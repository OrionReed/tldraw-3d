var X5=Object.defineProperty;var q5=(t,o,n)=>o in t?X5(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n;var D=(t,o,n)=>(q5(t,typeof o!="symbol"?o+"":o,n),n);function K5(t,o){for(var n=0;n<o.length;n++){const r=o[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wC={exports:{}},kg={},_C={exports:{}},Gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rh=Symbol.for("react.element"),Z5=Symbol.for("react.portal"),Q5=Symbol.for("react.fragment"),J5=Symbol.for("react.strict_mode"),eR=Symbol.for("react.profiler"),tR=Symbol.for("react.provider"),rR=Symbol.for("react.context"),nR=Symbol.for("react.forward_ref"),oR=Symbol.for("react.suspense"),sR=Symbol.for("react.memo"),iR=Symbol.for("react.lazy"),Uw=Symbol.iterator;function aR(t){return t===null||typeof t!="object"?null:(t=Uw&&t[Uw]||t["@@iterator"],typeof t=="function"?t:null)}var jC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EC=Object.assign,CC={};function Eu(t,o,n){this.props=t,this.context=o,this.refs=CC,this.updater=n||jC}Eu.prototype.isReactComponent={};Eu.prototype.setState=function(t,o){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,o,"setState")};Eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function PC(){}PC.prototype=Eu.prototype;function Z1(t,o,n){this.props=t,this.context=o,this.refs=CC,this.updater=n||jC}var Q1=Z1.prototype=new PC;Q1.constructor=Z1;EC(Q1,Eu.prototype);Q1.isPureReactComponent=!0;var Bw=Array.isArray,TC=Object.prototype.hasOwnProperty,J1={current:null},kC={key:!0,ref:!0,__self:!0,__source:!0};function IC(t,o,n){var r,s={},i=null,a=null;if(o!=null)for(r in o.ref!==void 0&&(a=o.ref),o.key!==void 0&&(i=""+o.key),o)TC.call(o,r)&&!kC.hasOwnProperty(r)&&(s[r]=o[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Rh,type:t,key:i,ref:a,props:s,_owner:J1.current}}function lR(t,o){return{$$typeof:Rh,type:t.type,key:o,ref:t.ref,props:t.props,_owner:t._owner}}function ex(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rh}function cR(t){var o={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return o[n]})}var zw=/\/+/g;function Wy(t,o){return typeof t=="object"&&t!==null&&t.key!=null?cR(""+t.key):o.toString(36)}function vp(t,o,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Rh:case Z5:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Wy(a,0):r,Bw(s)?(n="",t!=null&&(n=t.replace(zw,"$&/")+"/"),vp(s,o,n,"",function(u){return u})):s!=null&&(ex(s)&&(s=lR(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(zw,"$&/")+"/")+t)),o.push(s)),1;if(a=0,r=r===""?".":r+":",Bw(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Wy(i,l);a+=vp(i,o,n,c,s)}else if(c=aR(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Wy(i,l++),a+=vp(i,o,n,c,s);else if(i==="object")throw o=String(t),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return a}function gf(t,o,n){if(t==null)return t;var r=[],s=0;return vp(t,r,"","",function(i){return o.call(n,i,s++)}),r}function uR(t){if(t._status===-1){var o=t._result;o=o(),o.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=o)}if(t._status===1)return t._result.default;throw t._result}var go={current:null},bp={transition:null},dR={ReactCurrentDispatcher:go,ReactCurrentBatchConfig:bp,ReactCurrentOwner:J1};function MC(){throw Error("act(...) is not supported in production builds of React.")}Gt.Children={map:gf,forEach:function(t,o,n){gf(t,function(){o.apply(this,arguments)},n)},count:function(t){var o=0;return gf(t,function(){o++}),o},toArray:function(t){return gf(t,function(o){return o})||[]},only:function(t){if(!ex(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Gt.Component=Eu;Gt.Fragment=Q5;Gt.Profiler=eR;Gt.PureComponent=Z1;Gt.StrictMode=J5;Gt.Suspense=oR;Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dR;Gt.act=MC;Gt.cloneElement=function(t,o,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EC({},t.props),s=t.key,i=t.ref,a=t._owner;if(o!=null){if(o.ref!==void 0&&(i=o.ref,a=J1.current),o.key!==void 0&&(s=""+o.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in o)TC.call(o,c)&&!kC.hasOwnProperty(c)&&(r[c]=o[c]===void 0&&l!==void 0?l[c]:o[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Rh,type:t.type,key:s,ref:i,props:r,_owner:a}};Gt.createContext=function(t){return t={$$typeof:rR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tR,_context:t},t.Consumer=t};Gt.createElement=IC;Gt.createFactory=function(t){var o=IC.bind(null,t);return o.type=t,o};Gt.createRef=function(){return{current:null}};Gt.forwardRef=function(t){return{$$typeof:nR,render:t}};Gt.isValidElement=ex;Gt.lazy=function(t){return{$$typeof:iR,_payload:{_status:-1,_result:t},_init:uR}};Gt.memo=function(t,o){return{$$typeof:sR,type:t,compare:o===void 0?null:o}};Gt.startTransition=function(t){var o=bp.transition;bp.transition={};try{t()}finally{bp.transition=o}};Gt.unstable_act=MC;Gt.useCallback=function(t,o){return go.current.useCallback(t,o)};Gt.useContext=function(t){return go.current.useContext(t)};Gt.useDebugValue=function(){};Gt.useDeferredValue=function(t){return go.current.useDeferredValue(t)};Gt.useEffect=function(t,o){return go.current.useEffect(t,o)};Gt.useId=function(){return go.current.useId()};Gt.useImperativeHandle=function(t,o,n){return go.current.useImperativeHandle(t,o,n)};Gt.useInsertionEffect=function(t,o){return go.current.useInsertionEffect(t,o)};Gt.useLayoutEffect=function(t,o){return go.current.useLayoutEffect(t,o)};Gt.useMemo=function(t,o){return go.current.useMemo(t,o)};Gt.useReducer=function(t,o,n){return go.current.useReducer(t,o,n)};Gt.useRef=function(t){return go.current.useRef(t)};Gt.useState=function(t){return go.current.useState(t)};Gt.useSyncExternalStore=function(t,o,n){return go.current.useSyncExternalStore(t,o,n)};Gt.useTransition=function(){return go.current.useTransition()};Gt.version="18.3.1";_C.exports=Gt;var B=_C.exports;const Ut=Xl(B),hR=K5({__proto__:null,default:Ut},[B]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fR=B,pR=Symbol.for("react.element"),mR=Symbol.for("react.fragment"),gR=Object.prototype.hasOwnProperty,yR=fR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vR={key:!0,ref:!0,__self:!0,__source:!0};function OC(t,o,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),o.key!==void 0&&(i=""+o.key),o.ref!==void 0&&(a=o.ref);for(r in o)gR.call(o,r)&&!vR.hasOwnProperty(r)&&(s[r]=o[r]);if(t&&t.defaultProps)for(r in o=t.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:pR,type:t,key:i,ref:a,props:s,_owner:yR.current}}kg.Fragment=mR;kg.jsx=OC;kg.jsxs=OC;wC.exports=kg;var C=wC.exports;var Kv={},AC={exports:{}},rs={},RC={exports:{}},DC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function o(W,V){var q=W.length;W.push(V);e:for(;0<q;){var J=q-1>>>1,ae=W[J];if(0<s(ae,V))W[J]=V,W[q]=ae,q=J;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var V=W[0],q=W.pop();if(q!==V){W[0]=q;e:for(var J=0,ae=W.length,I=ae>>>1;J<I;){var U=2*(J+1)-1,z=W[U],K=U+1,te=W[K];if(0>s(z,q))K<ae&&0>s(te,z)?(W[J]=te,W[K]=q,J=K):(W[J]=z,W[U]=q,J=U);else if(K<ae&&0>s(te,q))W[J]=te,W[K]=q,J=K;else break e}}return V}function s(W,V){var q=W.sortIndex-V.sortIndex;return q!==0?q:W.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],f=1,h=null,d=3,p=!1,m=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(W){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=W)r(u),V.sortIndex=V.expirationTime,o(c,V);else break;V=n(u)}}function S(W){if(g=!1,x(W),!m)if(n(c)!==null)m=!0,G(w);else{var V=n(u);V!==null&&X(S,V.startTime-W)}}function w(W,V){m=!1,g&&(g=!1,y(P),P=-1),p=!0;var q=d;try{for(x(V),h=n(c);h!==null&&(!(h.expirationTime>V)||W&&!k());){var J=h.callback;if(typeof J=="function"){h.callback=null,d=h.priorityLevel;var ae=J(h.expirationTime<=V);V=t.unstable_now(),typeof ae=="function"?h.callback=ae:h===n(c)&&r(c),x(V)}else r(c);h=n(c)}if(h!==null)var I=!0;else{var U=n(u);U!==null&&X(S,U.startTime-V),I=!1}return I}finally{h=null,d=q,p=!1}}var E=!1,j=null,P=-1,M=5,O=-1;function k(){return!(t.unstable_now()-O<M)}function F(){if(j!==null){var W=t.unstable_now();O=W;var V=!0;try{V=j(!0,W)}finally{V?A():(E=!1,j=null)}}else E=!1}var A;if(typeof v=="function")A=function(){v(F)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,$=N.port2;N.port1.onmessage=F,A=function(){$.postMessage(null)}}else A=function(){b(F,0)};function G(W){j=W,E||(E=!0,A())}function X(W,V){P=b(function(){W(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,G(w))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var q=d;d=V;try{return W()}finally{d=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,V){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var q=d;d=W;try{return V()}finally{d=q}},t.unstable_scheduleCallback=function(W,V,q){var J=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,W){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=q+ae,W={id:f++,callback:V,priorityLevel:W,startTime:q,expirationTime:ae,sortIndex:-1},q>J?(W.sortIndex=q,o(u,W),n(c)===null&&W===n(u)&&(g?(y(P),P=-1):g=!0,X(S,q-J))):(W.sortIndex=ae,o(c,W),m||p||(m=!0,G(w))),W},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(W){var V=d;return function(){var q=d;d=V;try{return W.apply(this,arguments)}finally{d=q}}}})(DC);RC.exports=DC;var bR=RC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR=B,Jo=bR;function Je(t){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)o+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var LC=new Set,Yd={};function ql(t,o){cu(t,o),cu(t+"Capture",o)}function cu(t,o){for(Yd[t]=o,t=0;t<o.length;t++)LC.add(o[t])}var $i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zv=Object.prototype.hasOwnProperty,SR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gw={},Vw={};function wR(t){return Zv.call(Vw,t)?!0:Zv.call(Gw,t)?!1:SR.test(t)?Vw[t]=!0:(Gw[t]=!0,!1)}function _R(t,o,n,r){if(n!==null&&n.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jR(t,o,n,r){if(o===null||typeof o>"u"||_R(t,o,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function yo(t,o,n,r,s,i,a){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=o,this.sanitizeURL=i,this.removeEmptyString=a}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ln[t]=new yo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var o=t[0];Ln[o]=new yo(o,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ln[t]=new yo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ln[t]=new yo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ln[t]=new yo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ln[t]=new yo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ln[t]=new yo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ln[t]=new yo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ln[t]=new yo(t,5,!1,t.toLowerCase(),null,!1,!1)});var tx=/[\-:]([a-z])/g;function rx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var o=t.replace(tx,rx);Ln[o]=new yo(o,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var o=t.replace(tx,rx);Ln[o]=new yo(o,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var o=t.replace(tx,rx);Ln[o]=new yo(o,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ln[t]=new yo(t,1,!1,t.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new yo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ln[t]=new yo(t,1,!1,t.toLowerCase(),null,!0,!0)});function nx(t,o,n,r){var s=Ln.hasOwnProperty(o)?Ln[o]:null;(s!==null?s.type!==0:r||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(jR(o,n,s,r)&&(n=null),r||s===null?wR(o)&&(n===null?t.removeAttribute(o):t.setAttribute(o,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(o=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(o):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,o,n):t.setAttribute(o,n))))}var Ki=xR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yf=Symbol.for("react.element"),Tc=Symbol.for("react.portal"),kc=Symbol.for("react.fragment"),ox=Symbol.for("react.strict_mode"),Qv=Symbol.for("react.profiler"),FC=Symbol.for("react.provider"),NC=Symbol.for("react.context"),sx=Symbol.for("react.forward_ref"),Jv=Symbol.for("react.suspense"),eb=Symbol.for("react.suspense_list"),ix=Symbol.for("react.memo"),ba=Symbol.for("react.lazy"),$C=Symbol.for("react.offscreen"),Hw=Symbol.iterator;function qu(t){return t===null||typeof t!="object"?null:(t=Hw&&t[Hw]||t["@@iterator"],typeof t=="function"?t:null)}var Gr=Object.assign,Yy;function bd(t){if(Yy===void 0)try{throw Error()}catch(n){var o=n.stack.trim().match(/\n( *(at )?)/);Yy=o&&o[1]||""}return`
`+Yy+t}var Xy=!1;function qy(t,o){if(!t||Xy)return"";Xy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(u){var r=u}Reflect.construct(t,[],o)}else{try{o.call()}catch(u){r=u}t.call(o.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Xy=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?bd(t):""}function ER(t){switch(t.tag){case 5:return bd(t.type);case 16:return bd("Lazy");case 13:return bd("Suspense");case 19:return bd("SuspenseList");case 0:case 2:case 15:return t=qy(t.type,!1),t;case 11:return t=qy(t.type.render,!1),t;case 1:return t=qy(t.type,!0),t;default:return""}}function tb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case kc:return"Fragment";case Tc:return"Portal";case Qv:return"Profiler";case ox:return"StrictMode";case Jv:return"Suspense";case eb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case NC:return(t.displayName||"Context")+".Consumer";case FC:return(t._context.displayName||"Context")+".Provider";case sx:var o=t.render;return t=t.displayName,t||(t=o.displayName||o.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ix:return o=t.displayName||null,o!==null?o:tb(t.type)||"Memo";case ba:o=t._payload,t=t._init;try{return tb(t(o))}catch{}}return null}function CR(t){var o=t.type;switch(t.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=o.render,t=t.displayName||t.name||"",o.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tb(o);case 8:return o===ox?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function $a(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function UC(t){var o=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function PR(t){var o=UC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,o),r=""+t[o];if(!t.hasOwnProperty(o)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,o,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,o,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[o]}}}}function vf(t){t._valueTracker||(t._valueTracker=PR(t))}function BC(t){if(!t)return!1;var o=t._valueTracker;if(!o)return!0;var n=o.getValue(),r="";return t&&(r=UC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(o.setValue(t),!0):!1}function xm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rb(t,o){var n=o.checked;return Gr({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ww(t,o){var n=o.defaultValue==null?"":o.defaultValue,r=o.checked!=null?o.checked:o.defaultChecked;n=$a(o.value!=null?o.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function zC(t,o){o=o.checked,o!=null&&nx(t,"checked",o,!1)}function nb(t,o){zC(t,o);var n=$a(o.value),r=o.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}o.hasOwnProperty("value")?ob(t,o.type,n):o.hasOwnProperty("defaultValue")&&ob(t,o.type,$a(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(t.defaultChecked=!!o.defaultChecked)}function Yw(t,o,n){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var r=o.type;if(!(r!=="submit"&&r!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+t._wrapperState.initialValue,n||o===t.value||(t.value=o),t.defaultValue=o}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ob(t,o,n){(o!=="number"||xm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xd=Array.isArray;function qc(t,o,n,r){if(t=t.options,o){o={};for(var s=0;s<n.length;s++)o["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=o.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+$a(n),o=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}o!==null||t[s].disabled||(o=t[s])}o!==null&&(o.selected=!0)}}function sb(t,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Je(91));return Gr({},o,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Xw(t,o){var n=o.value;if(n==null){if(n=o.children,o=o.defaultValue,n!=null){if(o!=null)throw Error(Je(92));if(xd(n)){if(1<n.length)throw Error(Je(93));n=n[0]}o=n}o==null&&(o=""),n=o}t._wrapperState={initialValue:$a(n)}}function GC(t,o){var n=$a(o.value),r=$a(o.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),o.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function qw(t){var o=t.textContent;o===t._wrapperState.initialValue&&o!==""&&o!==null&&(t.value=o)}function VC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ib(t,o){return t==null||t==="http://www.w3.org/1999/xhtml"?VC(o):t==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bf,HC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(o,n,r,s)})}:t}(function(t,o){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=o;else{for(bf=bf||document.createElement("div"),bf.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=bf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;o.firstChild;)t.appendChild(o.firstChild)}});function Xd(t,o){if(o){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=o;return}}t.textContent=o}var kd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},TR=["Webkit","ms","Moz","O"];Object.keys(kd).forEach(function(t){TR.forEach(function(o){o=o+t.charAt(0).toUpperCase()+t.substring(1),kd[o]=kd[t]})});function WC(t,o,n){return o==null||typeof o=="boolean"||o===""?"":n||typeof o!="number"||o===0||kd.hasOwnProperty(t)&&kd[t]?(""+o).trim():o+"px"}function YC(t,o){t=t.style;for(var n in o)if(o.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=WC(n,o[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var kR=Gr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ab(t,o){if(o){if(kR[t]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Je(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Je(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Je(62))}}function lb(t,o){if(t.indexOf("-")===-1)return typeof o.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cb=null;function ax(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ub=null,Kc=null,Zc=null;function Kw(t){if(t=Fh(t)){if(typeof ub!="function")throw Error(Je(280));var o=t.stateNode;o&&(o=Rg(o),ub(t.stateNode,t.type,o))}}function XC(t){Kc?Zc?Zc.push(t):Zc=[t]:Kc=t}function qC(){if(Kc){var t=Kc,o=Zc;if(Zc=Kc=null,Kw(t),o)for(t=0;t<o.length;t++)Kw(o[t])}}function KC(t,o){return t(o)}function ZC(){}var Ky=!1;function QC(t,o,n){if(Ky)return t(o,n);Ky=!0;try{return KC(t,o,n)}finally{Ky=!1,(Kc!==null||Zc!==null)&&(ZC(),qC())}}function qd(t,o){var n=t.stateNode;if(n===null)return null;var r=Rg(n);if(r===null)return null;n=r[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,o,typeof n));return n}var db=!1;if($i)try{var Ku={};Object.defineProperty(Ku,"passive",{get:function(){db=!0}}),window.addEventListener("test",Ku,Ku),window.removeEventListener("test",Ku,Ku)}catch{db=!1}function IR(t,o,n,r,s,i,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{o.apply(n,u)}catch(f){this.onError(f)}}var Id=!1,Sm=null,wm=!1,hb=null,MR={onError:function(t){Id=!0,Sm=t}};function OR(t,o,n,r,s,i,a,l,c){Id=!1,Sm=null,IR.apply(MR,arguments)}function AR(t,o,n,r,s,i,a,l,c){if(OR.apply(this,arguments),Id){if(Id){var u=Sm;Id=!1,Sm=null}else throw Error(Je(198));wm||(wm=!0,hb=u)}}function Kl(t){var o=t,n=t;if(t.alternate)for(;o.return;)o=o.return;else{t=o;do o=t,o.flags&4098&&(n=o.return),t=o.return;while(t)}return o.tag===3?n:null}function JC(t){if(t.tag===13){var o=t.memoizedState;if(o===null&&(t=t.alternate,t!==null&&(o=t.memoizedState)),o!==null)return o.dehydrated}return null}function Zw(t){if(Kl(t)!==t)throw Error(Je(188))}function RR(t){var o=t.alternate;if(!o){if(o=Kl(t),o===null)throw Error(Je(188));return o!==t?null:t}for(var n=t,r=o;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Zw(s),t;if(i===r)return Zw(s),o;i=i.sibling}throw Error(Je(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(Je(189))}}if(n.alternate!==r)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:o}function eP(t){return t=RR(t),t!==null?tP(t):null}function tP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var o=tP(t);if(o!==null)return o;t=t.sibling}return null}var rP=Jo.unstable_scheduleCallback,Qw=Jo.unstable_cancelCallback,DR=Jo.unstable_shouldYield,LR=Jo.unstable_requestPaint,en=Jo.unstable_now,FR=Jo.unstable_getCurrentPriorityLevel,lx=Jo.unstable_ImmediatePriority,nP=Jo.unstable_UserBlockingPriority,_m=Jo.unstable_NormalPriority,NR=Jo.unstable_LowPriority,oP=Jo.unstable_IdlePriority,Ig=null,ni=null;function $R(t){if(ni&&typeof ni.onCommitFiberRoot=="function")try{ni.onCommitFiberRoot(Ig,t,void 0,(t.current.flags&128)===128)}catch{}}var Ns=Math.clz32?Math.clz32:zR,UR=Math.log,BR=Math.LN2;function zR(t){return t>>>=0,t===0?32:31-(UR(t)/BR|0)|0}var xf=64,Sf=4194304;function Sd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jm(t,o){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Sd(l):(i&=a,i!==0&&(r=Sd(i)))}else a=n&~s,a!==0?r=Sd(a):i!==0&&(r=Sd(i));if(r===0)return 0;if(o!==0&&o!==r&&!(o&s)&&(s=r&-r,i=o&-o,s>=i||s===16&&(i&4194240)!==0))return o;if(r&4&&(r|=n&16),o=t.entangledLanes,o!==0)for(t=t.entanglements,o&=r;0<o;)n=31-Ns(o),s=1<<n,r|=t[n],o&=~s;return r}function GR(t,o){switch(t){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VR(t,o){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Ns(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=GR(l,o)):c<=o&&(t.expiredLanes|=l),i&=~l}}function fb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sP(){var t=xf;return xf<<=1,!(xf&4194240)&&(xf=64),t}function Zy(t){for(var o=[],n=0;31>n;n++)o.push(t);return o}function Dh(t,o,n){t.pendingLanes|=o,o!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,o=31-Ns(o),t[o]=n}function HR(t,o){var n=t.pendingLanes&~o;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=o,t.mutableReadLanes&=o,t.entangledLanes&=o,o=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Ns(n),i=1<<s;o[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function cx(t,o){var n=t.entangledLanes|=o;for(t=t.entanglements;n;){var r=31-Ns(n),s=1<<r;s&o|t[r]&o&&(t[r]|=o),n&=~s}}var lr=0;function iP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var aP,ux,lP,cP,uP,pb=!1,wf=[],ka=null,Ia=null,Ma=null,Kd=new Map,Zd=new Map,Sa=[],WR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jw(t,o){switch(t){case"focusin":case"focusout":ka=null;break;case"dragenter":case"dragleave":Ia=null;break;case"mouseover":case"mouseout":Ma=null;break;case"pointerover":case"pointerout":Kd.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zd.delete(o.pointerId)}}function Zu(t,o,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:o,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},o!==null&&(o=Fh(o),o!==null&&ux(o)),t):(t.eventSystemFlags|=r,o=t.targetContainers,s!==null&&o.indexOf(s)===-1&&o.push(s),t)}function YR(t,o,n,r,s){switch(o){case"focusin":return ka=Zu(ka,t,o,n,r,s),!0;case"dragenter":return Ia=Zu(Ia,t,o,n,r,s),!0;case"mouseover":return Ma=Zu(Ma,t,o,n,r,s),!0;case"pointerover":var i=s.pointerId;return Kd.set(i,Zu(Kd.get(i)||null,t,o,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Zd.set(i,Zu(Zd.get(i)||null,t,o,n,r,s)),!0}return!1}function dP(t){var o=Sl(t.target);if(o!==null){var n=Kl(o);if(n!==null){if(o=n.tag,o===13){if(o=JC(n),o!==null){t.blockedOn=o,uP(t.priority,function(){lP(n)});return}}else if(o===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function xp(t){if(t.blockedOn!==null)return!1;for(var o=t.targetContainers;0<o.length;){var n=mb(t.domEventName,t.eventSystemFlags,o[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);cb=r,n.target.dispatchEvent(r),cb=null}else return o=Fh(n),o!==null&&ux(o),t.blockedOn=n,!1;o.shift()}return!0}function e_(t,o,n){xp(t)&&n.delete(o)}function XR(){pb=!1,ka!==null&&xp(ka)&&(ka=null),Ia!==null&&xp(Ia)&&(Ia=null),Ma!==null&&xp(Ma)&&(Ma=null),Kd.forEach(e_),Zd.forEach(e_)}function Qu(t,o){t.blockedOn===o&&(t.blockedOn=null,pb||(pb=!0,Jo.unstable_scheduleCallback(Jo.unstable_NormalPriority,XR)))}function Qd(t){function o(s){return Qu(s,t)}if(0<wf.length){Qu(wf[0],t);for(var n=1;n<wf.length;n++){var r=wf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ka!==null&&Qu(ka,t),Ia!==null&&Qu(Ia,t),Ma!==null&&Qu(Ma,t),Kd.forEach(o),Zd.forEach(o),n=0;n<Sa.length;n++)r=Sa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Sa.length&&(n=Sa[0],n.blockedOn===null);)dP(n),n.blockedOn===null&&Sa.shift()}var Qc=Ki.ReactCurrentBatchConfig,Em=!0;function qR(t,o,n,r){var s=lr,i=Qc.transition;Qc.transition=null;try{lr=1,dx(t,o,n,r)}finally{lr=s,Qc.transition=i}}function KR(t,o,n,r){var s=lr,i=Qc.transition;Qc.transition=null;try{lr=4,dx(t,o,n,r)}finally{lr=s,Qc.transition=i}}function dx(t,o,n,r){if(Em){var s=mb(t,o,n,r);if(s===null)a0(t,o,r,Cm,n),Jw(t,r);else if(YR(s,t,o,n,r))r.stopPropagation();else if(Jw(t,r),o&4&&-1<WR.indexOf(t)){for(;s!==null;){var i=Fh(s);if(i!==null&&aP(i),i=mb(t,o,n,r),i===null&&a0(t,o,r,Cm,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else a0(t,o,r,null,n)}}var Cm=null;function mb(t,o,n,r){if(Cm=null,t=ax(r),t=Sl(t),t!==null)if(o=Kl(t),o===null)t=null;else if(n=o.tag,n===13){if(t=JC(o),t!==null)return t;t=null}else if(n===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;t=null}else o!==t&&(t=null);return Cm=t,null}function hP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FR()){case lx:return 1;case nP:return 4;case _m:case NR:return 16;case oP:return 536870912;default:return 16}default:return 16}}var Ea=null,hx=null,Sp=null;function fP(){if(Sp)return Sp;var t,o=hx,n=o.length,r,s="value"in Ea?Ea.value:Ea.textContent,i=s.length;for(t=0;t<n&&o[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&o[n-r]===s[i-r];r++);return Sp=s.slice(t,1<r?1-r:void 0)}function wp(t){var o=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&o===13&&(t=13)):t=o,t===10&&(t=13),32<=t||t===13?t:0}function _f(){return!0}function t_(){return!1}function ns(t){function o(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_f:t_,this.isPropagationStopped=t_,this}return Gr(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_f)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_f)},persist:function(){},isPersistent:_f}),o}var Cu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fx=ns(Cu),Lh=Gr({},Cu,{view:0,detail:0}),ZR=ns(Lh),Qy,Jy,Ju,Mg=Gr({},Lh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:px,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ju&&(Ju&&t.type==="mousemove"?(Qy=t.screenX-Ju.screenX,Jy=t.screenY-Ju.screenY):Jy=Qy=0,Ju=t),Qy)},movementY:function(t){return"movementY"in t?t.movementY:Jy}}),r_=ns(Mg),QR=Gr({},Mg,{dataTransfer:0}),JR=ns(QR),eD=Gr({},Lh,{relatedTarget:0}),e0=ns(eD),tD=Gr({},Cu,{animationName:0,elapsedTime:0,pseudoElement:0}),rD=ns(tD),nD=Gr({},Cu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oD=ns(nD),sD=Gr({},Cu,{data:0}),n_=ns(sD),iD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cD(t){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(t):(t=lD[t])?!!o[t]:!1}function px(){return cD}var uD=Gr({},Lh,{key:function(t){if(t.key){var o=iD[t.key]||t.key;if(o!=="Unidentified")return o}return t.type==="keypress"?(t=wp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aD[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:px,charCode:function(t){return t.type==="keypress"?wp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?wp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dD=ns(uD),hD=Gr({},Mg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),o_=ns(hD),fD=Gr({},Lh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:px}),pD=ns(fD),mD=Gr({},Cu,{propertyName:0,elapsedTime:0,pseudoElement:0}),gD=ns(mD),yD=Gr({},Mg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vD=ns(yD),bD=[9,13,27,32],mx=$i&&"CompositionEvent"in window,Md=null;$i&&"documentMode"in document&&(Md=document.documentMode);var xD=$i&&"TextEvent"in window&&!Md,pP=$i&&(!mx||Md&&8<Md&&11>=Md),s_=String.fromCharCode(32),i_=!1;function mP(t,o){switch(t){case"keyup":return bD.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ic=!1;function SD(t,o){switch(t){case"compositionend":return gP(o);case"keypress":return o.which!==32?null:(i_=!0,s_);case"textInput":return t=o.data,t===s_&&i_?null:t;default:return null}}function wD(t,o){if(Ic)return t==="compositionend"||!mx&&mP(t,o)?(t=fP(),Sp=hx=Ea=null,Ic=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return pP&&o.locale!=="ko"?null:o.data;default:return null}}var _D={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a_(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o==="input"?!!_D[t.type]:o==="textarea"}function yP(t,o,n,r){XC(r),o=Pm(o,"onChange"),0<o.length&&(n=new fx("onChange","change",null,n,r),t.push({event:n,listeners:o}))}var Od=null,Jd=null;function jD(t){TP(t,0)}function Og(t){var o=Ac(t);if(BC(o))return t}function ED(t,o){if(t==="change")return o}var vP=!1;if($i){var t0;if($i){var r0="oninput"in document;if(!r0){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),r0=typeof l_.oninput=="function"}t0=r0}else t0=!1;vP=t0&&(!document.documentMode||9<document.documentMode)}function c_(){Od&&(Od.detachEvent("onpropertychange",bP),Jd=Od=null)}function bP(t){if(t.propertyName==="value"&&Og(Jd)){var o=[];yP(o,Jd,t,ax(t)),QC(jD,o)}}function CD(t,o,n){t==="focusin"?(c_(),Od=o,Jd=n,Od.attachEvent("onpropertychange",bP)):t==="focusout"&&c_()}function PD(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Og(Jd)}function TD(t,o){if(t==="click")return Og(o)}function kD(t,o){if(t==="input"||t==="change")return Og(o)}function ID(t,o){return t===o&&(t!==0||1/t===1/o)||t!==t&&o!==o}var Gs=typeof Object.is=="function"?Object.is:ID;function eh(t,o){if(Gs(t,o))return!0;if(typeof t!="object"||t===null||typeof o!="object"||o===null)return!1;var n=Object.keys(t),r=Object.keys(o);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Zv.call(o,s)||!Gs(t[s],o[s]))return!1}return!0}function u_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function d_(t,o){var n=u_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=o&&r>=o)return{node:n,offset:o-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=u_(n)}}function xP(t,o){return t&&o?t===o?!0:t&&t.nodeType===3?!1:o&&o.nodeType===3?xP(t,o.parentNode):"contains"in t?t.contains(o):t.compareDocumentPosition?!!(t.compareDocumentPosition(o)&16):!1:!1}function SP(){for(var t=window,o=xm();o instanceof t.HTMLIFrameElement;){try{var n=typeof o.contentWindow.location.href=="string"}catch{n=!1}if(n)t=o.contentWindow;else break;o=xm(t.document)}return o}function gx(t){var o=t&&t.nodeName&&t.nodeName.toLowerCase();return o&&(o==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||o==="textarea"||t.contentEditable==="true")}function MD(t){var o=SP(),n=t.focusedElem,r=t.selectionRange;if(o!==n&&n&&n.ownerDocument&&xP(n.ownerDocument.documentElement,n)){if(r!==null&&gx(n)){if(o=r.start,t=r.end,t===void 0&&(t=o),"selectionStart"in n)n.selectionStart=o,n.selectionEnd=Math.min(t,n.value.length);else if(t=(o=n.ownerDocument||document)&&o.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=d_(n,i);var a=d_(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(o=o.createRange(),o.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(o),t.extend(a.node,a.offset)):(o.setEnd(a.node,a.offset),t.addRange(o)))}}for(o=[],t=n;t=t.parentNode;)t.nodeType===1&&o.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<o.length;n++)t=o[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var OD=$i&&"documentMode"in document&&11>=document.documentMode,Mc=null,gb=null,Ad=null,yb=!1;function h_(t,o,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;yb||Mc==null||Mc!==xm(r)||(r=Mc,"selectionStart"in r&&gx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ad&&eh(Ad,r)||(Ad=r,r=Pm(gb,"onSelect"),0<r.length&&(o=new fx("onSelect","select",null,o,n),t.push({event:o,listeners:r}),o.target=Mc)))}function jf(t,o){var n={};return n[t.toLowerCase()]=o.toLowerCase(),n["Webkit"+t]="webkit"+o,n["Moz"+t]="moz"+o,n}var Oc={animationend:jf("Animation","AnimationEnd"),animationiteration:jf("Animation","AnimationIteration"),animationstart:jf("Animation","AnimationStart"),transitionend:jf("Transition","TransitionEnd")},n0={},wP={};$i&&(wP=document.createElement("div").style,"AnimationEvent"in window||(delete Oc.animationend.animation,delete Oc.animationiteration.animation,delete Oc.animationstart.animation),"TransitionEvent"in window||delete Oc.transitionend.transition);function Ag(t){if(n0[t])return n0[t];if(!Oc[t])return t;var o=Oc[t],n;for(n in o)if(o.hasOwnProperty(n)&&n in wP)return n0[t]=o[n];return t}var _P=Ag("animationend"),jP=Ag("animationiteration"),EP=Ag("animationstart"),CP=Ag("transitionend"),PP=new Map,f_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,o){PP.set(t,o),ql(o,[t])}for(var o0=0;o0<f_.length;o0++){var s0=f_[o0],AD=s0.toLowerCase(),RD=s0[0].toUpperCase()+s0.slice(1);qa(AD,"on"+RD)}qa(_P,"onAnimationEnd");qa(jP,"onAnimationIteration");qa(EP,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(CP,"onTransitionEnd");cu("onMouseEnter",["mouseout","mouseover"]);cu("onMouseLeave",["mouseout","mouseover"]);cu("onPointerEnter",["pointerout","pointerover"]);cu("onPointerLeave",["pointerout","pointerover"]);ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DD=new Set("cancel close invalid load scroll toggle".split(" ").concat(wd));function p_(t,o,n){var r=t.type||"unknown-event";t.currentTarget=n,AR(r,o,void 0,t),t.currentTarget=null}function TP(t,o){o=(o&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(o)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;p_(s,l,u),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;p_(s,l,u),i=c}}}if(wm)throw t=hb,wm=!1,hb=null,t}function kr(t,o){var n=o[wb];n===void 0&&(n=o[wb]=new Set);var r=t+"__bubble";n.has(r)||(kP(o,t,2,!1),n.add(r))}function i0(t,o,n){var r=0;o&&(r|=4),kP(n,t,r,o)}var Ef="_reactListening"+Math.random().toString(36).slice(2);function th(t){if(!t[Ef]){t[Ef]=!0,LC.forEach(function(n){n!=="selectionchange"&&(DD.has(n)||i0(n,!1,t),i0(n,!0,t))});var o=t.nodeType===9?t:t.ownerDocument;o===null||o[Ef]||(o[Ef]=!0,i0("selectionchange",!1,o))}}function kP(t,o,n,r){switch(hP(o)){case 1:var s=qR;break;case 4:s=KR;break;default:s=dx}n=s.bind(null,o,n,t),s=void 0,!db||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(o,n,{capture:!0,passive:s}):t.addEventListener(o,n,!0):s!==void 0?t.addEventListener(o,n,{passive:s}):t.addEventListener(o,n,!1)}function a0(t,o,n,r,s){var i=r;if(!(o&1)&&!(o&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Sl(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}QC(function(){var u=i,f=ax(n),h=[];e:{var d=PP.get(t);if(d!==void 0){var p=fx,m=t;switch(t){case"keypress":if(wp(n)===0)break e;case"keydown":case"keyup":p=dD;break;case"focusin":m="focus",p=e0;break;case"focusout":m="blur",p=e0;break;case"beforeblur":case"afterblur":p=e0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=r_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=JR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=pD;break;case _P:case jP:case EP:p=rD;break;case CP:p=gD;break;case"scroll":p=ZR;break;case"wheel":p=vD;break;case"copy":case"cut":case"paste":p=oD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=o_}var g=(o&4)!==0,b=!g&&t==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var v=u,x;v!==null;){x=v;var S=x.stateNode;if(x.tag===5&&S!==null&&(x=S,y!==null&&(S=qd(v,y),S!=null&&g.push(rh(v,S,x)))),b)break;v=v.return}0<g.length&&(d=new p(d,m,null,n,f),h.push({event:d,listeners:g}))}}if(!(o&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&n!==cb&&(m=n.relatedTarget||n.fromElement)&&(Sl(m)||m[Ui]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?Sl(m):null,m!==null&&(b=Kl(m),m!==b||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=r_,S="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=o_,S="onPointerLeave",y="onPointerEnter",v="pointer"),b=p==null?d:Ac(p),x=m==null?d:Ac(m),d=new g(S,v+"leave",p,n,f),d.target=b,d.relatedTarget=x,S=null,Sl(f)===u&&(g=new g(y,v+"enter",m,n,f),g.target=x,g.relatedTarget=b,S=g),b=S,p&&m)t:{for(g=p,y=m,v=0,x=g;x;x=uc(x))v++;for(x=0,S=y;S;S=uc(S))x++;for(;0<v-x;)g=uc(g),v--;for(;0<x-v;)y=uc(y),x--;for(;v--;){if(g===y||y!==null&&g===y.alternate)break t;g=uc(g),y=uc(y)}g=null}else g=null;p!==null&&m_(h,d,p,g,!1),m!==null&&b!==null&&m_(h,b,m,g,!0)}}e:{if(d=u?Ac(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var w=ED;else if(a_(d))if(vP)w=kD;else{w=PD;var E=CD}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=TD);if(w&&(w=w(t,u))){yP(h,w,n,f);break e}E&&E(t,d,u),t==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&ob(d,"number",d.value)}switch(E=u?Ac(u):window,t){case"focusin":(a_(E)||E.contentEditable==="true")&&(Mc=E,gb=u,Ad=null);break;case"focusout":Ad=gb=Mc=null;break;case"mousedown":yb=!0;break;case"contextmenu":case"mouseup":case"dragend":yb=!1,h_(h,n,f);break;case"selectionchange":if(OD)break;case"keydown":case"keyup":h_(h,n,f)}var j;if(mx)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Ic?mP(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(pP&&n.locale!=="ko"&&(Ic||P!=="onCompositionStart"?P==="onCompositionEnd"&&Ic&&(j=fP()):(Ea=f,hx="value"in Ea?Ea.value:Ea.textContent,Ic=!0)),E=Pm(u,P),0<E.length&&(P=new n_(P,t,null,n,f),h.push({event:P,listeners:E}),j?P.data=j:(j=gP(n),j!==null&&(P.data=j)))),(j=xD?SD(t,n):wD(t,n))&&(u=Pm(u,"onBeforeInput"),0<u.length&&(f=new n_("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:u}),f.data=j))}TP(h,o)})}function rh(t,o,n){return{instance:t,listener:o,currentTarget:n}}function Pm(t,o){for(var n=o+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qd(t,n),i!=null&&r.unshift(rh(t,i,s)),i=qd(t,o),i!=null&&r.push(rh(t,i,s))),t=t.return}return r}function uc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function m_(t,o,n,r,s){for(var i=o._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=qd(n,i),c!=null&&a.unshift(rh(n,c,l))):s||(c=qd(n,i),c!=null&&a.push(rh(n,c,l)))),n=n.return}a.length!==0&&t.push({event:o,listeners:a})}var LD=/\r\n?/g,FD=/\u0000|\uFFFD/g;function g_(t){return(typeof t=="string"?t:""+t).replace(LD,`
`).replace(FD,"")}function Cf(t,o,n){if(o=g_(o),g_(t)!==o&&n)throw Error(Je(425))}function Tm(){}var vb=null,bb=null;function xb(t,o){return t==="textarea"||t==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Sb=typeof setTimeout=="function"?setTimeout:void 0,ND=typeof clearTimeout=="function"?clearTimeout:void 0,y_=typeof Promise=="function"?Promise:void 0,$D=typeof queueMicrotask=="function"?queueMicrotask:typeof y_<"u"?function(t){return y_.resolve(null).then(t).catch(UD)}:Sb;function UD(t){setTimeout(function(){throw t})}function l0(t,o){var n=o,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Qd(o);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Qd(o)}function Oa(t){for(;t!=null;t=t.nextSibling){var o=t.nodeType;if(o===1||o===3)break;if(o===8){if(o=t.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return t}function v_(t){t=t.previousSibling;for(var o=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(o===0)return t;o--}else n==="/$"&&o++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),Js="__reactFiber$"+Pu,nh="__reactProps$"+Pu,Ui="__reactContainer$"+Pu,wb="__reactEvents$"+Pu,BD="__reactListeners$"+Pu,zD="__reactHandles$"+Pu;function Sl(t){var o=t[Js];if(o)return o;for(var n=t.parentNode;n;){if(o=n[Ui]||n[Js]){if(n=o.alternate,o.child!==null||n!==null&&n.child!==null)for(t=v_(t);t!==null;){if(n=t[Js])return n;t=v_(t)}return o}t=n,n=t.parentNode}return null}function Fh(t){return t=t[Js]||t[Ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ac(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function Rg(t){return t[nh]||null}var _b=[],Rc=-1;function Ka(t){return{current:t}}function Or(t){0>Rc||(t.current=_b[Rc],_b[Rc]=null,Rc--)}function wr(t,o){Rc++,_b[Rc]=t.current,t.current=o}var Ua={},Zn=Ka(Ua),Io=Ka(!1),Ol=Ua;function uu(t,o){var n=t.type.contextTypes;if(!n)return Ua;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===o)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=o[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=s),s}function Mo(t){return t=t.childContextTypes,t!=null}function km(){Or(Io),Or(Zn)}function b_(t,o,n){if(Zn.current!==Ua)throw Error(Je(168));wr(Zn,o),wr(Io,n)}function IP(t,o,n){var r=t.stateNode;if(o=o.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in o))throw Error(Je(108,CR(t)||"Unknown",s));return Gr({},n,r)}function Im(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ua,Ol=Zn.current,wr(Zn,t),wr(Io,Io.current),!0}function x_(t,o,n){var r=t.stateNode;if(!r)throw Error(Je(169));n?(t=IP(t,o,Ol),r.__reactInternalMemoizedMergedChildContext=t,Or(Io),Or(Zn),wr(Zn,t)):Or(Io),wr(Io,n)}var ki=null,Dg=!1,c0=!1;function MP(t){ki===null?ki=[t]:ki.push(t)}function GD(t){Dg=!0,MP(t)}function Za(){if(!c0&&ki!==null){c0=!0;var t=0,o=lr;try{var n=ki;for(lr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ki=null,Dg=!1}catch(s){throw ki!==null&&(ki=ki.slice(t+1)),rP(lx,Za),s}finally{lr=o,c0=!1}}return null}var Dc=[],Lc=0,Mm=null,Om=0,us=[],ds=0,Al=null,Mi=1,Oi="";function vl(t,o){Dc[Lc++]=Om,Dc[Lc++]=Mm,Mm=t,Om=o}function OP(t,o,n){us[ds++]=Mi,us[ds++]=Oi,us[ds++]=Al,Al=t;var r=Mi;t=Oi;var s=32-Ns(r)-1;r&=~(1<<s),n+=1;var i=32-Ns(o)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Mi=1<<32-Ns(o)+s|n<<s|r,Oi=i+t}else Mi=1<<i|n<<s|r,Oi=t}function yx(t){t.return!==null&&(vl(t,1),OP(t,1,0))}function vx(t){for(;t===Mm;)Mm=Dc[--Lc],Dc[Lc]=null,Om=Dc[--Lc],Dc[Lc]=null;for(;t===Al;)Al=us[--ds],us[ds]=null,Oi=us[--ds],us[ds]=null,Mi=us[--ds],us[ds]=null}var qo=null,Xo=null,Lr=!1,As=null;function AP(t,o){var n=fs(5,null,null,0);n.elementType="DELETED",n.stateNode=o,n.return=t,o=t.deletions,o===null?(t.deletions=[n],t.flags|=16):o.push(n)}function S_(t,o){switch(t.tag){case 5:var n=t.type;return o=o.nodeType!==1||n.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(t.stateNode=o,qo=t,Xo=Oa(o.firstChild),!0):!1;case 6:return o=t.pendingProps===""||o.nodeType!==3?null:o,o!==null?(t.stateNode=o,qo=t,Xo=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(n=Al!==null?{id:Mi,overflow:Oi}:null,t.memoizedState={dehydrated:o,treeContext:n,retryLane:1073741824},n=fs(18,null,null,0),n.stateNode=o,n.return=t,t.child=n,qo=t,Xo=null,!0):!1;default:return!1}}function jb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Eb(t){if(Lr){var o=Xo;if(o){var n=o;if(!S_(t,o)){if(jb(t))throw Error(Je(418));o=Oa(n.nextSibling);var r=qo;o&&S_(t,o)?AP(r,n):(t.flags=t.flags&-4097|2,Lr=!1,qo=t)}}else{if(jb(t))throw Error(Je(418));t.flags=t.flags&-4097|2,Lr=!1,qo=t}}}function w_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qo=t}function Pf(t){if(t!==qo)return!1;if(!Lr)return w_(t),Lr=!0,!1;var o;if((o=t.tag!==3)&&!(o=t.tag!==5)&&(o=t.type,o=o!=="head"&&o!=="body"&&!xb(t.type,t.memoizedProps)),o&&(o=Xo)){if(jb(t))throw RP(),Error(Je(418));for(;o;)AP(t,o),o=Oa(o.nextSibling)}if(w_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,o=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(o===0){Xo=Oa(t.nextSibling);break e}o--}else n!=="$"&&n!=="$!"&&n!=="$?"||o++}t=t.nextSibling}Xo=null}}else Xo=qo?Oa(t.stateNode.nextSibling):null;return!0}function RP(){for(var t=Xo;t;)t=Oa(t.nextSibling)}function du(){Xo=qo=null,Lr=!1}function bx(t){As===null?As=[t]:As.push(t)}var VD=Ki.ReactCurrentBatchConfig;function ed(t,o,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var r=n.stateNode}if(!r)throw Error(Je(147,t));var s=r,i=""+t;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===i?o.ref:(o=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},o._stringRef=i,o)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function Tf(t,o){throw t=Object.prototype.toString.call(o),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":t))}function __(t){var o=t._init;return o(t._payload)}function DP(t){function o(y,v){if(t){var x=y.deletions;x===null?(y.deletions=[v],y.flags|=16):x.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)o(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function s(y,v){return y=La(y,v),y.index=0,y.sibling=null,y}function i(y,v,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<v?(y.flags|=2,v):x):(y.flags|=2,v)):(y.flags|=1048576,v)}function a(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,v,x,S){return v===null||v.tag!==6?(v=g0(x,y.mode,S),v.return=y,v):(v=s(v,x),v.return=y,v)}function c(y,v,x,S){var w=x.type;return w===kc?f(y,v,x.props.children,S,x.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ba&&__(w)===v.type)?(S=s(v,x.props),S.ref=ed(y,v,x),S.return=y,S):(S=kp(x.type,x.key,x.props,null,y.mode,S),S.ref=ed(y,v,x),S.return=y,S)}function u(y,v,x,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=y0(x,y.mode,S),v.return=y,v):(v=s(v,x.children||[]),v.return=y,v)}function f(y,v,x,S,w){return v===null||v.tag!==7?(v=Il(x,y.mode,S,w),v.return=y,v):(v=s(v,x),v.return=y,v)}function h(y,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=g0(""+v,y.mode,x),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case yf:return x=kp(v.type,v.key,v.props,null,y.mode,x),x.ref=ed(y,null,v),x.return=y,x;case Tc:return v=y0(v,y.mode,x),v.return=y,v;case ba:var S=v._init;return h(y,S(v._payload),x)}if(xd(v)||qu(v))return v=Il(v,y.mode,x,null),v.return=y,v;Tf(y,v)}return null}function d(y,v,x,S){var w=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:l(y,v,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case yf:return x.key===w?c(y,v,x,S):null;case Tc:return x.key===w?u(y,v,x,S):null;case ba:return w=x._init,d(y,v,w(x._payload),S)}if(xd(x)||qu(x))return w!==null?null:f(y,v,x,S,null);Tf(y,x)}return null}function p(y,v,x,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(x)||null,l(v,y,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case yf:return y=y.get(S.key===null?x:S.key)||null,c(v,y,S,w);case Tc:return y=y.get(S.key===null?x:S.key)||null,u(v,y,S,w);case ba:var E=S._init;return p(y,v,x,E(S._payload),w)}if(xd(S)||qu(S))return y=y.get(x)||null,f(v,y,S,w,null);Tf(v,S)}return null}function m(y,v,x,S){for(var w=null,E=null,j=v,P=v=0,M=null;j!==null&&P<x.length;P++){j.index>P?(M=j,j=null):M=j.sibling;var O=d(y,j,x[P],S);if(O===null){j===null&&(j=M);break}t&&j&&O.alternate===null&&o(y,j),v=i(O,v,P),E===null?w=O:E.sibling=O,E=O,j=M}if(P===x.length)return n(y,j),Lr&&vl(y,P),w;if(j===null){for(;P<x.length;P++)j=h(y,x[P],S),j!==null&&(v=i(j,v,P),E===null?w=j:E.sibling=j,E=j);return Lr&&vl(y,P),w}for(j=r(y,j);P<x.length;P++)M=p(j,y,P,x[P],S),M!==null&&(t&&M.alternate!==null&&j.delete(M.key===null?P:M.key),v=i(M,v,P),E===null?w=M:E.sibling=M,E=M);return t&&j.forEach(function(k){return o(y,k)}),Lr&&vl(y,P),w}function g(y,v,x,S){var w=qu(x);if(typeof w!="function")throw Error(Je(150));if(x=w.call(x),x==null)throw Error(Je(151));for(var E=w=null,j=v,P=v=0,M=null,O=x.next();j!==null&&!O.done;P++,O=x.next()){j.index>P?(M=j,j=null):M=j.sibling;var k=d(y,j,O.value,S);if(k===null){j===null&&(j=M);break}t&&j&&k.alternate===null&&o(y,j),v=i(k,v,P),E===null?w=k:E.sibling=k,E=k,j=M}if(O.done)return n(y,j),Lr&&vl(y,P),w;if(j===null){for(;!O.done;P++,O=x.next())O=h(y,O.value,S),O!==null&&(v=i(O,v,P),E===null?w=O:E.sibling=O,E=O);return Lr&&vl(y,P),w}for(j=r(y,j);!O.done;P++,O=x.next())O=p(j,y,P,O.value,S),O!==null&&(t&&O.alternate!==null&&j.delete(O.key===null?P:O.key),v=i(O,v,P),E===null?w=O:E.sibling=O,E=O);return t&&j.forEach(function(F){return o(y,F)}),Lr&&vl(y,P),w}function b(y,v,x,S){if(typeof x=="object"&&x!==null&&x.type===kc&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case yf:e:{for(var w=x.key,E=v;E!==null;){if(E.key===w){if(w=x.type,w===kc){if(E.tag===7){n(y,E.sibling),v=s(E,x.props.children),v.return=y,y=v;break e}}else if(E.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===ba&&__(w)===E.type){n(y,E.sibling),v=s(E,x.props),v.ref=ed(y,E,x),v.return=y,y=v;break e}n(y,E);break}else o(y,E);E=E.sibling}x.type===kc?(v=Il(x.props.children,y.mode,S,x.key),v.return=y,y=v):(S=kp(x.type,x.key,x.props,null,y.mode,S),S.ref=ed(y,v,x),S.return=y,y=S)}return a(y);case Tc:e:{for(E=x.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(y,v.sibling),v=s(v,x.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else o(y,v);v=v.sibling}v=y0(x,y.mode,S),v.return=y,y=v}return a(y);case ba:return E=x._init,b(y,v,E(x._payload),S)}if(xd(x))return m(y,v,x,S);if(qu(x))return g(y,v,x,S);Tf(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(y,v.sibling),v=s(v,x),v.return=y,y=v):(n(y,v),v=g0(x,y.mode,S),v.return=y,y=v),a(y)):n(y,v)}return b}var hu=DP(!0),LP=DP(!1),Am=Ka(null),Rm=null,Fc=null,xx=null;function Sx(){xx=Fc=Rm=null}function wx(t){var o=Am.current;Or(Am),t._currentValue=o}function Cb(t,o,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&o)!==o?(t.childLanes|=o,r!==null&&(r.childLanes|=o)):r!==null&&(r.childLanes&o)!==o&&(r.childLanes|=o),t===n)break;t=t.return}}function Jc(t,o){Rm=t,xx=Fc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&o&&(Po=!0),t.firstContext=null)}function gs(t){var o=t._currentValue;if(xx!==t)if(t={context:t,memoizedValue:o,next:null},Fc===null){if(Rm===null)throw Error(Je(308));Fc=t,Rm.dependencies={lanes:0,firstContext:t}}else Fc=Fc.next=t;return o}var wl=null;function _x(t){wl===null?wl=[t]:wl.push(t)}function FP(t,o,n,r){var s=o.interleaved;return s===null?(n.next=n,_x(o)):(n.next=s.next,s.next=n),o.interleaved=n,Bi(t,r)}function Bi(t,o){t.lanes|=o;var n=t.alternate;for(n!==null&&(n.lanes|=o),n=t,t=t.return;t!==null;)t.childLanes|=o,n=t.alternate,n!==null&&(n.childLanes|=o),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xa=!1;function jx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NP(t,o){t=t.updateQueue,o.updateQueue===t&&(o.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ri(t,o){return{eventTime:t,lane:o,tag:0,payload:null,callback:null,next:null}}function Aa(t,o,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Kt&2){var s=r.pending;return s===null?o.next=o:(o.next=s.next,s.next=o),r.pending=o,Bi(t,n)}return s=r.interleaved,s===null?(o.next=o,_x(r)):(o.next=s.next,s.next=o),r.interleaved=o,Bi(t,n)}function _p(t,o,n){if(o=o.updateQueue,o!==null&&(o=o.shared,(n&4194240)!==0)){var r=o.lanes;r&=t.pendingLanes,n|=r,o.lanes=n,cx(t,n)}}function j_(t,o){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=o:i=i.next=o}else s=i=o;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=o:t.next=o,n.lastBaseUpdate=o}function Dm(t,o,n,r){var s=t.updateQueue;xa=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?i=u:a.next=u,a=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;a=0,f=u=c=null,l=i;do{var d=l.lane,p=l.eventTime;if((r&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,g=l;switch(d=o,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(p,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(p,h,d):m,d==null)break e;h=Gr({},h,d);break e;case 2:xa=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=p,c=h):f=f.next=p,a|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(f===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,o=s.shared.interleaved,o!==null){s=o;do a|=s.lane,s=s.next;while(s!==o)}else i===null&&(s.shared.lanes=0);Dl|=a,t.lanes=a,t.memoizedState=h}}function E_(t,o,n){if(t=o.effects,o.effects=null,t!==null)for(o=0;o<t.length;o++){var r=t[o],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Je(191,s));s.call(r)}}}var Nh={},oi=Ka(Nh),oh=Ka(Nh),sh=Ka(Nh);function _l(t){if(t===Nh)throw Error(Je(174));return t}function Ex(t,o){switch(wr(sh,o),wr(oh,t),wr(oi,Nh),t=o.nodeType,t){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ib(null,"");break;default:t=t===8?o.parentNode:o,o=t.namespaceURI||null,t=t.tagName,o=ib(o,t)}Or(oi),wr(oi,o)}function fu(){Or(oi),Or(oh),Or(sh)}function $P(t){_l(sh.current);var o=_l(oi.current),n=ib(o,t.type);o!==n&&(wr(oh,t),wr(oi,n))}function Cx(t){oh.current===t&&(Or(oi),Or(oh))}var $r=Ka(0);function Lm(t){for(var o=t;o!==null;){if(o.tag===13){var n=o.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var u0=[];function Px(){for(var t=0;t<u0.length;t++)u0[t]._workInProgressVersionPrimary=null;u0.length=0}var jp=Ki.ReactCurrentDispatcher,d0=Ki.ReactCurrentBatchConfig,Rl=0,zr=null,yn=null,Sn=null,Fm=!1,Rd=!1,ih=0,HD=0;function Bn(){throw Error(Je(321))}function Tx(t,o){if(o===null)return!1;for(var n=0;n<o.length&&n<t.length;n++)if(!Gs(t[n],o[n]))return!1;return!0}function kx(t,o,n,r,s,i){if(Rl=i,zr=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,jp.current=t===null||t.memoizedState===null?qD:KD,t=n(r,s),Rd){i=0;do{if(Rd=!1,ih=0,25<=i)throw Error(Je(301));i+=1,Sn=yn=null,o.updateQueue=null,jp.current=ZD,t=n(r,s)}while(Rd)}if(jp.current=Nm,o=yn!==null&&yn.next!==null,Rl=0,Sn=yn=zr=null,Fm=!1,o)throw Error(Je(300));return t}function Ix(){var t=ih!==0;return ih=0,t}function Zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?zr.memoizedState=Sn=t:Sn=Sn.next=t,Sn}function ys(){if(yn===null){var t=zr.alternate;t=t!==null?t.memoizedState:null}else t=yn.next;var o=Sn===null?zr.memoizedState:Sn.next;if(o!==null)Sn=o,yn=t;else{if(t===null)throw Error(Je(310));yn=t,t={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},Sn===null?zr.memoizedState=Sn=t:Sn=Sn.next=t}return Sn}function ah(t,o){return typeof o=="function"?o(t):o}function h0(t){var o=ys(),n=o.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var r=yn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,u=i;do{var f=u.lane;if((Rl&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=r):c=c.next=h,zr.lanes|=f,Dl|=f}u=u.next}while(u!==null&&u!==i);c===null?a=r:c.next=l,Gs(r,o.memoizedState)||(Po=!0),o.memoizedState=r,o.baseState=a,o.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,zr.lanes|=i,Dl|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[o.memoizedState,n.dispatch]}function f0(t){var o=ys(),n=o.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=o.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Gs(i,o.memoizedState)||(Po=!0),o.memoizedState=i,o.baseQueue===null&&(o.baseState=i),n.lastRenderedState=i}return[i,r]}function UP(){}function BP(t,o){var n=zr,r=ys(),s=o(),i=!Gs(r.memoizedState,s);if(i&&(r.memoizedState=s,Po=!0),r=r.queue,Mx(VP.bind(null,n,r,t),[t]),r.getSnapshot!==o||i||Sn!==null&&Sn.memoizedState.tag&1){if(n.flags|=2048,lh(9,GP.bind(null,n,r,s,o),void 0,null),jn===null)throw Error(Je(349));Rl&30||zP(n,o,s)}return s}function zP(t,o,n){t.flags|=16384,t={getSnapshot:o,value:n},o=zr.updateQueue,o===null?(o={lastEffect:null,stores:null},zr.updateQueue=o,o.stores=[t]):(n=o.stores,n===null?o.stores=[t]:n.push(t))}function GP(t,o,n,r){o.value=n,o.getSnapshot=r,HP(o)&&WP(t)}function VP(t,o,n){return n(function(){HP(o)&&WP(t)})}function HP(t){var o=t.getSnapshot;t=t.value;try{var n=o();return!Gs(t,n)}catch{return!0}}function WP(t){var o=Bi(t,1);o!==null&&$s(o,t,1,-1)}function C_(t){var o=Zs();return typeof t=="function"&&(t=t()),o.memoizedState=o.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ah,lastRenderedState:t},o.queue=t,t=t.dispatch=XD.bind(null,zr,t),[o.memoizedState,t]}function lh(t,o,n,r){return t={tag:t,create:o,destroy:n,deps:r,next:null},o=zr.updateQueue,o===null?(o={lastEffect:null,stores:null},zr.updateQueue=o,o.lastEffect=t.next=t):(n=o.lastEffect,n===null?o.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,o.lastEffect=t)),t}function YP(){return ys().memoizedState}function Ep(t,o,n,r){var s=Zs();zr.flags|=t,s.memoizedState=lh(1|o,n,void 0,r===void 0?null:r)}function Lg(t,o,n,r){var s=ys();r=r===void 0?null:r;var i=void 0;if(yn!==null){var a=yn.memoizedState;if(i=a.destroy,r!==null&&Tx(r,a.deps)){s.memoizedState=lh(o,n,i,r);return}}zr.flags|=t,s.memoizedState=lh(1|o,n,i,r)}function P_(t,o){return Ep(8390656,8,t,o)}function Mx(t,o){return Lg(2048,8,t,o)}function XP(t,o){return Lg(4,2,t,o)}function qP(t,o){return Lg(4,4,t,o)}function KP(t,o){if(typeof o=="function")return t=t(),o(t),function(){o(null)};if(o!=null)return t=t(),o.current=t,function(){o.current=null}}function ZP(t,o,n){return n=n!=null?n.concat([t]):null,Lg(4,4,KP.bind(null,o,t),n)}function Ox(){}function QP(t,o){var n=ys();o=o===void 0?null:o;var r=n.memoizedState;return r!==null&&o!==null&&Tx(o,r[1])?r[0]:(n.memoizedState=[t,o],t)}function JP(t,o){var n=ys();o=o===void 0?null:o;var r=n.memoizedState;return r!==null&&o!==null&&Tx(o,r[1])?r[0]:(t=t(),n.memoizedState=[t,o],t)}function eT(t,o,n){return Rl&21?(Gs(n,o)||(n=sP(),zr.lanes|=n,Dl|=n,t.baseState=!0),o):(t.baseState&&(t.baseState=!1,Po=!0),t.memoizedState=n)}function WD(t,o){var n=lr;lr=n!==0&&4>n?n:4,t(!0);var r=d0.transition;d0.transition={};try{t(!1),o()}finally{lr=n,d0.transition=r}}function tT(){return ys().memoizedState}function YD(t,o,n){var r=Da(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rT(t))nT(o,n);else if(n=FP(t,o,n,r),n!==null){var s=mo();$s(n,t,r,s),oT(n,o,r)}}function XD(t,o,n){var r=Da(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rT(t))nT(o,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=o.lastRenderedReducer,i!==null))try{var a=o.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Gs(l,a)){var c=o.interleaved;c===null?(s.next=s,_x(o)):(s.next=c.next,c.next=s),o.interleaved=s;return}}catch{}finally{}n=FP(t,o,s,r),n!==null&&(s=mo(),$s(n,t,r,s),oT(n,o,r))}}function rT(t){var o=t.alternate;return t===zr||o!==null&&o===zr}function nT(t,o){Rd=Fm=!0;var n=t.pending;n===null?o.next=o:(o.next=n.next,n.next=o),t.pending=o}function oT(t,o,n){if(n&4194240){var r=o.lanes;r&=t.pendingLanes,n|=r,o.lanes=n,cx(t,n)}}var Nm={readContext:gs,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},qD={readContext:gs,useCallback:function(t,o){return Zs().memoizedState=[t,o===void 0?null:o],t},useContext:gs,useEffect:P_,useImperativeHandle:function(t,o,n){return n=n!=null?n.concat([t]):null,Ep(4194308,4,KP.bind(null,o,t),n)},useLayoutEffect:function(t,o){return Ep(4194308,4,t,o)},useInsertionEffect:function(t,o){return Ep(4,2,t,o)},useMemo:function(t,o){var n=Zs();return o=o===void 0?null:o,t=t(),n.memoizedState=[t,o],t},useReducer:function(t,o,n){var r=Zs();return o=n!==void 0?n(o):o,r.memoizedState=r.baseState=o,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:o},r.queue=t,t=t.dispatch=YD.bind(null,zr,t),[r.memoizedState,t]},useRef:function(t){var o=Zs();return t={current:t},o.memoizedState=t},useState:C_,useDebugValue:Ox,useDeferredValue:function(t){return Zs().memoizedState=t},useTransition:function(){var t=C_(!1),o=t[0];return t=WD.bind(null,t[1]),Zs().memoizedState=t,[o,t]},useMutableSource:function(){},useSyncExternalStore:function(t,o,n){var r=zr,s=Zs();if(Lr){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=o(),jn===null)throw Error(Je(349));Rl&30||zP(r,o,n)}s.memoizedState=n;var i={value:n,getSnapshot:o};return s.queue=i,P_(VP.bind(null,r,i,t),[t]),r.flags|=2048,lh(9,GP.bind(null,r,i,n,o),void 0,null),n},useId:function(){var t=Zs(),o=jn.identifierPrefix;if(Lr){var n=Oi,r=Mi;n=(r&~(1<<32-Ns(r)-1)).toString(32)+n,o=":"+o+"R"+n,n=ih++,0<n&&(o+="H"+n.toString(32)),o+=":"}else n=HD++,o=":"+o+"r"+n.toString(32)+":";return t.memoizedState=o},unstable_isNewReconciler:!1},KD={readContext:gs,useCallback:QP,useContext:gs,useEffect:Mx,useImperativeHandle:ZP,useInsertionEffect:XP,useLayoutEffect:qP,useMemo:JP,useReducer:h0,useRef:YP,useState:function(){return h0(ah)},useDebugValue:Ox,useDeferredValue:function(t){var o=ys();return eT(o,yn.memoizedState,t)},useTransition:function(){var t=h0(ah)[0],o=ys().memoizedState;return[t,o]},useMutableSource:UP,useSyncExternalStore:BP,useId:tT,unstable_isNewReconciler:!1},ZD={readContext:gs,useCallback:QP,useContext:gs,useEffect:Mx,useImperativeHandle:ZP,useInsertionEffect:XP,useLayoutEffect:qP,useMemo:JP,useReducer:f0,useRef:YP,useState:function(){return f0(ah)},useDebugValue:Ox,useDeferredValue:function(t){var o=ys();return yn===null?o.memoizedState=t:eT(o,yn.memoizedState,t)},useTransition:function(){var t=f0(ah)[0],o=ys().memoizedState;return[t,o]},useMutableSource:UP,useSyncExternalStore:BP,useId:tT,unstable_isNewReconciler:!1};function Ts(t,o){if(t&&t.defaultProps){o=Gr({},o),t=t.defaultProps;for(var n in t)o[n]===void 0&&(o[n]=t[n]);return o}return o}function Pb(t,o,n,r){o=t.memoizedState,n=n(r,o),n=n==null?o:Gr({},o,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fg={isMounted:function(t){return(t=t._reactInternals)?Kl(t)===t:!1},enqueueSetState:function(t,o,n){t=t._reactInternals;var r=mo(),s=Da(t),i=Ri(r,s);i.payload=o,n!=null&&(i.callback=n),o=Aa(t,i,s),o!==null&&($s(o,t,s,r),_p(o,t,s))},enqueueReplaceState:function(t,o,n){t=t._reactInternals;var r=mo(),s=Da(t),i=Ri(r,s);i.tag=1,i.payload=o,n!=null&&(i.callback=n),o=Aa(t,i,s),o!==null&&($s(o,t,s,r),_p(o,t,s))},enqueueForceUpdate:function(t,o){t=t._reactInternals;var n=mo(),r=Da(t),s=Ri(n,r);s.tag=2,o!=null&&(s.callback=o),o=Aa(t,s,r),o!==null&&($s(o,t,r,n),_p(o,t,r))}};function T_(t,o,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):o.prototype&&o.prototype.isPureReactComponent?!eh(n,r)||!eh(s,i):!0}function sT(t,o,n){var r=!1,s=Ua,i=o.contextType;return typeof i=="object"&&i!==null?i=gs(i):(s=Mo(o)?Ol:Zn.current,r=o.contextTypes,i=(r=r!=null)?uu(t,s):Ua),o=new o(n,i),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Fg,t.stateNode=o,o._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),o}function k_(t,o,n,r){t=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(n,r),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(n,r),o.state!==t&&Fg.enqueueReplaceState(o,o.state,null)}function Tb(t,o,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},jx(t);var i=o.contextType;typeof i=="object"&&i!==null?s.context=gs(i):(i=Mo(o)?Ol:Zn.current,s.context=uu(t,i)),s.state=t.memoizedState,i=o.getDerivedStateFromProps,typeof i=="function"&&(Pb(t,o,i,n),s.state=t.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(o=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),o!==s.state&&Fg.enqueueReplaceState(s,s.state,null),Dm(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function pu(t,o){try{var n="",r=o;do n+=ER(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:o,stack:s,digest:null}}function p0(t,o,n){return{value:t,source:null,stack:n??null,digest:o??null}}function kb(t,o){try{console.error(o.value)}catch(n){setTimeout(function(){throw n})}}var QD=typeof WeakMap=="function"?WeakMap:Map;function iT(t,o,n){n=Ri(-1,n),n.tag=3,n.payload={element:null};var r=o.value;return n.callback=function(){Um||(Um=!0,$b=r),kb(t,o)},n}function aT(t,o,n){n=Ri(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=o.value;n.payload=function(){return r(s)},n.callback=function(){kb(t,o)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){kb(t,o),typeof r!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var a=o.stack;this.componentDidCatch(o.value,{componentStack:a!==null?a:""})}),n}function I_(t,o,n){var r=t.pingCache;if(r===null){r=t.pingCache=new QD;var s=new Set;r.set(o,s)}else s=r.get(o),s===void 0&&(s=new Set,r.set(o,s));s.has(n)||(s.add(n),t=hL.bind(null,t,o,n),o.then(t,t))}function M_(t){do{var o;if((o=t.tag===13)&&(o=t.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return t;t=t.return}while(t!==null);return null}function O_(t,o,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===o?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(o=Ri(-1,1),o.tag=2,Aa(n,o,1))),n.lanes|=1),t)}var JD=Ki.ReactCurrentOwner,Po=!1;function co(t,o,n,r){o.child=t===null?LP(o,null,n,r):hu(o,t.child,n,r)}function A_(t,o,n,r,s){n=n.render;var i=o.ref;return Jc(o,s),r=kx(t,o,n,r,i,s),n=Ix(),t!==null&&!Po?(o.updateQueue=t.updateQueue,o.flags&=-2053,t.lanes&=~s,zi(t,o,s)):(Lr&&n&&yx(o),o.flags|=1,co(t,o,r,s),o.child)}function R_(t,o,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Ux(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(o.tag=15,o.type=i,lT(t,o,i,r,s)):(t=kp(n.type,null,r,o,o.mode,s),t.ref=o.ref,t.return=o,o.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:eh,n(a,r)&&t.ref===o.ref)return zi(t,o,s)}return o.flags|=1,t=La(i,r),t.ref=o.ref,t.return=o,o.child=t}function lT(t,o,n,r,s){if(t!==null){var i=t.memoizedProps;if(eh(i,r)&&t.ref===o.ref)if(Po=!1,o.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Po=!0);else return o.lanes=t.lanes,zi(t,o,s)}return Ib(t,o,n,r,s)}function cT(t,o,n){var r=o.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},wr($c,Go),Go|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:t,cachePool:null,transitions:null},o.updateQueue=null,wr($c,Go),Go|=t,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,wr($c,Go),Go|=r}else i!==null?(r=i.baseLanes|n,o.memoizedState=null):r=n,wr($c,Go),Go|=r;return co(t,o,s,n),o.child}function uT(t,o){var n=o.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(o.flags|=512,o.flags|=2097152)}function Ib(t,o,n,r,s){var i=Mo(n)?Ol:Zn.current;return i=uu(o,i),Jc(o,s),n=kx(t,o,n,r,i,s),r=Ix(),t!==null&&!Po?(o.updateQueue=t.updateQueue,o.flags&=-2053,t.lanes&=~s,zi(t,o,s)):(Lr&&r&&yx(o),o.flags|=1,co(t,o,n,s),o.child)}function D_(t,o,n,r,s){if(Mo(n)){var i=!0;Im(o)}else i=!1;if(Jc(o,s),o.stateNode===null)Cp(t,o),sT(o,n,r),Tb(o,n,r,s),r=!0;else if(t===null){var a=o.stateNode,l=o.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=gs(u):(u=Mo(n)?Ol:Zn.current,u=uu(o,u));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==u)&&k_(o,a,r,u),xa=!1;var d=o.memoizedState;a.state=d,Dm(o,r,a,s),c=o.memoizedState,l!==r||d!==c||Io.current||xa?(typeof f=="function"&&(Pb(o,n,f,r),c=o.memoizedState),(l=xa||T_(o,n,l,r,d,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(o.flags|=4194308)):(typeof a.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=r,o.memoizedState=c),a.props=r,a.state=c,a.context=u,r=l):(typeof a.componentDidMount=="function"&&(o.flags|=4194308),r=!1)}else{a=o.stateNode,NP(t,o),l=o.memoizedProps,u=o.type===o.elementType?l:Ts(o.type,l),a.props=u,h=o.pendingProps,d=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=gs(c):(c=Mo(n)?Ol:Zn.current,c=uu(o,c));var p=n.getDerivedStateFromProps;(f=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||d!==c)&&k_(o,a,r,c),xa=!1,d=o.memoizedState,a.state=d,Dm(o,r,a,s);var m=o.memoizedState;l!==h||d!==m||Io.current||xa?(typeof p=="function"&&(Pb(o,n,p,r),m=o.memoizedState),(u=xa||T_(o,n,u,r,d,m,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,c)),typeof a.componentDidUpdate=="function"&&(o.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(o.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(o.flags|=1024),o.memoizedProps=r,o.memoizedState=m),a.props=r,a.state=m,a.context=c,r=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(o.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(o.flags|=1024),r=!1)}return Mb(t,o,n,r,i,s)}function Mb(t,o,n,r,s,i){uT(t,o);var a=(o.flags&128)!==0;if(!r&&!a)return s&&x_(o,n,!1),zi(t,o,i);r=o.stateNode,JD.current=o;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return o.flags|=1,t!==null&&a?(o.child=hu(o,t.child,null,i),o.child=hu(o,null,l,i)):co(t,o,l,i),o.memoizedState=r.state,s&&x_(o,n,!0),o.child}function dT(t){var o=t.stateNode;o.pendingContext?b_(t,o.pendingContext,o.pendingContext!==o.context):o.context&&b_(t,o.context,!1),Ex(t,o.containerInfo)}function L_(t,o,n,r,s){return du(),bx(s),o.flags|=256,co(t,o,n,r),o.child}var Ob={dehydrated:null,treeContext:null,retryLane:0};function Ab(t){return{baseLanes:t,cachePool:null,transitions:null}}function hT(t,o,n){var r=o.pendingProps,s=$r.current,i=!1,a=(o.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,o.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),wr($r,s&1),t===null)return Eb(o),t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(o.mode&1?t.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(a=r.children,t=r.fallback,i?(r=o.mode,i=o.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Ug(a,r,0,null),t=Il(t,r,n,null),i.return=o,t.return=o,i.sibling=t,o.child=i,o.child.memoizedState=Ab(n),o.memoizedState=Ob,t):Ax(o,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return eL(t,o,a,r,l,s,n);if(i){i=r.fallback,a=o.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&o.child!==s?(r=o.child,r.childLanes=0,r.pendingProps=c,o.deletions=null):(r=La(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=La(l,i):(i=Il(i,a,n,null),i.flags|=2),i.return=o,r.return=o,r.sibling=i,o.child=r,r=i,i=o.child,a=t.child.memoizedState,a=a===null?Ab(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,o.memoizedState=Ob,r}return i=t.child,t=i.sibling,r=La(i,{mode:"visible",children:r.children}),!(o.mode&1)&&(r.lanes=n),r.return=o,r.sibling=null,t!==null&&(n=o.deletions,n===null?(o.deletions=[t],o.flags|=16):n.push(t)),o.child=r,o.memoizedState=null,r}function Ax(t,o){return o=Ug({mode:"visible",children:o},t.mode,0,null),o.return=t,t.child=o}function kf(t,o,n,r){return r!==null&&bx(r),hu(o,t.child,null,n),t=Ax(o,o.pendingProps.children),t.flags|=2,o.memoizedState=null,t}function eL(t,o,n,r,s,i,a){if(n)return o.flags&256?(o.flags&=-257,r=p0(Error(Je(422))),kf(t,o,a,r)):o.memoizedState!==null?(o.child=t.child,o.flags|=128,null):(i=r.fallback,s=o.mode,r=Ug({mode:"visible",children:r.children},s,0,null),i=Il(i,s,a,null),i.flags|=2,r.return=o,i.return=o,r.sibling=i,o.child=r,o.mode&1&&hu(o,t.child,null,a),o.child.memoizedState=Ab(a),o.memoizedState=Ob,i);if(!(o.mode&1))return kf(t,o,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Je(419)),r=p0(i,r,void 0),kf(t,o,a,r)}if(l=(a&t.childLanes)!==0,Po||l){if(r=jn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Bi(t,s),$s(r,t,s,-1))}return $x(),r=p0(Error(Je(421))),kf(t,o,a,r)}return s.data==="$?"?(o.flags|=128,o.child=t.child,o=fL.bind(null,t),s._reactRetry=o,null):(t=i.treeContext,Xo=Oa(s.nextSibling),qo=o,Lr=!0,As=null,t!==null&&(us[ds++]=Mi,us[ds++]=Oi,us[ds++]=Al,Mi=t.id,Oi=t.overflow,Al=o),o=Ax(o,r.children),o.flags|=4096,o)}function F_(t,o,n){t.lanes|=o;var r=t.alternate;r!==null&&(r.lanes|=o),Cb(t.return,o,n)}function m0(t,o,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=o,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function fT(t,o,n){var r=o.pendingProps,s=r.revealOrder,i=r.tail;if(co(t,o,r.children,n),r=$r.current,r&2)r=r&1|2,o.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=o.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&F_(t,n,o);else if(t.tag===19)F_(t,n,o);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===o)break e;for(;t.sibling===null;){if(t.return===null||t.return===o)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(wr($r,r),!(o.mode&1))o.memoizedState=null;else switch(s){case"forwards":for(n=o.child,s=null;n!==null;)t=n.alternate,t!==null&&Lm(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=o.child,o.child=null):(s=n.sibling,n.sibling=null),m0(o,!1,s,n,i);break;case"backwards":for(n=null,s=o.child,o.child=null;s!==null;){if(t=s.alternate,t!==null&&Lm(t)===null){o.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}m0(o,!0,n,null,i);break;case"together":m0(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Cp(t,o){!(o.mode&1)&&t!==null&&(t.alternate=null,o.alternate=null,o.flags|=2)}function zi(t,o,n){if(t!==null&&(o.dependencies=t.dependencies),Dl|=o.lanes,!(n&o.childLanes))return null;if(t!==null&&o.child!==t.child)throw Error(Je(153));if(o.child!==null){for(t=o.child,n=La(t,t.pendingProps),o.child=n,n.return=o;t.sibling!==null;)t=t.sibling,n=n.sibling=La(t,t.pendingProps),n.return=o;n.sibling=null}return o.child}function tL(t,o,n){switch(o.tag){case 3:dT(o),du();break;case 5:$P(o);break;case 1:Mo(o.type)&&Im(o);break;case 4:Ex(o,o.stateNode.containerInfo);break;case 10:var r=o.type._context,s=o.memoizedProps.value;wr(Am,r._currentValue),r._currentValue=s;break;case 13:if(r=o.memoizedState,r!==null)return r.dehydrated!==null?(wr($r,$r.current&1),o.flags|=128,null):n&o.child.childLanes?hT(t,o,n):(wr($r,$r.current&1),t=zi(t,o,n),t!==null?t.sibling:null);wr($r,$r.current&1);break;case 19:if(r=(n&o.childLanes)!==0,t.flags&128){if(r)return fT(t,o,n);o.flags|=128}if(s=o.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wr($r,$r.current),r)break;return null;case 22:case 23:return o.lanes=0,cT(t,o,n)}return zi(t,o,n)}var pT,Rb,mT,gT;pT=function(t,o){for(var n=o.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break;for(;n.sibling===null;){if(n.return===null||n.return===o)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rb=function(){};mT=function(t,o,n,r){var s=t.memoizedProps;if(s!==r){t=o.stateNode,_l(oi.current);var i=null;switch(n){case"input":s=rb(t,s),r=rb(t,r),i=[];break;case"select":s=Gr({},s,{value:void 0}),r=Gr({},r,{value:void 0}),i=[];break;case"textarea":s=sb(t,s),r=sb(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Tm)}ab(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Yd.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Yd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&kr("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(o.updateQueue=u)&&(o.flags|=4)}};gT=function(t,o,n,r){n!==r&&(o.flags|=4)};function td(t,o){if(!Lr)switch(t.tailMode){case"hidden":o=t.tail;for(var n=null;o!==null;)o.alternate!==null&&(n=o),o=o.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?o||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function zn(t){var o=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(o)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,o}function rL(t,o,n){var r=o.pendingProps;switch(vx(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(o),null;case 1:return Mo(o.type)&&km(),zn(o),null;case 3:return r=o.stateNode,fu(),Or(Io),Or(Zn),Px(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Pf(o)?o.flags|=4:t===null||t.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,As!==null&&(zb(As),As=null))),Rb(t,o),zn(o),null;case 5:Cx(o);var s=_l(sh.current);if(n=o.type,t!==null&&o.stateNode!=null)mT(t,o,n,r,s),t.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!r){if(o.stateNode===null)throw Error(Je(166));return zn(o),null}if(t=_l(oi.current),Pf(o)){r=o.stateNode,n=o.type;var i=o.memoizedProps;switch(r[Js]=o,r[nh]=i,t=(o.mode&1)!==0,n){case"dialog":kr("cancel",r),kr("close",r);break;case"iframe":case"object":case"embed":kr("load",r);break;case"video":case"audio":for(s=0;s<wd.length;s++)kr(wd[s],r);break;case"source":kr("error",r);break;case"img":case"image":case"link":kr("error",r),kr("load",r);break;case"details":kr("toggle",r);break;case"input":Ww(r,i),kr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},kr("invalid",r);break;case"textarea":Xw(r,i),kr("invalid",r)}ab(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Cf(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Cf(r.textContent,l,t),s=["children",""+l]):Yd.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&kr("scroll",r)}switch(n){case"input":vf(r),Yw(r,i,!0);break;case"textarea":vf(r),qw(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Tm)}r=s,o.updateQueue=r,r!==null&&(o.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=VC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Js]=o,t[nh]=r,pT(t,o,!1,!1),o.stateNode=t;e:{switch(a=lb(n,r),n){case"dialog":kr("cancel",t),kr("close",t),s=r;break;case"iframe":case"object":case"embed":kr("load",t),s=r;break;case"video":case"audio":for(s=0;s<wd.length;s++)kr(wd[s],t);s=r;break;case"source":kr("error",t),s=r;break;case"img":case"image":case"link":kr("error",t),kr("load",t),s=r;break;case"details":kr("toggle",t),s=r;break;case"input":Ww(t,r),s=rb(t,r),kr("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Gr({},r,{value:void 0}),kr("invalid",t);break;case"textarea":Xw(t,r),s=sb(t,r),kr("invalid",t);break;default:s=r}ab(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?YC(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&HC(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Xd(t,c):typeof c=="number"&&Xd(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Yd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&kr("scroll",t):c!=null&&nx(t,i,c,a))}switch(n){case"input":vf(t),Yw(t,r,!1);break;case"textarea":vf(t),qw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+$a(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qc(t,!!r.multiple,i,!1):r.defaultValue!=null&&qc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Tm)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return zn(o),null;case 6:if(t&&o.stateNode!=null)gT(t,o,t.memoizedProps,r);else{if(typeof r!="string"&&o.stateNode===null)throw Error(Je(166));if(n=_l(sh.current),_l(oi.current),Pf(o)){if(r=o.stateNode,n=o.memoizedProps,r[Js]=o,(i=r.nodeValue!==n)&&(t=qo,t!==null))switch(t.tag){case 3:Cf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cf(r.nodeValue,n,(t.mode&1)!==0)}i&&(o.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Js]=o,o.stateNode=r}return zn(o),null;case 13:if(Or($r),r=o.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Lr&&Xo!==null&&o.mode&1&&!(o.flags&128))RP(),du(),o.flags|=98560,i=!1;else if(i=Pf(o),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Je(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Je(317));i[Js]=o}else du(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;zn(o),i=!1}else As!==null&&(zb(As),As=null),i=!0;if(!i)return o.flags&65536?o:null}return o.flags&128?(o.lanes=n,o):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(o.child.flags|=8192,o.mode&1&&(t===null||$r.current&1?vn===0&&(vn=3):$x())),o.updateQueue!==null&&(o.flags|=4),zn(o),null);case 4:return fu(),Rb(t,o),t===null&&th(o.stateNode.containerInfo),zn(o),null;case 10:return wx(o.type._context),zn(o),null;case 17:return Mo(o.type)&&km(),zn(o),null;case 19:if(Or($r),i=o.memoizedState,i===null)return zn(o),null;if(r=(o.flags&128)!==0,a=i.rendering,a===null)if(r)td(i,!1);else{if(vn!==0||t!==null&&t.flags&128)for(t=o.child;t!==null;){if(a=Lm(t),a!==null){for(o.flags|=128,td(i,!1),r=a.updateQueue,r!==null&&(o.updateQueue=r,o.flags|=4),o.subtreeFlags=0,r=n,n=o.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return wr($r,$r.current&1|2),o.child}t=t.sibling}i.tail!==null&&en()>mu&&(o.flags|=128,r=!0,td(i,!1),o.lanes=4194304)}else{if(!r)if(t=Lm(a),t!==null){if(o.flags|=128,r=!0,n=t.updateQueue,n!==null&&(o.updateQueue=n,o.flags|=4),td(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Lr)return zn(o),null}else 2*en()-i.renderingStartTime>mu&&n!==1073741824&&(o.flags|=128,r=!0,td(i,!1),o.lanes=4194304);i.isBackwards?(a.sibling=o.child,o.child=a):(n=i.last,n!==null?n.sibling=a:o.child=a,i.last=a)}return i.tail!==null?(o=i.tail,i.rendering=o,i.tail=o.sibling,i.renderingStartTime=en(),o.sibling=null,n=$r.current,wr($r,r?n&1|2:n&1),o):(zn(o),null);case 22:case 23:return Nx(),r=o.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(o.flags|=8192),r&&o.mode&1?Go&1073741824&&(zn(o),o.subtreeFlags&6&&(o.flags|=8192)):zn(o),null;case 24:return null;case 25:return null}throw Error(Je(156,o.tag))}function nL(t,o){switch(vx(o),o.tag){case 1:return Mo(o.type)&&km(),t=o.flags,t&65536?(o.flags=t&-65537|128,o):null;case 3:return fu(),Or(Io),Or(Zn),Px(),t=o.flags,t&65536&&!(t&128)?(o.flags=t&-65537|128,o):null;case 5:return Cx(o),null;case 13:if(Or($r),t=o.memoizedState,t!==null&&t.dehydrated!==null){if(o.alternate===null)throw Error(Je(340));du()}return t=o.flags,t&65536?(o.flags=t&-65537|128,o):null;case 19:return Or($r),null;case 4:return fu(),null;case 10:return wx(o.type._context),null;case 22:case 23:return Nx(),null;case 24:return null;default:return null}}var If=!1,Yn=!1,oL=typeof WeakSet=="function"?WeakSet:Set,pt=null;function Nc(t,o){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xr(t,o,r)}else n.current=null}function Db(t,o,n){try{n()}catch(r){Xr(t,o,r)}}var N_=!1;function sL(t,o){if(vb=Em,t=SP(),gx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==n||s!==0&&h.nodeType!==3||(l=a+s),h!==i||r!==0&&h.nodeType!==3||(c=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===n&&++u===s&&(l=a),d===i&&++f===r&&(c=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(bb={focusedElem:t,selectionRange:n},Em=!1,pt=o;pt!==null;)if(o=pt,t=o.child,(o.subtreeFlags&1028)!==0&&t!==null)t.return=o,pt=t;else for(;pt!==null;){o=pt;try{var m=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,b=m.memoizedState,y=o.stateNode,v=y.getSnapshotBeforeUpdate(o.elementType===o.type?g:Ts(o.type,g),b);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=o.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(S){Xr(o,o.return,S)}if(t=o.sibling,t!==null){t.return=o.return,pt=t;break}pt=o.return}return m=N_,N_=!1,m}function Dd(t,o,n){var r=o.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Db(o,n,i)}s=s.next}while(s!==r)}}function Ng(t,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var n=o=o.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==o)}}function Lb(t){var o=t.ref;if(o!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof o=="function"?o(t):o.current=t}}function yT(t){var o=t.alternate;o!==null&&(t.alternate=null,yT(o)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(o=t.stateNode,o!==null&&(delete o[Js],delete o[nh],delete o[wb],delete o[BD],delete o[zD])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function vT(t){return t.tag===5||t.tag===3||t.tag===4}function $_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||vT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Fb(t,o,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,o?n.nodeType===8?n.parentNode.insertBefore(t,o):n.insertBefore(t,o):(n.nodeType===8?(o=n.parentNode,o.insertBefore(t,n)):(o=n,o.appendChild(t)),n=n._reactRootContainer,n!=null||o.onclick!==null||(o.onclick=Tm));else if(r!==4&&(t=t.child,t!==null))for(Fb(t,o,n),t=t.sibling;t!==null;)Fb(t,o,n),t=t.sibling}function Nb(t,o,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,o?n.insertBefore(t,o):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Nb(t,o,n),t=t.sibling;t!==null;)Nb(t,o,n),t=t.sibling}var Tn=null,ks=!1;function fa(t,o,n){for(n=n.child;n!==null;)bT(t,o,n),n=n.sibling}function bT(t,o,n){if(ni&&typeof ni.onCommitFiberUnmount=="function")try{ni.onCommitFiberUnmount(Ig,n)}catch{}switch(n.tag){case 5:Yn||Nc(n,o);case 6:var r=Tn,s=ks;Tn=null,fa(t,o,n),Tn=r,ks=s,Tn!==null&&(ks?(t=Tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tn.removeChild(n.stateNode));break;case 18:Tn!==null&&(ks?(t=Tn,n=n.stateNode,t.nodeType===8?l0(t.parentNode,n):t.nodeType===1&&l0(t,n),Qd(t)):l0(Tn,n.stateNode));break;case 4:r=Tn,s=ks,Tn=n.stateNode.containerInfo,ks=!0,fa(t,o,n),Tn=r,ks=s;break;case 0:case 11:case 14:case 15:if(!Yn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Db(n,o,a),s=s.next}while(s!==r)}fa(t,o,n);break;case 1:if(!Yn&&(Nc(n,o),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xr(n,o,l)}fa(t,o,n);break;case 21:fa(t,o,n);break;case 22:n.mode&1?(Yn=(r=Yn)||n.memoizedState!==null,fa(t,o,n),Yn=r):fa(t,o,n);break;default:fa(t,o,n)}}function U_(t){var o=t.updateQueue;if(o!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new oL),o.forEach(function(r){var s=pL.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Ps(t,o){var n=o.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=o,l=a;e:for(;l!==null;){switch(l.tag){case 5:Tn=l.stateNode,ks=!1;break e;case 3:Tn=l.stateNode.containerInfo,ks=!0;break e;case 4:Tn=l.stateNode.containerInfo,ks=!0;break e}l=l.return}if(Tn===null)throw Error(Je(160));bT(i,a,s),Tn=null,ks=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Xr(s,o,u)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)xT(o,t),o=o.sibling}function xT(t,o){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ps(o,t),qs(t),r&4){try{Dd(3,t,t.return),Ng(3,t)}catch(g){Xr(t,t.return,g)}try{Dd(5,t,t.return)}catch(g){Xr(t,t.return,g)}}break;case 1:Ps(o,t),qs(t),r&512&&n!==null&&Nc(n,n.return);break;case 5:if(Ps(o,t),qs(t),r&512&&n!==null&&Nc(n,n.return),t.flags&32){var s=t.stateNode;try{Xd(s,"")}catch(g){Xr(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&zC(s,i),lb(l,a);var u=lb(l,i);for(a=0;a<c.length;a+=2){var f=c[a],h=c[a+1];f==="style"?YC(s,h):f==="dangerouslySetInnerHTML"?HC(s,h):f==="children"?Xd(s,h):nx(s,f,h,u)}switch(l){case"input":nb(s,i);break;case"textarea":GC(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?qc(s,!!i.multiple,p,!1):d!==!!i.multiple&&(i.defaultValue!=null?qc(s,!!i.multiple,i.defaultValue,!0):qc(s,!!i.multiple,i.multiple?[]:"",!1))}s[nh]=i}catch(g){Xr(t,t.return,g)}}break;case 6:if(Ps(o,t),qs(t),r&4){if(t.stateNode===null)throw Error(Je(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){Xr(t,t.return,g)}}break;case 3:if(Ps(o,t),qs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Qd(o.containerInfo)}catch(g){Xr(t,t.return,g)}break;case 4:Ps(o,t),qs(t);break;case 13:Ps(o,t),qs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Lx=en())),r&4&&U_(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Yn=(u=Yn)||f,Ps(o,t),Yn=u):Ps(o,t),qs(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(pt=t,f=t.child;f!==null;){for(h=pt=f;pt!==null;){switch(d=pt,p=d.child,d.tag){case 0:case 11:case 14:case 15:Dd(4,d,d.return);break;case 1:Nc(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,n=d.return;try{o=r,m.props=o.memoizedProps,m.state=o.memoizedState,m.componentWillUnmount()}catch(g){Xr(r,n,g)}}break;case 5:Nc(d,d.return);break;case 22:if(d.memoizedState!==null){z_(h);continue}}p!==null?(p.return=d,pt=p):z_(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=WC("display",a))}catch(g){Xr(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Xr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ps(o,t),qs(t),r&4&&U_(t);break;case 21:break;default:Ps(o,t),qs(t)}}function qs(t){var o=t.flags;if(o&2){try{e:{for(var n=t.return;n!==null;){if(vT(n)){var r=n;break e}n=n.return}throw Error(Je(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xd(s,""),r.flags&=-33);var i=$_(t);Nb(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=$_(t);Fb(t,l,a);break;default:throw Error(Je(161))}}catch(c){Xr(t,t.return,c)}t.flags&=-3}o&4096&&(t.flags&=-4097)}function iL(t,o,n){pt=t,ST(t)}function ST(t,o,n){for(var r=(t.mode&1)!==0;pt!==null;){var s=pt,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||If;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Yn;l=If;var u=Yn;if(If=a,(Yn=c)&&!u)for(pt=s;pt!==null;)a=pt,c=a.child,a.tag===22&&a.memoizedState!==null?G_(s):c!==null?(c.return=a,pt=c):G_(s);for(;i!==null;)pt=i,ST(i),i=i.sibling;pt=s,If=l,Yn=u}B_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,pt=i):B_(t)}}function B_(t){for(;pt!==null;){var o=pt;if(o.flags&8772){var n=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Yn||Ng(5,o);break;case 1:var r=o.stateNode;if(o.flags&4&&!Yn)if(n===null)r.componentDidMount();else{var s=o.elementType===o.type?n.memoizedProps:Ts(o.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=o.updateQueue;i!==null&&E_(o,i,r);break;case 3:var a=o.updateQueue;if(a!==null){if(n=null,o.child!==null)switch(o.child.tag){case 5:n=o.child.stateNode;break;case 1:n=o.child.stateNode}E_(o,a,n)}break;case 5:var l=o.stateNode;if(n===null&&o.flags&4){n=l;var c=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var u=o.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Qd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}Yn||o.flags&512&&Lb(o)}catch(d){Xr(o,o.return,d)}}if(o===t){pt=null;break}if(n=o.sibling,n!==null){n.return=o.return,pt=n;break}pt=o.return}}function z_(t){for(;pt!==null;){var o=pt;if(o===t){pt=null;break}var n=o.sibling;if(n!==null){n.return=o.return,pt=n;break}pt=o.return}}function G_(t){for(;pt!==null;){var o=pt;try{switch(o.tag){case 0:case 11:case 15:var n=o.return;try{Ng(4,o)}catch(c){Xr(o,n,c)}break;case 1:var r=o.stateNode;if(typeof r.componentDidMount=="function"){var s=o.return;try{r.componentDidMount()}catch(c){Xr(o,s,c)}}var i=o.return;try{Lb(o)}catch(c){Xr(o,i,c)}break;case 5:var a=o.return;try{Lb(o)}catch(c){Xr(o,a,c)}}}catch(c){Xr(o,o.return,c)}if(o===t){pt=null;break}var l=o.sibling;if(l!==null){l.return=o.return,pt=l;break}pt=o.return}}var aL=Math.ceil,$m=Ki.ReactCurrentDispatcher,Rx=Ki.ReactCurrentOwner,ps=Ki.ReactCurrentBatchConfig,Kt=0,jn=null,hn=null,An=0,Go=0,$c=Ka(0),vn=0,ch=null,Dl=0,$g=0,Dx=0,Ld=null,jo=null,Lx=0,mu=1/0,Pi=null,Um=!1,$b=null,Ra=null,Mf=!1,Ca=null,Bm=0,Fd=0,Ub=null,Pp=-1,Tp=0;function mo(){return Kt&6?en():Pp!==-1?Pp:Pp=en()}function Da(t){return t.mode&1?Kt&2&&An!==0?An&-An:VD.transition!==null?(Tp===0&&(Tp=sP()),Tp):(t=lr,t!==0||(t=window.event,t=t===void 0?16:hP(t.type)),t):1}function $s(t,o,n,r){if(50<Fd)throw Fd=0,Ub=null,Error(Je(185));Dh(t,n,r),(!(Kt&2)||t!==jn)&&(t===jn&&(!(Kt&2)&&($g|=n),vn===4&&wa(t,An)),Oo(t,r),n===1&&Kt===0&&!(o.mode&1)&&(mu=en()+500,Dg&&Za()))}function Oo(t,o){var n=t.callbackNode;VR(t,o);var r=jm(t,t===jn?An:0);if(r===0)n!==null&&Qw(n),t.callbackNode=null,t.callbackPriority=0;else if(o=r&-r,t.callbackPriority!==o){if(n!=null&&Qw(n),o===1)t.tag===0?GD(V_.bind(null,t)):MP(V_.bind(null,t)),$D(function(){!(Kt&6)&&Za()}),n=null;else{switch(iP(r)){case 1:n=lx;break;case 4:n=nP;break;case 16:n=_m;break;case 536870912:n=oP;break;default:n=_m}n=kT(n,wT.bind(null,t))}t.callbackPriority=o,t.callbackNode=n}}function wT(t,o){if(Pp=-1,Tp=0,Kt&6)throw Error(Je(327));var n=t.callbackNode;if(eu()&&t.callbackNode!==n)return null;var r=jm(t,t===jn?An:0);if(r===0)return null;if(r&30||r&t.expiredLanes||o)o=zm(t,r);else{o=r;var s=Kt;Kt|=2;var i=jT();(jn!==t||An!==o)&&(Pi=null,mu=en()+500,kl(t,o));do try{uL();break}catch(l){_T(t,l)}while(1);Sx(),$m.current=i,Kt=s,hn!==null?o=0:(jn=null,An=0,o=vn)}if(o!==0){if(o===2&&(s=fb(t),s!==0&&(r=s,o=Bb(t,s))),o===1)throw n=ch,kl(t,0),wa(t,r),Oo(t,en()),n;if(o===6)wa(t,r);else{if(s=t.current.alternate,!(r&30)&&!lL(s)&&(o=zm(t,r),o===2&&(i=fb(t),i!==0&&(r=i,o=Bb(t,i))),o===1))throw n=ch,kl(t,0),wa(t,r),Oo(t,en()),n;switch(t.finishedWork=s,t.finishedLanes=r,o){case 0:case 1:throw Error(Je(345));case 2:bl(t,jo,Pi);break;case 3:if(wa(t,r),(r&130023424)===r&&(o=Lx+500-en(),10<o)){if(jm(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){mo(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sb(bl.bind(null,t,jo,Pi),o);break}bl(t,jo,Pi);break;case 4:if(wa(t,r),(r&4194240)===r)break;for(o=t.eventTimes,s=-1;0<r;){var a=31-Ns(r);i=1<<a,a=o[a],a>s&&(s=a),r&=~i}if(r=s,r=en()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aL(r/1960))-r,10<r){t.timeoutHandle=Sb(bl.bind(null,t,jo,Pi),r);break}bl(t,jo,Pi);break;case 5:bl(t,jo,Pi);break;default:throw Error(Je(329))}}}return Oo(t,en()),t.callbackNode===n?wT.bind(null,t):null}function Bb(t,o){var n=Ld;return t.current.memoizedState.isDehydrated&&(kl(t,o).flags|=256),t=zm(t,o),t!==2&&(o=jo,jo=n,o!==null&&zb(o)),t}function zb(t){jo===null?jo=t:jo.push.apply(jo,t)}function lL(t){for(var o=t;;){if(o.flags&16384){var n=o.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Gs(i(),s))return!1}catch{return!1}}}if(n=o.child,o.subtreeFlags&16384&&n!==null)n.return=o,o=n;else{if(o===t)break;for(;o.sibling===null;){if(o.return===null||o.return===t)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function wa(t,o){for(o&=~Dx,o&=~$g,t.suspendedLanes|=o,t.pingedLanes&=~o,t=t.expirationTimes;0<o;){var n=31-Ns(o),r=1<<n;t[n]=-1,o&=~r}}function V_(t){if(Kt&6)throw Error(Je(327));eu();var o=jm(t,0);if(!(o&1))return Oo(t,en()),null;var n=zm(t,o);if(t.tag!==0&&n===2){var r=fb(t);r!==0&&(o=r,n=Bb(t,r))}if(n===1)throw n=ch,kl(t,0),wa(t,o),Oo(t,en()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=o,bl(t,jo,Pi),Oo(t,en()),null}function Fx(t,o){var n=Kt;Kt|=1;try{return t(o)}finally{Kt=n,Kt===0&&(mu=en()+500,Dg&&Za())}}function Ll(t){Ca!==null&&Ca.tag===0&&!(Kt&6)&&eu();var o=Kt;Kt|=1;var n=ps.transition,r=lr;try{if(ps.transition=null,lr=1,t)return t()}finally{lr=r,ps.transition=n,Kt=o,!(Kt&6)&&Za()}}function Nx(){Go=$c.current,Or($c)}function kl(t,o){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ND(n)),hn!==null)for(n=hn.return;n!==null;){var r=n;switch(vx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&km();break;case 3:fu(),Or(Io),Or(Zn),Px();break;case 5:Cx(r);break;case 4:fu();break;case 13:Or($r);break;case 19:Or($r);break;case 10:wx(r.type._context);break;case 22:case 23:Nx()}n=n.return}if(jn=t,hn=t=La(t.current,null),An=Go=o,vn=0,ch=null,Dx=$g=Dl=0,jo=Ld=null,wl!==null){for(o=0;o<wl.length;o++)if(n=wl[o],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}wl=null}return t}function _T(t,o){do{var n=hn;try{if(Sx(),jp.current=Nm,Fm){for(var r=zr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Fm=!1}if(Rl=0,Sn=yn=zr=null,Rd=!1,ih=0,Rx.current=null,n===null||n.return===null){vn=1,ch=o,hn=null;break}e:{var i=t,a=n.return,l=n,c=o;if(o=An,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=M_(a);if(p!==null){p.flags&=-257,O_(p,a,l,i,o),p.mode&1&&I_(i,u,o),o=p,c=u;var m=o.updateQueue;if(m===null){var g=new Set;g.add(c),o.updateQueue=g}else m.add(c);break e}else{if(!(o&1)){I_(i,u,o),$x();break e}c=Error(Je(426))}}else if(Lr&&l.mode&1){var b=M_(a);if(b!==null){!(b.flags&65536)&&(b.flags|=256),O_(b,a,l,i,o),bx(pu(c,l));break e}}i=c=pu(c,l),vn!==4&&(vn=2),Ld===null?Ld=[i]:Ld.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,o&=-o,i.lanes|=o;var y=iT(i,c,o);j_(i,y);break e;case 1:l=c;var v=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ra===null||!Ra.has(x)))){i.flags|=65536,o&=-o,i.lanes|=o;var S=aT(i,l,o);j_(i,S);break e}}i=i.return}while(i!==null)}CT(n)}catch(w){o=w,hn===n&&n!==null&&(hn=n=n.return);continue}break}while(1)}function jT(){var t=$m.current;return $m.current=Nm,t===null?Nm:t}function $x(){(vn===0||vn===3||vn===2)&&(vn=4),jn===null||!(Dl&268435455)&&!($g&268435455)||wa(jn,An)}function zm(t,o){var n=Kt;Kt|=2;var r=jT();(jn!==t||An!==o)&&(Pi=null,kl(t,o));do try{cL();break}catch(s){_T(t,s)}while(1);if(Sx(),Kt=n,$m.current=r,hn!==null)throw Error(Je(261));return jn=null,An=0,vn}function cL(){for(;hn!==null;)ET(hn)}function uL(){for(;hn!==null&&!DR();)ET(hn)}function ET(t){var o=TT(t.alternate,t,Go);t.memoizedProps=t.pendingProps,o===null?CT(t):hn=o,Rx.current=null}function CT(t){var o=t;do{var n=o.alternate;if(t=o.return,o.flags&32768){if(n=nL(n,o),n!==null){n.flags&=32767,hn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vn=6,hn=null;return}}else if(n=rL(n,o,Go),n!==null){hn=n;return}if(o=o.sibling,o!==null){hn=o;return}hn=o=t}while(o!==null);vn===0&&(vn=5)}function bl(t,o,n){var r=lr,s=ps.transition;try{ps.transition=null,lr=1,dL(t,o,n,r)}finally{ps.transition=s,lr=r}return null}function dL(t,o,n,r){do eu();while(Ca!==null);if(Kt&6)throw Error(Je(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(HR(t,i),t===jn&&(hn=jn=null,An=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Mf||(Mf=!0,kT(_m,function(){return eu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ps.transition,ps.transition=null;var a=lr;lr=1;var l=Kt;Kt|=4,Rx.current=null,sL(t,n),xT(n,t),MD(bb),Em=!!vb,bb=vb=null,t.current=n,iL(n),LR(),Kt=l,lr=a,ps.transition=i}else t.current=n;if(Mf&&(Mf=!1,Ca=t,Bm=s),i=t.pendingLanes,i===0&&(Ra=null),$R(n.stateNode),Oo(t,en()),o!==null)for(r=t.onRecoverableError,n=0;n<o.length;n++)s=o[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Um)throw Um=!1,t=$b,$b=null,t;return Bm&1&&t.tag!==0&&eu(),i=t.pendingLanes,i&1?t===Ub?Fd++:(Fd=0,Ub=t):Fd=0,Za(),null}function eu(){if(Ca!==null){var t=iP(Bm),o=ps.transition,n=lr;try{if(ps.transition=null,lr=16>t?16:t,Ca===null)var r=!1;else{if(t=Ca,Ca=null,Bm=0,Kt&6)throw Error(Je(331));var s=Kt;for(Kt|=4,pt=t.current;pt!==null;){var i=pt,a=i.child;if(pt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(pt=u;pt!==null;){var f=pt;switch(f.tag){case 0:case 11:case 15:Dd(8,f,i)}var h=f.child;if(h!==null)h.return=f,pt=h;else for(;pt!==null;){f=pt;var d=f.sibling,p=f.return;if(yT(f),f===u){pt=null;break}if(d!==null){d.return=p,pt=d;break}pt=p}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}pt=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,pt=a;else e:for(;pt!==null;){if(i=pt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Dd(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,pt=y;break e}pt=i.return}}var v=t.current;for(pt=v;pt!==null;){a=pt;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,pt=x;else e:for(a=v;pt!==null;){if(l=pt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ng(9,l)}}catch(w){Xr(l,l.return,w)}if(l===a){pt=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,pt=S;break e}pt=l.return}}if(Kt=s,Za(),ni&&typeof ni.onPostCommitFiberRoot=="function")try{ni.onPostCommitFiberRoot(Ig,t)}catch{}r=!0}return r}finally{lr=n,ps.transition=o}}return!1}function H_(t,o,n){o=pu(n,o),o=iT(t,o,1),t=Aa(t,o,1),o=mo(),t!==null&&(Dh(t,1,o),Oo(t,o))}function Xr(t,o,n){if(t.tag===3)H_(t,t,n);else for(;o!==null;){if(o.tag===3){H_(o,t,n);break}else if(o.tag===1){var r=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ra===null||!Ra.has(r))){t=pu(n,t),t=aT(o,t,1),o=Aa(o,t,1),t=mo(),o!==null&&(Dh(o,1,t),Oo(o,t));break}}o=o.return}}function hL(t,o,n){var r=t.pingCache;r!==null&&r.delete(o),o=mo(),t.pingedLanes|=t.suspendedLanes&n,jn===t&&(An&n)===n&&(vn===4||vn===3&&(An&130023424)===An&&500>en()-Lx?kl(t,0):Dx|=n),Oo(t,o)}function PT(t,o){o===0&&(t.mode&1?(o=Sf,Sf<<=1,!(Sf&130023424)&&(Sf=4194304)):o=1);var n=mo();t=Bi(t,o),t!==null&&(Dh(t,o,n),Oo(t,n))}function fL(t){var o=t.memoizedState,n=0;o!==null&&(n=o.retryLane),PT(t,n)}function pL(t,o){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Je(314))}r!==null&&r.delete(o),PT(t,n)}var TT;TT=function(t,o,n){if(t!==null)if(t.memoizedProps!==o.pendingProps||Io.current)Po=!0;else{if(!(t.lanes&n)&&!(o.flags&128))return Po=!1,tL(t,o,n);Po=!!(t.flags&131072)}else Po=!1,Lr&&o.flags&1048576&&OP(o,Om,o.index);switch(o.lanes=0,o.tag){case 2:var r=o.type;Cp(t,o),t=o.pendingProps;var s=uu(o,Zn.current);Jc(o,n),s=kx(null,o,r,t,s,n);var i=Ix();return o.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Mo(r)?(i=!0,Im(o)):i=!1,o.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jx(o),s.updater=Fg,o.stateNode=s,s._reactInternals=o,Tb(o,r,t,n),o=Mb(null,o,r,!0,i,n)):(o.tag=0,Lr&&i&&yx(o),co(null,o,s,n),o=o.child),o;case 16:r=o.elementType;e:{switch(Cp(t,o),t=o.pendingProps,s=r._init,r=s(r._payload),o.type=r,s=o.tag=gL(r),t=Ts(r,t),s){case 0:o=Ib(null,o,r,t,n);break e;case 1:o=D_(null,o,r,t,n);break e;case 11:o=A_(null,o,r,t,n);break e;case 14:o=R_(null,o,r,Ts(r.type,t),n);break e}throw Error(Je(306,r,""))}return o;case 0:return r=o.type,s=o.pendingProps,s=o.elementType===r?s:Ts(r,s),Ib(t,o,r,s,n);case 1:return r=o.type,s=o.pendingProps,s=o.elementType===r?s:Ts(r,s),D_(t,o,r,s,n);case 3:e:{if(dT(o),t===null)throw Error(Je(387));r=o.pendingProps,i=o.memoizedState,s=i.element,NP(t,o),Dm(o,r,null,n);var a=o.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},o.updateQueue.baseState=i,o.memoizedState=i,o.flags&256){s=pu(Error(Je(423)),o),o=L_(t,o,r,n,s);break e}else if(r!==s){s=pu(Error(Je(424)),o),o=L_(t,o,r,n,s);break e}else for(Xo=Oa(o.stateNode.containerInfo.firstChild),qo=o,Lr=!0,As=null,n=LP(o,null,r,n),o.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(du(),r===s){o=zi(t,o,n);break e}co(t,o,r,n)}o=o.child}return o;case 5:return $P(o),t===null&&Eb(o),r=o.type,s=o.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,xb(r,s)?a=null:i!==null&&xb(r,i)&&(o.flags|=32),uT(t,o),co(t,o,a,n),o.child;case 6:return t===null&&Eb(o),null;case 13:return hT(t,o,n);case 4:return Ex(o,o.stateNode.containerInfo),r=o.pendingProps,t===null?o.child=hu(o,null,r,n):co(t,o,r,n),o.child;case 11:return r=o.type,s=o.pendingProps,s=o.elementType===r?s:Ts(r,s),A_(t,o,r,s,n);case 7:return co(t,o,o.pendingProps,n),o.child;case 8:return co(t,o,o.pendingProps.children,n),o.child;case 12:return co(t,o,o.pendingProps.children,n),o.child;case 10:e:{if(r=o.type._context,s=o.pendingProps,i=o.memoizedProps,a=s.value,wr(Am,r._currentValue),r._currentValue=a,i!==null)if(Gs(i.value,a)){if(i.children===s.children&&!Io.current){o=zi(t,o,n);break e}}else for(i=o.child,i!==null&&(i.return=o);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ri(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Cb(i.return,n,o),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===o.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Je(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Cb(a,n,o),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===o){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}co(t,o,s.children,n),o=o.child}return o;case 9:return s=o.type,r=o.pendingProps.children,Jc(o,n),s=gs(s),r=r(s),o.flags|=1,co(t,o,r,n),o.child;case 14:return r=o.type,s=Ts(r,o.pendingProps),s=Ts(r.type,s),R_(t,o,r,s,n);case 15:return lT(t,o,o.type,o.pendingProps,n);case 17:return r=o.type,s=o.pendingProps,s=o.elementType===r?s:Ts(r,s),Cp(t,o),o.tag=1,Mo(r)?(t=!0,Im(o)):t=!1,Jc(o,n),sT(o,r,s),Tb(o,r,s,n),Mb(null,o,r,!0,t,n);case 19:return fT(t,o,n);case 22:return cT(t,o,n)}throw Error(Je(156,o.tag))};function kT(t,o){return rP(t,o)}function mL(t,o,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fs(t,o,n,r){return new mL(t,o,n,r)}function Ux(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gL(t){if(typeof t=="function")return Ux(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sx)return 11;if(t===ix)return 14}return 2}function La(t,o){var n=t.alternate;return n===null?(n=fs(t.tag,o,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=o,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,o=t.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kp(t,o,n,r,s,i){var a=2;if(r=t,typeof t=="function")Ux(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case kc:return Il(n.children,s,i,o);case ox:a=8,s|=8;break;case Qv:return t=fs(12,n,o,s|2),t.elementType=Qv,t.lanes=i,t;case Jv:return t=fs(13,n,o,s),t.elementType=Jv,t.lanes=i,t;case eb:return t=fs(19,n,o,s),t.elementType=eb,t.lanes=i,t;case $C:return Ug(n,s,i,o);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case FC:a=10;break e;case NC:a=9;break e;case sx:a=11;break e;case ix:a=14;break e;case ba:a=16,r=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return o=fs(a,n,o,s),o.elementType=t,o.type=r,o.lanes=i,o}function Il(t,o,n,r){return t=fs(7,t,r,o),t.lanes=n,t}function Ug(t,o,n,r){return t=fs(22,t,r,o),t.elementType=$C,t.lanes=n,t.stateNode={isHidden:!1},t}function g0(t,o,n){return t=fs(6,t,null,o),t.lanes=n,t}function y0(t,o,n){return o=fs(4,t.children!==null?t.children:[],t.key,o),o.lanes=n,o.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},o}function yL(t,o,n,r,s){this.tag=o,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zy(0),this.expirationTimes=Zy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zy(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Bx(t,o,n,r,s,i,a,l,c){return t=new yL(t,o,n,l,c),o===1?(o=1,i===!0&&(o|=8)):o=0,i=fs(3,null,null,o),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jx(i),t}function vL(t,o,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tc,key:r==null?null:""+r,children:t,containerInfo:o,implementation:n}}function IT(t){if(!t)return Ua;t=t._reactInternals;e:{if(Kl(t)!==t||t.tag!==1)throw Error(Je(170));var o=t;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Mo(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(Mo(n))return IP(t,n,o)}return o}function MT(t,o,n,r,s,i,a,l,c){return t=Bx(n,r,!0,t,s,i,a,l,c),t.context=IT(null),n=t.current,r=mo(),s=Da(n),i=Ri(r,s),i.callback=o??null,Aa(n,i,s),t.current.lanes=s,Dh(t,s,r),Oo(t,r),t}function Bg(t,o,n,r){var s=o.current,i=mo(),a=Da(s);return n=IT(n),o.context===null?o.context=n:o.pendingContext=n,o=Ri(i,a),o.payload={element:t},r=r===void 0?null:r,r!==null&&(o.callback=r),t=Aa(s,o,a),t!==null&&($s(t,s,a,i),_p(t,s,a)),a}function Gm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function W_(t,o){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<o?n:o}}function zx(t,o){W_(t,o),(t=t.alternate)&&W_(t,o)}function bL(){return null}var OT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gx(t){this._internalRoot=t}zg.prototype.render=Gx.prototype.render=function(t){var o=this._internalRoot;if(o===null)throw Error(Je(409));Bg(t,o,null,null)};zg.prototype.unmount=Gx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var o=t.containerInfo;Ll(function(){Bg(null,t,null,null)}),o[Ui]=null}};function zg(t){this._internalRoot=t}zg.prototype.unstable_scheduleHydration=function(t){if(t){var o=cP();t={blockedOn:null,target:t,priority:o};for(var n=0;n<Sa.length&&o!==0&&o<Sa[n].priority;n++);Sa.splice(n,0,t),n===0&&dP(t)}};function Vx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Gg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Y_(){}function xL(t,o,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Gm(a);i.call(u)}}var a=MT(o,r,t,0,null,!1,!1,"",Y_);return t._reactRootContainer=a,t[Ui]=a.current,th(t.nodeType===8?t.parentNode:t),Ll(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Gm(c);l.call(u)}}var c=Bx(t,0,!1,null,null,!1,!1,"",Y_);return t._reactRootContainer=c,t[Ui]=c.current,th(t.nodeType===8?t.parentNode:t),Ll(function(){Bg(o,c,n,r)}),c}function Vg(t,o,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Gm(a);l.call(c)}}Bg(o,a,t,s)}else a=xL(n,o,t,s,r);return Gm(a)}aP=function(t){switch(t.tag){case 3:var o=t.stateNode;if(o.current.memoizedState.isDehydrated){var n=Sd(o.pendingLanes);n!==0&&(cx(o,n|1),Oo(o,en()),!(Kt&6)&&(mu=en()+500,Za()))}break;case 13:Ll(function(){var r=Bi(t,1);if(r!==null){var s=mo();$s(r,t,1,s)}}),zx(t,1)}};ux=function(t){if(t.tag===13){var o=Bi(t,134217728);if(o!==null){var n=mo();$s(o,t,134217728,n)}zx(t,134217728)}};lP=function(t){if(t.tag===13){var o=Da(t),n=Bi(t,o);if(n!==null){var r=mo();$s(n,t,o,r)}zx(t,o)}};cP=function(){return lr};uP=function(t,o){var n=lr;try{return lr=t,o()}finally{lr=n}};ub=function(t,o,n){switch(o){case"input":if(nb(t,n),o=n.name,n.type==="radio"&&o!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<n.length;o++){var r=n[o];if(r!==t&&r.form===t.form){var s=Rg(r);if(!s)throw Error(Je(90));BC(r),nb(r,s)}}}break;case"textarea":GC(t,n);break;case"select":o=n.value,o!=null&&qc(t,!!n.multiple,o,!1)}};KC=Fx;ZC=Ll;var SL={usingClientEntryPoint:!1,Events:[Fh,Ac,Rg,XC,qC,Fx]},rd={findFiberByHostInstance:Sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wL={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=eP(t),t===null?null:t.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||bL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{Ig=Of.inject(wL),ni=Of}catch{}}rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SL;rs.createPortal=function(t,o){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vx(o))throw Error(Je(200));return vL(t,o,null,n)};rs.createRoot=function(t,o){if(!Vx(t))throw Error(Je(299));var n=!1,r="",s=OT;return o!=null&&(o.unstable_strictMode===!0&&(n=!0),o.identifierPrefix!==void 0&&(r=o.identifierPrefix),o.onRecoverableError!==void 0&&(s=o.onRecoverableError)),o=Bx(t,1,!1,null,null,n,!1,r,s),t[Ui]=o.current,th(t.nodeType===8?t.parentNode:t),new Gx(o)};rs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var o=t._reactInternals;if(o===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=eP(o),t=t===null?null:t.stateNode,t};rs.flushSync=function(t){return Ll(t)};rs.hydrate=function(t,o,n){if(!Gg(o))throw Error(Je(200));return Vg(null,t,o,!0,n)};rs.hydrateRoot=function(t,o,n){if(!Vx(t))throw Error(Je(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=OT;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),o=MT(o,null,t,1,n??null,s,!1,i,a),t[Ui]=o.current,th(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[n,s]:o.mutableSourceEagerHydrationData.push(n,s);return new zg(o)};rs.render=function(t,o,n){if(!Gg(o))throw Error(Je(200));return Vg(null,t,o,!1,n)};rs.unmountComponentAtNode=function(t){if(!Gg(t))throw Error(Je(40));return t._reactRootContainer?(Ll(function(){Vg(null,null,t,!1,function(){t._reactRootContainer=null,t[Ui]=null})}),!0):!1};rs.unstable_batchedUpdates=Fx;rs.unstable_renderSubtreeIntoContainer=function(t,o,n,r){if(!Gg(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return Vg(t,o,n,!1,r)};rs.version="18.3.1-next-f1338f8080-20240426";function AT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(AT)}catch(t){console.error(t)}}AT(),AC.exports=rs;var Zl=AC.exports;const _L=Xl(Zl);var RT,X_=Zl;RT=Kv.createRoot=X_.createRoot,Kv.hydrateRoot=X_.hydrateRoot;async function jL(t,o){const{url:n,style:r="normal",weight:s="500",display:i,featureSettings:a,stretch:l,unicodeRange:c,variant:u,format:f}=o,h={style:r,weight:s,display:i,featureSettings:a,stretch:l,unicodeRange:c,variant:u},d=new FontFace(t,`url(${n})`,h);return await d.load(),document.fonts.add(d),d.$$_url=n,d.$$_fontface=`
@font-face {
	font-family: ${d.family};
	font-stretch: ${d.stretch};
	font-weight: ${d.weight};
	font-style: ${d.style};
	src: url("${n}") format("${f}")
}`,d}function DT(t){return t&&typeof t=="object"&&"parents"in t}function LT(t){for(let o=0,n=t.parents.length;o<n;o++)if(t.parents[o].__unsafe__getWithoutCapture(!0),t.parents[o].lastChangedEpoch!==t.parentEpochs[o])return!0;return!1}const Vm=(t,o)=>{if(t.children.remove(o)&&t.children.isEmpty&&DT(t))for(let n=0,r=t.parents.length;n<r;n++)Vm(t.parents[n],t)},Hx=(t,o)=>{if(t.children.add(o)&&DT(t))for(let n=0,r=t.parents.length;n<r;n++)Hx(t.parents[n],t)};function FT(t,o){return t===o||Object.is(t,o)||!!(t&&o&&typeof t.equals=="function"&&t.equals(o))}function Qa(t,o){const n=Symbol.for(`com.tldraw.state/${t}`),r=globalThis;return r[n]??(r[n]=o()),r[n]}const Di=Qa("empty_array",()=>Object.freeze([])),q_=8;class Hm{constructor(){D(this,"arraySize",0);D(this,"array",Array(q_));D(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(o){if(this.array)return this.array.indexOf(o)!==-1?!1:this.arraySize<q_?(this.array[this.arraySize]=o,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(o),!0);if(this.set)return this.set.has(o)?!1:(this.set.add(o),!0);throw new Error("no set or array")}remove(o){if(this.array){const n=this.array.indexOf(o);return n===-1?!1:(this.array[n]=void 0,this.arraySize--,n!==this.arraySize&&(this.array[n]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(o)?(this.set.delete(o),!0):!1;throw new Error("no set or array")}visit(o){if(this.array){for(let n=0;n<this.arraySize;n++){const r=this.array[n];typeof r<"u"&&o(r)}return}if(this.set){this.set.forEach(o);return}throw new Error("no set or array")}has(o){return this.array?this.array.indexOf(o)!==-1:this.set.has(o)}clear(){this.set?this.set.clear():(this.arraySize=0,this.array=[])}size(){return this.set?this.set.size:this.arraySize}}const Ko=Symbol.for("com.tldraw.state/RESET_VALUE");class NT{constructor(o){D(this,"index",0);D(this,"buffer");this.capacity=o,this.buffer=new Array(o)}pushEntry(o,n,r){if(r!==void 0){if(r===Ko){this.clear();return}this.buffer[this.index]=[o,n,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(o){const{index:n,capacity:r,buffer:s}=this;for(let i=0;i<r;i++){const a=(n-1+r-i)%r,l=s[a];if(!l)return Ko;const[c,u]=l;if(i===0&&o>=u)return[];if(c<=o&&o<u){const f=i+1,h=new Array(f);for(let d=0;d<f;d++)h[d]=s[(a+d)%r][2];return h}}return Ko}}class EL{constructor(o,n){D(this,"offset",0);D(this,"maybeRemoved");this.below=o,this.child=n}}const Jr=Qa("capture",()=>({stack:null}));function $T(t){Jr.stack=new EL(Jr.stack,t),t.parentSet.clear()}function UT(){const t=Jr.stack;if(Jr.stack=t.below,t.offset<t.child.parents.length){for(let o=t.offset;o<t.child.parents.length;o++){const n=t.child.parents[o];t.child.parentSet.has(n)||Vm(n,t.child)}t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset}if(t.maybeRemoved)for(let o=0;o<t.maybeRemoved.length;o++){const n=t.maybeRemoved[o];t.child.parentSet.has(n)||Vm(n,t.child)}}function Wm(t){if(Jr.stack){if(Jr.stack.child.parentSet.has(t))return;if(Jr.stack.child.parentSet.add(t),Jr.stack.child.isActivelyListening&&Hx(t,Jr.stack.child),Jr.stack.offset<Jr.stack.child.parents.length){const n=Jr.stack.child.parents[Jr.stack.offset];n!==t&&(Jr.stack.maybeRemoved?Jr.stack.maybeRemoved.push(n):Jr.stack.maybeRemoved=[n])}Jr.stack.child.parents[Jr.stack.offset]=t,Jr.stack.child.parentEpochs[Jr.stack.offset]=t.lastChangedEpoch,Jr.stack.offset++}}const jl=-1;class CL{constructor(o,n,r){D(this,"_isActivelyListening",!1);D(this,"lastTraversedEpoch",jl);D(this,"lastReactedEpoch",jl);D(this,"_scheduleCount",0);D(this,"parentSet",new Hm);D(this,"parentEpochs",[]);D(this,"parents",[]);D(this,"_scheduleEffect");D(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=o,this.runEffect=n,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==uo()){if(this.parents.length&&!LT(this)){this.lastReactedEpoch=uo();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let o=0,n=this.parents.length;o<n;o++)Hx(this.parents[o],this)}detach(){this._isActivelyListening=!1;for(let o=0,n=this.parents.length;o<n;o++)Vm(this.parents[o],this)}execute(){try{$T(this);const o=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=uo(),o}finally{UT()}}}const Tu=Qa("EffectScheduler",()=>CL);function ku(t,o,n){const r=new Tu(t,o,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function PL(t,o,n){const r=new Tu(t,o,n);return{scheduler:r,start:s=>{const i=(s==null?void 0:s.force)??!1;r.attach(),i?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class TL{constructor(o){D(this,"initialAtomValues",new Map);this.parent=o}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const o=this.initialAtomValues;this.initialAtomValues=new Map,BT(o.keys())}else this.initialAtomValues.forEach((o,n)=>{this.parent.initialAtomValues.has(n)||this.parent.initialAtomValues.set(n,o)})}abort(){Xn.globalEpoch++,this.initialAtomValues.forEach((o,n)=>{var r;n.set(o),(r=n.historyBuffer)==null||r.clear()}),this.commit()}}const Xn=Qa("transactions",()=>({globalEpoch:jl+1,globalIsReacting:!1,currentTransaction:null}));function uo(){return Xn.globalEpoch}function BT(t){if(Xn.globalIsReacting)throw new Error("cannot change atoms during reaction cycle");try{Xn.globalIsReacting=!0;const o=new Set,n=r=>{r.lastTraversedEpoch!==Xn.globalEpoch&&(r.lastTraversedEpoch=Xn.globalEpoch,r instanceof Tu?o.add(r):r.children.visit(n))};for(const r of t)r.children.visit(n);for(const r of o)r.maybeScheduleEffect()}finally{Xn.globalIsReacting=!1}}function kL(t,o){Xn.currentTransaction?Xn.currentTransaction.initialAtomValues.has(t)||Xn.currentTransaction.initialAtomValues.set(t,o):BT([t])}function IL(){Xn.globalEpoch++}function ML(t){const o=new TL(Xn.currentTransaction);Xn.currentTransaction=o;try{let n=!1;const r=t(()=>n=!0);return n?o.abort():o.commit(),r}catch(n){throw o.abort(),n}finally{Xn.currentTransaction=Xn.currentTransaction.parent}}function Rs(t){return Xn.currentTransaction?t():ML(t)}class OL{constructor(o,n,r){D(this,"isEqual");D(this,"computeDiff");D(this,"lastChangedEpoch",uo());D(this,"children",new Hm);D(this,"historyBuffer");this.name=o,this.current=n,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new NT(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(o){return this.current}get(){return Wm(this),this.current}set(o,n){var s,i;if(((s=this.isEqual)==null?void 0:s.call(this,this.current,o))??FT(this.current,o))return this.current;IL(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,uo(),n??((i=this.computeDiff)==null?void 0:i.call(this,this.current,o,this.lastChangedEpoch,uo()))??Ko),this.lastChangedEpoch=uo();const r=this.current;return this.current=o,kL(this,r),o}update(o){return this.set(o(this.current))}getDiffSince(o){var n;return Wm(this),o>=this.lastChangedEpoch?Di:((n=this.historyBuffer)==null?void 0:n.getChangesSince(o))??Ko}}const AL=Qa("Atom",()=>OL);function po(t,o,n){return new AL(t,o,n)}let K_=!1;function RL(){K_||(K_=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const _d=Symbol.for("com.tldraw.state/UNINITIALIZED"),Ml=t=>t===_d,Gb=Qa("WithDiff",()=>class{constructor(o,n){this.value=o,this.diff=n}});function jd(t,o){return new Gb(t,o)}class DL{constructor(o,n,r){D(this,"lastChangedEpoch",jl);D(this,"lastTraversedEpoch",jl);D(this,"lastCheckedEpoch",jl);D(this,"parentSet",new Hm);D(this,"parents",[]);D(this,"parentEpochs",[]);D(this,"children",new Hm);D(this,"historyBuffer");D(this,"state",_d);D(this,"error",null);D(this,"computeDiff");D(this,"isEqual");this.name=o,this.derive=n,r!=null&&r.historyLength&&(this.historyBuffer=new NT(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??FT}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(o){var r;if(!(this.lastChangedEpoch===jl)&&(this.lastCheckedEpoch===uo()||!LT(this)))if(this.lastCheckedEpoch=uo(),this.error){if(o)return this.state;throw this.error.thrownValue}else return this.state;try{$T(this);const s=this.derive(this.state,this.lastCheckedEpoch),i=s instanceof Gb?s.value:s,a=this.state===_d;if(a||!this.isEqual(i,this.state)){if(this.historyBuffer&&!a){const l=s instanceof Gb?s.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,uo(),l??((r=this.computeDiff)==null?void 0:r.call(this,this.state,i,this.lastCheckedEpoch,uo()))??Ko)}this.lastChangedEpoch=uo(),this.state=i}return this.error=null,this.lastCheckedEpoch=uo(),this.state}catch(s){if(this.state!==_d&&(this.state=_d,this.lastChangedEpoch=uo()),this.lastCheckedEpoch=uo(),this.historyBuffer&&this.historyBuffer.clear(),this.error={thrownValue:s},!o)throw s;return this.state}finally{UT()}}get(){try{return this.__unsafe__getWithoutCapture()}finally{Wm(this)}}getDiffSince(o){var n;return this.__unsafe__getWithoutCapture(!0),Wm(this),o>=this.lastChangedEpoch?Di:((n=this.historyBuffer)==null?void 0:n.getChangesSince(o))??Ko}}const Wx=Qa("Computed",()=>DL);function LL(t={},o,n,r){const s=r.value,i=Symbol.for("__@tldraw/state__computed__"+n);return r.value=function(){let a=this[i];return a||(a=new Wx(n,s.bind(this),t),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:a})),a.get()},r.value[NL]=!0,r}function Z_(t={},o,n,r){return r.get?(RL(),FL(t,o,n,r)):LL(t,o,n,r)}function FL(t={},o,n,r){const s=r.get,i=Symbol.for("__@tldraw/state__computed__"+n);return r.get=function(){let a=this[i];return a||(a=new Wx(n,s.bind(this),t),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:a})),a.get()},r}const NL="@@__isComputedMethod__@@";function Xe(){if(arguments.length===1){const t=arguments[0];return(o,n,r)=>Z_(t,o,n,r)}else return typeof arguments[0]=="string"?new Wx(arguments[0],arguments[1],arguments[2]):Z_(void 0,arguments[0],arguments[1],arguments[2])}const zT=1,$L=Qa("apiVersion",()=>zT);if($L!==zT)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");function Hg(t,o){const n=Ut.useRef(o);n.current=o;const[r,s,i]=Ut.useMemo(()=>{let a=null;const l=f=>(a=f,()=>{a=null}),c=new Tu(`useStateTracking(${t})`,()=>{var f;return(f=n.current)==null?void 0:f.call(n)},{scheduleEffect(){a==null||a()}});return[c,l,()=>c.scheduleCount]},[t]);return Ut.useSyncExternalStore(s,i,i),Ut.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const Q_={apply(t,o,n){return Hg(t.displayName??t.name??"tracked(???)",()=>t.apply(o,n))}},UL=Symbol.for("react.memo"),BL=Symbol.for("react.forward_ref");function os(t){let o=null;const n=t.$$typeof;return n===UL&&(t=t.type,o=t.compare),n===BL?B.memo(B.forwardRef(new Proxy(t.render,Q_))):B.memo(new Proxy(t,Q_),o)}function zL(){const t=arguments[0],o=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return B.useMemo(()=>Xe(`useComputed(${t})`,o,n),r)}function Fa(t,o,n=Di){B.useEffect(()=>{const r=new Tu(t,o);return r.attach(),r.execute(),()=>{r.detach()}},n)}function He(){const t=arguments,o=t.length===3?t[2]:[t[0]],n=t.length===3?t[0]:`useValue(${t[0].name})`,r=B.useRef(!0);r.current=!0;const s=B.useMemo(()=>t.length===1?t[0]:Xe(n,()=>{if(r.current)return t[1]();try{return t[1]()}catch{return{}}}),o);try{const{subscribe:i,getSnapshot:a}=B.useMemo(()=>({subscribe:l=>ku(`useValue(${n})`,()=>{s.get(),l()}),getSnapshot:()=>s.get()}),[s]);return B.useSyncExternalStore(i,a,a)}finally{r.current=!1}}class Ip{constructor(o){D(this,"nextValue");D(this,"diff");this.previousValue=o}get(){var r,s,i,a;const o=((s=(r=this.diff)==null?void 0:r.removed)==null?void 0:s.size)??0,n=((a=(i=this.diff)==null?void 0:i.added)==null?void 0:a.size)??0;if(!(o===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(o,n){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(o),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(o):((s=this.diff).added??(s.added=new Set),this.diff.added.add(o))}add(o){var s,i,a;const n=this.previousValue.has(o);if(n)return((i=(s=this.diff)==null?void 0:s.removed)==null?void 0:i.has(o))?this._add(o,n):void 0;(a=this.nextValue)!=null&&a.has(o)||this._add(o,n)}_remove(o,n){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(o),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(o)):(s=this.diff.added)==null||s.delete(o)}remove(o){var s,i,a,l;const n=this.previousValue.has(o);if(!n)return((i=(s=this.diff)==null?void 0:s.added)==null?void 0:i.has(o))?this._remove(o,n):void 0;(l=(a=this.diff)==null?void 0:a.removed)!=null&&l.has(o)||this._remove(o,n)}}function Ym(t,o){const n=[];e:for(const r of t){for(const s of n)if(o?o(r,s):r===s)continue e;n.push(r)}return n}function Rt(t){return t.filter(o=>o!=null)}function Ho(t){return t[t.length-1]}function GL(t,o){let n,r=1/0;for(const s of t){const i=o(s);i<r&&(n=s,r=i)}return n}function VL(t,o){if(t===o)return!0;if(t.length!==o.length)return!1;for(let n=0;n<t.length;n++)if(!Object.is(t[n],o[n]))return!1;return!0}function HL(t,o){let n,r;return function(...s){return n||(n=!0,setTimeout(()=>n=!1,o),r=t(...s)),r}}function GT(t){const o=(...n)=>{try{return t(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,o),r}};return o}const tu={ok(t){return{ok:!0,value:t}},err(t){return{ok:!1,error:t}}};function Zi(t,o){const n=o&&t&&typeof t=="object"&&o in t?t[o]:t;throw new Error(`Unknown switch case ${n}`)}const bn=GT((t,o)=>{if(!t)throw new Error(o||"Assertion Error")}),El=GT((t,o)=>{if(t==null)throw new Error(o??"value must be defined");return t});function VT(t,o){let n;const r=(...s)=>(n||(n={},n.promise=new Promise((i,a)=>{n.resolve=i,n.reject=a})),clearTimeout(n.timeout),n.latestArgs=s,n.timeout=setTimeout(()=>{const i=n;n=void 0;try{i.resolve(t(...i.latestArgs))}catch(a){i.reject(a)}},o),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const J_=new WeakMap;function Yx(t,o){if(typeof t!="object"||t===null)return;let n=J_.get(t);n||(n={tags:{},extras:{}},J_.set(t,n)),o.tags&&(n.tags={...n.tags,...o.tags}),o.extras&&(n.extras={...n.extras,...o.extras})}class ru{static async dataUrlToArrayBuffer(o){return fetch(o).then(function(n){return n.arrayBuffer()})}static async blobToDataUrl(o){return await new Promise((n,r)=>{if(o){const s=new FileReader;s.onload=()=>n(s.result),s.onerror=i=>r(i),s.onabort=i=>r(i),s.readAsDataURL(o)}})}static async blobToText(o){return await new Promise((n,r)=>{if(o){const s=new FileReader;s.onload=()=>n(s.result),s.onerror=i=>r(i),s.onabort=i=>r(i),s.readAsText(o)}})}}function Vb(t){let o=0;for(let n=0;n<t.length;n++)o=(o<<5)-o+t.charCodeAt(n),o|=0;return o+""}function WL(t){const o=new DataView(t);let n=0;for(let r=0;r<o.byteLength;r++)n=(n<<5)-n+o.getUint8(r),n|=0;return n+""}let Hb=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(Hb=new Int32Array(Hb));const YL=(t,o)=>{let n=o===0?0:~~o^-1;for(let r=0;r<t.length;r++)n=Hb[(n^t[r])&255]^n>>>8;return n^-1},e2=4,t2=4;class ei{static isPng(o,n){return o.getUint8(n+0)===137&&o.getUint8(n+1)===80&&o.getUint8(n+2)===78&&o.getUint8(n+3)===71&&o.getUint8(n+4)===13&&o.getUint8(n+5)===10&&o.getUint8(n+6)===26&&o.getUint8(n+7)===10}static getChunkType(o,n){return[String.fromCharCode(o.getUint8(n)),String.fromCharCode(o.getUint8(n+1)),String.fromCharCode(o.getUint8(n+2)),String.fromCharCode(o.getUint8(n+3))].join("")}static readChunks(o,n=0){const r={};if(!ei.isPng(o,n))throw new Error("Not a PNG");for(n+=8;n<=o.buffer.byteLength;){const s=n,i=o.getInt32(n);n+=4;const a=ei.getChunkType(o,n);if(a==="IDAT"&&r[a]){n+=i+e2+t2;continue}if(a==="IEND")break;r[a]={start:s,dataOffset:n+4,size:i},n+=i+e2+t2}return r}static parsePhys(o,n){return{ppux:o.getUint32(n),ppuy:o.getUint32(n+4),unit:o.getUint8(n+4)}}static findChunk(o,n){return ei.readChunks(o)[n]}static setPhysChunk(o,n=1,r){let s=46,i=0;const a=ei.findChunk(o,"pHYs");a&&(s=a.start,i=a.size);const l=ei.findChunk(o,"IDAT");l&&(s=l.start,i=0);const c=new ArrayBuffer(21),u=new DataView(c);u.setUint32(0,9),u.setUint8(4,"p".charCodeAt(0)),u.setUint8(5,"H".charCodeAt(0)),u.setUint8(6,"Y".charCodeAt(0)),u.setUint8(7,"s".charCodeAt(0));const f=2835.5;u.setInt32(8,f*n),u.setInt32(12,f*n),u.setInt8(16,1);const h=new Uint8Array(c.slice(4,17));u.setInt32(17,YL(h));const d=o.buffer.slice(0,s),p=o.buffer.slice(s+i);return new Blob([d,c,p],r)}}class Ai{static loadVideo(o){return new Promise((n,r)=>{const s=document.createElement("video");s.onloadeddata=()=>n(s),s.onerror=i=>{console.error(i),r(new Error("Could not load video"))},s.crossOrigin="anonymous",s.src=o})}static loadImage(o){return new Promise((n,r)=>{const s=new Image;s.onload=()=>n(s),s.onerror=i=>{console.error(i),r(new Error("Could not load image"))},s.crossOrigin="anonymous",s.src=o})}static async getVideoSize(o){return Ai.usingObjectURL(o,async n=>{const r=await Ai.loadVideo(n);return{w:r.videoWidth,h:r.videoHeight}})}static async getImageSize(o){const n=await Ai.usingObjectURL(o,Ai.loadImage);try{if(o.type==="image/png"){const r=new DataView(await o.arrayBuffer());if(ei.isPng(r,0)){const s=ei.findChunk(r,"pHYs");if(s){const i=ei.parsePhys(r,s.dataOffset);if(i.unit===0&&i.ppux===i.ppuy){const a=Math.max(i.ppux/2834.5,1);return{w:Math.round(n.naturalWidth/a),h:Math.round(n.naturalHeight/a)}}}}}}catch(r){return console.error(r),{w:n.naturalWidth,h:n.naturalHeight}}return{w:n.naturalWidth,h:n.naturalHeight}}static async usingObjectURL(o,n){const r=URL.createObjectURL(o);try{return await n(r)}finally{URL.revokeObjectURL(r)}}}function Ja(t=""){let o=0,n=0,r=0,s=0;function i(){const a=o^o<<11;return o=n,n=r,r=s,s^=(s>>>19^a^a>>>8)>>>0,s/4294967296*2}for(let a=0;a<t.length+64;a++)o^=t.charCodeAt(a)|0,i();return i}function Xm(t,o,n,r=!1){const[s,i]=o,[a,l]=n,c=a+(t-s)/(i-s)*(l-a);return r?a<l?Math.max(Math.min(c,l),a):Math.max(Math.min(c,a),l):c}function si(t,o){return Object.prototype.hasOwnProperty.call(t,o)}function Us(t,o){if(si(t,o))return t[o]}function r2(t){return Object.keys(t)}function un(t){return Object.values(t)}function Ao(t){return Object.entries(t)}function Xx(t){return Object.fromEntries(t)}function v0(t,o){const n={};let r=!1;for(const[s,i]of Ao(t))o(s,i)?n[s]=i:r=!0;return r?n:t}function Wg(t,o){const n={};for(const[r,s]of Ao(t)){const i=o(r,s);n[r]=i}return n}function HT(t,o){if(t===o)return!0;const n=new Set(Object.keys(t)),r=new Set(Object.keys(o));if(n.size!==r.size)return!1;for(const s of n)if(!r.has(s)||!Object.is(t[s],o[s]))return!1;return!0}const Yo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",WT="a0",YT="A00000000000000000000000000";function XT(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-"a".charCodeAt(0)+2;if(t>="A"&&t<="Z")return"Z".charCodeAt(0)-t.charCodeAt(0)+2;throw new Error("Invalid index key head: "+t)}function qT(t){if(t.length!==XT(t.charAt(0)))throw new Error("invalid integer part of index key: "+t)}function n2(t){if(t===void 0)throw Error("n is undefined")}function o2(t){qT(t);const[o,...n]=t.split("");let r=!0;for(let s=n.length-1;r&&s>=0;s--){const i=Yo.indexOf(n[s])+1;i===Yo.length?n[s]="0":(n[s]=Yo.charAt(i),r=!1)}if(r){if(o==="Z")return"a0";if(o==="z")return;const s=String.fromCharCode(o.charCodeAt(0)+1);return s>"a"?n.push("0"):n.pop(),s+n.join("")}else return o+n.join("")}function XL(t){qT(t);const[o,...n]=t.split("");let r=!0;for(let s=n.length-1;r&&s>=0;s--){const i=Yo.indexOf(n[s])-1;i===-1?n[s]=Yo.slice(-1):(n[s]=Yo.charAt(i),r=!1)}if(r){if(o==="a")return"Z"+Yo.slice(-1);if(o==="A")return;const s=String.fromCharCode(o.charCodeAt(0)-1);return s<"Z"?n.push(Yo.slice(-1)):n.pop(),s+n.join("")}else return o+n.join("")}function Uc(t,o){if(o!==void 0&&t>=o)throw new Error(t+" >= "+o);if(t.slice(-1)==="0"||o&&o.slice(-1)==="0")throw new Error("trailing zero");if(o){let s=0;for(;(t.charAt(s)||"0")===o.charAt(s);)s++;if(s>0)return o.slice(0,s)+Uc(t.slice(s),o.slice(s))}const n=t?Yo.indexOf(t.charAt(0)):0,r=o!==void 0?Yo.indexOf(o.charAt(0)):Yo.length;if(r-n>1){const s=Math.round(.5*(n+r));return Yo.charAt(s)}else return o&&o.length>1?o.slice(0,1):Yo.charAt(n)+Uc(t.slice(1),void 0)}function Ed(t){const o=XT(t.charAt(0));if(o>t.length)throw new Error("invalid index: "+t);return t.slice(0,o)}function Wb(t){if(t===YT)throw new Error("invalid index: "+t);const o=Ed(t);if(t.slice(o.length).slice(-1)==="0")throw new Error("invalid index: "+t)}function dc(t,o){if(t!==void 0&&Wb(t),o!==void 0&&Wb(o),t!==void 0&&o!==void 0&&t>=o)throw new Error(t+" >= "+o);if(t===void 0&&o===void 0)return WT;if(t===void 0){if(o===void 0)throw Error("b is undefined");const l=Ed(o),c=o.slice(l.length);if(l===YT)return l+Uc("",c);if(l<o)return l;const u=XL(l);return n2(u),u}if(o===void 0){const l=Ed(t),c=t.slice(l.length),u=o2(l);return u===void 0?l+Uc(c,void 0):u}const n=Ed(t),r=t.slice(n.length),s=Ed(o),i=o.slice(s.length);if(n===s)return n+Uc(r,i);const a=o2(n);return n2(a),a<o?a:n+Uc(r,void 0)}function Ba(t,o,n){if(n===0)return[];if(n===1)return[dc(t,o)];if(o===void 0){let i=dc(t,o);const a=[i];for(let l=0;l<n-1;l++)i=dc(i,o),a.push(i);return a}if(t===void 0){let i=dc(t,o);const a=[i];for(let l=0;l<n-1;l++)i=dc(t,i),a.push(i);return a.reverse(),a}const r=Math.floor(n/2),s=dc(t,o);return[...Ba(t,s,r),s,...Ba(s,o,n-r-1)]}const qL=WT;function KL(t){Wb(t)}function gu(t,o,n){return Ba(t,o,n)}function b0(t,o){return Ba(t,void 0,o)}function Nd(t,o){return Ba(t,o,1)[0]}function Ii(t){return Ba(t,void 0,1)[0]}function ZL(t){return Ba(void 0,t,1)[0]}function uh(t,o="a1"){return[o,...Ba(o,void 0,t)]}function qn(t,o){return t.index<o.index?-1:t.index>o.index?1:0}function QL(t,o){return t.id>o.id?1:-1}function qx(t){try{return localStorage.getItem(t)}catch{return null}}function Kx(t,o){try{localStorage.setItem(t,o)}catch{}}function JL(){try{localStorage.clear()}catch{}}function KT(t){try{return sessionStorage.getItem(t)}catch{return null}}function Zx(t,o){try{sessionStorage.setItem(t,o)}catch{}}function ZT(t){try{sessionStorage.removeItem(t)}catch{}}function e4(){try{sessionStorage.clear()}catch{}}const t4=()=>typeof process<"u"&&!1,Bc=[],r4=60,Mp=Math.ceil(1e3/r4);let nd,x0=0,Yb=0;const n4=()=>{const t=Bc.splice(0,Bc.length);for(const o of t)o()};function QT(){if(nd)return;const t=Date.now(),o=t-Yb;if(x0+o<Mp){nd=requestAnimationFrame(()=>{nd=void 0,QT()});return}nd=requestAnimationFrame(()=>{nd=void 0,Yb=t,x0=Math.min(x0+o-Mp,Mp*10),n4()})}let s2=!1;function JT(t){return t4()?(t(),()=>{}):(Bc.includes(t)||(Bc.push(t),s2||(s2=!0,Yb=Date.now()-Mp-1),QT()),()=>{const o=Bc.indexOf(t);o>-1&&Bc.splice(o,1)})}function o4(t){return t!==null}function s4(){return typeof globalThis<"u"&&globalThis.structuredClone?[globalThis.structuredClone,!0]:typeof global<"u"&&global.structuredClone?[global.structuredClone,!0]:typeof window<"u"&&window.structuredClone?[window.structuredClone,!0]:[t=>t&&JSON.parse(JSON.stringify(t)),!1]}const ek=s4(),_r=ek[0];ek[1];const i4=Object.getPrototypeOf(_r({}));let Yg=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((o,n)=>(n&=63,n<36?o+=n.toString(36):n<62?o+=(n-26).toString(36).toUpperCase():n>62?o+="-":o+="_",o),"");class Qx{constructor(o,n){D(this,"createDefaultProperties");D(this,"validator");D(this,"scope");D(this,"isInstance",o=>(o==null?void 0:o.typeName)===this.typeName);this.typeName=o,this.createDefaultProperties=n.createDefaultProperties,this.validator=n.validator??{validate:r=>r},this.scope=n.scope??"document"}create(o){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,s]of Object.entries(o))s!==void 0&&(n[r]=s);return n.typeName=this.typeName,n}clone(o){return{..._r(o),id:this.createId()}}createId(o){return this.typeName+":"+(o??Yg())}createCustomId(o){return this.typeName+":"+o}parseId(o){if(!this.isId(o))throw new Error(`ID "${o}" is not a valid ID for type "${this.typeName}"`);return o.slice(this.typeName.length+1)}isId(o){if(!o)return!1;for(let n=0;n<this.typeName.length;n++)if(o[n]!==this.typeName[n])return!1;return o[this.typeName.length]===":"}withDefaultProperties(o){return new Qx(this.typeName,{createDefaultProperties:o,validator:this.validator,scope:this.scope})}validate(o,n){return n&&this.validator.validateUsingKnownGoodVersion?this.validator.validateUsingKnownGoodVersion(n,o):this.validator.validate(o)}}function Qi(t,o){return new Qx(t,{createDefaultProperties:()=>({}),validator:o.validator,scope:o.scope})}class i2{constructor(){D(this,"items",new WeakMap)}get(o,n){return this.items.has(o)||this.items.set(o,n(o)),this.items.get(o)}}var qm={exports:{}};qm.exports;(function(t,o){var n=200,r="__lodash_hash_undefined__",s=1,i=2,a=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",m="[object GeneratorFunction]",g="[object Map]",b="[object Number]",y="[object Null]",v="[object Object]",x="[object Promise]",S="[object Proxy]",w="[object RegExp]",E="[object Set]",j="[object String]",P="[object Symbol]",M="[object Undefined]",O="[object WeakMap]",k="[object ArrayBuffer]",F="[object DataView]",A="[object Float32Array]",N="[object Float64Array]",$="[object Int8Array]",G="[object Int16Array]",X="[object Int32Array]",W="[object Uint8Array]",V="[object Uint8ClampedArray]",q="[object Uint16Array]",J="[object Uint32Array]",ae=/[\\^$.*+?()[\]{}|]/g,I=/^\[object .+?Constructor\]$/,U=/^(?:0|[1-9]\d*)$/,z={};z[A]=z[N]=z[$]=z[G]=z[X]=z[W]=z[V]=z[q]=z[J]=!0,z[l]=z[c]=z[k]=z[f]=z[F]=z[h]=z[d]=z[p]=z[g]=z[b]=z[v]=z[w]=z[E]=z[j]=z[O]=!1;var K=typeof fn=="object"&&fn&&fn.Object===Object&&fn,te=typeof self=="object"&&self&&self.Object===Object&&self,ne=K||te||Function("return this")(),le=o&&!o.nodeType&&o,me=le&&!0&&t&&!t.nodeType&&t,ce=me&&me.exports===le,ge=ce&&K.process,pe=function(){try{return ge&&ge.binding&&ge.binding("util")}catch{}}(),oe=pe&&pe.isTypedArray;function de(ye,Ie){for(var Ye=-1,ht=ye==null?0:ye.length,cr=0,Dt=[];++Ye<ht;){var Cr=ye[Ye];Ie(Cr,Ye,ye)&&(Dt[cr++]=Cr)}return Dt}function xe(ye,Ie){for(var Ye=-1,ht=Ie.length,cr=ye.length;++Ye<ht;)ye[cr+Ye]=Ie[Ye];return ye}function Te(ye,Ie){for(var Ye=-1,ht=ye==null?0:ye.length;++Ye<ht;)if(Ie(ye[Ye],Ye,ye))return!0;return!1}function Se(ye,Ie){for(var Ye=-1,ht=Array(ye);++Ye<ye;)ht[Ye]=Ie(Ye);return ht}function je(ye){return function(Ie){return ye(Ie)}}function Oe(ye,Ie){return ye.has(Ie)}function We(ye,Ie){return ye==null?void 0:ye[Ie]}function Fe(ye){var Ie=-1,Ye=Array(ye.size);return ye.forEach(function(ht,cr){Ye[++Ie]=[cr,ht]}),Ye}function ut(ye,Ie){return function(Ye){return ye(Ie(Ye))}}function tt(ye){var Ie=-1,Ye=Array(ye.size);return ye.forEach(function(ht){Ye[++Ie]=ht}),Ye}var rt=Array.prototype,it=Function.prototype,nt=Object.prototype,Ce=ne["__core-js_shared__"],Ge=it.toString,Me=nt.hasOwnProperty,re=function(){var ye=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return ye?"Symbol(src)_1."+ye:""}(),ie=nt.toString,ee=RegExp("^"+Ge.call(Me).replace(ae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ue=ce?ne.Buffer:void 0,we=ne.Symbol,ke=ne.Uint8Array,$e=nt.propertyIsEnumerable,Ke=rt.splice,Qe=we?we.toStringTag:void 0,et=Object.getOwnPropertySymbols,at=ue?ue.isBuffer:void 0,Ot=ut(Object.keys,Object),Ct=Cn(ne,"DataView"),dt=Cn(ne,"Map"),Pt=Cn(ne,"Promise"),Et=Cn(ne,"Set"),rr=Cn(ne,"WeakMap"),Hr=Cn(Object,"create"),Wr=Ys(Ct),Qt=Ys(dt),pr=Ys(Pt),Ht=Ys(Et),pn=Ys(rr),Zr=we?we.prototype:void 0,Jt=Zr?Zr.valueOf:void 0;function Er(ye){var Ie=-1,Ye=ye==null?0:ye.length;for(this.clear();++Ie<Ye;){var ht=ye[Ie];this.set(ht[0],ht[1])}}function al(){this.__data__=Hr?Hr(null):{},this.size=0}function ll(ye){var Ie=this.has(ye)&&delete this.__data__[ye];return this.size-=Ie?1:0,Ie}function cl(ye){var Ie=this.__data__;if(Hr){var Ye=Ie[ye];return Ye===r?void 0:Ye}return Me.call(Ie,ye)?Ie[ye]:void 0}function sc(ye){var Ie=this.__data__;return Hr?Ie[ye]!==void 0:Me.call(Ie,ye)}function ul(ye,Ie){var Ye=this.__data__;return this.size+=this.has(ye)?0:1,Ye[ye]=Hr&&Ie===void 0?r:Ie,this}Er.prototype.clear=al,Er.prototype.delete=ll,Er.prototype.get=cl,Er.prototype.has=sc,Er.prototype.set=ul;function ro(ye){var Ie=-1,Ye=ye==null?0:ye.length;for(this.clear();++Ie<Ye;){var ht=ye[Ie];this.set(ht[0],ht[1])}}function be(){this.__data__=[],this.size=0}function Ze(ye){var Ie=this.__data__,Ye=Si(Ie,ye);if(Ye<0)return!1;var ht=Ie.length-1;return Ye==ht?Ie.pop():Ke.call(Ie,Ye,1),--this.size,!0}function ct(ye){var Ie=this.__data__,Ye=Si(Ie,ye);return Ye<0?void 0:Ie[Ye][1]}function qe(ye){return Si(this.__data__,ye)>-1}function $t(ye,Ie){var Ye=this.__data__,ht=Si(Ye,ye);return ht<0?(++this.size,Ye.push([ye,Ie])):Ye[ht][1]=Ie,this}ro.prototype.clear=be,ro.prototype.delete=Ze,ro.prototype.get=ct,ro.prototype.has=qe,ro.prototype.set=$t;function ze(ye){var Ie=-1,Ye=ye==null?0:ye.length;for(this.clear();++Ie<Ye;){var ht=ye[Ie];this.set(ht[0],ht[1])}}function Wt(){this.size=0,this.__data__={hash:new Er,map:new(dt||ro),string:new Er}}function st(ye){var Ie=wi(this,ye).delete(ye);return this.size-=Ie?1:0,Ie}function Bt(ye){return wi(this,ye).get(ye)}function lt(ye){return wi(this,ye).has(ye)}function Fr(ye,Ie){var Ye=wi(this,ye),ht=Ye.size;return Ye.set(ye,Ie),this.size+=Ye.size==ht?0:1,this}ze.prototype.clear=Wt,ze.prototype.delete=st,ze.prototype.get=Bt,ze.prototype.has=lt,ze.prototype.set=Fr;function Ar(ye){var Ie=-1,Ye=ye==null?0:ye.length;for(this.__data__=new ze;++Ie<Ye;)this.add(ye[Ie])}function Rr(ye){return this.__data__.set(ye,r),this}function nn(ye){return this.__data__.has(ye)}Ar.prototype.add=Ar.prototype.push=Rr,Ar.prototype.has=nn;function mn(ye){var Ie=this.__data__=new ro(ye);this.size=Ie.size}function no(){this.__data__=new ro,this.size=0}function is(ye){var Ie=this.__data__,Ye=Ie.delete(ye);return this.size=Ie.size,Ye}function on(ye){return this.__data__.get(ye)}function nf(ye){return this.__data__.has(ye)}function No(ye,Ie){var Ye=this.__data__;if(Ye instanceof ro){var ht=Ye.__data__;if(!dt||ht.length<n-1)return ht.push([ye,Ie]),this.size=++Ye.size,this;Ye=this.__data__=new ze(ht)}return Ye.set(ye,Ie),this.size=Ye.size,this}mn.prototype.clear=no,mn.prototype.delete=is,mn.prototype.get=on,mn.prototype.has=nf,mn.prototype.set=No;function aa(ye,Ie){var Ye=hl(ye),ht=!Ye&&By(ye),cr=!Ye&&!ht&&Hu(ye),Dt=!Ye&&!ht&&!cr&&ca(ye),Cr=Ye||ht||cr||Dt,Qr=Cr?Se(ye.length,String):[],sn=Qr.length;for(var mr in ye)(Ie||Me.call(ye,mr))&&!(Cr&&(mr=="length"||cr&&(mr=="offset"||mr=="parent")||Dt&&(mr=="buffer"||mr=="byteLength"||mr=="byteOffset")||ff(mr,sn)))&&Qr.push(mr);return Qr}function Si(ye,Ie){for(var Ye=ye.length;Ye--;)if(Vu(ye[Ye][0],Ie))return Ye;return-1}function of(ye,Ie,Ye){var ht=Ie(ye);return hl(ye)?ht:xe(ht,Ye(ye))}function la(ye){return ye==null?ye===void 0?M:y:Qe&&Qe in Object(ye)?df(ye):Uy(ye)}function zu(ye){return so(ye)&&la(ye)==l}function ic(ye,Ie,Ye,ht,cr){return ye===Ie?!0:ye==null||Ie==null||!so(ye)&&!so(Ie)?ye!==ye&&Ie!==Ie:sf(ye,Ie,Ye,ht,ic,cr)}function sf(ye,Ie,Ye,ht,cr,Dt){var Cr=hl(ye),Qr=hl(Ie),sn=Cr?c:oo(ye),mr=Qr?c:oo(Ie);sn=sn==l?v:sn,mr=mr==l?v:mr;var Fn=sn==v,wo=mr==v,gn=sn==mr;if(gn&&Hu(ye)){if(!Hu(Ie))return!1;Cr=!0,Fn=!1}if(gn&&!Fn)return Dt||(Dt=new mn),Cr||ca(ye)?ac(ye,Ie,Ye,ht,cr,Dt):cf(ye,Ie,sn,Ye,ht,cr,Dt);if(!(Ye&s)){var io=Fn&&Me.call(ye,"__wrapped__"),ao=wo&&Me.call(Ie,"__wrapped__");if(io||ao){var js=io?ye.value():ye,as=ao?Ie.value():Ie;return Dt||(Dt=new mn),cr(js,as,Ye,ht,Dt)}}return gn?(Dt||(Dt=new mn),uf(ye,Ie,Ye,ht,cr,Dt)):!1}function af(ye){if(!$o(ye)||Gu(ye))return!1;var Ie=mf(ye)?ee:I;return Ie.test(Ys(ye))}function lf(ye){return so(ye)&&Wu(ye.length)&&!!z[la(ye)]}function Ny(ye){if(!pf(ye))return Ot(ye);var Ie=[];for(var Ye in Object(ye))Me.call(ye,Ye)&&Ye!="constructor"&&Ie.push(Ye);return Ie}function ac(ye,Ie,Ye,ht,cr,Dt){var Cr=Ye&s,Qr=ye.length,sn=Ie.length;if(Qr!=sn&&!(Cr&&sn>Qr))return!1;var mr=Dt.get(ye);if(mr&&Dt.get(Ie))return mr==Ie;var Fn=-1,wo=!0,gn=Ye&i?new Ar:void 0;for(Dt.set(ye,Ie),Dt.set(Ie,ye);++Fn<Qr;){var io=ye[Fn],ao=Ie[Fn];if(ht)var js=Cr?ht(ao,io,Fn,Ie,ye,Dt):ht(io,ao,Fn,ye,Ie,Dt);if(js!==void 0){if(js)continue;wo=!1;break}if(gn){if(!Te(Ie,function(as,Xs){if(!Oe(gn,Xs)&&(io===as||cr(io,as,Ye,ht,Dt)))return gn.push(Xs)})){wo=!1;break}}else if(!(io===ao||cr(io,ao,Ye,ht,Dt))){wo=!1;break}}return Dt.delete(ye),Dt.delete(Ie),wo}function cf(ye,Ie,Ye,ht,cr,Dt,Cr){switch(Ye){case F:if(ye.byteLength!=Ie.byteLength||ye.byteOffset!=Ie.byteOffset)return!1;ye=ye.buffer,Ie=Ie.buffer;case k:return!(ye.byteLength!=Ie.byteLength||!Dt(new ke(ye),new ke(Ie)));case f:case h:case b:return Vu(+ye,+Ie);case d:return ye.name==Ie.name&&ye.message==Ie.message;case w:case j:return ye==Ie+"";case g:var Qr=Fe;case E:var sn=ht&s;if(Qr||(Qr=tt),ye.size!=Ie.size&&!sn)return!1;var mr=Cr.get(ye);if(mr)return mr==Ie;ht|=i,Cr.set(ye,Ie);var Fn=ac(Qr(ye),Qr(Ie),ht,cr,Dt,Cr);return Cr.delete(ye),Fn;case P:if(Jt)return Jt.call(ye)==Jt.call(Ie)}return!1}function uf(ye,Ie,Ye,ht,cr,Dt){var Cr=Ye&s,Qr=dl(ye),sn=Qr.length,mr=dl(Ie),Fn=mr.length;if(sn!=Fn&&!Cr)return!1;for(var wo=sn;wo--;){var gn=Qr[wo];if(!(Cr?gn in Ie:Me.call(Ie,gn)))return!1}var io=Dt.get(ye);if(io&&Dt.get(Ie))return io==Ie;var ao=!0;Dt.set(ye,Ie),Dt.set(Ie,ye);for(var js=Cr;++wo<sn;){gn=Qr[wo];var as=ye[gn],Xs=Ie[gn];if(ht)var Yu=Cr?ht(Xs,as,gn,Ie,ye,Dt):ht(as,Xs,gn,ye,Ie,Dt);if(!(Yu===void 0?as===Xs||cr(as,Xs,Ye,ht,Dt):Yu)){ao=!1;break}js||(js=gn=="constructor")}if(ao&&!js){var ua=ye.constructor,_i=Ie.constructor;ua!=_i&&"constructor"in ye&&"constructor"in Ie&&!(typeof ua=="function"&&ua instanceof ua&&typeof _i=="function"&&_i instanceof _i)&&(ao=!1)}return Dt.delete(ye),Dt.delete(Ie),ao}function dl(ye){return of(ye,fl,hf)}function wi(ye,Ie){var Ye=ye.__data__;return $y(Ie)?Ye[typeof Ie=="string"?"string":"hash"]:Ye.map}function Cn(ye,Ie){var Ye=We(ye,Ie);return af(Ye)?Ye:void 0}function df(ye){var Ie=Me.call(ye,Qe),Ye=ye[Qe];try{ye[Qe]=void 0;var ht=!0}catch{}var cr=ie.call(ye);return ht&&(Ie?ye[Qe]=Ye:delete ye[Qe]),cr}var hf=et?function(ye){return ye==null?[]:(ye=Object(ye),de(et(ye),function(Ie){return $e.call(ye,Ie)}))}:_s,oo=la;(Ct&&oo(new Ct(new ArrayBuffer(1)))!=F||dt&&oo(new dt)!=g||Pt&&oo(Pt.resolve())!=x||Et&&oo(new Et)!=E||rr&&oo(new rr)!=O)&&(oo=function(ye){var Ie=la(ye),Ye=Ie==v?ye.constructor:void 0,ht=Ye?Ys(Ye):"";if(ht)switch(ht){case Wr:return F;case Qt:return g;case pr:return x;case Ht:return E;case pn:return O}return Ie});function ff(ye,Ie){return Ie=Ie??a,!!Ie&&(typeof ye=="number"||U.test(ye))&&ye>-1&&ye%1==0&&ye<Ie}function $y(ye){var Ie=typeof ye;return Ie=="string"||Ie=="number"||Ie=="symbol"||Ie=="boolean"?ye!=="__proto__":ye===null}function Gu(ye){return!!re&&re in ye}function pf(ye){var Ie=ye&&ye.constructor,Ye=typeof Ie=="function"&&Ie.prototype||nt;return ye===Ye}function Uy(ye){return ie.call(ye)}function Ys(ye){if(ye!=null){try{return Ge.call(ye)}catch{}try{return ye+""}catch{}}return""}function Vu(ye,Ie){return ye===Ie||ye!==ye&&Ie!==Ie}var By=zu(function(){return arguments}())?zu:function(ye){return so(ye)&&Me.call(ye,"callee")&&!$e.call(ye,"callee")},hl=Array.isArray;function zy(ye){return ye!=null&&Wu(ye.length)&&!mf(ye)}var Hu=at||pl;function Gy(ye,Ie){return ic(ye,Ie)}function mf(ye){if(!$o(ye))return!1;var Ie=la(ye);return Ie==p||Ie==m||Ie==u||Ie==S}function Wu(ye){return typeof ye=="number"&&ye>-1&&ye%1==0&&ye<=a}function $o(ye){var Ie=typeof ye;return ye!=null&&(Ie=="object"||Ie=="function")}function so(ye){return ye!=null&&typeof ye=="object"}var ca=oe?je(oe):lf;function fl(ye){return zy(ye)?aa(ye):Ny(ye)}function _s(){return[]}function pl(){return!1}t.exports=Gy})(qm,qm.exports);var a4=qm.exports;const l4=Xl(a4);function c4(t){if(t.length===0)return new Set;const o=t[0],n=t.slice(1),r=new Set;for(const s of o)n.every(i=>i.has(s))&&r.add(s);return r}function u4(t,o){const n={};for(const r of o)t.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of t)o.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function a2(t,o){for(const[n,r]of Object.entries(t)){const s=r,i=o[n];if("eq"in s&&i!==s.eq||"neq"in s&&i===s.neq||"gt"in s&&(typeof i!="number"||i<=s.gt))return!1}return!0}function l2(t,o,n){const r=Object.fromEntries(Object.keys(n).map(s=>[s,new Set]));for(const[s,i]of Object.entries(n))if("eq"in i){const l=t.index(o,s).get().get(i.eq);if(l)for(const c of l)r[s].add(c)}else if("neq"in i){const a=t.index(o,s);for(const[l,c]of a.get())if(l!==i.neq)for(const u of c)r[s].add(u)}else if("gt"in i){const a=t.index(o,s);for(const[l,c]of a.get())if(l>i.gt)for(const u of c)r[s].add(u)}return c4(Object.values(r))}class d4{constructor(o,n){D(this,"indexCache",new Map);D(this,"historyCache",new Map);this.atoms=o,this.history=n}filterHistory(o){if(this.historyCache.has(o))return this.historyCache.get(o);const n=Xe("filterHistory:"+o,(r,s)=>{if(Ml(r))return this.history.get();const i=this.history.getDiffSince(s);if(i===Ko)return this.history.get();const a={added:{},removed:{},updated:{}};let l=0,c=0,u=0;for(const f of i){for(const h of un(f.added))if(h.typeName===o)if(a.removed[h.id]){const d=a.removed[h.id];delete a.removed[h.id],c--,d!==h&&(a.updated[h.id]=[d,h],u++)}else a.added[h.id]=h,l++;for(const[h,d]of un(f.updated))d.typeName===o&&(a.added[d.id]?a.added[d.id]=d:a.updated[d.id]?a.updated[d.id]=[a.updated[d.id][0],d]:(a.updated[d.id]=[h,d],u++));for(const h of un(f.removed))h.typeName===o&&(a.added[h.id]?(delete a.added[h.id],l--):a.updated[h.id]?(a.removed[h.id]=a.updated[h.id][0],delete a.updated[h.id],u--,c++):(a.removed[h.id]=h,c++))}return l||c||u?jd(this.history.get(),a):r},{historyLength:100});return this.historyCache.set(o,n),n}index(o,n){const r=o+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const s=this.__uncached_createIndex(o,n);return this.indexCache.set(r,s),s}__uncached_createIndex(o,n){const r=this.filterHistory(o),s=()=>{r.get();const i=new Map;for(const a of un(this.atoms.get())){const l=a.get();if(l.typeName===o){const c=l[n];i.has(c)||i.set(c,new Set),i.get(c).add(l.id)}}return i};return Xe("index:"+o+":"+n,(i,a)=>{if(Ml(i))return s();const l=r.getDiffSince(a);if(l===Ko)return s();const c=new Map,u=(p,m)=>{let g=c.get(p);g||(g=new Ip(i.get(p)??new Set)),g.add(m),c.set(p,g)},f=(p,m)=>{let g=c.get(p);g||(g=new Ip(i.get(p)??new Set)),g.remove(m),c.set(p,g)};for(const p of l){for(const m of un(p.added))if(m.typeName===o){const g=m[n];u(g,m.id)}for(const[m,g]of un(p.updated))if(g.typeName===o){const b=m[n],y=g[n];b!==y&&(f(b,g.id),u(y,g.id))}for(const m of un(p.removed))if(m.typeName===o){const g=m[n];f(g,m.id)}}let h,d;for(const[p,m]of c){const g=m.get();g&&(h||(h=new Map(i)),d||(d=new Map),g.value.size===0?h.delete(p):h.set(p,g.value),d.set(p,g.diff))}return h&&d?jd(h,d):i},{historyLength:100})}record(o,n=()=>({}),r="record:"+o+(n?":"+n.toString():"")){const s=this.ids(o,n,r);return Xe(r,()=>{var i;for(const a of s.get())return(i=this.atoms.get()[a])==null?void 0:i.get()})}records(o,n=()=>({}),r="records:"+o+(n?":"+n.toString():"")){const s=this.ids(o,n,"ids:"+r);return Xe(r,()=>[...s.get()].map(i=>{const a=this.atoms.get()[i];if(!a)throw new Error("no atom found for record id: "+i);return a.get()}))}ids(o,n=()=>({}),r="ids:"+o+(n?":"+n.toString():"")){const s=this.filterHistory(o),i=()=>{s.get();const c=n();return Object.keys(c).length===0?new Set(un(this.atoms.get()).flatMap(u=>{const f=u.get();return f.typeName===o?f.id:[]})):l2(this,o,c)},a=c=>{const u=i(),f=u4(c,u);return f?jd(u,f):c},l=Xe("ids_query:"+r,n,{isEqual:l4});return Xe("query:"+r,(c,u)=>{const f=l.get();if(Ml(c))return i();if(u<l.lastChangedEpoch)return a(c);const h=s.getDiffSince(u);if(h===Ko)return a(c);const d=new Ip(c);for(const m of h){for(const g of un(m.added))g.typeName===o&&a2(f,g)&&d.add(g.id);for(const[g,b]of un(m.updated))b.typeName===o&&(a2(f,b)?d.add(b.id):d.remove(b.id));for(const g of un(m.removed))g.typeName===o&&d.remove(g.id)}const p=d.get();return p?jd(p.value,p.diff):c},{historyLength:50})}exec(o,n){const r=l2(this,o,n);if(r.size===0)return Di;const s=this.atoms.get();return[...r].map(i=>s[i].get())}}class tk{constructor(o){D(this,"id",Yg());D(this,"atoms",po("store_atoms",{}));D(this,"history",po("history",0,{historyLength:1e3}));D(this,"query",new d4(this.atoms,this.history));D(this,"listeners",new Set);D(this,"historyAccumulator",new f4);D(this,"historyReactor");D(this,"schema");D(this,"props");D(this,"scopedTypes");D(this,"onBeforeCreate");D(this,"onAfterCreate");D(this,"onBeforeChange");D(this,"onAfterChange");D(this,"onBeforeDelete");D(this,"onAfterDelete");D(this,"_runCallbacks",!0);D(this,"put",(o,n)=>{Rs(()=>{const r={},s={},i=this.atoms.__unsafe__getWithoutCapture();let a=null,l,c=!1;const u=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,f=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,h=this.isMergingRemoteChanges?"remote":"user";for(let d=0,p=o.length;d<p;d++){l=o[d];const m=(a??i)[l.id];if(m){const g=m.__unsafe__getWithoutCapture();if(f&&(l=f(g,l,h)),this.schema.validateRecord(this,l,n??"updateRecord",g)===g)continue;m.set(l),c=!0,r[l.id]=[g,m.__unsafe__getWithoutCapture()]}else u&&(l=u(l,h)),c=!0,l=this.schema.validateRecord(this,l,n??"createRecord",null),s[l.id]=l,a||(a={...i}),a[l.id]=po("atom:"+l.id,l)}if(a&&this.atoms.set(a),!!c&&(this.updateHistory({added:s,updated:r,removed:{}}),this._runCallbacks)){const{onAfterCreate:d,onAfterChange:p}=this;d&&Object.values(s).forEach(m=>{d(m,h)}),p&&Object.values(r).forEach(([m,g])=>{p(m,g,h)})}})});D(this,"remove",o=>{Rs(()=>{const n=[],r=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(const i of o){const a=this.atoms.__unsafe__getWithoutCapture()[i];a&&this.onBeforeDelete(a.get(),r)===!1&&n.push(i)}let s;if(this.atoms.update(i=>{let a;for(const l of o)n.includes(l)||l in i&&(a||(a={...i}),s||(s={}),delete a[l],s[l]=i[l].get());return a??i}),!!s&&(this.updateHistory({added:{},updated:{},removed:s}),this.onAfterDelete&&this._runCallbacks)){let i;for(let a=0,l=o.length;a<l;a++)i=s[o[a]],i&&this.onAfterDelete(i,r)}})});D(this,"get",o=>{var n;return(n=this.atoms.get()[o])==null?void 0:n.get()});D(this,"unsafeGetWithoutCapture",o=>{var n;return(n=this.atoms.get()[o])==null?void 0:n.__unsafe__getWithoutCapture()});D(this,"serialize",(o="document")=>{const n={};for(const[r,s]of Ao(this.atoms.get())){const i=s.get();(o==="all"||this.scopedTypes[o].has(i.typeName))&&(n[r]=i)}return n});D(this,"allRecords",()=>un(this.atoms.get()).map(o=>o.get()));D(this,"clear",()=>{this.remove(r2(this.atoms.get()))});D(this,"update",(o,n)=>{const r=this.atoms.get()[o];if(!r){console.error(`Record ${o} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])});D(this,"has",o=>!!this.atoms.get()[o]);D(this,"listen",(o,n)=>{this._flushHistory();const r={onHistory:o,filters:{source:(n==null?void 0:n.source)??"all",scope:(n==null?void 0:n.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});D(this,"isMergingRemoteChanges",!1);D(this,"mergeRemoteChanges",o=>{if(this.isMergingRemoteChanges)return o();try{this.isMergingRemoteChanges=!0,Rs(o)}finally{this.isMergingRemoteChanges=!1}});D(this,"createComputedCache",(o,n,r)=>{const s=new i2;return{get:i=>{const a=this.atoms.get()[i];if(a)return s.get(a,()=>{const l=r?Xe(a.name+":equals",()=>a.get(),{isEqual:r}):a;return Xe(o+":"+i,()=>n(l.get()))}).get()}}});D(this,"createSelectedComputedCache",(o,n,r)=>{const s=new i2;return{get:i=>{const a=this.atoms.get()[i];if(!a)return;const l=Xe(o+":"+i+":selector",()=>n(a.get()));return s.get(a,()=>Xe(o+":"+i,()=>r(l.get()))).get()}}});D(this,"getRecordType",o=>{const n=this.schema.types[o.typeName];if(!n)throw new Error(`Record type ${o.typeName} not found`);return n});D(this,"_integrityChecker");D(this,"_isPossiblyCorrupted",!1);const{initialData:n,schema:r}=o;this.schema=r,this.props=o.props,n&&this.atoms.set(Xx(Ao(n).map(([s,i])=>[s,po("atom:"+s,this.schema.validateRecord(this,i,"initialize",null))]))),this.historyReactor=PL("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:s=>JT(s)}),this.scopedTypes={document:new Set(un(this.schema.types).filter(s=>s.scope==="document").map(s=>s.typeName)),session:new Set(un(this.schema.types).filter(s=>s.scope==="session").map(s=>s.typeName)),presence:new Set(un(this.schema.types).filter(s=>s.scope==="presence").map(s=>s.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const o=this.historyAccumulator.flush();for(const{changes:n,source:r}of o){let s=null,i=null,a=null;for(const{onHistory:l,filters:c}of this.listeners)if(!(c.source!=="all"&&c.source!==r))if(c.scope!=="all")if(c.scope==="document"){if(i??(i=this.filterChangesByScope(n,"document")),!i)continue;l({changes:i,source:r})}else if(c.scope==="session"){if(s??(s=this.filterChangesByScope(n,"session")),!s)continue;l({changes:s,source:r})}else{if(a??(a=this.filterChangesByScope(n,"presence")),!a)continue;l({changes:a,source:r})}else l({changes:n,source:r})}}}filterChangesByScope(o,n){const r={added:v0(o.added,(s,i)=>this.scopedTypes[n].has(i.typeName)),updated:v0(o.updated,(s,i)=>this.scopedTypes[n].has(i[1].typeName)),removed:v0(o.removed,(s,i)=>this.scopedTypes[n].has(i.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(o){this.historyAccumulator.add({changes:o,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,o)}validate(o){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,o,null))}getSnapshot(o="document"){return{store:this.serialize(o),schema:this.schema.serialize()}}migrateSnapshot(o){const n=this.schema.migrateStoreSnapshot(o);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);return{store:n.value,schema:this.schema.serialize()}}loadSnapshot(o){const n=this.schema.migrateStoreSnapshot(o);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);const r=this._runCallbacks;try{this._runCallbacks=!1,Rs(()=>{this.clear(),this.put(Object.values(n.value)),this.ensureStoreIsUsable()})}finally{this._runCallbacks=r}}extractingChanges(o){const n=[],r=this.historyAccumulator.intercepting(s=>n.push(s.changes));try{return Rs(o),Xg(n)}finally{r()}}applyDiff(o,n=!0){const r=this._runCallbacks;try{this._runCallbacks=n,Rs(()=>{const s=un(o.added).concat(un(o.updated).map(([a,l])=>l)),i=r2(o.removed);s.length&&this.put(s),i.length&&this.remove(i)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var o;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(o=this._integrityChecker)==null||o.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function Xg(t){const o={added:{},removed:{},updated:{}};for(const n of t){for(const[r,s]of Ao(n.added))if(o.removed[r]){const i=o.removed[r];delete o.removed[r],i!==s&&(o.updated[r]=[i,s])}else o.added[r]=s;for(const[r,[s,i]]of Ao(n.updated)){if(o.added[r]){o.added[r]=i,delete o.updated[r],delete o.removed[r];continue}if(o.updated[r]){o.updated[r]=[o.updated[r][0],i],delete o.removed[r];continue}o.updated[r]=n.updated[r],delete o.removed[r]}for(const[r,s]of Ao(n.removed))o.added[r]?delete o.added[r]:o.updated[r]?(o.removed[r]=o.updated[r][0],delete o.updated[r]):o.removed[r]=s}return o}function h4(t){if(t.length===0)return[];const o=[];let n=[t[0]],r;for(let s=1,i=t.length;s<i;s++)r=t[s],n[0].source!==r.source&&(o.push(n),n=[]),n.push(r);return o.push(n),o.map(s=>({source:s[0].source,changes:Xg(s.map(i=>i.changes))}))}class f4{constructor(){D(this,"_history",[]);D(this,"_interceptors",new Set)}intercepting(o){return this._interceptors.add(o),()=>{this._interceptors.delete(o)}}add(o){this._history.push(o);for(const n of this._interceptors)n(o)}flush(){const o=h4(this._history);return this._history=[],o}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function p4(t){const o=[];for(let n=t.length-1;n>=0;n--){const r=t[n];if("id"in r)o.unshift(r);else{const s=r.dependsOn,i=o[0];i&&(o[0]={...i,dependsOn:s.concat(i.dependsOn??[])})}}return o}function $d({sequence:t,sequenceId:o,retroactive:n=!0}){const r={sequenceId:o,retroactive:n,sequence:p4(t)};return rk(r),r}function ss(t,o){return Object.fromEntries(Ao(o).map(([n,r])=>[n,`${t}/${r}`]))}function xs(t){const o=t.sequenceId;return $d({sequenceId:o,retroactive:t.retroactive??!0,sequence:t.sequence.map(n=>"id"in n?{...n,scope:"record",filter:r=>{var s,i;return r.typeName===t.recordType&&(((s=n.filter)==null?void 0:s.call(n,r))??!0)&&(((i=t.filter)==null?void 0:i.call(t,r))??!0)}}:n)})}function m4(t){const o=new Map(t.map(i=>[i.id,i])),n=new Set,r=[];function s(i){bn(!n.has(i.id),`Circular dependency in migrations: ${i.id}`),n.add(i.id);const{version:a,sequenceId:l}=Km(i.id),c=o.get(`${l}/${a-1}`);if(c&&s(c),i.dependsOn)for(const u of i.dependsOn){const f=o.get(u);f&&s(f)}o.delete(i.id),r.push(i)}for(const i of o.values())s(i);return r}function Km(t){const[o,n]=t.split("/");return{sequenceId:o,version:parseInt(n)}}function c2(t,o){o&&bn(t.startsWith(o+"/"),`Every migration in sequence '${o}' must have an id starting with '${o}/'. Got invalid id: '${t}'`),bn(t.match(/^(.*?)\/(0|[1-9]\d*)$/),`Invalid migration id: '${t}'`)}function rk(t){if(bn(!t.sequenceId.includes("/"),`sequenceId cannot contain a '/', got ${t.sequenceId}`),bn(t.sequenceId.length,"sequenceId must be a non-empty string"),t.sequence.length===0)return;c2(t.sequence[0].id,t.sequenceId);let o=Km(t.sequence[0].id).version;bn(o===1,`Expected the first migrationId to be '${t.sequenceId}/1' but got '${t.sequence[0].id}'`);for(let n=1;n<t.sequence.length;n++){const r=t.sequence[n].id;c2(r,t.sequenceId);const s=Km(r).version;bn(s===o+1,`Migration id numbers must increase in increments of 1, expected ${t.sequenceId}/${o+1} but got '${t.sequence[n].id}'`),o=s}}var ya=(t=>(t.IncompatibleSubtype="incompatible-subtype",t.UnknownType="unknown-type",t.TargetVersionTooNew="target-version-too-new",t.TargetVersionTooOld="target-version-too-old",t.MigrationError="migration-error",t.UnrecognizedSubtype="unrecognized-subtype",t))(ya||{});function g4(t){if(t.schemaVersion>2||t.schemaVersion<1)return tu.err("Bad schema version");if(t.schemaVersion===2)return tu.ok(t);const o={schemaVersion:2,sequences:{}};for(const[n,r]of Object.entries(t.recordVersions))if(o.sequences[`com.tldraw.${n}`]=r.version,"subTypeKey"in r)for(const[s,i]of Object.entries(r.subTypeVersions))o.sequences[`com.tldraw.${n}.${s}`]=i;return tu.ok(o)}class Jx{constructor(o,n){D(this,"migrations",{});D(this,"sortedMigrations");var s;this.types=o,this.options=n;for(const i of n.migrations??[])bn(!this.migrations[i.sequenceId],`Duplicate migration sequenceId ${i.sequenceId}`),rk(i),this.migrations[i.sequenceId]=i;const r=Object.values(this.migrations).flatMap(i=>i.sequence);this.sortedMigrations=m4(r);for(const i of this.sortedMigrations)if((s=i.dependsOn)!=null&&s.length)for(const a of i.dependsOn){const l=r.find(c=>c.id===a);bn(l,`Migration '${i.id}' depends on missing migration '${a}'`)}}static create(o,n){return new Jx(o,n??{})}validateRecord(o,n,r,s){try{const i=Us(this.types,n.typeName);if(!i)throw new Error(`Missing definition for record type ${n.typeName}`);return i.validate(n,s??void 0)}catch(i){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:o,record:n,phase:r,recordBefore:s,error:i});throw i}}getMigrationsSince(o){const n=g4(o);if(!n.ok)return n;const r=n.value,s=new Set(Object.keys(r.sequences).filter(a=>this.migrations[a]));for(const a in this.migrations)r.sequences[a]===void 0&&this.migrations[a].retroactive&&s.add(a);if(s.size===0)return tu.ok([]);const i=new Set;for(const a of s){const l=r.sequences[a];if(typeof l!="number"&&this.migrations[a].retroactive||l===0){for(const f of this.migrations[a].sequence)i.add(f.id);continue}const c=`${a}/${l}`,u=this.migrations[a].sequence.findIndex(f=>f.id===c);if(u===-1)return tu.err("Incompatible schema?");for(const f of this.migrations[a].sequence.slice(u+1))i.add(f.id)}return tu.ok(this.sortedMigrations.filter(({id:a})=>i.has(a)))}migratePersistedRecord(o,n,r="up"){const s=this.getMigrationsSince(n);if(!s.ok)return console.error("Error migrating record",s.error),{type:"error",reason:ya.MigrationError};let i=s.value;if(i.length===0)return{type:"success",value:o};if(i.some(a=>a.scope==="store"))return{type:"error",reason:r==="down"?ya.TargetVersionTooOld:ya.TargetVersionTooNew};if(r==="down"){if(!i.every(a=>a.down))return{type:"error",reason:ya.TargetVersionTooOld};i=i.slice().reverse()}o=_r(o);try{for(const a of i){if(a.scope==="store")throw new Error;if(!(a.filter?a.filter(o):!0))continue;const c=a[r](o);c&&(o=_r(c))}}catch(a){return console.error("Error migrating record",a),{type:"error",reason:ya.MigrationError}}return{type:"success",value:o}}migrateStoreSnapshot(o){let{store:n}=o;const r=this.getMigrationsSince(o.schema);if(!r.ok)return console.error("Error migrating store",r.error),{type:"error",reason:ya.MigrationError};const s=r.value;if(s.length===0)return{type:"success",value:n};n=_r(n);try{for(const i of s)if(i.scope==="record")for(const[a,l]of Object.entries(n)){if(!(i.filter?i.filter(l):!0))continue;const u=i.up(l);u&&(n[a]=_r(u))}else if(i.scope==="store"){const a=i.up(n);a&&(n=_r(a))}else Zi(i)}catch(i){return console.error("Error migrating store",i),{type:"error",reason:ya.MigrationError}}return{type:"success",value:n}}createIntegrityChecker(o){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,o))??void 0}serialize(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:o,sequence:n})=>[o,n.length?Km(n.at(-1).id).version:0]))}}serializeEarliestVersion(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:o})=>[o,0]))}}}function y4(t){if(!t.length)return null;let o="";for(const n of t)typeof n=="number"?o+=`.${n}`:n.startsWith("(")?o.endsWith(")")?o=`${o.slice(0,-1)}, ${n.slice(1)}`:o+=n:o+=`.${n}`;return o=o.replace(/id = [^,]+, /,"").replace(/id = [^)]+/,""),o.startsWith(".")?o.slice(1):o}class Xt extends Error{constructor(n,r=[]){const s=y4(r),i=n.split(`
`).map((a,l)=>l===0?a:`  ${a}`).join(`
`);super(r?`At ${s}: ${i}`:i);D(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function Ro(t,o){try{return o()}catch(n){throw n instanceof Xt?new Xt(n.rawMessage,[t,...n.path]):new Xt(n.toString(),[t])}}function za(t){if(t===null)return"null";if(Array.isArray(t))return"an array";const o=typeof t;switch(o){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${o}`;case"object":return`an ${o}`;case"undefined":return"undefined";default:Zi(o)}}class vo{constructor(o,n){this.validationFn=o,this.validateUsingKnownGoodVersionFn=n}validate(o){return this.validationFn(o)}validateUsingKnownGoodVersion(o,n){return Object.is(o,n)?o:this.validateUsingKnownGoodVersionFn?this.validateUsingKnownGoodVersionFn(o,n):this.validate(n)}isValid(o){try{return this.validate(o),!0}catch{return!1}}nullable(){return _4(this)}optional(){return ok(this)}refine(o){return new vo(n=>o(this.validate(n)),(n,r)=>{const s=this.validateUsingKnownGoodVersion(n,r);return Object.is(n,s)?n:o(s)})}check(o,n){return typeof o=="string"?this.refine(r=>(Ro(`(check ${o})`,()=>n(r)),r)):this.refine(r=>(o(r),r))}}class v4 extends vo{constructor(o){super(n=>{const r=u2.validate(n);for(let s=0;s<r.length;s++)Ro(s,()=>o.validate(r[s]));return r},(n,r)=>{if(!o.validateUsingKnownGoodVersion)return this.validate(r);const s=u2.validate(r);let i=n.length!==s.length;for(let a=0;a<s.length;a++){const l=s[a];if(a>=n.length){i=!0,Ro(a,()=>o.validate(l));continue}if(Object.is(n[a],l))continue;const c=Ro(a,()=>o.validateUsingKnownGoodVersion(n[a],l));Object.is(c,n[a])||(i=!0)}return i?r:n}),this.itemValidator=o}nonEmpty(){return this.check(o=>{if(o.length===0)throw new Xt("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(o=>{if(o.length<=1)throw new Xt("Expected an array with length greater than 1")})}}class Zm extends vo{constructor(o,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new Xt(`Expected object, got ${za(r)}`);for(const[s,i]of Object.entries(o))Ro(s,()=>{i.validate(Us(r,s))});if(!n){for(const s of Object.keys(r))if(!si(o,s))throw new Xt("Unexpected property",[s])}return r},(r,s)=>{if(typeof s!="object"||s===null)throw new Xt(`Expected object, got ${za(s)}`);let i=!1;for(const[a,l]of Object.entries(o)){const c=Us(r,a),u=Us(s,a);if(Object.is(c,u))continue;const f=Ro(a,()=>{const h=l;return h.validateUsingKnownGoodVersion?h.validateUsingKnownGoodVersion(c,u):h.validate(u)});Object.is(f,c)||(i=!0)}if(!n){for(const a of Object.keys(s))if(!si(o,a))throw new Xt("Unexpected property",[a])}for(const a of Object.keys(r))if(!si(s,a)){i=!0;break}return i?s:r}),this.config=o,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new Zm(this.config,!0)}extend(o){return new Zm({...this.config,...o})}}class qg extends vo{constructor(o,n,r,s){super(i=>{this.expectObject(i);const{matchingSchema:a,variant:l}=this.getMatchingSchemaAndVariant(i);return a===void 0?this.unknownValueValidation(i,l):Ro(`(${o} = ${l})`,()=>a.validate(i))},(i,a)=>{this.expectObject(a),this.expectObject(i);const{matchingSchema:l,variant:c}=this.getMatchingSchemaAndVariant(a);return l===void 0?this.unknownValueValidation(a,c):Us(i,o)!==Us(a,o)?Ro(`(${o} = ${c})`,()=>l.validate(a)):Ro(`(${o} = ${c})`,()=>l.validateUsingKnownGoodVersion?l.validateUsingKnownGoodVersion(i,a):l.validate(a))}),this.key=o,this.config=n,this.unknownValueValidation=r,this.useNumberKeys=s}expectObject(o){if(typeof o!="object"||o===null)throw new Xt(`Expected an object, got ${za(o)}`,[])}getMatchingSchemaAndVariant(o){const n=Us(o,this.key);if(!this.useNumberKeys&&typeof n!="string")throw new Xt(`Expected a string for key "${this.key}", got ${za(n)}`);if(this.useNumberKeys&&!Number.isFinite(Number(n)))throw new Xt(`Expected a number for key "${this.key}", got "${n}"`);return{matchingSchema:si(this.config,n)?this.config[n]:void 0,variant:n}}validateUnknownVariants(o){return new qg(this.key,this.config,o,this.useNumberKeys)}}class b4 extends vo{constructor(o,n){super(r=>{if(typeof r!="object"||r===null)throw new Xt(`Expected object, got ${za(r)}`);for(const[s,i]of Object.entries(r))Ro(s,()=>{o.validate(s),n.validate(i)});return r},(r,s)=>{if(typeof s!="object"||s===null)throw new Xt(`Expected object, got ${za(s)}`);let i=!1;for(const[a,l]of Object.entries(s)){if(!si(r,a)){i=!0,Ro(a,()=>{o.validate(a),n.validate(l)});continue}const c=Us(r,a),u=l;if(Object.is(c,u))continue;const f=Ro(a,()=>n.validateUsingKnownGoodVersion?n.validateUsingKnownGoodVersion(c,u):n.validate(u));Object.is(f,c)||(i=!0)}for(const a of Object.keys(r))if(!si(s,a)){i=!0;break}return i?s:r}),this.keyValidator=o,this.valueValidator=n}}function eS(t){return new vo(o=>{if(typeof o!==t)throw new Xt(`Expected ${t}, got ${za(o)}`);return o})}const x4=new vo(t=>t),Lt=eS("string"),It=eS("number").check(t=>{if(Number.isNaN(t))throw new Xt("Expected a number, got NaN");if(!Number.isFinite(t))throw new Xt(`Expected a finite number, got ${t}`)}),Qm=It.check(t=>{if(t<0)throw new Xt(`Expected a positive number, got ${t}`)}),Do=It.check(t=>{if(t<=0)throw new Xt(`Expected a non-zero positive number, got ${t}`)}),nk=It.check(t=>{if(!Number.isInteger(t))throw new Xt(`Expected an integer, got ${t}`)}),Op=nk.check(t=>{if(t<0)throw new Xt(`Expected a positive integer, got ${t}`)}),S4=nk.check(t=>{if(t<=0)throw new Xt(`Expected a non-zero positive integer, got ${t}`)}),Vt=eS("boolean");function Qn(t){return new vo(o=>{if(o!==t)throw new Xt(`Expected ${t}, got ${JSON.stringify(o)}`);return t})}const u2=new vo(t=>{if(!Array.isArray(t))throw new Xt(`Expected an array, got ${za(t)}`);return t});function Mn(t){return new v4(t)}function zt(t){return new Zm(t)}function Xb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null||Object.getPrototypeOf(t)===i4)}function qb(t){return t===null||typeof t=="number"||typeof t=="string"||typeof t=="boolean"?!0:Array.isArray(t)?t.every(qb):Xb(t)?Object.values(t).every(qb):!1}const fo=new vo(t=>{if(qb(t))return t;throw new Xt(`Expected json serializable value, got ${typeof t}`)},(t,o)=>{if(Array.isArray(t)&&Array.isArray(o)){let n=t.length!==o.length;for(let r=0;r<o.length;r++){if(r>=t.length){n=!0,fo.validate(o[r]);continue}const s=t[r],i=o[r];if(Object.is(s,i))continue;const a=fo.validateUsingKnownGoodVersion(s,i);Object.is(a,s)||(n=!0)}return n?o:t}else if(Xb(t)&&Xb(o)){let n=!1;for(const r of Object.keys(o)){if(!si(t,r)){n=!0,fo.validate(o[r]);continue}const s=t[r],i=o[r];if(Object.is(s,i))continue;const a=fo.validateUsingKnownGoodVersion(s,i);Object.is(a,s)||(n=!0)}for(const r of Object.keys(t))if(!si(o,r)){n=!0;break}return n?o:t}else return fo.validate(o)});function Jm(t,o){return new b4(t,o)}function tS(t,o){return new qg(t,o,(n,r)=>{throw new Xt(`Expected one of ${Object.keys(o).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!1)}function w4(t,o){return new qg(t,o,(n,r)=>{throw new Xt(`Expected one of ${Object.keys(o).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!0)}function Ji(t,o){return new vo(n=>Ro(t,()=>o.validate(n)),(n,r)=>Ro(t,()=>o.validateUsingKnownGoodVersion?o.validateUsingKnownGoodVersion(n,r):o.validate(r)))}function Kg(t){return new vo(o=>{if(!t.has(o)){const n=Array.from(t,r=>JSON.stringify(r)).join(" or ");throw new Xt(`Expected ${n}, got ${o}`)}return o})}function ok(t){return new vo(o=>{if(o!==void 0)return t.validate(o)},(o,n)=>{if(!(o===void 0&&n===void 0)&&n!==void 0)return t.validateUsingKnownGoodVersion&&o!==void 0?t.validateUsingKnownGoodVersion(o,n):t.validate(n)})}function _4(t){return new vo(o=>o===null?null:t.validate(o),(o,n)=>n===null?null:t.validateUsingKnownGoodVersion&&o!==null?t.validateUsingKnownGoodVersion(o,n):t.validate(n))}function sk(...t){return Kg(new Set(t))}function ik(t){try{return new URL(t)}catch{if(t.startsWith("/")||t.startsWith("./"))try{return new URL(t,"http://example.com")}catch{throw new Xt(`Expected a valid url, got ${JSON.stringify(t)}`)}throw new Xt(`Expected a valid url, got ${JSON.stringify(t)}`)}}const j4=new Set(["http:","https:","mailto:"]),es=Lt.check(t=>{if(t==="")return;const o=ik(t);if(!j4.has(o.protocol.toLowerCase()))throw new Xt(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),E4=new Set(["http:","https:","data:"]),Iu=Lt.check(t=>{if(t==="")return;const o=ik(t);if(!E4.has(o.protocol.toLowerCase()))throw new Xt(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),rS=Lt.refine(t=>{try{return KL(t),t}catch{throw new Xt(`Expected an index key, got ${JSON.stringify(t)}`)}});function ms(t){return Lt.refine(o=>{if(!o.startsWith(`${t}:`))throw new Error(`${t} ID must start with "${t}:"`);return o})}const Zg=ms("asset");function nS(t,o){return zt({id:Zg,typeName:Qn("asset"),type:Qn(t),props:o,meta:fo})}const C4=Ji("camera",zt({typeName:Qn("camera"),id:ms("camera"),x:It,y:It,z:It,meta:fo})),P4=ss("com.tldraw.camera",{AddMeta:1}),T4=xs({sequenceId:"com.tldraw.camera",recordType:"camera",sequence:[{id:P4.AddMeta,up:t=>{t.meta={}}}]}),ho=Qi("camera",{validator:C4,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),dh=zt({x:It,y:It,z:It.optional()}),Ud=zt({x:It,y:It,w:It,h:It}),k4=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),ak=Kg(k4),I4=zt({type:ak,rotation:It}),lk=It.check(t=>{if(t<0||t>1)throw new Xt("Opacity must be between 0 and 1")}),M4=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),O4=Kg(M4),A4=new Set(["starting","paused","active","stopping"]),ck=zt({id:Lt,points:Mn(dh),size:Qm,color:O4,opacity:It,state:Kg(A4),delay:It,shrink:It,taper:Vt}),hh=ms("page"),R4=Ji("page",zt({typeName:Qn("page"),id:hh,name:Lt,index:rS,meta:fo})),D4=ss("com.tldraw.page",{AddMeta:1}),L4=xs({sequenceId:"com.tldraw.page",recordType:"page",sequence:[{id:D4.AddMeta,up:t=>{t.meta={}}}]}),Gi=Qi("page",{validator:R4,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function _o(t){return Gi.isId(t)}ms("instance");function F4(t){const o={};for(const[r,s]of t)o[r]=ok(s);const n=Ji("instance",zt({typeName:Qn("instance"),id:ms("instance"),currentPageId:hh,followingUserId:Lt.nullable(),brush:Ud.nullable(),opacityForNextShape:lk,stylesForNextShape:zt(o),cursor:I4,scribbles:Mn(ck),isFocusMode:Vt,isDebugMode:Vt,isToolLocked:Vt,exportBackground:Vt,screenBounds:Ud,insets:Mn(Vt),zoomBrush:Ud.nullable(),isPenMode:Vt,isGridMode:Vt,chatMessage:Lt,isChatting:Vt,highlightedUserIds:Mn(Lt),canMoveCamera:Vt,isFocused:Vt,devicePixelRatio:It,isCoarsePointer:Vt,isHoveringCanvas:Vt.nullable(),openMenus:Mn(Lt),isChangingStyle:Vt,isReadonly:Vt,meta:fo,duplicateProps:zt({shapeIds:Mn(ms("shape")),offset:zt({x:It,y:It})}).nullable()}));return Qi("instance",{validator:n,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},insets:[!1,!1,!1,!1],zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{},duplicateProps:null}))}const Dr=ss("com.tldraw.instance",{AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22,AddInset:23,AddDuplicateProps:24}),N4=xs({sequenceId:"com.tldraw.instance",recordType:"instance",sequence:[{id:Dr.AddTransparentExportBgs,up:t=>({...t,exportBackground:!0})},{id:Dr.RemoveDialog,up:({dialog:t,...o})=>o},{id:Dr.AddToolLockMode,up:t=>({...t,isToolLocked:!1})},{id:Dr.RemoveExtraPropsForNextShape,up:({propsForNextShape:t,...o})=>({...o,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([n])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(n)))})},{id:Dr.AddLabelColor,up:({propsForNextShape:t,...o})=>({...o,propsForNextShape:{...t,labelColor:"black"}})},{id:Dr.AddFollowingUserId,up:t=>({...t,followingUserId:null})},{id:Dr.RemoveAlignJustify,up:t=>{let o=t.propsForNextShape.align;return o==="justify"&&(o="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:o}}}},{id:Dr.AddZoom,up:t=>({...t,zoomBrush:null})},{id:Dr.AddVerticalAlign,up:t=>({...t,propsForNextShape:{...t.propsForNextShape,verticalAlign:"middle"}})},{id:Dr.AddScribbleDelay,up:t=>t.scribble!==null?{...t,scribble:{...t.scribble,delay:0}}:{...t}},{id:Dr.RemoveUserId,up:({userId:t,...o})=>o},{id:Dr.AddIsPenModeAndIsGridMode,up:t=>({...t,isPenMode:!1,isGridMode:!1})},{id:Dr.HoistOpacity,up:({propsForNextShape:{opacity:t,...o},...n})=>({...n,opacityForNextShape:Number(t??"1"),propsForNextShape:o})},{id:Dr.AddChat,up:t=>({...t,chatMessage:"",isChatting:!1})},{id:Dr.AddHighlightedUserIds,up:t=>({...t,highlightedUserIds:[]})},{id:Dr.ReplacePropsForNextShapeWithStylesForNextShape,up:({propsForNextShape:t,...o})=>({...o,stylesForNextShape:{}})},{id:Dr.AddMeta,up:t=>({...t,meta:{}})},{id:Dr.RemoveCursorColor,up:t=>{const{color:o,...n}=t.cursor;return{...t,cursor:n}}},{id:Dr.AddLonelyProperties,up:t=>({...t,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1})},{id:Dr.ReadOnlyReadonly,up:({isReadOnly:t,...o})=>({...o,isReadonly:t})},{id:Dr.AddHoveringCanvas,up:t=>({...t,isHoveringCanvas:null})},{id:Dr.AddScribbles,up:({scribble:t,...o})=>({...o,scribbles:[]})},{id:Dr.AddInset,up:t=>({...t,insets:[!1,!1,!1,!1]}),down:({insets:t,...o})=>({...o})},{id:Dr.AddDuplicateProps,up:t=>({...t,duplicateProps:null}),down:({duplicateProps:t,...o})=>({...o})}]}),Co="instance:instance",$4=Lt.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return t}),Is=ms("shape");function U4(t,o,n){return zt({id:Is,typeName:Qn("shape"),x:It,y:It,rotation:It,index:rS,parentId:$4,type:Qn(t),isLocked:Vt,opacity:lk,props:o?zt(o):fo,meta:n?zt(n):fo})}const B4=Ji("instance_page_state",zt({typeName:Qn("instance_page_state"),id:ms("instance_page_state"),pageId:hh,selectedShapeIds:Mn(Is),hintingShapeIds:Mn(Is),erasingShapeIds:Mn(Is),hoveredShapeId:Is.nullable(),editingShapeId:Is.nullable(),croppingShapeId:Is.nullable(),focusedGroupId:Is.nullable(),meta:fo})),od=ss("com.tldraw.instance_page_state",{AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5}),z4=xs({sequenceId:"com.tldraw.instance_page_state",recordType:"instance_page_state",sequence:[{id:od.AddCroppingId,up(t){t.croppingShapeId=null}},{id:od.RemoveInstanceIdAndCameraId,up(t){delete t.instanceId,delete t.cameraId}},{id:od.AddMeta,up:t=>{t.meta={}}},{id:od.RenameProperties,up:t=>{},down:t=>{}},{id:od.RenamePropertiesAgain,up:t=>{t.selectedShapeIds=t.selectedIds,delete t.selectedIds,t.hintingShapeIds=t.hintingIds,delete t.hintingIds,t.erasingShapeIds=t.erasingIds,delete t.erasingIds,t.hoveredShapeId=t.hoveredId,delete t.hoveredId,t.editingShapeId=t.editingId,delete t.editingId,t.croppingShapeId=t.croppingShapeId??t.croppingId??null,delete t.croppingId,t.focusedGroupId=t.focusLayerId,delete t.focusLayerId},down:t=>{t.selectedIds=t.selectedShapeIds,delete t.selectedShapeIds,t.hintingIds=t.hintingShapeIds,delete t.hintingShapeIds,t.erasingIds=t.erasingShapeIds,delete t.erasingShapeIds,t.hoveredId=t.hoveredShapeId,delete t.hoveredShapeId,t.editingId=t.editingShapeId,delete t.editingShapeId,t.croppingId=t.croppingShapeId,delete t.croppingShapeId,t.focusLayerId=t.focusedGroupId,delete t.focusedGroupId}}]}),Wn=Qi("instance_page_state",{validator:B4,scope:"session"}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),G4=Ji("pointer",zt({typeName:Qn("pointer"),id:ms("pointer"),x:It,y:It,lastActivityTimestamp:It,meta:fo})),V4=ss("com.tldraw.pointer",{AddMeta:1}),H4=xs({sequenceId:"com.tldraw.pointer",recordType:"pointer",sequence:[{id:V4.AddMeta,up:t=>{t.meta={}}}]}),oS=Qi("pointer",{validator:G4,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),eg=oS.createId("pointer"),W4=Ji("instance_presence",zt({typeName:Qn("instance_presence"),id:ms("instance_presence"),userId:Lt,userName:Lt,lastActivityTimestamp:It,followingUserId:Lt.nullable(),cursor:zt({x:It,y:It,type:ak,rotation:It}),color:Lt,camera:zt({x:It,y:It,z:It}),screenBounds:Ud,selectedShapeIds:Mn(ms("shape")),currentPageId:ms("page"),brush:Ud.nullable(),scribbles:Mn(ck),chatMessage:Lt,meta:fo})),sd=ss("com.tldraw.instance_presence",{AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5}),Y4=xs({sequenceId:"com.tldraw.instance_presence",recordType:"instance_presence",sequence:[{id:sd.AddScribbleDelay,up:t=>{t.scribble!==null&&(t.scribble.delay=0)}},{id:sd.RemoveInstanceId,up:t=>{delete t.instanceId}},{id:sd.AddChatMessage,up:t=>{t.chatMessage=""}},{id:sd.AddMeta,up:t=>{t.meta={}}},{id:sd.RenameSelectedShapeIds,up:t=>{}}]}),X4=Qi("instance_presence",{validator:W4,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),q4=Ji("document",zt({typeName:Qn("document"),id:Qn("document:document"),gridSize:It,name:Lt,meta:fo})),d2=ss("com.tldraw.document",{AddName:1,AddMeta:2}),K4=xs({sequenceId:"com.tldraw.document",recordType:"document",sequence:[{id:d2.AddName,up:t=>{t.name=""},down:t=>{delete t.name}},{id:d2.AddMeta,up:t=>{t.meta={}}}]}),sS=Qi("document",{validator:q4,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),Kb=sS.createId("document");function Z4(t,o){return t.index<o.index?-1:t.index>o.index?1:0}function h2(t){t.typeName==="asset"&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}const Q4=({error:t,phase:o,record:n,recordBefore:r})=>{throw Yx(t,{tags:{origin:"store.validateRecord",storePhase:o,isExistingValidationIssue:o==="initialize"},extras:{recordBefore:r?h2(_r(r)):void 0,recordAfter:h2(_r(n))}}),t};function J4(){return[Gi.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function e6(t){const o=t.query.ids("page"),n=()=>{if(!t.has(Kb))return t.put([sS.create({id:Kb,name:t.props.defaultName})]),n();if(!t.has(eg))return t.put([oS.create({id:eg})]),n();const r=o.get();if(r.size===0)return t.put(J4()),n();const s=()=>[...r].map(c=>t.get(c)).sort(Z4)[0].id,i=t.get(Co);if(i){if(!r.has(i.currentPageId))return t.put([{...i,currentPageId:s()}]),n()}else return t.put([t.schema.types.instance.create({id:Co,currentPageId:s(),exportBackground:!0})]),n();const a=new Set,l=new Set;for(const c of r){const u=Wn.createId(c);t.has(u)||a.add(u);const f=ho.createId(c);t.has(f)||l.add(f)}a.size>0&&t.put([...a].map(c=>Wn.create({id:c,pageId:Wn.parseId(c)}))),l.size>0&&t.put([...l].map(c=>ho.create({id:c})))};return n}const t6=nS("bookmark",zt({title:Lt,description:Lt,image:Lt,src:Iu.nullable()})),r6=ss("com.tldraw.asset.bookmark",{MakeUrlsValid:1}),n6=xs({sequenceId:"com.tldraw.asset.bookmark",recordType:"asset",filter:t=>t.type==="bookmark",sequence:[{id:r6.MakeUrlsValid,up:t=>{Iu.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),o6=nS("image",zt({w:It,h:It,name:Lt,isAnimated:Vt,mimeType:Lt.nullable(),src:Iu.nullable()})),S0=ss("com.tldraw.asset.image",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3}),s6=xs({sequenceId:"com.tldraw.asset.image",recordType:"asset",filter:t=>t.type==="image",sequence:[{id:S0.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:S0.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:S0.MakeUrlsValid,up:t=>{Iu.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),i6=nS("video",zt({w:It,h:It,name:Lt,isAnimated:Vt,mimeType:Lt.nullable(),src:Iu.nullable()})),w0=ss("com.tldraw.asset.video",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3}),a6=xs({sequenceId:"com.tldraw.asset.video",recordType:"asset",filter:t=>t.type==="video",sequence:[{id:w0.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:w0.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:w0.MakeUrlsValid,up:t=>{Iu.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),l6=Ji("asset",tS("type",{image:o6,video:i6,bookmark:t6})),c6=ss("com.tldraw.asset",{AddMeta:1}),u6=xs({sequenceId:"com.tldraw.asset",recordType:"asset",sequence:[{id:c6.AddMeta,up:t=>{t.meta={}}}]}),Cl=Qi("asset",{validator:l6,scope:"document"}).withDefaultProperties(()=>({meta:{}}));class eo{constructor(o,n,r){this.id=o,this.defaultValue=n,this.type=r}static define(o,n){const{defaultValue:r,type:s=x4}=n;return new eo(o,r,s)}static defineEnum(o,n){const{defaultValue:r,values:s}=n;return new d6(o,r,s)}validate(o){return this.type.validate(o)}validateUsingKnownGoodVersion(o,n){return this.type.validateUsingKnownGoodVersion?this.type.validateUsingKnownGoodVersion(o,n):this.validate(n)}}class d6 extends eo{constructor(o,n,r){super(o,n,sk(...r)),this.values=r}}const Af=ss("com.tldraw.shape",{AddIsLocked:1,HoistOpacity:2,AddMeta:3,AddWhite:4}),h6=xs({sequenceId:"com.tldraw.shape",recordType:"shape",sequence:[{id:Af.AddIsLocked,up:t=>{t.isLocked=!1},down:t=>{delete t.isLocked}},{id:Af.HoistOpacity,up:t=>{t.opacity=Number(t.props.opacity??"1"),delete t.props.opacity},down:t=>{const o=t.opacity;delete t.opacity,t.props.opacity=o<.175?"0.1":o<.375?"0.25":o<.625?"0.5":o<.875?"0.75":"1"}},{id:Af.AddMeta,up:t=>{t.meta={}}},{id:Af.AddWhite,up:t=>{},down:t=>{t.props.color==="white"&&(t.props.color="black")}}]});function zc(t){return t?t.typeName==="shape":!1}function Vo(t){return t?t.startsWith("shape:"):!1}function hr(t){return`shape:${t??Yg()}`}function uk(t){const o=new Map;for(const[n,r]of Object.entries(t))if(r instanceof eo){if(o.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);o.set(r,n)}return o}const qr="retired";function pi(t,o){return Wg(o,(n,r)=>`com.tldraw.shape.${t}/${r}`)}function f6(t){const o=[];for(const[n,{migrations:r}]of Object.entries(t)){const s=`com.tldraw.shape.${n}`;r?"sequenceId"in r?(bn(s===r.sequenceId,`sequenceId mismatch for ${n} shape migrations. Expected '${s}', got '${r.sequenceId}'`),o.push(r)):"sequence"in r?o.push($d({sequenceId:s,retroactive:!1,sequence:r.sequence.map(i=>"id"in i?{id:i.id,scope:"record",filter:a=>a.typeName==="shape"&&a.type===n,dependsOn:i.dependsOn,up:a=>{const l=i.up(a.props);l&&(a.props=l)},down:typeof i.down=="function"?a=>{const l=i.down(a.props);l&&(a.props=l)}:void 0}:i)})):o.push($d({sequenceId:s,retroactive:!1,sequence:Object.keys(r.migrators).map(i=>Number(i)).sort((i,a)=>i-a).map(i=>({id:`${s}/${i}`,scope:"record",filter:a=>a.typeName==="shape"&&a.type===n,up:a=>{const l=r.migrators[i].up(a);if(l)return l},down:a=>{const l=r.migrators[i].down(a);if(l)return l}}))})):o.push($d({sequenceId:s,retroactive:!1,sequence:[]}))}return o}function p6(t){return Qi("shape",{scope:"document",validator:Ji("shape",tS("type",Wg(t,(o,{props:n,meta:r})=>U4(o,n,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}const dk=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red","white"],tg={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",note:{fill:"#FCE19C",text:"#000000"},semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4465e9",note:{fill:"#8AA3FF",text:"#000000"},semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",note:{fill:"#6FC896",text:"#000000"},semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#9fa8b2",note:{fill:"#C0CAD3",text:"#000000"},semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4ba1f1",note:{fill:"#9BC4FD",text:"#000000"},semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#4cb05e",note:{fill:"#98D08A",text:"#000000"},semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#f87777",note:{fill:"#F7A5A1",text:"#000000"},semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e085f4",note:{fill:"#DFB0F9",text:"#000000"},semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#e16919",note:{fill:"#FAA475",text:"#000000"},semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",note:{fill:"#FC8282",text:"#000000"},semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",note:{fill:"#DB91FD",text:"#000000"},semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#f1ac4b",note:{fill:"#FED49A",text:"#000000"},semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},white:{solid:"#FFFFFF",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#FFFFFF",text:"#000000"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}},darkMode:{id:"dark",text:"hsl(210, 17%, 98%)",background:"hsl(240, 5%, 6.5%)",solid:"#010403",black:{solid:"#f2f2f2",note:{fill:"#2c2c2c",text:"#f2f2f2"},semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4f72fc",note:{fill:"#2A3F98",text:"#f2f2f2"},semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#099268",note:{fill:"#014429",text:"#f2f2f2"},semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#9398b0",note:{fill:"#56595F",text:"#f2f2f2"},semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#4dabf7",note:{fill:"#1F5495",text:"#f2f2f2"},semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#40c057",note:{fill:"#21581D",text:"#f2f2f2"},semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#ff8787",note:{fill:"#923632",text:"#f2f2f2"},semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#e599f7",note:{fill:"#762F8E",text:"#f2f2f2"},semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#f76707",note:{fill:"#843906",text:"#f2f2f2"},semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#e03131",note:{fill:"#89231A",text:"#f2f2f2"},semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#ae3ec9",note:{fill:"#681683",text:"#f2f2f2"},semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#ffc034",note:{fill:"#98571B",text:"#f2f2f2"},semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},white:{solid:"#f3f3f3",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#eaeaea",text:"#1d1d1d"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}}};function ea(t){return t.isDarkMode?tg.darkMode:tg.lightMode}const ts=eo.defineEnum("tldraw:color",{defaultValue:"black",values:dk}),hk=eo.defineEnum("tldraw:labelColor",{defaultValue:"black",values:dk}),Fl=eo.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),yu=eo.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),ci=eo.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),fk={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},ui=eo.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),pk=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],rg=eo.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:pk}),ng=eo.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:pk}),f2=tS("type",{binding:zt({type:Qn("binding"),boundShapeId:Is,normalizedAnchor:dh,isExact:Vt,isPrecise:Vt}),point:zt({type:Qn("point"),x:It,y:It})}),mk={labelColor:hk,color:ts,fill:yu,dash:Fl,size:ui,arrowheadStart:rg,arrowheadEnd:ng,font:ci,start:f2,end:f2,bend:It,text:Lt,labelPosition:It},_0=pi("arrow",{AddLabelColor:1,AddIsPrecise:2,AddLabelPosition:3}),gk={sequence:[{id:_0.AddLabelColor,up:t=>{t.labelColor="black"},down:qr},{id:_0.AddIsPrecise,up:({start:t,end:o})=>{t.type==="binding"&&(t.isPrecise=!(t.normalizedAnchor.x===.5&&t.normalizedAnchor.y===.5)),o.type==="binding"&&(o.isPrecise=!(o.normalizedAnchor.x===.5&&o.normalizedAnchor.y===.5))},down:({start:t,end:o})=>{t.type==="binding"&&(t.isPrecise||(t.normalizedAnchor={x:.5,y:.5}),delete t.isPrecise),o.type==="binding"&&(o.isPrecise||(o.normalizedAnchor={x:.5,y:.5}),delete o.isPrecise)}},{id:_0.AddLabelPosition,up:t=>{t.labelPosition=.5},down:t=>{delete t.labelPosition}}]},yk={w:Do,h:Do,assetId:Zg.nullable(),url:es},p2=pi("bookmark",{NullAssetId:1,MakeUrlsValid:2}),vk={sequence:[{id:p2.NullAssetId,up:t=>{t.assetId===void 0&&(t.assetId=null)},down:qr},{id:p2.MakeUrlsValid,up:t=>{es.isValid(t.url)||(t.url="")},down:t=>{}}]},bk=zt({type:sk("free","straight"),points:Mn(dh)}),xk={color:ts,fill:yu,dash:Fl,size:ui,segments:Mn(bk),isComplete:Vt,isClosed:Vt,isPen:Vt},m6=pi("draw",{AddInPen:1}),Sk={sequence:[{id:m6.AddInPen,up:t=>{const{points:o}=t.segments[0];if(o.length===0){t.isPen=!1;return}let n=!(o[0].z===0||o[0].z===.5);o[1]&&(n=n&&!(o[1].z===0||o[1].z===.5)),t.isPen=n},down:qr}]},m2=/(^\/r\/[^/]+\/?$)/,ur=t=>{try{return new URL(t)}catch{return}},$h=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(m2))return t},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(m2))return t}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/embed\/?$/)){const n=o.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.includes("/maps/")){const o=t.match(/@(.*),(.*),(.*)z/);let n;if(o){const[,r,s,i]=o;n=`https://${new URL(t).host.replace("www.","")}/maps/embed/v1/view?key=${{}.NEXT_PUBLIC_GC_API_KEY}&center=${r},${s}&zoom=${i}`}else n="";return n}},fromEmbedUrl:t=>{const o=ur(t);if(!o)return;if(o.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&o.searchParams.has("center")&&o.searchParams.get("zoom")){const r=o.searchParams.get("zoom"),[s,i]=o.searchParams.get("center").split(",");return`https://www.google.com/maps/@${s},${i},${r}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const o=ur(t),n=o&&o.pathname.match(/\/v\/([^/]+)\/?/);if(n)return`https://www.val.town/embed/${n[1]}`},fromEmbedUrl:t=>{const o=ur(t),n=o&&o.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const o=ur(t),n=o&&o.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:t=>{const o=ur(t),n=o&&o.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:t=>{const o=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=t.match(o);if(n){const[r,s,i]=n;return`https://codepen.io/${s}/embed/${i}`}},fromEmbedUrl:t=>{const o=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=t.match(o);if(n){const[r,s,i]=n;return`https://codepen.io/${s}/pen/${i}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:t=>{const o=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=t.match(o);if(n){const[r,s]=n;return`https://scratch.mit.edu/projects/embed/${s}`}},fromEmbedUrl:t=>{const o=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=t.match(o);if(n){const[r,s]=n;return`https://scratch.mit.edu/projects/${s}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{const o=ur(t);if(!o)return;const n=o.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${o.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&o.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${o.searchParams.get("v")}`},fromEmbedUrl:t=>{const o=ur(t);if(!o)return;if(o.hostname.replace(/^www./,"")==="youtube.com"){const r=o.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:t=>{const o=ur(t),n=o==null?void 0:o.searchParams.get("cid");if(o!=null&&o.pathname.match(/\/calendar\/u\/0/)&&n){o.pathname="/calendar/embed";const r=Array.from(o.searchParams.keys());for(const s of r)o.searchParams.delete(s);return o.searchParams.set("src",n),o.href}},fromEmbedUrl:t=>{const o=ur(t),n=o==null?void 0:o.searchParams.get("src");if(o!=null&&o.pathname.match(/\/calendar\/embed/)&&n){o.pathname="/calendar/u/0";const r=Array.from(o.searchParams.keys());for(const s of r)o.searchParams.delete(s);return o.searchParams.set("cid",n),o.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,toEmbedUrl:t=>{const o=ur(t);if(o!=null&&o.pathname.match(/^\/presentation/)&&(o!=null&&o.pathname.match(/\/pub\/?$/))){o.pathname=o.pathname.replace(/\/pub$/,"/embed");const n=Array.from(o.searchParams.keys());for(const r of n)o.searchParams.delete(r);return o.href}},fromEmbedUrl:t=>{const o=ur(t);if(o!=null&&o.pathname.match(/^\/presentation/)&&(o!=null&&o.pathname.match(/\/embed\/?$/))){o.pathname=o.pathname.replace(/\/embed$/,"/pub");const n=Array.from(o.searchParams.keys());for(const r of n)o.searchParams.delete(r);return o.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/\/@([^/]+)\/([^/]+)/)&&o.searchParams.has("embed"))return o.searchParams.delete("embed"),o.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/map\//))return o.origin+"/embed"+o.pathname},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/embed\/map\//))return o.pathname=o.pathname.replace(/^\/embed/,""),o.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/(artist|album)\//))return o.origin+"/embed"+o.pathname},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/embed\/(artist|album)\//))return o.origin+o.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.hostname==="vimeo.com"&&o.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+o.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.hostname==="player.vimeo.com"){const n=o.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const o=ur(t);if(o&&o.hash.match(/#room=/))return t},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${o.origin}/embed${o.pathname}?cell=*`;if(o&&o.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=o.pathname.replace(/^\/d/,"");return`${o.origin}/embed${n}?cell=*`}},fromEmbedUrl:t=>{const o=ur(t);if(o&&o.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${o.origin}${o.pathname.replace("/embed","")}#cell-*`;if(o&&o.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${o.origin}${o.pathname.replace("/embed","/d")}#cell-*`}}],g6={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},wk={w:Do,h:Do,url:Lt},Rf=pi("embed",{GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4}),_k={sequence:[{id:Rf.GenOriginalUrlInEmbed,up:t=>{try{const o=t.url,n=new URL(o).host.replace("www.","");let r;for(const s of $h)if(s.hostnames.includes(n))try{r=s.fromEmbedUrl(o)}catch(i){console.warn(i)}t.tmpOldUrl=t.url,t.url=r??""}catch{t.url="",t.tmpOldUrl=t.url}},down:qr},{id:Rf.RemoveDoesResize,up:t=>{delete t.doesResize},down:qr},{id:Rf.RemoveTmpOldUrl,up:t=>{delete t.tmpOldUrl},down:qr},{id:Rf.RemovePermissionOverrides,up:t=>{delete t.overridePermissions},down:qr}]},jk={w:Do,h:Do,name:Lt},Ek={sequence:[]},fh=eo.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),og=eo.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),ii=eo.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),Ck={geo:ii,labelColor:hk,color:ts,fill:yu,dash:Fl,size:ui,font:ci,align:fh,verticalAlign:og,url:es,w:Do,h:Do,growY:Qm,text:Lt},pa=pi("geo",{AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8}),Pk={sequence:[{id:pa.AddUrlProp,up:t=>{t.url=""},down:qr},{id:pa.AddLabelColor,up:t=>{t.labelColor="black"},down:qr},{id:pa.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:qr},{id:pa.AddCheckBox,up:t=>{},down:qr},{id:pa.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:qr},{id:pa.MigrateLegacyAlign,up:t=>{let o;switch(t.align){case"start":o="start-legacy";break;case"end":o="end-legacy";break;default:o="middle-legacy";break}t.align=o},down:qr},{id:pa.AddCloud,up:t=>{},down:qr},{id:pa.MakeUrlsValid,up:t=>{es.isValid(t.url)||(t.url="")},down:t=>{}}]},Tk={},kk={sequence:[]},Ik={color:ts,size:ui,segments:Mn(bk),isComplete:Vt,isPen:Vt},Mk={sequence:[]},y6=zt({topLeft:dh,bottomRight:dh}),Ok={w:Do,h:Do,playing:Vt,url:es,assetId:Zg.nullable(),crop:y6.nullable()},j0=pi("image",{AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3}),Ak={sequence:[{id:j0.AddUrlProp,up:t=>{t.url=""},down:qr},{id:j0.AddCropProp,up:t=>{t.crop=null},down:t=>{delete t.crop}},{id:j0.MakeUrlsValid,up:t=>{es.isValid(t.url)||(t.url="")},down:t=>{}}]},sg=eo.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),v6=zt({id:Lt,index:rS,x:It,y:It}),Rk={color:ts,dash:Fl,size:ui,spline:sg,points:Jm(Lt,v6)},Df=pi("line",{AddSnapHandles:1,RemoveExtraHandleProps:2,HandlesToPoints:3,PointIndexIds:4}),Dk={sequence:[{id:Df.AddSnapHandles,up:t=>{for(const o of Object.values(t.handles))o.canSnap=!0},down:qr},{id:Df.RemoveExtraHandleProps,up:t=>{t.handles=Xx(Object.values(t.handles).map(o=>[o.index,{x:o.x,y:o.y}]))},down:t=>{const o=Object.entries(t.handles).map(([n,r])=>({index:n,...r})).sort(qn);t.handles=Object.fromEntries(o.map((n,r)=>{const s=r===0?"start":r===o.length-1?"end":`handle:${n.index}`;return[s,{id:s,type:"vertex",canBind:!1,canSnap:!0,index:n.index,x:n.x,y:n.y}]}))}},{id:Df.HandlesToPoints,up:t=>{const o=Object.entries(t.handles).map(([n,{x:r,y:s}])=>({x:r,y:s,index:n})).sort(qn);t.points=o.map(({x:n,y:r})=>({x:n,y:r})),delete t.handles},down:t=>{const o=uh(t.points.length);t.handles=Object.fromEntries(t.points.map((n,r)=>[o[r],{x:n.x,y:n.y}])),delete t.points}},{id:Df.PointIndexIds,up:t=>{const o=uh(t.points.length);t.points=Object.fromEntries(t.points.map((n,r)=>{const s=o[r];return[s,{id:s,index:s,x:n.x,y:n.y}]}))},down:t=>{const o=Object.values(t.points).sort(qn);t.points=o.map(({x:n,y:r})=>({x:n,y:r}))}}]},Lk={color:ts,size:ui,font:ci,fontSizeAdjustment:Qm,align:fh,verticalAlign:og,growY:Qm,url:es,text:Lt},hc=pi("note",{AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5,AddFontSizeAdjustment:6}),Fk={sequence:[{id:hc.AddUrlProp,up:t=>{t.url=""},down:qr},{id:hc.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:qr},{id:hc.MigrateLegacyAlign,up:t=>{switch(t.align){case"start":t.align="start-legacy";return;case"end":t.align="end-legacy";return;default:t.align="middle-legacy";return}},down:qr},{id:hc.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:qr},{id:hc.MakeUrlsValid,up:t=>{es.isValid(t.url)||(t.url="")},down:t=>{}},{id:hc.AddFontSizeAdjustment,up:t=>{t.fontSizeAdjustment=0},down:t=>{delete t.fontSizeAdjustment}}]},Nk={color:ts,size:ui,font:ci,align:fh,w:Do,text:Lt,scale:Do,autoSize:Vt},b6=pi("text",{RemoveJustify:1}),$k={sequence:[{id:b6.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:qr}]},Uk={w:Do,h:Do,time:It,playing:Vt,url:es,assetId:Zg.nullable()},g2=pi("video",{AddUrlProp:1,MakeUrlsValid:2}),Bk={sequence:[{id:g2.AddUrlProp,up:t=>{t.url=""},down:qr},{id:g2.MakeUrlsValid,up:t=>{es.isValid(t.url)||(t.url="")},down:t=>{}}]},Lf=ss("com.tldraw.store",{RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4}),x6=$d({sequenceId:"com.tldraw.store",retroactive:!1,sequence:[{id:Lf.RemoveCodeAndIconShapeTypes,scope:"store",up:t=>{for(const[o,n]of Ao(t))n.typeName==="shape"&&(n.type==="icon"||n.type==="code")&&delete t[o]}},{id:Lf.AddInstancePresenceType,scope:"store",up(t){}},{id:Lf.RemoveTLUserAndPresenceAndAddPointer,scope:"store",up:t=>{for(const[o,n]of Ao(t))n.typeName.match(/^(user|user_presence)$/)&&delete t[o]}},{id:Lf.RemoveUserDocument,scope:"store",up:t=>{for(const[o,n]of Ao(t))n.typeName.match("user_document")&&delete t[o]}}]}),S6={arrow:{migrations:gk,props:mk},bookmark:{migrations:vk,props:yk},draw:{migrations:Sk,props:xk},embed:{migrations:_k,props:wk},frame:{migrations:Ek,props:jk},geo:{migrations:Pk,props:Ck},group:{migrations:kk,props:Tk},highlight:{migrations:Mk,props:Ik},image:{migrations:Ak,props:Ok},line:{migrations:Dk,props:Rk},note:{migrations:Fk,props:Lk},text:{migrations:$k,props:Nk},video:{migrations:Bk,props:Uk}};function w6({shapes:t=S6,migrations:o}={}){const n=new Map;for(const i of un(t))for(const a of uk(i.props??{}).keys()){if(n.has(a.id)&&n.get(a.id)!==a)throw new Error(`Multiple StyleProp instances with the same id: ${a.id}`);n.set(a.id,a)}const r=p6(t),s=F4(n);return Jx.create({asset:Cl,camera:ho,document:sS,instance:s,instance_page_state:Wn,page:Gi,instance_presence:X4,pointer:oS,shape:r},{migrations:[x6,u6,T4,K4,N4,z4,L4,Y4,H4,h6,n6,s6,a6,...f6(t),...o??[]],onValidationFailure:Q4,createIntegrityChecker:e6})}const ph=[{locale:"ca",label:"Català"},{locale:"cs",label:"Čeština"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"hr",label:"Hrvatski"},{locale:"it",label:"Italiano"},{locale:"hu",label:"Magyar"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sl",label:"Slovenščina"},{locale:"fi",label:"Suomi"},{locale:"sv",label:"Svenska"},{locale:"vi",label:"Tiếng Việt"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"he",label:"עברית"},{locale:"ar",label:"عربي"},{locale:"fa",label:"فارسی"},{locale:"ku",label:"کوردی"},{locale:"ne",label:"नेपाली"},{locale:"hi-in",label:"हिन्दी"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"my",label:"မြန်မာစာ"},{locale:"ko-kr",label:"한국어"},{locale:"ja",label:"日本語"},{locale:"zh-cn",label:"简体中文"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function _6(){const t=typeof window<"u"?window.navigator.languages??["en"]:["en"];return j6(t)}function j6(t){for(const o of t){const n=E6(o);if(n)return n}return"en"}const y2={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function E6(t){const o=ph.find(s=>s.locale===t.toLowerCase());if(o)return o.locale;const[n,r]=t.split(/[-_]/).map(s=>s.toLowerCase());if(r){const s=ph.find(i=>i.locale===n);if(s)return s.locale}return n in y2?y2[n]:null}var zk={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var o={}.hasOwnProperty;function n(){for(var i="",a=0;a<arguments.length;a++){var l=arguments[a];l&&(i=s(i,r(l)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return n.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var a="";for(var l in i)o.call(i,l)&&i[l]&&(a=s(a,l));return a}function s(i,a){return a?i?i+" "+a:i+a:i}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(zk);var C6=zk.exports;const Tt=Xl(C6),P6={error:null};class Gk extends B.Component{constructor(){super(...arguments);D(this,"state",P6)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,s;(s=(r=this.props).onError)==null||s.call(r,n)}render(){const{error:n}=this.state;if(n!==null){const{fallback:r}=this.props;return C.jsx(r,{error:n})}return this.props.children}}function mh({children:t,fallback:o,...n}){return o===null?C.jsx(C.Fragment,{children:t}):C.jsx(Gk,{fallback:o,...n,children:t})}const Qg=Ut.createContext({});function Ue(){return Ut.useContext(Qg)}function T6(){return C.jsx("div",{className:"tl-background"})}function Mu(t,o,n,r,s,i){B.useLayoutEffect(()=>{const a=t.current;if(!a||o===void 0)return;let l=`translate(${o}px, ${n}px)`;r!==void 0&&(l+=` scale(${r})`),s!==void 0&&(l+=` rotate(${s}rad)`),i&&(l+=` translate(${i.x}px, ${i.y}px)`),a.style.transform=l})}const Kn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2};class Y{constructor(o=0,n=0,r=1){this.x=o,this.y=n,this.z=r}get pressure(){return this.z}set(o=this.x,n=this.y,r=this.z){return this.x=o,this.y=n,this.z=r,this}setTo({x:o=0,y:n=0,z:r=1}){return this.x=o,this.y=n,this.z=r,this}rot(o){if(o===0)return this;const{x:n,y:r}=this,s=Math.sin(o),i=Math.cos(o);return this.x=n*i-r*s,this.y=n*s+r*i,this}rotWith(o,n){if(n===0)return this;const r=this.x-o.x,s=this.y-o.y,i=Math.sin(n),a=Math.cos(n);return this.x=o.x+(r*a-s*i),this.y=o.y+(r*i+s*a),this}clone(){const{x:o,y:n,z:r}=this;return new Y(o,n,r)}sub(o){return this.x-=o.x,this.y-=o.y,this}subXY(o,n){return this.x-=o,this.y-=n,this}subScalar(o){return this.x-=o,this.y-=o,this}add(o){return this.x+=o.x,this.y+=o.y,this}addXY(o,n){return this.x+=o,this.y+=n,this}addScalar(o){return this.x+=o,this.y+=o,this}clamp(o,n){return this.x=Math.max(this.x,o),this.y=Math.max(this.y,o),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(o){return this.x/=o,this.y/=o,this}divV(o){return this.x/=o.x,this.y/=o.y,this}mul(o){return this.x*=o,this.y*=o,this}mulV(o){return this.x*=o.x,this.y*=o.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(o,n){const r=Y.Tan(o,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(o){return this.x=this.y*o.z-this.z*o.y,this.y=this.z*o.x-this.x*o.z,this}dpr(o){return Y.Dpr(this,o)}cpr(o){return Y.Cpr(this,o)}len2(){return Y.Len2(this)}len(){return Y.Len(this)}pry(o){return Y.Pry(this,o)}per(){const{x:o,y:n}=this;return this.x=n,this.y=-o,this}uni(){return Y.Uni(this)}tan(o){return Y.Tan(this,o)}dist(o){return Y.Dist(this,o)}distanceToLineSegment(o,n){return Y.DistanceToLineSegment(o,n,this)}slope(o){return Y.Slope(this,o)}snapToGrid(o){return this.x=Math.round(this.x/o)*o,this.y=Math.round(this.y/o)*o,this}angle(o){return Y.Angle(this,o)}toAngle(){return Y.ToAngle(this)}lrp(o,n){return this.x=this.x+(o.x-this.x)*n,this.y=this.y+(o.y-this.y)*n,this}equals(o){return Y.Equals(this,o)}equalsXY(o,n){return Y.EqualsXY(this,o,n)}norm(){const o=this.len();return this.x=o===0?0:this.x/o,this.y=o===0?0:this.y/o,this}toFixed(){return Y.ToFixed(this)}toString(){return Y.ToString(Y.ToFixed(this))}toJson(){return Y.ToJson(this)}toArray(){return Y.ToArray(this)}static Add(o,n){return new Y(o.x+n.x,o.y+n.y)}static AddXY(o,n,r){return new Y(o.x+n,o.y+r)}static Sub(o,n){return new Y(o.x-n.x,o.y-n.y)}static SubXY(o,n,r){return new Y(o.x-n,o.y-r)}static AddScalar(o,n){return new Y(o.x+n,o.y+n)}static SubScalar(o,n){return new Y(o.x-n,o.y-n)}static Div(o,n){return new Y(o.x/n,o.y/n)}static Mul(o,n){return new Y(o.x*n,o.y*n)}static DivV(o,n){return new Y(o.x/n.x,o.y/n.y)}static MulV(o,n){return new Y(o.x*n.x,o.y*n.y)}static Neg(o){return new Y(-o.x,-o.y)}static Per(o){return new Y(o.y,-o.x)}static Abs(o){return new Y(Math.abs(o.x),Math.abs(o.y))}static Dist(o,n){return((o.y-n.y)**2+(o.x-n.x)**2)**.5}static DistMin(o,n,r){return(o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)<r**2}static Dist2(o,n){return(o.x-n.x)*(o.x-n.x)+(o.y-n.y)*(o.y-n.y)}static Dpr(o,n){return o.x*n.x+o.y*n.y}static Cross(o,n){return new Y(o.y*n.z-o.z*n.y,o.z*n.x-o.x*n.z)}static Cpr(o,n){return o.x*n.y-n.x*o.y}static Len2(o){return o.x*o.x+o.y*o.y}static Len(o){return(o.x*o.x+o.y*o.y)**.5}static Pry(o,n){return Y.Dpr(o,n)/Y.Len(n)}static Uni(o){return Y.Div(o,Y.Len(o))}static Tan(o,n){return Y.Uni(Y.Sub(o,n))}static Min(o,n){return new Y(Math.min(o.x,n.x),Math.min(o.y,n.y))}static Max(o,n){return new Y(Math.max(o.x,n.x),Math.max(o.y,n.y))}static From({x:o,y:n,z:r=1}){return new Y(o,n,r)}static FromArray(o){return new Y(o[0],o[1])}static Rot(o,n=0){const r=Math.sin(n),s=Math.cos(n);return new Y(o.x*s-o.y*r,o.x*r+o.y*s)}static RotWith(o,n,r){const s=o.x-n.x,i=o.y-n.y,a=Math.sin(r),l=Math.cos(r);return new Y(n.x+(s*l-i*a),n.y+(s*a+i*l))}static NearestPointOnLineThroughPoint(o,n,r){return Y.Mul(n,Y.Sub(r,o).pry(n)).add(o)}static NearestPointOnLineSegment(o,n,r,s=!0){if(Y.Equals(o,r)||Y.Equals(n,r))return Y.From(r);const i=Y.Tan(n,o),a=Y.Add(o,Y.Mul(i,Y.Sub(r,o).pry(i)));if(s){if(a.x<Math.min(o.x,n.x))return Y.Cast(o.x<n.x?o:n);if(a.x>Math.max(o.x,n.x))return Y.Cast(o.x>n.x?o:n);if(a.y<Math.min(o.y,n.y))return Y.Cast(o.y<n.y?o:n);if(a.y>Math.max(o.y,n.y))return Y.Cast(o.y>n.y?o:n)}return a}static DistanceToLineThroughPoint(o,n,r){return Y.Dist(r,Y.NearestPointOnLineThroughPoint(o,n,r))}static DistanceToLineSegment(o,n,r,s=!0){return Y.Dist(r,Y.NearestPointOnLineSegment(o,n,r,s))}static Snap(o,n=1){return new Y(Math.round(o.x/n)*n,Math.round(o.y/n)*n)}static Cast(o){return o instanceof Y?o:Y.From(o)}static Slope(o,n){return o.x===n.y?NaN:(o.y-n.y)/(o.x-n.x)}static IsNaN(o){return isNaN(o.x)||isNaN(o.y)}static Angle(o,n){return Math.atan2(n.y-o.y,n.x-o.x)}static Lrp(o,n,r){return Y.Sub(n,o).mul(r).add(o)}static Med(o,n){return new Y((o.x+n.x)/2,(o.y+n.y)/2)}static Equals(o,n){return Math.abs(o.x-n.x)<1e-4&&Math.abs(o.y-n.y)<1e-4}static EqualsXY(o,n,r){return o.x===n&&o.y===r}static Clockwise(o,n,r){return(r.x-o.x)*(n.y-o.y)-(n.x-o.x)*(r.y-o.y)<0}static Rescale(o,n){const r=Y.Len(o);return new Y(n*o.x/r,n*o.y/r)}static ScaleWithOrigin(o,n,r){return Y.Sub(o,r).mul(n).add(r)}static ToFixed(o,n=2){return new Y(+o.x.toFixed(n),+o.y.toFixed(n),+o.z.toFixed(n))}static Nudge(o,n,r){return Y.Add(o,Y.Tan(n,o).mul(r))}static ToString(o){return`${o.x}, ${o.y}`}static ToAngle(o){let n=Math.atan2(o.y,o.x);return n<0&&(n+=Math.PI*2),n}static FromAngle(o,n=1){return new Y(Math.cos(o)*n,Math.sin(o)*n)}static ToArray(o){return[o.x,o.y,o.z]}static ToJson(o){const{x:n,y:r,z:s}=o;return{x:n,y:r,z:s}}static Average(o){const n=o.length,r=new Y(0,0);if(n===0)return r;for(let s=0;s<n;s++)r.add(o[s]);return r.div(n)}static Clamp(o,n,r){return r===void 0?new Y(Math.min(Math.max(o.x,n)),Math.min(Math.max(o.y,n))):new Y(Math.min(Math.max(o.x,n),r),Math.min(Math.max(o.y,n),r))}static PointsBetween(o,n,r=6){const s=[];for(let i=0;i<r;i++){const a=Kn.easeInQuad(i/(r-1)),l=Y.Lrp(o,n,a);l.z=Math.min(1,.5+Math.abs(.5-k6(a))*.65),s.push(l)}return s}static SnapToGrid(o,n=8){return new Y(Math.round(o.x/n)*n,Math.round(o.y/n)*n)}}const k6=t=>t<.5?2*t*t:-1+(4-2*t)*t;function In(t){return`${Ee(t.x)},${Ee(t.y)} `}function Eo(t,o){return`${Ee((t.x+o.x)/2)},${Ee((t.y+o.y)/2)} `}const Yt=Math.PI,dr=Yt/2,or=Yt*2,I6=Math.sin;function Ga(t,o,n){return Math.max(o,typeof n<"u"?Math.min(t,n):t)}function Ff(t,o=1e10){return t?Math.round(t*o)/o:0}function Bd(t,o,n=1e-6){return Math.abs(t-o)<=n}function ig(t,o){const n=Math.pow(t-o,2)/Math.pow(t+o,2);return Yt*(t+o)*(1+3*n/(10+Math.sqrt(4-3*n)))}function Na(t){return t=t%or,t<0?t=t+or:t===0&&(t=0),t}function Uh(t,o){return t=Na(t),o=Na(o),t>o&&(o+=or),o-t}function Vk(t,o){return or-Uh(t,o)}function Ap(t,o){const n=(o-t)%or;return 2*n%or-n}function Zb(t){return(or+t)%or}function ag(t,o){const n=or/o;let r=Math.floor((Zb(t)+n/2)/n)*n%or;return r<Yt&&(r+=or),r>Yt&&(r-=or),r}function Hk(t,o){return t===o||Bd(t%(Math.PI/2)-o%(Math.PI/2),0)}function M6(t){return t*Yt/180}function O6(t){return t*180/Yt}function Nl(t,o,n){return new Y(t.x,t.y).add(Y.FromAngle(n,o))}function E0(t,o,n){const r=t/2,s=o/2,i=[];let a=1/0,l=-1/0,c=1/0,u=-1/0;for(let m=0;m<n;m++){const g=or/n,b=-dr+m*g,y=r+r*Math.cos(b),v=s+s*Math.sin(b);y<a&&(a=y),v<c&&(c=v),y>l&&(l=y),v>u&&(u=v),i.push(new Y(y,v))}const f=l-a,h=u-c,d=t-f,p=o-h;if(d!==0||p!==0)for(let m=0;m<i.length;m++){const g=i[m];g.x=(g.x-a)/f*t,g.y=(g.y-c)/h*o}return i}function id(t,o,n,r){return t<r&&n<o}function Ms(t,o,n,r){const s=Math.max(t,n),i=Math.min(o,r);return s<=i?[s,i]:null}function v2(t,o,n){return(o.x-t.x)*(n.y-t.y)-(n.x-t.x)*(o.y-t.y)}function Zo(t,o){let n=0,r,s;for(let i=0;i<o.length;i++){if(r=o[i],r.x===t.x&&r.y===t.y||(s=o[(i+1)%o.length],Y.Dist(t,r)+Y.Dist(t,s)===Y.Dist(r,s)))return!0;r.y<=t.y?s.y>t.y&&v2(r,s,t)>0&&(n+=1):s.y<=t.y&&v2(r,s,t)<0&&(n-=1)}return n!==0}function Ee(t){return Math.round(t*1e4)/1e4}function lg(t){return Math.round(t*100)/100}const b2=t=>Math.abs(t)<Number.MAX_SAFE_INTEGER;function _a(t,o,n){return n<0?Uh(t,o):Vk(t,o)}function Qb(t,o,n,r){let s;if(Math.abs(t)>Yt){s=Ap(o,r);const i=Ap(r,n);return Math.abs(s)<Math.abs(i)?s/t:(t-i)/t}else{s=Ap(o,r);const i=s/t;return Math.sign(s)!==Math.sign(t)?Math.abs(i)>.5?1:0:i}}function A6(t,o,n,r){const s=2*((o-t)%or)%or-(o-t)%or;return r?(or-Math.abs(s))*(n?1:-1):s}const Nf=({brush:t,color:o,opacity:n,className:r})=>{const s=B.useRef(null);Mu(s,t.x,t.y);const i=Ee(Math.max(1,t.w)),a=Ee(Math.max(1,t.h));return C.jsx("svg",{className:"tl-overlays__item",ref:s,children:o?C.jsxs("g",{className:"tl-brush",opacity:n,children:[C.jsx("rect",{width:i,height:a,fill:o,opacity:.75}),C.jsx("rect",{width:i,height:a,fill:"none",stroke:o,opacity:.1})]}):C.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:i,height:a})})},Ei=2e3,cg=40,ti=320,fc=[.1,.25,.5,1,2,4,8],ad=.1,ja=8,R6=.5,D6=.1,L6=.2,F6=.005,N6=.05,$6=450,U6=200,Jb=36,gh=16,B6=32,vu={};for(let t=1;t<=Math.ceil(ja);t++)vu[t+"_dark"]=`hash_pattern_zoom_${t}_dark`,vu[t+"_light"]=`hash_pattern_zoom_${t}_light`;const z6={duration:0,easing:Kn.easeInOutCubic},Rp=.09,x2=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],G6=6e4,Wk=3e3,V6=1200,S2={CAMERA_MOVE:-10},H6=64,Vi=8,W6=20,Y6=8,X6=12,Yk=20,Xk=12,q6=["top","right","bottom","left"],K6=500,w2=.35,Z6={},qk=Uo("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),wn={logPreventDefaults:Uo("logPreventDefaults",{defaults:{all:!1}}),logPointerCaptures:Uo("logPointerCaptures",{defaults:{all:!1}}),logElementRemoves:Uo("logElementRemoves",{defaults:{all:!1}}),debugSvg:Uo("debugSvg",{defaults:{all:!1}}),showFps:Uo("showFps",{defaults:{all:!1}}),throwToBlob:Uo("throwToBlob",{defaults:{all:!1}}),reconnectOnPing:Uo("reconnectOnPing",{defaults:{all:!1}}),debugCursors:Uo("debugCursors",{defaults:{all:!1}}),forceSrgb:Uo("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:Uo("debugGeometry",{defaults:{all:!1}}),hideShapes:Uo("hideShapes",{defaults:{all:!1}}),editOnType:Uo("editOnType",{defaults:{all:!1}})};if(typeof Element<"u"){const t=Element.prototype.removeChild;ku("element removal logging",()=>{wn.logElementRemoves.get()?Element.prototype.removeChild=function(o){return console.warn("[tldraw] removing child:",o),t.call(this,o)}:Element.prototype.removeChild=t})}function Uo(t,{defaults:o,shouldStoreForSession:n=!0}){return Q6({name:t,defaults:o,shouldStoreForSession:n})}function Q6(t){const o=eF(t),n=t.shouldStoreForSession?J6(t.name):null,r=po(`debug:${t.name}`,n??o);return typeof window<"u"&&(t.shouldStoreForSession&&ku(`debug:${t.name}`,()=>{const s=r.get();s===o?ZT(`tldraw_debug:${t.name}`):Zx(`tldraw_debug:${t.name}`,JSON.stringify(s))}),Object.defineProperty(window,`tldraw${t.name.replace(/^[a-z]/,s=>s.toUpperCase())}`,{get(){return r.get()},set(s){r.set(s)},configurable:!0})),Object.assign(r,t)}function J6(t){try{return JSON.parse(KT(`tldraw_debug:${t}`)??"null")}catch{return null}}function C0(t){try{return t()}catch{return null}}function eF(t){switch(C0(()=>({}).TLDRAW_ENV)??C0(()=>({}).VERCEL_PUBLIC_TLDRAW_ENV)??C0(()=>({}).NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return t.defaults.production??t.defaults.all;case"preview":case"staging":return t.defaults.staging??t.defaults.all;default:return t.defaults.development??t.defaults.all}}function ug(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return ug(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function qt(t){t.preventDefault(),wn.logPreventDefaults.get()&&console.warn("preventDefault called on event:",t)}function Bh(t,o){if(t.setPointerCapture(o.pointerId),wn.logPointerCaptures.get()){const n=qk.get();n.set(t,(n.get(t)??0)+1),console.warn("setPointerCapture called on element:",t,o)}}function zh(t,o){if(t.hasPointerCapture(o.pointerId)&&(t.releasePointerCapture(o.pointerId),wn.logPointerCaptures.get())){const n=qk.get();n.get(t)===1?n.delete(t):n.has(t)?n.set(t,n.get(t)-1):console.warn("Release without capture"),console.warn("releasePointerCapture called on element:",t,o)}}const Rn=t=>t.stopPropagation(),Gn=(t,o,n)=>{t&&t.style.setProperty(o,n)};function To(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}function tF(){const t=Ue();return B.useMemo(function(){let r,s;function i(g){if(!g.isKilled){if(g.button===2){t.dispatch({type:"pointer",target:"canvas",name:"right_click",...To(g)});return}g.button!==0&&g.button!==1&&g.button!==5||(Bh(g.currentTarget,g),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...To(g)}),t.getOpenMenus().length>0&&(t.updateInstanceState({openMenus:[]}),document.body.click(),t.getContainer().focus()))}}function a(g){g.isKilled||g.clientX===r&&g.clientY===s||(r=g.clientX,s=g.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...To(g)}))}function l(g){g.isKilled||g.button!==0&&g.button!==1&&g.button!==2&&g.button!==5||(r=g.clientX,s=g.clientY,zh(g.currentTarget,g),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...To(g)}))}function c(g){if(g.isKilled||t.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const b=g.pointerType==="mouse"||g.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:b?!0:null})}function u(g){if(g.isKilled||t.getInstanceState().isPenMode&&g.pointerType!=="pen")return;const b=g.pointerType==="mouse"||g.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:b?!1:null})}function f(g){g.isKilled=!0,document.body.click(),qt(g)}function h(g){g.isKilled=!0,g.target.tagName!=="A"&&g.target.tagName!=="TEXTAREA"&&!(t.getEditingShape()&&g.target.className.includes("tl-text-content"))&&qt(g)}function d(g){qt(g)}async function p(g){var y,v;if(qt(g),!((v=(y=g.dataTransfer)==null?void 0:y.files)!=null&&v.length))return;const b=Array.from(g.dataTransfer.files);await t.putExternalContent({type:"files",files:b,point:t.screenToPage({x:g.clientX,y:g.clientY}),ignoreParent:!1})}function m(g){Rn(g)}return{onPointerDown:i,onPointerMove:a,onPointerUp:l,onPointerEnter:c,onPointerLeave:u,onDragOver:d,onDrop:p,onTouchStart:f,onTouchEnd:h,onClick:m}},[t])}function rF(){const t=Ue();B.useEffect(()=>{if(t.environment.isFirefox&&!t.environment.isAndroid&&!t.environment.isIos){t.updateInstanceState({isCoarsePointer:!1});return}if(window.matchMedia){const o=window.matchMedia("(pointer: coarse)"),n=()=>{t.updateInstanceState({isCoarsePointer:!!o.matches})};if(n(),o)return o.addEventListener("change",n),()=>o.removeEventListener("change",n)}},[t])}const Kk=B.createContext(null);function nF({container:t,children:o}){return C.jsx(Kk.Provider,{value:t,children:o})}function to(){return El(B.useContext(Kk),"useContainer used outside of <Tldraw />")}function oF(){const t=Ue(),o=to(),n=He("isFocused",()=>t.getInstanceState().isFocused,[t]);B.useEffect(()=>{if(typeof matchMedia===void 0)return;let r=null;const s=()=>{r!=null&&r();const i=`(resolution: ${window.devicePixelRatio}dppx)`,a=matchMedia(i),l=c=>{c.type==="change"&&s()};a.addEventListener?a.addEventListener("change",s):a.addListener&&a.addListener(l),r=()=>{a.removeEventListener?a.removeEventListener("change",s):a.removeListener&&a.removeListener(l)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return s(),()=>{r==null||r()}},[t]),B.useEffect(()=>{if(!n)return;const r=l=>{if(l.altKey&&(t.isIn("zoom")||!t.getPath().endsWith(".idle"))&&!$f()&&qt(l),l.isKilled)return;switch(l.isKilled=!0,l.key){case"=":case"-":case"0":{if(l.metaKey||l.ctrlKey){qt(l);return}break}case"Tab":{if($f()||t.getIsMenuOpen())return;break}case",":return;case"Escape":{if((t.getEditingShape()||t.getSelectedShapeIds().length>0)&&l.preventDefault(),t.getOpenMenus().length>0)return;t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),o.focus());return}default:if($f()||t.getIsMenuOpen())return}const c={type:"keyboard",name:l.repeat?"key_repeat":"key_down",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey};t.dispatch(c)},s=l=>{if(l.isKilled||(l.isKilled=!0,$f()||t.getIsMenuOpen())||l.key===",")return;const c={type:"keyboard",name:"key_up",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey};t.dispatch(c)};function i(l){var c,u;if(o.contains(l.target)){const f=l.touches[0].pageX,h=l.touches[0].radiusX||0;(f-h<10||f+h>t.getViewportScreenBounds().width-10)&&(((c=l.target)==null?void 0:c.tagName)==="BUTTON"&&((u=l.target)==null||u.click()),qt(l))}}const a=l=>{o.contains(l.target)&&(l.ctrlKey||l.metaKey)&&qt(l)};return o.addEventListener("touchstart",i,{passive:!1}),o.addEventListener("wheel",a,{passive:!1}),document.addEventListener("gesturestart",qt),document.addEventListener("gesturechange",qt),document.addEventListener("gestureend",qt),o.addEventListener("keydown",r),o.addEventListener("keyup",s),()=>{o.removeEventListener("touchstart",i),o.removeEventListener("wheel",a),document.removeEventListener("gesturestart",qt),document.removeEventListener("gesturechange",qt),document.removeEventListener("gestureend",qt),o.removeEventListener("keydown",r),o.removeEventListener("keyup",s)}},[t,o,n])}const sF=["input","select","button","textarea"];function $f(){const{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||sF.indexOf(t.tagName.toLowerCase())>-1))}const iF=["textarea","input"];function aF(t){const o=Ue();B.useEffect(()=>{const n=t.current;if(!n)return;const r=s=>{var i;if(s instanceof PointerEvent&&s.pointerType==="pen"){s.isKilled=!0;const{target:a}=s;if(iF.includes((i=a.tagName)==null?void 0:i.toLocaleLowerCase())||o.isIn("select.editing_shape"))return;qt(s)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.removeEventListener("touchend",r)}},[o,t])}function lF(t,o,n){return Math.max(o,Math.min(t,n))}const On={toVector(t,o){return t===void 0&&(t=o),Array.isArray(t)?t:[t,t]},add(t,o){return[t[0]+o[0],t[1]+o[1]]},sub(t,o){return[t[0]-o[0],t[1]-o[1]]},addTo(t,o){t[0]+=o[0],t[1]+=o[1]},subTo(t,o){t[0]-=o[0],t[1]-=o[1]}};function _2(t,o,n){return o===0||Math.abs(o)===1/0?Math.pow(t,n*5):t*o*n/(o+n*t)}function j2(t,o,n,r=.15){return r===0?lF(t,o,n):t<o?-_2(o-t,n-o,r)+o:t>n?+_2(t-n,n-o,r)+n:t}function cF(t,[o,n],[r,s]){const[[i,a],[l,c]]=t;return[j2(o,i,a,r),j2(n,l,c,s)]}function uF(t,o){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,o||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(t)}function dF(t){var o=uF(t,"string");return typeof o=="symbol"?o:String(o)}function Hn(t,o,n){return o=dF(o),o in t?Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[o]=n,t}function E2(t,o){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);o&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ur(t){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?arguments[o]:{};o%2?E2(Object(n),!0).forEach(function(r){Hn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E2(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const Zk={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function C2(t){return t?t[0].toUpperCase()+t.slice(1):""}const hF=["enter","leave"];function fF(t=!1,o){return t&&!hF.includes(o)}function pF(t,o="",n=!1){const r=Zk[t],s=r&&r[o]||o;return"on"+C2(t)+C2(s)+(fF(n,s)?"Capture":"")}const mF=["gotpointercapture","lostpointercapture"];function gF(t){let o=t.substring(2).toLowerCase();const n=!!~o.indexOf("passive");n&&(o=o.replace("passive",""));const r=mF.includes(o)?"capturecapture":"capture",s=!!~o.indexOf(r);return s&&(o=o.replace("capture","")),{device:o,capture:s,passive:n}}function yF(t,o=""){const n=Zk[t],r=n&&n[o]||o;return t+r}function Qk(t){return"touches"in t}function vF(t){return Qk(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function bF(t){return Array.from(t.touches).filter(o=>{var n,r;return o.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,o.target))})}function e1(t,o){try{const n=o.clientX-t.clientX,r=o.clientY-t.clientY,s=(o.clientX+t.clientX)/2,i=(o.clientY+t.clientY)/2,a=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:a,origin:[s,i]}}catch{}return null}function xF(t){return bF(t).map(o=>o.identifier)}function P2(t,o){const[n,r]=Array.from(t.touches).filter(s=>o.includes(s.identifier));return e1(n,r)}const T2=40,k2=800;function Jk(t){let{deltaX:o,deltaY:n,deltaMode:r}=t;return r===1?(o*=T2,n*=T2):r===2&&(o*=k2,n*=k2),[o,n]}function SF(t){const o={};if("buttons"in t&&(o.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i}=t;Object.assign(o,{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i})}return o}function dg(t,...o){return typeof t=="function"?t(...o):t}function wF(){}function _F(...t){return t.length===0?wF:t.length===1?t[0]:function(){let o;for(const n of t)o=n.apply(this,arguments)||o;return o}}function I2(t,o){return Object.assign({},o,t||{})}const jF=32;class eI{constructor(o,n,r){this.ctrl=o,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(o){this.ctrl.state[this.key]=o}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:o,shared:n,ingKey:r,args:s}=this;n[r]=o._active=o.active=o._blocked=o._force=!1,o._step=[!1,!1],o.intentional=!1,o._movement=[0,0],o._distance=[0,0],o._direction=[0,0],o._delta=[0,0],o._bounds=[[-1/0,1/0],[-1/0,1/0]],o.args=s,o.axis=void 0,o.memo=void 0,o.elapsedTime=o.timeDelta=0,o.direction=[0,0],o.distance=[0,0],o.overflow=[0,0],o._movementBound=[!1,!1],o.velocity=[0,0],o.movement=[0,0],o.delta=[0,0],o.timeStamp=0}start(o){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=o.target,n.currentTarget=o.currentTarget,n.lastOffset=r.from?dg(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=o.timeStamp)}computeValues(o){const n=this.state;n._values=o,n.values=this.config.transform(o)}computeInitial(){const o=this.state;o._initial=o._values,o.initial=o.values}compute(o){const{state:n,config:r,shared:s}=this;n.args=this.args;let i=0;if(o&&(n.event=o,r.preventDefault&&o.cancelable&&n.event.preventDefault(),n.type=o.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,SF(o)),s.down=s.pressed=s.buttons%2===1||s.touches>0,i=o.timeStamp-n.timeStamp,n.timeStamp=o.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const E=n._delta.map(Math.abs);On.addTo(n._distance,E)}this.axisIntent&&this.axisIntent(o);const[a,l]=n._movement,[c,u]=r.threshold,{_step:f,values:h}=n;if(r.hasCustomTransform?(f[0]===!1&&(f[0]=Math.abs(a)>=c&&h[0]),f[1]===!1&&(f[1]=Math.abs(l)>=u&&h[1])):(f[0]===!1&&(f[0]=Math.abs(a)>=c&&Math.sign(a)*c),f[1]===!1&&(f[1]=Math.abs(l)>=u&&Math.sign(l)*u)),n.intentional=f[0]!==!1||f[1]!==!1,!n.intentional)return;const d=[0,0];if(r.hasCustomTransform){const[E,j]=h;d[0]=f[0]!==!1?E-f[0]:0,d[1]=f[1]!==!1?j-f[1]:0}else d[0]=f[0]!==!1?a-f[0]:0,d[1]=f[1]!==!1?l-f[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(d);const p=n.offset,m=n._active&&!n._blocked||n.active;m&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=s[this.ingKey]=n._active,o&&(n.first&&("bounds"in r&&(n._bounds=dg(r.bounds,n)),this.setup&&this.setup()),n.movement=d,this.computeOffset()));const[g,b]=n.offset,[[y,v],[x,S]]=n._bounds;n.overflow=[g<y?-1:g>v?1:0,b<x?-1:b>S?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const w=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=cF(n._bounds,n.offset,w),n.delta=On.sub(n.offset,p),this.computeMovement(),m&&(!n.last||i>jF)){n.delta=On.sub(n.offset,p);const E=n.delta.map(Math.abs);On.addTo(n.distance,E),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&i>0&&(n.velocity=[E[0]/i,E[1]/i],n.timeDelta=i)}}emit(){const o=this.state,n=this.shared,r=this.config;if(o._active||this.clean(),(o._blocked||!o.intentional)&&!o._force&&!r.triggerAllEvents)return;const s=this.handler(Ur(Ur(Ur({},n),o),{},{[this.aliasKey]:o.values}));s!==void 0&&(o.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function EF([t,o],n){const r=Math.abs(t),s=Math.abs(o);if(r>s&&r>n)return"x";if(s>r&&s>n)return"y"}class CF extends eI{constructor(...o){super(...o),Hn(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=On.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=On.sub(this.state.offset,this.state.lastOffset)}axisIntent(o){const n=this.state,r=this.config;if(!n.axis&&o){const s=typeof r.axisThreshold=="object"?r.axisThreshold[vF(o)]:r.axisThreshold;n.axis=EF(n._movement,s)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(o){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":o[1]=0;break;case"y":o[0]=0;break}}}const PF=t=>t,M2=.15,tI={enabled(t=!0){return t},eventOptions(t,o,n){return Ur(Ur({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[M2,M2];case!1:return[0,0];default:return On.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return On.toVector(t)},transform(t,o,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||PF},threshold(t){return On.toVector(t,0)}},TF=0,Gh=Ur(Ur({},tI),{},{axis(t,o,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=TF){return t},bounds(t={}){if(typeof t=="function")return i=>Gh.bounds(t(i));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:o=-1/0,right:n=1/0,top:r=-1/0,bottom:s=1/0}=t;return[[o,n],[r,s]]}}),Vh=typeof window<"u"&&window.document&&window.document.createElement;function rI(){return Vh&&"ontouchstart"in window}function kF(){return rI()||Vh&&window.navigator.maxTouchPoints>1}function IF(){return Vh&&"onpointerdown"in window}function MF(){return Vh&&"exitPointerLock"in window.document}function OF(){try{return"constructor"in GestureEvent}catch{return!1}}const hs={isBrowser:Vh,gesture:OF(),touch:rI(),touchscreen:kF(),pointer:IF(),pointerLock:MF()},AF=250,RF=180,DF=.5,LF=50,FF=250,NF=10,O2={mouse:0,touch:0,pen:8};Ur(Ur({},Gh),{},{device(t,o,{pointer:{touch:n=!1,lock:r=!1,mouse:s=!1}={}}){return this.pointerLock=r&&hs.pointerLock,hs.touch&&n?"touch":this.pointerLock?"mouse":hs.pointer&&!s?"pointer":hs.touch?"touch":"mouse"},preventScrollAxis(t,o,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?AF:void 0,!(!hs.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,o,{pointer:{capture:n=!0,buttons:r=1,keys:s=!0}={}}){return this.pointerButtons=r,this.keys=s,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,o,{filterTaps:n=!1,tapsThreshold:r=3,axis:s=void 0}){const i=On.toVector(t,n?r:s?1:0);return this.filterTaps=n,this.tapsThreshold=r,i},swipe({velocity:t=DF,distance:o=LF,duration:n=FF}={}){return{velocity:this.transform(On.toVector(t)),distance:this.transform(On.toVector(o)),duration:n}},delay(t=0){switch(t){case!0:return RF;case!1:return 0;default:return t}},axisThreshold(t){return t?Ur(Ur({},O2),t):O2},keyboardDisplacement(t=NF){return t}});function nI(t){const[o,n]=t.overflow,[r,s]=t._delta,[i,a]=t._direction;(o<0&&r>0&&i<0||o>0&&r<0&&i>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&s>0&&a<0||n>0&&s<0&&a>0)&&(t._movement[1]=t._movementBound[1])}const $F=30,UF=100;class BF extends eI{constructor(...o){super(...o),Hn(this,"ingKey","pinching"),Hn(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const o=this.state;o._touchIds=[],o.canceled=!1,o.cancel=this.cancel.bind(this),o.turns=0}computeOffset(){const{type:o,movement:n,lastOffset:r}=this.state;o==="wheel"?this.state.offset=On.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:o,lastOffset:n}=this.state;this.state.movement=[o[0]/n[0],o[1]-n[1]]}axisIntent(){const o=this.state,[n,r]=o._movement;if(!o.axis){const s=Math.abs(n)*$F-Math.abs(r);s<0?o.axis="angle":s>0&&(o.axis="scale")}}restrictToAxis(o){this.config.lockDirection&&(this.state.axis==="scale"?o[1]=0:this.state.axis==="angle"&&(o[0]=0))}cancel(){const o=this.state;o.canceled||setTimeout(()=>{o.canceled=!0,o._active=!1,this.compute(),this.emit()},0)}touchStart(o){this.ctrl.setEventIds(o);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(i=>r.has(i))||r.size<2)return;this.start(o),n._touchIds=Array.from(r).slice(0,2);const s=P2(o,n._touchIds);s&&this.pinchStart(o,s)}pointerStart(o){if(o.buttons!=null&&o.buttons%2!==1)return;this.ctrl.setEventIds(o),o.target.setPointerCapture(o.pointerId);const n=this.state,r=n._pointerEvents,s=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(a=>s.has(a))||(r.size<2&&r.set(o.pointerId,o),n._pointerEvents.size<2))return;this.start(o);const i=e1(...Array.from(r.values()));i&&this.pinchStart(o,i)}pinchStart(o,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(o),this.emit()}touchMove(o){if(!this.state._active)return;const n=P2(o,this.state._touchIds);n&&this.pinchMove(o,n)}pointerMove(o){const n=this.state._pointerEvents;if(n.has(o.pointerId)&&n.set(o.pointerId,o),!this.state._active)return;const r=e1(...Array.from(n.values()));r&&this.pinchMove(o,r)}pinchMove(o,n){const r=this.state,s=r._values[1],i=n.angle-s;let a=0;Math.abs(i)>270&&(a+=Math.sign(i)),this.computeValues([n.distance,n.angle-360*a]),r.origin=n.origin,r.turns=a,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(o),this.emit()}touchEnd(o){this.ctrl.setEventIds(o),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(o),this.emit())}pointerEnd(o){const n=this.state;this.ctrl.setEventIds(o);try{o.target.releasePointerCapture(o.pointerId)}catch{}n._pointerEvents.has(o.pointerId)&&n._pointerEvents.delete(o.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(o),this.emit())}gestureStart(o){o.cancelable&&o.preventDefault();const n=this.state;n._active||(this.start(o),this.computeValues([o.scale,o.rotation]),n.origin=[o.clientX,o.clientY],this.compute(o),this.emit())}gestureMove(o){if(o.cancelable&&o.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([o.scale,o.rotation]),n.origin=[o.clientX,o.clientY];const r=n._movement;n._movement=[o.scale-1,o.rotation],n._delta=On.sub(n._movement,r),this.compute(o),this.emit()}gestureEnd(o){this.state._active&&(this.state._active=!1,this.compute(o),this.emit())}wheel(o){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>o[r]):!o[n])||(this.state._active?this.wheelChange(o):this.wheelStart(o),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(o){this.start(o),this.wheelChange(o)}wheelChange(o){"uv"in o||o.cancelable&&o.preventDefault();const r=this.state;r._delta=[-Jk(o)[1]/UF*r.offset[0],0],On.addTo(r._movement,r._delta),nI(r),this.state.origin=[o.clientX,o.clientY],this.compute(o),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(o){const n=this.config.device;n&&(o(n,"start",this[n+"Start"].bind(this)),o(n,"change",this[n+"Move"].bind(this)),o(n,"end",this[n+"End"].bind(this)),o(n,"cancel",this[n+"End"].bind(this)),o("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&o("wheel","",this.wheel.bind(this),{passive:!1})}}const zF=Ur(Ur({},tI),{},{device(t,o,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!hs.touch&&hs.gesture)return"gesture";if(hs.touch&&r)return"touch";if(hs.touchscreen){if(hs.pointer)return"pointer";if(hs.touch)return"touch"}},bounds(t,o,{scaleBounds:n={},angleBounds:r={}}){const s=a=>{const l=I2(dg(n,a),{min:-1/0,max:1/0});return[l.min,l.max]},i=a=>{const l=I2(dg(r,a),{min:-1/0,max:1/0});return[l.min,l.max]};return typeof n!="function"&&typeof r!="function"?[s(),i()]:a=>[s(a),i(a)]},threshold(t,o,n){return this.lockDirection=n.axis==="lock",On.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});Ur(Ur({},Gh),{},{mouseOnly:(t=!0)=>t});class GF extends CF{constructor(...o){super(...o),Hn(this,"ingKey","wheeling")}wheel(o){this.state._active||this.start(o),this.wheelChange(o),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(o){const n=this.state;n._delta=Jk(o),On.addTo(n._movement,n._delta),nI(n),this.compute(o),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(o){o("wheel","",this.wheel.bind(this))}}const VF=Gh;Ur(Ur({},Gh),{},{mouseOnly:(t=!0)=>t});const iS=new Map,t1=new Map;function HF(t){iS.set(t.key,t.engine),t1.set(t.key,t.resolver)}const WF={key:"pinch",engine:BF,resolver:zF},YF={key:"wheel",engine:GF,resolver:VF};function XF(t,o){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(o.indexOf(s)>=0)&&(n[s]=t[s]);return n}function qF(t,o){if(t==null)return{};var n=XF(t,o),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(o.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const KF={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=hs.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:o=!1}={}){return{passive:t,capture:o}},transform(t){return t}},ZF=["target","eventOptions","window","enabled","transform"];function Dp(t={},o){const n={};for(const[r,s]of Object.entries(o))switch(typeof s){case"function":n[r]=s.call(n,t[r],r,t);break;case"object":n[r]=Dp(t[r],s);break;case"boolean":s&&(n[r]=t[r]);break}return n}function QF(t,o,n={}){const r=t,{target:s,eventOptions:i,window:a,enabled:l,transform:c}=r,u=qF(r,ZF);if(n.shared=Dp({target:s,eventOptions:i,window:a,enabled:l,transform:c},KF),o){const f=t1.get(o);n[o]=Dp(Ur({shared:n.shared},u),f)}else for(const f in u){const h=t1.get(f);h&&(n[f]=Dp(Ur({shared:n.shared},u[f]),h))}return n}class oI{constructor(o,n){Hn(this,"_listeners",new Set),this._ctrl=o,this._gestureKey=n}add(o,n,r,s,i){const a=this._listeners,l=yF(n,r),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},u=Ur(Ur({},c),i);o.addEventListener(l,s,u);const f=()=>{o.removeEventListener(l,s,u),a.delete(f)};return a.add(f),f}clean(){this._listeners.forEach(o=>o()),this._listeners.clear()}}class JF{constructor(){Hn(this,"_timeouts",new Map)}add(o,n,r=140,...s){this.remove(o),this._timeouts.set(o,window.setTimeout(n,r,...s))}remove(o){const n=this._timeouts.get(o);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(o=>void window.clearTimeout(o)),this._timeouts.clear()}}class e8{constructor(o){Hn(this,"gestures",new Set),Hn(this,"_targetEventStore",new oI(this)),Hn(this,"gestureEventStores",{}),Hn(this,"gestureTimeoutStores",{}),Hn(this,"handlers",{}),Hn(this,"config",{}),Hn(this,"pointerIds",new Set),Hn(this,"touchIds",new Set),Hn(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),t8(this,o)}setEventIds(o){if(Qk(o))return this.touchIds=new Set(xF(o)),this.touchIds;if("pointerId"in o)return o.type==="pointerup"||o.type==="pointercancel"?this.pointerIds.delete(o.pointerId):o.type==="pointerdown"&&this.pointerIds.add(o.pointerId),this.pointerIds}applyHandlers(o,n){this.handlers=o,this.nativeHandlers=n}applyConfig(o,n){this.config=QF(o,n,this.config)}clean(){this._targetEventStore.clean();for(const o of this.gestures)this.gestureEventStores[o].clean(),this.gestureTimeoutStores[o].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...o){const n=this.config.shared,r={};let s;if(!(n.target&&(s=n.target(),!s))){if(n.enabled){for(const a of this.gestures){const l=this.config[a],c=A2(r,l.eventOptions,!!s);if(l.enabled){const u=iS.get(a);new u(this,o,a).bind(c)}}const i=A2(r,n.eventOptions,!!s);for(const a in this.nativeHandlers)i(a,"",l=>this.nativeHandlers[a](Ur(Ur({},this.state.shared),{},{event:l,args:o})),void 0,!0)}for(const i in r)r[i]=_F(...r[i]);if(!s)return r;for(const i in r){const{device:a,capture:l,passive:c}=gF(i);this._targetEventStore.add(s,a,"",r[i],{capture:l,passive:c})}}}}function pc(t,o){t.gestures.add(o),t.gestureEventStores[o]=new oI(t,o),t.gestureTimeoutStores[o]=new JF}function t8(t,o){o.drag&&pc(t,"drag"),o.wheel&&pc(t,"wheel"),o.scroll&&pc(t,"scroll"),o.move&&pc(t,"move"),o.pinch&&pc(t,"pinch"),o.hover&&pc(t,"hover")}const A2=(t,o,n)=>(r,s,i,a={},l=!1)=>{var c,u;const f=(c=a.capture)!==null&&c!==void 0?c:o.capture,h=(u=a.passive)!==null&&u!==void 0?u:o.passive;let d=l?r:pF(r,s,f);n&&h&&(d+="Passive"),t[d]=t[d]||[],t[d].push(i)},r8=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function n8(t){const o={},n={},r=new Set;for(let s in t)r8.test(s)?(r.add(RegExp.lastMatch),n[s]=t[s]):o[s]=t[s];return[n,o,r]}function mc(t,o,n,r,s,i){if(!t.has(n)||!iS.has(r))return;const a=n+"Start",l=n+"End",c=u=>{let f;return u.first&&a in o&&o[a](u),n in o&&(f=o[n](u)),u.last&&l in o&&o[l](u),f};s[r]=c,i[r]=i[r]||{}}function o8(t,o){const[n,r,s]=n8(t),i={};return mc(s,n,"onDrag","drag",i,o),mc(s,n,"onWheel","wheel",i,o),mc(s,n,"onScroll","scroll",i,o),mc(s,n,"onPinch","pinch",i,o),mc(s,n,"onMove","move",i,o),mc(s,n,"onHover","hover",i,o),{handlers:i,config:o,nativeHandlers:r}}function s8(t,o={},n,r){const s=Ut.useMemo(()=>new e8(t),[]);if(s.applyHandlers(t,r),s.applyConfig(o,n),Ut.useEffect(s.effect.bind(s)),Ut.useEffect(()=>s.clean.bind(s),[]),o.target===void 0)return s.bind.bind(s)}function i8(t){return t.forEach(HF),function(n,r){const{handlers:s,nativeHandlers:i,config:a}=o8(n,r||{});return s8(s,a,void 0,i)}}const R2=10,a8=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function sI(t){let{deltaY:o,deltaX:n}=t,r=0;if(t.ctrlKey||t.altKey||t.metaKey){const s=Math.sign(t.deltaY),i=Math.abs(t.deltaY);let a=o;i>R2&&(a=R2*s),r=a/100}else t.shiftKey&&!a8&&(n=o,o=0);return{x:-n,y:-o,z:-r}}const l8=i8([YF,WF]);let gc;const c8=t=>gc===void 0?(gc=t,!1):t-gc>120&&t-gc<160?(gc=t,!0):(gc=t,!1);function u8(t){const o=Ue(),n=B.useMemo(()=>{let r="not sure";const s=({event:g})=>{if(!o.getInstanceState().isFocused||(r="not sure",c8(Date.now())))return;const b=o.getEditingShapeId();if(b){const x=o.getShape(b);if(x&&o.getShapeUtil(x).canScroll(x)){const w=o.getShapePageBounds(b);if(w!=null&&w.containsPoint(o.inputs.currentPagePoint))return}}qt(g),Rn(g);const y=sI(g);if(y.x===0&&y.y===0)return;const v={type:"wheel",name:"wheel",delta:y,point:new Y(g.clientX,g.clientY),shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey};o.dispatch(v)};let i=1,a=1,l=1,c=0;const u=new Y,f=new Y,h=g=>{const b=t.current;r="not sure";const{event:y,origin:v,da:x}=g;y instanceof WheelEvent||(y.target===b||b!=null&&b.contains(y.target))&&(f.x=v[0],f.y=v[1],u.x=v[0],u.y=v[1],i=x[0],a=o.getZoomLevel(),o.dispatch({type:"pinch",name:"pinch_start",point:{x:v[0],y:v[1],z:o.getZoomLevel()},delta:{x:0,y:0},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey}))},d=g=>{if(g&&(r="zooming"),r==="zooming")return;const b=Math.abs(c-i),y=Y.Dist(u,f);switch(r){case"not sure":{b>24?r="zooming":y>16&&(r="panning");break}case"panning":{b>64&&(r="zooming");break}}};return{onWheel:s,onPinchStart:h,onPinchEnd:g=>{const b=t.current,{event:y,origin:v,offset:x}=g;if(y instanceof WheelEvent||!(y.target===b||b!=null&&b.contains(y.target)))return;const S=x[0];r="not sure",requestAnimationFrame(()=>{o.dispatch({type:"pinch",name:"pinch_end",point:{x:v[0],y:v[1],z:S},delta:{x:v[0],y:v[1]},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey})})},onPinch:g=>{const b=t.current,{event:y,origin:v,offset:x,da:S}=g;if(y instanceof WheelEvent||!(y.target===b||b!=null&&b.contains(y.target)))return;const w=g.type==="gesturechange"||g.type==="gestureend";c=S[0];const E=v[0]-f.x,j=v[1]-f.y;switch(f.x=v[0],f.y=v[1],d(w),r){case"zooming":{l=x[0],o.dispatch({type:"pinch",name:"pinch",point:{x:v[0],y:v[1],z:l},delta:{x:E,y:j},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey});break}case"panning":{o.dispatch({type:"pinch",name:"pinch",point:{x:v[0],y:v[1],z:a},delta:{x:E,y:j},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey});break}}}}},[o,t]);l8(n,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[o.getZoomLevel(),0],scaleBounds:()=>({from:o.getZoomLevel(),max:8,min:.05})}})}function P0(t,o,n){const r=t.getShape(o),s=t.getShapeHandles(r);return{shape:r,handle:s.find(i=>i.id===n)}}function d8(t,o){const n=Ue();return B.useMemo(()=>{const r=c=>{if(c.isKilled)return;const u=ug(c.currentTarget);Bh(u,c);const{shape:f,handle:h}=P0(n,t,o);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:f,name:"pointer_down",...To(c)})};let s,i;return{onPointerDown:r,onPointerMove:c=>{if(c.isKilled||c.clientX===s&&c.clientY===i)return;s=c.clientX,i=c.clientY;const{shape:u,handle:f}=P0(n,t,o);f&&n.dispatch({type:"pointer",target:"handle",handle:f,shape:u,name:"pointer_move",...To(c)})},onPointerUp:c=>{if(c.isKilled)return;const u=ug(c.currentTarget);zh(u,c);const{shape:f,handle:h}=P0(n,t,o);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:f,name:"pointer_up",...To(c)})}}},[n,t,o])}var iI="Expected a function",D2=0/0,h8="[object Symbol]",f8=/^\s+|\s+$/g,p8=/^[-+]0x[0-9a-f]+$/i,m8=/^0b[01]+$/i,g8=/^0o[0-7]+$/i,y8=parseInt,v8=typeof fn=="object"&&fn&&fn.Object===Object&&fn,b8=typeof self=="object"&&self&&self.Object===Object&&self,x8=v8||b8||Function("return this")(),S8=Object.prototype,w8=S8.toString,_8=Math.max,j8=Math.min,T0=function(){return x8.Date.now()};function E8(t,o,n){var r,s,i,a,l,c,u=0,f=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(iI);o=L2(o)||0,hg(n)&&(f=!!n.leading,h="maxWait"in n,i=h?_8(L2(n.maxWait)||0,o):i,d="trailing"in n?!!n.trailing:d);function p(E){var j=r,P=s;return r=s=void 0,u=E,a=t.apply(P,j),a}function m(E){return u=E,l=setTimeout(y,o),f?p(E):a}function g(E){var j=E-c,P=E-u,M=o-j;return h?j8(M,i-P):M}function b(E){var j=E-c,P=E-u;return c===void 0||j>=o||j<0||h&&P>=i}function y(){var E=T0();if(b(E))return v(E);l=setTimeout(y,g(E))}function v(E){return l=void 0,d&&r?p(E):(r=s=void 0,a)}function x(){l!==void 0&&clearTimeout(l),u=0,r=c=s=l=void 0}function S(){return l===void 0?a:v(T0())}function w(){var E=T0(),j=b(E);if(r=arguments,s=this,c=E,j){if(l===void 0)return m(c);if(h)return l=setTimeout(y,o),p(c)}return l===void 0&&(l=setTimeout(y,o)),a}return w.cancel=x,w.flush=S,w}function C8(t,o,n){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(iI);return hg(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),E8(t,o,{leading:r,maxWait:o,trailing:s})}function hg(t){var o=typeof t;return!!t&&(o=="object"||o=="function")}function P8(t){return!!t&&typeof t=="object"}function T8(t){return typeof t=="symbol"||P8(t)&&w8.call(t)==h8}function L2(t){if(typeof t=="number")return t;if(T8(t))return D2;if(hg(t)){var o=typeof t.valueOf=="function"?t.valueOf():t;t=hg(o)?o+"":o}if(typeof t!="string")return t===0?t:+t;t=t.replace(f8,"");var n=m8.test(t);return n||g8.test(t)?y8(t.slice(2),n?2:8):p8.test(t)?D2:+t}var k8=C8;const I8=Xl(k8),Ir=class Ir{constructor(o=0,n=0,r=0,s=0){D(this,"x",0);D(this,"y",0);D(this,"w",0);D(this,"h",0);this.x=o,this.y=n,this.w=r,this.h=s}get point(){return new Y(this.x,this.y)}set point(o){this.x=o.x,this.y=o.y}get minX(){return this.x}set minX(o){this.x=o}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(o){this.y=o}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(o){this.w=o}get height(){return this.h}set height(o){this.h=o}get aspectRatio(){return this.width/this.height}get center(){return new Y(this.midX,this.midY)}set center(o){this.minX=o.x-this.width/2,this.minY=o.y-this.height/2}get corners(){return[new Y(this.minX,this.minY),new Y(this.maxX,this.minY),new Y(this.maxX,this.maxY),new Y(this.minX,this.maxY)]}get cornersAndCenter(){return[new Y(this.minX,this.minY),new Y(this.maxX,this.minY),new Y(this.maxX,this.maxY),new Y(this.minX,this.maxY),this.center]}get sides(){const{corners:o}=this;return[[o[0],o[1]],[o[1],o[2]],[o[2],o[3]],[o[3],o[0]]]}get size(){return new Y(this.w,this.h)}toFixed(){return this.x=Ff(this.x),this.y=Ff(this.y),this.w=Ff(this.w),this.h=Ff(this.h),this}setTo(o){return this.x=o.x,this.y=o.y,this.w=o.w,this.h=o.h,this}set(o=0,n=0,r=0,s=0){return this.x=o,this.y=n,this.w=r,this.h=s,this}expand(o){const n=Math.min(this.minX,o.minX),r=Math.min(this.minY,o.minY),s=Math.max(this.maxX,o.maxX),i=Math.max(this.maxY,o.maxY);return this.x=n,this.y=r,this.w=s-n,this.h=i-r,this}expandBy(o){return this.x-=o,this.y-=o,this.w+=o*2,this.h+=o*2,this}scale(o){return this.x/=o,this.y/=o,this.w/=o,this.h/=o,this}clone(){const{x:o,y:n,w:r,h:s}=this;return new Ir(o,n,r,s)}translate(o){return this.x+=o.x,this.y+=o.y,this}snapToGrid(o){const n=Math.round(this.minX/o)*o,r=Math.round(this.minY/o)*o,s=Math.round(this.maxX/o)*o,i=Math.round(this.maxY/o)*o;this.minX=n,this.minY=r,this.width=Math.max(1,s-n),this.height=Math.max(1,i-r)}collides(o){return Ir.Collides(this,o)}contains(o){return Ir.Contains(this,o)}includes(o){return Ir.Includes(this,o)}containsPoint(o,n=0){return Ir.ContainsPoint(this,o,n)}getHandlePoint(o){switch(o){case"top_left":return new Y(this.minX,this.minY);case"top_right":return new Y(this.maxX,this.minY);case"bottom_left":return new Y(this.minX,this.maxY);case"bottom_right":return new Y(this.maxX,this.maxY);case"top":return new Y(this.midX,this.minY);case"right":return new Y(this.maxX,this.midY);case"bottom":return new Y(this.midX,this.maxY);case"left":return new Y(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(o,n,r){const{minX:s,minY:i,maxX:a,maxY:l}=this;let{minX:c,minY:u,maxX:f,maxY:h}=this;switch(o){case"left":case"top_left":case"bottom_left":{c+=n;break}case"right":case"top_right":case"bottom_right":{f+=n;break}}switch(o){case"top":case"top_left":case"top_right":{u+=r;break}case"bottom":case"bottom_left":case"bottom_right":{h+=r;break}}const d=(f-c)/(a-s),p=(h-u)/(l-i),m=d<0,g=p<0;if(m){const b=f;f=c,c=b}if(g){const b=h;h=u,u=b}this.minX=c,this.minY=u,this.width=Math.abs(f-c),this.height=Math.abs(h-u)}union(o){const n=Math.min(this.minX,o.x),r=Math.min(this.minY,o.y),s=Math.max(this.maxX,o.w+o.x),i=Math.max(this.maxY,o.h+o.y);return this.x=n,this.y=r,this.width=s-n,this.height=i-r,this}static From(o){return new Ir(o.x,o.y,o.w,o.h)}static FromCenter(o,n){return new Ir(o.x-n.x/2,o.y-n.y/2,n.x,n.y)}static FromPoints(o){if(o.length===0)return new Ir;let n=1/0,r=1/0,s=-1/0,i=-1/0,a;for(let l=0,c=o.length;l<c;l++)a=o[l],n=Math.min(a.x,n),r=Math.min(a.y,r),s=Math.max(a.x,s),i=Math.max(a.y,i);return new Ir(n,r,s-n,i-r)}static Expand(o,n){const r=Math.min(n.minX,o.minX),s=Math.min(n.minY,o.minY),i=Math.max(n.maxX,o.maxX),a=Math.max(n.maxY,o.maxY);return new Ir(r,s,i-r,a-s)}static ExpandBy(o,n){return new Ir(o.minX-n,o.minY-n,o.width+n*2,o.height+n*2)}static Resize(o,n,r,s,i=!1){const{minX:a,minY:l,maxX:c,maxY:u}=o;let{minX:f,minY:h,maxX:d,maxY:p}=o;switch(n){case"left":case"top_left":case"bottom_left":{f+=r;break}case"right":case"top_right":case"bottom_right":{d+=r;break}}switch(n){case"top":case"top_left":case"top_right":{h+=s;break}case"bottom":case"bottom_left":case"bottom_right":{p+=s;break}}const m=(d-f)/(c-a),g=(p-h)/(u-l),b=m<0,y=g<0;if(i){const x=(c-a)/(u-l),S=Math.abs(d-f),w=Math.abs(p-h),E=S*(g<0?1:-1)*(1/x),j=w*(m<0?1:-1)*x,P=x<S/w;switch(n){case"top_left":{P?h=p+E:f=d+j;break}case"top_right":{P?h=p+E:d=f-j;break}case"bottom_right":{P?p=h-E:d=f-j;break}case"bottom_left":{P?p=h-E:f=d+j;break}case"bottom":case"top":{const M=(f+d)/2,O=w*x;f=M-O/2,d=M+O/2;break}case"left":case"right":{const M=(h+p)/2,O=S/x;h=M-O/2,p=M+O/2;break}}}if(b){const x=d;d=f,f=x}if(y){const x=p;p=h,h=x}const v=new Ir(f,h,Math.abs(d-f),Math.abs(p-h));return{box:v,scaleX:+(v.width/o.width*(m>0?1:-1)).toFixed(5),scaleY:+(v.height/o.height*(g>0?1:-1)).toFixed(5)}}equals(o){return Ir.Equals(this,o)}static Equals(o,n){return n.x===o.x&&n.y===o.y&&n.w===o.w&&n.h===o.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(o){return new Ir(o.x,o.y,Math.max(1,o.w),Math.max(1,o.h))}};D(Ir,"Collides",(o,n)=>!(o.maxX<n.minX||o.minX>n.maxX||o.maxY<n.minY||o.minY>n.maxY)),D(Ir,"Contains",(o,n)=>o.minX<n.minX&&o.minY<n.minY&&o.maxY>n.maxY&&o.maxX>n.maxX),D(Ir,"Includes",(o,n)=>Ir.Collides(o,n)||Ir.Contains(o,n)),D(Ir,"ContainsPoint",(o,n,r=0)=>!(n.x<o.minX-r||n.y<o.minY-r||n.x>o.maxX+r||n.y>o.maxY+r)),D(Ir,"Common",o=>{let n=1/0,r=1/0,s=-1/0,i=-1/0;for(let a=0;a<o.length;a++){const l=o[a];n=Math.min(n,l.minX),r=Math.min(r,l.minY),s=Math.max(s,l.maxX),i=Math.max(i,l.maxY)}return new Ir(n,r,s-n,i-r)}),D(Ir,"Sides",(o,n=0)=>{const{corners:r}=o;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let mt=Ir;function M8(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function O8(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}function A8(t){return t==="top_left"||t==="top_right"||t==="bottom_right"||t==="bottom_left"}function R8(t){const o=Ue();B.useLayoutEffect(()=>{let n=new mt;function r(){const u=t.current;if(!u)return null;const f=u.getBoundingClientRect(),h=new mt(f.left||f.x,f.top||f.y,Math.max(f.width,1),Math.max(f.height,1));n.equals(h)||(o.updateViewportScreenBounds(h),n=h)}r();const s=I8(r,200,{trailing:!0}),i=setInterval(s,1e3);window.addEventListener("resize",s);const a=new ResizeObserver(u=>{u[0].contentRect&&s()}),l=t.current;let c=null;return l&&(a.observe(l),c=D8(l),c.addEventListener("scroll",s)),()=>{clearInterval(i),window.removeEventListener("resize",s),a.disconnect(),c==null||c.removeEventListener("scroll",s)}},[o,t])}/*!
 * Author: excalidraw
 * MIT License: https://github.com/excalidraw/excalidraw/blob/master/LICENSE
 * https://github.com/excalidraw/excalidraw/blob/48c3465b19f10ec755b3eb84e21a01a468e96e43/packages/excalidraw/utils.ts#L600
 */const D8=t=>{let o=t.parentElement;for(;o;){if(o===document.body)return document;const{overflowY:n}=window.getComputedStyle(o);if(o.scrollHeight>o.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return o;o=o.parentElement}return document},nr=class nr{constructor(o,n,r,s,i,a){D(this,"a",1);D(this,"b",0);D(this,"c",0);D(this,"d",1);D(this,"e",0);D(this,"f",0);this.a=o,this.b=n,this.c=r,this.d=s,this.e=i,this.f=a}equals(o){return this===o||this.a===o.a&&this.b===o.b&&this.c===o.c&&this.d===o.d&&this.e===o.e&&this.f===o.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(o){const n=o,{a:r,b:s,c:i,d:a,e:l,f:c}=this;return this.a=r*n.a+i*n.b,this.c=r*n.c+i*n.d,this.e=r*n.e+i*n.f+l,this.b=s*n.a+a*n.b,this.d=s*n.c+a*n.d,this.f=s*n.e+a*n.f+c,this}rotate(o,n,r){return o===0?this:n===void 0?this.multiply(nr.Rotate(o)):this.translate(n,r).multiply(nr.Rotate(o)).translate(-n,-r)}translate(o,n){return this.multiply(nr.Translate(o,n))}scale(o,n){return this.multiply(nr.Scale(o,n))}invert(){const{a:o,b:n,c:r,d:s,e:i,f:a}=this,l=o*s-n*r;return this.a=s/l,this.b=n/-l,this.c=r/-l,this.d=o/l,this.e=(s*i-r*a)/-l,this.f=(n*i-o*a)/l,this}applyToPoint(o){return nr.applyToPoint(this,o)}applyToPoints(o){return nr.applyToPoints(this,o)}rotation(){return nr.Rotation(this)}point(){return nr.Point(this)}decomposed(){return nr.Decompose(this)}toCssString(){return nr.toCssString(this)}setTo(o){return Object.assign(this,o),this}decompose(){return nr.Decompose(this)}clone(){return new nr(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new nr(1,0,0,1,0,0)}static Translate(o,n){return new nr(1,0,0,1,o,n)}static Rotate(o,n,r){if(o===0)return nr.Identity();const s=Math.cos(o),i=Math.sin(o),a=new nr(s,i,-i,s,0,0);return n===void 0?a:nr.Compose(nr.Translate(n,r),a,nr.Translate(-n,-r))}static Multiply(o,n){return{a:o.a*n.a+o.c*n.b,c:o.a*n.c+o.c*n.d,e:o.a*n.e+o.c*n.f+o.e,b:o.b*n.a+o.d*n.b,d:o.b*n.c+o.d*n.d,f:o.b*n.e+o.d*n.f+o.f}}static Inverse(o){const n=o.a*o.d-o.b*o.c;return{a:o.d/n,b:o.b/-n,c:o.c/-n,d:o.a/n,e:(o.d*o.e-o.c*o.f)/-n,f:(o.b*o.e-o.a*o.f)/n}}static Absolute(o){const n=o.a*o.d-o.b*o.c;return{a:o.d/n,b:o.b/-n,c:o.c/-n,d:o.a/n,e:(o.d*o.e-o.c*o.f)/n,f:(o.b*o.e-o.a*o.f)/-n}}static Compose(...o){const n=nr.Identity();for(let r=0,s=o.length;r<s;r++)n.multiply(o[r]);return n}static Point(o){return new Y(o.e,o.f)}static Rotation(o){let n;if(o.a!==0||o.c!==0){const r=(o.a*o.a+o.c*o.c)**.5;n=Math.acos(o.a/r)*(o.c>0?-1:1)}else if(o.b!==0||o.d!==0){const r=(o.b*o.b+o.d*o.d)**.5;n=dr+Math.acos(o.b/r)*(o.d>0?-1:1)}else n=0;return Zb(n)}static Decompose(o){let n,r,s;if(o.a!==0||o.c!==0){const i=(o.a*o.a+o.c*o.c)**.5;n=i,r=(o.a*o.d-o.b*o.c)/i,s=Math.acos(o.a/i)*(o.c>0?-1:1)}else if(o.b!==0||o.d!==0){const i=(o.b*o.b+o.d*o.d)**.5;n=(o.a*o.d-o.b*o.c)/i,r=i,s=dr+Math.acos(o.b/i)*(o.d>0?-1:1)}else n=0,r=0,s=0;return{x:o.e,y:o.f,scaleX:n,scaleY:r,rotation:Zb(s)}}static Smooth(o,n=1e10){return o.a=Math.round(o.a*n)/n,o.b=Math.round(o.b*n)/n,o.c=Math.round(o.c*n)/n,o.d=Math.round(o.d*n)/n,o.e=Math.round(o.e*n)/n,o.f=Math.round(o.f*n)/n,o}static toCssString(o){return`matrix(${Ee(o.a)}, ${Ee(o.b)}, ${Ee(o.c)}, ${Ee(o.d)}, ${Ee(o.e)}, ${Ee(o.f)})`}static applyToPoint(o,n){return new Y(o.a*n.x+o.c*n.y+o.e,o.b*n.x+o.d*n.y+o.f,n.z)}static applyToXY(o,n,r){return[o.a*n+o.c*r+o.e,o.b*n+o.d*r+o.f]}static applyToPoints(o,n){return n.map(r=>new Y(o.a*r.x+o.c*r.y+o.e,o.b*r.x+o.d*r.y+o.f,r.z))}static applyToBounds(o,n){return new mt(o.e+n.minX,o.f+n.minY,n.width,n.height)}static From(o){return new nr(o.a,o.b,o.c,o.d,o.e,o.f)}static Cast(o){return o instanceof nr?o:nr.From(o)}};D(nr,"Scale",(o,n,r,s)=>{const i=new nr(o,0,0,n,0,0);return r===void 0?i:nr.Compose(nr.Translate(r,s),i,nr.Translate(-r,-s))});let vt=nr;function aI(t,o){return o===0?t:aI(o,t%o)}function lI(t){const o=t.toString().split(".")[1];if(!o)return 1;const n=Math.pow(10,o.length),r=parseInt(o,10);return n/aI(r,n)}class Ql{constructor(o){D(this,"isFilled",!1);D(this,"isClosed",!0);D(this,"isLabel",!1);D(this,"debugColor");D(this,"ignore");D(this,"_vertices");D(this,"_bounds");D(this,"_area");this.isFilled=o.isFilled,this.isClosed=o.isClosed,this.isLabel=o.isLabel??!1,this.debugColor=o.debugColor,this.ignore=o.ignore}hitTestPoint(o,n=0,r=!1){return this.isClosed&&(this.isFilled||r)&&Zo(o,this.vertices)?!0:Y.Dist2(o,this.nearestPoint(o))<=n*n}distanceToPoint(o,n=!1){return o.dist(this.nearestPoint(o))*(this.isClosed&&(this.isFilled||n)&&Zo(o,this.vertices)?-1:1)}distanceToLineSegment(o,n){if(o.equals(n))return this.distanceToPoint(o);const{vertices:r}=this;let s,i=1/0,a,l,c;for(let u=0;u<r.length;u++)l=r[u],c=Y.NearestPointOnLineSegment(o,n,l,!0),a=Y.Dist2(l,c),a<i&&(i=a,s=c);if(!s)throw Error("nearest point not found");return this.isClosed&&this.isFilled&&Zo(s,this.vertices)?-i:i}hitTestLineSegment(o,n,r=0){return this.distanceToLineSegment(o,n)<=r}nearestPointOnLineSegment(o,n){const{vertices:r}=this;let s,i=1/0,a,l,c;for(let u=0;u<r.length;u++)l=r[u],c=Y.NearestPointOnLineSegment(o,n,l,!0),a=Y.Dist2(l,c),a<i&&(i=a,s=c);if(!s)throw Error("nearest point not found");return s}isPointInBounds(o,n=0){const{bounds:r}=this;return!(o.x<r.minX-n||o.y<r.minY-n||o.x>r.maxX+n||o.y>r.maxY+n)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return mt.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:o}=this;let n=0;for(let r=0,s=o.length;r<s;r++){const i=o[r],a=o[(r+1)%s];n+=i.x*a.y-a.x*i.y}return n/2}toSimpleSvgPath(){let o="";const{vertices:n}=this,r=n.length;if(r===0)return o;o+=`M${n[0].x},${n[0].y}`;for(let s=1;s<r;s++)o+=`L${n[s].x},${n[s].y}`;return this.isClosed&&(o+="Z"),o}}class Vs extends Ql{constructor(n){super({...n,isClosed:!0,isFilled:!1});D(this,"children",[]);D(this,"ignoredChildren",[]);for(const r of n.children)r.ignore?this.ignoredChildren.push(r):this.children.push(r);if(this.children.length===0)throw Error("Group2d must have at least one child")}getVertices(){return this.children.filter(n=>!n.isLabel).flatMap(n=>n.vertices)}nearestPoint(n){let r=1/0,s;const{children:i}=this;if(i.length===0)throw Error("no children");let a,l;for(const c of i)a=c.nearestPoint(n),l=Y.Dist2(a,n),l<r&&(r=l,s=a);if(!s)throw Error("nearest point not found");return s}distanceToPoint(n,r=!1){return Math.min(...this.children.map((s,i)=>s.distanceToPoint(n,r||i>0)))}hitTestPoint(n,r,s){return!!this.children.filter(i=>!i.isLabel).find(i=>i.hitTestPoint(n,r,s))}hitTestLineSegment(n,r,s){return!!this.children.filter(i=>!i.isLabel).find(i=>i.hitTestLineSegment(n,r,s))}getArea(){return this.children[0].area}toSimpleSvgPath(){let n="";for(const s of this.children)n+=s.toSimpleSvgPath();const r=mt.FromPoints(this.vertices).corners;for(let s=0,i=r.length;s<i;s++){const a=r[s],l=r[(s-1+i)%i],c=a.dist(l),u=r[(s+1)%i],f=a.dist(u),h=a.clone().lrp(l,4/c),d=a,p=a.clone().lrp(u,4/f);n+=`M${h.x},${h.y} L${d.x},${d.y} L${p.x},${p.y} `}return n}}function L8(t=!0){const[o,n]=B.useState(0),r=Ue();B.useEffect(()=>{if(!t)return;const s=()=>n(i=>i+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const F8=os(function({showStroke:o=!0,showVertices:n=!0,showClosestPointOnOutline:r=!0}){const s=Ue();L8(r);const i=s.getZoomLevel(),a=s.getRenderingShapes(),{inputs:{currentPagePoint:l}}=s;return C.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:a.map(c=>{const u=s.getShape(c.id);if(u.type==="group")return null;const f=s.getShapeGeometry(u),h=s.getShapePageTransform(u),d=s.getPointInShapeSpace(u,l),p=f.nearestPoint(d),m=f.distanceToPoint(d,!0),g=Math.abs(m)*i,b=m<0,{vertices:y}=f;return C.jsxs("g",{transform:h.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[o&&C.jsx(cI,{geometry:f}),n&&y.map((v,x)=>C.jsx("circle",{cx:v.x,cy:v.y,r:"2",fill:`hsl(${Xm(x,[0,y.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${x}`)),r&&g<150&&C.jsx("line",{x1:p.x,y1:p.y,x2:d.x,y2:d.y,opacity:1-g/150,stroke:b?"goldenrod":"dodgerblue",strokeWidth:"2"})]},c.id+"_outline")})})});function cI({geometry:t}){return t instanceof Vs?C.jsx(C.Fragment,{children:[...t.children,...t.ignoredChildren].map((o,n)=>C.jsx(cI,{geometry:o},n))}):C.jsx("path",{stroke:t.debugColor??"red",strokeWidth:"2",fill:"none",opacity:"1",d:t.toSimpleSvgPath()})}var N8=200,aS="__lodash_hash_undefined__",$8=1/0,U8="[object Function]",B8="[object GeneratorFunction]",z8=/[\\^$.*+?()[\]{}|]/g,G8=/^\[object .+?Constructor\]$/,V8=typeof fn=="object"&&fn&&fn.Object===Object&&fn,H8=typeof self=="object"&&self&&self.Object===Object&&self,lS=V8||H8||Function("return this")();function W8(t,o){var n=t?t.length:0;return!!n&&q8(t,o,0)>-1}function Y8(t,o,n){for(var r=-1,s=t?t.length:0;++r<s;)if(n(o,t[r]))return!0;return!1}function X8(t,o,n,r){for(var s=t.length,i=n+(r?1:-1);r?i--:++i<s;)if(o(t[i],i,t))return i;return-1}function q8(t,o,n){if(o!==o)return X8(t,K8,n);for(var r=n-1,s=t.length;++r<s;)if(t[r]===o)return r;return-1}function K8(t){return t!==t}function Z8(t,o){return t.has(o)}function Q8(t,o){return t==null?void 0:t[o]}function J8(t){var o=!1;if(t!=null&&typeof t.toString!="function")try{o=!!(t+"")}catch{}return o}function uI(t){var o=-1,n=Array(t.size);return t.forEach(function(r){n[++o]=r}),n}var eN=Array.prototype,tN=Function.prototype,dI=Object.prototype,k0=lS["__core-js_shared__"],F2=function(){var t=/[^.]+$/.exec(k0&&k0.keys&&k0.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),hI=tN.toString,cS=dI.hasOwnProperty,rN=dI.toString,nN=RegExp("^"+hI.call(cS).replace(z8,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oN=eN.splice,sN=uS(lS,"Map"),I0=uS(lS,"Set"),yh=uS(Object,"create");function $l(t){var o=-1,n=t?t.length:0;for(this.clear();++o<n;){var r=t[o];this.set(r[0],r[1])}}function iN(){this.__data__=yh?yh(null):{}}function aN(t){return this.has(t)&&delete this.__data__[t]}function lN(t){var o=this.__data__;if(yh){var n=o[t];return n===aS?void 0:n}return cS.call(o,t)?o[t]:void 0}function cN(t){var o=this.__data__;return yh?o[t]!==void 0:cS.call(o,t)}function uN(t,o){var n=this.__data__;return n[t]=yh&&o===void 0?aS:o,this}$l.prototype.clear=iN;$l.prototype.delete=aN;$l.prototype.get=lN;$l.prototype.has=cN;$l.prototype.set=uN;function Ou(t){var o=-1,n=t?t.length:0;for(this.clear();++o<n;){var r=t[o];this.set(r[0],r[1])}}function dN(){this.__data__=[]}function hN(t){var o=this.__data__,n=Jg(o,t);if(n<0)return!1;var r=o.length-1;return n==r?o.pop():oN.call(o,n,1),!0}function fN(t){var o=this.__data__,n=Jg(o,t);return n<0?void 0:o[n][1]}function pN(t){return Jg(this.__data__,t)>-1}function mN(t,o){var n=this.__data__,r=Jg(n,t);return r<0?n.push([t,o]):n[r][1]=o,this}Ou.prototype.clear=dN;Ou.prototype.delete=hN;Ou.prototype.get=fN;Ou.prototype.has=pN;Ou.prototype.set=mN;function Au(t){var o=-1,n=t?t.length:0;for(this.clear();++o<n;){var r=t[o];this.set(r[0],r[1])}}function gN(){this.__data__={hash:new $l,map:new(sN||Ou),string:new $l}}function yN(t){return ey(this,t).delete(t)}function vN(t){return ey(this,t).get(t)}function bN(t){return ey(this,t).has(t)}function xN(t,o){return ey(this,t).set(t,o),this}Au.prototype.clear=gN;Au.prototype.delete=yN;Au.prototype.get=vN;Au.prototype.has=bN;Au.prototype.set=xN;function fg(t){var o=-1,n=t?t.length:0;for(this.__data__=new Au;++o<n;)this.add(t[o])}function SN(t){return this.__data__.set(t,aS),this}function wN(t){return this.__data__.has(t)}fg.prototype.add=fg.prototype.push=SN;fg.prototype.has=wN;function Jg(t,o){for(var n=t.length;n--;)if(IN(t[n][0],o))return n;return-1}function _N(t){if(!fI(t)||PN(t))return!1;var o=MN(t)||J8(t)?nN:G8;return o.test(TN(t))}function jN(t,o,n){var r=-1,s=W8,i=t.length,a=!0,l=[],c=l;if(n)a=!1,s=Y8;else if(i>=N8){var u=o?null:EN(t);if(u)return uI(u);a=!1,s=Z8,c=new fg}else c=o?[]:l;e:for(;++r<i;){var f=t[r],h=o?o(f):f;if(f=n||f!==0?f:0,a&&h===h){for(var d=c.length;d--;)if(c[d]===h)continue e;o&&c.push(h),l.push(f)}else s(c,h,n)||(c!==l&&c.push(h),l.push(f))}return l}var EN=I0&&1/uI(new I0([,-0]))[1]==$8?function(t){return new I0(t)}:ON;function ey(t,o){var n=t.__data__;return CN(o)?n[typeof o=="string"?"string":"hash"]:n.map}function uS(t,o){var n=Q8(t,o);return _N(n)?n:void 0}function CN(t){var o=typeof t;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null}function PN(t){return!!F2&&F2 in t}function TN(t){if(t!=null){try{return hI.call(t)}catch{}try{return t+""}catch{}}return""}function kN(t){return t&&t.length?jN(t):[]}function IN(t,o){return t===o||t!==t&&o!==o}function MN(t){var o=fI(t)?rN.call(t):"";return o==U8||o==B8}function fI(t){var o=typeof t;return!!t&&(o=="object"||o=="function")}function ON(){}var AN=kN;const RN=Xl(AN);function pI(t){return RN(t)}function DN(){const t=Ue(),o=zL("userIds",()=>pI(t.getCollaborators().map(n=>n.userId)).sort(),{isEqual:(n,r)=>{var s;return n.join(",")===((s=r.join)==null?void 0:s.call(r,","))}},[t]);return He(o)}function mI(t){const o=Ue();return He(`latestPresence:${t}`,()=>o.getCollaborators().find(r=>r.userId===t),[o])??null}const LN=os(function(){const o=DN();return C.jsx(C.Fragment,{children:o.map(n=>C.jsx(FN,{collaboratorId:n},n))})}),FN=os(function({collaboratorId:o}){const n=Ue(),r=mI(o),s=$N(r);if(!(r&&r.currentPageId===n.getCurrentPageId()))return null;switch(s){case"inactive":{const{followingUserId:i,highlightedUserIds:a}=n.getInstanceState();if(!(i===r.userId||a.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:i}=n.getInstanceState();if(r.followingUserId===n.user.getId()&&!(r.chatMessage||i.includes(r.userId)))return null;break}}return C.jsx(NN,{latestPresence:r})}),NN=os(function({latestPresence:o}){const n=Ue(),{CollaboratorBrush:r,CollaboratorScribble:s,CollaboratorCursor:i,CollaboratorHint:a,CollaboratorShapeIndicator:l}=Vr(),c=n.getZoomLevel(),u=n.getViewportPageBounds(),{userId:f,chatMessage:h,brush:d,scribbles:p,selectedShapeIds:m,userName:g,cursor:b,color:y}=o,v=!(b.x<u.minX-12/c||b.y<u.minY-16/c||b.x>u.maxX-12/c||b.y>u.maxY-16/c);return C.jsxs(C.Fragment,{children:[d&&r?C.jsx(r,{className:"tl-collaborator__brush",brush:d,color:y,opacity:.1},f+"_brush"):null,v&&i?C.jsx(i,{className:"tl-collaborator__cursor",point:b,color:y,zoom:c,name:g!=="New User"?g:null,chatMessage:h},f+"_cursor"):a?C.jsx(a,{className:"tl-collaborator__cursor-hint",point:b,color:y,zoom:c,viewport:u},f+"_cursor_hint"):null,s&&p.length?C.jsx(C.Fragment,{children:p.map(x=>C.jsx(s,{className:"tl-collaborator__scribble",scribble:x,color:y,zoom:c,opacity:x.color==="laser"?.5:.1},f+"_scribble_"+x.id))}):null,l&&m.map(x=>C.jsx(l,{className:"tl-collaborator__shape-indicator",shapeId:x,color:y,opacity:.5},f+"_"+x))]})});function N2(t){return t>G6?"inactive":t>Wk?"idle":"active"}function $N(t){const o=B.useRef((t==null?void 0:t.lastActivityTimestamp)??-1),[n,r]=B.useState(()=>N2(Date.now()-o.current));return B.useEffect(()=>{const s=setInterval(()=>{r(N2(Date.now()-o.current))},V6);return()=>clearInterval(s)},[]),t&&(o.current=t.lastActivityTimestamp),n}const gI=B.memo(function({id:o,shape:n,util:r,index:s,backgroundIndex:i,opacity:a,dprMultiple:l}){const c=Ue(),{ShapeErrorFallback:u}=Vr(),f=B.useRef(null),h=B.useRef(null),d=B.useRef({transform:"",clipPath:"none",width:0,height:0,x:0,y:0,isCulled:!1});Fa("set shape stuff",()=>{const g=c.getShape(o);if(!g)return;const b=d.current,y=c.getShapeClipPath(o)??"none";y!==b.clipPath&&(Gn(f.current,"clip-path",y),Gn(h.current,"clip-path",y),b.clipPath=y);const v=c.getShapePageTransform(o),x=vt.toCssString(v),S=c.getShapeGeometry(g).bounds;x!==b.transform&&(Gn(f.current,"transform",x),Gn(h.current,"transform",x),b.transform=x);const w=S.w%l,E=S.h%l,j=w===0?S.w:S.w+(l-w),P=E===0?S.h:S.h+(l-E);(j!==b.width||P!==b.height)&&(Gn(f.current,"width",Math.max(j,l)+"px"),Gn(f.current,"height",Math.max(P,l)+"px"),Gn(h.current,"width",Math.max(j,l)+"px"),Gn(h.current,"height",Math.max(P,l)+"px"),b.width=j,b.height=P)},[c]),Fa("set opacity and z-index",()=>{const g=f.current,b=h.current;Gn(g,"opacity",a),Gn(b,"opacity",a),Gn(g,"z-index",s),Gn(b,"z-index",i)},[a,s,i]),Fa("set display",()=>{if(!c.getShape(o))return;const y=c.getCulledShapes().has(o);y!==d.current.isCulled&&(Gn(f.current,"display",y?"none":"block"),Gn(h.current,"display",y?"none":"block"),d.current.isCulled=y)},[c]);const p=B.useCallback(g=>c.annotateError(g,{origin:"shape",willCrashApp:!1}),[c]);if(!n)return null;const m="fill"in n.props&&n.props.fill!=="none";return C.jsxs(C.Fragment,{children:[r.backgroundComponent&&C.jsx("div",{ref:h,className:"tl-shape tl-shape-background","data-shape-type":n.type,draggable:!1,children:C.jsx(mh,{fallback:u,onError:p,children:C.jsx(BN,{shape:n,util:r})})}),C.jsx("div",{ref:f,className:"tl-shape","data-shape-type":n.type,"data-shape-is-filled":m,draggable:!1,children:C.jsx(mh,{fallback:u,onError:p,children:C.jsx(UN,{shape:n,util:r})})})]})}),UN=B.memo(function({shape:o,util:n}){return Hg("InnerShape:"+o.type,()=>n.component(o))},(t,o)=>t.shape.props===o.shape.props&&t.shape.meta===o.shape.meta),BN=B.memo(function({shape:o,util:n}){return Hg("InnerShape:"+o.type,()=>{var r;return(r=n.backgroundComponent)==null?void 0:r.call(n,o)})},(t,o)=>t.shape.props===o.shape.props&&t.shape.meta===o.shape.meta);function zN({className:t}){const o=Ue(),{Background:n,SvgDefs:r}=Vr(),s=B.useRef(null),i=B.useRef(null),a=B.useRef(null),l=to();R8(s),oF(),rF(),u8(s),aF(s);const c=B.useRef({lodDisableTextOutline:!1,allowTextOutline:!0});Fa("position layers",function(){const{x:y,y:v,z:x}=o.getCamera();if(c.current.allowTextOutline&&o.environment.isSafari&&(l.style.setProperty("--tl-text-outline","none"),c.current.allowTextOutline=!1),c.current.allowTextOutline&&x<w2!==c.current.lodDisableTextOutline){const E=x<w2;l.style.setProperty("--tl-text-outline",E?"none":`0 var(--b) 0 var(--color-background), 0 var(--a) 0 var(--color-background),
				var(--b) var(--b) 0 var(--color-background), var(--a) var(--b) 0 var(--color-background),
				var(--a) var(--a) 0 var(--color-background), var(--b) var(--a) 0 var(--color-background)`),c.current.lodDisableTextOutline=E}const S=x>=1?Xm(x,[1,8],[.125,.5],!0):Xm(x,[.1,1],[-2,.125],!0),w=`scale(${Ee(x)}) translate(${Ee(y+S)}px,${Ee(v+S)}px)`;Gn(i.current,"transform",w),Gn(a.current,"transform",w)},[o,l]);const u=tF(),f=He("shapeSvgDefs",()=>{const b=new Map;for(const y of un(o.shapeUtils)){if(!y)return;const v=y.getCanvasSvgDefs();for(const{key:x,component:S}of v)b.has(x)||b.set(x,C.jsx(S,{},x))}return[...b.values()]},[o]),h=He("debug_shapes",()=>wn.hideShapes.get(),[wn]),d=He("debug_svg",()=>wn.debugSvg.get(),[wn]),p=He("debug_geometry",()=>wn.debugGeometry.get(),[wn]),m=He("isEditingAnything",()=>o.getEditingShapeId()!==null,[o]),g=He("isSelectingAnything",()=>!!o.getSelectedShapeIds().length,[o]);return C.jsxs("div",{ref:s,draggable:!1,"data-iseditinganything":m,"data-isselectinganything":g,className:Tt("tl-canvas",t),"data-testid":"canvas",...u,children:[C.jsx("svg",{className:"tl-svg-context",children:C.jsxs("defs",{children:[f,C.jsx(r$,{}),C.jsx(n$,{}),r&&C.jsx(r,{})]})}),n&&C.jsx("div",{className:"tl-background__wrapper",children:C.jsx(n,{})}),C.jsx(GN,{}),C.jsxs("div",{ref:i,className:"tl-html-layer tl-shapes",draggable:!1,children:[C.jsx(a$,{}),C.jsx(i$,{}),h?null:d?C.jsx(ZN,{}):C.jsx(JN,{})]}),C.jsxs("div",{className:"tl-overlays",children:[C.jsxs("div",{ref:a,className:"tl-html-layer",children:[p?C.jsx(F8,{}):null,C.jsx(XN,{}),C.jsx(HN,{}),C.jsx(VN,{}),C.jsx(WN,{}),C.jsx(e$,{}),C.jsx(t$,{}),C.jsx(YN,{}),C.jsx(s$,{}),C.jsx(LN,{})]}),C.jsx(l$,{})]}),C.jsx(c$,{})]})}function GN(){const t=Ue(),o=He("gridSize",()=>t.getDocumentSettings().gridSize,[t]),{x:n,y:r,z:s}=He("camera",()=>t.getCamera(),[t]),i=He("isGridMode",()=>t.getInstanceState().isGridMode,[t]),{Grid:a}=Vr();return a&&i?C.jsx(a,{x:n,y:r,z:s,size:o}):null}function VN(){const t=Ue(),o=He("scribbles",()=>t.getInstanceState().scribbles,[t]),n=He("zoomLevel",()=>t.getZoomLevel(),[t]),{Scribble:r}=Vr();return r&&o.length?C.jsx(C.Fragment,{children:o.map(s=>C.jsx(r,{className:"tl-user-scribble",scribble:s,zoom:n},s.id))}):null}function HN(){const t=Ue(),o=He("brush",()=>t.getInstanceState().brush,[t]),{Brush:n}=Vr();return n&&o?C.jsx(n,{className:"tl-user-brush",brush:o}):null}function WN(){const t=Ue(),o=He("zoomBrush",()=>t.getInstanceState().zoomBrush,[t]),{ZoomBrush:n}=Vr();return n&&o?C.jsx(n,{className:"tl-user-brush tl-zoom-brush",brush:o}):null}function YN(){const t=Ue(),o=He("snapLines",()=>t.snaps.getIndicators(),[t]),n=He("zoomLevel",()=>t.getZoomLevel(),[t]),{SnapIndicator:r}=Vr();return r&&o.length>0?C.jsx(C.Fragment,{children:o.map(s=>C.jsx(r,{className:"tl-user-snapline",line:s,zoom:n},s.id))}):null}function XN(){const t=Ue(),o=He("handles shapeIdWithHandles",()=>{const{isReadonly:n,isChangingStyle:r}=t.getInstanceState();if(n||r)return!1;const s=t.getOnlySelectedShape();return!s||!t.getShapeHandles(s)?!1:s.id},[t]);return o?C.jsx(qN,{shapeId:o}):null}function qN({shapeId:t}){const o=Ue(),{Handles:n}=Vr(),r=He("zoomLevel",()=>o.getZoomLevel(),[o]),s=He("coarse pointer",()=>o.getInstanceState().isCoarsePointer,[o]),i=He("handles transform",()=>o.getShapePageTransform(t),[o,t]),a=He("handles",()=>{const l=o.getShapeHandles(t);if(!l)return null;const c=(s?Yk:Xk)/r*2;return l.filter(u=>u.type!=="virtual"||!l.some(f=>f!==u&&f.type==="vertex"&&Y.Dist(u,f)<c)).sort(u=>u.type==="vertex"?1:-1)},[o,r,s,t]);return!n||!a||!i?null:C.jsx(n,{children:C.jsx("g",{transform:vt.toCssString(i),children:a.map(l=>C.jsx(KN,{shapeId:t,handle:l,zoom:r,isCoarse:s},l.id))})})}function KN({shapeId:t,handle:o,zoom:n,isCoarse:r}){const s=d8(t,o.id),{Handle:i}=Vr();return i?C.jsx("g",{"aria-label":"handle",transform:`translate(${o.x}, ${o.y})`,...s,children:C.jsx(i,{shapeId:t,handle:o,zoom:n,isCoarse:r})}):null}function ZN(){const t=Ue(),o=He("rendering shapes",()=>t.getRenderingShapes(),[t]),n=He("dpr multiple",()=>lI(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return C.jsx(C.Fragment,{children:o.map(r=>C.jsxs(B.Fragment,{children:[C.jsx(gI,{...r,dprMultiple:n}),C.jsx(o$,{id:r.id})]},r.id+"_fragment"))})}function QN(){const t=Ue(),o=B.useRef(new Set);return Fa("reflow for culled shapes",()=>{const n=t.getCulledShapes();if(o.current.size===n.size&&[...n].every(s=>o.current.has(s)))return;o.current=n;const r=document.getElementsByClassName("tl-canvas");r.length!==0&&r[0].offsetHeight},[t]),null}function JN(){const t=Ue(),o=He("rendering shapes",()=>t.getRenderingShapes(),[t]),n=He("dpr multiple",()=>lI(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return C.jsxs(C.Fragment,{children:[o.map(r=>C.jsx(gI,{...r,dprMultiple:n},r.id+"_shape")),t.environment.isSafari&&C.jsx(QN,{})]})}function e$(){const t=Ue(),o=He("rendering shapes",()=>t.getRenderingShapes(),[t]),n=B.useRef(new Set),r=He("should display selected ids",()=>{const i=n.current,a=new Set;if(t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!t.getInstanceState().isChangingStyle){const l=t.getSelectedShapeIds();for(const c of l)a.add(c);if(t.isInAny("select.idle","select.editing_shape")){const c=t.getInstanceState();if(c.isHoveringCanvas&&!c.isCoarsePointer){const u=t.getHoveredShapeId();u&&a.add(u)}}}if(i.size!==a.size)return n.current=a,a;for(const l of a)if(!i.has(l))return n.current=a,a;return i},[t]),{ShapeIndicator:s}=Vr();return s?C.jsx(C.Fragment,{children:o.map(({id:i})=>C.jsx(s,{shapeId:i,hidden:!r.has(i)},i+"_indicator"))}):null}function t$(){const t=Ue(),{ShapeIndicator:o}=Vr(),n=He("hinting shape ids",()=>Ym(t.getHintingShapeIds()),[t]);return!n.length||!o?null:C.jsx(C.Fragment,{children:n.map(r=>C.jsx(o,{className:"tl-user-indicator__hint",shapeId:r},r+"_hinting"))})}function r$(){return C.jsxs("g",{id:"cursor",children:[C.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[C.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),C.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),C.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[C.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),C.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),C.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[C.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),C.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function n$(){return C.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function o$({id:t}){const o=Ue(),[n,r]=B.useState(null),s=He("is in root",()=>{const i=o.getShape(t);return(i==null?void 0:i.parentId)===o.getCurrentPageId()},[o,t]);return B.useEffect(()=>{if(!s)return;let i=null;const a=ku("shape to svg",async()=>{const l=Math.random();i=l;const u=o.isShapeOfType(t,"frame")?0:10;let f=o.getShapePageBounds(t);if(!f)return;f=f.clone().expandBy(u);const h=await o.getSvgString([t],{padding:u,background:o.getInstanceState().exportBackground});if(i!==l||!h)return;const d=`data:image/svg+xml;utf8,${encodeURIComponent(h.svg)}`;r({src:d,bounds:f})});return()=>{i=null,a()}},[o,t,s]),!s||!n?null:C.jsx("img",{src:n.src,width:n.bounds.width,height:n.bounds.height,style:{position:"absolute",top:0,left:0,transform:`translate(${n.bounds.x}px, ${n.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}})}function s$(){const t=Ue(),o=He("selection rotation",()=>t.getSelectionRotation(),[t]),n=He("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionForeground:r}=Vr();return!n||!r?null:C.jsx(r,{bounds:n,rotation:o})}function i$(){const t=Ue(),o=He("selection rotation",()=>t.getSelectionRotation(),[t]),n=He("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionBackground:r}=Vr();return!n||!r?null:C.jsx(r,{bounds:n,rotation:o})}function a$(){const{OnTheCanvas:t}=Vr();return t?C.jsx(t,{}):null}function l$(){const{InFrontOfTheCanvas:t}=Vr();return t?C.jsx(t,{}):null}function c$(){const t=Ue(),o=He("camera state",()=>t.getCameraState(),[t]);return C.jsx("div",{className:Tt("tl-hit-test-blocker",{"tl-hit-test-blocker__hidden":o==="idle"})})}function u$({className:t,zoom:o,point:n,color:r,viewport:s,opacity:i=1}){const a=B.useRef(null);return Mu(a,Ga(n.x,s.minX+5/o,s.maxX-5/o),Ga(n.y,s.minY+5/o,s.maxY-5/o),1/o,Y.Angle(s.center,n)),C.jsxs("svg",{ref:a,className:Tt("tl-overlays__item",t),children:[C.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),C.jsx("use",{href:"#cursor_hint",color:r,opacity:i})]})}const $2=B.memo(function({className:o,zoom:n,point:r,color:s,name:i,chatMessage:a}){const l=B.useRef(null);return Mu(l,r==null?void 0:r.x,r==null?void 0:r.y,1/n),r?C.jsxs("div",{ref:l,className:Tt("tl-overlays__item",o),children:[C.jsx("svg",{className:"tl-cursor",children:C.jsx("use",{href:"#cursor",color:s})}),a?C.jsxs(C.Fragment,{children:[i&&C.jsx("div",{className:"tl-nametag-title",style:{color:s},children:i}),C.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:s},children:a})]}):i&&C.jsx("div",{className:"tl-nametag",style:{backgroundColor:s},children:i})]}):null});function d$({x:t,y:o,z:n,size:r}){return C.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[C.jsx("defs",{children:x2.map(({min:s,mid:i,step:a},l)=>{const c=a*r*n,u=.5+t*n,f=.5+o*n,h=u>0?u%c:c+u%c,d=f>0?f%c:c+f%c,p=n<i?Xm(n,[s,i],[0,1]):1;return C.jsx("pattern",{id:`grid-${a}`,width:c,height:c,patternUnits:"userSpaceOnUse",children:C.jsx("circle",{className:"tl-grid-dot",cx:h,cy:d,r:1,opacity:p})},`grid-pattern-${l}`)})}),x2.map(({step:s},i)=>C.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${s})`},`grid-rect-${i}`))]})}function h$({handle:t,isCoarse:o,className:n,zoom:r}){const s=(o?Yk:Xk)/r;if(t.type==="clone"){const a=3/Math.max(r,.35),l=`M0,${-a} A${a},${a} 0 0,1 0,${a}`,c=q6.indexOf(t.id);return C.jsxs("g",{className:Tt(`tl-handle tl-handle__${t.type}`,n),children:[C.jsx("circle",{className:"tl-handle__bg",r:s}),C.jsx("path",{className:"tl-handle__fg",d:l,transform:`rotate(${-90+90*c})`})]})}const i=(t.type==="create"&&o?3:4)/Math.max(r,.35);return C.jsxs("g",{className:Tt(`tl-handle tl-handle__${t.type}`,n),children:[C.jsx("circle",{className:"tl-handle__bg",r:s}),C.jsx("circle",{className:"tl-handle__fg",r:i})]})}const f$=({children:t})=>C.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t});function dS(t,o=!0){const n=t.length;if(n<2)return"";let r=t[0],s=t[1];if(n===2)return`M${In(r)}L${In(s)}`;let i="";for(let a=2,l=n-1;a<l;a++)r=t[a],s=t[a+1],i+=Eo(r,s);return o?`M${Eo(t[0],t[1])}Q${In(t[1])}${Eo(t[1],t[2])}T${i}${Eo(t[n-1],t[0])}${Eo(t[0],t[1])}Z`:`M${In(t[0])}Q${In(t[1])}${Eo(t[1],t[2])}${t.length>3?"T":""}${i}L${In(t[n-1])}`}function U2({scribble:t,zoom:o,color:n,opacity:r,className:s}){return t.points.length?C.jsx("svg",{className:s&&Tt("tl-overlays__item",s),children:C.jsx("path",{className:"tl-scribble",d:dS(t.points,!1),stroke:n??`var(--color-${t.color})`,fill:"none",strokeWidth:8/o,opacity:r??t.opacity})}):null}function yI({bounds:t,rotation:o}){const n=B.useRef(null);return Mu(n,t.x,t.y,1,o),B.useLayoutEffect(()=>{const r=n.current;r&&(r.style.width=Ee(Math.max(1,t.width))+"px",r.style.height=Ee(Math.max(1,t.height))+"px")},[t.width,t.height]),C.jsx("div",{ref:n,className:"tl-selection__bg",draggable:!1})}function p$({bounds:t,rotation:o}){const n=Ue(),r=B.useRef(null),s=He("only selected shape",()=>n.getOnlySelectedShape(),[n]),i=s?n.getShapeUtil(s).expandSelectionOutlinePx(s):0;return Mu(r,t==null?void 0:t.x,t==null?void 0:t.y,1,o,{x:-i,y:-i}),t=t.clone().expandBy(i).zeroFix(),C.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:C.jsx("rect",{className:Tt("tl-selection__fg__outline"),width:Ee(t.width),height:Ee(t.height)})})}const m$=()=>C.jsx("div",{className:"tl-shape-error-boundary"}),g$=({shape:t,util:o})=>Hg("Indicator: "+t.type,()=>o.indicator(t)),y$=({editor:t,id:o})=>{const n=He("shape for indicator",()=>t.store.get(o),[t,o]),{ShapeIndicatorErrorFallback:r}=Vr();return!n||n.isLocked?null:C.jsx(mh,{fallback:r,onError:s=>t.annotateError(s,{origin:"react.shapeIndicator",willCrashApp:!1}),children:C.jsx(g$,{shape:n,util:t.getShapeUtil(n)},n.id)})},B2=B.memo(function({shapeId:o,className:n,color:r,hidden:s,opacity:i}){const a=Ue(),l=B.useRef(null);return Fa("indicator transform",()=>{const c=l.current;if(!c)return;const u=a.getShapePageTransform(o);u&&c.style.setProperty("transform",u.toCssString())},[a,o]),B.useLayoutEffect(()=>{const c=l.current;c&&c.style.setProperty("display",s?"none":"block")},[s]),C.jsx("svg",{ref:l,className:Tt("tl-overlays__item",n),children:C.jsx("g",{className:"tl-shape-indicator",stroke:r??"var(--color-selected)",opacity:i,children:C.jsx(y$,{editor:a,id:o})})})}),v$=()=>C.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function b$({points:t,zoom:o}){const n=2.5/o,r=t.reduce((d,p)=>Math.min(d,p.x),1/0),s=t.reduce((d,p)=>Math.max(d,p.x),-1/0),i=t.reduce((d,p)=>Math.min(d,p.y),1/0),a=t.reduce((d,p)=>Math.max(d,p.y),-1/0),l=t.some(d=>d.x===r&&d.y===i);let c,u,f,h;return l?(c=r,u=i,f=s,h=a):(c=r,u=a,f=s,h=i),C.jsxs("g",{className:"tl-snap-indicator",stroke:"lime",children:[C.jsx("line",{x1:c,y1:u,x2:f,y2:h}),t.map((d,p)=>C.jsx("g",{transform:`translate(${d.x},${d.y})`,children:C.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},p))]})}function x$({gaps:t,direction:o,zoom:n}){const r=3.5/n;let s=[-1/0,1/0],i=null;const a=o==="horizontal";for(const c of t){if(i=Ms(s[0],s[1],a?c.startEdge[0].y:c.startEdge[0].x,a?c.startEdge[1].y:c.startEdge[1].x),i)s=i;else continue;if(i=Ms(s[0],s[1],a?c.endEdge[0].y:c.endEdge[0].x,a?c.endEdge[1].y:c.endEdge[1].x),i)s=i;else continue}if(s===null)return null;const l=(s[0]+s[1])/2;return C.jsx("g",{className:"tl-snap-indicator",stroke:"cyan",children:t.map(({startEdge:c,endEdge:u},f)=>C.jsx(B.Fragment,{children:a?C.jsxs(C.Fragment,{children:[C.jsx("line",{x1:c[0].x,y1:l-2*r,x2:c[1].x,y2:l+2*r}),C.jsx("line",{x1:u[0].x,y1:l-2*r,x2:u[1].x,y2:l+2*r}),C.jsx("line",{x1:c[0].x,y1:l,x2:u[0].x,y2:l}),C.jsx("line",{x1:(c[0].x+u[0].x)/2,y1:l-r,x2:(c[0].x+u[0].x)/2,y2:l+r})]}):C.jsxs(C.Fragment,{children:[C.jsx("line",{x1:l-2*r,y1:c[0].y,x2:l+2*r,y2:c[1].y}),C.jsx("line",{x1:l-2*r,y1:u[0].y,x2:l+2*r,y2:u[1].y}),C.jsx("line",{x1:l,y1:c[0].y,x2:l,y2:u[0].y}),C.jsx("line",{x1:l-r,y1:(c[0].y+u[0].y)/2,x2:l+r,y2:(c[0].y+u[0].y)/2})]})},f))})}function S$({className:t,line:o,zoom:n}){return C.jsx("svg",{className:Tt("tl-overlays__item",t),children:o.type==="points"?C.jsx(b$,{...o,zoom:n}):o.type==="gaps"?C.jsx(x$,{...o,zoom:n}):null})}function w$(){return C.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:C.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[C.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),C.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:C.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const _$=()=>null;function vI(t,o){const n=B.useRef(t);return o(t,n.current)?n.current:(n.current=t,t)}function r1(t){return vI(t,VL)}function hS(t){return vI(t,HT)}const bI=B.createContext({});function j$({overrides:t={},children:o}){const n=hS(t);return C.jsx(bI.Provider,{value:B.useMemo(()=>({Background:T6,SvgDefs:_$,Brush:Nf,ZoomBrush:Nf,ScreenshotBrush:Nf,CollaboratorBrush:Nf,Cursor:$2,CollaboratorCursor:$2,CollaboratorHint:u$,CollaboratorShapeIndicator:B2,Grid:d$,Scribble:U2,SnapIndicator:S$,Handles:f$,Handle:h$,CollaboratorScribble:U2,ErrorFallback:SI,ShapeErrorFallback:m$,ShapeIndicatorErrorFallback:v$,Spinner:w$,SelectionBackground:yI,SelectionForeground:p$,ShapeIndicator:B2,OnTheCanvas:null,InFrontOfTheCanvas:null,Canvas:zN,...n}),[n]),children:o})}function Vr(){return B.useContext(bI)}const fS={openWindow:(t,o)=>window.open(t,o,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var t;return await((t=window.__tldraw__hardReset)==null?void 0:t.call(window))}};function xI(){fS.hardReset()}function E$(){fS.refreshPage()}const C$="https://github.com/tldraw/tldraw/issues/new";function P$(){}const SI=({error:t,editor:o})=>{const n=B.useRef(null),[r,s]=B.useState(!1),[i,a]=B.useState(!1),[l,c]=B.useState(!1),{Canvas:u}=Vr(),f=t instanceof Error?t.message:String(t),h=t instanceof Error?t.stack:null,d=He("isDarkMode",()=>{try{if(o)return o.user.getIsDarkMode()}catch{}return null},[o]),[p,m]=B.useState(null);B.useLayoutEffect(()=>{var w;d!==null&&m(d);let x=(w=n.current)==null?void 0:w.parentElement,S=!1;for(;x;){if(x.classList.contains("tl-theme__dark")||x.classList.contains("tl-theme__light")){S=!0;break}x=x.parentElement}if(S){m(null);return}m(window.matchMedia("(prefers-color-scheme: dark)").matches)},[d]),B.useEffect(()=>{if(i){const x=setTimeout(()=>{a(!1)},2e3);return()=>clearTimeout(x)}},[i]);const g=()=>{const x=document.createElement("textarea");x.value=h??f,document.body.appendChild(x),x.select(),document.execCommand("copy"),x.remove(),a(!0)},b=()=>{E$()},y=async()=>{xI()},v=new URL(C$);return v.searchParams.set("title",f),v.searchParams.set("labels","bug"),v.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${h??f}
\`\`\`

My browser: ${navigator.userAgent}`),C.jsxs("div",{ref:n,className:Tt("tl-container tl-error-boundary",p===null?"":p?"tl-theme__dark":"tl-theme__light"),children:[C.jsx("div",{className:"tl-error-boundary__overlay"}),o&&C.jsx(Gk,{onError:P$,fallback:()=>null,children:C.jsx(Qg.Provider,{value:o,children:C.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:u?C.jsx(u,{}):null})})}),C.jsx("div",{className:Tt("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!l}),children:l?C.jsxs(C.Fragment,{children:[C.jsx("h2",{children:"Are you sure?"}),C.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),C.jsxs("div",{className:"tl-error-boundary__content__actions",children:[C.jsx("button",{onClick:()=>c(!1),children:"Cancel"}),C.jsx("button",{className:"tl-error-boundary__reset",onClick:y,children:"Reset data"})]})]}):C.jsxs(C.Fragment,{children:[C.jsx("h2",{children:"Something's gone wrong."}),C.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",C.jsx("a",{href:v.toString(),children:"create a GitHub issue"})," or"," ",C.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&C.jsxs(C.Fragment,{children:["Message:",C.jsx("h4",{children:C.jsx("code",{children:f})}),"Stack trace:",C.jsxs("div",{className:"tl-error-boundary__content__error",children:[C.jsx("pre",{children:C.jsx("code",{children:h??f})}),C.jsx("button",{onClick:g,children:i?"Copied!":"Copy"})]})]}),C.jsxs("div",{className:"tl-error-boundary__content__actions",children:[C.jsx("button",{onClick:()=>s(!r),children:r?"Hide details":"Show details"}),C.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[C.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>c(!0),children:"Reset data"}),C.jsx("button",{className:"tl-error-boundary__refresh",onClick:b,children:"Refresh Page"})]})]})]})})]})};function Mr(){return Yg()}const wI="TLDRAW_USER_DATA_v3",_I=zt({id:Lt,name:Lt.nullable().optional(),locale:Lt.nullable().optional(),color:Lt.nullable().optional(),isDarkMode:Vt.nullable().optional(),animationSpeed:It.nullable().optional(),edgeScrollSpeed:It.nullable().optional(),isSnapMode:Vt.nullable().optional(),isWrapMode:Vt.nullable().optional()}),Ec={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4,AddExcalidrawSelectMode:5},pS=Math.max(...Object.values(Ec));function T$(t){t.version<Ec.AddAnimationSpeed&&(t.user.animationSpeed=1),t.version<Ec.AddIsSnapMode&&(t.user.isSnapMode=!1),t.version<Ec.MakeFieldsNullable,t.version<Ec.AddEdgeScrollSpeed&&(t.user.edgeScrollSpeed=1),t.version<Ec.AddExcalidrawSelectMode&&(t.user.isWrapMode=!1),t.version=pS}const z2=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function k$(){return z2[Math.floor(Math.random()*z2.length)]}function I$(){var t,o;return typeof window>"u"?!1:((o=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-color-scheme: dark)"))==null?void 0:o.matches)??!1}function M$(){var t,o;return typeof window>"u"?!1:((o=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:o.matches)??!1}const ml=Object.freeze({name:"New User",locale:_6(),color:k$(),isDarkMode:!1,edgeScrollSpeed:1,animationSpeed:M$()?0:1,isSnapMode:!1,isWrapMode:!1});function M0(){return{id:Mr()}}function jI(t){if(t===null||typeof t!="object"||!("version"in t)||!("user"in t)||typeof t.version!="number")return M0();const o=_r(t);T$(o);try{return _I.validate(o.user)}catch{return M0()}}function O$(){const t=JSON.parse(qx(wI)||"null")??null;return jI(t)}const vh=po("globalUserData",null);function A$(){Kx(wI,JSON.stringify({version:pS,user:vh.get()}))}function R$(t){_I.validate(t),vh.set(t),A$(),L$()}const D$=typeof process<"u"&&!1,nu=typeof BroadcastChannel<"u"&&!D$?new BroadcastChannel("tldraw-user-sync"):null;nu==null||nu.addEventListener("message",t=>{const o=t.data;(o==null?void 0:o.type)===CI&&(o==null?void 0:o.origin)!==EI()&&vh.set(jI(o.data))});let O0=null;function EI(){return O0===null&&(O0=Mr()),O0}const CI="tldraw-user-preferences-change";function L$(){nu==null||nu.postMessage({type:CI,origin:EI(),data:{user:PI(),version:pS}})}function PI(){let t=vh.get();return t||(t=O$(),vh.set(t)),t}function TI(t={}){return{derivePresenceState:t.derivePresenceState??(()=>Xe("presence",()=>null)),userPreferences:t.userPreferences??Xe("userPreferences",()=>PI()),setUserPreferences:t.setUserPreferences??R$}}var kI={exports:{}};(function(t){var o=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function i(c,u,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var p=new s(f,h||c,d),m=n?n+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,h;if(this._eventsCount===0)return u;for(h in f=this._events)o.call(f,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=n?n+u:u,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,p=h.length,m=new Array(p);d<p;d++)m[d]=h[d].fn;return m},l.prototype.listenerCount=function(u){var f=n?n+u:u,h=this._events[f];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,f,h,d,p,m){var g=n?n+u:u;if(!this._events[g])return!1;var b=this._events[g],y=arguments.length,v,x;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),y){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,h),!0;case 4:return b.fn.call(b.context,f,h,d),!0;case 5:return b.fn.call(b.context,f,h,d,p),!0;case 6:return b.fn.call(b.context,f,h,d,p,m),!0}for(x=1,v=new Array(y-1);x<y;x++)v[x-1]=arguments[x];b.fn.apply(b.context,v)}else{var S=b.length,w;for(x=0;x<S;x++)switch(b[x].once&&this.removeListener(u,b[x].fn,void 0,!0),y){case 1:b[x].fn.call(b[x].context);break;case 2:b[x].fn.call(b[x].context,f);break;case 3:b[x].fn.call(b[x].context,f,h);break;case 4:b[x].fn.call(b[x].context,f,h,d);break;default:if(!v)for(w=1,v=new Array(y-1);w<y;w++)v[w-1]=arguments[w];b[x].fn.apply(b[x].context,v)}}return!0},l.prototype.on=function(u,f,h){return i(this,u,f,h,!1)},l.prototype.once=function(u,f,h){return i(this,u,f,h,!0)},l.prototype.removeListener=function(u,f,h,d){var p=n?n+u:u;if(!this._events[p])return this;if(!f)return a(this,p),this;var m=this._events[p];if(m.fn)m.fn===f&&(!d||m.once)&&(!h||m.context===h)&&a(this,p);else{for(var g=0,b=[],y=m.length;g<y;g++)(m[g].fn!==f||d&&!m[g].once||h&&m[g].context!==h)&&b.push(m[g]);b.length?this._events[p]=b.length===1?b[0]:b:a(this,p)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=n?n+u:u,this._events[f]&&a(this,f)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l})(kI);var F$=kI.exports;function Va({children:t,className:o="",...n}){return C.jsx("svg",{...n,className:Tt("tl-svg-container",o),children:t})}function mS(t,o,n,r){const s=t.x-n.x,i=t.y-n.y,a=r.x-n.x,l=r.y-n.y,c=o.x-t.x,u=o.y-t.y,f=a*i-l*s,h=c*i-u*s,d=l*c-a*u;if(f===0||h===0||d===0)return null;if(d!==0){const p=f/d,m=h/d;if(0<=p&&p<=1&&0<=m&&m<=1)return Y.AddXY(t,p*c,p*u)}return null}function ty(t,o,n,r){const s=(o.x-t.x)*(o.x-t.x)+(o.y-t.y)*(o.y-t.y),i=2*((o.x-t.x)*(t.x-n.x)+(o.y-t.y)*(t.y-n.y)),a=n.x*n.x+n.y*n.y+t.x*t.x+t.y*t.y-2*(n.x*t.x+n.y*t.y)-r*r,l=i*i-4*s*a;if(l<0||l===0)return null;const c=Math.sqrt(l),u=(-i+c)/(2*s),f=(-i-c)/(2*s);if((u<0||u>1)&&(f<0||f>1))return null;const h=[];return 0<=u&&u<=1&&h.push(Y.Lrp(t,o,u)),0<=f&&f<=1&&h.push(Y.Lrp(t,o,f)),h.length===0?null:h}function N$(t,o,n){const r=[];let s;for(let i=0,a=n.length-1;i<a;i++)s=mS(t,o,n[i],n[i+1]),s&&r.push(s);return r.length===0?null:r}function gS(t,o,n){const r=[];let s;for(let i=1,a=n.length;i<a+1;i++)s=mS(t,o,n[i-1],n[i%n.length]),s&&r.push(s);return r.length===0?null:r}function $$(t,o,n,r){let s=n.x-t.x,i=n.y-t.y;const a=Math.sqrt(s*s+i*i),l=(a*a-r*r+o*o)/(2*a),c=Math.sqrt(o*o-l*l);return s/=a,i/=a,[new Y(t.x+s*l-i*c,t.y+i*l+s*c),new Y(t.x+s*l+i*c,t.y+i*l-s*c)]}function n1(t,o,n){const r=[];let s,i,a;for(let l=0,c=n.length;l<c;l++)s=n[l],i=n[(l+1)%n.length],a=ty(s,i,t,o),a&&r.push(...a);return r.length===0?null:r}function G2(t,o,n){const r=[];let s,i,a;for(let l=1,c=n.length;l<c;l++)s=n[l-1],i=n[l],a=ty(s,i,t,o),a&&r.push(...a);return r.length===0?null:r}function Uf(t,o,n){return(n.y-t.y)*(o.x-t.x)>(o.y-t.y)*(n.x-t.x)}function yS(t,o,n,r){return Uf(t,n,r)!==Uf(o,n,r)&&Uf(t,o,n)!==Uf(t,o,r)}function V2(t,o){const n=new Map;let r,s,i,a;for(let l=0,c=t.length;l<c;l++)if(r=t[l],Zo(r,o)){const u=A0(r);n.has(u)||n.set(u,r)}for(let l=0,c=o.length;l<c;l++)if(r=o[l],Zo(r,t)){const u=A0(r);n.has(u)||n.set(u,r)}for(let l=0,c=t.length;l<c;l++){r=t[l],s=t[(l+1)%t.length];for(let u=0,f=o.length;u<f;u++){i=o[u],a=o[(u+1)%o.length];const h=mS(r,s,i,a);if(h!==null){const d=A0(h);n.has(d)||n.set(d,h)}}}return n.size===0?null:U$([...n.values()])}function A0(t){return`${t.x},${t.y}`}function U$(t){const o=Y.Average(t);return t.sort((n,r)=>Y.Angle(o,n)-Y.Angle(o,r))}function II(t,o){let n,r,s,i;for(let a=0,l=t.length;a<l;a++){n=t[a],r=t[(a+1)%l];for(let c=0,u=o.length;c<u;c++)if(s=o[c],i=o[(c+1)%u],yS(n,r,s,i))return!0}return!1}function B$(t,o){let n,r,s,i;for(let a=0,l=t.length;a<l;a++){n=t[a],r=t[(a+1)%l];for(let c=1,u=o.length;c<u;c++)if(s=o[c-1],i=o[c],yS(n,r,s,i))return!0}return!1}class bh extends Ql{constructor(n){super({...n,isClosed:!1,isFilled:!1});D(this,"start");D(this,"end");D(this,"d");D(this,"u");D(this,"ul");D(this,"_length");const{start:r,end:s}=n;this.start=r,this.end=s,this.d=r.clone().sub(s),this.u=this.d.clone().uni(),this.ul=this.u.len()}get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(n){const{start:r,end:s,u:i,ul:a}=this;if(a===0)return r;const l=Y.Sub(n,r).dpr(i)/a,c=r.x+i.x*l;if(c<Math.min(r.x,s.x))return r.x<s.x?r:s;if(c>Math.max(r.x,s.x))return r.x>s.x?r:s;const u=r.y+i.y*l;return u<Math.min(r.y,s.y)?r.y<s.y?r:s:u>Math.max(r.y,s.y)?r.y>s.y?r:s:new Y(c,u)}hitTestLineSegment(n,r,s=0){return yS(n,r,this.start,this.end)||this.distanceToLineSegment(n,r)<=s}}class Jl extends Ql{constructor(n){super({isClosed:!1,isFilled:!1,...n});D(this,"points");D(this,"_segments");D(this,"_length");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:n}=this;for(let r=0,s=n.length-1;r<s;r++){const i=n[r],a=n[r+1];this._segments.push(new bh({start:i,end:a}))}this.isClosed&&this._segments.push(new bh({start:n[n.length-1],end:n[0]}))}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((n,r)=>n+r.length,0)),this._length}getVertices(){return this.points}nearestPoint(n){const{segments:r}=this;let s=this.points[0],i=1/0,a,l;for(let c=0;c<r.length;c++)a=r[c].nearestPoint(n),l=Y.Dist2(a,n),l<i&&(s=a,i=l);if(!s)throw Error("nearest point not found");return s}hitTestLineSegment(n,r,s=0){const{segments:i}=this;for(let a=0,l=i.length;a<l;a++)if(i[a].hitTestLineSegment(n,r,s))return!0;return!1}}class cn extends Jl{constructor(o){super({...o}),this.isClosed=!0}}class Hi extends cn{constructor(n){const{x:r=0,y:s=0,width:i,height:a}=n;super({...n,points:[new Y(r,s),new Y(r+i,s),new Y(r+i,s+a),new Y(r,s+a)]});D(this,"x");D(this,"y");D(this,"w");D(this,"h");this.x=r,this.y=s,this.w=i,this.h=a}getBounds(){return new mt(this.x,this.y,this.w,this.h)}}class Bs{constructor(o){D(this,"canSnap",()=>!0);D(this,"canScroll",()=>!1);D(this,"canBind",(o,n)=>!0);D(this,"canEdit",()=>!1);D(this,"canResize",()=>!0);D(this,"canEditInReadOnly",()=>!1);D(this,"canCrop",()=>!1);D(this,"hideResizeHandles",()=>!1);D(this,"hideRotateHandle",()=>!1);D(this,"hideSelectionBoundsBg",()=>!1);D(this,"hideSelectionBoundsFg",()=>!1);D(this,"isAspectRatioLocked",()=>!1);D(this,"onBeforeCreate");D(this,"onBeforeUpdate");D(this,"onDragShapesOver");D(this,"onDragShapesOut");D(this,"onDropShapesOver");D(this,"onResizeStart");D(this,"onResize");D(this,"onResizeEnd");D(this,"onTranslateStart");D(this,"onTranslate");D(this,"onTranslateEnd");D(this,"onHandleDrag");D(this,"onRotateStart");D(this,"onRotate");D(this,"onRotateEnd");D(this,"onBindingChange");D(this,"onChildrenChange");D(this,"onDoubleClickHandle");D(this,"onDoubleClickEdge");D(this,"onDoubleClick");D(this,"onClick");D(this,"onEditEnd");this.editor=o}providesBackgroundForChildren(o){return!1}canReceiveNewChildrenOfType(o,n){return!1}canDropShapes(o,n){return!1}expandSelectionOutlinePx(o){return 0}getCanvasSvgDefs(){return[]}getBoundsSnapGeometry(o){return{}}getHandleSnapGeometry(o){return{}}}D(Bs,"props"),D(Bs,"migrations"),D(Bs,"type");function z$(t,o,n={}){const{closed:r=!1,snap:s=1,start:i="outset",end:a="outset",lengthRatio:l=2,style:c="dashed"}=n;let u=0,f=0,h=1,d=0,p=0;switch(c){case"dashed":{h=1,u=Math.min(o*l,t/4);break}case"dotted":{h=100,u=o/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(i==="outset"?(t+=u/2,p+=u/2):i==="skip"&&(t-=u,p-=u),a==="outset"?t+=u/2:a==="skip"&&(t-=u)),f=Math.floor(t/u/(2*h)),f-=f%s,f<3&&c==="dashed"?t/o<5?(u=t,f=1,d=0):(u=t*.333,d=t*.333):(f=Math.max(f,3),u=t/f/(2*h),r?(p=u/2,d=(t-f*u)/f):d=(t-f*u)/Math.max(1,f-1)),{strokeDasharray:[u,d].join(" "),strokeDashoffset:p.toString()}}function H2({bounds:t,className:o}){const n=Ue(),r=He("zoom level",()=>n.getZoomLevel(),[n]);return C.jsx("g",{className:o,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((s,i)=>{const{strokeDasharray:a,strokeDashoffset:l}=z$(s[0].dist(s[1]),1/r,{style:"dashed",lengthRatio:4});return C.jsx("line",{x1:s[0].x,y1:s[0].y,x2:s[1].x,y2:s[1].y,strokeDasharray:a,strokeDashoffset:l},i)})})}class Lp extends Bs{constructor(){super(...arguments);D(this,"hideSelectionBoundsFg",()=>!0);D(this,"canBind",()=>!1);D(this,"onChildrenChange",n=>{const r=this.editor.getSortedChildIdsForParent(n.id);if(r.length===0){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([n.id]);return}else if(r.length===1){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(r,n.parentId),this.editor.deleteShapes([n.id]);return}})}getDefaultProps(){return{}}getGeometry(n){const r=this.editor.getSortedChildIdsForParent(n.id);return r.length===0?new Hi({width:1,height:1,isFilled:!1}):new Vs({children:r.map(s=>{const i=this.editor.getShape(s),a=this.editor.getShapeGeometry(s),l=this.editor.getShapeLocalTransform(i).applyToPoints(a.vertices);return a.isClosed?new cn({points:l,isFilled:!0}):new Jl({points:l})})})}component(n){const r=this.editor.getErasingShapeIds().includes(n.id),{hintingShapeIds:s}=this.editor.getCurrentPageState(),i=s.length>0&&s.some(c=>c!==n.id&&this.editor.isShapeOfType(this.editor.getShape(c),"group")),a=this.editor.getCurrentPageState().focusedGroupId!==n.id;if(!r&&(a||i))return null;const l=this.editor.getShapeGeometry(n).bounds;return C.jsx(Va,{id:n.id,children:C.jsx(H2,{className:"tl-group",bounds:l})})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return C.jsx(H2,{className:"",bounds:r})}}D(Lp,"type","group"),D(Lp,"props",Tk),D(Lp,"migrations",kk);const MI=[Lp],G$=new Set(MI.map(t=>t.type));function OI(t){const o=[...MI],n=new Set;for(const r of t){if(G$.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);o.push(r),n.add(r.type)}return o}function W2(t,o){if(!o)return!1;switch(t.type){case"mixed":return o.type==="mixed";case"shared":return o.type==="shared"&&t.value===o.value;default:throw Zi(t)}}class V${constructor(o){D(this,"map");this.map=new Map(o)}get(o){return this.map.get(o)}getAsKnownValue(o){const n=this.get(o);if(n&&n.type!=="mixed")return n.value}get size(){return this.map.size}equals(o){if(this.size!==o.size)return!1;const n=new Set;for(const[r,s]of this){if(!W2(s,o.get(r)))return!1;n.add(r)}for(const[r,s]of o)if(!n.has(r)&&!W2(s,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class o1 extends V${set(o,n){this.map.set(o,n)}applyValue(o,n){const r=this.get(o);if(!r){this.set(o,{type:"shared",value:n});return}switch(r.type){case"mixed":return;case"shared":r.value!==n&&this.set(o,{type:"mixed"});return;default:Zi(r,"type")}}}class ry{constructor(){D(this,"items",new WeakMap)}get(o,n){return this.items.has(o)||this.items.set(o,n(o)),this.items.get(o)}access(o){return this.items.get(o)}set(o,n){this.items.set(o,n)}has(o){return this.items.has(o)}invalidate(o){this.items.delete(o)}bust(){this.items=new WeakMap}}function H$(t,o,n){return fetch(t).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],o,{type:n})})}function W$(t,o){var s;let n=t;const r=new Set(o);for(;r.has(n);)n=(s=/^.*(\d+)$/.exec(n))!=null&&s[1]?n.replace(/(\d+)(?=\D?)$/,i=>(+i+1).toString()):`${n} 1`;return n}function Bf(t,o,n){if(n.length===0)return[];const r=new Map;for(const i of Rt(n.map(a=>t.getShape(a)))){const{parentId:a}=i;r.has(a)||r.set(a,{children:Rt(t.getSortedChildIdsForParent(a).map(l=>t.getShape(l))),moving:new Set}),r.get(a).moving.add(i)}const s=[];switch(o){case"toBack":{r.forEach(({moving:i,children:a})=>Y$(i,a,s));break}case"toFront":{r.forEach(({moving:i,children:a})=>X$(i,a,s));break}case"forward":{r.forEach(({moving:i,children:a})=>q$(i,a,s));break}case"backward":{r.forEach(({moving:i,children:a})=>K$(i,a,s));break}}return s}function Y$(t,o,n){const r=o.length;if(t.size===r)return;let s,i;for(let a=0;a<r;a++){const l=o[a];if(t.has(l))s=l.index,t.delete(l);else{i=l.index;break}}if(t.size!==0){const a=gu(s,i,t.size);n.push(...Array.from(t.values()).sort(qn).map((l,c)=>({...l,index:a[c]})))}}function X$(t,o,n){const r=o.length;if(t.size===r)return;let s,i;for(let a=r-1;a>-1;a--){const l=o[a];if(t.has(l))i=l.index,t.delete(l);else{s=l.index;break}}if(t.size!==0){const a=gu(s,i,t.size);n.push(...Array.from(t.values()).sort(qn).map((l,c)=>({...l,index:a[c]})))}}function q$(t,o,n){var i;const r=o.length;if(t.size===r)return;let s={name:"skipping"};for(let a=0;a<r;a++){const l=t.has(o[a]);switch(s.name){case"skipping":{if(!l)continue;s={name:"selecting",selectIndex:a};break}case"selecting":{if(l)continue;const{selectIndex:c}=s;gu(o[a].index,(i=o[a+1])==null?void 0:i.index,a-c).forEach((u,f)=>n.push({...o[c+f],index:u})),s={name:"skipping"};break}}}}function K$(t,o,n){var i;const r=o.length;if(t.size===r)return;let s={name:"skipping"};for(let a=r-1;a>-1;a--){const l=t.has(o[a]);switch(s.name){case"skipping":{if(!l)continue;s={name:"selecting",selectIndex:a};break}case"selecting":{if(l)continue;gu((i=o[a-1])==null?void 0:i.index,o[a].index,s.selectIndex-a).forEach((c,u)=>{n.push({...o[a+u+1],index:c})}),s={name:"skipping"};break}}}}function AI({editor:t}){const o=t.getSelectedShapes(),n=t.getSelectionRotation(),r=t.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:s}}=t;if(!r)return null;const i=r.center.clone().rotWith(r.point,n);return{selectionPageCenter:i,initialCursorAngle:i.angle(s),initialSelectionRotation:n,shapeSnapshots:o.map(a=>({shape:_r(a),initialPagePoint:t.getShapePageTransform(a.id).point()}))}}function Fp({delta:t,editor:o,snapshot:n,stage:r}){const{selectionPageCenter:s,shapeSnapshots:i}=n;o.updateShapes(i.map(({shape:l,initialPagePoint:c})=>{const u=Vo(l.parentId)?o.getShapePageTransform(l.parentId):vt.Identity(),f=Y.RotWith(c,s,t),h=vt.applyToPoint(vt.Inverse(u),f),d=Na(l.rotation+t);return{id:l.id,type:l.type,x:h.x,y:h.y,rotation:d}}));const a=[];i.forEach(({shape:l})=>{var h,d,p;const c=o.getShape(l.id);if(!c)return;const u=o.getShapeUtil(l);if(r==="start"||r==="one-off"){const m=(h=u.onRotateStart)==null?void 0:h.call(u,l);m&&a.push(m)}const f=(d=u.onRotate)==null?void 0:d.call(u,l,c);if(f&&a.push(f),r==="end"||r==="one-off"){const m=(p=u.onRotateEnd)==null?void 0:p.call(u,l,c);m&&a.push(m)}}),a.length>0&&o.updateShapes(a)}const Z$=t=>{const{store:o}=t,n=o.query.filterHistory("shape"),r=o.query.records("shape",()=>({type:{eq:"arrow"}}));function s(){const i=r.get(),a={};for(const l of i){const{start:c,end:u}=l.props;if(c.type==="binding"){const f=a[c.boundShapeId];f?f.push({arrowId:l.id,handleId:"start"}):a[c.boundShapeId]=[{arrowId:l.id,handleId:"start"}]}if(u.type==="binding"){const f=a[u.boundShapeId];f?f.push({arrowId:l.id,handleId:"end"}):a[u.boundShapeId]=[{arrowId:l.id,handleId:"end"}]}}return a}return Xe("arrowBindingsIndex",(i,a)=>{if(Ml(i))return s();const l=i,c=n.getDiffSince(a);if(c===Ko)return s();let u;function f(p){u||(u={...l}),u[p]?u[p]===l[p]&&(u[p]=[...u[p]]):u[p]=[]}function h(p,m,g){f(p),u[p]=u[p].filter(b=>b.arrowId!==m||b.handleId!==g),u[p].length===0&&delete u[p]}function d(p,m,g){f(p),u[p].push({arrowId:m,handleId:g})}for(const p of c){for(const m of Object.values(p.added))if(t.isShapeOfType(m,"arrow")){const{start:g,end:b}=m.props;g.type==="binding"&&d(g.boundShapeId,m.id,"start"),b.type==="binding"&&d(b.boundShapeId,m.id,"end")}for(const[m,g]of Object.values(p.updated))if(!(!t.isShapeOfType(m,"arrow")||!t.isShapeOfType(g,"arrow")))for(const b of["start","end"]){const y=m.props[b],v=g.props[b];y.type==="binding"&&v.type==="point"?h(y.boundShapeId,m.id,b):y.type==="point"&&v.type==="binding"?d(v.boundShapeId,g.id,b):y.type==="binding"&&v.type==="binding"&&y.boundShapeId!==v.boundShapeId&&(h(y.boundShapeId,m.id,b),d(v.boundShapeId,g.id,b))}for(const m of Object.values(p.removed))if(t.isShapeOfType(m,"arrow")){const{start:g,end:b}=m.props;g.type==="binding"&&h(g.boundShapeId,m.id,"start"),b.type==="binding"&&h(b.boundShapeId,m.id,"end")}}return u??l})};function Q$(t,o,n){const r=t.getShapeMaskedPageBounds(o);return r===void 0?!0:!n.includes(r)}const J$=t=>{const o=Number.isFinite(t.renderingBoundsMargin);function n(r){const s=r.getCurrentPageShapeIds(),i=r.getViewportPageBounds(),a=new Set;return s.forEach(l=>{Q$(r,l,i)&&a.add(l)}),a}return Xe("getCulledShapes",r=>{if(!o)return new Set;if(Ml(r))return n(t);const s=n(t);if(r.size!==s.size)return s;for(const i of r)if(!s.has(i))return s;return r})},eU=t=>{const o=t.query.ids("shape"),n=t.query.filterHistory("shape");function r(){const s={},i=o.get(),a=Array(i.size);return i.forEach(l=>a.push(t.get(l))),a.sort(qn),a.forEach(l=>{s[l.parentId]||(s[l.parentId]=[]),s[l.parentId].push(l.id)}),s}return Xe("parentsToChildrenWithIndexes",(s,i)=>{if(Ml(s))return r();const a=n.getDiffSince(i);if(a===Ko)return r();if(a.length===0)return s;let l=null;const c=h=>{l||(l={...s}),l[h]?l[h]===s[h]&&(l[h]=[...l[h]]):l[h]=[]},u=new Set;let f;for(let h=0,d=a.length;h<d;h++){f=a[h];for(const p of Object.values(f.added))zc(p)&&(c(p.parentId),l[p.parentId].push(p.id),u.add(l[p.parentId]));for(const[p,m]of Object.values(f.updated))if(zc(m)&&zc(p)){if(p.parentId!==m.parentId)c(p.parentId),c(m.parentId),l[p.parentId].splice(l[p.parentId].indexOf(m.id),1),l[m.parentId].push(m.id),u.add(l[m.parentId]);else if(p.index!==m.index){c(m.parentId);const g=l[m.parentId].indexOf(m.id);l[m.parentId][g]=m.id,u.add(l[m.parentId])}}for(const p of Object.values(f.removed))zc(p)&&(c(p.parentId),l[p.parentId].splice(l[p.parentId].indexOf(p.id),1))}for(const h of u){const d=Rt(h.map(p=>t.get(p)));d.sort(qn),h.splice(0,h.length,...d.map(p=>p.id))}return l??s})},R0=(t,o,n)=>{for(;!_o(n.parentId);){const r=t.get(n.parentId);if(!r)return!1;n=r}return n.parentId===o},tU=(t,o)=>{const n=t.query.ids("shape");let r=null;function s(){const i=o();return r=i,new Set([...n.get()].filter(a=>R0(t,i,t.get(a))))}return Xe("_shapeIdsInCurrentPage",(i,a)=>{if(Ml(i))return s();const l=o();if(l!==r)return s();const c=t.history.getDiffSince(a);if(c===Ko)return s();const u=new Ip(i);for(const h of c){for(const d of Object.values(h.added))zc(d)&&R0(t,l,d)&&u.add(d.id);for(const[d,p]of Object.values(h.updated))zc(p)&&(R0(t,l,p)?u.add(p.id):u.remove(p.id));for(const d of Object.keys(h.removed))Vo(d)&&u.remove(d)}const f=u.get();return f?jd(f.value,f.diff):i})},RI=B.createContext(null);function rU({context:t,editor:o,children:n}){return C.jsx(Qg.Provider,{value:o,children:C.jsx(RI.Provider,{value:t,children:n})})}function DI(){const t=B.useContext(RI);return t?{isDarkMode:t.isDarkMode}:null}async function nU(t,o,n={}){var w,E;const r=typeof o[0]=="string"?o:o.map(j=>j.id);if(r.length===0)return;if(!window.document)throw Error("No document");const{scale:s=1,background:i=!1,padding:a=B6,preserveAspectRatio:l=!1}=n,c=n.darkMode??t.user.getIsDarkMode(),u=ea({isDarkMode:c}),f=t.getShapeAndDescendantIds(r),h=t.getUnorderedRenderingShapes(!1).filter(({id:j})=>f.has(j));let d=null;if(n.bounds)d=n.bounds;else for(const{id:j}of h){const P=t.getShapeMaskedPageBounds(j);P&&(d?d.union(P):d=P.clone())}if(!d)return;const p=r.length===1&&t.isShapeOfType(t.getShape(r[0]),"frame")?r[0]:null;p||d.expandBy(a);const m=d.width*s,g=d.height*s;try{(E=(w=document.body).focus)==null||E.call(w)}catch{}const b=[],y=new Map,v={isDarkMode:c,addExportDef:j=>{if(y.has(j.key))return;const P=(async()=>{const M=await j.getElement();M&&b.push(C.jsx(B.Fragment,{children:M},b.length))})();y.set(j.key,P)}},x=(await Promise.all(h.map(async({id:j,opacity:P,index:M,backgroundIndex:O})=>{var W,V;if(j===p)return[];const k=t.getShape(j);if(t.isShapeOfType(k,"group"))return[];const F=t.getShapeUtil(k);let A=await((W=F.toSvg)==null?void 0:W.call(F,k,v)),N=await((V=F.toBackgroundSvg)==null?void 0:V.call(F,k,v));if(!A&&!N){const q=t.getShapePageBounds(k);A=C.jsx("rect",{width:q.w,height:q.h,fill:u.solid,stroke:u.grey.pattern,strokeWidth:1})}let $=t.getShapePageTransform(k).toCssString();"scale"in k.props&&k.props.scale!==1&&($=`${$} scale(${k.props.scale}, ${k.props.scale})`),A&&(A=C.jsx("g",{transform:$,opacity:P,children:A},k.id)),N&&(N=C.jsx("g",{transform:$,opacity:P,children:N},`bg_${k.id}`));const G=t.getShapeMask(k.id);if(G){const q=`mask_${k.id.replace(":","_")}`;b.push(C.jsx("clipPath",{id:q,children:C.jsx("path",{d:`M${G.map(({x:J,y:ae})=>`${J},${ae}`).join("L")}Z`})},b.length)),A&&(A=C.jsx("g",{clipPath:`url(#${q})`,children:A},k.id)),N&&(N=C.jsx("g",{clipPath:`url(#${q})`,children:N},`bg_${k.id}`))}const X=[];return A&&X.push({zIndex:M,element:A}),N&&X.push({zIndex:O,element:N}),X}))).flat();return await Promise.all(y.values()),{jsx:C.jsx(rU,{editor:t,context:v,children:C.jsxs("svg",{preserveAspectRatio:l||void 0,direction:"ltr",width:m,height:g,viewBox:`${d.minX} ${d.minY} ${d.width} ${d.height}`,strokeLinecap:"round",strokeLinejoin:"round",style:{backgroundColor:i?p?u.solid:u.background:"transparent"},children:[C.jsx("defs",{children:b}),x.sort((j,P)=>j.zIndex-P.zIndex).map(({element:j})=>j)]})}),width:m,height:g}}const oU=40;class sU{constructor(o){D(this,"_clickId","");D(this,"_clickTimeout");D(this,"_clickScreenPoint");D(this,"_previousScreenPoint");D(this,"_getClickTimeout",(o,n=Mr())=>{this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===o&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},o==="idle"||o==="pendingDouble"?$6:U6)});D(this,"_clickState","idle");D(this,"lastPointerInfo",{});D(this,"transformPointerDownEvent",o=>{if(!this._clickState)return o;switch(this._clickScreenPoint=Y.From(o.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>oU&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=o,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),o;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...o,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...o,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...o,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),o;default:return this._clickTimeout=this._getClickTimeout(this._clickState),o}});D(this,"transformPointerUpEvent",o=>{if(!this._clickState)return o;switch(this._clickScreenPoint=Y.From(o.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return o}});D(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});D(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&Y.Dist2(this._clickScreenPoint,this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?Jb:gh)&&this.cancelDoubleClickTimeout()});this.editor=o}get clickState(){return this._clickState}}class iU{constructor(o){D(this,"isSafari");D(this,"isIos");D(this,"isChromeForIos");D(this,"isFirefox");D(this,"isAndroid");this.editor=o,typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}}function gl(t){if(t){let o=Y2;for(;t.length;)o=o.push(t.pop());return o}return Y2}class aU{constructor(){D(this,"length",0);D(this,"head",null);D(this,"tail",this)}push(o){return new vS(o,this)}toArray(){return Di}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const Y2=new aU;class vS{constructor(o,n){D(this,"length");this.head=o,this.tail=n,this.length=n.length+1}push(o){return new vS(o,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let o=this;return{next(){if(o.length){const n=o.head;return o=o.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class lU{constructor(o,n){D(this,"_undos",po("HistoryManager.undos",gl()));D(this,"_redos",po("HistoryManager.redos",gl()));D(this,"_batchDepth",0);D(this,"onBatchComplete",()=>{});D(this,"_commands",{});D(this,"createCommand",(o,n,r)=>{if(this._commands[o])throw new Error(`Duplicate command: ${o}`);this._commands[o]=r;const s=(...i)=>{if(!this._batchDepth)return this.batch(()=>s(...i)),this.ctx;const a=n(...i);if(!a)return this.ctx;const{data:l,ephemeral:c,squashing:u,preservesRedoStack:f}=a;if(this.ignoringUpdates((h,d)=>(r.do(l),{undos:h,redos:d})),!c){const h=this._undos.get().head;u&&h&&h.type==="command"&&h.name===o&&h.preservesRedoStack===f?this._undos.update(d=>d.tail.push({...h,data:r.squash(h.data,l)})):this._undos.update(d=>d.push({type:"command",name:o,data:l,preservesRedoStack:f})),a.preservesRedoStack||this._redos.set(gl()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return s});D(this,"batch",o=>{try{this._batchDepth++,this._batchDepth===1?Rs(()=>{const n=this._undos.get().head;o(),n!==this._undos.get().head&&this.onBatchComplete()}):o()}catch(n){throw this.annotateError(n),n}finally{this._batchDepth--}return this});D(this,"ignoringUpdates",o=>{let n=this._undos.get(),r=this._redos.get();this._undos.set(gl()),this._redos.set(gl());try{({undos:n,redos:r}=Rs(()=>o(n,r)))}finally{this._undos.set(n),this._redos.set(r)}});D(this,"_undo",({pushToRedoStack:o,toMark:n=void 0})=>(this.ignoringUpdates((r,s)=>{var i;if(r.length===0)return{undos:r,redos:s};for(;((i=r.head)==null?void 0:i.type)==="STOP";){const a=r.head;if(r=r.tail,o&&(s=s.push(a)),a.id===n)return this.ctx.emit("change-history",o?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:s}}if(r.length===0)return this.ctx.emit("change-history",o?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:s};for(;r.head;){const a=r.head;if(r=r.tail,o&&(s=s.push(a)),a.type==="STOP"){if(a.onUndo&&(!n||a.id===n))return this.ctx.emit("change-history",o?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:s}}else this._commands[a.name].undo(a.data)}return this.ctx.emit("change-history",o?{reason:"undo"}:{reason:"bail",markId:n}),{undos:r,redos:s}}),this));D(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));D(this,"redo",()=>(this.ignoringUpdates((o,n)=>{var r;if(n.length===0)return{undos:o,redos:n};for(;((r=n.head)==null?void 0:r.type)==="STOP";)o=o.push(n.head),n=n.tail;if(n.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:o,redos:n};for(;n.head;){const s=n.head;if(o=o.push(n.head),n=n.tail,s.type==="STOP"){if(s.onRedo)break}else{const i=this._commands[s.name];i.redo?i.redo(s.data):i.do(s.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:o,redos:n}}),this));D(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));D(this,"bailToMark",o=>(this._undo({pushToRedoStack:!1,toMark:o}),this));D(this,"mark",(o=Mr(),n=!0,r=!0)=>{const s=this._undos.get().head;return s&&s.type==="STOP"&&s.id===o&&s.onUndo===n&&s.onRedo===r?s.id:(this._undos.update(i=>i.push({type:"STOP",id:o,onUndo:n,onRedo:r})),this.ctx.emit("mark-history",{id:o}),o)});this.ctx=o,this.annotateError=n}getNumUndos(){return this._undos.get().length}getNumRedos(){return this._redos.get().length}clear(){this._undos.set(gl()),this._redos.set(gl())}}class cU{constructor(o){D(this,"scribbleItems",new Map);D(this,"state","paused");D(this,"addScribble",(o,n=Mr())=>{const r={id:n,scribble:{id:n,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...o,state:"starting"},timeoutMs:0,delayRemaining:o.delay??0,prev:null,next:null};return this.scribbleItems.set(n,r),r});D(this,"stop",o=>{const n=this.scribbleItems.get(o);if(!n)throw Error(`Scribble with id ${o} not found`);return n.delayRemaining=Math.min(n.delayRemaining,200),n.scribble.state="stopping",n});D(this,"addPoint",(o,n,r)=>{const s=this.scribbleItems.get(o);if(!s)throw Error(`Scribble with id ${o} not found`);const{prev:i}=s,a={x:n,y:r,z:.5};return(!i||Y.Dist(i,a)>=1)&&(s.next=a),s});D(this,"tick",o=>{this.scribbleItems.size!==0&&this.editor.batch(()=>{this.scribbleItems.forEach(n=>{if(n.scribble.state==="starting"){const{next:c,prev:u}=n;c&&c!==u&&(n.prev=c,n.scribble.points.push(c)),n.scribble.points.length>8&&(n.scribble.state="active");return}n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-o)),n.timeoutMs+=o,n.timeoutMs>=16&&(n.timeoutMs=0);const{delayRemaining:r,timeoutMs:s,prev:i,next:a,scribble:l}=n;switch(l.state){case"active":{a&&a!==i?(n.prev=a,l.points.push(a),r===0&&l.points.length>8&&l.points.shift()):s===0&&(l.points.length>1?l.points.shift():n.delayRemaining=l.delay);break}case"stopping":{if(n.delayRemaining===0&&s===0){if(l.points.length===1){this.scribbleItems.delete(n.id);return}l.shrink&&(l.size=Math.max(1,l.size*(1-l.shrink))),l.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:n})=>({...n,points:[...n.points]})).slice(-5)})})});this.editor=o}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear()}}class uU{constructor(o){D(this,"_beforeCreateHandlers",{});D(this,"_afterCreateHandlers",{});D(this,"_beforeChangeHandlers",{});D(this,"_afterChangeHandlers",{});D(this,"_beforeDeleteHandlers",{});D(this,"_afterDeleteHandlers",{});D(this,"_batchCompleteHandlers",[]);this.editor=o,o.store.onBeforeCreate=(r,s)=>{const i=this._beforeCreateHandlers[r.typeName];if(i){let a=r;for(const l of i)a=l(a,s);return a}return r},o.store.onAfterCreate=(r,s)=>{const i=this._afterCreateHandlers[r.typeName];if(i)for(const a of i)a(r,s)},o.store.onBeforeChange=(r,s,i)=>{const a=this._beforeChangeHandlers[s.typeName];if(a){let l=s;for(const c of a)l=c(r,l,i);return l}return s};let n=0;o.store.onAfterChange=(r,s,i)=>{if(n++,n>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{const a=this._afterChangeHandlers[s.typeName];if(a)for(const l of a)l(r,s,i)}n--},o.store.onBeforeDelete=(r,s)=>{const i=this._beforeDeleteHandlers[r.typeName];if(i){for(const a of i)if(a(r,s)===!1)return!1}},o.store.onAfterDelete=(r,s)=>{const i=this._afterDeleteHandlers[r.typeName];if(i)for(const a of i)a(r,s)},o.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach(r=>r())}}registerBeforeCreateHandler(o,n){return this._beforeCreateHandlers[o]||(this._beforeCreateHandlers[o]=[]),this._beforeCreateHandlers[o].push(n),()=>yl(this._beforeCreateHandlers[o],n)}registerAfterCreateHandler(o,n){return this._afterCreateHandlers[o]||(this._afterCreateHandlers[o]=[]),this._afterCreateHandlers[o].push(n),()=>yl(this._afterCreateHandlers[o],n)}registerBeforeChangeHandler(o,n){return this._beforeChangeHandlers[o]||(this._beforeChangeHandlers[o]=[]),this._beforeChangeHandlers[o].push(n),()=>yl(this._beforeChangeHandlers[o],n)}registerAfterChangeHandler(o,n){return this._afterChangeHandlers[o]||(this._afterChangeHandlers[o]=[]),this._afterChangeHandlers[o].push(n),()=>yl(this._afterChangeHandlers[o],n)}registerBeforeDeleteHandler(o,n){return this._beforeDeleteHandlers[o]||(this._beforeDeleteHandlers[o]=[]),this._beforeDeleteHandlers[o].push(n),()=>yl(this._beforeDeleteHandlers[o],n)}registerAfterDeleteHandler(o,n){return this._afterDeleteHandlers[o]||(this._afterDeleteHandlers[o]=[]),this._afterDeleteHandlers[o].push(n),()=>yl(this._afterDeleteHandlers[o],n)}registerBatchCompleteHandler(o){return this._batchCompleteHandlers.push(o),()=>yl(this._batchCompleteHandlers,o)}}function yl(t,o){const n=t.indexOf(o);n>=0&&t.splice(n,1)}var dU=Object.defineProperty,hU=Object.getOwnPropertyDescriptor,ny=(t,o,n,r)=>{for(var s=r>1?void 0:r?hU(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&dU(o,n,s),s};const kt=t=>Math.round(t*10**8)/10**8;function Ci(t,o,n,r,s){const i=t.filter(l=>(r==="forward"?l.startNode.id===o:l.endNode.id===o)&&kt(l.length)===kt(n)&&Ms(l.breadthIntersection[0],l.breadthIntersection[1],s[0],s[1]));if(i.length===0)return[];const a=new Set;return i.forEach(l=>{const c=r==="forward"?l.endNode.id:l.startNode.id;if(!a.has(c)){a.add(c);const u=Ci(t,c,n,r,Ms(l.breadthIntersection[0],l.breadthIntersection[1],s[0],s[1]));i.push(...u)}}),i}function fU(t){t.sort((o,n)=>n.gaps.length-o.gaps.length);for(let o=t.length-1;o>0;o--){const n=t[o];for(let r=o-1;r>=0;r--){const s=t[r];if(s.direction===n.direction&&n.gaps.every(i=>s.gaps.some(a=>kt(i.startEdge[0].x)===kt(a.startEdge[0].x)&&kt(i.startEdge[0].y)===kt(a.startEdge[0].y)&&kt(i.startEdge[1].x)===kt(a.startEdge[1].x)&&kt(i.startEdge[1].y)===kt(a.startEdge[1].y))&&s.gaps.some(a=>kt(i.endEdge[0].x)===kt(a.endEdge[0].x)&&kt(i.endEdge[0].y)===kt(a.endEdge[0].y)&&kt(i.endEdge[1].x)===kt(a.endEdge[1].x)&&kt(i.endEdge[1].y)===kt(a.endEdge[1].y)))){t.splice(o,1);break}}}}class Hh{constructor(o){D(this,"editor");this.manager=o,this.editor=o.editor}getSnapPointsCache(){const{editor:o}=this;return o.store.createComputedCache("snapPoints",n=>{const r=o.getShapePageTransform(n.id);if(!r)return;const i=o.getShapeUtil(n).getBoundsSnapGeometry(n).points??o.getShapeGeometry(n).bounds.cornersAndCenter;if(!(!r||!i))return i.map((a,l)=>{const{x:c,y:u}=vt.applyToPoint(r,a);return{x:c,y:u,id:`${n.id}:${l}`}})})}getSnapPoints(o){return this.getSnapPointsCache().get(o)??[]}getSnappablePoints(){const o=this.getSnapPointsCache(),n=this.manager.getSnappableShapes(),r=[];for(const s of n){const i=o.get(s);i&&r.push(...i)}return r}getSnappableGapNodes(){return Array.from(this.manager.getSnappableShapes(),o=>({id:o,pageBounds:El(this.editor.getShapePageBounds(o))}))}getVisibleGaps(){const o=[],n=[];let r,s;const i=this.getSnappableGapNodes().sort((l,c)=>l.pageBounds.minX-c.pageBounds.minX);for(let l=0;l<i.length;l++){r=i[l];for(let c=l+1;c<i.length;c++)s=i[c],r.pageBounds.maxX<s.pageBounds.minX&&id(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)&&o.push({startNode:r,endNode:s,startEdge:[new Y(r.pageBounds.maxX,r.pageBounds.minY),new Y(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new Y(s.pageBounds.minX,s.pageBounds.minY),new Y(s.pageBounds.minX,s.pageBounds.maxY)],length:s.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:Ms(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)})}const a=i.sort((l,c)=>l.pageBounds.minY-c.pageBounds.minY);for(let l=0;l<a.length;l++){r=a[l];for(let c=l+1;c<a.length;c++)s=a[c],r.pageBounds.maxY<s.pageBounds.minY&&id(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)&&n.push({startNode:r,endNode:s,startEdge:[new Y(r.pageBounds.minX,r.pageBounds.maxY),new Y(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new Y(s.pageBounds.minX,s.pageBounds.minY),new Y(s.pageBounds.maxX,s.pageBounds.minY)],length:s.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:Ms(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)})}return{horizontal:o,vertical:n}}snapTranslateShapes({lockedAxis:o,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:s}){var b,y;const i=this.manager.getSnapThreshold(),a=this.getSnappablePoints(),l=n.clone().translate(s),c=r.map(({x:v,y:x},S)=>({id:"selection:"+S,x:v+s.x,y:x+s.y})),u=a,f=[],h=[],d=new Y(i,i);this.collectPointSnaps({minOffset:d,nearestSnapsX:f,nearestSnapsY:h,otherNodeSnapPoints:u,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h,minOffset:d});const p=new Y(o==="x"?0:((b=f[0])==null?void 0:b.nudge)??0,o==="y"?0:((y=h[0])==null?void 0:y.nudge)??0);d.x=0,d.y=0,f.length=0,h.length=0,c.forEach(v=>{v.x+=p.x,v.y+=p.y}),l.translate(p),this.collectPointSnaps({minOffset:d,nearestSnapsX:f,nearestSnapsY:h,otherNodeSnapPoints:u,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h,minOffset:d});const m=this.getPointSnapLines({nearestSnapsX:f,nearestSnapsY:h}),g=this.getGapSnapLines({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h});return this.manager.setIndicators([...g,...m]),{nudge:p}}snapResizeShapes({initialSelectionPageBounds:o,dragDelta:n,handle:r,isAspectRatioLocked:s,isResizingFromCenter:i}){var j,P;const a=this.manager.getSnapThreshold(),{box:l,scaleX:c,scaleY:u}=mt.Resize(o,r,i?n.x*2:n.x,i?n.y*2:n.y,s);let f=r;c<0&&(f=O8(f)),u<0&&(f=M8(f)),i&&(l.center=o.center);const h=f==="top"||f==="bottom",d=f==="left"||f==="right",p=X2(f,l),m=this.getSnappablePoints(),g=[],b=[],y=new Y(a,a);this.collectPointSnaps({minOffset:y,nearestSnapsX:g,nearestSnapsY:b,otherNodeSnapPoints:m,selectionSnapPoints:p});const v=new Y(h?0:((j=g[0])==null?void 0:j.nudge)??0,d?0:((P=b[0])==null?void 0:P.nudge)??0);if(s&&A8(f)&&v.len()!==0){const M=g.length&&b.length?Math.abs(v.x)<Math.abs(v.y)?"x":"y":g.length?"x":"y",O=o.aspectRatio;M==="x"?(b.length=0,v.y=v.x/O,(f==="bottom_left"||f==="top_right")&&(v.y=-v.y)):(g.length=0,v.x=v.y*O,(f==="bottom_left"||f==="top_right")&&(v.x=-v.x))}const x=Y.Add(n,v),{box:S}=mt.Resize(o,r,i?x.x*2:x.x,i?x.y*2:x.y,s);i&&(S.center=o.center);const w=X2("any",S);g.length=0,b.length=0,y.x=0,y.y=0,this.collectPointSnaps({minOffset:y,nearestSnapsX:g,nearestSnapsY:b,otherNodeSnapPoints:m,selectionSnapPoints:w});const E=this.getPointSnapLines({nearestSnapsX:g,nearestSnapsY:b});return this.manager.setIndicators([...E]),{nudge:v}}collectPointSnaps({selectionSnapPoints:o,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:s,nearestSnapsY:i}){for(const a of o)for(const l of n){const c=Y.Sub(a,l),u=Math.abs(c.x),f=Math.abs(c.y);kt(u)<=kt(r.x)&&(kt(u)<kt(r.x)&&(s.length=0),s.push({type:"points",points:{thisPoint:a,otherPoint:l},nudge:l.x-a.x}),r.x=u),kt(f)<=kt(r.y)&&(kt(f)<kt(r.y)&&(i.length=0),i.push({type:"points",points:{thisPoint:a,otherPoint:l},nudge:l.y-a.y}),r.y=f)}}collectGapSnaps({selectionPageBounds:o,minOffset:n,nearestSnapsX:r,nearestSnapsY:s}){const{horizontal:i,vertical:a}=this.getVisibleGaps();for(const l of i){if(!id(l.breadthIntersection[0],l.breadthIntersection[1],o.minY,o.maxY))continue;const u=l.startEdge[0].x+l.length/2-o.center.x;if(l.length>o.width&&kt(Math.abs(u))<=kt(n.x)){kt(Math.abs(u))<kt(n.x)&&(r.length=0),n.x=Math.abs(u);const y={type:"gap_center",gap:l,nudge:u},v=r.find(({type:S})=>S==="gap_center"),x=v&&Ms(l.breadthIntersection[0],l.breadthIntersection[1],v.gap.breadthIntersection[0],v.gap.breadthIntersection[1]);v&&v.gap.length>l.length&&x?r[r.indexOf(v)]=y:(!v||!x)&&r.push(y)}const h=l.startNode.pageBounds.minX-l.length,d=o.maxX,p=h-d;kt(Math.abs(p))<=kt(n.x)&&(kt(Math.abs(p))<kt(n.x)&&(r.length=0),n.x=Math.abs(p),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"left",nudge:p}));const m=l.endNode.pageBounds.maxX+l.length,g=o.minX,b=m-g;kt(Math.abs(b))<=kt(n.x)&&(kt(Math.abs(b))<kt(n.x)&&(r.length=0),n.x=Math.abs(b),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"right",nudge:b}))}for(const l of a){if(!id(l.breadthIntersection[0],l.breadthIntersection[1],o.minX,o.maxX))continue;const u=l.startEdge[0].y+l.length/2-o.center.y;if(l.length>o.height&&kt(Math.abs(u))<=kt(n.y)){kt(Math.abs(u))<kt(n.y)&&(s.length=0),n.y=Math.abs(u);const y={type:"gap_center",gap:l,nudge:u},v=s.find(({type:S})=>S==="gap_center"),x=v&&id(v.gap.breadthIntersection[0],v.gap.breadthIntersection[1],l.breadthIntersection[0],l.breadthIntersection[1]);v&&v.gap.length>l.length&&x?s[s.indexOf(v)]=y:(!v||!x)&&s.push(y);continue}const h=l.startNode.pageBounds.minY-l.length,d=o.maxY,p=h-d;kt(Math.abs(p))<=kt(n.y)&&(kt(Math.abs(p))<kt(n.y)&&(s.length=0),n.y=Math.abs(p),s.push({type:"gap_duplicate",gap:l,protrusionDirection:"top",nudge:p}));const m=l.endNode.pageBounds.maxY+l.length,g=o.minY,b=m-g;kt(Math.abs(b))<=kt(n.y)&&(kt(Math.abs(b))<kt(n.y)&&(s.length=0),n.y=Math.abs(b),s.push({type:"gap_duplicate",gap:l,protrusionDirection:"bottom",nudge:b}))}}getPointSnapLines({nearestSnapsX:o,nearestSnapsY:n}){const r={},s={};if(o.length>0){for(const i of o)if(i.type==="points"){const a=kt(i.points.otherPoint.x);r[a]||(r[a]=[]),r[a].push(i.points)}}if(n.length>0){for(const i of n)if(i.type==="points"){const a=kt(i.points.otherPoint.y);s[a]||(s[a]=[]),s[a].push(i.points)}}return Object.values(r).concat(Object.values(s)).map(i=>({id:Mr(),type:"points",points:Ym(i.map(a=>Y.From(a.otherPoint)).concat(i.map(a=>Y.From(a.thisPoint))),(a,l)=>a.equals(l))}))}getGapSnapLines({selectionPageBounds:o,nearestSnapsX:n,nearestSnapsY:r}){const{vertical:s,horizontal:i}=this.getVisibleGaps(),a={top:o.sides[0],right:o.sides[1],bottom:[o.corners[3],o.corners[2]],left:[o.corners[0],o.corners[3]]},l=[];if(n.length>0)for(const c of n){if(c.type==="points")continue;const{gap:{breadthIntersection:u,startEdge:f,startNode:h,endNode:d,length:p,endEdge:m}}=c;switch(c.type){case"gap_center":{const g=(p-o.width)/2,b=Ms(u[0],u[1],o.minY,o.maxY);l.push({type:"gaps",direction:"horizontal",id:Mr(),gaps:[...Ci(i,h.id,g,"backward",b),{startEdge:f,endEdge:a.left},{startEdge:a.right,endEdge:m},...Ci(i,d.id,g,"forward",b)]});break}case"gap_duplicate":{const g=Ms(u[0],u[1],o.minY,o.maxY);l.push({type:"gaps",direction:"horizontal",id:Mr(),gaps:c.protrusionDirection==="left"?[{startEdge:a.right,endEdge:f.map(b=>b.clone().addXY(-h.pageBounds.width,0))},{startEdge:f,endEdge:m},...Ci(i,d.id,p,"forward",g)]:[...Ci(i,h.id,p,"backward",g),{startEdge:f,endEdge:m},{startEdge:m.map(b=>b.clone().addXY(c.gap.endNode.pageBounds.width,0)),endEdge:a.left}]});break}}}if(r.length>0)for(const c of r){if(c.type==="points")continue;const{gap:{breadthIntersection:u,startEdge:f,startNode:h,endNode:d,length:p,endEdge:m}}=c;switch(c.type){case"gap_center":{const g=(p-o.height)/2,b=Ms(u[0],u[1],o.minX,o.maxX);l.push({type:"gaps",direction:"vertical",id:Mr(),gaps:[...Ci(s,h.id,g,"backward",b),{startEdge:f,endEdge:a.top},{startEdge:a.bottom,endEdge:m},...Ci(s,c.gap.endNode.id,g,"forward",b)]});break}case"gap_duplicate":{const g=Ms(u[0],u[1],o.minX,o.maxX);l.push({type:"gaps",direction:"vertical",id:Mr(),gaps:c.protrusionDirection==="top"?[{startEdge:a.bottom,endEdge:f.map(b=>b.clone().addXY(0,-h.pageBounds.height))},{startEdge:f,endEdge:m},...Ci(s,d.id,p,"forward",g)]:[...Ci(s,h.id,p,"backward",g),{startEdge:f,endEdge:m},{startEdge:m.map(b=>b.clone().addXY(0,d.pageBounds.height)),endEdge:a.top}]})}break}}return fU(l),l}}ny([Xe],Hh.prototype,"getSnapPointsCache",1);ny([Xe],Hh.prototype,"getSnappablePoints",1);ny([Xe],Hh.prototype,"getSnappableGapNodes",1);ny([Xe],Hh.prototype,"getVisibleGaps",1);function X2(t,o){const{minX:n,maxX:r,minY:s,maxY:i}=o,a=[];switch(t){case"top":case"left":case"top_left":case"any":a.push({id:"top_left",handle:"top_left",x:n,y:s})}switch(t){case"top":case"right":case"top_right":case"any":a.push({id:"top_right",handle:"top_right",x:r,y:s})}switch(t){case"bottom":case"right":case"bottom_right":case"any":a.push({id:"bottom_right",handle:"bottom_right",x:r,y:i})}switch(t){case"bottom":case"left":case"bottom_left":case"any":a.push({id:"bottom_left",handle:"bottom_left",x:n,y:i})}return a}var pU=Object.defineProperty,mU=Object.getOwnPropertyDescriptor,gU=(t,o,n,r)=>{for(var s=r>1?void 0:r?mU(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&pU(o,n,s),s};const yU=()=>null,vU=()=>[];class LI{constructor(o){D(this,"editor");this.manager=o,this.editor=o.editor}getSnapGeometryCache(){const{editor:o}=this;return o.store.createComputedCache("handle snap geometry",n=>{const r=o.getShapeUtil(n).getHandleSnapGeometry(n);return{outline:r.outline===void 0?o.getShapeGeometry(n):r.outline,points:r.points??[],getSelfSnapOutline:r.getSelfSnapOutline??yU,getSelfSnapPoints:r.getSelfSnapPoints??vU}})}*iterateSnapPointsInPageSpace(o,n){var s,i;const r=(s=this.getSnapGeometryCache().get(o))==null?void 0:s.getSelfSnapPoints(n);if(r&&r.length){const a=El(this.editor.getShapePageTransform(o));for(const l of r)yield a.applyToPoint(l)}for(const a of this.manager.getSnappableShapes()){if(a===o)continue;const l=(i=this.getSnapGeometryCache().get(a))==null?void 0:i.points;if(!l||!l.length)continue;const c=El(this.editor.getShapePageTransform(a));for(const u of l)yield c.applyToPoint(u)}}*iterateSnapOutlines(o,n){var s,i;const r=(s=this.getSnapGeometryCache().get(o))==null?void 0:s.getSelfSnapOutline(n);r&&(yield{shapeId:o,outline:r});for(const a of this.manager.getSnappableShapes()){if(a===o)continue;const l=(i=this.getSnapGeometryCache().get(a))==null?void 0:i.outline;l&&(yield{shapeId:a,outline:l})}}getHandleSnapPosition({currentShapeId:o,handle:n,handleInPageSpace:r}){const s=this.manager.getSnapThreshold();let i=s,a=null;for(const u of this.iterateSnapPointsInPageSpace(o,n))Y.DistMin(r,u,i)&&(i=Y.Dist(r,u),a=u);if(a)return a;let l=s,c=null;for(const{shapeId:u,outline:f}of this.iterateSnapOutlines(o,n)){const h=El(this.editor.getShapePageTransform(u)),d=this.editor.getPointInShapeSpace(u,r),p=f.nearestPoint(d),m=h.applyToPoint(p);Y.DistMin(r,m,l)&&(l=Y.Dist(r,m),c=m)}return c||null}snapHandle({currentShapeId:o,handle:n}){const s=El(this.editor.getShapePageTransform(o)).applyToPoint(n),i=this.getHandleSnapPosition({currentShapeId:o,handle:n,handleInPageSpace:s});return i?(this.manager.setIndicators([{id:Mr(),type:"points",points:[i]}]),{nudge:Y.Sub(i,s)}):null}}gU([Xe],LI.prototype,"getSnapGeometryCache",1);var bU=Object.defineProperty,xU=Object.getOwnPropertyDescriptor,bS=(t,o,n,r)=>{for(var s=r>1?void 0:r?xU(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&bU(o,n,s),s};class oy{constructor(o){D(this,"shapeBounds");D(this,"handles");D(this,"_snapIndicators",po("snapLines",void 0));this.editor=o,this.shapeBounds=new Hh(this),this.handles=new LI(this)}getIndicators(){return this._snapIndicators.get()??Di}clearIndicators(){this.getIndicators().length&&this._snapIndicators.set(void 0)}setIndicators(o){this._snapIndicators.set(o)}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:o}=this,n=o.getRenderingBounds(),r=o.getSelectedShapeIds(),s=new Set,i=a=>{if(Vo(a)){const c=o.getShape(a);c&&o.isShapeOfType(c,"frame")&&s.add(a)}const l=o.getSortedChildIdsForParent(a);for(const c of l){if(r.includes(c))continue;const u=o.getShape(c);if(!u||!o.getShapeUtil(u).canSnap(u))continue;const h=o.getShapePageBounds(c);if(h&&n.includes(h)){if(o.isShapeOfType(u,"group")){i(c);continue}s.add(c)}}};return i(this.getCurrentCommonAncestor()??o.getCurrentPageId()),s}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}}bS([Xe],oy.prototype,"getSnapThreshold",1);bS([Xe],oy.prototype,"getSnappableShapes",1);bS([Xe],oy.prototype,"getCurrentCommonAncestor",1);const SU=/\r?\n|\r/g;function q2(t){return t.replace(SU,`
`).split(`
`).map(o=>o||" ").join(`
`)}const wU={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},_U=/\s/;class jU{constructor(o){D(this,"baseElm");D(this,"measureText",(o,n)=>{var a;const r=(a=this.baseElm)==null?void 0:a.cloneNode();this.baseElm.insertAdjacentElement("afterend",r),r.setAttribute("dir","ltr"),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-style",n.fontStyle),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("font-size",n.fontSize+"px"),r.style.setProperty("line-height",n.lineHeight*n.fontSize+"px"),r.style.setProperty("max-width",n.maxWidth===null?null:n.maxWidth+"px"),r.style.setProperty("min-width",n.minWidth===null?null:n.minWidth+"px"),r.style.setProperty("padding",n.padding),r.style.setProperty("overflow-wrap",n.disableOverflowWrapBreaking?"normal":"break-word"),r.textContent=q2(o);const s=r.scrollWidth,i=r.getBoundingClientRect();return r.remove(),{x:0,y:0,w:i.width,h:i.height,scrollWidth:s}});var s;this.editor=o;const n=this.editor.getContainer();(s=n.querySelector("#tldraw_text_measure"))==null||s.remove();const r=document.createElement("div");r.id="tldraw_text_measure",r.classList.add("tl-text"),r.classList.add("tl-text-measure"),r.tabIndex=-1,n.appendChild(r),this.baseElm=r}measureElementTextNodeSpans(o,{shouldTruncateToFirstLine:n=!1}={}){const r=[],s=o.getBoundingClientRect(),i=-s.left,a=-s.top,l=new Range,c=o.childNodes[0];let u=0,f=null,h=null,d=0,p=!1;for(const m of o.childNodes)if(m.nodeType===Node.TEXT_NODE)for(const g of m.textContent??""){l.setStart(c,u),l.setEnd(c,u+g.length);const b=l.getClientRects(),y=b[b.length-1],v=y.top+a,x=y.left+i,S=y.right+i,w=_U.test(g);if(w!==h||v!==d||!f){if(f){if(n&&v!==d){p=!0;break}r.push(f)}f={box:{x,y:v,w:y.width,h:y.height},text:g}}else f.box.w=S-f.box.x,f.text+=g;h=w,d=v,u+=g.length}return f&&r.push(f),{spans:r,didTruncate:p}}measureTextSpans(o,n){var u;if(o==="")return[];const r=(u=this.baseElm)==null?void 0:u.cloneNode();this.baseElm.insertAdjacentElement("afterend",r);const s=Math.ceil(n.width-n.padding*2);r.style.setProperty("width",`${s}px`),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size",`${n.fontSize}px`),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("line-height",`${n.lineHeight*n.fontSize}px`),r.style.setProperty("text-align",wU[n.textAlign]);const i=n.overflow==="truncate-ellipsis"||n.overflow==="truncate-clip";i&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all"));const a=q2(o);r.textContent=a;const{spans:l,didTruncate:c}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:i});if(n.overflow==="truncate-ellipsis"&&c){r.textContent="…";const f=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${s-f}px`),r.textContent=a;const h=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,d=h[h.length-1];return h.push({text:"…",box:{x:Math.min(d.box.x+d.box.w,n.width-n.padding-f),y:d.box.y,w:f,h:d.box.h}}),h}return r.remove(),l}}const K2=(typeof process<"u",JT);class EU{constructor(o){D(this,"cancelRaf");D(this,"isPaused",!0);D(this,"now",0);D(this,"start",()=>{var o;this.isPaused=!1,(o=this.cancelRaf)==null||o.call(this),this.cancelRaf=K2(this.tick),this.now=Date.now()});D(this,"tick",()=>{if(this.isPaused)return;const o=Date.now(),n=o-this.now;this.now=o,this.updatePointerVelocity(n),this.editor.emit("frame",n),this.editor.emit("tick",n),this.cancelRaf=K2(this.tick)});D(this,"dispose",()=>{var o;this.isPaused=!0,(o=this.cancelRaf)==null||o.call(this)});D(this,"prevPoint",new Y);D(this,"updatePointerVelocity",o=>{const{prevPoint:n,editor:{inputs:{currentScreenPoint:r,pointerVelocity:s}}}=this;if(o===0)return;const i=Y.Sub(r,n);this.prevPoint=r.clone();const a=i.len(),l=a?i.div(a):new Y(0,0),c=s.clone().lrp(l.mul(a/o),.5);Math.abs(c.x)<.01&&(c.x=0),Math.abs(c.y)<.01&&(c.y=0),s.equals(c)||(this.editor.inputs.pointerVelocity=c)});this.editor=o,this.editor.disposables.add(this.dispose),this.start()}}var CU=Object.defineProperty,PU=Object.getOwnPropertyDescriptor,mi=(t,o,n,r)=>{for(var s=r>1?void 0:r?PU(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&CU(o,n,s),s};class Hs{constructor(o,n){D(this,"updateUserPreferences",o=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...o})});this.user=o,this.inferDarkMode=n}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode(),isDarkMode:this.getIsDarkMode(),isWrapMode:this.getIsWrapMode()}}getIsDarkMode(){return this.user.userPreferences.get().isDarkMode??(this.inferDarkMode?I$():!1)}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??ml.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??ml.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??ml.name}getLocale(){return this.user.userPreferences.get().locale??ml.locale}getColor(){return this.user.userPreferences.get().color??ml.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??ml.isSnapMode}getIsWrapMode(){return this.user.userPreferences.get().isWrapMode??ml.isWrapMode}}mi([Xe],Hs.prototype,"getUserPreferences",1);mi([Xe],Hs.prototype,"getIsDarkMode",1);mi([Xe],Hs.prototype,"getEdgeScrollSpeed",1);mi([Xe],Hs.prototype,"getAnimationSpeed",1);mi([Xe],Hs.prototype,"getId",1);mi([Xe],Hs.prototype,"getName",1);mi([Xe],Hs.prototype,"getLocale",1);mi([Xe],Hs.prototype,"getColor",1);mi([Xe],Hs.prototype,"getIsSnapMode",1);mi([Xe],Hs.prototype,"getIsWrapMode",1);function ld(t){return Math.abs(t.props.bend)<8}function pg(t,o){if(o.type==="point")return;const n=t.getShape(o.boundShapeId),r=t.getShapePageTransform(n),s=t.getShapeGeometry(n),i=s instanceof Vs?s.children[0].vertices:s.vertices;return{shape:n,transform:r,isClosed:s.isClosed,isExact:o.isExact,didIntersect:!1,outline:i}}function Z2(t,o,n,r){if(n.type==="point")return Y.From(n);const s=t.getShape(n.boundShapeId);if(s){const{point:i,size:a}=t.getShapeGeometry(s).bounds,l=Y.Add(i,Y.MulV(n.isPrecise||r?n.normalizedAnchor:{x:.5,y:.5},a)),c=vt.applyToPoint(t.getShapePageTransform(s),l);return vt.applyToPoint(vt.Inverse(o),c)}else return new Y(0,0)}function Ls(t,o){const n=t.getShapePageTransform(o);let r,s;o.props.start.type==="binding"&&o.props.end.type==="binding"&&(r=o.props.start.boundShapeId,s=o.props.end.boundShapeId);const i=xS(t,r,s),a=Z2(t,n,o.props.start,i==="double-bound"||i==="start-contains-end"),l=Z2(t,n,o.props.end,i==="double-bound"||i==="end-contains-start");return{start:a,end:l}}const Gc=10,mg=10,TU=10,Pa={s:2,m:3.5,l:5,xl:10};function xS(t,o,n){if(!o||!n)return"safe";if(o===n)return"double-bound";const r=t.getShapePageBounds(o),s=t.getShapePageBounds(n);if(r&&s){if(r.contains(s))return"start-contains-end";if(s.contains(r))return"end-contains-start"}return"safe"}function zd(t,o){const{start:n,end:r,arrowheadStart:s,arrowheadEnd:i}=o.props,a=Ls(t,o),l=a.start.clone(),c=a.end.clone(),u=Y.Med(l,c);if(Y.Equals(l,c))return{isStraight:!0,start:{handle:l,point:l,arrowhead:o.props.arrowheadStart},end:{handle:c,point:c,arrowhead:o.props.arrowheadEnd},middle:u,isValid:!1,length:0};const f=Y.Sub(c,l).uni(),h=pg(t,n),d=pg(t,r),p=t.getShapePageTransform(o);Q2(c,a.start,p,d),Q2(l,a.end,p,h);let m=0,g=0,b=0,y=0,v=Gc;const x=h&&d&&h.shape===d.shape,S=h&&d?xS(t,h.shape.id,d.shape.id):"safe";S==="safe"&&h&&d&&!x&&!h.isExact&&!d.isExact&&(d.didIntersect&&!h.didIntersect?h.isClosed&&l.setTo(c.clone().add(f.clone().mul(Gc))):d.didIntersect||d.isClosed&&c.setTo(l.clone().sub(f.clone().mul(Gc))));const w=Y.Sub(c,l),E=Y.Len(w)?w.uni():Y.From(w),j=!Y.Equals(E,f);x||(S!=="start-contains-end"&&h&&s!=="none"&&!h.isExact&&(b=Pa[o.props.size]/2+("size"in h.shape.props?Pa[h.shape.props.size]/2:0),m=mg+b,v+=b),S!=="end-contains-start"&&d&&i!=="none"&&!d.isExact&&(y=Pa[o.props.size]/2+("size"in d.shape.props?Pa[d.shape.props.size]/2:0),g=mg+y,v+=y));const P=l.clone().add(E.clone().mul(m*(j?-1:1))),M=c.clone().sub(E.clone().mul(g*(j?-1:1)));Y.DistMin(P,M,v)&&(m!==0&&g!==0?(m*=-1.5,g*=-1.5):m!==0?m*=-1:g!==0&&(g*=-1)),l.add(E.clone().mul(m*(j?-1:1))),c.sub(E.clone().mul(g*(j?-1:1))),j?(h&&d&&c.setTo(Y.Add(l,E.clone().mul(-Gc))),u.setTo(Y.Med(a.start,a.end))):u.setTo(Y.Med(l,c));const O=Y.Dist(l,c);return{isStraight:!0,start:{handle:a.start,point:l,arrowhead:o.props.arrowheadStart},end:{handle:a.end,point:c,arrowhead:o.props.arrowheadEnd},middle:u,isValid:O>0,length:O}}function Q2(t,o,n,r){if(r===void 0||r.isExact)return;const s=vt.applyToPoint(n,o),i=vt.applyToPoint(n,t),a=vt.applyToPoint(vt.Inverse(r.transform),s),l=vt.applyToPoint(vt.Inverse(r.transform),i),c=r.isClosed,f=(c?gS:N$)(a,l,r.outline);let h;if(f!==null&&(h=f.sort((m,g)=>Y.Dist2(m,a)-Y.Dist2(g,a))[0]??(c?void 0:l)),h===void 0)return;const d=vt.applyToPoint(r.transform,h),p=vt.applyToPoint(vt.Inverse(n),d);t.setTo(p),r.didIntersect=!0}function D0(t,o,n=0){const{arrowheadEnd:r,arrowheadStart:s}=o.props,i=o.props.bend+n;if(Math.abs(i)>Math.abs(o.props.bend*TU))return zd(t,o);const a=Ls(t,o),l=Y.Med(a.start,a.end),c=Y.Sub(a.end,a.start),u=Y.Len(c)?c.uni():Y.From(c),f=Y.Add(l,u.per().mul(-i)),h=pg(t,o.props.start),d=pg(t,o.props.end),p=a.start.clone(),m=a.end.clone(),g=f.clone();if(Y.Equals(p,m))return{isStraight:!0,start:{handle:p,point:p,arrowhead:o.props.arrowheadStart},end:{handle:m,point:m,arrowhead:o.props.arrowheadEnd},middle:g,isValid:!1,length:0};const b=o.props.bend<0,y=b?Uh:Vk,v=J2(p,m,g),x=Y.Angle(v.center,p),S=Y.Angle(v.center,m),w=y(x,S);if(v.length===0||v.size===0||!b2(v.length)||!b2(v.size))return zd(t,o);const E=p.clone(),j=m.clone(),P=g.clone(),M=t.getShapePageTransform(o);let O=0,k=0,F=Gc;if(h&&!h.isExact){const q=vt.applyToPoint(M,E),J=vt.applyToPoint(M,v.center),ae=vt.applyToPoint(M,j),I=vt.Inverse(h.transform),U=vt.applyToPoint(I,q),z=vt.applyToPoint(I,J),K=vt.applyToPoint(I,ae),{isClosed:te}=h,ne=te?n1:G2;let le,me=ne(z,v.radius,h.outline);if(me){const ce=z.angle(U),ge=z.angle(K),pe=y(ce,ge);me=me.filter(de=>y(ce,z.angle(de))<=pe);const oe=pe*.25;me.sort(te?(de,xe)=>Math.abs(y(ce,z.angle(de))-oe)<Math.abs(y(ce,z.angle(xe))-oe)?-1:1:(de,xe)=>y(ce,z.angle(de))<y(ce,z.angle(xe))?-1:1),le=me[0]??(te?void 0:U)}else le=te?void 0:U;if(le&&(E.setTo(t.getPointInShapeSpace(o,vt.applyToPoint(h.transform,le))),h.didIntersect=!0,s!=="none")){const ce=Pa[o.props.size]/2+("size"in h.shape.props?Pa[h.shape.props.size]/2:0);O=mg+ce,F+=ce}}if(d&&!d.isExact){const q=vt.applyToPoint(M,E),J=vt.applyToPoint(M,j),ae=vt.applyToPoint(M,v.center),I=vt.Inverse(d.transform),U=vt.applyToPoint(I,q),z=vt.applyToPoint(I,ae),K=vt.applyToPoint(I,J),te=d.isClosed,ne=te?n1:G2;let le,me=ne(z,v.radius,d.outline);if(me){const ce=z.angle(U),ge=z.angle(K),pe=y(ce,ge),oe=pe*.75;me=me.filter(de=>y(ce,z.angle(de))<=pe),me.sort(te?(de,xe)=>Math.abs(y(ce,z.angle(de))-oe)<Math.abs(y(ce,z.angle(xe))-oe)?-1:1:(de,xe)=>y(ce,z.angle(de))<y(ce,z.angle(xe))?-1:1),me[0]?le=me[0]:le=te?void 0:K}else le=te?void 0:K;if(le&&(j.setTo(t.getPointInShapeSpace(o,vt.applyToPoint(d.transform,le))),d.didIntersect=!0,r!=="none")){const ce=Pa[o.props.size]/2+("size"in d.shape.props?Pa[d.shape.props.size]/2:0);k=mg+ce,F+=ce}}let A=Y.Angle(v.center,E),N=Y.Angle(v.center,j),$=y(A,N),G=$*v.radius;const X=E.clone(),W=j.clone();if(O!==0){const q=O/G*(b?1:-1),J=Y.FromAngle(A+$*q);X.setTo(v.center).add(J.mul(v.radius))}if(k!==0){const q=k/G*(b?-1:1),J=Y.FromAngle(N+$*q);W.setTo(v.center).add(J.mul(v.radius))}if(Y.DistMin(X,W,F)&&(O!==0&&k!==0?(O*=-1.5,k*=-1.5):O!==0?O*=-2:k!==0&&(k*=-2)),O!==0){const q=O/G*(b?1:-1),J=Y.FromAngle(A+$*q);E.setTo(v.center).add(J.mul(v.radius))}if(k!==0){const q=k/G*(b?-1:1),J=Y.FromAngle(N+$*q);j.setTo(v.center).add(J.mul(v.radius))}if(h&&d&&!h.isExact&&!d.isExact){A=Y.Angle(v.center,E),N=Y.Angle(v.center,j),$=y(A,N),G=$*v.radius;const q=xS(t,h.shape.id,d.shape.id);if(q==="double-bound"&&G<30)E.setTo(p),j.setTo(m),P.setTo(g);else if(q==="safe"&&(h&&!h.didIntersect&&E.setTo(p),d&&!d.didIntersect||y(x,A)>y(x,N))){const J=Math.min(.9,Gc/G)*(b?1:-1),ae=Y.FromAngle(A+$*J);j.setTo(v.center).add(ae.mul(v.radius))}}kU(v.center,v.radius,E,j,P,w,b),E.equals(j)&&(E.setTo(P.clone().addXY(1,1)),j.setTo(P.clone().subXY(1,1))),p.setTo(E),m.setTo(j),g.setTo(P);const V=J2(p,m,g);return{isStraight:!1,start:{point:p,handle:a.start,arrowhead:o.props.arrowheadStart},end:{point:m,handle:a.end,arrowhead:o.props.arrowheadEnd},middle:g,handleArc:v,bodyArc:V,isValid:V.length!==0&&isFinite(V.center.x)&&isFinite(V.center.y)}}function J2(t,o,n){const r=-2*(t.x*(o.y-n.y)-t.y*(o.x-n.x)+o.x*n.y-n.x*o.y),s={x:((t.x*t.x+t.y*t.y)*(n.y-o.y)+(o.x*o.x+o.y*o.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(o.y-t.y))/r,y:((t.x*t.x+t.y*t.y)*(o.x-n.x)+(o.x*o.x+o.y*o.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-o.x))/r},i=Y.Dist(s,t),a=+Y.Clockwise(t,n,o),l=((t.y-o.y)**2+(t.x-o.x)**2)**.5,c=((o.y-n.y)**2+(o.x-n.x)**2)**.5,u=((n.y-t.y)**2+(n.x-t.x)**2)**.5,f=Math.acos((c*c+u*u-l*l)/(2*c*u))*2,h=+(Yt>f),d=(or-f)*(a?1:-1),p=d*i;return{center:s,radius:i,size:d,length:p,largeArcFlag:h,sweepFlag:a}}function kU(t,o,n,r,s,i,a){const l=Y.Angle(t,n),c=Y.Angle(t,r);let u=Uh(l,c);a||(u=or-u);const f=.5*(a?1:-1),h=Y.FromAngle(l+u*f);if(s.setTo(t).add(h.mul(o)),u>i){s.rotWith(t,Yt);const d=r.clone();r.setTo(n),n.setTo(d)}}const IU={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",long_press:"onLongPress",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick",tick:"onTick"};class bt{constructor(o,n){D(this,"id");D(this,"type");D(this,"shapeType");D(this,"initial");D(this,"children");D(this,"parent");D(this,"_path");D(this,"_current");D(this,"_isActive");D(this,"transition",(o,n={})=>{var i;const r=o.split(".");let s=this;for(let a=0;a<r.length;a++){const l=r[a],c=s.getCurrent(),u=(i=s.children)==null?void 0:i[l];if(!u)throw Error(`${s.id} - no child state exists with the id ${l}.`);if((c==null?void 0:c.id)!==u.id&&(c==null||c.exit(n,l),s._current.set(u),u.enter(n,(c==null?void 0:c.id)||"initial"),!u.getIsActive()))break;s=u}return this});D(this,"handleEvent",o=>{var s;const n=IU[o.name],r=this._current.__unsafe__getWithoutCapture();(s=this[n])==null||s.call(this,o),this._isActive.__unsafe__getWithoutCapture()&&r&&r===this._current.__unsafe__getWithoutCapture()&&r.handleEvent(o)});D(this,"enter",(o,n)=>{var r;if(this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,o,n),this.children&&this.initial&&this.getIsActive()){const s=this.children[this.initial];this._current.set(s),s.enter(o,n)}});D(this,"exit",(o,n)=>{var r,s;this._isActive.set(!1),(r=this.onExit)==null||r.call(this,o,n),this.getIsActive()||(s=this.getCurrent())==null||s.exit(o,n)});D(this,"_currentToolIdMask",po("curent tool id mask",void 0));D(this,"onWheel");D(this,"onPointerDown");D(this,"onPointerMove");D(this,"onLongPress");D(this,"onPointerUp");D(this,"onDoubleClick");D(this,"onTripleClick");D(this,"onQuadrupleClick");D(this,"onRightClick");D(this,"onMiddleClick");D(this,"onKeyDown");D(this,"onKeyUp");D(this,"onKeyRepeat");D(this,"onCancel");D(this,"onComplete");D(this,"onInterrupt");D(this,"onTick");D(this,"onEnter");D(this,"onExit");this.editor=o;const{id:r,children:s,initial:i}=this.constructor;this.id=r,this._isActive=po("toolIsActive"+this.id,!1),this._current=po("toolState"+this.id,void 0),this._path=Xe("toolPath"+this.id,()=>{const a=this.getCurrent();return this.id+(a?`.${a.getPath()}`:"")}),this.parent=n??{},this.parent?s&&i?(this.type="branch",this.initial=i,this.children=Object.fromEntries(s().map(a=>[a.id,new a(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",s&&i&&(this.initial=i,this.children=Object.fromEntries(s().map(a=>[a.id,new a(this.editor,this)])),this._current.set(this.children[this.initial])))}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(o){this._currentToolIdMask.set(o)}}D(bt,"id"),D(bt,"initial"),D(bt,"children");class Np extends bt{constructor(){super(...arguments);D(this,"onKeyDown",n=>{var r;switch(n.code){case"KeyZ":{if(!(n.shiftKey||n.ctrlKey)){const s=this.getCurrent();s&&((r=s.getCurrent())==null?void 0:r.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...n,onInteractionEnd:s.id})}break}}})}}D(Np,"id","root"),D(Np,"initial",""),D(Np,"children",()=>[]);var MU=Object.defineProperty,OU=Object.getOwnPropertyDescriptor,gt=(t,o,n,r)=>{for(var s=r>1?void 0:r?OU(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&MU(o,n,s),s};class ft extends F$.EventEmitter{constructor({store:n,user:r,shapeUtils:s,tools:i,getContainer:a,initialState:l,inferDarkMode:c}){super();D(this,"store");D(this,"root");D(this,"disposables",new Set);D(this,"_tickManager");D(this,"snaps");D(this,"user");D(this,"textMeasure");D(this,"environment");D(this,"scribbles");D(this,"getContainer");D(this,"sideEffects");D(this,"shapeUtils");D(this,"styleProps");D(this,"history",new lU(this,n=>{this.annotateError(n,{origin:"history.batch",willCrashApp:!0}),this.crash(n)}));D(this,"_crashingError",null);D(this,"_updateInstanceState",this.history.createCommand("updateInstanceState",(n,r)=>{const s=this.store.get(this.getInstanceState().id),i={...s,...n};return{data:{prev:s,next:i},ephemeral:!1,squashing:!1,...r}},{do:({next:n})=>{this.store.put([n])},undo:({prev:n})=>{this.store.put([n])},squash({prev:n},{next:r}){return{prev:n,next:r}}}));D(this,"_isChangingStyleTimeout",-1);D(this,"setCursor",n=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...n}},{ephemeral:!0}),this));D(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(n,r)=>({data:{prev:this.store.get(n.id??this.getCurrentPageState().id),partial:n},...r}),{do:({prev:n,partial:r})=>{this.store.update(n.id,s=>({...s,...r}))},undo:({prev:n})=>{this.store.update(n.id,()=>n)}}));D(this,"_setSelectedShapes",this.history.createCommand("setSelectedShapes",(n,r)=>{const{selectedShapeIds:s}=this.getCurrentPageState(),i=new Set(s);return n.length===i.size&&n.every(a=>i.has(a))?null:{data:{selectedShapeIds:n,prevSelectedShapeIds:s},preservesRedoStack:!0,...r}},{do:({selectedShapeIds:n})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:n}])},undo:({prevSelectedShapeIds:n})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:n}])},squash({prevSelectedShapeIds:n},{selectedShapeIds:r}){return{selectedShapeIds:r,prevSelectedShapeIds:n}}}));D(this,"_setFocusedGroupId",this.history.createCommand("setFocusedGroupId",n=>{const r=this.getCurrentPageState().focusedGroupId;if(r!==n)return{data:{prev:r,next:n},preservesRedoStack:!0,squashing:!0}},{do:({next:n})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:n}))},undo:({prev:n})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:n}))},squash({prev:n},{next:r}){return{prev:n,next:r}}}));D(this,"_viewportAnimation",null);D(this,"_willSetInitialBounds",!0);D(this,"_wasInset",!1);D(this,"_cameraState",po("camera state","idle"));D(this,"_cameraStateTimeoutRemaining",0);D(this,"_lastUpdateRenderingBoundsTimestamp",Date.now());D(this,"_decayCameraStateTimeout",n=>{this._cameraStateTimeoutRemaining-=n,this._cameraStateTimeoutRemaining<=0&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"),this.updateRenderingBounds())});D(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=H6;const n=Date.now();this._cameraState.__unsafe__getWithoutCapture()==="idle"&&(this._lastUpdateRenderingBoundsTimestamp=n,this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout))});D(this,"_renderingBounds",po("rendering viewport",new mt));D(this,"renderingBoundsMargin",100);D(this,"_currentPageShapeIds");D(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(n,r)=>{if(!this.store.has(n)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return this.stopFollowingUser(),{data:{toId:n,fromId:this.getCurrentPageId()},squashing:!0,preservesRedoStack:!0,...r}},{do:({toId:n})=>{if(this.store.has(n)){if(!this.getPageStates().find(r=>r.pageId===n)){const r=ho.create({id:ho.createId(n)});this.store.put([r,Wn.create({id:Wn.createId(n),pageId:n})])}this.store.put([{...this.getInstanceState(),currentPageId:n}]),this.updateRenderingBounds()}},undo:({fromId:n})=>{this.store.has(n)&&(this.store.put([{...this.getInstanceState(),currentPageId:n}]),this.updateRenderingBounds())},squash:({fromId:n},{toId:r})=>({toId:r,fromId:n})}));D(this,"_updatePage",this.history.createCommand("updatePage",(n,r)=>{if(this.getInstanceState().isReadonly)return null;const s=this.getPage(n.id);return s?{data:{prev:s,partial:n},...r}:null},{do:({partial:n})=>{this.store.update(n.id,r=>({...r,...n}))},undo:({prev:n,partial:r})=>{this.store.update(r.id,()=>n)},squash(n,r){return{prev:{...n.prev,...r.prev},partial:r.partial}}}));D(this,"_createPage",this.history.createCommand("createPage",n=>{if(this.getInstanceState().isReadonly||this.getPages().length>=cg)return null;const r=this.getPages(),s=W$(n.name??"Page 1",r.map(u=>u.name));let i=n.index;(!i||r.some(u=>u.index===i))&&(i=Ii(r[r.length-1].index));const a=Gi.create({meta:{},...n,name:s,index:i}),l=ho.create({id:ho.createId(a.id)}),c=Wn.create({id:Wn.createId(a.id),pageId:a.id});return{data:{newPage:a,newTabPageState:c,newCamera:l}}},{do:({newPage:n,newTabPageState:r,newCamera:s})=>{this.store.put([n,s,r])},undo:({newPage:n,newTabPageState:r,newCamera:s})=>{this.getPages().length!==1&&this.store.remove([r.id,n.id,s.id])}}));D(this,"_deletePage",this.history.createCommand("delete_page",n=>{if(this.getInstanceState().isReadonly)return null;const r=this.getPages();if(r.length===1)return null;const s=this.getPage(n),i=this.getPageStates().filter(a=>a.pageId===n);if(!s)return null;if(n===this.getCurrentPageId()){const a=r.findIndex(c=>c.id===n),l=r[a-1]??r[a+1];this.setCurrentPage(l.id)}return{data:{id:n,deletedPage:s,deletedPageStates:i}}},{do:({deletedPage:n,deletedPageStates:r})=>{const s=this.getPages();if(s.length!==1){if(n.id===this.getCurrentPageId()){const i=s.findIndex(l=>l.id===n.id),a=s[i-1]??s[i+1];this.setCurrentPage(a.id)}this.store.remove(r.map(i=>i.id)),this.store.remove([n.id]),this.updateRenderingBounds()}},undo:({deletedPage:n,deletedPageStates:r})=>{this.store.put([n]),this.store.put(r),this.updateRenderingBounds()}}));D(this,"_createAssets",this.history.createCommand("createAssets",n=>this.getInstanceState().isReadonly||n.length<=0?null:{data:{assets:n}},{do:({assets:n})=>{this.store.put(n)},undo:({assets:n})=>{this.store.remove(n.map(r=>r.id))}}));D(this,"_updateAssets",this.history.createCommand("updateAssets",n=>this.getInstanceState().isReadonly||n.length<=0?void 0:{data:{snapshots:{},assets:n}},{do:({assets:n,snapshots:r})=>{this.store.put(n.map(s=>{const i=this.store.get(s.id);return r[s.id]=i,{...i,...s}}))},undo:({snapshots:n})=>{this.store.put(Object.values(n))}}));D(this,"_deleteAssets",this.history.createCommand("deleteAssets",n=>{if(this.getInstanceState().isReadonly||n.length<=0)return;const r=Rt(n.map(s=>this.store.get(s)));return{data:{ids:n,prev:r}}},{do:({ids:n})=>{this.store.remove(n)},undo:({prev:n})=>{this.store.put(n)}}));D(this,"_parentIdsToChildIds");D(this,"_childIdsCache",new ry);D(this,"_createShapes",this.history.createCommand("createShapes",n=>{if(this.getInstanceState().isReadonly||n.length<=0)return null;const r=this.getCurrentPageShapeIds();if(n.length+r.size>Ei){zf(this);return}return n.length===0?null:{data:{currentPageId:this.getCurrentPageId(),partials:n.map(i=>i.id?i:{...i,id:hr()})}}},{do:({partials:n})=>{var l,c;const r=this.getFocusedGroupId(),s=this.getCurrentPageShapesSorted();n=n.map(u=>{if(!u.parentId||!(this.store.has(u.parentId)||n.some(f=>f.id===u.parentId))){let f=this.getFocusedGroupId();for(let d=s.length-1;d>=0;d--){const p=s[d];if(this.getShapeUtil(p).canReceiveNewChildrenOfType(p,u.type)&&this.isPointInShape(p,{x:u.x??0,y:u.y??0},{margin:0,hitInside:!0})){f=p.id;break}}const h=u.parentId;if(f===u.id&&(f=r),f!==h&&(u={...u},u.parentId=f,Vo(f))){const d=this.getPointInShapeSpace(this.getShape(f),{x:u.x??0,y:u.y??0});u.x=d.x,u.y=d.y,u.rotation=-this.getShapePageTransform(f).rotation()+(u.rotation??0)}}return u});const i=new Map,a=[];for(const u of n){const f=this.getShapeUtil(u);let h=u.index;if(!h){const g=u.parentId??r;i.has(g)||i.set(g,this.getHighestIndexForParent(g)),h=i.get(g),i.set(g,Ii(h))}const d=f.getDefaultProps();for(const[g,b]of this.styleProps[u.type])d[b]=this.getStyleForNextShape(g);let p=this.store.schema.types.shape.create({...u,index:h,opacity:u.opacity??this.getInstanceState().opacityForNextShape,parentId:u.parentId??r,props:"props"in u?{...d,...u.props}:d});if(p.index===void 0)throw Error("no index!");const m=(c=(l=this.getShapeUtil(p)).onBeforeCreate)==null?void 0:c.call(l,p);m&&(p=m),a.push(p)}a.forEach(u=>{u.meta={...this.getInitialMetaForShape(u),...u.meta}}),this.store.put(a)},undo:({partials:n})=>{this.store.remove(n.map(r=>r.id))}}));D(this,"animatingShapes",new Map);D(this,"_updateShapes",this.history.createCommand("updateShapes",(n,r)=>{if(this.getInstanceState().isReadonly)return null;const s={},i={};let a,l;for(let c=0,u=n.length;c<u;c++){const f=n[c];f&&(a=this.getShape(f.id),a&&(l=cd(a,f),l!==a&&(s[a.id]=a,i[a.id]=l)))}return{data:{snapshots:s,updates:i},...r}},{do:({updates:n})=>{this.store.put(un(n).map(r=>{var i,a;const s=this.store.get(r.id);if(s){const l=(a=(i=this.getShapeUtil(r)).onBeforeUpdate)==null?void 0:a.call(i,s,r);if(l)return l}return r}))},undo:({snapshots:n})=>{this.store.put(Object.values(n))},squash(n,r){return{snapshots:{...r.snapshots,...n.snapshots},updates:{...n.updates,...r.updates}}}}));D(this,"_deleteShapes",this.history.createCommand("delete_shapes",n=>{if(this.getInstanceState().isReadonly||n.length===0)return null;const r=[...this.getCurrentPageState().selectedShapeIds],s=new Set(n);for(const u of n)this.visitDescendants(u,f=>{s.add(f)});const i=[...s],a=this._getArrowBindingsIndex().get(),l=Rt(i.flatMap(u=>{const f=this.getShape(u),h=a[u];return h&&h.length>0?h.map(({arrowId:d})=>this.getShape(d)).concat(f):f})),c=r.filter(u=>!s.has(u));return{data:{deletedIds:i,snapshots:l,prevSelectedShapeIds:r,postSelectedShapeIds:c}}},{do:({deletedIds:n,postSelectedShapeIds:r})=>{this.store.remove(n),this.store.update(this.getCurrentPageState().id,s=>({...s,selectedShapeIds:r}))},undo:({snapshots:n,prevSelectedShapeIds:r})=>{this.store.put(n),this.store.update(this.getCurrentPageState().id,s=>({...s,selectedShapeIds:r}))}}));D(this,"externalAssetContentHandlers",{file:null,url:null});D(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null});D(this,"inputs",{originPagePoint:new Y,originScreenPoint:new Y,previousPagePoint:new Y,previousScreenPoint:new Y,currentPagePoint:new Y,currentScreenPoint:new Y,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new Y});D(this,"_clickManager",new sU(this));D(this,"_prevCursor","default");D(this,"_shiftKeyTimeout",-1);D(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});D(this,"_altKeyTimeout",-1);D(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});D(this,"_ctrlKeyTimeout",-1);D(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});D(this,"_restoreToolId","select");D(this,"_pinchStart",1);D(this,"_didPinch",!1);D(this,"_selectedShapeIdsAtPointerDown",[]);D(this,"_longPressTimeout",-1);D(this,"capturedPointerId",null);D(this,"dispatch",n=>(this._pendingEventsForNextTick.push(n),n.type==="pointer"&&n.name==="pointer_move"||n.type==="wheel"||n.type==="pinch"||this._flushEventsForTick(0),this));D(this,"_pendingEventsForNextTick",[]);D(this,"_flushEventForTick",n=>{if(this.getCrashingError())return this;const{inputs:r}=this,{type:s}=n;if(n.type==="misc"){(n.name==="cancel"||n.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}))),this.root.handleEvent(n);return}n.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!n.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),n.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!n.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),n.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!n.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:i,originScreenPoint:a,currentPagePoint:l,currentScreenPoint:c}=r;switch(r.isPointing||(r.isDragging=!1),s){case"pinch":{if(!this.getInstanceState().canMoveCamera)return;switch(clearTimeout(this._longPressTimeout),this._updateInputsFromEvent(n),n.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds()),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{z:u=1},delta:{x:f,y:h}}=n,{screenBounds:d}=this.store.unsafeGetWithoutCapture(Co),{x:p,y:m}=Y.SubXY(n.point,d.x,d.y),{x:g,y:b,z:y}=this.getCamera(),v=Math.min(ja,Math.max(ad,u));this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this._setCamera({x:g+f/y-p/y+p/v,y:b+h/y-m/y+m/v,z:v},!0);return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedShapeIdsAtPointerDown:u}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown,{squashing:!0}),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,this.once("tick",()=>{this._didPinch||this.setSelectedShapes(u,{squashing:!0})}));return}}}case"wheel":{if(!this.getInstanceState().canMoveCamera)return;if(this._updateInputsFromEvent(n),!this.getIsMenuOpen()){if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),r.ctrlKey){const{x:d,y:p}=this.inputs.currentScreenPoint,{x:m,y:g,z:b}=this.getCamera(),y=Math.min(ja,Math.max(ad,b+(n.delta.z??0)*b));this._setCamera({x:m+(d/y-d)-(d/b-d),y:g+(p/y-p)-(p/b-p),z:y},!0);return}const{x:u,y:f,z:h}=this.getCamera();this._setCamera({x:u+n.delta.x/h,y:f+n.delta.y/h,z:h},!0),!r.isDragging&&r.isPointing&&Y.Dist2(i,l)>(this.getInstanceState().isCoarsePointer?Jb:gh)/this.getZoomLevel()&&(clearTimeout(this._longPressTimeout),r.isDragging=!0)}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(n);const{isPen:u}=n;switch(n.name){case"pointer_down":{if(this.clearOpenMenus(),this._longPressTimeout=setTimeout(()=>{this.dispatch({...n,name:"long_press"})},K6),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),n.button===0&&(this.capturedPointerId=n.pointerId),r.buttons.add(n.button),r.isPointing=!0,r.isDragging=!1,this.getInstanceState().isPenMode){if(!u)return}else u&&this.updateInstanceState({isPenMode:!0});if(n.button===5?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):n.button===1&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing",rotation:0}),this;a.setTo(c),i.setTo(l);break}case"pointer_move":{if(!u&&this.getInstanceState().isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){clearTimeout(this._longPressTimeout);const{currentScreenPoint:f,previousScreenPoint:h}=this.inputs;this.pan(Y.Sub(f,h));return}!r.isDragging&&r.isPointing&&Y.Dist2(i,l)>(this.getInstanceState().isCoarsePointer?Jb:gh)/this.getZoomLevel()&&(clearTimeout(this._longPressTimeout),r.isDragging=!0);break}case"pointer_up":{if(r.buttons.delete(n.button),r.isPointing=!1,r.isDragging=!1,this.getIsMenuOpen()||!u&&this.getInstanceState().isPenMode)return;this.capturedPointerId===n.pointerId&&(this.capturedPointerId=null,n.button=0),r.isPanning?n.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Rp}),this.setCursor({type:"grab",rotation:0})):(r.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Rp}),this.setCursor({type:this._prevCursor,rotation:0})):n.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:Rp}),this.setCursor({type:"grab",rotation:0})):n.button===5&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(n.key==="ShiftRight"&&(n.key="ShiftLeft"),n.key==="AltRight"&&(n.key="AltLeft"),n.code==="ControlRight"&&(n.code="ControlLeft"),n.name){case"key_down":{r.keys.add(n.code),!n.ctrlKey&&n.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,this.setCursor({type:this.inputs.isPointing?"grabbing":"grab",rotation:0}));break}case"key_up":{r.keys.delete(n.code),n.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0}));break}}break}}if(n.type==="pointer"&&(n.button===1?n.name="middle_click":n.button===2&&(n.name="right_click"),n.isPen===this.getInstanceState().isPenMode))switch(n.name){case"pointer_down":{const u=this._clickManager.transformPointerDownEvent(n);if(n.name!==u.name){this.root.handleEvent(n),this.emit("event",n),this.root.handleEvent(u),this.emit("event",u);return}break}case"pointer_up":{clearTimeout(this._longPressTimeout);const u=this._clickManager.transformPointerUpEvent(n);if(n.name!==u.name){this.root.handleEvent(n),this.emit("event",n),this.root.handleEvent(u),this.emit("event",u);return}break}case"pointer_move":{this._clickManager.handleMove();break}}return this.root.handleEvent(n),this.emit("event",n),this});this.store=n,this.snaps=new oy(this),this.user=new Hs(r??TI(),c??!1),this.getContainer=a??(()=>document.body),this.textMeasure=new jU(this),this._tickManager=new EU(this);class u extends Np{}D(u,"initial",l??""),this.root=new u(this),this.root.children={};const f=OI(s),h={},d={},p=new Map;for(const x of f){const S=new x(this);h[x.type]=S;const w=uk(x.props??{});d[x.type]=w;for(const E of w.keys())if(!p.has(E.id))p.set(E.id,E);else if(p.get(E.id)!==E)throw Error(`Multiple style props with id "${E.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=h,this.styleProps=d;for(const x of[...i]){if(si(this.root.children,x.id))throw Error(`Can't override tool with id "${x.id}"`);this.root.children[x.id]=new x(this,this.root)}this.environment=new iU(this),this.scribbles=new cU(this);const m=new Set,g=x=>{var X;const S=this.getShape(x);if(!S)return;const{start:w,end:E}=S.props,j=w.type==="binding"?this.getShape(w.boundShapeId):void 0,P=E.type==="binding"?this.getShape(E.boundShapeId):void 0,M=this.getAncestorPageId(S);if(!M)return;let O;if(j&&P)O=this.findCommonAncestor([j,P])??M;else if(j||P){const W=(X=j||P)==null?void 0:X.parentId;W&&W===S.parentId?O=S.parentId:O=M}else return;O&&O!==S.parentId&&this.reparentShapes([x],O);const k=this.getShape(x);if(!k)throw Error("no reparented arrow");const F=this.getShapeNearestSibling(k,j),A=this.getShapeNearestSibling(k,P);let N;if(F&&A)N=F.index>A.index?F:A;else if(F&&!A)N=F;else if(A&&!F)N=A;else return;let $;const G=this.getSortedChildIdsForParent(N.parentId).map(W=>this.getShape(W)).filter(W=>W.index>N.index);if(G.length){const W=G.find(V=>V.type!=="arrow");if(k.index>N.index&&(!W||k.index<W.index))return;$=Nd(N.index,G[0].index)}else $=Ii(N.index);$!==k.index&&this.updateShapes([{id:x,type:"arrow",index:$}])},b=(x,S)=>{const{x:w,y:E}=Ls(this,x)[S];this.store.put([{...x,props:{...x.props,[S]:{type:"point",x:w,y:E}}}])},y=x=>{for(const S of["start","end"]){const w=x.props[S];if(w.type!=="binding")continue;const E=this.getShape(w.boundShapeId),j=this.getAncestorPageId(x)===this.getAncestorPageId(E);(!E||!j)&&b(x,S)}g(x.id)},v=(x,S)=>{let w=null;const E=x.selectedShapeIds.filter(M=>!S.has(M));E.length!==x.selectedShapeIds.length&&(w||(w={...x}),w.selectedShapeIds=E);const j=x.erasingShapeIds.filter(M=>!S.has(M));j.length!==x.erasingShapeIds.length&&(w||(w={...x}),w.erasingShapeIds=j),x.hoveredShapeId&&S.has(x.hoveredShapeId)&&(w||(w={...x}),w.hoveredShapeId=null),x.editingShapeId&&S.has(x.editingShapeId)&&(w||(w={...x}),w.editingShapeId=null);const P=x.hintingShapeIds.filter(M=>!S.has(M));return P.length!==x.hintingShapeIds.length&&(w||(w={...x}),w.hintingShapeIds=P),x.focusedGroupId&&S.has(x.focusedGroupId)&&(w||(w={...x}),w.focusedGroupId=null),w};if(this.sideEffects=new uU(this),this.sideEffects.registerBatchCompleteHandler(()=>{var x;for(const S of m){m.delete(S);const w=this.getShape(S);if(!w)continue;const E=this.getShapeUtil(w),j=(x=E.onChildrenChange)==null?void 0:x.call(E,w);j!=null&&j.length&&this.updateShapes(j,{squashing:!0})}this.emit("update")}),this.sideEffects.registerBeforeDeleteHandler("shape",x=>{x.parentId&&Vo(x.parentId)&&m.add(x.parentId);const S=this._getArrowBindingsIndex().get()[x.id];if(S!=null&&S.length)for(const{arrowId:j,handleId:P}of S){const M=this.getShape(j);M&&b(M,P)}const w=new Set([x.id]),E=Rt(this.getPageStates().map(j=>v(j,w)));E.length&&this.store.put(E)}),this.sideEffects.registerBeforeDeleteHandler("page",x=>{var j;if(this.getInstanceState().currentPageId!==x.id)return;const S=(j=this.getPages().find(P=>P.id!==x.id))==null?void 0:j.id;if(!S)return;this.store.put([{...this.getInstanceState(),currentPageId:S}]);const w=ho.createId(x.id),E=Wn.createId(x.id);this.store.remove([w,E])}),this.sideEffects.registerAfterChangeHandler("shape",(x,S)=>{if(this.isShapeOfType(S,"arrow")&&y(S),x.parentId!==S.parentId){const w=E=>{const j=this._getArrowBindingsIndex().get()[E];if(j!=null&&j.length)for(const P of j)g(P.arrowId)};w(S.id),this.visitDescendants(S.id,w)}if(x.parentId!==S.parentId&&_o(S.parentId)){const w=new Set([x.id]);this.visitDescendants(x.id,E=>{w.add(E)});for(const E of this.getPageStates()){if(E.pageId===S.parentId)continue;const j=v(E,w);j&&this.store.put([j])}}x.parentId&&Vo(x.parentId)&&m.add(x.parentId),S.parentId!==x.parentId&&Vo(S.parentId)&&m.add(S.parentId)}),this.sideEffects.registerAfterChangeHandler("instance_page_state",(x,S)=>{if((x==null?void 0:x.selectedShapeIds)!==(S==null?void 0:S.selectedShapeIds)){const w=S.selectedShapeIds.filter(j=>{var M,O;let P=(M=this.getShape(j))==null?void 0:M.parentId;for(;Vo(P);){if(S.selectedShapeIds.includes(P))return!1;P=(O=this.getShape(P))==null?void 0:O.parentId}return!0});let E=null;if(w.length>0){const j=this.findCommonAncestor(Rt(w.map(P=>this.getShape(P))),P=>this.isShapeOfType(P,"group"));j&&(E=j)}else S!=null&&S.focusedGroupId&&(E=S.focusedGroupId);(w.length!==S.selectedShapeIds.length||E!==S.focusedGroupId)&&this.store.put([{...S,selectedShapeIds:w,focusedGroupId:E??null}])}}),this.sideEffects.registerAfterCreateHandler("shape",x=>{this.isShapeOfType(x,"arrow")&&y(x)}),this.sideEffects.registerAfterCreateHandler("page",x=>{const S=ho.createId(x.id),w=Wn.createId(x.id);this.store.has(S)||this.store.put([ho.create({id:S})]),this.store.has(w)||this.store.put([Wn.create({id:w,pageId:x.id})])}),this._currentPageShapeIds=tU(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=eU(this.store),this.disposables.add(this.store.listen(x=>{this.emit("change",x)})),this.store.ensureStoreIsUsable(),this._setInstancePageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]},{ephemeral:!0}),l&&this.root.children[l]===void 0)throw Error(`No state found for initialState "${l}".`);this.root.enter(void 0,"initial"),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.updateRenderingBounds(),this.on("tick",this._flushEventsForTick),requestAnimationFrame(()=>{this._tickManager.start()})}dispose(){this.disposables.forEach(n=>n()),this.disposables.clear()}getShapeUtil(n){const r=typeof n=="string"?n:n.type,s=Us(this.shapeUtils,r);return bn(s,`No shape util found for type "${r}"`),s}undo(){return this._flushEventsForTick(0),this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this._flushEventsForTick(0),this.history.redo(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(n,r,s){return this.history.mark(n,r,s),this}bail(){return this.history.bail(),this}bailToMark(n){return this.history.bailToMark(n),this}batch(n){return this.history.batch(n),this}_getArrowBindingsIndex(){return Z$(this)}getArrowsBoundTo(n){return this._getArrowBindingsIndex().get()[n]||Di}getArrowInfoCache(){return this.store.createComputedCache("arrow infoCache",n=>ld(n)?zd(this,n):D0(this,n))}getArrowInfo(n){const r=typeof n=="string"?n:n.id;return this.getArrowInfoCache().get(r)}annotateError(n,{origin:r,willCrashApp:s,tags:i,extras:a}){const l=this.createErrorAnnotations(r,s);return Yx(n,{tags:{...l.tags,...i},extras:{...l.extras,...a}}),s&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(n,r){try{const s=this.getEditingShapeId();return{tags:{origin:n,willCrashApp:r},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:s?this.getShape(s):void 0,inputs:this.inputs}}}catch{return{tags:{origin:n,willCrashApp:r},extras:{}}}}getCrashingError(){return this._crashingError}crash(n){return this._crashingError=n,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:n}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(n){const r=n.split(".").reverse();let s=this.root;for(;r.length>0;){const i=r.pop();if(!i)return!0;const a=s.getCurrent();if((a==null?void 0:a.id)===i){if(r.length===0)return!0;s=a;continue}else return!1}return!1}isInAny(...n){return n.some(r=>this.isIn(r))}setCurrentTool(n,r={}){return this.root.transition(n,r),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const n=this.getCurrentTool();return n?n.getCurrentToolIdMask()??n.id:""}getStateDescendant(n){var i;const r=n.split(".").reverse();let s=this.root;for(;r.length>0;){const a=r.pop();if(!a)return s;const l=(i=s.children)==null?void 0:i[a];if(!l)return;s=l}return s}getDocumentSettings(){return this.store.get(Kb)}updateDocumentSettings(n){return this.store.put([{...this.getDocumentSettings(),...n}]),this}getInstanceState(){return this.store.get(Co)}updateInstanceState(n,r){return this._updateInstanceState(n,{ephemeral:!0,squashing:!0,...r}),n.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),n.isChangingStyle===!0&&(this._isChangingStyleTimeout=setTimeout(()=>{this.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},2e3))),this}getOpenMenus(){return this.getInstanceState().openMenus}addOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)||(r.add(n),this.updateInstanceState({openMenus:[...r]})),this}deleteOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)&&(r.delete(n),this.updateInstanceState({openMenus:[...r]})),this}clearOpenMenus(){return this.getOpenMenus().length&&this.updateInstanceState({openMenus:[]}),this}getIsMenuOpen(){return this.getOpenMenus().length>0}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return Wn.createId(this.getCurrentPageId())}updateCurrentPageState(n,r){return this._setInstancePageState(n,r),this}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:n}=this.getCurrentPageState();return Rt(n.map(r=>this.store.get(r)))}setSelectedShapes(n,r){const s=n.map(i=>typeof i=="string"?i:i.id);return this._setSelectedShapes(s,r),this}select(...n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);return this.setSelectedShapes(r),this}deselect(...n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=this.getSelectedShapeIds();return s.length>0&&r.length>0&&this.setSelectedShapes(s.filter(i=>!r.includes(i))),this}selectAll(){const n=this.getSortedChildIdsForParent(this.getCurrentPageId());return n.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(n)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShapeId(){var n;return((n=this.getOnlySelectedShape())==null?void 0:n.id)??null}getOnlySelectedShape(){const n=this.getSelectedShapes();return n.length===1?n[0]:null}getSelectionPageBounds(){const n=this.getCurrentPageState().selectedShapeIds;return n.length===0?null:mt.Common(Rt(n.map(r=>this.getShapePageBounds(r))))}getSelectionRotation(){const n=this.getSelectedShapeIds();let r=!1,s=0;for(let i=0,a=n.length;i<a;i++){const l=this.getShapePageTransform(n[i]);if(l)if(r){if(l.rotation()!==s)return 0}else r=!0,s=l.rotation()}return s}getSelectionRotatedPageBounds(){const n=this.getSelectedShapeIds();if(n.length===0)return;const r=this.getSelectionRotation();if(r===0)return this.getSelectionPageBounds();if(n.length===1){const i=this.getShapeGeometry(n[0]).bounds.clone(),a=this.getShapePageTransform(n[0]);return i.point=a.applyToPoint(i.point),i}const s=mt.FromPoints(this.getSelectedShapeIds().flatMap(i=>{const a=this.getShapePageTransform(i);return a?a.applyToPoints(this.getShapeGeometry(i).bounds.corners):[]}).map(i=>i.rot(-r)));return s.point=s.point.rot(r),s}getSelectionRotatedScreenBounds(){const n=this.getSelectionRotatedPageBounds();if(!n)return;const{x:r,y:s}=this.pageToScreen(n.point),i=this.getZoomLevel();return new mt(r,s,n.width*i,n.height*i)}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const n=this.getFocusedGroupId();return n?this.getShape(n):void 0}setFocusedGroup(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==null){const s=this.getShape(r);if(!s)throw Error(`Editor.setFocusedGroup: Shape with id ${r} does not exist`);if(!this.isShapeOfType(s,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${s.type}`)}return r===this.getFocusedGroupId()?this:(this._setFocusedGroupId(r),this)}popFocusedGroupId(){const n=this.getFocusedGroup();if(n){const r=this.findShapeAncestor(n,s=>this.isShapeOfType(s,"group"));this.setFocusedGroup((r==null?void 0:r.id)??null),this.select(n.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const n=this.getEditingShapeId();return n?this.getShape(n):void 0}setEditingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==this.getEditingShapeId()){if(r){const s=this.getShape(r);if(s&&this.getShapeUtil(s).canEdit(s))return this._setInstancePageState({editingShapeId:r}),this}this._setInstancePageState({editingShapeId:null})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const n=this.getHoveredShapeId();return n?this.getShape(n):void 0}setHoveredShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;return r===this.getHoveredShapeId()?this:(this.updateCurrentPageState({hoveredShapeId:r},{ephemeral:!0}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const n=this.getHintingShapeIds();return Rt(n.map(r=>this.getShape(r)))}setHintingShapes(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);return this.updateCurrentPageState({hintingShapeIds:Ym(r)},{ephemeral:!0}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const n=this.getErasingShapeIds();return Rt(n.map(r=>this.getShape(r)))}setErasingShapes(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id);r.sort();const s=this.getErasingShapeIds();if(r.length===s.length){for(let i=0;i<r.length;i++)if(r[i]!==s[i]){this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});break}}else this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});return this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==this.getCroppingShapeId())if(!r)this.updateCurrentPageState({croppingShapeId:null});else{const s=this.getShape(r),i=this.getShapeUtil(s);s&&i.canCrop(s)&&this.updateCurrentPageState({croppingShapeId:r})}return this}getCameraId(){return ho.createId(this.getCurrentPageId())}getCamera(){return this.store.get(this.getCameraId())}getZoomLevel(){return this.getCamera().z}_setCamera(n,r=!1){const s=this.getCamera();return s.x===n.x&&s.y===n.y&&s.z===n.z?this:(this.batch(()=>{const i={...s,...n};this.store.put([i]);const{currentScreenPoint:a,currentPagePoint:l}=this.inputs,{screenBounds:c}=this.store.unsafeGetWithoutCapture(Co);if(a.x/i.z-i.x!==l.x||a.y/i.z-i.y!==l.y){const u={type:"pointer",target:"canvas",name:"pointer_move",point:Y.AddXY(a,c.x,c.y),pointerId:S2.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1};r?this._flushEventForTick(u):this.dispatch(u)}this._tickCameraState()}),this)}setCamera(n,r){const s=Number.isFinite(n.x)?n.x:0,i=Number.isFinite(n.y)?n.y:0,a=Number.isFinite(n.z)?n.z:this.getZoomLevel();if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),r){const{width:l,height:c}=this.getViewportScreenBounds();return this._animateToViewport(new mt(-s,-i,l/a,c/a),r)}else this._setCamera({x:s,y:i,z:a});return this}centerOnPoint(n,r){if(!this.getInstanceState().canMoveCamera)return this;const{width:s,height:i}=this.getViewportPageBounds();return this.setCamera({x:-(n.x-s/2),y:-(n.y-i/2),z:this.getCamera().z},r),this}zoomToContent(n={duration:220}){const r=this.getSelectionPageBounds()??this.getCurrentPageBounds();return r&&this.zoomToBounds(r,{targetZoom:Math.min(1,this.getZoomLevel()),...n}),this}zoomToFit(n){if(!this.getInstanceState().canMoveCamera)return this;const r=[...this.getCurrentPageShapeIds()];if(r.length<=0)return this;const s=mt.Common(Rt(r.map(i=>this.getShapePageBounds(i))));return this.zoomToBounds(s,n),this}resetZoom(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:i,z:a}=this.getCamera(),{x:l,y:c}=n;return this.setCamera({x:s+(l/1-l)-(l/a-l),y:i+(c/1-c)-(c/a-c),z:1},r),this}zoomIn(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:i,z:a}=this.getCamera();let l=ja;for(let f=1;f<fc.length;f++){const h=fc[f-1],d=fc[f];if(!(d-a<=(d-h)/2)){l=d;break}}const{x:c,y:u}=n;return this.setCamera({x:s+(c/l-c)-(c/a-c),y:i+(u/l-u)-(u/a-u),z:l},r),this}zoomOut(n=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:i,z:a}=this.getCamera();let l=ad;for(let f=fc.length-1;f>0;f--){const h=fc[f-1],d=fc[f];if(!(d-a>=(d-h)/2)){l=h;break}}const{x:c,y:u}=n;return this.setCamera({x:s+(c/l-c)-(c/a-c),y:i+(u/l-u)-(u/a-u),z:l},r),this}zoomToSelection(n){if(!this.getInstanceState().canMoveCamera)return this;const r=this.getSelectionPageBounds();return r?(this.zoomToBounds(r,{targetZoom:Math.max(1,this.getZoomLevel()),...n}),this):this}panZoomIntoView(n,r){if(!this.getInstanceState().canMoveCamera)return this;if(n.length<=0)return this;const s=mt.Common(Rt(n.map(a=>this.getShapePageBounds(a)))),i=this.getViewportPageBounds();if(i.h<s.h||i.w<s.w)return this.zoomToBounds(s,{targetZoom:this.getCamera().z,...r}),this;{const a=this.getViewportPageBounds().clone().expandBy(-32/this.getZoomLevel());let l=0,c=0;a.maxY<s.maxY?c=a.maxY-s.maxY:a.minY>s.minY&&(c=a.minY-s.minY),a.maxX<s.maxX?l=a.maxX-s.maxX:a.minX>s.minX&&(l=a.minX-s.minX);const u=this.getCamera();this.setCamera({x:u.x+l,y:u.y+c,z:u.z},r)}return this}zoomToBounds(n,r){if(!this.getInstanceState().canMoveCamera)return this;const s=this.getViewportScreenBounds(),i=(r==null?void 0:r.inset)??Math.min(256,s.width*.28);let a=Ga(Math.min((s.width-i)/n.width,(s.height-i)/n.height),ad,ja);return(r==null?void 0:r.targetZoom)!==void 0&&(a=Math.min(r.targetZoom,a)),this.setCamera({x:-n.minX+(s.width-n.width*a)/2/a,y:-n.minY+(s.height-n.height*a)/2/a,z:a},r),this}pan(n,r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:i,z:a}=this.getCamera();return this.setCamera({x:s+n.x/a,y:i+n.y/a,z:a},r),this._flushEventsForTick(0),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(n){if(!this._viewportAnimation)return;const r=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",r),this._viewportAnimation=null};this.once("stop-camera-animation",r),this._viewportAnimation.elapsed+=n;const{elapsed:s,easing:i,duration:a,start:l,end:c}=this._viewportAnimation;if(s>a){this._setCamera({x:-c.x,y:-c.y,z:this.getViewportScreenBounds().width/c.width}),r();return}const u=a-s,f=i(1-u/a),h=l.minX+(c.minX-l.minX)*f,d=l.minY+(c.minY-l.minY)*f,p=l.maxX+(c.maxX-l.maxX)*f;this._setCamera({x:-h,y:-d,z:this.getViewportScreenBounds().width/(p-h)})}_animateToViewport(n,r={}){const{duration:s=0,easing:i=Kn.easeInOutCubic}=r,a=this.user.getAnimationSpeed(),l=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),s===0||a===0?this._setCamera({x:-n.x,y:-n.y,z:this.getViewportScreenBounds().width/n.width}):(this._viewportAnimation={elapsed:0,duration:s/a,easing:i,start:l.clone(),end:n.clone()},this.addListener("tick",this._animateViewport),this)}slideCamera(n={}){if(!this.getInstanceState().canMoveCamera)return this;if(this.stopCameraAnimation(),this.user.getAnimationSpeed()===0)return this;const{speed:s,friction:i,direction:a,speedThreshold:l=.01}=n;let c=Math.min(s,1);const u=()=>{this.removeListener("tick",f),this.removeListener("stop-camera-animation",u)};this.once("stop-camera-animation",u);const f=h=>{const{x:d,y:p,z:m}=this.getCamera(),g=Y.Mul(a,c*h/m);c*=1-i,c<l?u():this._setCamera({x:d+g.x,y:p+g.y,z:m})};return this.addListener("tick",f),this}animateToUser(n){const r=this.getCollaborators().find(s=>s.userId===n);return r?(this.batch(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const s=r.currentPageId===this.getCurrentPageId();s||this.setCurrentPage(r.currentPageId);const i=s?{duration:500}:void 0;this.centerOnPoint(r.cursor,i);const{highlightedUserIds:a}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...a,n]}),setTimeout(()=>{const l=[...this.getInstanceState().highlightedUserIds],c=l.indexOf(n);c<0||(l.splice(c,1),this.updateInstanceState({highlightedUserIds:l}))},Wk)}),this):this}animateToShape(n,r=z6){if(!this.getInstanceState().canMoveCamera)return this;const s=this.getViewportScreenBounds().clone().expandBy(-32),i=s.width/s.height,a=this.getShapePageBounds(n);if(!a)return this;const l=a.width/a.height,c=a.clone(),u=a.width/s.width;return c.width+=(s.minX+s.maxX)*u,c.height+=(s.minY+s.maxY)*u,c.x-=s.minX*u,c.y-=s.minY*u,l>i?(c.height=a.width/i,c.y-=(c.height-a.height)/2):(c.width=a.height*i,c.x-=(c.width-a.width)/2),this._animateToViewport(c,r)}updateViewportScreenBounds(n,r=!1){n.width=Math.max(n.width,1),n.height=Math.max(n.height,1);const s=[n.minY!==0,document.body.scrollWidth!==n.maxX,document.body.scrollHeight!==n.maxY,n.minX!==0],i=n.equals(this.getViewportScreenBounds()),{_willSetInitialBounds:a}=this;if(i)this._willSetInitialBounds=!1;else if(a)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:n.toJson(),insets:s},{squashing:!0,ephemeral:!0});else if(r&&!this.getInstanceState().followingUserId){const l=this.getViewportPageCenter();this.updateInstanceState({screenBounds:n.toJson(),insets:s},{squashing:!0,ephemeral:!0}),this.centerOnPoint(l)}else this.updateInstanceState({screenBounds:n.toJson(),insets:s},{squashing:!0,ephemeral:!0});return this._tickCameraState(),this.updateRenderingBounds(),this}getViewportScreenBounds(){const{x:n,y:r,w:s,h:i}=this.getInstanceState().screenBounds;return new mt(n,r,s,i)}getViewportScreenCenter(){const n=this.getViewportScreenBounds();return new Y(n.midX-n.minX,n.midY-n.minY)}getViewportPageBounds(){const{w:n,h:r}=this.getViewportScreenBounds(),{x:s,y:i,z:a}=this.getCamera();return new mt(-s,-i,n/a,r/a)}getViewportPageCenter(){return this.getViewportPageBounds().center}screenToPage(n){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Co),{x:s,y:i,z:a=1}=this.getCamera();return{x:(n.x-r.x)/a-s,y:(n.y-r.y)/a-i,z:n.z??.5}}pageToScreen(n){const r=this.getViewportScreenBounds(),{x:s,y:i,z:a=1}=this.getCamera();return{x:(n.x+s)*a+r.x,y:(n.y+i)*a+r.y,z:n.z??.5}}pageToViewport(n){const{x:r,y:s,z:i=1}=this.getCamera();return{x:(n.x+r)*i,y:(n.y+s)*i,z:n.z??.5}}_getCollaboratorsQuery(){return this.store.query.records("instance_presence",()=>({userId:{neq:this.user.getId()}}))}getCollaborators(){const n=this._getCollaboratorsQuery().get();return n.length?[...new Set(n.map(s=>s.userId))].sort().map(s=>n.filter(a=>a.userId===s).sort((a,l)=>l.lastActivityTimestamp-a.lastActivityTimestamp)[0]):Di}getCollaboratorsOnCurrentPage(){const n=this.getCurrentPageId();return this.getCollaborators().filter(r=>r.currentPageId===n)}startFollowingUser(n){const r=this._getCollaboratorsQuery().get().filter(c=>c.userId===n),s=this.user.getId();if(s||console.warn("You should set the userId for the current instance before following a user"),r.some(c=>c.followingUserId===s))return this;Rs(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:n},{ephemeral:!0})});const i=()=>{this.removeListener("frame",l),this.removeListener("stop-following",i)};let a=!1;const l=()=>{const c=[...r].sort((A,N)=>A.lastActivityTimestamp-N.lastActivityTimestamp).pop();if(!c){this.stopFollowingUser();return}const u=c.currentPageId===this.getCurrentPageId(),f=u?R6:1;if(!u){this.stopFollowingUser(),this.setCurrentPage(c.currentPageId),this.startFollowingUser(n);return}const{center:h,width:d,height:p}=this.getViewportPageBounds(),m=mt.From(c.screenBounds),g=m.width/c.camera.z,b=m.height/c.camera.z,y=new Y(g/2-c.camera.x,b/2-c.camera.y),v=c.followingUserId===s,x=d+(g-d)*f,S=p+(b-p)*f,w=v?p/S:Math.min(d/x,p/S),E=Ga(this.getCamera().z*w,ad,ja),j=this.getViewportScreenBounds().w/E,P=this.getViewportScreenBounds().h/E,M=y.sub(h),O=Y.Add(h,Y.Mul(M,f)),k=Y.Sub(O,h).len(),F=Math.abs(E-this.getCamera().z);if(k<D6&&F<F6){a=!0;return}a&&k<L6&&F<N6||(a=!1,this.stopCameraAnimation(),this._setCamera({x:-(O.x-j/2),y:-(O.y-P/2),z:E}))};return this.once("stop-following",i),this.addListener("frame",l),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},{ephemeral:!0}),this.emit("stop-following"),this}getCameraState(){return this._cameraState.get()}getUnorderedRenderingShapes(n){const r=[];let s=Ei*2,i=Ei;const a=this.getErasingShapeIds(),l=(u,f,h)=>{const d=this.getShape(u);if(!d)return;f*=d.opacity;let p=!1;const m=this.getShapeUtil(d);n&&(p=!h&&a.includes(u),p&&(f*=.32)),r.push({id:u,shape:d,util:m,index:s,backgroundIndex:i,opacity:f}),s+=1,i+=1;const g=this.getSortedChildIdsForParent(u);if(!g.length)return;let b=null;m.providesBackgroundForChildren(d)&&(b=i,i=s,s+=Ei);for(const y of g)l(y,f,h||p);b!==null&&(i=b)},c=n?[this.getCurrentPage()]:this.getPages();for(const u of c)for(const f of this.getSortedChildIdsForParent(u.id))l(f,1,!1);return r}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(QL)}getRenderingBounds(){return this._renderingBounds.get()}updateRenderingBounds(){const n=this.getViewportPageBounds();return n.equals(this._renderingBounds.__unsafe__getWithoutCapture())?this:(this._renderingBounds.set(n.clone()),this)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort(qn)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(n){return this.store.get(typeof n=="string"?n:n.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getCurrentPageShapeIdsSorted(){return Array.from(this.getCurrentPageShapeIds()).sort()}getPageShapeIds(n){const r=typeof n=="string"?n:n.id,s=this.store.query.exec("shape",{parentId:{eq:r}});return this.getShapeAndDescendantIds(s.map(i=>i.id))}setCurrentPage(n,r){const s=typeof n=="string"?n:n.id;return this._setCurrentPageId(s,r),this}updatePage(n,r){return this._updatePage(n,r),this}createPage(n){return this._createPage(n),this}deletePage(n){const r=typeof n=="string"?n:n.id;return this._deletePage(r),this}duplicatePage(n,r=Gi.createId()){if(this.getPages().length>=cg)return this;const s=typeof n=="string"?n:n.id,i=this.getPage(s);if(!i)return this;const a={...this.getCamera()},l=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(i.id));return this.batch(()=>{var f;const c=this.getPages(),u=Nd(i.index,(f=c[c.indexOf(i)+1])==null?void 0:f.index);if(this.createPage({name:i.name+" Copy",id:r,index:u}),this.setCurrentPage(r),this.setCamera(a),l)return this.putContentOntoCurrentPage(l)}),this}renamePage(n,r,s){const i=typeof n=="string"?n:n.id;return this.getInstanceState().isReadonly?this:(this.updatePage({id:i,name:r},s),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(n){return this._createAssets(n),this}updateAssets(n){return this._updateAssets(n),this}deleteAssets(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);return this._deleteAssets(r),this}getAsset(n){return this.store.get(typeof n=="string"?n:n.id)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",n=>this.getShapeUtil(n).getGeometry(n),(n,r)=>n.props===r.props)}getShapeGeometry(n){return this._getShapeGeometryCache().get(typeof n=="string"?n:n.id)}_getShapeHandlesCache(){return this.store.createComputedCache("handles",n=>{var r,s;return(s=(r=this.getShapeUtil(n)).getHandles)==null?void 0:s.call(r,n)})}getShapeHandles(n){return this._getShapeHandlesCache().get(typeof n=="string"?n:n.id)}getShapeLocalTransform(n){const r=typeof n=="string"?n:n.id,s=this.getShape(r);if(!s)throw Error("Editor.getTransform: shape not found");return vt.Identity().translate(s.x,s.y).rotate(s.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",n=>{if(_o(n.parentId))return this.getShapeLocalTransform(n);const r=this._getShapePageTransformCache().get(n.parentId)??vt.Identity();return vt.Compose(r,this.getShapeLocalTransform(n))})}getShapeParentTransform(n){const r=typeof n=="string"?n:n.id,s=this.getShape(r);return!s||_o(s.parentId)?vt.Identity():this._getShapePageTransformCache().get(s.parentId)??vt.Identity()}getShapePageTransform(n){const r=typeof n=="string"?n:n.id;return this._getShapePageTransformCache().get(r)??vt.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",n=>{const r=this._getShapePageTransformCache().get(n.id);return r?mt.FromPoints(vt.applyToPoints(r,this.getShapeGeometry(n).vertices)):new mt})}getShapePageBounds(n){return this._getShapePageBoundsCache().get(typeof n=="string"?n:n.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",n=>{const r=this._getShapeMaskCache().get(n.id);if(!r)return;if(r.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const s=this._getShapePageTransformCache().get(n.id);return s?`polygon(${vt.applyToPoints(vt.Inverse(s),r).map(a=>`${a.x}px ${a.y}px`).join(",")})`:void 0})}getShapeClipPath(n){return this._getShapeClipPathCache().get(typeof n=="string"?n:n.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",n=>{if(_o(n.parentId))return;const r=this.getShapeAncestors(n.id).filter(i=>this.isShapeOfType(i,"frame"));return r.length===0?void 0:r.map(i=>this._getShapePageTransformCache().get(i.id).applyToPoints(this.getShapeGeometry(i).vertices)).reduce((i,a)=>{if(!(a&&i))return;const l=V2(i,a);return l?l.map(Y.Cast):[]})})}getShapeMask(n){return this._getShapeMaskCache().get(typeof n=="string"?n:n.id)}getShapeMaskedPageBounds(n){return typeof n!="string"&&(n=n.id),this._getShapeMaskedPageBoundsCache().get(n)}_getShapeMaskedPageBoundsCache(){return this.store.createComputedCache("shapeMaskedPageBoundsCache",n=>{const r=this._getShapePageBoundsCache().get(n.id);if(!r)return;const s=this._getShapeMaskCache().get(n.id);if(s){if(s.length===0)return;const{corners:i}=r;if(i.every((l,c)=>l&&Y.Equals(l,s[c])))return r.clone();const a=V2(s,i);return a?mt.FromPoints(a):void 0}return r})}getShapeAncestors(n,r=[]){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return r;const a=i.parentId;if(_o(a))return r.reverse(),r;const l=this.store.get(a);return l?(r.push(l),this.getShapeAncestors(l,r)):r}findShapeAncestor(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return;const a=i.parentId;if(_o(a))return;const l=this.getShape(a);if(l)return r(l)?l:this.findShapeAncestor(l,r)}hasAncestor(n,r){const s=typeof n=="string"?n:n==null?void 0:n.id,i=s&&this.getShape(s);return i?i.parentId===r?!0:this.hasAncestor(this.getShapeParent(i),r):!1}findCommonAncestor(n,r){var u;if(n.length===0)return;const s=typeof n[0]=="string"?n:n.map(f=>f.id),i=Rt(s.map(f=>this.getShape(f)));if(i.length===1){const f=i[0].parentId;return _o(f)?void 0:r?(u=this.findShapeAncestor(i[0],r))==null?void 0:u.id:f}const[a,...l]=i;let c=this.getShapeParent(a);for(;c;){if(r&&!r(c)){c=this.getShapeParent(c);continue}if(l.every(f=>this.hasAncestor(f,c.id)))return c.id;c=this.getShapeParent(c)}}isShapeOrAncestorLocked(n){const r=typeof n=="string"?this.getShape(n):n;return r===void 0?!1:r.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(r))}_notVisibleShapes(){return J$(this)}getCulledShapes(){const n=this._notVisibleShapes().get(),r=this.getSelectedShapeIds(),s=this.getEditingShapeId(),i=new Set(n);return s&&i.delete(s),r.forEach(a=>{i.delete(a)}),i}getCurrentPageBounds(){let n;return this.getCurrentPageShapeIdsSorted().forEach(r=>{const s=this.getShapeMaskedPageBounds(r);s&&(n?n=n.expand(s):n=s.clone())}),n}getSelectedShapeAtPoint(n){const r=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(s=>s.type!=="group"&&r.includes(s.id)).reverse().find(s=>this.isPointInShape(s,n,{hitInside:!0,margin:0}))}getShapeAtPoint(n,r={}){const s=this.getZoomLevel(),i=this.getViewportPageBounds(),{filter:a,margin:l=0,hitLabels:c=!1,hitInside:u=!1,hitFrameInside:f=!1}=r;let h=1/0,d=null,p=1/0,m=null;const g=(r.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(b=>{if(this.isShapeOfType(b,"group"))return!1;const y=this.getShapeMask(b);return y&&!Zo(n,y)?!1:a?a(b):!0});for(let b=g.length-1;b>=0;b--){const y=g[b],v=this.getShapeGeometry(y),x=v instanceof Vs,S=this.getPointInShapeSpace(y,n);if((this.isShapeOfType(y,"arrow")||this.isShapeOfType(y,"geo")&&y.props.fill==="none")&&y.props.text.trim()){for(const E of v.children)if(E.isLabel&&E.isPointInBounds(S))return y}if(this.isShapeOfType(y,"frame")){const E=v.distanceToPoint(S,u);if(Math.abs(E)<=l)return m||y;if(v.hitTestPoint(S,0,!0))return m||d||(f?y:void 0);continue}let w;if(x){let E=1/0;for(const j of v.children){if(j.isLabel&&!c)continue;const P=j.distanceToPoint(S,u);P<E&&(E=P)}w=E}else l===0&&(v.bounds.w<1||v.bounds.h<1)||v.bounds.containsPoint(S,l)?w=v.distanceToPoint(S,u):w=1/0;if(v.isClosed){if(w<=l){if(v.isFilled||x&&v.children[0].isFilled)return m||y;if(this.getShapePageBounds(y).contains(i))continue;if(Math.abs(w)<l)Math.abs(w)<p&&(p=Math.abs(w),m=y);else if(!m){const{area:E}=v;E<h&&(h=E,d=y)}}}else if(w<Vi/s)return y}return m||d||void 0}getShapesAtPoint(n,r={}){return this.getCurrentPageShapes().filter(s=>this.isPointInShape(s,n,r))}isPointInShape(n,r,s={}){const{hitInside:i=!1,margin:a=0}=s,l=typeof n=="string"?n:n.id,c=this.getShapeMask(l);return c&&!Zo(r,c)?!1:this.getShapeGeometry(l).hitTestPoint(this.getPointInShapeSpace(n,r),a,i)}getPointInShapeSpace(n,r){const s=typeof n=="string"?n:n.id;return this._getShapePageTransformCache().get(s).clone().invert().applyToPoint(r)}getPointInParentSpace(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return new Y(0,0);if(_o(i.parentId))return Y.From(r);const a=this.getShapePageTransform(i.parentId);return a?a.clone().invert().applyToPoint(r):Y.From(r)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),n=>this.store.get(n))}getCurrentPageShapesSorted(){const n=[],r=this.getSortedChildIdsForParent(this.getCurrentPageId());for(let s=0,i=r.length;s<i;s++)FI(this,r[s],n);return n}getCurrentPageRenderingShapesSorted(){const n=this.getCulledShapes();return this.getCurrentPageShapesSorted().filter(({id:r})=>!n.has(r))}isShapeOfType(n,r){const s=typeof n=="string"?this.getShape(n):n;return s?s.type===r:!1}getShape(n){const r=typeof n=="string"?n:n.id;if(Vo(r))return this.store.get(r)}getShapeParent(n){const r=typeof n=="string"?n:n==null?void 0:n.id;if(!r)return;const s=this.getShape(r);if(!(s===void 0||!Vo(s.parentId)))return this.store.get(s.parentId)}getShapeNearestSibling(n,r){return r?r.parentId===n.parentId?r:this.findShapeAncestor(r,i=>i.parentId===n.parentId):void 0}isShapeInPage(n,r=this.getCurrentPageId()){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return!1;let a=!1;if(i.parentId===r)a=!0;else{let l=this.getShape(i.parentId);e:for(;l;){if(l.parentId===r){a=!0;break e}l=this.getShape(l.parentId)}}return a}getAncestorPageId(n){const r=typeof n=="string"?n:n==null?void 0:n.id,s=r&&this.getShape(r);if(s)return _o(s.parentId)?s.parentId:this.getAncestorPageId(this.getShape(s.parentId))}reparentShapes(n,r,s){const i=typeof n[0]=="string"?n:n.map(m=>m.id);if(i.length===0)return this;const a=[],l=_o(r)?vt.Identity():this.getShapePageTransform(r),c=l.rotation();let u=[];const f=Rt(this.getSortedChildIdsForParent(r).map(m=>this.getShape(m)));if(s){const m=f.find(g=>g.index===s);if(m){const g=f[f.indexOf(m)+1];g?u=gu(s,g.index,i.length):u=b0(s,i.length)}else{const g=f.sort(qn).find(b=>b.index>s);g?u=gu(s,g.index,i.length):u=b0(s,i.length)}}else{const m=f.length&&f[f.length-1];u=m?b0(m.index,i.length):uh(i.length)}const h=l.clone().invert(),d=Rt(i.map(m=>this.getShape(m))),p=d.filter(m=>m.isLocked);p.length&&this.updateShapes(p.map(({id:m,type:g})=>({id:m,type:g,isLocked:!1})));for(let m=0;m<d.length;m++){const g=d[m],b=this.getShapePageTransform(g);if(!b)continue;const y=b.point();if(!y)continue;const v=h.applyToPoint(y),x=b.rotation()-c;a.push({id:g.id,type:g.type,parentId:r,x:v.x,y:v.y,rotation:x,index:u[m],isLocked:g.isLocked})}return this.updateShapes(a),this}getHighestIndexForParent(n){const r=typeof n=="string"?n:n.id,s=this._parentIdsToChildIds.get()[r];if(!s||s.length===0)return"a1";const i=this.getShape(s[s.length-1]);return Ii(i.index)}getSortedChildIdsForParent(n){const r=typeof n=="string"?n:n.id,s=this._parentIdsToChildIds.get()[r];return s?this._childIdsCache.get(s,()=>s):Di}visitDescendants(n,r){const s=typeof n=="string"?n:n.id,i=this.getSortedChildIdsForParent(s);for(const a of i)r(a)!==!1&&this.visitDescendants(a,r);return this}getShapeAndDescendantIds(n){const r=new Set,s=[...n];for(;s.length>0;){const i=s.pop();if(!i)break;if(!r.has(i)){r.add(i);for(const a of this.getSortedChildIdsForParent(i))s.push(a)}}return r}getDroppingOverShape(n,r=[]){const s=this.getCurrentPageShapesSorted();for(let i=s.length-1;i>=0;i--){const a=s[i];if(this.getSelectedShapeIds().includes(a.id)||!this.getShapeUtil(a).canDropShapes(a,r)||r.find(c=>c.id===a.id||this.hasAncestor(a,c.id)))continue;const l=this.getShapeMaskedPageBounds(a.id);if(l&&l.containsPoint(n)&&this.getShapeGeometry(a).hitTestPoint(this.getPointInShapeSpace(a,n),0,!0))return a}}getOutermostSelectableShape(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);let a=i,l=i;const c=this.getFocusedGroup();for(;l;){if(this.isShapeOfType(l,"group")&&(c==null?void 0:c.id)!==l.id&&!this.hasAncestor(c,l.id)&&((r==null?void 0:r(l))??!0))a=l;else if((c==null?void 0:c.id)===l.id)break;l=this.getShapeParent(l)}return a}rotateShapesBy(n,r){if((typeof n[0]=="string"?n:n.map(a=>a.id)).length<=0)return this;const i=AI({editor:this});return i?(Fp({delta:r,snapshot:i,editor:this,stage:"one-off"}),this):this}getChangesToTranslateShape(n,r){var a,l,c;let s=n;const i=this.getShapeUtil(n);return s=cd(s,((a=i.onTranslateStart)==null?void 0:a.call(i,s))??void 0),s=cd(s,{id:n.id,type:n.type,x:r.x,y:r.y}),s=cd(s,((l=i.onTranslate)==null?void 0:l.call(i,n,s))??void 0),s=cd(s,((c=i.onTranslateEnd)==null?void 0:c.call(i,n,s))??void 0),s}nudgeShapes(n,r,s){const i=typeof n[0]=="string"?n:n.map(l=>l.id);if(i.length<=0)return this;const a=[];for(const l of i){const c=this.getShape(l),u=Y.From(r),f=this.getShapeParentTransform(c);f&&u.rot(-f.rotation()),a.push(this.getChangesToTranslateShape(c,u.add(c)))}return this.updateShapes(a,{squashing:!0,...s}),this}duplicateShapes(n,r){const s=typeof n[0]=="string"?n:n.map(f=>f.id);if(s.length<=0)return this;const i=new Set(s),a=[],l=[...s];for(;l.length>0;){const f=l.pop();if(!f)break;a.push(f),this.getSortedChildIdsForParent(f).forEach(h=>l.push(h))}a.reverse();const c=new Map(a.map(f=>[f,hr()])),u=Rt(a.map(f=>{const h=this.getShape(f);if(!h)return null;const d=c.get(f);let p=0,m=0;if(r&&i.has(f)){const E=this.getShapeParentTransform(h),j=new Y(r.x,r.y).rot(-E.rotation());p=j.x,m=j.y}const g=h.parentId??this.getCurrentPageId(),b=this.getSortedChildIdsForParent(g),y=b.indexOf(h.id),v=b[y+1],x=v?this.getShape(v):null,S=x?Nd(h.index,x.index):Ii(h.index);let w=_r(h);if(this.isShapeOfType(h,"arrow")&&this.isShapeOfType(w,"arrow")){const E=this.getArrowInfo(h);let j,P;if(h.props.start.type==="binding"&&(j=c.get(h.props.start.boundShapeId),!j))if(E!=null&&E.isValid){const{x:O,y:k}=E.start.point;w.props.start={type:"point",x:O,y:k}}else{const{start:O}=Ls(this,h);w.props.start={type:"point",x:O.x,y:O.y}}if(h.props.end.type==="binding"&&(P=c.get(h.props.end.boundShapeId),!P))if(E!=null&&E.isValid){const{x:O,y:k}=E.end.point;w.props.end={type:"point",x:O,y:k}}else{const{end:O}=Ls(this,h);w.props.start={type:"point",x:O.x,y:O.y}}const M=ld(w)?zd(this,w):D0(this,w);if(E!=null&&E.isValid&&(M!=null&&M.isValid)&&!ld(h)){const O=Y.Med(E.start.handle,E.end.handle),k=Y.Dist(E.middle,O),F=Y.Dist(M.middle,O);w.props.bend<0?w.props.bend+=F-k:w.props.bend-=F-k}w.props.start.type==="binding"&&j&&(w.props.start.boundShapeId=j),w.props.end.type==="binding"&&P&&(w.props.end.boundShapeId=P)}return w={...w,id:d,x:h.x+p,y:h.y+m,index:S},w}));return u.forEach(f=>{Vo(f.parentId)&&c.has(f.parentId)&&(f.parentId=c.get(f.parentId))}),this.history.batch(()=>{const f=u.length+this.getCurrentPageShapeIds().size>Ei;f&&zf(this);const h=f?u.slice(0,Ei-this.getCurrentPageShapeIds().size):u,d=h.map(p=>p.id);if(this.createShapes(h),this.setSelectedShapes(d),r!==void 0){const p=this.getSelectionPageBounds(),m=this.getViewportPageBounds();p&&!m.contains(p)&&this.centerOnPoint(p.center,{duration:ti})}}),this}moveShapesToPage(n,r){const s=typeof n[0]=="string"?n:n.map(c=>c.id);if(s.length===0)return this;if(this.getInstanceState().isReadonly)return this;const i=this.getCurrentPageId();if(r===i)return this;if(!this.store.has(r))return this;const a=this.getContentFromCurrentPage(s);if(!a)return this;if(this.getPageShapeIds(r).size+a.shapes.length>Ei)return zf(this,r),this;const l=this.getCamera().z;return this.history.batch(()=>{this.deleteShapes(s),this.setCurrentPage(r),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(a,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:l}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(n){const r=typeof n[0]=="string"?n:n.map(l=>l.id);if(this.getInstanceState().isReadonly||r.length===0)return this;let s=!0,i=!0;const a=[];for(const l of r){const c=this.getShape(l);c&&(a.push(c),c.isLocked?i=!1:s=!1)}return this.batch(()=>{i?(this.updateShapes(a.map(l=>({id:l.id,type:l.type,isLocked:!0}))),this.setSelectedShapes([])):s?this.updateShapes(a.map(l=>({id:l.id,type:l.type,isLocked:!1}))):this.updateShapes(a.map(l=>({id:l.id,type:l.type,isLocked:!0})))}),this}sendToBack(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=Bf(this,"toBack",r);return s&&this.updateShapes(s),this}sendBackward(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=Bf(this,"backward",r);return s&&this.updateShapes(s),this}bringForward(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=Bf(this,"forward",r);return s&&this.updateShapes(s),this}bringToFront(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=Bf(this,"toFront",r);return s&&this.updateShapes(s),this}flipShapes(n,r){const s=typeof n[0]=="string"?n:n.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;let i=Rt(s.map(l=>this.getShape(l)));if(!i.length)return this;i=Rt(i.map(l=>this.isShapeOfType(l,"group")?this.getSortedChildIdsForParent(l.id).map(c=>this.getShape(c)):l).flat());const a=mt.Common(Rt(i.map(l=>this.getShapePageBounds(l)))).center;return this.batch(()=>{for(const l of i){const c=this.getShapeGeometry(l).bounds,u=this.getShapePageTransform(l.id);u&&this.resizeShape(l.id,{x:r==="horizontal"?-1:1,y:r==="vertical"?-1:1},{initialBounds:c,initialPageTransform:u,initialShape:l,mode:"scale_shape",scaleOrigin:a,scaleAxisRotation:0})}}),this}stackShapes(n,r,s){const i=typeof n[0]=="string"?n:n.map(b=>b.id);if(this.getInstanceState().isReadonly)return this;const a=Rt(i.map(b=>this.getShape(b)).filter(b=>!(!b||this.isShapeOfType(b,"arrow")&&(b.props.start.type==="binding"||b.props.end.type==="binding")))),l=a.length;if(s===0&&l<3||l<2)return this;const c=Object.fromEntries(a.map(b=>[b.id,this.getShapePageBounds(b)]));let u,f,h,d;r==="horizontal"?(u="x",f="minX",h="maxX",d="width"):(u="y",f="minY",h="maxY",d="height");let p;if(s===0){const b=[];a.sort((v,x)=>c[v.id][f]-c[x.id][f]);for(let v=0;v<l-1;v++){const x=a[v],S=a[v+1],w=c[x.id],j=c[S.id][f]-w[h],P=b.find(M=>M.gap===j);P?P.count++:b.push({gap:j,count:1})}let y=0;b.forEach(v=>{v.count>y&&(y=v.count,p=v.gap)}),y===1&&(p=Math.max(0,b.reduce((v,x)=>v+x.gap*x.count,0)/(l-1)))}else p=s;const m=[];let g=c[a[0].id][h];return a.forEach((b,y)=>{var E,j;if(y===0)return;const v={x:0,y:0};v[u]=g+p-c[b.id][u];const x=this.getShapeParent(b),S=x?Y.Rot(v,-this.getShapePageTransform(x).decompose().rotation):v,w=(j=(E=this.getShapeUtil(b)).onTranslateStart)==null?void 0:j.call(E,b);m.push(w?{...w,[u]:b[u]+S[u]}:{id:b.id,type:b.type,[u]:b[u]+S[u]}),g+=c[b.id][d]+p}),this.updateShapes(m),this}packShapes(n,r){var j,P;const s=typeof n[0]=="string"?n:n.map(M=>M.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=Rt(s.map(M=>this.getShape(M)).filter(M=>!(!M||this.isShapeOfType(M,"arrow")&&(M.props.start.type==="binding"||M.props.end.type==="binding")))),a={},l={};let c,u,f=0;for(let M=0;M<i.length;M++)c=i[M],u=this.getShapePageBounds(c),a[c.id]=u,l[c.id]=u.clone(),f+=u.width*u.height;const h=mt.Common(Rt(Object.values(a))),d=h.width;i.sort((M,O)=>a[O.id].height-a[M.id].height);const p=Math.max(Math.ceil(Math.sqrt(f/.95)),d),m=[new mt(h.x,h.y,p,1/0)];let g=0,b=0,y,v;for(let M=0;M<i.length;M++){c=i[M],u=l[c.id];for(let O=m.length-1;O>=0;O--)if(y=m[O],!(u.width>y.width||u.height>y.height)){u.x=y.x,u.y=y.y,b=Math.max(b,u.maxY),g=Math.max(g,u.maxX),u.width===y.width&&u.height===y.height?(v=m.pop(),O<m.length&&(m[O]=v)):u.height===y.height?(y.x+=u.width+r,y.width-=u.width+r):u.width===y.width?(y.y+=u.height+r,y.height-=u.height+r):(m.push(new mt(y.x+(u.width+r),y.y,y.width-(u.width+r),u.height)),y.y+=u.height+r,y.height-=u.height+r);break}}const x=mt.Common(Object.values(l)),S=Y.Sub(h.center,x.center);let w;const E=[];for(let M=0;M<i.length;M++){c=i[M],u=a[c.id],w=l[c.id];const O=Y.Sub(w.point,u.point).add(S),k=this.getShapeParentTransform(c);k&&O.rot(-k.rotation());const F={id:c.id,type:c.type,x:c.x+O.x,y:c.y+O.y},A=(P=(j=this.getShapeUtil(c)).onTranslateStart)==null?void 0:P.call(j,{...c,...F});A?E.push({...F,...A}):E.push(F)}return E.length&&this.updateShapes(E),this}alignShapes(n,r){const s=typeof n[0]=="string"?n:n.map(u=>u.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=Rt(s.map(u=>this.getShape(u))),a=Object.fromEntries(i.map(u=>[u.id,this.getShapePageBounds(u)])),l=mt.Common(Rt(Object.values(a))),c=[];return i.forEach(u=>{const f=a[u.id];if(!f)return;const h={x:0,y:0};switch(r){case"top":{h.y=l.minY-f.minY;break}case"center-vertical":{h.y=l.midY-f.minY-f.height/2;break}case"bottom":{h.y=l.maxY-f.minY-f.height;break}case"left":{h.x=l.minX-f.minX;break}case"center-horizontal":{h.x=l.midX-f.minX-f.width/2;break}case"right":{h.x=l.maxX-f.minX-f.width;break}}const d=this.getShapeParent(u),p=d?Y.Rot(h,-this.getShapePageTransform(d).decompose().rotation):h;c.push(this.getChangesToTranslateShape(u,Y.Add(u,p)))}),this.updateShapes(c),this}distributeShapes(n,r){const s=typeof n[0]=="string"?n:n.map(x=>x.id);if(this.getInstanceState().isReadonly)return this;if(s.length<3)return this;const i=s.length,a=Rt(s.map(x=>this.getShape(x))),l=Object.fromEntries(a.map(x=>[x.id,this.getShapePageBounds(x)]));let c,u,f,h,d;r==="horizontal"?(c="x",u="minX",f="maxX",h="midX",d="width"):(c="y",u="minY",f="maxY",h="midY",d="height");const p=[],m=a.sort((x,S)=>l[x.id][u]-l[S.id][u])[0],g=a.sort((x,S)=>l[S.id][f]-l[x.id][f])[0],b=l[m.id][h],y=(l[g.id][h]-b)/(i-1),v=b+y;return a.filter(x=>x!==m&&x!==g).sort((x,S)=>l[x.id][h]-l[S.id][h]).forEach((x,S)=>{const w={x:0,y:0};w[c]=v+y*S-l[x.id][d]/2-l[x.id][c];const E=this.getShapeParent(x),j=E?Y.Rot(w,-this.getShapePageTransform(E).rotation()):w;p.push(this.getChangesToTranslateShape(x,Y.Add(x,j)))}),this.updateShapes(p),this}stretchShapes(n,r){const s=typeof n[0]=="string"?n:n.map(u=>u.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=Rt(s.map(u=>this.getShape(u))),a=Object.fromEntries(s.map(u=>[u,this.getShapeGeometry(u).bounds])),l=Object.fromEntries(s.map(u=>[u,this.getShapePageBounds(u)])),c=mt.Common(Rt(Object.values(l)));switch(r){case"vertical":{this.batch(()=>{for(const u of i){if(this.getShapePageTransform(u).rotation()%or)continue;const h=a[u.id],d=l[u.id],p=new Y(0,c.minY-d.minY),m=this.getShapeParentTransform(u);m&&p.rot(-m.rotation());const{x:g,y:b}=Y.Add(p,u);this.updateShapes([{id:u.id,type:u.type,x:g,y:b}],{squashing:!0});const y=new Y(1,c.height/d.height);this.resizeShape(u.id,y,{initialBounds:h,scaleOrigin:new Y(d.center.x,c.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const u of i){const f=a[u.id],h=l[u.id];if(this.getShapePageTransform(u).rotation()%or)continue;const p=new Y(c.minX-h.minX,0),m=this.getShapeParentTransform(u);m&&p.rot(-m.rotation());const{x:g,y:b}=Y.Add(p,u);this.updateShapes([{id:u.id,type:u.type,x:g,y:b}],{squashing:!0});const y=new Y(c.width/h.width,1);this.resizeShape(u.id,y,{initialBounds:f,scaleOrigin:new Y(c.minX,h.center.y),scaleAxisRotation:0})}});break}}return this}resizeShape(n,r,s={}){var p;const i=typeof n=="string"?n:n.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(r.x)||(r=new Y(1,r.y)),Number.isFinite(r.y)||(r=new Y(r.x,1));const a=s.initialShape??this.getShape(i);if(!a)return this;const l=s.scaleOrigin??((p=this.getShapePageBounds(i))==null?void 0:p.center);if(!l)return this;const c=s.initialPageTransform?vt.Cast(s.initialPageTransform):this.getShapePageTransform(i);if(!c)return this;const u=c.rotation();if(u==null)return this;const f=s.scaleAxisRotation??u,h=s.initialBounds??this.getShapeGeometry(i).bounds;if(!h)return this;if(!Hk(u,f))return this._resizeUnalignedShape(i,r,{...s,initialBounds:h,scaleOrigin:l,scaleAxisRotation:f,initialPageTransform:c,initialShape:a});const d=this.getShapeUtil(a);if(d.isAspectRatioLocked(a)&&(Math.abs(r.x)>Math.abs(r.y)?r=new Y(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new Y(Math.sign(r.x)*Math.abs(r.y),r.y)),d.onResize&&d.canResize(a)){const m=this._scalePagePoint(vt.applyToPoint(c,new Y(0,0)),l,r,f),g=this.getPointInParentSpace(a.id,m),b=new Y(r.x,r.y),y=Bd((u-f)%Math.PI,0);b.x=y?r.x:r.y,b.y=y?r.y:r.x;const v=vt.applyToPoint(c,new Y),{x,y:S}=this.getPointInParentSpace(a.id,v);this.updateShapes([{id:i,type:a.type,x:g.x,y:g.y,...d.onResize({...a,x,y:S},{newPoint:g,handle:s.dragHandle??"bottom_right",mode:s.mode??"scale_shape",scaleX:b.x,scaleY:b.y,initialBounds:h,initialShape:a})}],{squashing:!0})}else{const m=vt.applyToPoint(c,h.center),g=this._scalePagePoint(m,l,r,f),b=this.getPointInParentSpace(a.id,m),y=this.getPointInParentSpace(a.id,g),v=Y.Sub(y,b);this.updateShapes([{id:i,type:a.type,x:a.x+v.x,y:a.y+v.y}],{squashing:!0})}return this}_scalePagePoint(n,r,s,i){const a=Y.RotWith(n,r,-i).sub(r),l=Y.MulV(a,s);return Y.Add(l,r).rotWith(r,i)}_resizeUnalignedShape(n,r,s){const{type:i}=s.initialShape,a=new Y(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?a.x=Math.sign(r.x)*Math.abs(r.y):a.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(n,a,{initialShape:s.initialShape,initialBounds:s.initialBounds}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:y}=vt.Decompose(s.initialPageTransform);y-=2*y,this.updateShapes([{id:n,type:i,rotation:y}],{squashing:!0})}const l=vt.applyToPoint(s.initialPageTransform,s.initialBounds.center),c=this._scalePagePoint(l,s.scaleOrigin,r,s.scaleAxisRotation),u=this.getShapePageBounds(n),f=this.getShapePageTransform(n),h=u.center,d=f.point();if(!h||!d)return this;const p=Y.Sub(c,h),m=Y.Add(d,p),{x:g,y:b}=this.getPointInParentSpace(n,m);return this.updateShapes([{id:n,type:i,x:g,y:b}],{squashing:!0}),this}getInitialMetaForShape(n){return{}}createShape(n){return this._createShapes([n]),this}createShapes(n){if(!Array.isArray(n))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");return this._createShapes(n),this}animateShape(n,r){return this.animateShapes([n],r)}animateShapes(n,r={}){const{duration:s=500,easing:i=Kn.linear}=r,a=Mr();let l=s,c;const u=[];let f,h;for(let m=0,g=n.length;m<g;m++){if(f=n[m],!f)continue;h={partial:f,values:[]};const b=this.getShape(f.id);if(b){for(const y of["x","y","rotation"])f[y]!==void 0&&b[y]!==f[y]&&h.values.push({prop:y,from:b[y],to:f[y]});u.push(h),this.animatingShapes.set(b.id,a)}}let d;const p=m=>{if(l-=m,l<0){const{animatingShapes:v}=this,x=n.filter(S=>S&&v.get(S.id)===a);x.length&&this.updateShapes(x,{squashing:!1}),this.removeListener("tick",p);return}c=i(1-l/s);const{animatingShapes:g}=this,b=[];let y;for(let v=0,x=u.length;v<x;v++)d=u[v],y=g.get(d.partial.id),y===a&&b.push({id:d.partial.id,type:d.partial.type,...d.values.reduce((S,{prop:w,from:E,to:j})=>(S[w]=E+(j-E)*c,S),{})});this._updateShapes(b,{squashing:!0})};return this.addListener("tick",p),this}groupShapes(n,r=hr()){var p;if(!Array.isArray(n))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const s=typeof n[0]=="string"?n:n.map(m=>m.id);if(s.length<=1)return this;const i=Rt(this._getUnlockedShapeIds(s).map(m=>this.getShape(m))),a=i.sort(qn).map(m=>m.id),l=mt.Common(Rt(i.map(m=>this.getShapePageBounds(m)))),{x:c,y:u}=l.point,f=this.findCommonAncestor(i)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const h=i.filter(m=>m.parentId===f).sort(qn),d=(p=h[h.length-1])==null?void 0:p.index;return this.batch(()=>{this.createShapes([{id:r,type:"group",parentId:f,index:d,x:c,y:u,opacity:1,props:{}}]),this.reparentShapes(a,r),this.select(r)}),this}ungroupShapes(n){const r=typeof n[0]=="string"?n:n.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;if(r.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const s=new Set,i=Rt(r.map(l=>this.getShape(l))),a=[];return i.forEach(l=>{this.isShapeOfType(l,"group")?a.push(l):s.add(l.id)}),a.length===0?this:(this.batch(()=>{let l;for(let c=0,u=a.length;c<u;c++){l=a[c];const f=this.getSortedChildIdsForParent(l.id);for(let h=0,d=f.length;h<d;h++)s.add(f[h]);this.reparentShapes(f,l.parentId,l.index)}this.deleteShapes(a.map(c=>c.id)),this.select(...s)}),this)}updateShape(n,r){return this.updateShapes([n],r),this}updateShapes(n,r){const s=Array(n.length);for(let i=0,a=n.length;i<a;i++){const l=n[i];if(!l)continue;const c=this.getShape(l.id);c&&(this.isShapeOrAncestorLocked(c)&&!Object.hasOwn(l,"isLocked")||(this.animatingShapes.delete(l.id),s.push(l)))}return this._updateShapes(s,r),this}_getUnlockedShapeIds(n){return n.filter(r=>{var s;return!((s=this.getShape(r))!=null&&s.isLocked)})}deleteShapes(n){if(!Array.isArray(n))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");return this._deleteShapes(this._getUnlockedShapeIds(typeof n[0]=="string"?n:n.map(r=>r.id))),this}deleteShape(n){return this.deleteShapes([typeof n=="string"?n:n.id]),this}_extractSharedStyles(n,r){if(this.isShapeOfType(n,"group")){const s=this._parentIdsToChildIds.get()[n.id];if(!s)return;for(let i=0,a=s.length;i<a;i++)this._extractSharedStyles(this.getShape(s[i]),r)}else for(const[s,i]of this.styleProps[n.type])r.applyValue(s,Us(n.props,i))}_getSelectionSharedStyles(){const n=this.getSelectedShapes(),r=new o1;for(const s of n)this._extractSharedStyles(s,r);return r}getStyleForNextShape(n){const r=this.getInstanceState().stylesForNextShape[n.id];return r===void 0?n.defaultValue:r}getShapeStyleIfExists(n,r){const s=this.styleProps[n.type].get(r);if(s!==void 0)return Us(n.props,s)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._getSelectionSharedStyles();const n=this.root.getCurrent(),r=new o1;if(!n)return r;if(n.shapeType)for(const s of this.styleProps[n.shapeType].keys())r.applyValue(s,this.getStyleForNextShape(s));return r}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const n=[],r=i=>{const a=this.getShape(i);if(a)if(this.isShapeOfType(a,"group"))for(const l of this.getSortedChildIdsForParent(a.id))r(l);else n.push(a)};for(const i of this.getSelectedShapeIds())r(i);let s=null;for(const i of n)if(s===null)s=i.opacity;else if(s!==i.opacity)return{type:"mixed"};if(s!==null)return{type:"shared",value:s}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(n,r){return this.updateInstanceState({opacityForNextShape:n},r),this}setOpacityForSelectedShapes(n,r){const s=this.getSelectedShapes();if(s.length>0){const i=[],a=l=>{if(this.isShapeOfType(l,"group")){const c=this.getSortedChildIdsForParent(l);for(const u of c)a(this.getShape(u))}else i.push(l)};for(const l of s)a(l);this.updateShapes(i.map(l=>({id:l.id,type:l.type,opacity:n})),r)}return this}setStyleForNextShapes(n,r,s){const i=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...i,[n.id]:r}},s),this}setStyleForSelectedShapes(n,r,s){const i=this.getSelectedShapes();if(i.length>0){const a=[],l=c=>{if(this.isShapeOfType(c,"group")){const u=this.getSortedChildIdsForParent(c.id);for(const f of u)l(this.getShape(f))}else{const u=this.getShapeUtil(c),f=this.styleProps[c.type].get(n);if(f){const h={id:c.id,type:c.type,props:{[f]:r}};a.push({util:u,originalShape:c,updatePartial:h})}}};for(const c of i)l(c);this.updateShapes(a.map(({updatePartial:c})=>c),s)}return this}registerExternalAssetHandler(n,r){return this.externalAssetContentHandlers[n]=r,this}async getAssetForExternalContent(n){var r,s;return await((s=(r=this.externalAssetContentHandlers)[n.type])==null?void 0:s.call(r,n))}registerExternalContentHandler(n,r){return this.externalContentHandlers[n]=r,this}async putExternalContent(n){var r,s;return(s=(r=this.externalContentHandlers)[n.type])==null?void 0:s.call(r,n)}getContentFromCurrentPage(n){const r=typeof n[0]=="string"?n:n.map(c=>c.id);if(!r||r.length===0)return;const s={};let i=Ym(r.map(c=>this.getShape(c)).sort(qn).flatMap(c=>{const u=[c];return this.visitDescendants(c.id,f=>{u.push(this.getShape(f))}),u}));i=i.map(c=>{if(s[c.id]=this.getShapePageTransform(c.id),c=_r(c),this.isShapeOfType(c,"arrow")){const u=c.props.start.type==="binding"?c.props.start.boundShapeId:void 0,f=c.props.end.type==="binding"?c.props.end.boundShapeId:void 0,h=this.getArrowInfo(c);if(c.props.start.type==="binding"&&!i.some(p=>p.id===u))if(h!=null&&h.isValid){const{x:p,y:m}=h.start.point;c.props.start={type:"point",x:p,y:m}}else{const{start:p}=Ls(this,c);c.props.start={type:"point",x:p.x,y:p.y}}if(c.props.end.type==="binding"&&!i.some(p=>p.id===f))if(h!=null&&h.isValid){const{x:p,y:m}=h.end.point;c.props.end={type:"point",x:p,y:m}}else{const{end:p}=Ls(this,c);c.props.end={type:"point",x:p.x,y:p.y}}const d=ld(c)?zd(this,c):D0(this,c);if(h!=null&&h.isValid&&(d!=null&&d.isValid)&&!ld(c)){const p=Y.Med(h.start.handle,h.end.handle),m=Y.Dist(h.middle,p),g=Y.Dist(d.middle,p);c.props.bend<0?c.props.bend+=g-m:c.props.bend-=g-m}return c}return c});const a=[];i.forEach(c=>{if(i.find(u=>u.id===c.parentId)===void 0){const u=this.getShapePageTransform(c.id),f=u.point(),h=u.rotation();c.x=f.x,c.y=f.y,c.rotation=h,c.parentId=this.getCurrentPageId(),a.push(c.id)}});const l=new Set;return i.forEach(c=>{"assetId"in c.props&&c.props.assetId!==null&&l.add(c.props.assetId)}),{shapes:i,rootShapeIds:a,schema:this.store.schema.serialize(),assets:Rt(Array.from(l).map(c=>this.getAsset(c)))}}putContentOntoCurrentPage(n,r={}){var P;if(this.getInstanceState().isReadonly)return this;if(!n.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:s=!1,preserveIds:i=!1,preservePosition:a=!1}=r;let{point:l=void 0}=r;const c=this.getCurrentPageId(),{rootShapeIds:u}=n,f=[],h=[],d={store:{...Object.fromEntries(n.assets.map(M=>[M.id,M])),...Object.fromEntries(n.shapes.map(M=>[M.id,M]))},schema:n.schema},p=this.store.schema.migrateStoreSnapshot(d);if(p.type==="error")throw Error("Could not put content: could not migrate content");for(const M of Object.values(p.value))switch(M.typeName){case"asset":{f.push(M);break}case"shape":{h.push(M);break}}const m=new Map(h.map(M=>[M.id,hr()]));let g=this.getCurrentPageId(),b=1/0,y=[];for(const M of this.getSelectedShapes()){if(b===0)break;const O=this.isShapeOfType(M,"frame"),k=this.getShapeAncestors(M);O&&k.push(M);const F=O?k.length+1:k.length;if(F<b)b=F,y=k,g=O?M.id:M.parentId;else if(F===b){if(y.length!==k.length)throw Error(`Ancestors: ${y.length} !== ${k.length}`);if(y.length===0){g=c;break}else{g=c;for(let A=0;A<y.length&&k[A]===y[A];A++)g=k[A].id}}}let v=!1;if(!_o(g)){const M=this.getShape(g);if(M){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(M)))g=c;else if(u.length===1){const O=h.find(k=>k.id===u[0]);this.isShapeOfType(M,"frame")&&this.isShapeOfType(O,"frame")&&O.props.w===(M==null?void 0:M.props.w)&&O.props.h===(M==null?void 0:M.props.h)&&(v=!0)}}else g=c}v||(v=m.has(g)),v&&(g=this.getShape(g).parentId);let x=this.getHighestIndexForParent(g);const S=[],w=h.map(M=>{let O;if(i)O=_r(M),m.set(M.id,M.id);else{const k=m.get(M.id);O=_r({...M,id:k})}if(u.includes(M.id)&&(O.parentId=c,S.push(O)),m.has(O.parentId)?O.parentId=m.get(M.parentId):(u.push(O.id),O.index=x,x=Ii(x)),this.isShapeOfType(O,"arrow")){if(O.props.start.type==="binding"){const k=m.get(O.props.start.boundShapeId);O.props.start=k?{...O.props.start,boundShapeId:k}:{type:"point",x:0,y:0}}if(O.props.end.type==="binding"){const k=m.get(O.props.end.boundShapeId);O.props.end=k?{...O.props.end,boundShapeId:k}:{type:"point",x:0,y:0}}}return O});if(w.length+this.getCurrentPageShapeIds().size>Ei)return zf(this),this;const E=[],j=[];for(const M of f)this.store.has(M.id)||((M.type==="image"||M.type==="video")&&((P=M.props.src)!=null&&P.startsWith("data:image"))&&(j.push(_r(M)),M.props.src=null),E.push(M));return Promise.allSettled(j.map(async M=>{const O=await H$(M.props.src,M.props.name,M.props.mimeType??"image/png"),k=await this.getAssetForExternalContent({type:"file",file:O});if(!k){this.deleteAssets([M.id]);return}this.updateAssets([{...k,id:M.id}])})),this.batch(()=>{E.length>0&&this.createAssets(E),this.createShapes(w),s&&this.select(...S.map(A=>A.id)),g!==c&&this.reparentShapes(S.map(A=>A.id),g);const M=w.map(A=>this.getShape(A.id)),O=mt.Common(M.map(A=>this.getShapePageBounds(A)));if(l===void 0)if(_o(g)){const A=this.getViewportPageBounds();a||A.includes(mt.From(O))?l=O.center:l=A.center}else{const A=this.getShape(g);l=vt.applyToPoint(this.getShapePageTransform(A),this.getShapeGeometry(A).bounds.center)}if(S.length===1){const A=S[0];if(this.isShapeOfType(A,"frame"))for(;this.getShapesAtPoint(l).some(N=>this.isShapeOfType(N,"frame")&&N.props.w===A.props.w&&N.props.h===A.props.h);)l.x+=O.w+16}const k=mt.Common(Rt(S.map(({id:A})=>this.getShapePageBounds(A)))).center,F=Y.Sub(l,k);this.updateShapes(S.map(({id:A})=>{const N=this.getShape(A),$=this.getShapeParentTransform(A).decompose().rotation,G=Y.Rot(F,-$);return{id:N.id,type:N.type,x:N.x+G.x,y:N.y+G.y}}))}),this}async getSvgElement(n,r={}){const s=await nU(this,n,r);if(!s)return;const i=document.createDocumentFragment(),a=RT(i);Zl.flushSync(()=>{a.render(s.jsx)});const l=i.firstElementChild;return bn(l instanceof SVGSVGElement,"Expected an SVG element"),a.unmount(),{svg:l,width:s.width,height:s.height}}async getSvgString(n,r={}){const s=await this.getSvgElement(n,r);return s?{svg:new XMLSerializer().serializeToString(s.svg),width:s.width,height:s.height}:void 0}async getSvg(n,r={}){const s=await this.getSvgElement(n,r);if(s)return s.svg}_updateInputsFromEvent(n){var y;const{pointerVelocity:r,previousScreenPoint:s,previousPagePoint:i,currentScreenPoint:a,currentPagePoint:l}=this.inputs,{screenBounds:c}=this.store.unsafeGetWithoutCapture(Co),{x:u,y:f,z:h}=this.store.unsafeGetWithoutCapture(this.getCameraId()),d=n.point.x-c.x,p=n.point.y-c.y,m=n.point.z??.5;s.setTo(a),i.setTo(l),a.set(d,p);const g=d/h-u,b=p/h-f;isFinite(g)&&isFinite(b)&&l.set(g,b,m),this.inputs.isPen=n.type==="pointer"&&n.isPen,(n.name==="pointer_down"||this.inputs.isPinching)&&r.set(0,0),this.store.put([{id:eg,typeName:"pointer",x:l.x,y:l.y,lastActivityTimestamp:n.type==="pointer"&&n.pointerId===S2.CAMERA_MOVE?((y=this.store.unsafeGetWithoutCapture(eg))==null?void 0:y.lastActivityTimestamp)??this._tickManager.now:this._tickManager.now,meta:{}}])}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_flushEventsForTick(n){this.batch(()=>{if(this._pendingEventsForNextTick.length>0){const r=[...this._pendingEventsForNextTick];this._pendingEventsForNextTick.length=0;for(const s of r)this._flushEventForTick(s)}n>0&&this.root.handleEvent({type:"misc",name:"tick",elapsed:n}),this.scribbles.tick(n)})}}gt([Xe],ft.prototype,"getCanUndo",1);gt([Xe],ft.prototype,"getCanRedo",1);gt([Xe],ft.prototype,"_getArrowBindingsIndex",1);gt([Xe],ft.prototype,"getArrowInfoCache",1);gt([Xe],ft.prototype,"getPath",1);gt([Xe],ft.prototype,"getCurrentTool",1);gt([Xe],ft.prototype,"getCurrentToolId",1);gt([Xe],ft.prototype,"getDocumentSettings",1);gt([Xe],ft.prototype,"getInstanceState",1);gt([Xe],ft.prototype,"getOpenMenus",1);gt([Xe],ft.prototype,"getIsMenuOpen",1);gt([Xe],ft.prototype,"getPageStates",1);gt([Xe],ft.prototype,"_getPageStatesQuery",1);gt([Xe],ft.prototype,"getCurrentPageState",1);gt([Xe],ft.prototype,"_getCurrentPageStateId",1);gt([Xe],ft.prototype,"getSelectedShapeIds",1);gt([Xe],ft.prototype,"getSelectedShapes",1);gt([Xe],ft.prototype,"getOnlySelectedShapeId",1);gt([Xe],ft.prototype,"getOnlySelectedShape",1);gt([Xe],ft.prototype,"getSelectionPageBounds",1);gt([Xe],ft.prototype,"getSelectionRotation",1);gt([Xe],ft.prototype,"getSelectionRotatedPageBounds",1);gt([Xe],ft.prototype,"getSelectionRotatedScreenBounds",1);gt([Xe],ft.prototype,"getFocusedGroupId",1);gt([Xe],ft.prototype,"getFocusedGroup",1);gt([Xe],ft.prototype,"getEditingShapeId",1);gt([Xe],ft.prototype,"getEditingShape",1);gt([Xe],ft.prototype,"getHoveredShapeId",1);gt([Xe],ft.prototype,"getHoveredShape",1);gt([Xe],ft.prototype,"getHintingShapeIds",1);gt([Xe],ft.prototype,"getHintingShape",1);gt([Xe],ft.prototype,"getErasingShapeIds",1);gt([Xe],ft.prototype,"getErasingShapes",1);gt([Xe],ft.prototype,"getCameraId",1);gt([Xe],ft.prototype,"getCamera",1);gt([Xe],ft.prototype,"getZoomLevel",1);gt([Xe],ft.prototype,"getViewportScreenBounds",1);gt([Xe],ft.prototype,"getViewportScreenCenter",1);gt([Xe],ft.prototype,"getViewportPageBounds",1);gt([Xe],ft.prototype,"getViewportPageCenter",1);gt([Xe],ft.prototype,"_getCollaboratorsQuery",1);gt([Xe],ft.prototype,"getCollaborators",1);gt([Xe],ft.prototype,"getCollaboratorsOnCurrentPage",1);gt([Xe],ft.prototype,"getRenderingShapes",1);gt([Xe],ft.prototype,"_getAllPagesQuery",1);gt([Xe],ft.prototype,"getPages",1);gt([Xe],ft.prototype,"getCurrentPageId",1);gt([Xe],ft.prototype,"getCurrentPageShapeIdsSorted",1);gt([Xe],ft.prototype,"_getAllAssetsQuery",1);gt([Xe],ft.prototype,"_getShapeGeometryCache",1);gt([Xe],ft.prototype,"_getShapeHandlesCache",1);gt([Xe],ft.prototype,"_getShapePageTransformCache",1);gt([Xe],ft.prototype,"_getShapePageBoundsCache",1);gt([Xe],ft.prototype,"_getShapeClipPathCache",1);gt([Xe],ft.prototype,"_getShapeMaskCache",1);gt([Xe],ft.prototype,"_getShapeMaskedPageBoundsCache",1);gt([Xe],ft.prototype,"_notVisibleShapes",1);gt([Xe],ft.prototype,"getCulledShapes",1);gt([Xe],ft.prototype,"getCurrentPageBounds",1);gt([Xe],ft.prototype,"getCurrentPageShapes",1);gt([Xe],ft.prototype,"getCurrentPageShapesSorted",1);gt([Xe],ft.prototype,"getCurrentPageRenderingShapesSorted",1);gt([Xe],ft.prototype,"_getSelectionSharedStyles",1);gt([Xe({isEqual:(t,o)=>t.equals(o)})],ft.prototype,"getSharedStyles",1);gt([Xe],ft.prototype,"getSharedOpacity",1);function zf(t,o=t.getCurrentPageId()){const n=t.getPage(o).name;t.emit("max-shapes",{name:n,pageId:o,count:Ei})}function cd(t,o){if(!o)return t;let n=null;const r=Object.entries(o);for(let s=0,i=r.length;s<i;s++){const[a,l]=r[s];if(l!==void 0&&!(a==="id"||a==="type"||a==="typeName")&&l!==t[a]){if(n||(n={...t}),a==="props"||a==="meta"){n[a]={...t[a]};for(const[c,u]of Object.entries(l))u!==void 0&&(n[a][c]=u);continue}n[a]=l}}return n||t}function FI(t,o,n){const r=t.getShape(o);if(!r)return;n.push(r);const s=t.getSortedChildIdsForParent(o);for(let i=0,a=s.length;i<a;i++)FI(t,s[i],n)}function Wh(){const t=Ue(),o=DI();return He("isDarkMode",()=>(o==null?void 0:o.isDarkMode)??t.user.getIsDarkMode(),[o,t])}const ej="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",tj="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Gf='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function ma(t,o,n,r,s,i=16,a=16){const l=(-n-o)*(Yt/180),c=Math.sin(l),u=Math.cos(l),f=1*u-1*c,h=1*c+1*u;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${s};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${f}' dy='${h}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${o+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+`</g></svg>") ${i} ${a}, pointer`}const AU=["default","pointer","cross","move","grab","grabbing","text","zoom-in","zoom-out"],RU={none:()=>"none","ew-resize":(t,o,n)=>ma(tj,t,0,o,n),"ns-resize":(t,o,n)=>ma(tj,t,90,o,n),"nesw-resize":(t,o,n)=>ma(ej,t,0,o,n),"nwse-resize":(t,o,n)=>ma(ej,t,90,o,n),"nwse-rotate":(t,o,n)=>ma(Gf,t,0,o,n),"nesw-rotate":(t,o,n)=>ma(Gf,t,90,o,n),"senw-rotate":(t,o,n)=>ma(Gf,t,180,o,n),"swne-rotate":(t,o,n)=>ma(Gf,t,270,o,n)};function Bo(t,o=0,n="black"){return RU[t](O6(o),!1,n)}function DU(){const t=Ue(),o=to(),n=Wh();Fa("useCursor",()=>{const{type:r,rotation:s}=t.getInstanceState().cursor;if(AU.includes(r)){o.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}o.style.setProperty("--tl-cursor",Bo(r,s,n?"white":"black"))},[t,o,n])}function LU(){const t=Ue(),o=to(),n=Wh(),r=He(wn.forceSrgb);Ut.useEffect(()=>{n?(o.setAttribute("data-color-mode","dark"),o.classList.remove("tl-theme__light"),o.classList.add("tl-theme__dark")):(o.setAttribute("data-color-mode","light"),o.classList.remove("tl-theme__dark"),o.classList.add("tl-theme__light")),r?o.classList.add("tl-theme__force-sRGB"):o.classList.remove("tl-theme__force-sRGB")},[t,o,r,n])}function SS(t){const o=B.useRef();return B.useLayoutEffect(()=>{o.current=t}),B.useDebugValue(t),B.useCallback((...n)=>{const r=o.current;return bn(r,"fn does not exist"),r(...n)},[])}function FU(t){const o=Ue(),n=to();B.useLayoutEffect(()=>{t?(o.getInstanceState().isFocused||o.updateInstanceState({isFocused:!0}),o.getContainer().focus()):o.getInstanceState().isFocused&&o.updateInstanceState({isFocused:!1})},[o,n,t])}function NU(){const[t,o]=B.useState(0);B.useEffect(()=>o(n=>n+1),[])}const ou="TLDRAW_TAB_ID_v2",ai=globalThis.window;function $U(){return ai?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(ai.navigator.platform)||ai.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const gg=ai?ai[ou]??KT(ou)??"TLDRAW_INSTANCE_STATE_V1_"+Mr():"<error>";ai&&(ai[ou]=gg,$U()?Zx(ou,gg):ZT(ou));ai==null||ai.addEventListener("beforeunload",()=>{Zx(ou,gg)});const NI={Initial:0},sy=Math.max(...Object.values(NI));function UU(t){t.version<NI.Initial,t.version=sy}const $I=zt({version:It,currentPageId:hh,isFocusMode:Vt,exportBackground:Vt,isDebugMode:Vt,isToolLocked:Vt,isGridMode:Vt,pageStates:Mn(zt({pageId:hh,camera:zt({x:It,y:It,z:It}),selectedShapeIds:Mn(Is),focusedGroupId:Is.nullable()}))});function BU(t){if(!t||typeof t!="object")return console.warn("Invalid instance state"),null;if(!("version"in t)||typeof t.version!="number")return console.warn("No version in instance state"),null;t.version!==sy&&(t=_r(t),UU(t));try{return $I.validate(t)}catch(o){return console.warn(o),null}}function zU(t){const o=t.query.ids("page");return Xe("sessionStateSnapshot",()=>{const n=t.get(Co);if(!n)return null;const r=[...o.get()];return{version:sy,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(s=>{const i=t.get(Wn.createId(s)),a=t.get(ho.createId(s));return{pageId:s,camera:{x:(a==null?void 0:a.x)??0,y:(a==null?void 0:a.y)??0,z:(a==null?void 0:a.z)??1},selectedShapeIds:(i==null?void 0:i.selectedShapeIds)??[],focusedGroupId:(i==null?void 0:i.focusedGroupId)??null}})}})}function GU(t,o){const n=BU(o);if(!n)return;const r=t.allRecords().filter(a=>a.typeName==="instance_page_state"||a.typeName==="camera"),s={added:{},updated:{},removed:{...Xx(r.map(a=>[a.id,a]))}};t.has(Co)&&(s.removed[Co]=t.get(Co));const i={removed:{},updated:{},added:{[Co]:t.schema.types.instance.create({id:Co,currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground})}};for(const a of n.pageStates){const l=ho.createId(a.pageId),c=Wn.createId(a.pageId);i.added[l]=ho.create({id:ho.createId(a.pageId),x:a.camera.x,y:a.camera.y,z:a.camera.z}),i.added[c]=Wn.create({id:Wn.createId(a.pageId),pageId:a.pageId,selectedShapeIds:a.selectedShapeIds,focusedGroupId:a.focusedGroupId})}Rs(()=>{t.applyDiff(Xg([s,i])),t.ensureStoreIsUsable()})}function VU(t){var s;const o=[];for(const i of Object.values(t))(s=i.typeName)!=null&&s.match(/^(instance.*|pointer|camera)$/)&&o.push(i);const n=o.filter(i=>i.typeName==="instance"&&i.id!==Co)[0];if(!n)return null;const r={version:sy,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:o.filter(i=>i.typeName==="instance_page_state"&&i.instanceId===n.id).map(i=>{const a=t[i.cameraId]??{x:0,y:0,z:1};return{pageId:i.pageId,camera:{x:a.x,y:a.y,z:a.z},selectedShapeIds:i.selectedShapeIds,focusedGroupId:i.focusedGroupId}})};try{return $I.validate(r),r}catch{return null}}function HU(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
• If your hard disk is full, try clearing up some space and then reload the page.`)}function WU(){window.alert(`Oops! We could not access your browser's storage—and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const YU=(t,o)=>o.some(n=>t instanceof n);let rj,nj;function XU(){return rj||(rj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qU(){return nj||(nj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const UI=new WeakMap,s1=new WeakMap,BI=new WeakMap,L0=new WeakMap,wS=new WeakMap;function KU(t){const o=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Li(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return o.then(n=>{n instanceof IDBCursor&&UI.set(n,t)}).catch(()=>{}),wS.set(o,t),o}function ZU(t){if(s1.has(t))return;const o=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});s1.set(t,o)}let i1={get(t,o,n){if(t instanceof IDBTransaction){if(o==="done")return s1.get(t);if(o==="objectStoreNames")return t.objectStoreNames||BI.get(t);if(o==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Li(t[o])},set(t,o,n){return t[o]=n,!0},has(t,o){return t instanceof IDBTransaction&&(o==="done"||o==="store")?!0:o in t}};function QU(t){i1=t(i1)}function JU(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(o,...n){const r=t.call(F0(this),o,...n);return BI.set(r,o.sort?o.sort():[o]),Li(r)}:qU().includes(t)?function(...o){return t.apply(F0(this),o),Li(UI.get(this))}:function(...o){return Li(t.apply(F0(this),o))}}function eB(t){return typeof t=="function"?JU(t):(t instanceof IDBTransaction&&ZU(t),YU(t,XU())?new Proxy(t,i1):t)}function Li(t){if(t instanceof IDBRequest)return KU(t);if(L0.has(t))return L0.get(t);const o=eB(t);return o!==t&&(L0.set(t,o),wS.set(o,t)),o}const F0=t=>wS.get(t);function tB(t,o,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,o),l=Li(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Li(a.result),c.oldVersion,c.newVersion,Li(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}function rB(t,{blocked:o}={}){const n=indexedDB.deleteDatabase(t);return o&&n.addEventListener("blocked",r=>o(r.oldVersion,r)),Li(n).then(()=>{})}const nB=["get","getKey","getAll","getAllKeys","count"],oB=["put","add","delete","clear"],N0=new Map;function oj(t,o){if(!(t instanceof IDBDatabase&&!(o in t)&&typeof o=="string"))return;if(N0.get(o))return N0.get(o);const n=o.replace(/FromIndex$/,""),r=o!==n,s=oB.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||nB.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return N0.set(o,i),i}QU(t=>({...t,get:(o,n,r)=>oj(o,n)||t.get(o,n,r),has:(o,n)=>!!oj(o,n)||t.has(o,n)}));const iy="TLDRAW_DOCUMENT_v2",zI="TLDRAW_DB_NAME_INDEX_v2",ar={Records:"records",Schema:"schema",SessionState:"session_state"};async function ay(t,o){cB(t);const n=await tB(t,3,{upgrade(r){r.objectStoreNames.contains(ar.Records)||r.createObjectStore(ar.Records),r.objectStoreNames.contains(ar.Schema)||r.createObjectStore(ar.Schema),r.objectStoreNames.contains(ar.SessionState)||r.createObjectStore(ar.SessionState)}});try{return await o(n)}finally{n.close()}}async function sB({persistenceKey:t,sessionId:o,didCancel:n}){const r=iy+t;if(_S().includes(r))return await lB({persistenceKey:t,didCancel:n}),await ay(r,async s=>{var h,d;if(n!=null&&n())return;const i=s.transaction([ar.Records,ar.Schema,ar.SessionState],"readonly"),a=i.objectStore(ar.Records),l=i.objectStore(ar.Schema),c=i.objectStore(ar.SessionState);let u=o?(h=await c.get(o))==null?void 0:h.snapshot:null;u||(u=(d=(await c.getAll()).sort((m,g)=>m.updatedAt-g.updatedAt).pop())==null?void 0:d.snapshot);const f={records:await a.getAll(),schema:await l.get(ar.Schema),sessionStateSnapshot:u};if(n!=null&&n()){i.abort();return}return await i.done,f})}async function iB({persistenceKey:t,schema:o,changes:n,sessionId:r,sessionStateSnapshot:s,didCancel:i}){const a=iy+t;await ay(a,async l=>{const c=l.transaction([ar.Records,ar.Schema,ar.SessionState],"readwrite"),u=c.objectStore(ar.Records),f=c.objectStore(ar.Schema),h=c.objectStore(ar.SessionState);for(const[d,p]of Object.entries(n.added))await u.put(p,d);for(const[d,p]of Object.values(n.updated))await u.put(p,p.id);for(const d of Object.keys(n.removed))await u.delete(d);if(f.put(o.serialize(),ar.Schema),s&&r?h.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),i!=null&&i())return c.abort();await c.done})}async function aB({persistenceKey:t,schema:o,snapshot:n,sessionId:r,sessionStateSnapshot:s,didCancel:i}){const a=iy+t;await ay(a,async l=>{const c=l.transaction([ar.Records,ar.Schema,ar.SessionState],"readwrite"),u=c.objectStore(ar.Records),f=c.objectStore(ar.Schema),h=c.objectStore(ar.SessionState);await u.clear();for(const[d,p]of Object.entries(n))await u.put(p,d);if(f.put(o.serialize(),ar.Schema),s&&r?h.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),i!=null&&i())return c.abort();await c.done})}async function lB({persistenceKey:t,didCancel:o}){await ay(iy+t,async n=>{const r=n.transaction([ar.SessionState],"readwrite"),s=r.objectStore(ar.SessionState),i=(await s.getAll()).sort((l,c)=>l.updatedAt-c.updatedAt);if(i.length<10){await r.done;return}const a=i.slice(0,i.length-10);for(const{id:l}of a)await s.delete(l);if(o!=null&&o())return r.abort();await r.done})}function _S(){const t=JSON.parse(qx(zI)||"[]")??[];return Array.isArray(t)?t:[]}function cB(t){const o=new Set(_S());o.add(t),Kx(zI,JSON.stringify([...o]))}const uB=350,dB=1e4,sj=Symbol("UPDATE_INSTANCE_STATE"),hB=t=>t;class fB{constructor(o){D(this,"onmessage")}postMessage(o){}close(){}}const pB=typeof BroadcastChannel>"u"?fB:BroadcastChannel;class mB{constructor(o,{persistenceKey:n,sessionId:r=gg,onLoad:s,onLoadError:i},a=new pB(`tldraw-tab-sync-${n}`)){D(this,"disposables",new Set);D(this,"diffQueue",[]);D(this,"didDispose",!1);D(this,"shouldDoFullDBWrite",!0);D(this,"isReloading",!1);D(this,"persistenceKey");D(this,"sessionId");D(this,"serializedSchema");D(this,"isDebugging",!1);D(this,"documentTypes");D(this,"$sessionStateSnapshot");D(this,"initTime",Date.now());D(this,"isPersisting",!1);D(this,"didLastWriteError",!1);D(this,"scheduledPersistTimeout",null);this.store=o,this.channel=a,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=n,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=zU(this.store),this.disposables.add(o.listen(({changes:l})=>{this.diffQueue.push(l),this.channel.postMessage(hB({type:"diff",storeId:this.store.id,changes:l,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(o.listen(()=>{this.diffQueue.push(sj),this.schedulePersist()},{scope:"session"})),this.connect(s,i),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(l=>l.scope==="document").map(l=>l.typeName))}debug(...o){this.isDebugging&&console.debug(...o)}async connect(o,n){this.debug("connecting");let r;try{r=await sB({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(s){n(s),WU(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const s=Object.fromEntries(r.records.map(l=>[l.id,l])),i=r.sessionStateSnapshot??VU(s),a=this.store.schema.migrateStoreSnapshot({store:s,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(a.type==="error"){console.error("failed to migrate store",a),n(new Error(`Failed to migrate store: ${a.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(a.value).filter(l=>this.documentTypes.has(l.typeName)),"initialize")}),i&&GU(this.store,i)}this.channel.onmessage=({data:s})=>{var l,c;this.debug("got message",s);const i=s,a=this.store.schema.getMigrationsSince(i.schema);if(a.ok){if(a.value.length>0){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}}else{if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(c=(l=window==null?void 0:window.location)==null?void 0:l.reload)==null||c.call(l);return}i.type==="diff"&&(this.debug("applying diff"),Rs(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(i.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),o(this)}catch(s){if(this.debug("error loading data from store",s),this.didDispose)return;n(s);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(o=>o())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?dB:uB))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){bn(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const o=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await aB({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const n=Xg(o.filter(r=>r!==sj));await iB({persistenceKey:this.persistenceKey,changes:n,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),HU(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function gB({initialData:t,defaultName:o="",...n}){const r="schema"in n&&n.schema?n.schema:w6({shapes:yB(OI("shapeUtils"in n&&n.shapeUtils?n.shapeUtils:[])),migrations:"migrations"in n?n.migrations:[]});return new tk({schema:r,initialData:t,props:{defaultName:o}})}function yB(t){return Object.fromEntries(t.map(o=>[o.type,{props:o.props,migrations:o.migrations}]))}function ij(t){const o=gB(t);return t.snapshot&&o.loadSnapshot(t.snapshot),{store:o,opts:t}}function GI(t){const[o,n]=B.useState(()=>ij(t));if(!HT(o.opts,t)){const r=ij(t);return n(r),r.store}return o.store}function vB({persistenceKey:t,sessionId:o,...n}){const[r,s]=B.useState(null),i=GI(n);return B.useEffect(()=>{const a=Mr();if(!t){s({id:a,storeWithStatus:{status:"not-synced",store:i}});return}s({id:a,storeWithStatus:{status:"loading"}});const l=u=>{s(f=>(f==null?void 0:f.id)===a?{id:a,storeWithStatus:u}:f)},c=new mB(i,{sessionId:o,persistenceKey:t,onLoad(){l({store:i,status:"synced-local"})},onLoadError(u){l({status:"error",error:u})}});return()=>{s(u=>(u==null?void 0:u.id)===a?null:u),c.close()}},[t,i,o]),(r==null?void 0:r.storeWithStatus)??{status:"loading"}}let VI=!1;if(typeof window<"u"){const t=window.navigator.userAgent,o=!!t.match(/iPad/i)||!!t.match(/iPhone/i),n=!!t.match(/WebKit/i);VI=o&&n&&!t.match(/CriOS/i)}function bB(){const t=Ue();B.useEffect(()=>{if(!VI)return;function o(n){(n.target instanceof HTMLInputElement&&n.target.type==="text"||n.target instanceof HTMLTextAreaElement)&&t.complete()}return document.addEventListener("focusout",o),()=>document.removeEventListener("focusout",o)},[t])}function xB(){const t=Ue(),o=to();B.useEffect(()=>{const n=i=>o.style.setProperty("--tl-zoom",i.toString()),r=VT(n,100),s=new Tu("useZoomCss",()=>{t.getCurrentPageShapeIds().size<300?n(t.getZoomLevel()):r(t.getZoomLevel())});return s.attach(),s.execute(),()=>{s.detach()}},[t,o])}const SB=[],wB=[],_B=B.memo(function({store:o,components:n,className:r,user:s,...i}){const[a,l]=Ut.useState(null),c=B.useMemo(()=>s??TI(),[s]),u=(n==null?void 0:n.ErrorFallback)===void 0?SI:n==null?void 0:n.ErrorFallback,f={...i,shapeUtils:i.shapeUtils??SB,tools:i.tools??wB,components:n};return C.jsx("div",{ref:l,draggable:!1,className:Tt("tl-container tl-theme__light",r),onPointerDown:Rn,tabIndex:-1,children:C.jsx(mh,{fallback:u,onError:h=>Yx(h,{tags:{origin:"react.tldraw-before-app"}}),children:a&&C.jsx(nF,{container:a,children:C.jsx(j$,{overrides:n,children:o?o instanceof tk?C.jsx(WI,{...f,store:o,user:c}):C.jsx(HI,{...f,store:o,user:c}):C.jsx(jB,{...f,store:o,user:c})})})})})});function jB(t){const{defaultName:o,snapshot:n,initialData:r,shapeUtils:s,persistenceKey:i,sessionId:a,user:l}=t,c=vB({shapeUtils:s,initialData:r,persistenceKey:i,sessionId:a,defaultName:o,snapshot:n});return C.jsx(HI,{...t,store:c,user:l})}const HI=B.memo(function({store:o,user:n,...r}){const s=to();B.useLayoutEffect(()=>{n.userPreferences.get().isDarkMode&&(s.classList.remove("tl-theme__light"),s.classList.add("tl-theme__dark"))},[s,n]);const{LoadingScreen:i}=Vr();switch(o.status){case"error":throw o.error;case"loading":return i?C.jsx(i,{}):null}return C.jsx(WI,{...r,store:o.store,user:n})});function WI({onMount:t,children:o,store:n,tools:r,shapeUtils:s,user:i,initialState:a,autoFocus:l=!0,inferDarkMode:c}){const{ErrorFallback:u}=Vr(),f=to(),[h,d]=B.useState(null);B.useLayoutEffect(()=>{const g=new ft({store:n,shapeUtils:s,tools:r,getContainer:()=>f,user:i,initialState:a,inferDarkMode:c});return d(g),()=>{g.dispose()}},[f,s,r,n,i,a,c]);const p=B.useSyncExternalStore(B.useCallback(g=>h?(h.on("crash",g),()=>h.off("crash",g)):()=>{},[h]),()=>(h==null?void 0:h.getCrashingError())??null),{Canvas:m}=Vr();return h?C.jsx(mh,{fallback:u,onError:g=>h.annotateError(g,{origin:"react.tldraw",willCrashApp:!0}),children:p?C.jsx(CB,{crashingError:p}):C.jsx(Qg.Provider,{value:h,children:C.jsx(EB,{autoFocus:l,onMount:t,children:o??(m?C.jsx(m,{}):null)})})}):null}function EB({children:t,onMount:o,autoFocus:n}){return xB(),DU(),LU(),bB(),NU(),FU(n),PB(o),C.jsx(C.Fragment,{children:t})}function CB({crashingError:t}){throw t}function YI({children:t}){return C.jsx("div",{className:"tl-loading",children:t})}function XI({children:t}){return C.jsx("div",{className:"tl-loading",children:t})}function PB(t){const o=Ue(),n=SS(r=>{const s=t==null?void 0:t(r);return r.emit("mount"),window.tldrawReady=!0,s});Ut.useLayoutEffect(()=>{if(o)return n==null?void 0:n(o)},[o,n])}function Ul({children:t,className:o="",...n}){return C.jsx("div",{...n,className:Tt("tl-html-container",o),children:t})}function qI(t,o,n={}){const{newPoint:r,handle:s,scaleX:i,scaleY:a}=o,{minWidth:l=1,maxWidth:c=1/0,minHeight:u=1,maxHeight:f=1/0}=n;let h=t.props.w*i,d=t.props.h*a;const p=new Y(0,0);if(h>0){if(h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=h-l;break}case"top":case"bottom":{p.x=(h-l)/2;break}default:p.x=0}h=l}}else if(p.x=h,h=-h,h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=-h;break}default:p.x=-l}h=l}if(d>0){if(d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=d-u;break}case"right":case"left":{p.y=(d-u)/2;break}default:p.y=0}d=u}}else if(p.y=d,d=-d,d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=-d;break}default:p.y=-u}d=u}const{x:m,y:g}=p.rot(t.rotation).add(r);return{x:m,y:g,props:{w:Math.min(c,h),h:Math.min(f,d)}}}class Ru extends Bs{constructor(){super(...arguments);D(this,"onResize",(n,r)=>qI(n,r))}getGeometry(n){return new Hi({width:n.props.w,height:n.props.h,isFilled:!0})}getHandleSnapGeometry(n){return{points:this.getGeometry(n).bounds.cornersAndCenter}}}var Iv;let TB=(Iv=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Iv,"id","idle"),Iv);var Mv;let kB=(Mv=class extends bt{constructor(){super(...arguments);D(this,"markId","");D(this,"wasFocusedOnEnter",!1);D(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()});D(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,s=this.parent.shapeType,i=hr();this.markId=`creating:${i}`,this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:s,x:r.x,y:r.y,props:{w:1,h:1}}]).select(i),this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:this.parent.onCreate})}});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType,s=hr();this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:r,x:n.x,y:n.y}]);const i=this.editor.getShape(s),{w:a,h:l}=this.editor.getShapeUtil(i).getDefaultProps(),c=new Y(a/2,l/2),u=this.editor.getShapeParentTransform(i);u&&c.rot(-u.rotation()),this.editor.updateShapes([{id:s,type:r,x:i.x-c.x,y:i.y-c.y}]),this.editor.setSelectedShapes([s]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},D(Mv,"id","pointing"),Mv);class $p extends bt{constructor(){super(...arguments);D(this,"onCreate")}}D($p,"id","box"),D($p,"initial","idle"),D($p,"children",()=>[TB,kB]);function ly(t){const o=Ue();return He("isEditing",()=>o.getEditingShapeId()===t,[o,t])}function IB(){return B.useId().replace(/:/g,"_")}function Qs(t){const o=Ue();return B.useMemo(function(){const s=u=>{if(u.isKilled)return;if(u.button===2){o.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...To(u)});return}if(u.button!==0)return;const f=ug(u.currentTarget);function h(){f.removeEventListener("pointerup",h),zh(f,u)}Bh(f,u),f.addEventListener("pointerup",h),o.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...To(u)}),Rn(u)};let i,a;function l(u){u.isKilled||u.button===0&&(u.clientX===i&&u.clientY===a||(i=u.clientX,a=u.clientY,o.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...To(u)})))}return{onPointerDown:s,onPointerMove:l,onPointerUp:u=>{u.isKilled||u.button===0&&o.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...To(u)})}}},[o,t])}const MB=20,OB=8;function jS(t,o=MB){return Math.max(OB,Math.ceil(t/o))}class KI extends Ql{constructor(n){super({...n,isFilled:!1,isClosed:!1});D(this,"_center");D(this,"radius");D(this,"start");D(this,"end");D(this,"measure");D(this,"length");D(this,"angleStart");D(this,"angleEnd");const{center:r,radius:s,sweepFlag:i,largeArcFlag:a,start:l,end:c}=n;if(l.equals(c))throw Error("Arc must have different start and end points.");this.angleStart=Y.Angle(r,l),this.angleEnd=Y.Angle(r,c),this.measure=A6(this.angleStart,this.angleEnd,i,a),this.length=this.measure*s,this.start=l,this.end=c,this._center=r,this.radius=s}nearestPoint(n){const{_center:r,measure:s,radius:i,angleEnd:a,angleStart:l,start:c,end:u}=this,f=Qb(s,l,a,r.angle(n));if(f<=0)return c;if(f>=1)return u;const h=r.clone().add(n.clone().sub(r).uni().mul(i));let d,p=1/0,m;for(const g of[c,u,h])m=Y.Dist2(n,g),m<p&&(d=g,p=m);if(!d)throw Error("nearest point not found");return d}hitTestLineSegment(n,r){const{_center:s,radius:i,measure:a,angleStart:l,angleEnd:c}=this,u=ty(n,r,s,i);return u===null?!1:u.some(f=>{const h=Qb(a,l,c,s.angle(f));return h>=0&&h<=1})}getVertices(){const{_center:n,measure:r,length:s,radius:i,angleStart:a}=this,l=[];for(let c=0,u=jS(Math.abs(s));c<u+1;c++){const f=c/u*r,h=a+f;l.push(Nl(n,i,h))}return l}}class ES extends Ql{constructor(n){super({isClosed:!0,...n});D(this,"_center");D(this,"radius");D(this,"x");D(this,"y");this.config=n;const{x:r=0,y:s=0,radius:i}=n;this.x=r,this.y=s,this._center=new Y(i+r,i+s),this.radius=i}getBounds(){return new mt(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:n,radius:r}=this,s=or*r,i=[];for(let a=0,l=jS(s);a<l;a++){const c=a/l*or;i.push(Nl(n,r,c))}return i}nearestPoint(n){const{_center:r,radius:s}=this;return r.equals(n)?Y.AddXY(r,s,0):r.clone().add(n.clone().sub(r).uni().mul(s))}hitTestLineSegment(n,r,s=0){const{_center:i,radius:a}=this;return ty(n,r,i,a+s)!==null}}class AB extends Jl{constructor(n){const{start:r,cp1:s,cp2:i,end:a}=n;super({...n,points:[r,a]});D(this,"a");D(this,"b");D(this,"c");D(this,"d");this.a=r,this.b=s,this.c=i,this.d=a}getVertices(){const n=[],{a:r,b:s,c:i,d:a}=this;for(let l=0,c=10;l<=c;l++){const u=l/c;n.push(new Y((1-u)*(1-u)*(1-u)*r.x+3*((1-u)*(1-u))*u*s.x+3*(1-u)*(u*u)*i.x+u*u*u*a.x,(1-u)*(1-u)*(1-u)*r.y+3*((1-u)*(1-u))*u*s.y+3*(1-u)*(u*u)*i.y+u*u*u*a.y))}return n}midPoint(){return RB(this,.5)}nearestPoint(n){let r,s=1/0,i,a;for(const l of this.segments)a=l.nearestPoint(n),i=Y.Dist2(a,n),i<s&&(r=a,s=i);if(!r)throw Error("nearest point not found");return r}}function RB(t,o){const{a:n,b:r,c:s,d:i}=t;return new Y((1-o)*(1-o)*(1-o)*n.x+3*((1-o)*(1-o))*o*r.x+3*(1-o)*(o*o)*s.x+o*o*o*i.x,(1-o)*(1-o)*(1-o)*n.y+3*((1-o)*(1-o))*o*r.y+3*(1-o)*(o*o)*s.y+o*o*o*i.y)}class DB extends Ql{constructor(n){super({...n,isClosed:!1,isFilled:!1});D(this,"points");D(this,"_segments");D(this,"_length");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:n}=this,r=n.length,s=r-2,i=1.25;for(let a=0;a<r-1;a++){const l=a===0?n[0]:n[a-1],c=n[a],u=n[a+1],f=a===s?u:n[a+2],h=c,d=a===0?l:new Y(c.x+(u.x-l.x)/6*i,c.y+(u.y-l.y)/6*i),p=a===s?u:new Y(u.x-(f.x-c.x)/6*i,u.y-(f.y-c.y)/6*i),m=u;this._segments.push(new AB({start:h,cp1:d,cp2:p,end:m}))}}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((n,r)=>n+r.length,0)),this._length}getVertices(){const n=this.segments.reduce((r,s)=>r.concat(s.vertices),[]);return n.push(this.points[this.points.length-1]),n}nearestPoint(n){let r,s=1/0,i,a;for(const l of this.segments)a=l.nearestPoint(n),i=Y.Dist2(a,n),i<s&&(r=a,s=i);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.segments.some(s=>s.hitTestLineSegment(n,r))}}class ZI extends Ql{constructor(n){super({...n,isClosed:!0});D(this,"w");D(this,"h");D(this,"_edges");this.config=n;const{width:r,height:s}=n;this.w=r,this.h=s}get edges(){if(!this._edges){const{vertices:n}=this;this._edges=[];for(let r=0,s=n.length;r<s;r++){const i=n[r],a=n[(r+1)%s];this._edges.push(new bh({start:i,end:a}))}}return this._edges}getVertices(){const n=Math.max(1,this.w),r=Math.max(1,this.h),s=n/2,i=r/2,a=Math.pow(s-i,2)/Math.pow(s+i,2),l=Yt*(s+i)*(1+3*a/(10+Math.sqrt(4-3*a))),c=jS(l),u=or/c,f=Math.cos(u),h=Math.sin(u);let d=0,p=1,m=0,g=1;const b=Array(c);for(let y=0;y<c;y++)b[y]=new Y(s+s*p,i+i*d),m=h*p+f*d,g=f*p-h*d,d=m,p=g;return b}nearestPoint(n){let r,s=1/0,i,a;for(const l of this.edges)a=l.nearestPoint(n),i=Y.Dist2(a,n),i<s&&(r=a,s=i);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.edges.some(s=>s.hitTestLineSegment(n,r))}getBounds(){return new mt(0,0,this.w,this.h)}}const ji=18;class LB extends ZI{constructor(o){super({...o}),this.config=o}getVertices(){const o=Math.max(1,this.w),n=Math.max(1,this.h),r=o/2,s=n/2,i=Array(ji);let a,l;if(n>o)for(let c=0;c<ji-1;c++)a=-Yt+Yt*c/(ji-2),l=Yt*c/(ji-2),i[c]=new Y(r+r*Math.cos(a),r+r*Math.sin(a)),i[c+(ji-1)]=new Y(r+r*Math.cos(l),n-r+r*Math.sin(l));else for(let c=0;c<ji-1;c++)a=-dr+Yt*c/(ji-2),l=dr+Yt*-c/(ji-2),i[c]=new Y(o-s+s*Math.cos(a),n-s+s*Math.sin(a)),i[c+(ji-1)]=new Y(s-s*Math.cos(l),n-s+s*Math.sin(l));return i}}function aj(t,o,n,r,s){const i=Y6,a=n?X6:0,l=t-a,c=t+a,u=r?0:i,f=s?o:o-i;return l<u?Math.min(1,(u-l)/i):c>f?-Math.min(1,(c-f)/i):0}function CS(t){if(!t.inputs.isDragging||t.inputs.isPanning||!t.getInstanceState().canMoveCamera)return;const{inputs:{currentScreenPoint:{x:o,y:n}}}=t,r=t.getZoomLevel(),s=t.getViewportScreenBounds(),i=s.w<1e3?.612:1,a=s.h<1e3?.612:1,{isCoarsePointer:l,insets:[c,u,f,h]}=t.getInstanceState(),d=aj(o,s.w,l,h,u),p=aj(n,s.h,l,c,f);if(d===0&&p===0)return;const m=t.user.getEdgeScrollSpeed()*W6,g=m*d*i/r,b=m*p*a/r,y=t.getCamera();t.setCamera({x:y.x+g,y:y.y+b})}async function FB({shouldReload:t=!0}={}){e4(),await Promise.all(_S().map(o=>rB(o))),JL(),t&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=FB);function NB(t,o="_blank"){fS.openWindow(t,o)}var ud=function(t){return t&&t.Math===Math&&t},Lo=ud(typeof globalThis=="object"&&globalThis)||ud(typeof window=="object"&&window)||ud(typeof self=="object"&&self)||ud(typeof fn=="object"&&fn)||ud(typeof fn=="object"&&fn)||function(){return this}()||Function("return this")(),PS={},bo=function(t){try{return!!t()}catch{return!0}},$B=bo,el=!$B(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),UB=bo,cy=!UB(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),BB=cy,Vf=Function.prototype.call,ta=BB?Vf.bind(Vf):function(){return Vf.apply(Vf,arguments)},QI={},JI={}.propertyIsEnumerable,eM=Object.getOwnPropertyDescriptor,zB=eM&&!JI.call({1:2},1);QI.f=zB?function(o){var n=eM(this,o);return!!n&&n.enumerable}:JI;var tM=function(t,o){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:o}},rM=cy,nM=Function.prototype,a1=nM.call,GB=rM&&nM.bind.bind(a1,a1),En=rM?GB:function(t){return function(){return a1.apply(t,arguments)}},oM=En,VB=oM({}.toString),HB=oM("".slice),Du=function(t){return HB(VB(t),8,-1)},WB=En,YB=bo,XB=Du,$0=Object,qB=WB("".split),KB=YB(function(){return!$0("z").propertyIsEnumerable(0)})?function(t){return XB(t)==="String"?qB(t,""):$0(t)}:$0,uy=function(t){return t==null},ZB=uy,QB=TypeError,Lu=function(t){if(ZB(t))throw new QB("Can't call method on "+t);return t},JB=KB,e7=Lu,dy=function(t){return JB(e7(t))},U0=typeof document=="object"&&document.all,xo=typeof U0>"u"&&U0!==void 0?function(t){return typeof t=="function"||t===U0}:function(t){return typeof t=="function"},t7=xo,ec=function(t){return typeof t=="object"?t!==null:t7(t)},B0=Lo,r7=xo,n7=function(t){return r7(t)?t:void 0},hy=function(t,o){return arguments.length<2?n7(B0[t]):B0[t]&&B0[t][o]},o7=En,sM=o7({}.isPrototypeOf),s7=typeof navigator<"u"&&String(navigator.userAgent)||"",iM=Lo,z0=s7,lj=iM.process,cj=iM.Deno,uj=lj&&lj.versions||cj&&cj.version,dj=uj&&uj.v8,Ds,yg;dj&&(Ds=dj.split("."),yg=Ds[0]>0&&Ds[0]<4?1:+(Ds[0]+Ds[1]));!yg&&z0&&(Ds=z0.match(/Edge\/(\d+)/),(!Ds||Ds[1]>=74)&&(Ds=z0.match(/Chrome\/(\d+)/),Ds&&(yg=+Ds[1])));var i7=yg,hj=i7,a7=bo,l7=Lo,c7=l7.String,aM=!!Object.getOwnPropertySymbols&&!a7(function(){var t=Symbol("symbol detection");return!c7(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&hj&&hj<41}),u7=aM,lM=u7&&!Symbol.sham&&typeof Symbol.iterator=="symbol",d7=hy,h7=xo,f7=sM,p7=lM,m7=Object,cM=p7?function(t){return typeof t=="symbol"}:function(t){var o=d7("Symbol");return h7(o)&&f7(o.prototype,m7(t))},g7=String,y7=function(t){try{return g7(t)}catch{return"Object"}},v7=xo,b7=y7,x7=TypeError,TS=function(t){if(v7(t))return t;throw new x7(b7(t)+" is not a function")},S7=TS,w7=uy,kS=function(t,o){var n=t[o];return w7(n)?void 0:S7(n)},G0=ta,V0=xo,H0=ec,_7=TypeError,j7=function(t,o){var n,r;if(o==="string"&&V0(n=t.toString)&&!H0(r=G0(n,t))||V0(n=t.valueOf)&&!H0(r=G0(n,t))||o!=="string"&&V0(n=t.toString)&&!H0(r=G0(n,t)))return r;throw new _7("Can't convert object to primitive value")},uM={exports:{}},fj=Lo,E7=Object.defineProperty,IS=function(t,o){try{E7(fj,t,{value:o,configurable:!0,writable:!0})}catch{fj[t]=o}return o},C7=Lo,P7=IS,pj="__core-js_shared__",mj=uM.exports=C7[pj]||P7(pj,{});(mj.versions||(mj.versions=[])).push({version:"3.37.0",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"});var MS=uM.exports,gj=MS,OS=function(t,o){return gj[t]||(gj[t]=o||{})},T7=Lu,k7=Object,Yh=function(t){return k7(T7(t))},I7=En,M7=Yh,O7=I7({}.hasOwnProperty),tl=Object.hasOwn||function(o,n){return O7(M7(o),n)},A7=En,R7=0,D7=Math.random(),L7=A7(1 .toString),dM=function(t){return"Symbol("+(t===void 0?"":t)+")_"+L7(++R7+D7,36)},F7=Lo,N7=OS,yj=tl,$7=dM,U7=aM,B7=lM,Vc=F7.Symbol,W0=N7("wks"),z7=B7?Vc.for||Vc:Vc&&Vc.withoutSetter||$7,ra=function(t){return yj(W0,t)||(W0[t]=U7&&yj(Vc,t)?Vc[t]:z7("Symbol."+t)),W0[t]},G7=ta,vj=ec,bj=cM,V7=kS,H7=j7,W7=ra,Y7=TypeError,X7=W7("toPrimitive"),q7=function(t,o){if(!vj(t)||bj(t))return t;var n=V7(t,X7),r;if(n){if(o===void 0&&(o="default"),r=G7(n,t,o),!vj(r)||bj(r))return r;throw new Y7("Can't convert object to primitive value")}return o===void 0&&(o="number"),H7(t,o)},K7=q7,Z7=cM,hM=function(t){var o=K7(t,"string");return Z7(o)?o:o+""},Q7=Lo,xj=ec,l1=Q7.document,J7=xj(l1)&&xj(l1.createElement),fM=function(t){return J7?l1.createElement(t):{}},e9=el,t9=bo,r9=fM,pM=!e9&&!t9(function(){return Object.defineProperty(r9("div"),"a",{get:function(){return 7}}).a!==7}),n9=el,o9=ta,s9=QI,i9=tM,a9=dy,l9=hM,c9=tl,u9=pM,Sj=Object.getOwnPropertyDescriptor;PS.f=n9?Sj:function(o,n){if(o=a9(o),n=l9(n),u9)try{return Sj(o,n)}catch{}if(c9(o,n))return i9(!o9(s9.f,o,n),o[n])};var Fu={},d9=el,h9=bo,mM=d9&&h9(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),f9=ec,p9=String,m9=TypeError,tc=function(t){if(f9(t))return t;throw new m9(p9(t)+" is not an object")},g9=el,y9=pM,v9=mM,Hf=tc,wj=hM,b9=TypeError,Y0=Object.defineProperty,x9=Object.getOwnPropertyDescriptor,X0="enumerable",q0="configurable",K0="writable";Fu.f=g9?v9?function(o,n,r){if(Hf(o),n=wj(n),Hf(r),typeof o=="function"&&n==="prototype"&&"value"in r&&K0 in r&&!r[K0]){var s=x9(o,n);s&&s[K0]&&(o[n]=r.value,r={configurable:q0 in r?r[q0]:s[q0],enumerable:X0 in r?r[X0]:s[X0],writable:!1})}return Y0(o,n,r)}:Y0:function(o,n,r){if(Hf(o),n=wj(n),Hf(r),y9)try{return Y0(o,n,r)}catch{}if("get"in r||"set"in r)throw new b9("Accessors not supported");return"value"in r&&(o[n]=r.value),o};var S9=el,w9=Fu,_9=tM,AS=S9?function(t,o,n){return w9.f(t,o,_9(1,n))}:function(t,o,n){return t[o]=n,t},gM={exports:{}},c1=el,j9=tl,yM=Function.prototype,E9=c1&&Object.getOwnPropertyDescriptor,RS=j9(yM,"name"),C9=RS&&(function(){}).name==="something",P9=RS&&(!c1||c1&&E9(yM,"name").configurable),T9={EXISTS:RS,PROPER:C9,CONFIGURABLE:P9},k9=En,I9=xo,u1=MS,M9=k9(Function.toString);I9(u1.inspectSource)||(u1.inspectSource=function(t){return M9(t)});var vM=u1.inspectSource,O9=Lo,A9=xo,_j=O9.WeakMap,R9=A9(_j)&&/native code/.test(String(_j)),D9=OS,L9=dM,jj=D9("keys"),bM=function(t){return jj[t]||(jj[t]=L9(t))},DS={},F9=R9,xM=Lo,N9=ec,$9=AS,Z0=tl,Q0=MS,U9=bM,B9=DS,Ej="Object already initialized",d1=xM.TypeError,z9=xM.WeakMap,vg,xh,bg,G9=function(t){return bg(t)?xh(t):vg(t,{})},V9=function(t){return function(o){var n;if(!N9(o)||(n=xh(o)).type!==t)throw new d1("Incompatible receiver, "+t+" required");return n}};if(F9||Q0.state){var Ks=Q0.state||(Q0.state=new z9);Ks.get=Ks.get,Ks.has=Ks.has,Ks.set=Ks.set,vg=function(t,o){if(Ks.has(t))throw new d1(Ej);return o.facade=t,Ks.set(t,o),o},xh=function(t){return Ks.get(t)||{}},bg=function(t){return Ks.has(t)}}else{var yc=U9("state");B9[yc]=!0,vg=function(t,o){if(Z0(t,yc))throw new d1(Ej);return o.facade=t,$9(t,yc,o),o},xh=function(t){return Z0(t,yc)?t[yc]:{}},bg=function(t){return Z0(t,yc)}}var SM={set:vg,get:xh,has:bg,enforce:G9,getterFor:V9},LS=En,H9=bo,W9=xo,Wf=tl,h1=el,Y9=T9.CONFIGURABLE,X9=vM,wM=SM,q9=wM.enforce,K9=wM.get,Cj=String,Up=Object.defineProperty,Z9=LS("".slice),Q9=LS("".replace),J9=LS([].join),ez=h1&&!H9(function(){return Up(function(){},"length",{value:8}).length!==8}),tz=String(String).split("String"),rz=gM.exports=function(t,o,n){Z9(Cj(o),0,7)==="Symbol("&&(o="["+Q9(Cj(o),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(o="get "+o),n&&n.setter&&(o="set "+o),(!Wf(t,"name")||Y9&&t.name!==o)&&(h1?Up(t,"name",{value:o,configurable:!0}):t.name=o),ez&&n&&Wf(n,"arity")&&t.length!==n.arity&&Up(t,"length",{value:n.arity});try{n&&Wf(n,"constructor")&&n.constructor?h1&&Up(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=q9(t);return Wf(r,"source")||(r.source=J9(tz,typeof o=="string"?o:"")),t};Function.prototype.toString=rz(function(){return W9(this)&&K9(this).source||X9(this)},"toString");var nz=gM.exports,oz=xo,sz=Fu,iz=nz,az=IS,_M=function(t,o,n,r){r||(r={});var s=r.enumerable,i=r.name!==void 0?r.name:o;if(oz(n)&&iz(n,i,r),r.global)s?t[o]=n:az(o,n);else{try{r.unsafe?t[o]&&(s=!0):delete t[o]}catch{}s?t[o]=n:sz.f(t,o,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},jM={},lz=Math.ceil,cz=Math.floor,uz=Math.trunc||function(o){var n=+o;return(n>0?cz:lz)(n)},dz=uz,rc=function(t){var o=+t;return o!==o||o===0?0:dz(o)},hz=rc,fz=Math.max,pz=Math.min,mz=function(t,o){var n=hz(t);return n<0?fz(n+o,0):pz(n,o)},gz=rc,yz=Math.min,EM=function(t){var o=gz(t);return o>0?yz(o,9007199254740991):0},vz=EM,Xh=function(t){return vz(t.length)},bz=dy,xz=mz,Sz=Xh,Pj=function(t){return function(o,n,r){var s=bz(o),i=Sz(s);if(i===0)return!t&&-1;var a=xz(r,i),l;if(t&&n!==n){for(;i>a;)if(l=s[a++],l!==l)return!0}else for(;i>a;a++)if((t||a in s)&&s[a]===n)return t||a||0;return!t&&-1}},wz={includes:Pj(!0),indexOf:Pj(!1)},_z=En,J0=tl,jz=dy,Ez=wz.indexOf,Cz=DS,Tj=_z([].push),CM=function(t,o){var n=jz(t),r=0,s=[],i;for(i in n)!J0(Cz,i)&&J0(n,i)&&Tj(s,i);for(;o.length>r;)J0(n,i=o[r++])&&(~Ez(s,i)||Tj(s,i));return s},FS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Pz=CM,Tz=FS,kz=Tz.concat("length","prototype");jM.f=Object.getOwnPropertyNames||function(o){return Pz(o,kz)};var PM={};PM.f=Object.getOwnPropertySymbols;var Iz=hy,Mz=En,Oz=jM,Az=PM,Rz=tc,Dz=Mz([].concat),Lz=Iz("Reflect","ownKeys")||function(o){var n=Oz.f(Rz(o)),r=Az.f;return r?Dz(n,r(o)):n},kj=tl,Fz=Lz,Nz=PS,$z=Fu,Uz=function(t,o,n){for(var r=Fz(o),s=$z.f,i=Nz.f,a=0;a<r.length;a++){var l=r[a];!kj(t,l)&&!(n&&kj(n,l))&&s(t,l,i(o,l))}},Bz=bo,zz=xo,Gz=/#|\.prototype\./,qh=function(t,o){var n=Hz[Vz(t)];return n===Yz?!0:n===Wz?!1:zz(o)?Bz(o):!!o},Vz=qh.normalize=function(t){return String(t).replace(Gz,".").toLowerCase()},Hz=qh.data={},Wz=qh.NATIVE="N",Yz=qh.POLYFILL="P",Xz=qh,Yf=Lo,qz=PS.f,Kz=AS,Zz=_M,Qz=IS,Jz=Uz,eG=Xz,Nu=function(t,o){var n=t.target,r=t.global,s=t.stat,i,a,l,c,u,f;if(r?a=Yf:s?a=Yf[n]||Qz(n,{}):a=Yf[n]&&Yf[n].prototype,a)for(l in o){if(u=o[l],t.dontCallGetSet?(f=qz(a,l),c=f&&f.value):c=a[l],i=eG(r?l:n+(s?".":"#")+l,t.forced),!i&&c!==void 0){if(typeof u==typeof c)continue;Jz(u,c)}(t.sham||c&&c.sham)&&Kz(u,"sham",!0),Zz(a,l,u,t)}},TM={},tG=CM,rG=FS,nG=Object.keys||function(o){return tG(o,rG)},oG=el,sG=mM,iG=Fu,aG=tc,lG=dy,cG=nG;TM.f=oG&&!sG?Object.defineProperties:function(o,n){aG(o);for(var r=lG(n),s=cG(n),i=s.length,a=0,l;i>a;)iG.f(o,l=s[a++],r[l]);return o};var uG=hy,dG=uG("document","documentElement"),hG=tc,fG=TM,Ij=FS,pG=DS,mG=dG,gG=fM,yG=bM,Mj=">",Oj="<",f1="prototype",p1="script",kM=yG("IE_PROTO"),ev=function(){},IM=function(t){return Oj+p1+Mj+t+Oj+"/"+p1+Mj},Aj=function(t){t.write(IM("")),t.close();var o=t.parentWindow.Object;return t=null,o},vG=function(){var t=gG("iframe"),o="java"+p1+":",n;return t.style.display="none",mG.appendChild(t),t.src=String(o),n=t.contentWindow.document,n.open(),n.write(IM("document.F=Object")),n.close(),n.F},Xf,Bp=function(){try{Xf=new ActiveXObject("htmlfile")}catch{}Bp=typeof document<"u"?document.domain&&Xf?Aj(Xf):vG():Aj(Xf);for(var t=Ij.length;t--;)delete Bp[f1][Ij[t]];return Bp()};pG[kM]=!0;var MM=Object.create||function(o,n){var r;return o!==null?(ev[f1]=hG(o),r=new ev,ev[f1]=null,r[kM]=o):r=Bp(),n===void 0?r:fG.f(r,n)},bG=ra,xG=MM,SG=Fu.f,m1=bG("unscopables"),g1=Array.prototype;g1[m1]===void 0&&SG(g1,m1,{configurable:!0,value:xG(null)});var NS=function(t){g1[m1][t]=!0},wG=Nu,_G=Yh,jG=Xh,EG=rc,CG=NS;wG({target:"Array",proto:!0},{at:function(o){var n=_G(this),r=jG(n),s=EG(o),i=s>=0?s:r+s;return i<0||i>=r?void 0:n[i]}});CG("at");var PG=Lo,TG=En,Kh=function(t,o){return TG(PG[t].prototype[o])},kG=Kh;kG("Array","at");var IG=Du,OM=Array.isArray||function(o){return IG(o)==="Array"},MG=TypeError,OG=9007199254740991,AG=function(t){if(t>OG)throw MG("Maximum allowed index exceeded");return t},RG=Du,DG=En,LG=function(t){if(RG(t)==="Function")return DG(t)},Rj=LG,FG=TS,NG=cy,$G=Rj(Rj.bind),UG=function(t,o){return FG(t),o===void 0?t:NG?$G(t,o):function(){return t.apply(o,arguments)}},BG=OM,zG=Xh,GG=AG,VG=UG,AM=function(t,o,n,r,s,i,a,l){for(var c=s,u=0,f=a?VG(a,l):!1,h,d;u<r;)u in n&&(h=f?f(n[u],u,o):n[u],i>0&&BG(h)?(d=zG(h),c=AM(t,o,h,d,c,i-1)-1):(GG(c+1),t[c]=h),c++),u++;return c},RM=AM,HG=ra,WG=HG("toStringTag"),DM={};DM[WG]="z";var YG=String(DM)==="[object z]",XG=YG,qG=xo,zp=Du,KG=ra,ZG=KG("toStringTag"),QG=Object,JG=zp(function(){return arguments}())==="Arguments",eV=function(t,o){try{return t[o]}catch{}},LM=XG?zp:function(t){var o,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=eV(o=QG(t),ZG))=="string"?n:JG?zp(o):(r=zp(o))==="Object"&&qG(o.callee)?"Arguments":r},tV=En,rV=bo,FM=xo,nV=LM,oV=hy,sV=vM,NM=function(){},$M=oV("Reflect","construct"),$S=/^\s*(?:class|function)\b/,iV=tV($S.exec),aV=!$S.test(NM),dd=function(o){if(!FM(o))return!1;try{return $M(NM,[],o),!0}catch{return!1}},UM=function(o){if(!FM(o))return!1;switch(nV(o)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return aV||!!iV($S,sV(o))}catch{return!0}};UM.sham=!0;var lV=!$M||rV(function(){var t;return dd(dd.call)||!dd(Object)||!dd(function(){t=!0})||t})?UM:dd,Dj=OM,cV=lV,uV=ec,dV=ra,hV=dV("species"),Lj=Array,fV=function(t){var o;return Dj(t)&&(o=t.constructor,cV(o)&&(o===Lj||Dj(o.prototype))?o=void 0:uV(o)&&(o=o[hV],o===null&&(o=void 0))),o===void 0?Lj:o},pV=fV,BM=function(t,o){return new(pV(t))(o===0?0:o)},mV=Nu,gV=RM,yV=TS,vV=Yh,bV=Xh,xV=BM;mV({target:"Array",proto:!0},{flatMap:function(o){var n=vV(this),r=bV(n),s;return yV(o),s=xV(n,0),s.length=gV(s,n,n,r,0,1,o,arguments.length>1?arguments[1]:void 0),s}});var SV=NS;SV("flatMap");var wV=Kh;wV("Array","flatMap");var _V=Nu,jV=RM,EV=Yh,CV=Xh,PV=rc,TV=BM;_V({target:"Array",proto:!0},{flat:function(){var o=arguments.length?arguments[0]:void 0,n=EV(this),r=CV(n),s=TV(n,0);return s.length=jV(s,n,n,r,0,o===void 0?1:PV(o)),s}});var kV=NS;kV("flat");var IV=Kh;IV("Array","flat");var MV=LM,OV=String,Zh=function(t){if(MV(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return OV(t)},AV=Nu,RV=En,DV=Lu,LV=rc,FV=Zh,NV=bo,$V=RV("".charAt),UV=NV(function(){return"𠮷".at(-2)!=="\uD842"});AV({target:"String",proto:!0,forced:UV},{at:function(o){var n=FV(DV(this)),r=n.length,s=LV(o),i=s>=0?s:r+s;return i<0||i>=r?void 0:$V(n,i)}});var BV=Kh;BV("String","at");var zV=tc,zM=function(){var t=zV(this),o="";return t.hasIndices&&(o+="d"),t.global&&(o+="g"),t.ignoreCase&&(o+="i"),t.multiline&&(o+="m"),t.dotAll&&(o+="s"),t.unicode&&(o+="u"),t.unicodeSets&&(o+="v"),t.sticky&&(o+="y"),o},US=bo,GV=Lo,BS=GV.RegExp,zS=US(function(){var t=BS("a","y");return t.lastIndex=2,t.exec("abcd")!==null}),VV=zS||US(function(){return!BS("a","y").sticky}),HV=zS||US(function(){var t=BS("^r","gy");return t.lastIndex=2,t.exec("str")!==null}),WV={BROKEN_CARET:HV,MISSED_STICKY:VV,UNSUPPORTED_Y:zS},YV=bo,XV=Lo,qV=XV.RegExp,KV=YV(function(){var t=qV(".","s");return!(t.dotAll&&t.test(`
`)&&t.flags==="s")}),ZV=bo,QV=Lo,JV=QV.RegExp,eH=ZV(function(){var t=JV("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),Hc=ta,fy=En,tH=Zh,rH=zM,nH=WV,oH=OS,sH=MM,iH=SM.get,aH=KV,lH=eH,cH=oH("native-string-replace",String.prototype.replace),xg=RegExp.prototype.exec,y1=xg,uH=fy("".charAt),dH=fy("".indexOf),hH=fy("".replace),tv=fy("".slice),v1=function(){var t=/a/,o=/b*/g;return Hc(xg,t,"a"),Hc(xg,o,"a"),t.lastIndex!==0||o.lastIndex!==0}(),GM=nH.BROKEN_CARET,b1=/()??/.exec("")[1]!==void 0,fH=v1||b1||GM||aH||lH;fH&&(y1=function(o){var n=this,r=iH(n),s=tH(o),i=r.raw,a,l,c,u,f,h,d;if(i)return i.lastIndex=n.lastIndex,a=Hc(y1,i,s),n.lastIndex=i.lastIndex,a;var p=r.groups,m=GM&&n.sticky,g=Hc(rH,n),b=n.source,y=0,v=s;if(m&&(g=hH(g,"y",""),dH(g,"g")===-1&&(g+="g"),v=tv(s,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&uH(s,n.lastIndex-1)!==`
`)&&(b="(?: "+b+")",v=" "+v,y++),l=new RegExp("^(?:"+b+")",g)),b1&&(l=new RegExp("^"+b+"$(?!\\s)",g)),v1&&(c=n.lastIndex),u=Hc(xg,m?l:n,v),m?u?(u.input=tv(u.input,y),u[0]=tv(u[0],y),u.index=n.lastIndex,n.lastIndex+=u[0].length):n.lastIndex=0:v1&&u&&(n.lastIndex=n.global?u.index+u[0].length:c),b1&&u&&u.length>1&&Hc(cH,u[0],l,function(){for(f=1;f<arguments.length-2;f++)arguments[f]===void 0&&(u[f]=void 0)}),u&&p)for(u.groups=h=sH(null),f=0;f<p.length;f++)d=p[f],h[d[0]]=u[d[1]];return u});var GS=y1,pH=Nu,Fj=GS;pH({target:"RegExp",proto:!0,forced:/./.exec!==Fj},{exec:Fj});var mH=cy,VM=Function.prototype,Nj=VM.apply,$j=VM.call,gH=typeof Reflect=="object"&&Reflect.apply||(mH?$j.bind(Nj):function(){return $j.apply(Nj,arguments)}),Uj=ta,Bj=_M,yH=GS,zj=bo,HM=ra,vH=AS,bH=HM("species"),rv=RegExp.prototype,xH=function(t,o,n,r){var s=HM(t),i=!zj(function(){var u={};return u[s]=function(){return 7},""[t](u)!==7}),a=i&&!zj(function(){var u=!1,f=/a/;return t==="split"&&(f={},f.constructor={},f.constructor[bH]=function(){return f},f.flags="",f[s]=/./[s]),f.exec=function(){return u=!0,null},f[s](""),!u});if(!i||!a||n){var l=/./[s],c=o(s,""[t],function(u,f,h,d,p){var m=f.exec;return m===yH||m===rv.exec?i&&!p?{done:!0,value:Uj(l,f,h,d)}:{done:!0,value:Uj(u,h,f,d)}:{done:!1}});Bj(String.prototype,t,c[0]),Bj(rv,s,c[1])}r&&vH(rv[s],"sham",!0)},VS=En,SH=rc,wH=Zh,_H=Lu,jH=VS("".charAt),Gj=VS("".charCodeAt),EH=VS("".slice),Vj=function(t){return function(o,n){var r=wH(_H(o)),s=SH(n),i=r.length,a,l;return s<0||s>=i?t?"":void 0:(a=Gj(r,s),a<55296||a>56319||s+1===i||(l=Gj(r,s+1))<56320||l>57343?t?jH(r,s):a:t?EH(r,s,s+2):(a-55296<<10)+(l-56320)+65536)}},CH={codeAt:Vj(!1),charAt:Vj(!0)},PH=CH.charAt,TH=function(t,o,n){return o+(n?PH(t,o).length:1)},HS=En,kH=Yh,IH=Math.floor,nv=HS("".charAt),MH=HS("".replace),ov=HS("".slice),OH=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,AH=/\$([$&'`]|\d{1,2})/g,WM=function(t,o,n,r,s,i){var a=n+t.length,l=r.length,c=AH;return s!==void 0&&(s=kH(s),c=OH),MH(i,c,function(u,f){var h;switch(nv(f,0)){case"$":return"$";case"&":return t;case"`":return ov(o,0,n);case"'":return ov(o,a);case"<":h=s[ov(f,1,-1)];break;default:var d=+f;if(d===0)return u;if(d>l){var p=IH(d/10);return p===0?u:p<=l?r[p-1]===void 0?nv(f,1):r[p-1]+nv(f,1):u}h=r[d-1]}return h===void 0?"":h})},Hj=ta,RH=tc,DH=xo,LH=Du,FH=GS,NH=TypeError,$H=function(t,o){var n=t.exec;if(DH(n)){var r=Hj(n,t,o);return r!==null&&RH(r),r}if(LH(t)==="RegExp")return Hj(FH,t,o);throw new NH("RegExp#exec called on incompatible receiver")},UH=gH,Wj=ta,py=En,BH=xH,zH=bo,GH=tc,VH=xo,HH=uy,WH=rc,YH=EM,vc=Zh,XH=Lu,qH=TH,KH=kS,ZH=WM,QH=$H,JH=ra,x1=JH("replace"),eW=Math.max,tW=Math.min,rW=py([].concat),sv=py([].push),Yj=py("".indexOf),Xj=py("".slice),nW=function(t){return t===void 0?t:String(t)},oW=function(){return"a".replace(/./,"$0")==="$0"}(),qj=function(){return/./[x1]?/./[x1]("a","$0")==="":!1}(),sW=!zH(function(){var t=/./;return t.exec=function(){var o=[];return o.groups={a:"7"},o},"".replace(t,"$<a>")!=="7"});BH("replace",function(t,o,n){var r=qj?"$":"$0";return[function(i,a){var l=XH(this),c=HH(i)?void 0:KH(i,x1);return c?Wj(c,i,l,a):Wj(o,vc(l),i,a)},function(s,i){var a=GH(this),l=vc(s);if(typeof i=="string"&&Yj(i,r)===-1&&Yj(i,"$<")===-1){var c=n(o,a,l,i);if(c.done)return c.value}var u=VH(i);u||(i=vc(i));var f=a.global,h;f&&(h=a.unicode,a.lastIndex=0);for(var d=[],p;p=QH(a,l),!(p===null||(sv(d,p),!f));){var m=vc(p[0]);m===""&&(a.lastIndex=qH(l,YH(a.lastIndex),h))}for(var g="",b=0,y=0;y<d.length;y++){p=d[y];for(var v=vc(p[0]),x=eW(tW(WH(p.index),l.length),0),S=[],w,E=1;E<p.length;E++)sv(S,nW(p[E]));var j=p.groups;if(u){var P=rW([v],S,x,l);j!==void 0&&sv(P,j),w=vc(UH(i,void 0,P))}else w=ZH(v,l,x,S,j,i);x>=b&&(g+=Xj(l,b,x)+w,b=x+v.length)}return g+Xj(l,b)}]},!sW||!oW||qj);var iW=ec,aW=Du,lW=ra,cW=lW("match"),uW=function(t){var o;return iW(t)&&((o=t[cW])!==void 0?!!o:aW(t)==="RegExp")},dW=ta,hW=tl,fW=sM,pW=zM,Kj=RegExp.prototype,mW=function(t){var o=t.flags;return o===void 0&&!("flags"in Kj)&&!hW(t,"flags")&&fW(Kj,t)?dW(pW,t):o},gW=Nu,yW=ta,WS=En,Zj=Lu,vW=xo,bW=uy,xW=uW,hd=Zh,SW=kS,wW=mW,_W=WM,jW=ra,EW=jW("replace"),CW=TypeError,iv=WS("".indexOf);WS("".replace);var Qj=WS("".slice),PW=Math.max;gW({target:"String",proto:!0},{replaceAll:function(o,n){var r=Zj(this),s,i,a,l,c,u,f,h,d,p=0,m=0,g="";if(!bW(o)){if(s=xW(o),s&&(i=hd(Zj(wW(o))),!~iv(i,"g")))throw new CW("`.replaceAll` does not allow non-global regexes");if(a=SW(o,EW),a)return yW(a,o,r,n)}for(l=hd(r),c=hd(o),u=vW(n),u||(n=hd(n)),f=c.length,h=PW(1,f),p=iv(l,c);p!==-1;)d=u?hd(n(c,p,l)):_W(c,l,p,[],void 0,n),g+=Qj(l,m,p)+d,m=p+f,p=p+h>l.length?-1:iv(l,c,p+h);return m<l.length&&(g+=Qj(l,m)),g}});var TW=Kh;TW("String","replaceAll");function kW(t){return t.getSelectedShapeIds().map(r=>t.getShape(r)).filter(r=>!(!r||t.isShapeOfType(r,"arrow")&&r.props.start.type==="binding"||t.isShapeOfType(r,"arrow")&&r.props.end.type==="binding"))}const YM=()=>{const t=Ue();return He("threeStackableItems",()=>kW(t).length>2,[t])},XM=()=>{const t=Ue();return He("allow group",()=>{const o=t.getSelectedShapes();if(o.length<2)return!1;for(const n of o)if(t.isShapeOfType(n,"arrow")){const{start:r,end:s}=n.props;if(r.type==="binding"&&!o.some(i=>i.id===r.boundShapeId)||s.type==="binding"&&!o.some(i=>i.id===s.boundShapeId))return!1}return!0},[t])},qM=()=>{const t=Ue();return He("allowUngroup",()=>t.getSelectedShapeIds().some(o=>{var n;return((n=t.getShape(o))==null?void 0:n.type)==="group"}),[t])},IW=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read;function MW(t,o){const n=Ue();return He("selectedShapes",()=>{const r=n.getSelectedShapes().length;return t===void 0?o===void 0?r:r<=o:o===void 0?r>=t:r>=t&&r<=o},[n,t,o])}function So(t,o){const n=Ue();return He("selectedShapes",()=>{const r=n.getSelectedShapes().filter(s=>!n.isShapeOrAncestorLocked(s)).length;return t===void 0?o===void 0?r:r<=o:o===void 0?r>=t:r>=t&&r<=o},[n])}function OW(){const t=Ue();return He("showAutoSizeToggle",()=>{const o=t.getSelectedShapes();return o.length===1&&t.isShapeOfType(o[0],"text")&&o[0].props.autoSize===!1},[t])}function KM(){const t=Ue();return He("hasLinkShapeSelected",()=>{const o=t.getOnlySelectedShape();return!!(o&&o.type!=="embed"&&"url"in o.props&&!o.isLocked)},[t])}function AW(){const t=Ue();return He("onlyFlippableShape",()=>{const o=t.getOnlySelectedShape();return o&&(t.isShapeOfType(o,"group")||t.isShapeOfType(o,"arrow")||t.isShapeOfType(o,"line")||t.isShapeOfType(o,"draw"))},[t])}function ZM(){const t=Ue();return He("useCanRedo",()=>t.getCanRedo(),[t])}function QM(){const t=Ue();return He("useCanUndo",()=>t.getCanUndo(),[t])}function RW({children:t}){const o=Ue();return He("shouldDisplayHandles",()=>{if(o.isInAny("select.idle","select.pointing_handle","select.pointing_shape"))return!0;if(o.isInAny("select.editing_shape")){const r=o.getOnlySelectedShape();return r&&o.isShapeOfType(r,"note")}return!1},[o])?C.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}):null}const{PI:DW}=Math,su=DW+1e-4;function JM(t,o={}){const{size:n=16,smoothing:r=.5}=o;if(t.length===0||n<=0)return{left:[],right:[]};const s=t[0],i=t[t.length-1],a=i.runningLength,l=Math.pow(n*r,2),c=[],u=[];let f=t[0].vector,h=t[0].point,d=h,p=h,m=d,g=!1,b;for(let y=0;y<t.length;y++){b=t[y];const{point:v,vector:x}=t[y],S=b.vector.dpr(f),w=(y<t.length-1?t[y+1]:t[y]).vector,E=y<t.length-1?w.dpr(b.vector):1,j=S<0&&!g,P=E!==null&&E<.2;if(j||P){if(E>-.62&&a-b.runningLength>b.radius){const O=f.clone().mul(b.radius);f.clone().cpr(w)<0?(p=Y.Add(v,O),m=Y.Sub(v,O)):(p=Y.Sub(v,O),m=Y.Add(v,O)),c.push(p),u.push(m)}else{const O=f.clone().mul(b.radius).per(),k=Y.Sub(b.input,O);for(let F=1/13,A=0;A<1;A+=F)p=Y.RotWith(k,b.input,su*A),c.push(p),m=Y.RotWith(k,b.input,su+su*-A),u.push(m)}h=p,d=m,P&&(g=!0);continue}if(g=!1,b===s||b===i){const O=Y.Per(x).mul(b.radius);c.push(Y.Sub(v,O)),u.push(Y.Add(v,O));continue}const M=Y.Lrp(w,x,E).per().mul(b.radius);p=Y.Sub(v,M),(y<=1||Y.Dist2(h,p)>l)&&(c.push(p),h=p),m=Y.Add(v,M),(y<=1||Y.Dist2(d,m)>l)&&(u.push(m),d=m),f=x}return{left:c,right:u}}function YS(t,o={}){const{size:n=16,start:r={},end:s={},last:i=!1}=o,{cap:a=!0}=r,{cap:l=!0}=s;if(t.length===0||n<=0)return[];const c=t[0],u=t[t.length-1],f=u.runningLength,h=r.taper===!1?0:r.taper===!0?Math.max(n,f):r.taper,d=s.taper===!1?0:s.taper===!0?Math.max(n,f):s.taper,{left:p,right:m}=JM(t,o),g=c.point,b=t.length>1?t[t.length-1].point:Y.AddXY(c.point,1,1);if(t.length===1&&(!(h||d)||i)){const S=Y.Add(g,Y.Sub(g,b).uni().per().mul(-c.radius)),w=[];for(let E=1/13,j=E;j<=1;j+=E)w.push(Y.RotWith(S,g,su*2*j));return w}const y=[];if(!(h||d&&t.length===1))if(a)for(let S=1/8,w=S;w<=1;w+=S){const E=Y.RotWith(m[0],g,su*w);y.push(E)}else{const S=Y.Sub(p[0],m[0]),w=Y.Mul(S,.5),E=Y.Mul(S,.51);y.push(Y.Sub(g,w),Y.Sub(g,E),Y.Add(g,E),Y.Add(g,w))}const v=[],x=u.vector.clone().per().neg();if(d||h&&t.length===1)v.push(b);else if(l){const S=Y.Add(b,Y.Mul(x,u.radius));for(let w=1/29,E=w;E<1;E+=w)v.push(Y.RotWith(S,b,su*3*E))}else v.push(Y.Add(b,Y.Mul(x,u.radius)),Y.Add(b,Y.Mul(x,u.radius*.99)),Y.Sub(b,Y.Mul(x,u.radius*.99)),Y.Sub(b,Y.Mul(x,u.radius)));return p.concat(v,m.reverse(),y)}const LW=.025,FW=.01;function di(t,o={}){var b;const{streamline:n=.5,size:r=16,simulatePressure:s=!1}=o;if(t.length===0)return[];const i=.15+(1-n)*.85;let a=t.map(Y.From),l=0;if(!s){let y=a[0];for(;y&&!(y.z>=LW);)a.shift(),y=a[0]}if(!s){let y=a[a.length-1];for(;y&&!(y.z>=FW);)a.pop(),y=a[a.length-1]}if(a.length===0)return[{point:Y.From(t[0]),input:Y.From(t[0]),pressure:s?.5:.15,vector:new Y(1,1),distance:0,runningLength:0,radius:1}];let c=a[1];for(;c&&!(Y.Dist2(c,a[0])>(r/3)**2);)a[0].z=Math.max(a[0].z,c.z),a.splice(1,1),c=a[1];const u=a.pop();for(c=a[a.length-1];c&&!(Y.Dist2(c,u)>(r/3)**2);)a.pop(),c=a[a.length-1],l++;a.push(u);const f=o.last||!o.simulatePressure||a.length>1&&Y.Dist2(a[a.length-1],a[a.length-2])<r**2||l>0;if(a.length===2&&o.simulatePressure){const y=a[1];a=a.slice(0,-1);for(let v=1;v<5;v++){const x=Y.Lrp(a[0],y,v/4);x.z=(a[0].z+(y.z-a[0].z))*v/4,a.push(x)}}const h=[{point:a[0],input:a[0],pressure:s?.5:a[0].z,vector:new Y(1,1),distance:0,runningLength:0,radius:1}];let d=0,p=h[0],m,g;f&&n>0&&a.push(a[a.length-1].clone());for(let y=1,v=a.length;y<v;y++)m=!i||o.last&&y===v-1?a[y].clone():a[y].clone().lrp(p.point,1-i),!p.point.equals(m)&&(g=Y.Dist(m,p.point),d+=g,!(y<4&&d<r)&&(p={input:a[y],point:m,pressure:s?.5:a[y].z,vector:Y.Sub(p.point,m).uni(),distance:g,runningLength:d,radius:1},h.push(p)));if((b=h[1])!=null&&b.vector&&(h[0].vector=h[1].vector.clone()),d<1){const y=Math.max(.5,...h.map(v=>v.pressure));h.forEach(v=>v.pressure=y)}return h}const{min:ga}=Math,av=.275;function my(t,o){const{size:n=16,thinning:r=.5,simulatePressure:s=!0,easing:i=b=>b,start:a={},end:l={}}=o,{easing:c=Kn.easeOutQuad}=a,{easing:u=Kn.easeOutCubic}=l,f=t[t.length-1].runningLength;let h,d=t[0].pressure,p;if(!s&&f<n){const b=t.reduce((y,v)=>Math.max(y,v.pressure),.5);return t.forEach(y=>{y.pressure=b,y.radius=n*i(.5-r*(.5-y.pressure))}),t}else{let b;for(let y=0,v=t.length;y<v&&(p=t[y],!(p.runningLength>n*5));y++){const x=ga(1,p.distance/n);if(s){const S=ga(1,1-x);b=ga(1,d+(S-d)*(x*av))}else b=ga(1,d+(p.pressure-d)*.5);d=d+(b-d)*.5}for(let y=0;y<t.length;y++){if(p=t[y],r){let{pressure:v}=p;const x=ga(1,p.distance/n);if(s){const S=ga(1,1-x);v=ga(1,d+(S-d)*(x*av))}else v=ga(1,d+(v-d)*(x*av));p.radius=n*i(.5-r*(.5-v)),d=v}else p.radius=n/2;h===void 0&&(h=p.radius)}}const m=a.taper===!1?0:a.taper===!0?Math.max(n,f):a.taper,g=l.taper===!1?0:l.taper===!0?Math.max(n,f):l.taper;if(m||g)for(let b=0;b<t.length;b++){p=t[b];const{runningLength:y}=p,v=y<m?c(y/m):1,x=f-y<g?u((f-y)/g):1;p.radius=Math.max(.01,p.radius*Math.min(v,x))}return t}function NW(t,o={}){return YS(my(di(t,o),o),o)}function Jj({scribble:t,zoom:o,color:n,opacity:r,className:s}){if(!t.points.length)return null;const i=NW(t.points,{size:t.size/o,start:{taper:t.taper,easing:Kn.linear},last:t.state==="stopping",simulatePressure:!1,streamline:.32});let a;if(i.length<4){const l=t.size/o/2,{x:c,y:u}=t.points[t.points.length-1];a=`M ${c-l},${u} a ${l},${l} 0 1,0 ${l*2},0 a ${l},${l} 0 1,0 ${-l*2},0`}else a=dS(i);return C.jsx("svg",{className:s&&Tt("tl-overlays__item",s),children:C.jsx("path",{className:"tl-scribble",d:a,fill:n??`var(--color-${t.color})`,opacity:r??t.opacity})})}const $W=({bounds:t,rotation:o})=>{const n=Ue();return He("should display",()=>n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[n])?C.jsx(yI,{bounds:t,rotation:o}):null};function na(){const t=Ue();return He("isReadonlyMode",()=>t.getInstanceState().isReadonly,[t])}function UW({size:t,width:o,height:n,hideAlternateHandles:r}){const s=Ee(t/3),i=s/2;return C.jsxs("svg",{className:"tl-overlays__item",children:[C.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${Ee(0-i)},${Ee(t)} 
						${Ee(0-i)},${Ee(0-i)} 
						${Ee(t)},${Ee(0-i)}`,strokeWidth:s,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),C.jsx("line",{className:Tt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Ee(o/2-t),y1:Ee(0-i),x2:Ee(o/2+t),y2:Ee(0-i),strokeWidth:s,"data-testid":"selection.crop.top","aria-label":"top handle"}),C.jsx("polyline",{className:Tt("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${Ee(o-t)},${Ee(0-i)} 
						${Ee(o+i)},${Ee(0-i)} 
						${Ee(o+i)},${Ee(t)}`,strokeWidth:s,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),C.jsx("line",{className:Tt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Ee(o+i),y1:Ee(n/2-t),x2:Ee(o+i),y2:Ee(n/2+t),strokeWidth:s,"data-testid":"selection.crop.right","aria-label":"right handle"}),C.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${Ee(o+i)},${Ee(n-t)} 
						${Ee(o+i)},${Ee(n+i)}
						${Ee(o-t)},${Ee(n+i)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),C.jsx("line",{className:Tt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Ee(o/2-t),y1:Ee(n+i),x2:Ee(o/2+t),y2:Ee(n+i),strokeWidth:s,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),C.jsx("polyline",{className:Tt("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${Ee(0+t)},${Ee(n+i)} 
						${Ee(0-i)},${Ee(n+i)}
						${Ee(0-i)},${Ee(n-t)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),C.jsx("line",{className:Tt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:Ee(0-i),y1:Ee(n/2-t),x2:Ee(0-i),y2:Ee(n/2+t),strokeWidth:s,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const BW=os(function({bounds:o,rotation:n}){const r=Ue(),s=B.useRef(null),i=na(),a=Qs("top"),l=Qs("right"),c=Qs("bottom"),u=Qs("left"),f=Qs("top_left"),h=Qs("top_right"),d=Qs("bottom_right"),p=Qs("bottom_left"),m=!r.getIsMenuOpen()&&r.getInstanceState().cursor.type==="default",g=r.getInstanceState().isCoarsePointer,b=r.getOnlySelectedShape(),y=b&&r.isShapeOrAncestorLocked(b),v=b?r.getShapeUtil(b).expandSelectionOutlinePx(b):0;if(Mu(s,o==null?void 0:o.x,o==null?void 0:o.y,1,r.getSelectionRotation(),{x:-v,y:-v}),!o)return null;o=o.clone().expandBy(v).zeroFix();const x=r.getZoomLevel(),S=r.getInstanceState().isChangingStyle,w=o.width,E=o.height,j=8/x,P=w<j*2,M=E<j*2,O=w<j*4,k=E<j*4,F=w<j*5,A=E<j*5,N=g?1.75:1,$=6/x*N,G=(O?$/2:$)*(N*.75),X=(k?$/2:$)*(N*.75),W=(b?!r.getShapeUtil(b).hideSelectionBoundsFg(b):!0)&&!S;let V=W&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||W&&r.isIn("select.resizing")&&b&&r.isShapeOfType(b,"text");b&&V&&r.environment.isFirefox&&r.isShapeOfType(b,"embed")&&(V=!1);const q=r.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!S&&!i,J=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!S&&!i,ae=!g&&!(P||M)&&(J||q)&&(b?!r.getShapeUtil(b).hideRotateHandle(b):!0)&&!y,I=g&&(!O||!k)&&(J||q)&&(b?!r.getShapeUtil(b).hideRotateHandle(b):!0)&&!y,U=J&&(b?r.getShapeUtil(b).canResize(b)&&!r.getShapeUtil(b).hideResizeHandles(b):!0)&&!q&&!y,z=P||M,K=P&&M,te=F||A,ne=U||q,le=!ae,me=!J||!I,ce=!J||!ne,ge=!J||!ne||z,pe=!J||!ne||z,oe=!J||!ne||K&&!q;let de=!0,xe=!0;if(q)de=te,xe=te;else if(U){de=z||K||g;const je=g&&b&&b.type==="text";xe=de&&!je}const Te=Math.min(24/x,E-X*3),Se=J&&g&&b&&r.isShapeOfType(b,"text")&&Te*x>=4;return C.jsx("svg",{className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:C.jsxs("g",{ref:s,children:[V&&C.jsx("rect",{className:"tl-selection__fg__outline",width:Ee(w),height:Ee(E)}),C.jsx(qf,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:$,corner:"top_left_rotate",cursor:m?Bo("nwse-rotate",n):void 0,isHidden:le}),C.jsx(qf,{"data-testid":"selection.rotate.top-right",cx:w+$*3,cy:0,targetSize:$,corner:"top_right_rotate",cursor:m?Bo("nesw-rotate",n):void 0,isHidden:le}),C.jsx(qf,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:E+$*3,targetSize:$,corner:"bottom_left_rotate",cursor:m?Bo("swne-rotate",n):void 0,isHidden:le}),C.jsx(qf,{"data-testid":"selection.rotate.bottom-right",cx:w+$*3,cy:E+$*3,targetSize:$,corner:"bottom_right_rotate",cursor:m?Bo("senw-rotate",n):void 0,isHidden:le}),C.jsx(GW,{"data-testid":"selection.rotate.mobile",cx:O?-$*1.5:w/2,cy:O?E/2:-$*1.5,size:j,isHidden:me}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":de}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:Ee(0-(k?X*2:X)),width:Ee(w),height:Ee(Math.max(1,X*2)),style:m?{cursor:Bo("ns-resize",n)}:void 0,...a}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":xe}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:Ee(w-(O?0:G)),y:0,height:Ee(E),width:Ee(Math.max(1,G*2)),style:m?{cursor:Bo("ew-resize",n)}:void 0,...l}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":de}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:Ee(E-(k?0:X)),width:Ee(w),height:Ee(Math.max(1,X*2)),style:m?{cursor:Bo("ns-resize",n)}:void 0,...c}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":xe}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:Ee(0-(O?G*2:G)),y:0,height:Ee(E),width:Ee(Math.max(1,G*2)),style:m?{cursor:Bo("ew-resize",n)}:void 0,...u}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":ce}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:Ee(0-(O?G*2:G*1.5)),y:Ee(0-(k?X*2:X*1.5)),width:Ee(G*3),height:Ee(X*3),style:m?{cursor:Bo("nwse-resize",n)}:void 0,...f}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":ge}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:Ee(w-(O?0:G*1.5)),y:Ee(0-(k?X*2:X*1.5)),width:Ee(G*3),height:Ee(X*3),style:m?{cursor:Bo("nesw-resize",n)}:void 0,...h}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":oe}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:Ee(w-(O?G:G*1.5)),y:Ee(E-(k?X:X*1.5)),width:Ee(G*3),height:Ee(X*3),style:m?{cursor:Bo("nwse-resize",n)}:void 0,...d}),C.jsx("rect",{className:Tt("tl-transparent",{"tl-hidden":pe}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:Ee(0-(O?G*3:G*1.5)),y:Ee(E-(k?0:X*1.5)),width:Ee(G*3),height:Ee(X*3),style:m?{cursor:Bo("nesw-resize",n)}:void 0,...p}),U&&C.jsxs(C.Fragment,{children:[C.jsx("rect",{"data-testid":"selection.resize.top-left",className:Tt("tl-corner-handle",{"tl-hidden":ce}),"aria-label":"top_left handle",x:Ee(0-j/2),y:Ee(0-j/2),width:Ee(j),height:Ee(j)}),C.jsx("rect",{"data-testid":"selection.resize.top-right",className:Tt("tl-corner-handle",{"tl-hidden":ge}),"aria-label":"top_right handle",x:Ee(w-j/2),y:Ee(0-j/2),width:Ee(j),height:Ee(j)}),C.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:Tt("tl-corner-handle",{"tl-hidden":oe}),"aria-label":"bottom_right handle",x:Ee(w-j/2),y:Ee(E-j/2),width:Ee(j),height:Ee(j)}),C.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:Tt("tl-corner-handle",{"tl-hidden":pe}),"aria-label":"bottom_left handle",x:Ee(0-j/2),y:Ee(E-j/2),width:Ee(j),height:Ee(j)})]}),Se&&C.jsxs(C.Fragment,{children:[C.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:Ee(0-j/4),y:Ee(E/2-Te/2),rx:j/4,width:Ee(j/2),height:Ee(Te)}),C.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:j/4,x:Ee(w-j/4),y:Ee(E/2-Te/2),width:Ee(j/2),height:Ee(Te)})]}),q&&C.jsx(UW,{size:j,width:w,height:E,hideAlternateHandles:te})]})})}),qf=function({cx:o,cy:n,targetSize:r,corner:s,cursor:i,isHidden:a,"data-testid":l}){const c=Qs(s);return C.jsx("rect",{className:Tt("tl-transparent","tl-rotate-corner",{"tl-hidden":a}),"data-testid":l,"aria-label":`${s} target`,pointerEvents:"all",x:Ee(o-r*3),y:Ee(n-r*3),width:Ee(Math.max(1,r*3)),height:Ee(Math.max(1,r*3)),cursor:i,...c})},zW=Math.sqrt(Math.PI),GW=function({cx:o,cy:n,size:r,isHidden:s,"data-testid":i}){const a=Qs("mobile_rotate"),l=Ue(),c=He("zoom level",()=>l.getZoomLevel(),[l]),u=Math.max(14*(1/c),20/Math.max(1,c));return C.jsxs("g",{children:[C.jsx("circle",{"data-testid":i,pointerEvents:"all",className:Tt("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":s}),cx:o,cy:n,r:u,...a}),C.jsx("circle",{className:Tt("tl-mobile-rotate__fg",{"tl-hidden":s}),cx:o,cy:n,r:r/zW})]})},Dn={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},_n={s:2,m:3.5,l:5,xl:10},bu={s:18,m:24,l:36,xl:44},Fi={s:18,m:22,l:26,xl:32},xl={s:18,m:20,l:24,xl:28},li={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},VW=20,HW=4.25,Os=16;/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function WW(t,o){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,o===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==o);c=!0);}catch(f){u=!0,s=f}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function eE(t,o){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);o&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function zo(t){for(var o=1;o<arguments.length;o++){var n=arguments[o]!=null?arguments[o]:{};o%2?eE(Object(n),!0).forEach(function(r){YW(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eE(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YW(t,o,n){return o=rY(o),o in t?Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[o]=n,t}function XW(t,o){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(o.indexOf(s)>=0)&&(n[s]=t[s]);return n}function qW(t,o){if(t==null)return{};var n=XW(t,o),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(o.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function tE(t,o){return ZW(t)||WW(t,o)||e3(t,o)||eY()}function Kf(t){return KW(t)||QW(t)||e3(t)||JW()}function KW(t){if(Array.isArray(t))return S1(t)}function ZW(t){if(Array.isArray(t))return t}function QW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function e3(t,o){if(t){if(typeof t=="string")return S1(t,o);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S1(t,o)}}function S1(t,o){(o==null||o>t.length)&&(o=t.length);for(var n=0,r=new Array(o);n<o;n++)r[n]=t[n];return r}function JW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tY(t,o){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,o||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(t)}function rY(t){var o=tY(t,"string");return typeof o=="symbol"?o:String(o)}function Gd(t){var o=t.sizes.shift(),n=Math.max(Math.ceil(o[0]),1),r=Math.max(Math.ceil(o[1]),1),s=[n-1,r-1,1,1],i=Date.now(),a=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,l,c;a?(l=new OffscreenCanvas(1,1),c=new OffscreenCanvas(n,r)):(l=document.createElement("canvas"),l.width=1,l.height=1,c=document.createElement("canvas"),c.width=n,c.height=r);var u=l.getContext("2d"),f=c.getContext("2d");f&&(f.fillRect.apply(f,s),u.drawImage(c,n-1,r-1,1,1,0,0,1,1));var h=u&&u.getImageData(0,0,1,1).data[3]!==0,d=Date.now()-i;return[l,c].forEach(function(p){p.height=0,p.width=0}),a?(postMessage({width:n,height:r,benchmark:d,isTestPass:h}),!h&&t.sizes.length&&Gd(t)):h?t.onSuccess(n,r,d):(t.onError(n,r,d),t.sizes.length&&Gd(t)),h}var lv={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},nY=["onError","onSuccess"],Wc={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},fd={};function cv(t){var o=t.width===t.height,n=t.height===1,r=t.width===1,s=[];if(!t.width||!t.height)t.sizes.forEach(function(f){var h=o||n?f:1,d=o||r?f:1;s.push([h,d])});else for(var i=t.min||Wc.min,a=t.step||Wc.step,l=Math.max(t.width,t.height);l>=i;){var c=o||n?l:1,u=o||r?l:1;s.push([c,u]),l-=a}return s}function Zf(t){var o=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),s=t.onError,i=t.onSuccess,a=qW(t,nY),l=null;if(!o)return!1;if(t.useWorker&&n){var c=`
            var canvasTest = `.concat(Gd.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),u=new Blob([c],{type:"application/javascript"}),f=URL.createObjectURL(u);l=new Worker(f),URL.revokeObjectURL(f),l.onmessage=function(h){var d=h.data,p=d.width,m=d.height,g=d.benchmark,b=d.isTestPass;b?(fd[r].onSuccess(p,m,g),delete fd[r]):fd[r].onError(p,m,g)}}if(t.usePromise)return new Promise(function(h,d){var p=zo(zo({},t),{},{onError:function(y,v,x){var S;if(t.sizes.length===0)S=!0;else{var w=t.sizes.slice(-1),E=tE(w,1),j=tE(E[0],2),P=j[0],M=j[1];S=y===P&&v===M}s(y,v,x),S&&d({width:y,height:v,benchmark:x})},onSuccess:function(y,v,x){i(y,v,x),h({width:y,height:v,benchmark:x})}});if(l){var m=p.onError,g=p.onSuccess;fd[r]={onError:m,onSuccess:g},l.postMessage(a)}else Gd(p)});if(l)fd[r]={onError:s,onSuccess:i},l.postMessage(a);else return Gd(t)}var uv={maxArea:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=cv({width:o.max,height:o.max,min:o.min,step:o.step,sizes:Kf(lv.area)}),r=zo(zo(zo({},Wc),o),{},{sizes:n});return Zf(r)},maxHeight:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=cv({width:1,height:o.max,min:o.min,step:o.step,sizes:Kf(lv.height)}),r=zo(zo(zo({},Wc),o),{},{sizes:n});return Zf(r)},maxWidth:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=cv({width:o.max,height:1,min:o.min,step:o.step,sizes:Kf(lv.width)}),r=zo(zo(zo({},Wc),o),{},{sizes:n});return Zf(r)},test:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=zo(zo({},Wc),o);return n.sizes=Kf(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),Zf(n)}};let dv=null;function oY(){return dv||(dv=sY()),dv}async function sY(){const t=await uv.maxWidth({usePromise:!0}),o=await uv.maxHeight({usePromise:!0}),n=await uv.maxArea({usePromise:!0});return{maxWidth:t.width,maxHeight:o.height,maxArea:n.width*n.height}}const rE=8192,iY=4096*4096;async function t3(t,o){if(t<=rE&&o<=rE&&t*o<=iY)return[t,o];const{maxWidth:n,maxHeight:r,maxArea:s}=await oY(),i=t/o;if(t>n&&(t=n,o=t/i),o>r&&(o=r,t=o*i),t*o>s){const a=Math.sqrt(s/(t*o));t*=a,o*=a}return[t,o]}/*!
 * MIT License
 * Modified code originally from <https://github.com/qzb/is-animated>
 * Copyright (c) 2016 Józef Sokołowski <j.k.sokolowski@gmail.com>
 */function nE(t,o){let n=0;for(;t[o+n];)n+=t[o+n]+1;return n+1}function aY(t){return new TextDecoder("ascii").decode(t.slice(0,3))==="GIF"}function lY(t){const o=new Uint8Array(t);let n,r,s=0,i=0;if(!aY(t))return!1;for(n=o[10]&128,r=o[10]&7,s+=6,s+=7,s+=n?3*Math.pow(2,r+1):0;i<2&&s<o.length;)switch(o[s]){case 44:i+=1,n=o[s+9]&128,r=o[s+9]&7,s+=10,s+=n?3*Math.pow(2,r+1):0,s+=nE(o,s+1)+1;break;case 33:s+=2,s+=nE(o,s);break;case 59:s=o.length;break;default:s=o.length;break}return i>1}function cY(t,o){const n=t.w/o.w,r=t.h/o.h;return n<=1&&r<=1?t:n>r?{w:t.w/n,h:t.h/n}:{w:t.w/r,h:t.h/r}}async function uY(t,o,n,r={}){const s=await Ai.usingObjectURL(t,Ai.loadImage),{type:i=t.type,quality:a=.92}=r,[l,c]=await t3(Math.min(o*2,s.naturalWidth),Math.min(n*2,s.naturalHeight)),u=document.createElement("canvas");u.width=l,u.height=c;const f=El(u.getContext("2d",{willReadFrequently:!0}),"Could not get canvas context");return f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(s,0,0,l,c),new Promise((h,d)=>{u.toBlob(p=>{p?h(p):d(new Error("Could not resize image"))},i,a)})}async function dY(t){return lY(await t.arrayBuffer())}function hY(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function fY(t){const o=new URL(t).host.replace("www.","");for(const n of $h)if(r3(n.hostnames,o)){const r=n.fromEmbedUrl(t);if(r)return{definition:n,url:r,embedUrl:t}}}const pY=t=>t.split("*").map(o=>hY(o)).join(".+"),r3=(t,o)=>!!t.find(n=>{const r=new RegExp(pY(n));return o.match(r)});function mY(t){const o=new URL(t).host.replace("www.","");for(const n of $h)if(r3(n.hostnames,o)){const r=n.toEmbedUrl(t);if(r)return{definition:n,embedUrl:r,url:t}}}function n3(t){return mY(t)??fY(t)}function Ta(t){try{return n3(t)}catch(o){console.error(o)}}/*!
 * MIT License
 * Adapted (mostly copied) the work of https://github.com/fregante/text-field-edit
 * Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)
 */const Yc="  ",lo=class lo{static insertTextFirefox(o,n){o.setRangeText(n,o.selectionStart||0,o.selectionEnd||0,"end"),o.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(o,n){const r=o.ownerDocument,s=r.activeElement;s!==o&&o.focus(),r.execCommand("insertText",!1,n)||lo.insertTextFirefox(o,n),s===r.body?o.blur():s instanceof HTMLElement&&s!==o&&s.focus()}static set(o,n){o.select(),lo.insert(o,n)}static getSelection(o){const{selectionStart:n,selectionEnd:r}=o;return o.value.slice(n||void 0,r||void 0)}static wrapSelection(o,n,r){const{selectionStart:s,selectionEnd:i}=o,a=lo.getSelection(o);lo.insert(o,n+a+(r??n)),o.selectionStart=(s||0)+n.length,o.selectionEnd=(i||0)+n.length}static replace(o,n,r){let s=0;o.value.replace(n,(...i)=>{const a=s+i[i.length-2],l=i[0].length;o.selectionStart=a,o.selectionEnd=a+l;const c=typeof r=="string"?r:r(...i);return lo.insert(o,c),o.selectionStart=a,s+=c.length-l,c})}static findLineEnd(o,n){const r=o.lastIndexOf(`
`,n-1)+1;return o.charAt(r)!=="	"?n:r+1}static indent(o){var l;const{selectionStart:n,selectionEnd:r,value:s}=o,i=s.slice(n,r),a=(l=/\n/g.exec(i))==null?void 0:l.length;if(a&&a>0){const c=s.lastIndexOf(`
`,n-1)+1,u=o.value.slice(c,r-1),f=u.replace(/^|\n/g,`$&${Yc}`),h=f.length-u.length;o.setSelectionRange(c,r-1),lo.insert(o,f),o.setSelectionRange(n+1,r+h)}else lo.insert(o,Yc)}static unindent(o){const{selectionStart:n,selectionEnd:r,value:s}=o,i=s.lastIndexOf(`
`,n-1)+1,a=lo.findLineEnd(s,r),l=o.value.slice(i,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;o.setSelectionRange(i,a),lo.insert(o,c);const f=/\t| {1,2}/.exec(s.slice(i,n)),h=f?f[0].length:0,d=n-h;o.setSelectionRange(n-h,Math.max(d,r-u))}static indentCE(o){var c;const n=window.getSelection(),r=o.innerText,s=Qf(o)??0,i=Qf(o)??0,a=r.slice(s,i),l=(c=/\n/g.exec(a))==null?void 0:c.length;if(l&&l>0){const u=r.lastIndexOf(`
`,s-1)+1,f=r.slice(u,i-1),d=f.replace(/^|\n/g,`$&${Yc}`).length-f.length;n&&n.setBaseAndExtent(o,s+1,o,i+d)}else{const u=window.getSelection();o.innerText=r.slice(0,s)+Yc+r.slice(s),u==null||u.setBaseAndExtent(o,s+1,o,s+2)}}static unindentCE(o){const n=window.getSelection(),r=o.innerText,s=Qf(o)??0,i=Qf(o)??0,a=r.lastIndexOf(`
`,s-1)+1,l=lo.findLineEnd(r,i),c=r.slice(a,l),u=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),f=c.length-u.length;if(n){n.setBaseAndExtent(o,a,o,l);const h=/\t| {1,2}/.exec(r.slice(a,s)),d=h?h[0].length:0,p=s-d;n.setBaseAndExtent(o,s-d,o,Math.max(p,i-f))}}static normalizeText(o){return o.replace(lo.fixNewLines,`
`)}static normalizeTextForDom(o){return o.replace(lo.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};D(lo,"fixNewLines",/\r?\n|\r/g);let xu=lo;function Qf(t){if(typeof window.getSelection>"u")return;const o=window.getSelection();if(!o)return;let n=0;if(o.rangeCount!==0){const r=o.getRangeAt(0),s=r.cloneRange();s.selectNodeContents(t),s.setEnd(r.endContainer,r.endOffset),n=s.toString().length}return n}const gY=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function o3(t){return gY.test(t)}function yY(t){return t.replace(/\t/g,Yc)}function vY(t){const o=t.split(`
`);for(;o[0]&&o[0].trim().length===0;)o.shift();let n=1/0;for(const r of o)if(r.trim().length>0){const s=r.length-r.trimStart().length;n=Math.min(n,s)}return o.map(r=>r.slice(n)).join(`
`)}function bY(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function xY(t){return bY(vY(yY(t)))}const Vd=(t,o)=>t.length<=o?t:t.substring(0,o-3)+"...";function SY(t,{maxImageDimension:o,maxAssetSize:n,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:s},{toasts:i,msg:a}){t.registerExternalAssetHandler("file",async({file:l})=>{const c=l.name;let u=l;const f=r.includes(u.type),h=s.includes(u.type);bn(f||h,`File type not allowed: ${u.type}`),bn(u.size<=n,`File size too big: ${(u.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),u.type==="video/quicktime"&&(u=new Blob([u],{type:"video/mp4"}));let d=f?await Ai.getImageSize(u):await Ai.getVideoSize(u);const p=u.type==="image/gif"?await dY(u):h,m=await WL(await u.arrayBuffer());if(isFinite(o)){const y=cY(d,{w:o,h:o});d!==y&&(u.type==="image/jpeg"||u.type==="image/png")&&(d=y)}(u.type==="image/jpeg"||u.type==="image/png")&&(u=await uY(u,d.w,d.h,{type:u.type,quality:.92}));const g=Cl.createId(m);return Cl.create({id:g,type:f?"image":"video",typeName:"asset",props:{name:c,src:await ru.blobToDataUrl(u),w:d.w,h:d.h,mimeType:u.type,isAnimated:p}})}),t.registerExternalAssetHandler("url",async({url:l})=>{var u,f,h;let c;try{const p=await(await fetch(l,{method:"GET",mode:"no-cors"})).text(),m=new DOMParser().parseFromString(p,"text/html");c={image:((u=m.head.querySelector('meta[property="og:image"]'))==null?void 0:u.getAttribute("content"))??"",title:((f=m.head.querySelector('meta[property="og:title"]'))==null?void 0:f.getAttribute("content"))??Vd(l,32),description:((h=m.head.querySelector('meta[property="og:description"]'))==null?void 0:h.getAttribute("content"))??""}}catch(d){console.error(d),i.addToast({title:a("assets.url.failed"),severity:"error"}),c={image:"",title:Vd(l,32),description:""}}return{id:Cl.createId(Vb(l)),typeName:"asset",type:"bookmark",props:{src:l,description:c.description,image:c.image,title:c.title},meta:{}}}),t.registerExternalContentHandler("svg-text",async({point:l,text:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=new DOMParser().parseFromString(c,"image/svg+xml").querySelector("svg");if(!f)throw new Error("No <svg/> element present");let h=parseFloat(f.getAttribute("width")||"0"),d=parseFloat(f.getAttribute("height")||"0");if(!(h&&d)){document.body.appendChild(f);const m=f.getBoundingClientRect();document.body.removeChild(f),h=m.width,d=m.height}const p=await t.getAssetForExternalContent({type:"file",file:new File([c],"asset.svg",{type:"image/svg+xml"})});if(!p)throw Error("Could not create an asset");oE(t,[p],u)}),t.registerExternalContentHandler("embed",({point:l,url:c,embed:u})=>{const f=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),{width:h,height:d}=u,p=hr(),m={id:p,type:"embed",x:f.x-(h||450)/2,y:f.y-(d||450)/2,props:{w:h,h:d,url:c}};t.createShapes([m]).select(p)}),t.registerExternalContentHandler("files",async({point:l,files:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=new Y(u.x,u.y),h=[];await Promise.all(c.map(async(d,p)=>{if(d.size>n)return console.warn(`File size too big: ${(d.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),null;if(!d.type)throw new Error("No mime type");if(!r.concat(s).includes(d.type))return console.warn(`${d.name} not loaded - Extension not allowed.`),null;try{const m=await t.getAssetForExternalContent({type:"file",file:d});if(!m)throw Error("Could not create an asset");h[p]=m}catch(m){return i.addToast({title:a("assets.files.upload-failed"),severity:"error"}),console.error(m),null}})),oE(t,Rt(h),f)}),t.registerExternalContentHandler("text",async({point:l,text:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=t.getShapeUtil("text").getDefaultProps(),h=xY(c),d=t.getOnlySelectedShape();if(d&&"text"in d.props){t.updateShapes([{id:d.id,type:d.type,props:{text:h}}]);return}let p,m,g,b="middle";const y=h.split(`
`).length>1,v=o3(h);y&&(b=y?v?"end":"start":"middle");const x=t.textMeasure.measureText(h,{...Dn,fontFamily:li[f.font],fontSize:bu[f.size],maxWidth:null}),S=Math.min(y?t.getViewportPageBounds().width*.9:920,Math.max(200,t.getViewportPageBounds().width*.9));if(x.w>S){const w=t.textMeasure.measureText(h,{...Dn,fontFamily:li[f.font],fontSize:bu[f.size],maxWidth:S});p=w.w,m=w.h,g=!1,b=v?"end":"start"}else p=x.w,m=x.h,g=!0;u.y-m/2<t.getViewportPageBounds().minY+40&&(u.y=t.getViewportPageBounds().minY+40+m/2),t.createShapes([{id:hr(),type:"text",x:u.x-p/2,y:u.y-m/2,props:{text:h,align:b,autoSize:g,w:p}}])}),t.registerExternalContentHandler("url",async({point:l,url:c})=>{const u=Ta(c);if(u)return t.putExternalContent({type:"embed",url:u.url,point:l,embed:u.definition});const f=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),h=Cl.createId(Vb(c)),d=wY(t,c,f);let p=t.getAsset(h),m=!1;if(!p){m=!0;try{const g=await t.getAssetForExternalContent({type:"url",url:c});if(!g)throw Error("Could not create an asset");p=g}catch{i.addToast({title:a("assets.url.failed"),severity:"error"});return}}t.batch(()=>{m&&t.createAssets([p]),t.updateShapes([{id:d.id,type:d.type,props:{assetId:p.id}}])})})}async function oE(t,o,n){if(!o.length)return[];const r=Y.From(n),s=[];for(const i of o)switch(i.type){case"bookmark":{s.push({id:hr(),type:"bookmark",x:r.x-150,y:r.y-160,opacity:1,props:{assetId:i.id,url:i.props.src}}),r.x+=300;break}case"image":{s.push({id:hr(),type:"image",x:r.x-i.props.w/2,y:r.y-i.props.h/2,opacity:1,props:{assetId:i.id,w:i.props.w,h:i.props.h}}),r.x+=i.props.w;break}case"video":s.push({id:hr(),type:"video",x:r.x-i.props.w/2,y:r.y-i.props.h/2,opacity:1,props:{assetId:i.id,w:i.props.w,h:i.props.h}}),r.x+=i.props.w}return t.batch(()=>{const i=o.filter(a=>!t.getAsset(a.id));i.length&&t.createAssets(i),t.createShapes(s).select(...s.map(a=>a.id)),s3(t,n)}),s.map(i=>i.id)}function s3(t,o){const n=t.getViewportPageBounds();let r=t.getSelectionPageBounds();if(r){const s=r.center.sub(o);t.updateShapes(t.getSelectedShapes().map(i=>{const a=t.getShapeParentTransform(i).decompose().rotation,l=Y.Rot(s,-a);return{id:i.id,type:i.type,x:i.x-l.x,y:i.y-l.y}}))}r=t.getSelectionPageBounds(),r&&!n.contains(r)&&t.zoomToSelection()}function wY(t,o,n){const r={id:hr(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:null,url:o}};return t.batch(()=>{t.createShapes([r]).select(r.id),s3(t,n)}),t.getShape(r.id)}var Ov;let _Y=(Ov=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")});D(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}})}},D(Ov,"id","idle"),Ov);var Av;let jY=(Av=class extends bt{constructor(){super(...arguments);D(this,"shape");D(this,"markId","");D(this,"onEnter",()=>{this.didTimeout=!1;const n=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:r=>!r.isLocked&&this.editor.getShapeUtil(r).canBind(r),margin:0,hitInside:!0,renderingOnly:!0});n?this.editor.setHintingShapes([n.id]):this.createArrowShape(),this.startPreciseTimeout()});D(this,"onExit",()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()});D(this,"onPointerMove",()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find(n=>n.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});D(this,"onPointerUp",()=>{this.cancel()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()});D(this,"preciseTimeout",-1);D(this,"didTimeout",!1)}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var f,h;const{originPagePoint:n}=this.editor.inputs,r=hr();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"arrow",x:n.x,y:n.y}]);const s=this.editor.getShape(r);if(!s)throw Error("expected shape");const i=this.editor.getShapeHandles(s);if(!i)throw Error("expected handles for arrow");const a=this.editor.getShapeUtil("arrow"),l=this.shape,c=i.find(d=>d.id==="start"),u=(f=a.onHandleDrag)==null?void 0:f.call(a,s,{handle:{...c,x:0,y:0},isPrecise:!0,initial:l});if(u){const d=(h=u.props)==null?void 0:h.start;(d==null?void 0:d.type)==="binding"&&this.editor.setHintingShapes([d.boundShapeId]),this.editor.updateShapes([u],{squashing:!0})}this.shape=this.editor.getShape(r),this.editor.select(r)}updateArrowShapeEndHandle(){var i,a,l;const n=this.shape;if(!n)throw Error("expected shape");const r=this.editor.getShapeHandles(n);if(!r)throw Error("expected handles for arrow");const s={...n,props:{...n.props,end:{...n.props.end,x:0,y:0}}};{const c=this.editor.getShapeUtil("arrow"),u=this.shape,f=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint),h=r.find(p=>p.id==="end"),d=(i=c.onHandleDrag)==null?void 0:i.call(c,s,{handle:{...h,x:f.x,y:f.y},isPrecise:!1,initial:u});if(d){const p=(a=d.props)==null?void 0:a.end;(p==null?void 0:p.type)==="binding"&&this.editor.setHintingShapes([p.boundShapeId]),this.editor.updateShapes([d],{squashing:!0})}}{const c=this.editor.getShapeUtil("arrow"),u=this.shape,f=r.find(d=>d.id==="start"),h=(l=c.onHandleDrag)==null?void 0:l.call(c,s,{handle:{...f,x:0,y:0},isPrecise:this.didTimeout,initial:u});h&&this.editor.updateShapes([h],{squashing:!0})}this.shape=this.editor.getShape(n.id)}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},D(Av,"id","pointing"),Av);class Gp extends bt{constructor(){super(...arguments);D(this,"shapeType","arrow")}}D(Gp,"id","arrow"),D(Gp,"initial","idle"),D(Gp,"children",()=>[_Y,jY]);class XS extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"initialShape");D(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");D(this,"util",this.editor.getShapeUtil(this.shapeType));D(this,"isPen",!1);D(this,"segmentMode","free");D(this,"didJustShiftClickToExtendPreviousShapeLine",!1);D(this,"pagePointWhereCurrentSegmentChanged",{});D(this,"pagePointWhereNextSegmentChanged",null);D(this,"lastRecordedPoint",{});D(this,"mergeNextPoint",!1);D(this,"currentLineLength",0);D(this,"canDraw",!1);D(this,"markId",null);D(this,"onEnter",n=>{this.markId=null,this.info=n,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});D(this,"onPointerMove",()=>{const{inputs:n}=this.editor;if(this.isPen!==n.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&n.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(n.isPen?Y.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateDrawingShape())});D(this,"onKeyDown",n=>{if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateDrawingShape()});D(this,"onKeyUp",n=>{if(n.key==="Shift")switch(this.editor.snaps.clearIndicators(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateDrawingShape()});D(this,"onExit",()=>{this.editor.snaps.clearIndicators(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(n,r){if(!this.canClose())return!1;const s=_n[r],i=n[0].points[0],a=n[n.length-1],l=a.points[a.points.length-1];return i!==l&&this.currentLineLength>s*4&&Y.DistMin(i,l,s*2)}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.editor;this.markId="draw start "+Mr(),this.editor.mark(this.markId),this.isPen=r;const s=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const a=this.editor.getShape(this.initialShape.id);if(a&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const l=Ho(a.props.segments);if(!l)throw Error("Expected a previous segment!");const c=Ho(l.points);if(!c)throw Error("Expected a previous point!");const{x:u,y:f}=this.editor.getPointInShapeSpace(a,n).toFixed(),h=this.isPen?this.info.point.z*1.25:.5,d={type:this.segmentMode,points:[{x:c.x,y:c.y,z:+h.toFixed(2)},{x:u,y:f,z:+h.toFixed(2)}]},p=vt.applyToPoint(this.editor.getShapePageTransform(a.id),c);this.pagePointWhereCurrentSegmentChanged=p,this.pagePointWhereNextSegmentChanged=null;const m=[...a.props.segments,d];this.currentLineLength<_n[a.props.size]*4&&(this.currentLineLength=this.getLineLength(m));const g={id:a.id,type:this.shapeType,props:{segments:m}};this.canClose()&&(g.props.isClosed=this.getIsClosed(m,a.props.size)),this.editor.updateShapes([g]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const i=hr();this.editor.createShapes([{id:i,type:this.shapeType,x:n.x,y:n.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+s.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(i)}updateDrawingShape(){const{initialShape:n}=this,{inputs:r}=this.editor;if(!n)return;const{id:s,props:{size:i}}=n,a=this.editor.getShape(s);if(!a)return;const{segments:l}=a.props,{x:c,y:u,z:f}=this.editor.getPointInShapeSpace(a,r.currentPagePoint).toFixed(),h={x:c,y:u,z:this.isPen?+(f*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:d}=this;if(d===null)throw Error("We should have a point where the segment changed");if(Y.Dist2(d,r.currentPagePoint)>gh){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const m=Ho(l);if(!m)throw Error("Expected a previous segment!");const g=Ho(m.points);if(!g)throw Error("Expected a previous last point!");let b;const y=this.editor.getPointInShapeSpace(a,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(m.type==="straight"){this.currentLineLength+=Y.Dist(g,y),b={type:"straight",points:[{...g},y]};const x=this.editor.getShapePageTransform(a);this.pagePointWhereCurrentSegmentChanged=vt.applyToPoint(x,g)}else b={type:"straight",points:[y,h]};const v={id:s,type:this.shapeType,props:{segments:[...l,b]}};this.canClose()&&(v.props.isClosed=this.getIsClosed(l,i)),this.editor.updateShapes([v],{squashing:!0})}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:d}=this;if(d===null)throw Error("We should have a point where the segment changed");if(Y.Dist2(d,r.currentPagePoint)>gh){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const m=l.slice(),g=m[m.length-1],b=Ho(g.points);if(!b)throw Error("No previous point!");const y={type:"free",points:[...Y.PointsBetween(b,h,6).map(S=>S.toFixed().toJson())]},v=[...m,y];this.currentLineLength<_n[a.props.size]*4&&(this.currentLineLength=this.getLineLength(v));const x={id:s,type:this.shapeType,props:{segments:v}};this.canClose()&&(x.props.isClosed=this.getIsClosed(v,i)),this.editor.updateShapes([x],{squashing:!0})}break}case"straight":{const d=l.slice(),p=d[d.length-1],{pagePointWhereCurrentSegmentChanged:m}=this,{ctrlKey:g,currentPagePoint:b}=this.editor.inputs;if(!m)throw Error("We should have a point where the segment changed");let y,v=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(v=!g,this.didJustShiftClickToExtendPreviousShapeLine=!1):v=!g;let x=this.editor.getPointInShapeSpace(a,b).toFixed().toJson(),S=!1,w;if((this.editor.user.getIsSnapMode()?!g:g)&&d.length>2){let P,M=8/this.editor.getZoomLevel();for(let O=0,k=l.length-2;O<k;O++){const F=l[O];if(!F)break;if(F.type==="free")continue;const A=F.points[0],N=Ho(F.points);if(!(A&&N))continue;const $=Y.NearestPointOnLineSegment(A,N,x);if(Y.DistMin($,x,M)){P=$.toFixed().toJson(),M=Y.Dist($,x),w=F;break}}P&&(S=!0,x=P)}if(S&&w){const P=this.editor.getShapePageTransform(a),M=w.points[0],O=Ho(w.points);if(!O)throw Error("Expected a last point!");const k=vt.applyToPoint(P,M),F=vt.applyToPoint(P,O),A=vt.applyToPoint(P,x);this.editor.snaps.setIndicators([{id:Mr(),type:"points",points:[k,A,F]}])}else{if(this.editor.snaps.clearIndicators(),v){const P=Y.Angle(m,b),O=ag(P,24)-P;y=Y.RotWith(b,m,O)}else y=b;x=this.editor.getPointInShapeSpace(a,y).toFixed().toJson()}this.currentLineLength+=Y.Dist(p.points[0],x),d[d.length-1]={...p,type:"straight",points:[p.points[0],x]};const j={id:s,type:this.shapeType,props:{segments:d}};this.canClose()&&(j.props.isClosed=this.getIsClosed(l,i)),this.editor.updateShapes([j],{squashing:!0});break}case"free":{const d=l.slice(),p=d[d.length-1],m=[...p.points];if(m.length&&this.mergeNextPoint){const{z:b}=m[m.length-1];m[m.length-1]={x:h.x,y:h.y,z:b?Math.max(b,h.z):h.z}}else this.currentLineLength+=Y.Dist(m[m.length-1],h),m.push(h);d[d.length-1]={...p,points:m},this.currentLineLength<_n[a.props.size]*4&&(this.currentLineLength=this.getLineLength(d));const g={id:s,type:this.shapeType,props:{segments:d}};if(this.canClose()&&(g.props.isClosed=this.getIsClosed(d,i)),this.editor.updateShapes([g],{squashing:!0}),m.length>500){this.editor.updateShapes([{id:s,type:this.shapeType,props:{isComplete:!0}}]);const b=hr();this.editor.createShapes([{id:b,type:this.shapeType,x:lg(r.currentPagePoint.x),y:lg(r.currentPagePoint.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(f*1.25).toFixed():.5}]}]}}]),this.initialShape=_r(this.editor.getShape(b)),this.mergeNextPoint=!1,this.lastRecordedPoint=r.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const s of n)for(let i=0;i<s.points.length-1;i++){const a=s.points[i],l=s.points[i+1];r+=Y.Dist2(l,a)}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:n}=this;n&&(this.editor.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}D(XS,"id","drawing");var Rv;let i3=(Rv=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Rv,"id","idle"),Rv);class Vp extends bt{constructor(){super(...arguments);D(this,"shapeType","draw");D(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}D(Vp,"id","draw"),D(Vp,"initial","idle"),D(Vp,"children",()=>[i3,XS]);class w1 extends $p{constructor(){super(...arguments);D(this,"shapeType","frame");D(this,"onCreate",n=>{if(!n)return;const r=this.editor.getShapePageBounds(n),s=[],i=this.editor.getShapeAncestors(n).map(a=>a.id);this.editor.getSortedChildIdsForParent(n.parentId).map(a=>{const l=this.editor.getShape(a);if(!l||l.id===n.id||l.isLocked)return;const c=this.editor.getShapePageBounds(l);c&&r.contains(c)&&EY(l,i,n)&&s.push(l.id)}),this.editor.reparentShapes(s,n.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")})}}D(w1,"id","frame"),D(w1,"initial","idle");function EY(t,o,n){return o.includes(t.id)?!1:t.parentId===n.parentId}var Dv;let CY=(Dv=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Dv,"id","idle"),Dv);var Lv;let PY=(Lv=class extends bt{constructor(){super(...arguments);D(this,"markId","");D(this,"onPointerUp",()=>{this.complete()});D(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,s=hr();this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(ii)}}]).select(s).setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs,r=hr();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{geo:this.editor.getStyleForNextShape(ii),w:1,h:1}}]);const s=this.editor.getShape(r);if(!s)return;const i=s.props.geo==="star"?new mt(0,0,200,190):s.props.geo==="cloud"?new mt(0,0,300,180):new mt(0,0,200,200),a=i.center,l=this.editor.getShapeParentTransform(s);l&&a.rot(-l.rotation()),this.editor.select(r),this.editor.updateShapes([{id:s.id,type:"geo",x:s.x-a.x,y:s.y-a.y,props:{geo:this.editor.getStyleForNextShape(ii),w:i.width,h:i.height}}]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},D(Lv,"id","pointing"),Lv);class Hp extends bt{constructor(){super(...arguments);D(this,"shapeType","geo")}}D(Hp,"id","geo"),D(Hp,"initial","idle"),D(Hp,"children",()=>[CY,PY]);class Wp extends bt{constructor(){super(...arguments);D(this,"shapeType","highlight");D(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}D(Wp,"id","highlight"),D(Wp,"initial","idle"),D(Wp,"children",()=>[i3,XS]);var Fv;let TY=(Fv=class extends bt{constructor(){super(...arguments);D(this,"shapeId","");D(this,"onEnter",n=>{this.shapeId=n.shapeId,this.editor.setCursor({type:"cross",rotation:0})});D(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Fv,"id","idle"),Fv);const sE=2;var Nv;let kY=(Nv=class extends bt{constructor(){super(...arguments);D(this,"shape",{});D(this,"markId");D(this,"onEnter",n=>{const{inputs:r}=this.editor,{currentPagePoint:s}=r;this.markId=void 0;const i=n.shapeId&&this.editor.getShape(n.shapeId);if(i&&r.shiftKey){this.markId=`creating:${i.id}`,this.editor.mark(this.markId),this.shape=i;const a=this.editor.getShapeHandles(this.shape);if(!a)return;const l=a.filter(p=>p.type==="vertex").sort(qn),c=l[l.length-1],u=l[l.length-2],f=vt.applyToPoint(this.editor.getShapeParentTransform(this.shape),new Y(this.shape.x,this.shape.y)),h=Y.Sub(s,f).addXY(.1,.1),d=_r(this.shape.props.points);if(Y.DistMin(c,u,sE)||Y.DistMin(h,c,sE))d[c.id]={id:c.id,index:c.index,x:h.x,y:h.y};else{const p=Ii(c.index);d[p]={id:p,index:p,x:h.x,y:h.y}}this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{points:d}}])}else{const a=hr();this.markId=`creating:${a}`,this.editor.mark(this.markId),this.editor.createShapes([{id:a,type:"line",x:s.x,y:s.y}]),this.editor.select(a),this.shape=this.editor.getShape(a)}});D(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const n=this.editor.getShapeHandles(this.shape);if(!n)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const r=Ho(n);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...r,x:r.x-.1,y:r.y-.1},onInteractionEnd:"line"})}});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}},D(Nv,"id","pointing"),Nv);class Yp extends bt{constructor(){super(...arguments);D(this,"shapeType","line")}}D(Yp,"id","line"),D(Yp,"initial","idle"),D(Yp,"children",()=>[TY,kY]);var $v;let IY=($v=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D($v,"id","idle"),$v);function xr(t,o){var s;const n=new Set;for(const i of o){const a=t.getShape(i);if(!a)continue;t.getShapeUtil(a).onDragShapesOut&&n.add(a);const l=t.getShape(a.parentId);l&&t.getShapeUtil(l).onDragShapesOut&&n.add(l)}const r=new Map;for(const i of n){const a=a3(t,i);a.length&&r.set(i,a)}for(const[i,a]of r){const l=t.getShapeUtil(i),c=Rt(a.map(u=>t.getShape(u)));(s=l.onDragShapesOut)==null||s.call(l,i,c)}}function a3(t,o){const n=t.getSortedChildIdsForParent(o.id);if(n.length===0)return[];const r=t.getShapePageBounds(o);if(!r)return[];let s,i,a;const l=[];for(const c of n){const u=t.getShapePageBounds(c);if(!u)continue;if(!r.includes(u)){l.push(c);continue}s??(s=t.getShapeGeometry(o)),i??(i=t.getShapePageTransform(o)),a??(a=i.applyToPoints(s.vertices));const f=t.getShapePageTransform(c).clone().invert().applyToPoints(a),{vertices:h,isClosed:d}=t.getShapeGeometry(c);if(!h.some(p=>Zo(p,f))){if(d){if(II(f,h))continue}else if(B$(f,h))continue;l.push(c)}}return l}function Sg(t,o,n=!1){t.select(o),t.setEditingShape(o),t.setCurrentTool("select.editing_shape",{target:"shape",shape:o}),n&&t.emit("select-all-text",{shapeId:o.id}),l3(t)}const MY=16;function l3(t){const o=t.getSelectionPageBounds(),n=t.getViewportPageBounds();if(o&&!n.contains(o)){const r=o.clone().expandBy(MY/t.getZoomLevel()).expand(n),s=n.clone().translate({x:(r.center.x-n.center.x)*2,y:(r.center.y-n.center.y)*2});t.zoomToBounds(s,{duration:ti,inset:0})}}const Pl=20,OY=0,er=200,qS={x:er/2,y:er/2},c3=10,AY={a1:new Y(er*.5,er*-.5-Pl),a2:new Y(er*1.5+Pl,er*.5),a3:new Y(er*.5,er*1.5+Pl),a4:new Y(er*-.5-Pl,er*.5)};function u3(t,o,n,r){return Object.fromEntries(Object.entries(AY).map(([s,i],a)=>{const l=i.clone();return a===0&&r?l.y-=r:a===2&&n&&(l.y+=n),[s,l.rot(o).add(t)]}))}function d3(t,o,n){const r=new Set(t.getSelectedShapeIds()),s=(er+Pl+n)**2,i=new Map,a=[];for(const u of t.getCurrentPageShapes()){if(!t.isShapeOfType(u,"note")||r.has(u.id))continue;const f=t.getShapePageTransform(u.id);o===f.rotation()&&(i.set(u,t.getShapePageBounds(u).center),a.push(...Object.values(u3(f.point(),o,u.props.growY,n))))}const l=a.length;let c;for(const[u,f]of i)for(let h=0;h<l;h++)c=a[h],c&&(Y.Dist2(f,c)>s||t.isPointInShape(u,c)&&(a[h]=void 0));return Rt(a)}function h3(t,o,n,r,s=!1){let i;const a=t.getCurrentPageShapesSorted(),l=er+Pl**2;for(let c=a.length-1;c>=0;c--){const u=a[c];if(u.type==="note"&&u.id!==o.id){const f=t.getShapePageBounds(u);if(f&&Y.Dist2(f.center,n)<l&&t.isPointInShape(u,n)){i=u;break}}}if(t.complete(),!i||s){t.mark("creating note shape");const c=hr();t.createShape({id:c,type:"note",x:n.x,y:n.y,rotation:r,opacity:o.opacity,props:{...o.props,text:"",growY:0,fontSizeAdjustment:0,url:""}});const u=t.getShape(c),f=t.getPointInParentSpace(u,Y.Sub(n,Y.Rot(qS,r)));t.updateShape({id:c,type:"note",x:f.x,y:f.y}),i=t.getShape(c)}return l3(t),i}var Uv;let RY=(Uv=class extends bt{constructor(){super(...arguments);D(this,"dragged",!1);D(this,"info",{});D(this,"wasFocusedOnEnter",!1);D(this,"markId","");D(this,"shape",{});D(this,"onEnter",()=>{const{editor:n}=this;if(this.wasFocusedOnEnter=!n.getIsMenuOpen(),this.wasFocusedOnEnter){const r=hr();this.markId=`creating:${r}`,n.mark(this.markId);const s=this.editor.inputs.originPagePoint.clone(),i=iE(this.editor,s);i&&s.sub(i),this.shape=aE(this.editor,r,s)}});D(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(!this.wasFocusedOnEnter){const r=hr(),s=this.editor.inputs.originPagePoint.clone(),i=iE(this.editor,s);i&&s.sub(i),this.shape=aE(this.editor,r,s)}this.editor.setCurrentTool("select.translating",{...n,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}})}});D(this,"onPointerUp",()=>{this.complete()});D(this,"onInterrupt",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()})}complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}},D(Uv,"id","pointing"),Uv);function iE(t,o){let n=c3/t.getZoomLevel(),r;for(const s of d3(t,0,0)){const i=Y.Sub(o,s),a=i.len();a<n&&(n=a,r=i)}return r}function aE(t,o,n){t.createShape({id:o,type:"note",x:n.x,y:n.y}).select(o);const r=t.getShape(o),s=t.getShapeGeometry(r).bounds;return t.updateShapes([{id:o,type:"note",x:r.x-s.width/2,y:r.y-s.height/2}]),t.getShape(o)}class Xp extends bt{constructor(){super(...arguments);D(this,"shapeType","note")}}D(Xp,"id","note"),D(Xp,"initial","idle"),D(Xp,"children",()=>[IY,RY]);function DY(t){const o=t.getShapeAtPoint(t.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:Vi/t.getZoomLevel(),renderingOnly:!0});if(!o)return t.setHoveredShape(null);let n;const r=t.getOutermostSelectableShape(o);return r===o||r.id===t.getFocusedGroupId()||t.getSelectedShapeIds().includes(r.id)?n=o:n=r,t.setHoveredShape(n.id)}const iu=HL(DY,32);var Bv;let LY=(Bv=class extends bt{constructor(){super(...arguments);D(this,"onPointerMove",n=>{switch(n.target){case"shape":case"canvas":iu(this.editor)}});D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});D(this,"onKeyDown",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Bv,"id","idle"),Bv);var zv;let FY=(zv=class extends bt{constructor(){super(...arguments);D(this,"shape");D(this,"markId","");D(this,"onExit",()=>{this.editor.setHintingShapes([])});D(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,s=hr();if(this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(s),this.shape=this.editor.getShape(s),!this.shape)return;const{shape:i}=this;this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"text",onCreate:()=>{this.editor.setEditingShape(i.id),this.editor.setCurrentTool("select.editing_shape")}})}});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.cancel()});D(this,"onCancel",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}complete(){var i;this.editor.mark("creating text shape");const n=hr(),{x:r,y:s}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:n,type:"text",x:r,y:s,props:{text:"",autoSize:!0}}]).select(n),this.editor.setEditingShape(n),this.editor.setCurrentTool("select"),(i=this.editor.root.getCurrent())==null||i.transition("editing_shape")}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}},D(zv,"id","pointing"),zv);class qp extends bt{constructor(){super(...arguments);D(this,"shapeType","text")}}D(qp,"id","text"),D(qp,"initial","idle"),D(qp,"children",()=>[LY,FY]);const NY=[qp,Vp,Hp,Xp,Yp,w1,Gp,Wp];function rn(){return ea({isDarkMode:Wh()})}const dn=Ut.memo(function({theme:o,d:n,color:r,fill:s}){switch(s){case"none":return null;case"solid":return C.jsx("path",{fill:o[r].semi,d:n});case"semi":return C.jsx("path",{fill:o.solid,d:n});case"pattern":return C.jsx($Y,{theme:o,color:r,fill:s,d:n})}}),$Y=function({d:o,color:n,theme:r}){const s=Ue(),i=DI(),a=He("zoomLevel",()=>s.getZoomLevel(),[s]),l=Math.ceil(a),c=s.getZoomLevel()<=.18;return C.jsxs(C.Fragment,{children:[C.jsx("path",{fill:r[n].pattern,d:o}),C.jsx("path",{fill:i?`url(#${vu[`1_${r.id}`]})`:c?r[n].semi:`url(#${vu[`${l}_${r.id}`]})`,d:o})]})};function UY(t){return t.replace(/\s/g," ")}function _1(t,o,n){const{padding:r=0}=n;if(o.length===0)return null;const s=mt.From(o[0].box);for(const{box:u}of o)s.union(u);const i=r+(n.offsetX??0),a=(n.offsetY??0)+n.fontSize/2+(n.verticalTextAlign==="start"?r:n.verticalTextAlign==="end"?n.height-r-s.height:(Math.ceil(n.height)-s.height)/2);let l=null;const c=[];for(const{text:u,box:f}of o)l!==null&&f.y>l&&c.push(C.jsx("tspan",{alignmentBaseline:"mathematical",x:i,y:f.y+a,children:`
`},c.length)),c.push(C.jsx("tspan",{alignmentBaseline:"mathematical",x:f.x+i,y:f.y+a,children:UY(u)},c.length)),l=f.y;return C.jsx("text",{fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontFamily,fontWeight:n.fontWeight,dominantBaseline:"mathematical",alignmentBaseline:"mathematical",stroke:n.stroke,strokeWidth:n.strokeWidth,fill:n.fill,children:c})}function BY(t,o,n,r){if((t==="start-legacy"||t==="end-legacy")&&n.length!==0){const s=mt.From(n[0].box);for(const{box:i}of n)s.union(i);if(t==="start-legacy")return(r-2*o-s.width)/2;if(t==="end-legacy")return-(r-2*o-s.width)/2}}function zY(t){return t==="start-legacy"||t==="middle-legacy"||t==="end-legacy"}function gy({fontSize:t,font:o,align:n,verticalAlign:r,text:s,labelColor:i,bounds:a,padding:l=16,stroke:c=!0}){const u=Ue(),f=rn(),h={fontSize:t,fontFamily:fk[o],textAlign:n,verticalTextAlign:r,width:Math.ceil(a.width),height:Math.ceil(a.height),padding:l,lineHeight:Dn.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0,offsetY:0,fill:i,stroke:void 0,strokeWidth:void 0},d=u.textMeasure.measureTextSpans(s,h),p=BY(n,l,d,a.width);p&&(h.offsetX=p),h.offsetX+=a.x,h.offsetY+=a.y;const m=_1(u,d,h);let g=null;return c&&(h.fill=f.background,h.stroke=f.background,h.strokeWidth=2,g=_1(u,d,h)),C.jsxs(C.Fragment,{children:[g,m]})}function Su(t){return{key:`${ci.id}:${t}`,getElement:async()=>{const o=GY(t);if(!o)return null;const n=o.$$_url,r=o.$$_fontface;if(!n||!r)return null;const s=await(await fetch(n)).blob(),i=await ru.blobToDataUrl(s),a=r.replace(n,i);return C.jsx("style",{children:a})}}}function GY(t){const o=fk[t];for(const n of document.fonts)if(o.includes(n.family))return n;return null}function KS(t){return{key:`${ci.id}:${t}`,getElement:async()=>t!=="pattern"?null:C.jsx(VY,{})}}function VY(){const t=rn(),o=8/12;return C.jsxs(C.Fragment,{children:[C.jsxs("mask",{id:"hash_pattern_mask",children:[C.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:"white"}),C.jsxs("g",{strokeLinecap:"round",stroke:"black",children:[C.jsx("line",{x1:o*1,y1:o*3,x2:o*3,y2:o*1}),C.jsx("line",{x1:o*5,y1:o*7,x2:o*7,y2:o*5}),C.jsx("line",{x1:o*9,y1:o*11,x2:o*11,y2:o*9})]})]}),C.jsx("pattern",{id:vu[`1_${t.id}`],width:"8",height:"8",patternUnits:"userSpaceOnUse",children:C.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:t.solid,mask:"url(#hash_pattern_mask)"})})]})}function ZS(){return{key:`${ci.id}:pattern`,component:YY}}const Cd=8,lE=(t,o,n)=>new Promise((r,s)=>{const i=Cd*o*t,a=document.createElement("canvas");a.width=i,a.height=i;const l=a.getContext("2d");if(!l)return;l.fillStyle=n?"#212529":"#f8f9fa",l.fillRect(0,0,i,i),l.globalCompositeOperation="destination-out",l.lineCap="round",l.lineWidth=1.25*o*t;const c=8/12,u=f=>f*o*t;l.beginPath(),l.moveTo(u(c*1),u(c*3)),l.lineTo(u(c*3),u(c*1)),l.moveTo(u(c*5),u(c*7)),l.lineTo(u(c*7),u(c*5)),l.moveTo(u(c*9),u(c*11)),l.lineTo(u(c*11),u(c*9)),l.stroke(),a.toBlob(f=>{!f||wn.throwToBlob.get()?s():r(f)})}),cE=(t,o)=>{const n=document.createElement("canvas");n.width=t[0],n.height=t[1];const r=n.getContext("2d");return r?(o(r),n.toDataURL()):""},HY=()=>{const t=[];for(let o=1;o<=Math.ceil(ja);o++){const n=cE([1,1],s=>{s.fillStyle=tg.lightMode.black.semi,s.fillRect(0,0,1,1)}),r=cE([1,1],s=>{s.fillStyle=tg.darkMode.black.semi,s.fillRect(0,0,1,1)});t.push({zoom:o,url:n,darkMode:!1}),t.push({zoom:o,url:r,darkMode:!0})}return t};function WY(){const o=Ue().getInstanceState().devicePixelRatio,[n,r]=B.useState(!1),s=B.useMemo(()=>HY(),[]),[i,a]=B.useState(s);return B.useEffect(()=>{const c=[];for(let f=1;f<=Math.ceil(ja);f++)c.push(lE(o,f,!1).then(h=>({zoom:f,url:URL.createObjectURL(h),darkMode:!1}))),c.push(lE(o,f,!0).then(h=>({zoom:f,url:URL.createObjectURL(h),darkMode:!0})));let u=!1;return Promise.all(c).then(f=>{u||(a(f),r(!0))}),()=>{u=!0,r(!1)}},[o]),{defs:C.jsx(C.Fragment,{children:i.map(c=>{const u=c.zoom+(c.darkMode?"_dark":"_light");return C.jsx("pattern",{id:vu[u],width:Cd,height:Cd,patternUnits:"userSpaceOnUse",children:C.jsx("image",{href:c.url,width:Cd,height:Cd})},u)})}),isReady:n}}function YY(){const t=Ue(),o=B.useRef(null),{defs:n,isReady:r}=WY();return B.useEffect(()=>{if(r&&t.environment.isSafari){const s=f3(o.current);s&&requestAnimationFrame(()=>{s.style.display="none",requestAnimationFrame(()=>{s.style.display=""})})}},[t,r]),C.jsx("g",{ref:o,"data-testid":r?"ready-pattern-fill-defs":void 0,children:n})}function f3(t){return t.classList.contains("tl-html-layer")?t:t.parentElement?f3(t.parentElement):null}function Wi(t,o,n={}){const{closed:r=!1,snap:s=1,start:i="outset",end:a="outset",lengthRatio:l=2,style:c="dashed"}=n;let u=0,f=0,h=1,d=0,p=0;switch(c){case"dashed":{h=1,u=Math.min(o*l,t/4);break}case"dotted":{h=100,u=o/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(i==="outset"?(t+=u/2,p+=u/2):i==="skip"&&(t-=u,p-=u),a==="outset"?t+=u/2:a==="skip"&&(t-=u)),f=Math.floor(t/u/(2*h)),f-=f%s,f<3&&c==="dashed"?t/o<5?(u=t,f=1,d=0):(u=t*.333,d=t*.333):(f=Math.max(f,3),u=t/f/(2*h),r?(p=u/2,d=(t-f*u)/f):d=(t-f*u)/Math.max(1,f-1)),{strokeDasharray:[u,d].join(" "),strokeDashoffset:p.toString()}}const uE=new WeakMap;function QS(t,o){const n=uE.get(o);if(n)return n;const r=t.getArrowInfo(o);let s=0,i=0;const a=r.isStraight?new bh({start:Y.From(r.start.point),end:Y.From(r.end.point)}):new KI({center:Y.Cast(r.handleArc.center),radius:r.handleArc.radius,start:Y.Cast(r.start.point),end:Y.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});if(o.props.text.trim()){const c=a.bounds,{w:u,h:f}=t.textMeasure.measureText(o.props.text,{...Dn,fontFamily:li[o.props.font],fontSize:xl[o.props.size],maxWidth:null});if(s=u,i=f,c.width>c.height){s=Math.max(Math.min(u,64),Math.min(c.width-64,u));const{w:h,h:d}=t.textMeasure.measureText(o.props.text,{...Dn,fontFamily:li[o.props.font],fontSize:xl[o.props.size],maxWidth:s});s=h,i=d}if(s>16*xl[o.props.size]){s=16*xl[o.props.size];const{w:h,h:d}=t.textMeasure.measureText(o.props.text,{...Dn,fontFamily:li[o.props.font],fontSize:xl[o.props.size],maxWidth:s});s=h,i=d}}const l=new Y(s,i).addScalar(HW*2);return uE.set(o,l),l}function p3(t,o){const n=_n[o.props.size];return VW+(n-_n.s)*2+(n===_n.xl?20:0)}function XY(t,o,n){const r=QS(t,o),s=p3(t,o),i=Y.Nudge(n.start.point,n.end.point,s),a=Y.Nudge(n.end.point,n.start.point,s),l=gS(i,a,mt.FromCenter(n.middle,r).corners);if(!l||l.length!==2)return{start:.5,end:.5};let[c,u]=l;Y.Dist2(c,i)>Y.Dist2(u,i)&&([u,c]=l);const f=i.add(Y.Sub(n.middle,c)),h=a.add(Y.Sub(n.middle,u)),d=Y.Dist(n.start.point,f)/n.length,p=Y.Dist(n.start.point,h)/n.length;return{start:d,end:p}}function qY(t,o,n){const r=QS(t,o),s=p3(t,o),i=Math.sign(o.props.bend),a=s/n.handleArc.radius*i,l=Y.Angle(n.bodyArc.center,n.start.point)-a,c=Y.Angle(n.bodyArc.center,n.end.point)+a,u=Nl(n.bodyArc.center,n.bodyArc.radius,l),f=Nl(n.bodyArc.center,n.bodyArc.radius,c),h=[],d=dE(n.bodyArc.center,n.bodyArc.radius,l,c,i,mt.FromCenter(u,r).corners);h.push(new cn({points:mt.FromCenter(u,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));const p=dE(n.bodyArc.center,n.bodyArc.radius,l,c,i,mt.FromCenter(f,r).corners);h.push(new cn({points:mt.FromCenter(f,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));for(const j of[...d??[],...p??[],u,f])h.push(new ES({x:j.x-3,y:j.y-3,radius:3,isFilled:!1,debugColor:"magenta",ignore:!0}));const m=(d&&hE(n.start.point,d))??n.middle,g=(p&&hE(n.end.point,p))??n.middle,b=Y.Angle(n.bodyArc.center,n.start.point),y=Y.Angle(n.bodyArc.center,n.end.point),v=Y.Angle(n.bodyArc.center,m),x=Y.Angle(n.bodyArc.center,g);if(_a(b,v,i)>_a(b,x,i))return{start:.5,end:.5,dbg:h};const S=_a(b,y,i),w=_a(b,v,i)/S,E=_a(b,x,i)/S;return{start:w,end:E,dbg:h}}function Kp(t,o){let n;const r=[],s=t.getArrowInfo(o),i=o.props.start.type==="binding",a=o.props.end.type==="binding",l=s.start.arrowhead!=="none",c=s.end.arrowhead!=="none";if(s.isStraight){const f=XY(t,o,s);let h=Ga(o.props.labelPosition,l||i?f.start:0,c||a?f.end:1);h=h>=.48&&h<=.52?.5:h,n=Y.Lrp(s.start.point,s.end.point,h)}else{const f=qY(t,o,s);f.dbg&&r.push(...f.dbg);let h=Ga(o.props.labelPosition,l||i?f.start:0,c||a?f.end:1);h=h>=.48&&h<=.52?.5:h;const d=KY(Y.Angle(s.bodyArc.center,s.start.point),Y.Angle(s.bodyArc.center,s.end.point),Math.sign(o.props.bend),h);n=Nl(s.bodyArc.center,s.bodyArc.radius,d)}const u=QS(t,o);return{box:mt.FromCenter(n,u),debugGeom:r}}function dE(t,o,n,r,s,i){const a=n1(t,o,i),l=_a(n,r,s);return a==null?void 0:a.filter(c=>{const u=_a(n,Y.Angle(t,c),s);return u>=0&&u<=l})}function hE(t,o){let n=null,r=-1/0;for(const s of o){const i=Y.Dist2(t,s);i>r&&(n=s,r=i)}return n}function KY(t,o,n,r){const s=_a(t,o,n);return t+s*r*n*-1}function ZY(t,o,n){const r=o==="end"?t.end.point:t.start.point,s=o==="end"?t.start.point:t.end.point,i=t.isStraight?Y.Dist(s,r):Math.abs(t.bodyArc.length),a=Math.max(Math.min(i/5,n*3),n);let l;if(t.isStraight)l=Y.Nudge(r,s,a);else{const c=$$(r,a,t.handleArc.center,t.handleArc.radius);l=o==="end"?t.handleArc.sweepFlag?c[0]:c[1]:t.handleArc.sweepFlag?c[1]:c[0]}return Y.IsNaN(l)&&(l=t.start.point),{point:r,int:l}}function QY({point:t,int:o}){const n=Y.RotWith(o,t,Yt/6),r=Y.RotWith(o,t,-Yt/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y}`}function JY({point:t,int:o}){const n=Y.RotWith(o,t,Yt/6),r=Y.RotWith(o,t,-Yt/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y} Z`}function eX({point:t,int:o}){const n=Y.Sub(o,t).div(2),r=Y.Add(t,Y.Rot(n,dr)),s=Y.Sub(t,Y.Rot(n,dr));return`M ${r.x} ${r.y} L ${o.x} ${o.y} L ${s.x} ${s.y} Z`}function tX({point:t,int:o}){const n=Y.Lrp(t,o,.45),r=Y.Dist(n,t);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function rX({point:t,int:o}){const n=Y.Lrp(t,o,.75),r=Y.RotWith(n,t,Yt/4),s=Y.RotWith(n,t,-Yt/4),i=Y.Lrp(r,s,.5);return i.add(Y.Sub(i,t)),`M ${i.x} ${i.y} L ${r.x} ${r.y} ${t.x} ${t.y} L ${s.x} ${s.y} Z`}function nX({int:t,point:o}){const n=Y.Lrp(o,t,.85),r=Y.Sub(n,o).div(2),s=Y.Add(o,Y.Rot(r,dr)),i=Y.Sub(o,Y.Rot(r,dr)),a=Y.Add(n,Y.Rot(r,dr)),l=Y.Sub(n,Y.Rot(r,dr));return`M ${s.x} ${s.y} L ${a.x} ${a.y} L ${l.x} ${l.y} L ${i.x} ${i.y} Z`}function oX({int:t,point:o}){const n=Y.Sub(t,o).div(2),r=Y.Add(o,Y.Rot(n,dr)),s=Y.Sub(o,Y.Rot(n,dr));return`M ${r.x} ${r.y} L ${s.x} ${s.y}`}function wg(t,o,n){const r=o==="end"?t.end.arrowhead:t.start.arrowhead;if(r==="none")return;const s=ZY(t,o,n);if(s){switch(r){case"bar":return oX(s);case"square":return nX(s);case"diamond":return rX(s);case"dot":return tX(s);case"inverted":return eX(s);case"arrow":return QY(s);case"triangle":return JY(s)}return""}}function sX(t){const{start:o,end:n,handleArc:{radius:r,largeArcFlag:s,sweepFlag:i}}=t;return`M${o.handle.x},${o.handle.y} A${r} ${r} 0 ${s} ${i} ${n.handle.x},${n.handle.y}`}function m3(t){const{start:o,end:n,bodyArc:{radius:r,largeArcFlag:s,sweepFlag:i}}=t;return`M${o.point.x},${o.point.y} A${r} ${r} 0 ${s} ${i} ${n.point.x},${n.point.y}`}function g3(t,o){return`M${t.x},${t.y}L${o.x},${o.y}`}function iX(t){return g3(t.start.handle,t.end.handle)}function y3(t){return g3(t.start.point,t.end.point)}const aX=B.forwardRef(function({isEditing:o,text:n,handleFocus:r,handleChange:s,handleKeyDown:i,handleBlur:a,handleInputPointerDown:l,handleDoubleClick:c},u){return C.jsx("textarea",{ref:u,className:"tl-text tl-text-input",name:"text",tabIndex:-1,readOnly:!o,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:r,onChange:s,onKeyDown:i,onBlur:a,onTouchEnd:Rn,onContextMenu:o?Rn:void 0,onPointerDown:l,onDoubleClick:c,onDragStart:qt})});function lX(t,o,n){const r=Ue(),s=B.useRef(null),i=B.useRef(),a=He("isEditing",()=>r.getEditingShapeId()===t,[r]),l=He("isEditingAnything",()=>!!r.getEditingShapeId(),[r]);B.useEffect(()=>{function d({shapeId:p}){requestAnimationFrame(()=>{if(p===t){const m=s.current;m&&(document.activeElement!==m&&m.focus(),m.select())}})}return r.on("select-all-text",d),()=>{r.off("select-all-text",d)}},[r,t]),B.useEffect(()=>{if(!a)return;const d=s.current;if(!d)return;document.activeElement!==d?(d.focus(),r.getInstanceState().isCoarsePointer&&d.select()):r.environment.isSafari&&(d.blur(),d.focus());function p(){var g,b;const m=(g=window.getSelection)==null?void 0:g.call(window);if(m&&m.type!=="None"){const y=[];for(let v=0;v<m.rangeCount;v++)y.push((b=m.getRangeAt)==null?void 0:b.call(m,v));i.current=y}}return document.addEventListener("selectionchange",p),()=>{document.removeEventListener("selectionchange",p)}},[r,a]);const c=B.useCallback(()=>{const d=i.current;requestAnimationFrame(()=>{var g;const p=s.current,m=r.getEditingShapeId();if(m){if(p&&m===t&&(p.focus(),d&&d.length)){const b=window.getSelection();b&&d.forEach(y=>b.addRange(y))}}else(g=window.getSelection())==null||g.removeAllRanges()})},[r,t]),u=B.useCallback(d=>{if(r.getEditingShapeId()===t)switch(d.key){case"Enter":{(d.ctrlKey||d.metaKey)&&r.complete();break}}},[r,t]),f=B.useCallback(d=>{if(r.getEditingShapeId()!==t)return;let p=xu.normalizeText(d.currentTarget.value);const m=p.replace(/\t/g,Yc);if(m!==p){const g=d.currentTarget.selectionStart;d.currentTarget.value=m,d.currentTarget.selectionStart=g+(m.length-p.length),d.currentTarget.selectionEnd=g+(m.length-p.length),p=m}r.updateShape({id:t,type:o,props:{text:p}})},[r,t,o]),h=B.useCallback(d=>{r.dispatch({...To(d),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(t)}),Rn(d)},[r,t]);return{rInput:s,handleFocus:cX,handleBlur:c,handleKeyDown:u,handleChange:f,handleInputPointerDown:h,handleDoubleClick:Rn,isEmpty:n.trim().length===0,isEditing:a,isEditingAnything:l}}function cX(){}const yy=Ut.memo(function({id:o,type:n,text:r,labelColor:s,font:i,fontSize:a,lineHeight:l,align:c,verticalAlign:u,wrap:f,isSelected:h,onKeyDown:d,classNamePrefix:p,style:m,textWidth:g,textHeight:b}){const{rInput:y,isEmpty:v,isEditing:x,isEditingAnything:S,...w}=lX(o,n,r),[E,j]=B.useState(r);B.useEffect(()=>{x||j(r)},[x,r]);const P=xu.normalizeTextForDom(r),M=P.length>0,O=zY(c);if(!x&&!M)return null;const k=p||"tl-text";return C.jsx("div",{className:`${k}-label tl-text-wrapper`,"data-font":i,"data-align":c,"data-hastext":!v,"data-isediting":x,"data-iseditinganything":S,"data-textwrap":!!f,"data-isselected":h,style:{justifyContent:c==="middle"||O?"center":c,alignItems:u==="middle"?"center":u,...m},children:C.jsxs("div",{className:`${k}-label__inner tl-text-content__wrapper`,style:{fontSize:a,lineHeight:a*l+"px",minHeight:l+32,minWidth:g||0,color:s,width:g,height:b},children:[C.jsx("div",{className:`${k} tl-text tl-text-content`,dir:"ltr",children:P}),(S||h)&&C.jsx(aX,{ref:y,text:r,isEditing:x,...w,handleKeyDown:d??w.handleKeyDown},E)]})})}),uX=B.memo(function({id:o,text:n,size:r,font:s,position:i,width:a,isSelected:l,labelColor:c}){const u=rn();return C.jsx(yy,{id:o,classNamePrefix:"tl-arrow",type:"arrow",font:s,fontSize:xl[r],lineHeight:Dn.lineHeight,align:"middle",verticalAlign:"middle",text:n,labelColor:u[c].solid,textWidth:a,isSelected:l,style:{transform:`translate(${i.x}px, ${i.y}px)`}})});let dX=0;class Zp extends Bs{constructor(){super(...arguments);D(this,"canEdit",()=>!0);D(this,"canBind",()=>!1);D(this,"canSnap",()=>!1);D(this,"hideResizeHandles",()=>!0);D(this,"hideRotateHandle",()=>!0);D(this,"hideSelectionBoundsBg",()=>!0);D(this,"hideSelectionBoundsFg",()=>!0);D(this,"onHandleDrag",(n,{handle:r,isPrecise:s})=>{const i=r.id;if(i==="middle"){const{start:b,end:y}=Ls(this.editor,n),v=Y.Sub(y,b),x=Y.Per(v),S=Y.Med(y,b),w=Y.Sub(S,x),E=Y.Add(S,x),j=Y.NearestPointOnLineSegment(w,E,r,!1);let P=Y.Dist(j,S);return Y.Clockwise(j,y,S)&&(P*=-1),{id:n.id,type:n.type,props:{bend:P}}}const a=_r(n);if(this.editor.inputs.ctrlKey)return a.props[i]={type:"point",x:r.x,y:r.y},a;const l=this.editor.getShapePageTransform(n.id).applyToPoint(r),c=this.editor.getShapeAtPoint(l,{hitInside:!0,hitFrameInside:!0,margin:0,filter:b=>!b.isLocked&&this.editor.getShapeUtil(b).canBind(b)});if(!c)return a.props[i]={type:"point",x:r.x,y:r.y},a;const u=this.editor.getShapeGeometry(c),f=mt.ZeroFix(u.bounds),d=this.editor.getShapePageTransform(a.id).applyToPoint(r),p=this.editor.getPointInShapeSpace(c,d);let m=s;if(!m){const b=a.props[i];(b.type==="point"||b.type==="binding"&&c.id!==b.boundShapeId)&&(m=this.editor.inputs.pointerVelocity.len()<.5)}if(!s){u.isClosed||(m=!0);const b=a.props[i==="start"?"end":"start"];b.type==="binding"&&c.id===b.boundShapeId&&b.isPrecise&&(m=!0)}const g={x:(p.x-f.minX)/f.width,y:(p.y-f.minY)/f.height};return m&&Y.Dist(p,f.center)<Math.max(4,Math.min(Math.min(f.width,f.height)*.15,16))/this.editor.getZoomLevel()&&(g.x=.5,g.y=.5),a.props[i]={type:"binding",boundShapeId:c.id,normalizedAnchor:g,isPrecise:m,isExact:this.editor.inputs.altKey},a.props.start.type==="binding"&&a.props.end.type==="binding"&&a.props.start.boundShapeId===a.props.end.boundShapeId&&Y.Equals(a.props.start.normalizedAnchor,a.props.end.normalizedAnchor)&&(a.props.end.normalizedAnchor.x+=.05),a});D(this,"onTranslateStart",n=>{const r=n.props.start.type==="binding"?n.props.start.boundShapeId:null,s=n.props.end.type==="binding"?n.props.end.boundShapeId:null,i=Ls(this.editor,n),a=this.editor.getShapePageTransform(n.id),l=this.editor.getSelectedShapeIds(),c=new Set;r&&(c.add(r),this.editor.getShapeAncestors(r).forEach(f=>c.add(f.id))),s&&(c.add(s),this.editor.getShapeAncestors(s).forEach(f=>c.add(f.id)));for(const f of l)if(c.has(f))return;let u=n;pE.set(n,{pagePosition:a.applyToPoint(n),terminalBindings:Wg(i,(f,h)=>{const d=n.props[f];return d.type!=="binding"?null:{binding:d,shapePosition:h,pagePosition:a.applyToPoint(h)}})});for(const f of["start","end"]){const h=n.props[f];h.type==="binding"&&(u={...n,props:{...n.props,[f]:{...h,isPrecise:!0}}})}return u});D(this,"onTranslate",(n,r)=>{const s=pE.get(n);if(!s)return;const i=this.editor.getShapePageTransform(r.id),a=Y.Sub(i.applyToPoint(r),s.pagePosition);let l=r;for(const[c,u]of Ao(s.terminalBindings)){if(!u)continue;const f=Y.Add(u.pagePosition,Y.Mul(a,.5)),h=this.editor.getShapeAtPoint(f,{hitInside:!0,hitFrameInside:!0,margin:0,filter:d=>!d.isLocked&&this.editor.getShapeUtil(d).canBind(d)});if((h==null?void 0:h.id)===u.binding.boundShapeId){const d=mt.ZeroFix(this.editor.getShapeGeometry(h).bounds),p=this.editor.getPointInShapeSpace(h,f),m={x:(p.x-d.minX)/d.width,y:(p.y-d.minY)/d.height};l={...l,props:{...l.props,[c]:{...u.binding,isPrecise:!0,normalizedAnchor:m}}}}else l={...l,props:{...l.props,[c]:{type:"point",x:u.shapePosition.x,y:u.shapePosition.y}}}}return l});D(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,a=Ls(this.editor,n),{start:l,end:c}=_r(n.props);let{bend:u}=n.props;l.type==="point"&&(l.x=a.start.x*s,l.y=a.start.y*i),c.type==="point"&&(c.x=a.end.x*s,c.y=a.end.y*i);const f=Math.abs(s),h=Math.abs(i);return s<0&&i>=0?(u!==0&&(u*=-1,u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x),c.type==="binding"&&(c.normalizedAnchor.x=1-c.normalizedAnchor.x)):s>=0&&i<0?(u!==0&&(u*=-1,u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y),c.type==="binding"&&(c.normalizedAnchor.y=1-c.normalizedAnchor.y)):s>=0&&i>=0?u!==0&&(u*=Math.max(f,h)):s<0&&i<0&&(u!==0&&(u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y),c.type==="binding"&&(c.normalizedAnchor.x=1-c.normalizedAnchor.x,c.normalizedAnchor.y=1-c.normalizedAnchor.y)),{props:{start:l,end:c,bend:u}}});D(this,"onDoubleClickHandle",(n,r)=>{switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}});D(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])})}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",labelPosition:.5,font:"draw"}}getGeometry(n){const r=this.editor.getArrowInfo(n),s=[],i=r.isStraight?new bh({start:Y.From(r.start.point),end:Y.From(r.end.point)}):new KI({center:Y.Cast(r.handleArc.center),radius:r.handleArc.radius,start:Y.Cast(r.start.point),end:Y.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let a;if(n.props.text.trim()){const l=Kp(this.editor,n);s.push(...l.debugGeom),a=new Hi({x:l.box.x,y:l.box.y,width:l.box.w,height:l.box.h,isFilled:!0,isLabel:!0})}return new Vs({children:[...a?[i,a]:[i],...s]})}getHandles(n){const r=this.editor.getArrowInfo(n);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}].filter(Boolean)}component(n){const r=this.editor.getOnlySelectedShape(),s=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","select.translating","arrow.dragging")&&!this.editor.getInstanceState().isReadonly,i=this.editor.getArrowInfo(n);if(!(i!=null&&i.isValid))return null;const a=Kp(this.editor,n),l=n.id===this.editor.getOnlySelectedShapeId(),u=this.editor.getEditingShapeId()===n.id||n.props.text;return C.jsxs(C.Fragment,{children:[C.jsx(Va,{id:n.id,style:{minWidth:50,minHeight:50},children:C.jsx(fE,{shape:n,shouldDisplayHandles:s&&r===n})}),u&&C.jsx(uX,{id:n.id,text:n.props.text,font:n.props.font,size:n.props.size,position:a.box.center,width:a.box.w,isSelected:l,labelColor:n.props.labelColor})]})}indicator(n){const{start:r,end:s}=Ls(this.editor,n),i=this.editor.getArrowInfo(n),a=this.editor.getShapeGeometry(n),l=a.bounds,c=n.props.text.trim()?a.children[1]:null,u=ly(n.id);if(!i||Y.Equals(r,s))return null;const f=_n[n.props.size],h=i.start.arrowhead&&wg(i,"start",f),d=i.end.arrowhead&&wg(i,"end",f),p=i.isStraight?y3(i):m3(i),m=h&&i.start.arrowhead!=="arrow"||d&&i.end.arrowhead!=="arrow"||!!c,g=(n.id+"_clip").replace(":","_");return u&&c?C.jsx("rect",{x:Ee(c.x),y:Ee(c.y),width:c.w,height:c.h,rx:3.5,ry:3.5}):C.jsxs("g",{children:[m&&C.jsx("defs",{children:C.jsxs("mask",{id:g,children:[C.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.w+200,height:l.h+200,fill:"white"}),c&&C.jsx("rect",{x:Ee(c.x),y:Ee(c.y),width:c.w,height:c.h,fill:"black",rx:3.5,ry:3.5}),h&&C.jsx("path",{d:h,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&C.jsx("path",{d,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),C.jsxs("g",{...m?{mask:`url(#${g})`}:void 0,children:[m&&C.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.width+200,height:l.height+200,opacity:0}),C.jsx("path",{d:p})]}),h&&C.jsx("path",{d:h}),d&&C.jsx("path",{d}),c&&C.jsx("rect",{x:Ee(c.x),y:Ee(c.y),width:c.w,height:c.h,rx:3.5,ry:3.5})]})}toSvg(n,r){r.addExportDef(KS(n.props.fill)),n.props.text&&r.addExportDef(Su(n.props.font));const s=ea(r);return C.jsxs(C.Fragment,{children:[C.jsx(fE,{shape:n,shouldDisplayHandles:!1}),C.jsx(gy,{fontSize:xl[n.props.size],font:n.props.font,align:"middle",verticalAlign:"middle",text:n.props.text,labelColor:s[n.props.labelColor].solid,bounds:Kp(this.editor,n).box,padding:4})]})}getCanvasSvgDefs(){return[ZS(),{key:"arrow:dot",component:fX},{key:"arrow:cross",component:pX}]}}D(Zp,"type","arrow"),D(Zp,"props",mk),D(Zp,"migrations",gk);function hX(t,o){const n=t.getArrowInfo(o);return n.isStraight?Y.Dist(n.start.handle,n.end.handle):Math.abs(n.handleArc.length)}const fE=os(function({shape:o,shouldDisplayHandles:n}){const r=Ue(),s=rn(),i=r.getArrowInfo(o),a=mt.ZeroFix(r.getShapeGeometry(o).bounds),l=Ut.useMemo(()=>r.environment.isSafari?dX+=1:0,[o]);if(!(i!=null&&i.isValid))return null;const c=_n[o.props.size],u=i.start.arrowhead&&wg(i,"start",c),f=i.end.arrowhead&&wg(i,"end",c),h=i.isStraight?y3(i):m3(i);let d=null;if(n){const{strokeDasharray:S,strokeDashoffset:w}=Wi(hX(r,o),2,{end:"skip",start:"skip",lengthRatio:2.5});d=o.props.start.type==="binding"||o.props.end.type==="binding"?C.jsx("path",{className:"tl-arrow-hint",d:i.isStraight?iX(i):sX(i),strokeDasharray:S,strokeDashoffset:w,strokeWidth:2,markerStart:o.props.start.type==="binding"?o.props.start.isExact?"":o.props.start.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:o.props.end.type==="binding"?o.props.end.isExact?"":o.props.end.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:p,strokeDashoffset:m}=Wi(i.isStraight?i.length:Math.abs(i.bodyArc.length),c,{style:o.props.dash}),g=Kp(r,o),b=!(i.start.arrowhead==="none"||i.start.arrowhead==="arrow"),y=!(i.end.arrowhead==="none"||i.end.arrowhead==="arrow"),v=(o.id+"_clip_"+l).replace(":","_");return C.jsxs(C.Fragment,{children:[C.jsx("defs",{children:C.jsxs("mask",{id:v,children:[C.jsx("rect",{x:Ee(-100+a.minX),y:Ee(-100+a.minY),width:Ee(a.width+200),height:Ee(a.height+200),fill:"white"}),o.props.text.trim()&&C.jsx("rect",{x:g.box.x,y:g.box.y,width:g.box.w,height:g.box.h,fill:"black",rx:4,ry:4}),u&&b&&C.jsx("path",{d:u,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),f&&y&&C.jsx("path",{d:f,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),C.jsxs("g",{fill:"none",stroke:s[o.props.color].solid,strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[d,C.jsxs("g",{mask:`url(#${v})`,children:[C.jsx("rect",{x:Ee(a.minX-100),y:Ee(a.minY-100),width:Ee(a.width+200),height:Ee(a.height+200),opacity:0}),C.jsx("path",{d:h,strokeDasharray:p,strokeDashoffset:m})]}),u&&b&&o.props.fill!=="none"&&C.jsx(dn,{theme:s,d:u,color:o.props.color,fill:o.props.fill}),f&&y&&o.props.fill!=="none"&&C.jsx(dn,{theme:s,d:f,color:o.props.color,fill:o.props.fill}),u&&C.jsx("path",{d:u}),f&&C.jsx("path",{d:f})]})]})}),pE=new WeakMap;function fX(){return C.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:C.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function pX(){return C.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[C.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),C.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const mE="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function wu({url:t,zoomLevel:o}){return C.jsx("a",{className:Tt("tl-hyperlink-button",{"tl-hyperlink-button__hidden":o<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:Rn,onPointerUp:Rn,title:t,draggable:!1,children:C.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${mE}") center 100% / 100% no-repeat`,WebkitMask:`url("${mE}") center 100% / 100% no-repeat`}})})}const mX=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function JS(t){return mX.map(n=>{const{offsetX:r,offsetY:s,blur:i,spread:a,color:l}=n,c=new Y(r,s),{x:u,y:f}=c.rot(-t);return`${u}px ${f}px ${i}px ${a}px ${l}`}).join(", ")}class Qp extends Ru{constructor(){super(...arguments);D(this,"canResize",()=>!1);D(this,"hideSelectionBoundsFg",()=>!0);D(this,"onBeforeCreate",n=>{gE(this.editor,n)});D(this,"onBeforeUpdate",(n,r)=>{if(n.props.url!==r.props.url)if(es.isValid(r.props.url))gE(this.editor,r);else return{...r,props:{...r.props,url:n.props.url}}})}getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(n){const r=n.props.assetId?this.editor.getAsset(n.props.assetId):null,s=this.editor.getShapePageTransform(n).rotation(),i=gX(n);return C.jsx(Ul,{children:C.jsxs("div",{className:"tl-bookmark__container",style:{boxShadow:JS(s)},children:[C.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?C.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):C.jsx("div",{className:"tl-bookmark__placeholder"}),C.jsx(wu,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]}),C.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&C.jsx("h2",{className:"tl-bookmark__heading",children:Vd((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&C.jsx("p",{className:"tl-bookmark__description",children:Vd((r==null?void 0:r.props.description)||"",128)}),C.jsx("a",{className:"tl-bookmark__link",href:n.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:Rn,onPointerUp:Rn,onClick:Rn,children:Vd(i,45)})]})]})})}indicator(n){return C.jsx("rect",{width:Ee(n.props.w),height:Ee(n.props.h),rx:"6",ry:"6"})}}D(Qp,"type","bookmark"),D(Qp,"props",yk),D(Qp,"migrations",vk);const gX=t=>{try{const o=new URL(t.props.url),n=o.pathname.replace(/\/*$/,"");return`${o.hostname}${n}`}catch{return t.props.url}};function gE(t,o){const{url:n}=o.props,r=Cl.createId(Vb(n));t.getAsset(r)?o.props.assetId!==r&&t.updateShapes([{id:o.id,type:o.type,props:{assetId:r}}]):(t.updateShapes([{id:o.id,type:o.type,props:{assetId:null}}]),yX(t,o))}const yX=VT(async(t,o)=>{const{url:n}=o.props,r=await t.getAssetForExternalContent({type:"url",url:n});r&&t.batch(()=>{t.createAssets([r]),t.updateShapes([{id:o.id,type:o.type,props:{assetId:r.id}}])})},500);function Bl(t,o=!1){const n=t.length;if(n<2)return"";let r=t[0].point,s=t[1].point;if(n===2)return`M${In(r)}L${In(s)}`;let i="";for(let a=2,l=n-1;a<l;a++)r=t[a].point,s=t[a+1].point,i+=Eo(r,s);return o?`M${Eo(t[0].point,t[1].point)}Q${In(t[1].point)}${Eo(t[1].point,t[2].point)}T${i}${Eo(t[n-1].point,t[0].point)}${Eo(t[0].point,t[1].point)}Z`:`M${In(t[0].point)}Q${In(t[1].point)}${Eo(t[1].point,t[2].point)}${t.length>3?"T":""}${i}L${In(t[n-1].point)}`}function vX(t,o={}){const{start:n={},end:r={}}=o,{cap:s=!0}=n,{cap:i=!0}=r;bn(!n.taper&&!r.taper,"cap taper not supported here"),bn(!n.easing&&!r.easing,"cap easing not supported here"),bn(s&&i,"cap must be true");const a=di(t,o);my(a,o);const l=bX(a);let c="";for(const u of l)c+=SX(u,o);return c}function bX(t){if(t.length<=2)return[t];const o=[];let n=[t[0]],r=Y.Sub(t[1].point,t[0].point).uni(),s,i,a,l,c;for(let u=1,f=t.length;u<f-1;u++){if(a=t[u-1],l=t[u],c=t[u+1],s=Y.Sub(c.point,l.point).uni(),i=Y.Dpr(r,s),r=s,i<-.8){const h={...l,point:l.input};n.push(h),o.push(hv(n)),n=[h];continue}if(n.push(l),!(i>.7)&&(Y.Dist2(a.point,l.point)+Y.Dist2(l.point,c.point))/((a.radius+l.radius+c.radius)/3)**2<1.5){n.push(l),o.push(hv(n)),n=[l];continue}}return n.push(t[t.length-1]),o.push(hv(n)),o}function hv(t){const o=t[0];let n;for(;t.length>2&&(n=t[1],Y.Dist2(o.point,n.point)<((o.radius+n.radius)/2*.5)**2);)t.splice(1,1);const r=t[t.length-1];let s;for(;t.length>2&&(s=t[t.length-2],Y.Dist2(r.point,s.point)<((r.radius+s.radius)/2*.5)**2);)t.splice(t.length-2,1);return t.length>1&&(t[0]={...t[0],vector:Y.Sub(t[0].point,t[1].point).uni()},t[t.length-1]={...t[t.length-1],vector:Y.Sub(t[t.length-2].point,t[t.length-1].point).uni()}),t}function xX(t,o,n){return"M "+t+" "+o+" m -"+n+", 0 a "+n+","+n+" 0 1,1 "+n*2+",0 a "+n+","+n+" 0 1,1 -"+n*2+",0"}function SX(t,o={}){if(t.length===0)return"";if(t.length===1)return xX(t[0].point.x,t[0].point.y,t[0].radius);const{left:n,right:r}=JM(t,o);r.reverse();let s=`M${In(n[0])}T`;for(let i=1;i<n.length;i++)s+=Eo(n[i-1],n[i]);{const i=t[t.length-1],a=i.radius,l=i.vector.clone().per().neg(),c=Y.Add(i.point,Y.Mul(l,a)),u=Y.Add(i.point,Y.Mul(l,-a));s+=`${In(c)}A${Ee(a)},${Ee(a)} 0 0 1 ${In(u)}T`}for(let i=1;i<r.length;i++)s+=Eo(r[i-1],r[i]);{const i=t[0],a=i.radius,l=i.vector.clone().per(),c=Y.Add(i.point,Y.Mul(l,a)),u=Y.Add(i.point,Y.Mul(l,-a));s+=`${In(c)}A${Ee(a)},${Ee(a)} 0 0 1 ${In(u)}Z`}return s}function Sh(){const t=Ue();return He("zoom",()=>t.getZoomLevel()<.35,[t])}const wX=t=>t*.65+I6(t*Yt/2)*.35,_X=t=>({size:1+t,thinning:.5,streamline:.62+(1+t)/8*.06,smoothing:.62,easing:Kn.easeOutSine,simulatePressure:!0}),jX=t=>({size:1+t*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:wX}),yE=t=>({size:1+t,thinning:0,streamline:.62+(1+t)/8*.06,smoothing:.62,simulatePressure:!1,easing:Kn.linear});function j1({strokeWidth:t,showAsComplete:o}){return{size:1+t,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:Kn.easeOutSine,last:o}}function E1(t,o,n,r){return{...r?yE(o):t.dash==="draw"?t.isPen?jX(o):_X(o):yE(o),last:t.isComplete||n}}function wh(t){const o=[];for(const n of t)if(n.type==="free"||n.points.length<2)o.push(...n.points.map(Y.Cast));else{const r=Math.max(4,Math.floor(Y.Dist(n.points[0],n.points[1])/16));o.push(...Y.PointsBetween(n.points[0],n.points[1],r))}return o}function EX(t,o){return{draw:"none",solid:"none",dotted:`0.1 ${o*2}`,dashed:`${o*2} ${o*2}`}[t.props.dash]}class Jp extends Bs{constructor(){super(...arguments);D(this,"hideResizeHandles",n=>fv(n));D(this,"hideRotateHandle",n=>fv(n));D(this,"hideSelectionBoundsFg",n=>fv(n));D(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,a=[];for(const l of n.props.segments)a.push({...l,points:l.points.map(({x:c,y:u,z:f})=>({x:lg(s*c),y:lg(i*u),z:f}))});return{props:{segments:a}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(n){const r=wh(n.props.segments),s=_n[n.props.size];if(n.props.segments.length===1){const a=mt.FromPoints(r);if(a.width<s*2&&a.height<s*2)return new ES({x:-s,y:-s,radius:s,isFilled:!0})}const i=di(r,E1(n.props,s,!0,!0)).map(a=>a.point);return n.props.isClosed?new cn({points:i,isFilled:n.props.fill!=="none"}):new Jl({points:i})}component(n){return C.jsx(Va,{id:n.id,children:C.jsx(vE,{shape:n,forceSolid:Sh()})})}indicator(n){var h;const r=Sh(),s=_n[n.props.size],i=wh(n.props.segments);let a=s;!r&&!n.props.isPen&&n.props.dash==="draw"&&i.length===1&&(a+=Ja(n.id)()*(s/6));const l=n.props.isComplete||((h=Ho(n.props.segments))==null?void 0:h.type)==="straight",c=E1(n.props,a,l,!0),u=di(i,c),f=u.length>1?Bl(u,n.props.isClosed):v3(i[0],a);return C.jsx("path",{d:f})}toSvg(n,r){return r.addExportDef(KS(n.props.fill)),C.jsx(vE,{shape:n,forceSolid:!1})}getCanvasSvgDefs(){return[ZS()]}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return _n[n.props.size]*r/2}}D(Jp,"type","draw"),D(Jp,"props",xk),D(Jp,"migrations",Sk);function v3(t,o){const n=(o+1)*.5;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function fv(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function vE({shape:t,forceSolid:o}){var h;const n=rn(),r=_n[t.props.size],s=wh(t.props.segments),i=t.props.isComplete||((h=Ho(t.props.segments))==null?void 0:h.type)==="straight";let a=r;!o&&!t.props.isPen&&t.props.dash==="draw"&&s.length===1&&(a+=Ja(t.id)()*(r/6));const l=E1(t.props,a,i,o);if(!o&&t.props.dash==="draw")return C.jsxs(C.Fragment,{children:[t.props.isClosed&&t.props.fill&&s.length>1?C.jsx(dn,{theme:n,fill:t.props.isClosed?t.props.fill:"none",color:t.props.color,d:Bl(di(s,l),t.props.isClosed)}):null,C.jsx("path",{d:vX(s,l),strokeLinecap:"round",fill:n[t.props.color].solid})]});const c=di(s,l),u=c.length<2,f=u?v3(s[0],0):Bl(c,t.props.isClosed);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:n,color:t.props.color,fill:u||t.props.isClosed?t.props.fill:"none",d:f}),C.jsx("path",{d:f,strokeLinecap:"round",fill:u?n[t.props.color].solid:"none",stroke:n[t.props.color].solid,strokeWidth:r,strokeDasharray:u?"none":EX(t,r),strokeDashoffset:"0"})]})}function CX(t,o,n={}){const{newPoint:r,handle:s,scaleX:i,scaleY:a}=o,{minWidth:l=1,maxWidth:c=1/0,minHeight:u=1,maxHeight:f=1/0}=n;let h=t.props.w*i,d=t.props.h*a;const p=new Y(0,0);if(h>0){if(h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=h-l;break}case"top":case"bottom":{p.x=(h-l)/2;break}default:p.x=0}h=l}}else if(p.x=h,h=-h,h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=-h;break}default:p.x=-l}h=l}if(d>0){if(d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=d-u;break}case"right":case"left":{p.y=(d-u)/2;break}default:p.y=0}d=u}}else if(p.y=d,d=-d,d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=-d;break}default:p.y=-u}d=u}const{x:m,y:g}=p.rot(t.rotation).add(r);return{x:m,y:g,props:{w:Math.min(c,h),h:Math.min(f,d)}}}const PX=t=>Object.entries(t).filter(([o,n])=>n).map(([o])=>o).join(" ");class em extends Ru{constructor(){super(...arguments);D(this,"hideSelectionBoundsFg",n=>!this.canResize(n));D(this,"canEdit",()=>!0);D(this,"canResize",n=>{var r,s;return!!((s=(r=Ta(n.props.url))==null?void 0:r.definition)!=null&&s.doesResize)});D(this,"canEditInReadOnly",()=>!0);D(this,"isAspectRatioLocked",n=>{const r=Ta(n.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});D(this,"onResize",(n,r)=>{const s=this.isAspectRatioLocked(n),i=Ta(n.props.url);let a=(i==null?void 0:i.definition.minWidth)??200,l=(i==null?void 0:i.definition.minHeight)??200;if(s){const c=n.props.w/n.props.h;c>1?a*=c:l/=c}return CX(n,r,{minWidth:a,minHeight:l})})}getDefaultProps(){return{w:300,h:300,url:""}}component(n){const{w:r,h:s,url:i}=n.props,a=ly(n.id),l=B.useMemo(()=>n3(i),[i]),c=He("is hovering",()=>{const{editingShapeId:d,hoveredShapeId:p}=this.editor.getCurrentPageState();if(d&&p!==d){const m=this.editor.getShape(d);if(m&&this.editor.isShapeOfType(m,"embed"))return!0}return!1},[]),u=this.editor.getShapePageTransform(n).rotation(),f=a||c;if((l==null?void 0:l.definition.type)==="github_gist"){const d=l.url.split("/").pop();if(!d)throw Error("No gist id!");return C.jsx(Ul,{className:"tl-embed-container",id:n.id,children:C.jsx(TX,{id:d,width:Ee(r),height:Ee(s),isInteractive:f,pageRotation:u})})}const h=PX({...g6,...(l==null?void 0:l.definition.overridePermissions)??{}});return C.jsx(Ul,{className:"tl-embed-container",id:n.id,children:l!=null&&l.definition?C.jsx("iframe",{className:"tl-embed",sandbox:h,src:l.embedUrl,width:Ee(r),height:Ee(s),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:f?"auto":"none",zIndex:f?"":"-1",boxShadow:JS(u),borderRadius:(l==null?void 0:l.definition.overrideOutlineRadius)??8,background:l==null?void 0:l.definition.backgroundColor}}):null})}indicator(n){const r=B.useMemo(()=>Ta(n.props.url),[n.props.url]);return C.jsx("rect",{width:Ee(n.props.w),height:Ee(n.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}D(em,"type","embed"),D(em,"props",wk),D(em,"migrations",_k);function TX({id:t,file:o,isInteractive:n,width:r,height:s,style:i,pageRotation:a}){return C.jsx("iframe",{className:"tl-embed",draggable:!1,width:Ee(r),height:Ee(s),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...i,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:JS(a)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${t}.js${o?`?file=${o}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const kX=B.forwardRef(({id:t,name:o,isEditing:n},r)=>{const s=Ue(),i=B.useCallback(c=>{c.key==="Enter"&&!c.nativeEvent.isComposing&&(Rn(c),c.currentTarget.blur(),s.setEditingShape(null))},[s]),a=B.useCallback(c=>{const u=s.getShape(t);if(!u)return;const f=u.props.name,h=c.currentTarget.value.trim();f!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}],{squashing:!0})},[t,s]),l=B.useCallback(c=>{const u=s.getShape(t);if(!u)return;const f=u.props.name,h=c.currentTarget.value;f!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}],{squashing:!0})},[t,s]);return C.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[C.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:o,autoFocus:!0,onKeyDown:i,onBlur:a,onChange:l}),b3(o,"Frame")+String.fromCharCode(8203)]})}),IX=function({id:o,name:n,width:r,height:s}){const i=Ue(),a=He("shape rotation",()=>Na(i.getShapePageTransform(o).rotation()),[i,o]),l=ly(o),c=B.useRef(null),u=B.useCallback(m=>{const g=To(m);i.getEditingShapeId()!==o&&(i.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:i.getShape(o),...g}),m.preventDefault())},[i,o]);B.useEffect(()=>{const m=c.current;m&&l&&(m.focus(),m.select(),requestAnimationFrame(()=>{document.activeElement!==m&&(m.focus(),m.select())}))},[c,l]);const h=((a+Math.PI/4)*(2/Math.PI)+4)%4,d=["top","left","bottom","right"][Math.floor(h)];let p;switch(d){case"top":p="";break;case"right":p=`translate(${Ee(r)}px, 0px) rotate(90deg)`;break;case"bottom":p=`translate(${Ee(r)}px, ${Ee(s)}px) rotate(180deg)`;break;case"left":p=`translate(0px, ${Ee(s)}px) rotate(270deg)`;break}return C.jsx("div",{className:"tl-frame-heading",style:{overflow:l?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(d==="top"||d==="bottom"?r:s)}px + var(--space-5))`,bottom:"100%",transform:`${p} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:u,children:C.jsx("div",{className:"tl-frame-heading-hit-area",children:C.jsx(kX,{ref:c,id:o,name:n,isEditing:l})})})};function b3(t,o){return t.match(/^\s*$/)?o:t}class tm extends Ru{constructor(){super(...arguments);D(this,"canBind",()=>!0);D(this,"canEdit",()=>!0);D(this,"canReceiveNewChildrenOfType",(n,r)=>!n.isLocked);D(this,"canDropShapes",(n,r)=>!n.isLocked);D(this,"onDragShapesOver",(n,r)=>{r.every(s=>s.parentId===n.id)||this.editor.reparentShapes(r,n.id)});D(this,"onDragShapesOut",(n,r)=>{const s=this.editor.getShape(n.parentId);s&&this.editor.isShapeOfType(s,"group")?this.editor.reparentShapes(r,s.id):this.editor.reparentShapes(r,this.editor.getCurrentPageId())});D(this,"onResize",(n,r)=>qI(n,r))}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(n){return new Hi({width:n.props.w,height:n.props.h,isFilled:!1})}component(n){const r=this.editor.getShapeGeometry(n).bounds,s=rn(),i=He("is creating this shape",()=>{const a=this.editor.getStateDescendant("select.resizing");if(!a||!a.getIsActive())return!1;const l=a==null?void 0:a.info;return l?l.isCreating&&this.editor.getOnlySelectedShapeId()===n.id:!1},[n.id]);return C.jsxs(C.Fragment,{children:[C.jsx(Va,{children:C.jsx("rect",{className:Tt("tl-frame__body",{"tl-frame__creating":i}),width:r.width,height:r.height,fill:s.solid,stroke:s.text})}),i?null:C.jsx(IX,{id:n.id,name:n.props.name,width:r.width,height:r.height})]})}toSvg(n,r){const s=ea({isDarkMode:r.isDarkMode}),l=((Na(this.editor.getShapePageTransform(n.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4,c=Math.floor(l);let u;switch(c){case 0:u="";break;case 3:u=`translate(${Ee(n.props.w)}, 0) rotate(90)`;break;case 2:u=`translate(${Ee(n.props.w)}, ${Ee(n.props.h)}) rotate(180)`;break;case 1:u=`translate(0, ${Ee(n.props.h)}) rotate(270)`;break;default:throw Error("labelSide out of bounds")}const f={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:n.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},h=this.editor.textMeasure.measureTextSpans(b3(n.props.name,"Frame")+String.fromCharCode(8203),f),d=h[0],p=Ho(h),m=p.box.w+p.box.x-d.box.x,g=_1(this.editor,h,{offsetY:-f.height-2,...f});return C.jsxs(C.Fragment,{children:[C.jsx("rect",{width:n.props.w,height:n.props.h,fill:s.solid,stroke:s.black.solid,strokeWidth:1,rx:1,ry:1}),C.jsxs("g",{transform:u,children:[C.jsx("rect",{x:-8,y:-f.height-4,width:m+16,height:f.height,fill:s.background,rx:4,ry:4}),g]})]})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return C.jsx("rect",{width:Ee(r.width),height:Ee(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}D(tm,"type","frame"),D(tm,"props",jk),D(tm,"migrations",Ek);function Vn(t){return`${Ee(t.x)},${Ee(t.y)} `}function x3(t=""){let o=0,n=0,r=0,s=0;function i(){const a=o^o<<11;return o=n,n=r,r=s,s^=(s>>>19^a^a>>>8)>>>0,s/4294967296*2}for(let a=0;a<t.length+64;a++)o^=t.charCodeAt(a)|0,i();return i}function C1(t){let o="M";const n=t.length;let r,s,i;for(let a=0,l=n;a<l;a+=3)r=t[a],s=t[a+1],i=t[a+2],o+=`${Vn(r)}L${Vn(s)}Q${Vn(i)}`;return o+=`${Vn(t[0])}`,o}function P1(t,o,n,r,s){const i=[],a=x3(t);let l=o[0],c;const u=o.length;for(let f=0,h=u*s;f<h;f++){c=Y.AddXY(o[(f+1)%u],a()*n,a()*n);const d=Y.Sub(c,l),p=Y.Len(d),m=Y.Div(d,p).mul(Math.min(p/4,r));i.push(Y.Add(l,m),Y.Add(c,m.neg()),c),l=c}return i}function S3(t,o,n){let r=`M ${Vn(o[0])}L`,s=`M ${Vn(o[0])}L`;const i=n/3,a=n*2,l=x3(t);let c=o[0],u,f=o[0],h;const d=o.length;for(let p=0,m=d-1;p<m;p++){u=o[p+1],h=Y.AddXY(o[p+1],l()*i,l()*i);const g=Y.Sub(u,c),b=Y.Len(g),y=Y.Div(g,b).mul(Math.min(b/4,a)),v=Y.Add(c,y),x=Y.Add(u,y.neg()),S=Y.Sub(h,f),w=Y.Len(S),E=Y.Div(S,w).mul(Math.min(w/4,a)),j=Y.Add(f,E),P=Y.Add(h,E.neg());p===m-1?(r+=`${Vn(v)}L ${Vn(u)}`,s+=`${Vn(j)}L ${Vn(h)}`):(r+=`${Vn(v)}L ${Vn(x)}Q ${Vn(u)}`,s+=`${Vn(j)}L ${Vn(P)}Q ${Vn(h)}`,c=u,f=h)}return[r,r+s]}function bE(t,o){const n=Math.min(t,o)/2,r=Math.max(t,o)-n*2;return Math.PI*(n*2)+2*r}function MX(t,o,n){const r=Math.min(t,o)/2,s=Math.max(t,o)-r*2,a=(Math.PI*(r*2)+2*s)/n,l=t>o?[{type:"straight",start:new Y(r,0),delta:new Y(1,0)},{type:"arc",center:new Y(t-r,r),startAngle:-Yt/2},{type:"straight",start:new Y(t-r,o),delta:new Y(-1,0)},{type:"arc",center:new Y(r,r),startAngle:Yt/2}]:[{type:"straight",start:new Y(t,r),delta:new Y(0,1)},{type:"arc",center:new Y(r,o-r),startAngle:0},{type:"straight",start:new Y(0,o-r),delta:new Y(0,-1)},{type:"arc",center:new Y(r,r),startAngle:Yt}];let c=0;const u=[];for(let f=0;f<n;f++){const h=l[0];h.type==="straight"?u.push(Y.Add(h.start,Y.Mul(h.delta,c))):u.push(Nl(h.center,r,h.startAngle+c/r)),c+=a;let d=h.type==="straight"?s:Yt*r;for(;c>d;)c-=d,l.push(l.shift()),d=l[0].type==="straight"?s:Yt*r}return u}const OX=(t,o,n,r,s)=>{switch(t){case"s":return o;case"m":return n;case"l":return r;case"xl":return s}};function vy(t,o,n,r){const s=Ja(n),i=bE(t,o),a=Math.max(Math.ceil(i/OX(r,50,70,100,130)),6,Math.ceil(i/Math.min(t,o))),l=i/a*.2,c=Math.max(t-l*2,1),u=Math.max(o-l*2,1),f=(t-c)/2,h=(o-u)/2,d=bE(c,u)/a,p=MX(c,u,a).map(v=>v.addXY(f,h)),m=t<20?0:l*.3,g=o<20?0:l*.3,b=p.slice(0);for(let v=0;v<Math.floor(a/2);v++)b[v]=Y.AddXY(b[v],s()*m,s()*g),b[a-v-1]=Y.AddXY(b[a-v-1],s()*m,s()*g);const y=[];for(let v=0;v<b.length;v++){const x=v===b.length-1?0:v+1,S=b[v],w=b[x],E=p[v],j=p[x],P=Y.Average([E,j]),M=Y.Angle(E,j)-Math.PI/2,O=Y.Dist(E,j),k=d-O,A=Y.Dist(S,w)/O,N=(Math.max(f,h)+k)*A,$=Y.Add(P,Y.FromAngle(M,N));$.x<0?$.x=0:$.x>t&&($.x=t),$.y<0?$.y=0:$.y>o&&($.y=o);const G=w3(S,w,$),X=Y.Dist(G||Y.Average([S,w]),S);y.push({leftPoint:S,rightPoint:w,arcPoint:$,center:G,radius:X})}return y}function w3(t,o,n){const r=t.x*(o.y-n.y)-t.y*(o.x-n.x)+o.x*n.y-n.x*o.y,s=(t.x*t.x+t.y*t.y)*(n.y-o.y)+(o.x*o.x+o.y*o.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(o.y-t.y),i=(t.x*t.x+t.y*t.y)*(o.x-n.x)+(o.x*o.x+o.y*o.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-o.x),a=-s/(2*r),l=-i/(2*r);return!Number.isFinite(a)||!Number.isFinite(l)?null:new Y(a,l)}function AX(t,o,n,r){const s=[],i=vy(t,o,n,r);for(const{center:a,radius:l,leftPoint:c,rightPoint:u}of i)s.push(...DX(c,u,a,l,10));return s}function ew(t,o,n,r){const s=vy(t,o,n,r);let i=`M${Ee(s[0].leftPoint.x)},${Ee(s[0].leftPoint.y)}`;for(const{leftPoint:a,rightPoint:l,radius:c,center:u}of s){if(u===null){i+=` L${Ee(l.x)},${Ee(l.y)}`;continue}const f=_3(a,l,u)?"0":"1";i+=` A${Ee(c)},${Ee(c)} 0 ${f},1 ${Ee(l.x)},${Ee(l.y)}`}return i+=" Z",i}function RX(t,o,n,r){const s=Ja(n),i=r==="s"?.5:r==="m"?.7:r==="l"?.9:1.6,a=m=>m+s()*i*2,l=vy(t,o,n,r),f=l.reduce((m,g)=>m+Y.Dist2(g.leftPoint,g.rightPoint),0)/l.length>(i*15)**2?m=>new Y(a(m.x),a(m.y)):m=>m;let h=`M${Ee(l[0].leftPoint.x)},${Ee(l[0].leftPoint.y)}`,d=f(l[0].leftPoint),p=`M${Ee(d.x)},${Ee(d.y)}`;for(const{leftPoint:m,center:g,rightPoint:b,radius:y,arcPoint:v}of l){if(g===null){h+=` L${Ee(b.x)},${Ee(b.y)}`;const P=f(b);p+=` L${Ee(P.x)},${Ee(P.y)}`,d=P;continue}const x=_3(m,b,g)?"0":"1";h+=` A${Ee(y)},${Ee(y)} 0 ${x},1 ${Ee(b.x)},${Ee(b.y)}`;const S=f(b),w=f(v),E=w3(d,S,w);if(!E){p+=` L${Ee(S.x)},${Ee(S.y)}`,d=S;continue}const j=Math.abs(Y.Dist(E,d));p+=` A${Ee(j)},${Ee(j)} 0 ${x},1 ${Ee(S.x)},${Ee(S.y)}`,d=S}return h+p+" Z"}function DX(t,o,n,r,s){if(n===null)return[Y.From(t),Y.From(o)];const i=[],a=Y.Angle(n,t),l=Y.Angle(n,o),c=Uh(a,l);for(let u=0;u<s;u++){const f=u/(s-1),h=a+c*f,d=Nl(n,r,h);i.push(d)}return i}function _3(t,o,n){return(o.x-t.x)*(n.y-t.y)-(o.y-t.y)*(n.x-t.x)>0}function LX(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function FX(t,o,n,r){const s=Ja(t),i=o/2,a=n/2,l=ig(i,a),c=[],u=or*s(),f=or+dr/2+Math.abs(s())*dr,h=Math.max(16,l/10);for(let d=0;d<h;d++){const p=d/(h-1),m=u+p*f,g=Math.cos(m),b=Math.sin(m);c.push(new Y(i*g+o*.5+.05*s(),a*b+n/2+.05*s(),Math.min(1,.5+Math.abs(.5-(s()>0?Kn.easeInOutSine(p):Kn.easeInExpo(p)))/2)))}return di(c,LX(r))}function NX(t,o,n,r){return Bl(FX(t,o,n,r))}function T1(t,o){switch(t.geo){case"x-box":return $X(t.w,t.h,o,t.dash);case"check-box":return UX(t.w,t.h);default:return}}function $X(t,o,n,r){const s=r==="draw"?.62:0;if(r==="dashed")return[[new Y(0,0),new Y(t/2,o/2)],[new Y(t,o),new Y(t/2,o/2)],[new Y(0,o),new Y(t/2,o/2)],[new Y(t,0),new Y(t/2,o/2)]];const i=l=>Math.max(0,Math.min(t,l)),a=l=>Math.max(0,Math.min(o,l));return[[new Y(i(n*s),a(n*s)),new Y(i(t-n*s),a(o-n*s))],[new Y(i(n*s),a(o-n*s)),new Y(i(t-n*s),a(n*s))]]}function UX(t,o){const n=Math.min(t,o)*.82,r=(t-n)/2,s=(o-n)/2,i=l=>Math.max(0,Math.min(t,l)),a=l=>Math.max(0,Math.min(o,l));return[[new Y(i(r+n*.25),a(s+n*.52)),new Y(i(r+n*.45),a(s+n*.82))],[new Y(i(r+n*.45),a(s+n*.82)),new Y(i(r+n*.82),a(s+n*.22))]]}const BX=B.memo(function({dash:o,fill:n,color:r,strokeWidth:s,w:i,h:a,id:l,size:c}){const u=rn(),f=ew(i,a,l,c),h=vy(i,a,l,c);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:u,d:f,fill:n,color:r}),C.jsx("g",{strokeWidth:s,stroke:u[r].solid,fill:"none",pointerEvents:"all",children:h.map(({leftPoint:d,rightPoint:p,center:m,radius:g},b)=>{const y=m?g*Na(Na(Y.Angle(m,p))-Na(Y.Angle(m,d))):Y.Dist(d,p),{strokeDasharray:v,strokeDashoffset:x}=Wi(y,s,{style:o,start:"outset",end:"outset"});return C.jsx("path",{d:m?`M${d.x},${d.y}A${g},${g},0,0,1,${p.x},${p.y}`:`M${d.x},${d.y}L${p.x},${p.y}`,strokeDasharray:v,strokeDashoffset:x},b)})})]})}),zX=B.memo(function({w:o,h:n,strokeWidth:r,dash:s,color:i,fill:a}){const l=rn(),c=o/2,u=n/2,f=Math.max(0,c),h=Math.max(0,u),d=ig(f,h),{strokeDasharray:p,strokeDashoffset:m}=Wi(d<64?d*2:d,r,{style:s,snap:4,closed:!0}),g=`M${c-f},${u}a${f},${h},0,1,1,${f*2},0a${f},${h},0,1,1,-${f*2},0`;return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:l,d:g,color:i,fill:a}),C.jsx("path",{d:g,strokeWidth:r,width:Ee(o),height:Ee(n),fill:"none",stroke:l[i].solid,strokeDasharray:p,strokeDashoffset:m,pointerEvents:"all"})]})});function GX(t,o){if(o>t){const r=t/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${o-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const n=o/2;return`
    M${n},0
    L${t-n},0
    a${n},${n},0,1,1,0,${n*2}
    L${n},${o}
    a${n},${n},0,1,1,0,${-n*2}
    Z`}function VX(t,o){if(t>o){const r=o/2;return ig(r,r)+(t-r*2)*2}const n=t/2;return ig(n,n)+(o-n*2)*2}const HX=B.memo(function({w:o,h:n,strokeWidth:r,dash:s,color:i,fill:a}){const l=rn(),c=GX(o,n),u=VX(o,n),{strokeDasharray:f,strokeDashoffset:h}=Wi(u<64?u*2:u,r,{style:s,snap:4,start:"outset",end:"outset",closed:!0});return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:l,d:c,color:i,fill:a}),C.jsx("path",{d:c,strokeWidth:r,width:Ee(o),height:Ee(n),fill:"none",stroke:l[i].solid,strokeDasharray:f,strokeDashoffset:h,pointerEvents:"all"})]})}),WX=B.memo(function({dash:o,fill:n,color:r,strokeWidth:s,outline:i,lines:a}){const l=rn(),c="M"+i[0]+"L"+i.slice(1)+"Z";return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:l,d:c,fill:n,color:r}),C.jsxs("g",{strokeWidth:s,stroke:l[r].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(i.length)).map((u,f)=>{const h=i[f],d=i[(f+1)%i.length],p=Y.Dist(h,d),{strokeDasharray:m,strokeDashoffset:g}=Wi(p,s,{style:o,start:"outset",end:"outset"});return C.jsx("line",{x1:h.x,y1:h.y,x2:d.x,y2:d.y,strokeDasharray:m,strokeDashoffset:g},f)}),a&&a.map(([u,f],h)=>{const d=Y.Dist(u,f),{strokeDasharray:p,strokeDashoffset:m}=Wi(d,s,{style:o,start:"skip",end:"outset",snap:o==="dotted"?4:void 0});return C.jsx("path",{d:`M${u.x},${u.y}L${f.x},${f.y}`,stroke:l[r].solid,strokeWidth:s,fill:"none",strokeDasharray:p,strokeDashoffset:m},`line_fg_${h}`)})]})]})}),YX=B.memo(function({fill:o,color:n,strokeWidth:r,w:s,h:i,id:a,size:l}){const c=rn(),u=RX(s,i,a,l);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:c,d:u,fill:o,color:n}),C.jsx("path",{d:u,stroke:c[n].solid,strokeWidth:r,fill:"none"})]})}),XX=B.memo(function({id:o,outline:n,lines:r,fill:s,color:i,strokeWidth:a}){const l=rn(),c=P1(o,n,a/3,a*2,2);let u=C1(c);if(r)for(const[d,p]of r)u+=`M${d.x},${d.y}L${p.x},${p.y}`;const f=P1(o,n,0,a*2,1),h=C1(f);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:h,fill:s,color:i,theme:l}),C.jsx("path",{d:u,stroke:l[i].solid,strokeWidth:a,fill:"none"})]})}),qX=B.memo(function({fill:o,color:n,strokeWidth:r,w:s,h:i,id:a,size:l}){const c=rn(),u=ew(s,i,a,l);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{theme:c,d:u,fill:o,color:n}),C.jsx("path",{d:u,stroke:c[n].solid,strokeWidth:r,fill:"none"})]})}),xE=B.memo(function({w:o,h:n,strokeWidth:r,fill:s,color:i}){const a=rn(),l=o/2,c=n/2,u=Math.max(0,l),f=Math.max(0,c),h=`M${l-u},${c}a${u},${f},0,1,1,${u*2},0a${u},${f},0,1,1,-${u*2},0`;return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:h,color:i,fill:s,theme:a}),C.jsx("path",{d:h,stroke:a[i].solid,strokeWidth:r,fill:"none"})]})}),SE=B.memo(function({w:o,h:n,strokeWidth:r,fill:s,color:i}){const a=rn(),l=j3(o,n);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:l,color:i,fill:s,theme:a}),C.jsx("path",{d:l,stroke:a[i].solid,strokeWidth:r,fill:"none"})]})});function j3(t,o){let n;if(o>t){const r=t/2;n=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${o-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=o/2;n=`
    M${r},0
    L${t-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${o}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return n}const KX=B.memo(function({outline:o,lines:n,fill:r,color:s,strokeWidth:i}){const a=rn();let l="M"+o[0]+"L"+o.slice(1)+"Z";if(n)for(const[c,u]of n)l+=`M${c.x},${c.y}L${u.x},${u.y}`;return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:l,fill:r,color:s,theme:a}),C.jsx("path",{d:l,stroke:a[s].solid,strokeWidth:i,fill:"none"})]})});function wE({shape:t}){const o=Ue(),{id:n,props:r}=t,{w:s,color:i,fill:a,dash:l,growY:c,size:u}=r,f=_n[u],h=r.h+c;switch(r.geo){case"cloud":{if(l==="solid")return C.jsx(qX,{color:i,fill:a,strokeWidth:f,w:s,h,id:n,size:u});if(l==="dashed"||l==="dotted")return C.jsx(BX,{color:i,fill:a,strokeWidth:f,w:s,h,id:n,size:u,dash:l});if(l==="draw")return C.jsx(YX,{color:i,fill:a,strokeWidth:f,w:s,h,id:n,size:u});break}case"ellipse":{if(l==="solid")return C.jsx(xE,{strokeWidth:f,w:s,h,color:i,fill:a});if(l==="dashed"||l==="dotted")return C.jsx(zX,{id:n,strokeWidth:f,w:s,h,dash:l,color:i,fill:a});if(l==="draw")return C.jsx(xE,{strokeWidth:f,w:s,h,color:i,fill:a});break}case"oval":{if(l==="solid")return C.jsx(SE,{strokeWidth:f,w:s,h,color:i,fill:a});if(l==="dashed"||l==="dotted")return C.jsx(HX,{id:n,strokeWidth:f,w:s,h,dash:l,color:i,fill:a});if(l==="draw")return C.jsx(SE,{strokeWidth:f,w:s,h,color:i,fill:a});break}default:{const d=o.getShapeGeometry(t),p=d instanceof Vs?d.children[0].vertices:d.vertices,m=T1(t.props,f);if(l==="solid")return C.jsx(KX,{fill:a,color:i,strokeWidth:f,outline:p,lines:m});if(l==="dashed"||l==="dotted")return C.jsx(WX,{dash:l,fill:a,color:i,strokeWidth:f,outline:p,lines:m});if(l==="draw")return C.jsx(XX,{id:n,fill:a,color:i,strokeWidth:f,outline:p,lines:m})}}}const ls=17*3;class rm extends Ru{constructor(){super(...arguments);D(this,"canEdit",()=>!0);D(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])});D(this,"onResize",(n,{handle:r,newPoint:s,scaleX:i,scaleY:a,initialShape:l})=>{let c=l.props.w*i,u=(l.props.h+l.props.growY)*a,f=0,h=0;if(n.props.text.trim()){let g=Math.max(Math.abs(c),ls),b=Math.max(Math.abs(u),ls);g<ls&&b===ls&&(g=ls),g===ls&&b<ls&&(b=ls);const y=Jf(this.editor,{...n,props:{...n.props,w:g,h:b}}),v=Math.max(Math.abs(c),y.w)*Math.sign(c),x=Math.max(Math.abs(u),y.h)*Math.sign(u);f=Math.abs(v)-Math.abs(c),h=Math.abs(x)-Math.abs(u),c=v,u=x}const d=new Y(0,0);i<0&&(d.x+=c),(r==="left"||r==="top_left"||r==="bottom_left")&&(d.x+=i<0?f:-f),a<0&&(d.y+=u),(r==="top"||r==="top_left"||r==="top_right")&&(d.y+=a<0?h:-h);const{x:p,y:m}=d.rot(n.rotation).add(s);return{x:p,y:m,props:{w:Math.max(Math.abs(c),1),h:Math.max(Math.abs(u),1),growY:0}}});D(this,"onBeforeCreate",n=>{if(!n.props.text)return n.props.growY?{...n,props:{...n.props,growY:0}}:void 0;const r=n.props.h,s=Jf(this.editor,n).h;let i=null;if(s>r?i=s-r:n.props.growY&&(i=0),i!==null)return{...n,props:{...n.props,growY:i}}});D(this,"onBeforeUpdate",(n,r)=>{const s=n.props.text,i=r.props.text;if(s===i&&n.props.font===r.props.font&&n.props.size===r.props.size)return;if(s&&!i)return{...r,props:{...r.props,growY:0}};const a=n.props.w,l=n.props.h,c=Jf(this.editor,r),u=c.w,f=c.h;if(!s&&i&&i.length===1){let d=Math.max(a,u),p=Math.max(l,f);return n.props.w<ls&&n.props.h<ls&&(d=Math.max(d,ls),p=Math.max(p,ls),d=Math.max(d,p),p=Math.max(d,p)),{...r,props:{...r.props,w:d,h:p,growY:0}}}let h=null;if(f>l?h=f-l:n.props.growY&&(h=0),h!==null)return{...r,props:{...r.props,growY:h,w:Math.max(r.props.w,u)}};if(u>n.props.w)return{...r,props:{...r.props,w:u}}});D(this,"onDoubleClick",n=>{if(this.editor.inputs.altKey)switch(n.props.geo){case"rectangle":return{...n,props:{geo:"check-box"}};case"check-box":return{...n,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(n){const r=Math.max(1,n.props.w),s=Math.max(1,n.props.h+n.props.growY),i=r/2,a=s/2,l=_n[n.props.size],c=n.props.fill!=="none";let u;switch(n.props.geo){case"cloud":{u=new cn({points:AX(r,s,n.id,n.props.size),isFilled:c});break}case"triangle":{u=new cn({points:[new Y(i,0),new Y(r,s),new Y(0,s)],isFilled:c});break}case"diamond":{u=new cn({points:[new Y(i,0),new Y(r,a),new Y(i,s),new Y(0,a)],isFilled:c});break}case"pentagon":{u=new cn({points:E0(r,s,5),isFilled:c});break}case"hexagon":{u=new cn({points:E0(r,s,6),isFilled:c});break}case"octagon":{u=new cn({points:E0(r,s,8),isFilled:c});break}case"ellipse":{u=new ZI({width:r,height:s,isFilled:c});break}case"oval":{u=new LB({width:r,height:s,isFilled:c});break}case"star":{const v=or/5/2,x=Math.floor(5/4)*2,S=5*2-x,w=0,E=Math.floor(5/2)*2,j=Math.cos(-dr+x*v)*r/2,P=Math.cos(-dr+S*v)*r/2,M=Math.sin(-dr+w*v)*s/2,O=Math.sin(-dr+E*v)*s/2,k=r-Math.abs(j-P),F=s-Math.abs(O-M),A=r/2+P-(r/2-j),N=s/2+M-(s/2-O),$=1,G=(r-A)/2,X=(s-N)/2,W=(r+k)/2,V=(s+F)/2,q=W*$/2,J=V*$/2;u=new cn({points:Array.from(Array(5*2)).map((ae,I)=>{const U=-dr+I*v;return new Y(G+(I%2?q:W)*Math.cos(U),X+(I%2?J:V)*Math.sin(U))}),isFilled:c});break}case"rhombus":{const y=Math.min(r*.38,s*.38);u=new cn({points:[new Y(y,0),new Y(r,0),new Y(r-y,s),new Y(0,s)],isFilled:c});break}case"rhombus-2":{const y=Math.min(r*.38,s*.38);u=new cn({points:[new Y(0,0),new Y(r-y,0),new Y(r,s),new Y(y,s)],isFilled:c});break}case"trapezoid":{const y=Math.min(r*.38,s*.38);u=new cn({points:[new Y(y,0),new Y(r-y,0),new Y(r,s),new Y(0,s)],isFilled:c});break}case"arrow-right":{const y=Math.min(r,s)*.38,v=s*.16;u=new cn({points:[new Y(0,v),new Y(r-y,v),new Y(r-y,0),new Y(r,s/2),new Y(r-y,s),new Y(r-y,s-v),new Y(0,s-v)],isFilled:c});break}case"arrow-left":{const y=Math.min(r,s)*.38,v=s*.16;u=new cn({points:[new Y(y,0),new Y(y,v),new Y(r,v),new Y(r,s-v),new Y(y,s-v),new Y(y,s),new Y(0,s/2)],isFilled:c});break}case"arrow-up":{const y=r*.16,v=Math.min(r,s)*.38;u=new cn({points:[new Y(r/2,0),new Y(r,v),new Y(r-y,v),new Y(r-y,s),new Y(y,s),new Y(y,v),new Y(0,v)],isFilled:c});break}case"arrow-down":{const y=r*.16,v=Math.min(r,s)*.38;u=new cn({points:[new Y(y,0),new Y(r-y,0),new Y(r-y,s-v),new Y(r,s-v),new Y(r/2,s),new Y(0,s-v),new Y(y,s-v)],isFilled:c});break}case"check-box":case"x-box":case"rectangle":{u=new Hi({width:r,height:s,isFilled:c});break}}const f=Jf(this.editor,n),h=Math.min(100,r/2),d=Math.min(r,Math.max(f.w,Math.min(h,Math.max(1,r-8)))),p=Math.min(Fi[n.props.size]*Dn.lineHeight+Os*2,s/2),m=Math.min(s,Math.max(f.h,Math.min(p,Math.max(1,r-8)))),g=T1(n.props,l),b=g?g.map(y=>new Jl({points:y})):[];return new Vs({children:[u,new Hi({x:n.props.align==="start"?0:n.props.align==="end"?r-d:(r-d)/2,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?s-m:(s-m)/2,width:d,height:m,isFilled:!0,isLabel:!0}),...b]})}getHandleSnapGeometry(n){const r=this.getGeometry(n),s=r.children[0];switch(n.props.geo){case"arrow-down":case"arrow-left":case"arrow-right":case"arrow-up":case"check-box":case"diamond":case"hexagon":case"octagon":case"pentagon":case"rectangle":case"rhombus":case"rhombus-2":case"star":case"trapezoid":case"triangle":case"x-box":return{outline:s,points:[...s.getVertices(),r.bounds.center]};case"cloud":case"ellipse":case"oval":return{outline:s,points:[r.bounds.center]};default:Zi(n.props.geo)}}component(n){const{id:r,type:s,props:i}=n,{fill:a,font:l,align:c,verticalAlign:u,size:f,text:h}=i,d=n.id===this.editor.getOnlySelectedShapeId(),p=rn(),g=this.editor.getEditingShapeId()!==null||n.props.text;return C.jsxs(C.Fragment,{children:[C.jsx(Va,{id:r,children:C.jsx(wE,{shape:n})}),g&&C.jsx(Ul,{style:{overflow:"hidden",width:n.props.w,height:n.props.h+i.growY},children:C.jsx(yy,{id:r,type:s,font:l,fontSize:Fi[f],lineHeight:Dn.lineHeight,fill:a,align:c,verticalAlign:u,text:h,isSelected:d,labelColor:p[i.labelColor].solid,wrap:!0})}),n.props.url&&C.jsx(wu,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){const{id:r,props:s}=n,{w:i,size:a}=s,l=s.h+s.growY,c=_n[a];switch(s.geo){case"ellipse":return s.dash==="draw"?C.jsx("path",{d:NX(r,i,l,c)}):C.jsx("ellipse",{cx:i/2,cy:l/2,rx:i/2,ry:l/2});case"oval":return C.jsx("path",{d:j3(i,l)});case"cloud":return C.jsx("path",{d:ew(i,l,r,a)});default:{const u=this.editor.getShapeGeometry(n),f=u instanceof Vs?u.children[0].vertices:u.vertices;let h;if(s.dash==="draw"){const p=P1(r,f,0,c*2,1);h=C1(p)}else h="M"+f[0]+"L"+f.slice(1)+"Z";const d=T1(n.props,c);if(d)for(const[p,m]of d)h+=`M${p.x},${p.y}L${m.x},${m.y}`;return C.jsx("path",{d:h})}}}toSvg(n,r){const{props:s}=n;r.addExportDef(KS(n.props.fill));let i;if(s.text){r.addExportDef(Su(n.props.font));const a=ea(r),l=this.editor.getShapeGeometry(n).bounds;i=C.jsx(gy,{fontSize:Fi[s.size],font:s.font,align:s.align,verticalAlign:s.verticalAlign,text:s.text,labelColor:a[s.labelColor].solid,bounds:l})}return C.jsxs(C.Fragment,{children:[C.jsx(wE,{shape:n}),i]})}getCanvasSvgDefs(){return[ZS()]}}D(rm,"type","geo"),D(rm,"props",Ck),D(rm,"migrations",Pk);function Jf(t,o){const n=o.props.text;if(!n)return{w:0,h:0};const r=t.textMeasure.measureText("w",{...Dn,fontFamily:li[o.props.font],fontSize:Fi[o.props.size],maxWidth:100}),s={s:2,m:3.5,l:5,xl:10},i=t.textMeasure.measureText(n,{...Dn,fontFamily:li[o.props.font],fontSize:Fi[o.props.size],minWidth:r.w,maxWidth:Math.max(0,Math.ceil(r.w+s[o.props.size]),Math.ceil(o.props.w-Os*2))});return{w:i.w+Os*2,h:i.h+Os*2}}function ZX(){const[t,o]=B.useState(!1);return B.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),s=matchMedia("(color-gamut: p3)");o(r&&s.matches);const i=()=>o(r&&s.matches);return s.addEventListener("change",i),()=>s.removeEventListener("change",i)},[]),He(wn.forceSrgb)||!t?"srgb":"p3"}const _E=.35,jE=.82;class nm extends Bs{constructor(){super(...arguments);D(this,"hideResizeHandles",n=>tp(n));D(this,"hideRotateHandle",n=>tp(n));D(this,"hideSelectionBoundsFg",n=>tp(n));D(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,a=[];for(const l of n.props.segments)a.push({...l,points:l.points.map(({x:c,y:u,z:f})=>({x:s*c,y:i*u,z:f}))});return{props:{segments:a}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(n){const r=bc(n);if(tp(n))return new ES({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:s,sw:i}=E3(n,r,!0),a=j1({strokeWidth:i,showAsComplete:!0});return my(s,a),new cn({points:YS(s,a),isFilled:!0})}component(n){return C.jsx(Va,{id:n.id,style:{opacity:_E},children:C.jsx(ep,{strokeWidth:bc(n),shape:n})})}backgroundComponent(n){return C.jsx(Va,{id:n.id,style:{opacity:jE},children:C.jsx(ep,{strokeWidth:bc(n),shape:n})})}indicator(n){var h;const r=Sh(),s=bc(n),i=wh(n.props.segments);let a=s;!r&&!n.props.isPen&&i.length===1&&(a+=Ja(n.id)()*(s/6));const l=n.props.isComplete||((h=Ho(n.props.segments))==null?void 0:h.type)==="straight",c=j1({strokeWidth:s,showAsComplete:l}),u=di(i,c);let f;return u.length<2?f=JX(i[0],a):f=Bl(u,!1),C.jsx("path",{d:f})}toSvg(n){return C.jsx(ep,{strokeWidth:bc(n),shape:n,opacity:_E})}toBackgroundSvg(n){return C.jsx(ep,{strokeWidth:bc(n),shape:n,opacity:jE})}}D(nm,"type","highlight"),D(nm,"props",Ik),D(nm,"migrations",Mk);function QX(t){return`M ${t.x} ${t.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function JX(t,o){const n=o/2;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function E3(t,o,n){var c;const r=wh(t.props.segments),s=t.props.isComplete||((c=Ho(t.props.segments))==null?void 0:c.type)==="straight";let i=o;!n&&!t.props.isPen&&r.length===1&&(i+=Ja(t.id)()*(o/6));const a=j1({strokeWidth:i,showAsComplete:s});return{strokePoints:di(r,a),sw:i}}function eq(t,o,n){const{strokePoints:r,sw:s}=E3(t,o,n);return{solidStrokePath:r.length>1?Bl(r,!1):QX(t.props.segments[0].points[0]),sw:s}}function ep({strokeWidth:t,shape:o,opacity:n}){const r=rn(),s=Sh(),{solidStrokePath:i,sw:a}=eq(o,t,s),l=ZX(),c=r[o.props.color].highlight[l];return C.jsx("path",{d:i,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:c,strokeWidth:a,opacity:n})}function bc(t){return bu[t.props.size]*1.12}function tp(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function C3(){return C.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[C.jsx("path",{d:"M3,11 L3,3 11,3",strokeWidth:"2"}),C.jsx("path",{d:"M19,27 L27,27 L27,19",strokeWidth:"2"}),C.jsx("path",{d:"M27,3 L3,27",strokeWidth:"2"})]})}function P3(){const[t,o]=B.useState(!1);return B.useEffect(()=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{o(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),t}async function tq(t){const n=await(await fetch(t)).blob();return ru.blobToDataUrl(n)}class om extends Ru{constructor(){super(...arguments);D(this,"isAspectRatioLocked",()=>!0);D(this,"canCrop",()=>!0);D(this,"onDoubleClick",n=>{const r=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.editor.updateShapes([{type:"image",id:n.id,props:{playing:!n.props.playing}}])});D(this,"onDoubleClickEdge",n=>{const r=n.props;if(!r||this.editor.getCroppingShapeId()!==n.id)return;const s=_r(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},i=1/(s.bottomRight.x-s.topLeft.x)*n.props.w,a=1/(s.bottomRight.y-s.topLeft.y)*n.props.h,l=new Y(s.topLeft.x*i,s.topLeft.y*a).rot(n.rotation),c={id:n.id,type:n.type,x:n.x-l.x,y:n.y-l.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:a}};this.editor.updateShapes([c])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(n){var d,p;const r=this.editor.getCroppingShapeId()===n.id,s=P3(),[i,a]=B.useState(""),l=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0,c=n.id===this.editor.getOnlySelectedShapeId();if(B.useEffect(()=>{if(l!=null&&l.props.src&&"mimeType"in l.props&&(l==null?void 0:l.props.mimeType)==="image/gif"){let m=!1;const g=l.props.src;if(!g)return;const b=new Image;return b.onload=()=>{if(m)return;const y=document.createElement("canvas");y.width=b.width,y.height=b.height;const v=y.getContext("2d");v&&(v.drawImage(b,0,0),a(y.toDataURL()))},b.crossOrigin="anonymous",b.src=g,()=>{m=!0}}},[s,l==null?void 0:l.props]),(l==null?void 0:l.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const u=c&&r&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),f=s&&(((d=l==null?void 0:l.props.mimeType)==null?void 0:d.includes("video"))||((p=l==null?void 0:l.props.mimeType)==null?void 0:p.includes("gif"))),h=EE(n);return l!=null&&l.props.src?C.jsxs(C.Fragment,{children:[u&&C.jsx("div",{style:h,children:C.jsx("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!n.props.playing||f?i:l.props.src})`},draggable:!1})}),C.jsxs(Ul,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h},children:[C.jsxs("div",{className:"tl-image-container",style:h,children:[C.jsx("div",{className:"tl-image",style:{backgroundImage:`url(${!n.props.playing||f?i:l.props.src})`},draggable:!1}),l.props.isAnimated&&!n.props.playing&&C.jsx("div",{className:"tl-image__tg",children:"GIF"})]}),")",n.props.url&&C.jsx(wu,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})]}):C.jsxs(Ul,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h,color:"var(--color-text-3)",backgroundColor:l?"transparent":"var(--color-low)",border:l?"none":"1px solid var(--color-low-border)"},children:[C.jsx("div",{className:"tl-image-container",style:h,children:l?null:C.jsx(C3,{})}),")","url"in n.props&&n.props.url&&C.jsx(wu,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){return this.editor.getCroppingShapeId()===n.id?null:C.jsx("rect",{width:Ee(n.props.w),height:Ee(n.props.h)})}async toSvg(n){const r=n.props.assetId?this.editor.getAsset(n.props.assetId):null;if(!r)return null;let s=(r==null?void 0:r.props.src)||"";(s.startsWith("http")||s.startsWith("/")||s.startsWith("./"))&&(s=await tq(s)||"");const i=EE(n),a=n.props.crop;if(i.transform&&a){const{transform:l,width:c,height:u}=i,f=(a.bottomRight.x-a.topLeft.x)*c,h=(a.bottomRight.y-a.topLeft.y)*u,d=[new Y(0,0),new Y(f,0),new Y(f,h),new Y(0,h)],p=`cropClipPath_${n.id.replace(":","_")}`;return C.jsxs(C.Fragment,{children:[C.jsx("defs",{children:C.jsx("clipPath",{id:p,children:C.jsx("polygon",{points:d.map(m=>`${m.x},${m.y}`).join(" ")})})}),C.jsx("g",{clipPath:"url(#{cropClipId})",children:C.jsx("image",{href:s,width:c,height:u,style:{transform:l}})})]})}else return C.jsx("image",{href:s,width:n.props.w,height:n.props.h})}}D(om,"type","image"),D(om,"props",Ok),D(om,"migrations",Ak);function EE(t){const o=t.props.crop,n=o==null?void 0:o.topLeft;if(!n)return{width:t.props.w,height:t.props.h};const r=1/(o.bottomRight.x-o.topLeft.x)*t.props.w,s=1/(o.bottomRight.y-o.topLeft.y)*t.props.h,i=-n.x*r,a=-n.y*s;return{transform:`translate(${i}px, ${a}px)`,width:r,height:s}}function T3(t,o){const{start:n,end:r}=t;return o?`M${Ee(n.x)},${Ee(n.y)} L${Ee(r.x)},${Ee(r.y)} `:`${Ee(r.x)},${Ee(r.y)} `}function k3(t,o){const{a:n,b:r,c:s,d:i}=t;return Y.Equals(n,i)?"":`${o?`M${Ee(n.x)},${Ee(n.y)}`:""}C${Ee(r.x)},${Ee(r.y)} ${Ee(s.x)},${Ee(s.y)} ${Ee(i.x)},${Ee(i.y)}`}function rq(t,o){let n=t.segments.reduce((r,s,i)=>r+k3(s,i===0),"");return o&&(n+="Z"),n}function nq(t,o){let n=t.segments.reduce((r,s,i)=>r+T3(s,i===0),"");return o&&(n+="Z"),n}function I3(t,o=!1){return t instanceof Jl?nq(t,o):rq(t,o)}function M3(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function O3(t,o,n){const r=o.vertices,s=M3(n);return di(r,s)}function oq(t,o,n){const r=M3(n);return YS(my(O3(t,o,n),r),r)}function sq(t,o,n){const r=oq(t,o,n);return dS(r)}function iq(t,o,n){if(t.props.dash==="draw"){const r=O3(t,o,n);return Bl(r)}return I3(o)}const aq=new ry;class sm extends Bs{constructor(){super(...arguments);D(this,"hideResizeHandles",()=>!0);D(this,"hideRotateHandle",()=>!0);D(this,"hideSelectionBoundsFg",()=>!0);D(this,"hideSelectionBoundsBg",()=>!0);D(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r;return{props:{points:Wg(n.props.points,(a,{id:l,index:c,x:u,y:f})=>({id:l,index:c,x:u*s,y:f*i}))}}});D(this,"onHandleDrag",(n,{handle:r})=>{if(r.type==="vertex")return{...n,props:{...n.props,points:{...n.props.points,[r.id]:{id:r.id,index:r.index,x:r.x,y:r.y}}}}})}getDefaultProps(){const[n,r]=uh(2);return{dash:"draw",size:"m",color:"black",spline:"line",points:{[n]:{id:n,index:n,x:0,y:0},[r]:{id:r,index:r,x:.1,y:.1}}}}getGeometry(n){return Pd(n)}getHandles(n){return aq.get(n.props,()=>{const r=Pd(n),s=k1(n),i=s.map(a=>({...a,id:a.index,type:"vertex",canSnap:!0}));for(let a=0;a<s.length-1;a++){const l=Nd(s[a].index,s[a+1].index),u=r.segments[a].midPoint();i.push({id:l,type:"create",index:l,x:u.x,y:u.y,canSnap:!0})}return i.sort(qn)})}component(n){return C.jsx(Va,{id:n.id,children:C.jsx(CE,{shape:n})})}indicator(n){const r=_n[n.props.size],s=Pd(n),{dash:i}=n.props;let a;if(n.props.spline==="line"){const l=s.points;if(i==="solid"||i==="dotted"||i==="dashed")a="M"+l[0]+"L"+l.slice(1);else{const[c]=S3(n.id,l,r);a=c}}else a=iq(n,s,r);return C.jsx("path",{d:a})}toSvg(n){return C.jsx(CE,{shape:n})}getHandleSnapGeometry(n){const r=k1(n);return{points:r,getSelfSnapPoints:s=>{const i=this.getHandles(n).filter(a=>a.type==="vertex").findIndex(a=>a.id===s.id);return r.filter((a,l)=>Math.abs(l-i)>1).map(Y.From)},getSelfSnapOutline:s=>{const i=this.getHandles(n).filter(l=>l.type==="vertex").findIndex(l=>l.id===s.id),a=Pd(n).segments.filter((l,c)=>c!==i-1&&c!==i);return a.length?new Vs({children:a}):null}}}}D(sm,"type","line"),D(sm,"props",Rk),D(sm,"migrations",Dk);function k1(t){return Object.values(t.props.points).sort(qn)}function Pd(t){const o=k1(t).map(Y.From);switch(t.props.spline){case"cubic":return new DB({points:o});case"line":return new Jl({points:o})}}function CE({shape:t}){const o=rn(),n=Pd(t),r=_n[t.props.size],{dash:s,color:i}=t.props;if(t.props.spline==="line"){if(s==="solid"){const a=n.points,l="M"+a[0]+"L"+a.slice(1);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:l,fill:"none",color:i,theme:o}),C.jsx("path",{d:l,stroke:o[i].solid,strokeWidth:r,fill:"none"})]})}if(s==="dashed"||s==="dotted"){const a=n.points,l="M"+a[0]+"L"+a.slice(1);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:l,fill:"none",color:i,theme:o}),C.jsx("g",{stroke:o[i].solid,strokeWidth:r,children:n.segments.map((c,u)=>{const{strokeDasharray:f,strokeDashoffset:h}=Wi(c.length,r,{style:s,start:u>0?"outset":"none",end:u<n.segments.length-1?"outset":"none"});return C.jsx("path",{strokeDasharray:f,strokeDashoffset:h,d:T3(c,!0),fill:"none"},u)})})]})}if(s==="draw"){const a=n.points,[l,c]=S3(t.id,a,r);return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:l,fill:"none",color:i,theme:o}),C.jsx("path",{d:c,stroke:o[i].solid,strokeWidth:r,fill:"none"})]})}}if(t.props.spline==="cubic"){const a=I3(n);if(s==="solid")return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:a,fill:"none",color:i,theme:o}),C.jsx("path",{strokeWidth:r,stroke:o[i].solid,fill:"none",d:a})]});if(s==="dashed"||s==="dotted")return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:a,fill:"none",color:i,theme:o}),C.jsx("g",{stroke:o[i].solid,strokeWidth:r,children:n.segments.map((l,c)=>{const{strokeDasharray:u,strokeDashoffset:f}=Wi(l.length,r,{style:s,start:c>0?"outset":"none",end:c<n.segments.length-1?"outset":"none"});return C.jsx("path",{strokeDasharray:u,strokeDashoffset:f,d:k3(l,!0),fill:"none"},c)})})]});if(s==="draw")return C.jsxs(C.Fragment,{children:[C.jsx(dn,{d:a,fill:"none",color:i,theme:o}),C.jsx("path",{d:sq(t,n,r),strokeWidth:1,stroke:o[i].solid,fill:o[i].solid})]})}}const A3=B.createContext(null);function lq({assetUrls:t,children:o}){return B.useEffect(()=>{for(const n of Object.values(t.icons)){const r=new Image;r.src=n,r.decode()}for(const n of Object.values(t.embedIcons)){const r=new Image;r.src=n,r.decode()}},[t]),C.jsx(A3.Provider,{value:t,children:o})}function tw(){const t=B.useContext(A3);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const I1={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.export-all-as-json.short":"JSON","action.export-all-as-json":"Export as JSON","action.export-all-as-png.short":"PNG","action.export-all-as-png":"Export as PNG","action.export-all-as-svg.short":"SVG","action.export-all-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rename":"Rename","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-wrap-mode.menu":"Select on wrap","action.toggle-wrap-mode":"Toggle Select on wrap","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","assets.files.upload-failed":"Upload failed","assets.url.failed":"Couldn't load URL preview","color-style.white":"White","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","document.default-name":"Untitled","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","verticalAlign-style.start":"Top","verticalAlign-style.middle":"Middle","verticalAlign-style.end":"Bottom","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.export-all-as":"Export","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},cq=new Set(["ar","fa","he","ur","ku"]),xc={locale:"en",label:"English",messages:I1,dir:"ltr"};async function uq(t,o){if(!(await fetch(o.translations.en)).ok)return console.warn("No main translations found."),xc;if(t==="en")return xc;const r=ph.find(l=>l.locale===t);if(!r)return console.warn(`No translation found for locale ${t}`),xc;const i=await(await fetch(o.translations[r.locale])).json();if(!i)return console.warn(`No messages found for locale ${t}`),xc;const a=[];for(const l in xc.messages)i[l]||a.push(l);return a.length>0,{locale:t,label:r.label,dir:cq.has(r.locale)?"rtl":"ltr",messages:{...xc.messages,...i}}}const R3=B.createContext({}),D3=()=>B.useContext(R3),dq=os(function({overrides:o,children:n}){const s=Ue().user.getLocale(),i=tw(),[a,l]=B.useState(()=>o&&o.en?{locale:"en",label:"English",dir:"ltr",messages:{...I1,...o.en}}:{locale:"en",label:"English",dir:"ltr",messages:I1});return B.useEffect(()=>{let c=!1;async function u(){const f=await uq(s,i);f&&!c&&(o&&o[s]?l({...f,messages:{...f.messages,...o[s]}}):l(f))}return u(),()=>{c=!0}},[i,s,o]),C.jsx(R3.Provider,{value:a,children:n})});function tr(){const t=D3();return B.useCallback(function(n){return t.messages[n]??n},[t])}class im extends Bs{constructor(){super(...arguments);D(this,"canEdit",()=>!0);D(this,"hideResizeHandles",()=>!0);D(this,"hideSelectionBoundsFg",()=>!1);D(this,"onBeforeCreate",n=>PE(this.editor,n));D(this,"onBeforeUpdate",(n,r)=>{if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return PE(this.editor,r)});D(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,fontSizeAdjustment:0,url:""}}getGeometry(n){const r=rp(n),{labelHeight:s,labelWidth:i}=L3(this.editor,n);return new Vs({children:[new Hi({width:er,height:r,isFilled:!0}),new Hi({x:n.props.align==="start"?0:n.props.align==="end"?er-i:(er-i)/2,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?r-s:(r-s)/2,width:i,height:s,isFilled:!0,isLabel:!0})]})}getHandles(n){const r=this.editor.getZoomLevel(),s=OY/r,i=rp(n),a=this.editor.getInstanceState().isCoarsePointer;return r<.25||a?[]:r<.5?[{id:"bottom",index:"a3",type:"clone",x:er/2,y:i+s}]:[{id:"top",index:"a1",type:"clone",x:er/2,y:-s},{id:"right",index:"a2",type:"clone",x:er+s,y:i/2},{id:"bottom",index:"a3",type:"clone",x:er/2,y:i+s},{id:"left",index:"a4",type:"clone",x:-s,y:i/2}]}component(n){const{id:r,type:s,props:{color:i,font:a,size:l,align:c,text:u,verticalAlign:f,fontSizeAdjustment:h}}=n,d=pq(r),p=rn(),m=rp(n),g=He("shape rotation",()=>{var v;return((v=this.editor.getShapePageTransform(r))==null?void 0:v.rotation())??0},[this.editor]),b=Sh(),y=n.id===this.editor.getOnlySelectedShapeId();return C.jsxs(C.Fragment,{children:[C.jsx("div",{id:r,className:"tl-note__container",style:{width:er,height:m,backgroundColor:p[i].note.fill,borderBottom:b?"3px solid rgb(15, 23, 31, .2)":"none",boxShadow:b?"none":mq(n.id,g)},children:C.jsx(yy,{id:r,type:s,font:a,fontSize:h||Fi[l],lineHeight:Dn.lineHeight,align:c,verticalAlign:f,text:u,isNote:!0,isSelected:y,labelColor:p[i].note.text,wrap:!0,onKeyDown:d})}),"url"in n.props&&n.props.url&&C.jsx(wu,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){return C.jsx("rect",{rx:"1",width:Ee(er),height:Ee(rp(n))})}toSvg(n,r){r.addExportDef(Su(n.props.font)),n.props.text&&r.addExportDef(Su(n.props.font));const s=ea({isDarkMode:r.isDarkMode}),i=this.editor.getShapeGeometry(n).bounds;return C.jsxs(C.Fragment,{children:[C.jsx("rect",{x:5,y:5,rx:1,width:er-10,height:i.h,fill:"rgba(0,0,0,.1)"}),C.jsx("rect",{rx:1,width:er,height:i.h,fill:s[n.props.color].note.fill}),C.jsx(gy,{fontSize:n.props.fontSizeAdjustment||Fi[n.props.size],font:n.props.font,align:n.props.align,verticalAlign:n.props.verticalAlign,text:n.props.text,labelColor:s[n.props.color].note.text,bounds:i,stroke:!1})]})}}D(im,"type","note"),D(im,"props",Lk),D(im,"migrations",Fk);function PE(t,o){const{labelHeight:n,fontSizeAdjustment:r}=L3(t,o),s=Math.max(0,n-er);if(s!==o.props.growY||r!==o.props.fontSizeAdjustment)return{...o,props:{...o.props,growY:s,fontSizeAdjustment:r}}}function hq(t,o){const n=o.props.text;if(!n)return{labelHeight:Fi[o.props.size]*Dn.lineHeight+Os*2,labelWidth:100,fontSizeAdjustment:0};const r=Fi[o.props.size];let s=0,i=0,a=er,l=er;const c=1;do{s=Math.min(r,r-i);const u=t.textMeasure.measureText(n,{...Dn,fontFamily:li[o.props.font],fontSize:s,maxWidth:er-Os*2-c,disableOverflowWrapBreaking:!0});if(a=u.h+Os*2,l=u.w+Os*2,s<=14){const f=t.textMeasure.measureText(n,{...Dn,fontFamily:li[o.props.font],fontSize:s,maxWidth:er-Os*2-c});a=f.h+Os*2,l=f.w+Os*2;break}if(u.scrollWidth.toFixed(0)===u.w.toFixed(0))break}while(i++<50);return{labelHeight:a,labelWidth:l,fontSizeAdjustment:s}}const fq=new ry;function L3(t,o){return fq.get(o,()=>hq(t,o))}function pq(t){const o=Ue(),n=D3();return B.useCallback(r=>{const s=o.getShape(t);if(!s)return;const i=r.key==="Tab",a=(r.metaKey||r.ctrlKey)&&r.key==="Enter";if(i||a){r.preventDefault();const l=o.getShapePageTransform(t),c=l.rotation(),u=!!(n.dir==="rtl"||o3(s.props.text)),f=er+Pl+(a&&!r.shiftKey?s.props.growY:0),h=new Y(i?r.shiftKey!=u?-1:1:0,a?r.shiftKey?-1:1:0).mul(f).add(qS).rot(c).add(l.point()),d=h3(o,s,h,c);d&&(o.mark("editing adjacent shape"),Sg(o,d,!0))}},[t,o,n.dir])}function rp(t){return er+t.props.growY}function mq(t,o){const n=Ja(t),r=Math.abs(n())+.5,s=Math.cos(o);return`0px ${5-r}px 5px -5px rgba(15, 23, 31, .6),
	0px ${(4+r*7)*Math.max(0,s)}px ${6+r*7}px -${4+r*6}px rgba(15, 23, 31, ${(.3+r*.1).toFixed(2)}), 
	0px 48px 10px -10px inset rgba(15, 23, 44, ${((.022+n()*.005)*((1+s)/2)).toFixed(2)})`}function gq(t,{initialBounds:o,scaleX:n,scaleY:r,newPoint:s}){const i=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),a=new Y(0,0);n<0&&(a.x=-(o.width*i)),r<0&&(a.y=-(o.height*i));const{x:l,y:c}=Y.Add(s,a.rot(t.rotation));return{x:l,y:c,props:{scale:i*t.props.scale}}}const yq=new ry;class am extends Bs{constructor(){super(...arguments);D(this,"canEdit",()=>!0);D(this,"isAspectRatioLocked",()=>!0);D(this,"onResize",(n,r)=>{const{initialBounds:s,initialShape:i,scaleX:a,handle:l}=r;if(r.mode==="scale_shape"||l!=="right"&&l!=="left")return{id:n.id,type:n.type,...gq(n,r)};{const c=s.width;let u=c*a;const f=new Y(0,0);u=Math.max(1,Math.abs(u)),l==="left"?(f.x=c-u,a<0&&(f.x+=u)):a<0&&(f.x-=u);const{x:h,y:d}=f.rot(n.rotation).add(i);return{id:n.id,type:n.type,x:h,y:d,props:{w:u/i.props.scale,autoSize:!1}}}});D(this,"onBeforeCreate",n=>{if(!n.props.autoSize||n.props.text.trim())return;const r=this.getMinDimensions(n);return{...n,x:n.x-r.width/2,y:n.y-r.height/2}});D(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n,a=n.props.text.trimEnd();a.length===0?this.editor.deleteShapes([n.id]):a!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])});D(this,"onBeforeUpdate",(n,r)=>{if(!r.props.autoSize)return;const s=n.props.size!==r.props.size||n.props.align!==r.props.align||n.props.font!==r.props.font||n.props.scale!==1&&r.props.scale===1,i=n.props.text!==r.props.text;if(!s&&!i)return;const a=this.getMinDimensions(n),l=TE(this.editor,r.props),c=a.width*n.props.scale,u=a.height*n.props.scale,f=l.width*r.props.scale,h=l.height*r.props.scale;let d;switch(r.props.align){case"middle":{d=new Y((f-c)/2,i?0:(h-u)/2);break}case"end":{d=new Y(f-c,i?0:(h-u)/2);break}default:{if(i)break;d=new Y(0,(h-u)/2);break}}if(d){d.rot(r.rotation);const{x:p,y:m}=r;return{...r,x:p-d.x,y:m-d.y,props:{...r.props,w:f}}}else return{...r,props:{...r.props,w:f}}});D(this,"onDoubleClickEdge",n=>{if(!n.props.autoSize)return{id:n.id,type:n.type,props:{autoSize:!0}};if(n.props.scale!==1)return{id:n.id,type:n.type,props:{scale:1}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(n){return yq.get(n.props,r=>TE(this.editor,r))}getGeometry(n){const{scale:r}=n.props,{width:s,height:i}=this.getMinDimensions(n);return new Hi({width:s*r,height:i*r,isFilled:!0,isLabel:!0})}component(n){const{id:r,props:{font:s,size:i,text:a,color:l,scale:c,align:u}}=n,{width:f,height:h}=this.getMinDimensions(n),d=n.id===this.editor.getOnlySelectedShapeId(),p=rn(),m=vq(r);return C.jsx(yy,{id:r,classNamePrefix:"tl-text-shape",type:"text",font:s,fontSize:bu[i],lineHeight:Dn.lineHeight,align:u,verticalAlign:"middle",text:a,labelColor:p[l].solid,isSelected:d,textWidth:f,textHeight:h,style:{transform:`scale(${c})`,transformOrigin:"top left"},wrap:!0,onKeyDown:m})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds,s=Ue();return n.props.autoSize&&s.getEditingShapeId()===n.id?null:C.jsx("rect",{width:Ee(r.width),height:Ee(r.height)})}toSvg(n,r){r.addExportDef(Su(n.props.font)),n.props.text&&r.addExportDef(Su(n.props.font));const s=this.editor.getShapeGeometry(n).bounds,i=s.width/(n.props.scale??1),a=s.height/(n.props.scale??1),l=ea(r);return C.jsx(gy,{fontSize:bu[n.props.size],font:n.props.font,align:n.props.align,verticalAlign:"middle",text:n.props.text,labelColor:l[n.props.color].solid,bounds:new mt(0,0,i,a),padding:0})}}D(am,"type","text"),D(am,"props",Nk),D(am,"migrations",$k);function TE(t,o){const{font:n,text:r,autoSize:s,size:i,w:a}=o,l=s?16:Math.max(16,a),c=bu[i],u=s?null:Math.floor(Math.max(l,a)),f=t.textMeasure.measureText(r,{...Dn,fontFamily:li[n],fontSize:c,maxWidth:u});return s&&(f.w+=1),{width:Math.max(l,f.w),height:Math.max(c,f.h)}}function vq(t){const o=Ue();return B.useCallback(n=>{if(o.getEditingShapeId()===t)switch(n.key){case"Enter":{(n.ctrlKey||n.metaKey)&&o.complete();break}case"Tab":{qt(n),n.shiftKey?xu.unindent(n.currentTarget):xu.indent(n.currentTarget);break}}},[o,t])}class lm extends Ru{constructor(){super(...arguments);D(this,"canEdit",()=>!0);D(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(n){const{editor:r}=this,s=r.getShapeGeometry(n).bounds.w*r.getZoomLevel()>=110,i=n.props.assetId?r.getAsset(n.props.assetId):null,{time:a,playing:l}=n.props,c=ly(n.id),u=P3(),f=B.useRef(null),h=B.useCallback(y=>{const v=y.currentTarget;v&&r.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:v.currentTime}}])},[n.id,r]),d=B.useCallback(y=>{const v=y.currentTarget;v&&r.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:v.currentTime}}])},[n.id,r]),p=B.useCallback(y=>{const v=y.currentTarget;v&&c&&r.updateShapes([{type:"video",id:n.id,props:{time:v.currentTime}}])},[c,n.id,r]),[m,g]=B.useState(!1),b=B.useCallback(y=>{const v=y.currentTarget;v&&(a!==v.currentTime&&(v.currentTime=a),l||v.pause(),g(!0))},[l,a]);return B.useEffect(()=>{const y=f.current;y&&(m&&!c&&a!==y.currentTime&&(y.currentTime=a),c&&document.activeElement!==y&&y.focus())},[c,m,a]),B.useEffect(()=>{if(u){const y=f.current;if(!y)return;y.pause(),y.currentTime=0}},[f,u]),C.jsxs(C.Fragment,{children:[C.jsx(Ul,{id:n.id,style:{color:"var(--color-text-3)",backgroundColor:i?"transparent":"var(--color-low)",border:i?"none":"1px solid var(--color-low-border)"},children:C.jsx("div",{className:"tl-counter-scaled",children:C.jsx("div",{className:"tl-video-container",children:i!=null&&i.props.src?C.jsx("video",{ref:f,style:c?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${n.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:c&&s,onPlay:h,onPause:d,onTimeUpdate:p,onLoadedData:b,hidden:!m,children:C.jsx("source",{src:i.props.src})}):C.jsx(C3,{})})})}),"url"in n.props&&n.props.url&&C.jsx(wu,{url:n.props.url,zoomLevel:r.getZoomLevel()})]})}indicator(n){return C.jsx("rect",{width:Ee(n.props.w),height:Ee(n.props.h)})}toSvg(n){return C.jsx("image",{href:bq(n.id),width:n.props.w,height:n.props.h})}}D(lm,"type","video"),D(lm,"props",Uk),D(lm,"migrations",Bk);function bq(t){const o=t.split(":")[1],n=document.querySelector(`.tl-video-shape-${o}`);if(n){const r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}else throw new Error("Video with not found when attempting serialization.")}const F3=[am,Qp,Jp,rm,im,sm,tm,Zp,nm,em,om,lm];function xq(t){return[t.sideEffects.registerAfterChangeHandler("instance",(o,n)=>{o.isFocused!==n.isFocused&&(n.isFocused?t.getContainer().focus():(t.complete(),t.getContainer().blur()))}),t.sideEffects.registerAfterChangeHandler("instance_page_state",(o,n)=>{if(o.croppingShapeId!==n.croppingShapeId){const r=t.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!o.croppingShapeId&&n.croppingShapeId?r||t.setCurrentTool("select.crop.idle"):o.croppingShapeId&&!n.croppingShapeId&&r&&t.setCurrentTool("select.idle")}o.editingShapeId!==n.editingShapeId&&(!o.editingShapeId&&n.editingShapeId?t.isIn("select.editing_shape")||t.setCurrentTool("select.editing_shape"):o.editingShapeId&&!n.editingShapeId&&t.isIn("select.editing_shape")&&t.setCurrentTool("select.idle"))})]}class N3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"scribbleId","id");D(this,"markId","");D(this,"excludedShapeIds",new Set);D(this,"onEnter",n=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=n;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(i=>{if(this.editor.isShapeOrAncestorLocked(i))return!0;if(this.editor.isShapeOfType(i,"group")||this.editor.isShapeOfType(i,"frame")){const a=this.editor.getPointInShapeSpace(i,r);return this.editor.getShapeGeometry(i).bounds.containsPoint(a)}return!1}).map(i=>i.id));const s=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=s.id,this.update()});D(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});D(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});D(this,"onPointerMove",()=>{this.update()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()})}update(){const{editor:n,excludedShapeIds:r}=this,s=n.getErasingShapeIds(),i=n.getZoomLevel(),a=n.getCurrentPageShapes(),{inputs:{currentPagePoint:l,previousPagePoint:c}}=n;this.pushPointToScribble();const u=new Set(s),f=Vi/i;for(const h of a){if(n.isShapeOfType(h,"group"))continue;const d=n.getShapeMask(h.id);if(d&&!Zo(l,d))continue;const p=n.getShapeGeometry(h),m=n.getShapePageTransform(h);if(!p||!m)continue;const g=m.clone().invert(),b=g.applyToPoint(c),y=g.applyToPoint(l),{bounds:v}=p;v.minX-f>Math.max(b.x,y.x)||v.minY-f>Math.max(b.y,y.y)||v.maxX+f<Math.min(b.x,y.x)||v.maxY+f<Math.min(b.y,y.y)||p.hitTestLineSegment(b,y,f)&&u.add(n.getOutermostSelectableShape(h).id)}this.editor.setErasingShapes([...u].filter(h=>!r.has(h)))}complete(){const{editor:n}=this;n.deleteShapes(n.getCurrentPageState().erasingShapeIds),n.setErasingShapes([]),this.parent.transition("idle")}cancel(){const{editor:n}=this;n.setErasingShapes([]),n.bailToMark(this.markId),this.parent.transition("idle",this.info)}}D(N3,"id","erasing");var Gv;let Sq=(Gv=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Gv,"id","idle"),Gv);var Vv;let wq=(Vv=class extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{const n=this.editor.getZoomLevel(),r=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:s}}=this.editor,i=new Set,a=i.size;for(let l=r.length,c=l-1;c>=0;c--){const u=r[c];if(!(this.editor.isShapeOrAncestorLocked(u)||this.editor.isShapeOfType(u,"group"))&&this.editor.isPointInShape(u,s,{hitInside:!1,margin:Vi/n})){const f=this.editor.getOutermostSelectableShape(u);if(this.editor.isShapeOfType(f,"frame")&&i.size>a)break;i.add(f.id)}}this.editor.setErasingShapes([...i])});D(this,"onLongPress",n=>{this.startErasing(n)});D(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startErasing(n)});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.cancel()})}startErasing(n){this.parent.transition("erasing",n)}complete(){const n=this.editor.getErasingShapeIds();n.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(n)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}},D(Vv,"id","pointing"),Vv);class cm extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}D(cm,"id","eraser"),D(cm,"initial","idle"),D(cm,"children",()=>[Sq,wq,N3]);class $3 extends bt{constructor(){super(...arguments);D(this,"initialCamera",new Y);D(this,"onEnter",()=>{this.initialCamera=Y.From(this.editor.getCamera()),this.update()});D(this,"onPointerMove",()=>{this.update()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.parent.transition("idle")});D(this,"onComplete",()=>{this.complete()})}update(){const{initialCamera:n,editor:r}=this,{currentScreenPoint:s,originScreenPoint:i}=r.inputs,a=Y.Sub(s,i).div(r.getZoomLevel());a.len2()!==0&&r.setCamera(n.clone().add(a))}complete(){const{editor:n}=this,{pointerVelocity:r}=n.inputs,s=Math.min(r.len(),2);s>.1&&this.editor.slideCamera({speed:s,direction:r,friction:Rp}),this.parent.transition("idle")}}D($3,"id","dragging");var Hv;let _q=(Hv=class extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.editor.setCursor({type:"grab",rotation:0})});D(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});D(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},D(Hv,"id","idle"),Hv);var Wv;let jq=(Wv=class extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});D(this,"onLongPress",()=>{this.startDragging()});D(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startDragging()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.complete()})}startDragging(){this.parent.transition("dragging")}complete(){this.parent.transition("idle")}},D(Wv,"id","pointing"),Wv);class um extends bt{constructor(){super(...arguments);D(this,"onDoubleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{duration:220,easing:Kn.easeOutQuint})}});D(this,"onTripleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{duration:320,easing:Kn.easeOutQuint})}});D(this,"onQuadrupleClick",n=>{if(n.phase==="settle"){const r=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:s}}=this.editor;r===1?this.editor.zoomToFit({duration:400,easing:Kn.easeOutQuint}):this.editor.resetZoom(s,{duration:320,easing:Kn.easeOutQuint})}})}}D(um,"id","hand"),D(um,"initial","idle"),D(um,"children",()=>[_q,jq,$3]);var Yv;let Eq=(Yv=class extends bt{constructor(){super(...arguments);D(this,"onPointerDown",n=>{this.parent.transition("lasering",n)})}},D(Yv,"id","idle"),Yv);class U3 extends bt{constructor(){super(...arguments);D(this,"scribbleId","id");D(this,"onEnter",()=>{const n=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=n.id,this.pushPointToScribble()});D(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});D(this,"onPointerMove",()=>{this.pushPointToScribble()});D(this,"onPointerUp",()=>{this.complete()});D(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}D(U3,"id","lasering");class dm extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}D(dm,"id","laser"),D(dm,"initial","idle"),D(dm,"children",()=>[Eq,U3]);class B3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"initialSelectedShapeIds",[]);D(this,"excludedShapeIds",new Set);D(this,"isWrapMode",!1);D(this,"initialStartShape",null);D(this,"onEnter",n=>{const{altKey:r,currentPagePoint:s}=this.editor.inputs;if(this.isWrapMode=this.editor.user.getIsWrapMode(),r){this.parent.transition("scribble_brushing",n);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(i=>this.editor.isShapeOfType(i,"group")||this.editor.isShapeOrAncestorLocked(i)).map(i=>i.id)),this.info=n,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(s)[0],this.hitTestShapes()});D(this,"onExit",()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})});D(this,"onTick",()=>{CS(this.editor)});D(this,"onPointerMove",()=>{this.hitTestShapes()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",n=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",n)});D(this,"onKeyDown",n=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()});D(this,"onKeyUp",()=>{this.hitTestShapes()});D(this,"onInterrupt",()=>{this.editor.updateInstanceState({brush:null})})}complete(){this.hitTestShapes(),this.parent.transition("idle")}hitTestShapes(){const{editor:n,excludedShapeIds:r,isWrapMode:s}=this,{inputs:{originPagePoint:i,currentPagePoint:a,shiftKey:l,ctrlKey:c}}=n,u=new Set(l?this.initialSelectedShapeIds:[]),f=s?!c:c,h=mt.FromPoints([i,a]),{corners:d}=h;let p,m,g,b,y,v;const x=n.getCurrentPageShapes(),S=n.getCurrentPageId();e:for(let j=0,P=x.length;j<P;j++){if(g=x[j],r.has(g.id)||u.has(g.id)||(b=n.getShapePageBounds(g),!b))continue e;if(h.contains(b)){this.handleHit(g,a,S,u,d);continue e}if(f||n.isShapeOfType(g,"frame"))continue e;if(h.collides(b)){if(y=n.getShapePageTransform(g),!y)continue e;v=y.clone().invert().applyToPoints(d);const M=n.getShapeGeometry(g);t:for(let O=0;O<4;O++)if(p=v[O],m=v[(O+1)%4],M.hitTestLineSegment(p,m,0)){this.handleHit(g,a,S,u,d);break t}}}n.getInstanceState().isCoarsePointer;const w=n.getInstanceState().brush;(!w||!h.equals(w))&&n.updateInstanceState({brush:{...h.toJson()}});const E=n.getSelectedShapeIds();(E.length!==u.size||E.some(j=>!u.has(j)))&&n.setSelectedShapes(Array.from(u),{squashing:!0})}handleHit(n,r,s,i,a){if(n.parentId===s){i.add(n.id);return}const l=this.editor.getOutermostSelectableShape(n),c=this.editor.getShapeMask(l.id);c&&!II(c,a)&&!Zo(r,c)||i.add(l.id)}}D(B3,"id","brushing");function rw(t,o=!1){const n=t.getZoomLevel(),{inputs:{currentPagePoint:r}}=t;return t.getShapeAtPoint(r,{hitInside:!1,hitLabels:o,margin:Vi/n,renderingOnly:!0})??t.getSelectedShapeAtPoint(r)}function z3(t,o,n){if(!o)throw Error("Needs to translate a cropped shape!");const{crop:r}=o.props;if(!r)return;const s=t.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;s==="x"?n.x=0:s==="y"&&(n.y=0),n.rot(-o.rotation);const i=1/(r.bottomRight.x-r.topLeft.x)*o.props.w,a=1/(r.bottomRight.y-r.topLeft.y)*o.props.h,l=r.bottomRight.y-r.topLeft.y,c=r.bottomRight.x-r.topLeft.x,u=_r(r);return u.topLeft.x=Math.min(1-c,Math.max(0,u.topLeft.x-n.x/i)),u.topLeft.y=Math.min(1-l,Math.max(0,u.topLeft.y-n.y/a)),u.bottomRight.x=u.topLeft.x+c,u.bottomRight.y=u.topLeft.y+l,{id:o.id,type:o.type,props:{crop:u}}}var Xv;let Cq=(Xv=class extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});const n=this.editor.getOnlySelectedShape();this.editor.on("change-history",this.cleanupCroppingState),n&&(this.editor.mark("crop"),this.editor.setCroppingShape(n.id))});D(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)});D(this,"onCancel",()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})});D(this,"onPointerDown",n=>{var r;if(!this.editor.getIsMenuOpen()){if(n.ctrlKey){this.cancel(),this.editor.root.handleEvent(n);return}switch(n.target){case"canvas":{const s=rw(this.editor);if(s&&!this.editor.isShapeOfType(s,"group")){this.onPointerDown({...n,shape:s,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(n);break}case"shape":{if(n.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",n);return}else(r=this.editor.getShapeUtil(n.shape))!=null&&r.canCrop(n.shape)?(this.editor.setCroppingShape(n.shape.id),this.editor.setSelectedShapes([n.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",n)):(this.cancel(),this.editor.root.handleEvent(n));break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});D(this,"onDoubleClick",n=>{var a;if(this.editor.inputs.shiftKey||n.phase!=="up")return;const r=this.editor.getCroppingShapeId();if(!r)return;const s=this.editor.getShape(r);if(!s)return;const i=this.editor.getShapeUtil(s);i&&n.target==="selection"&&((a=i.onDoubleClickEdge)==null||a.call(i,s))});D(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});D(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});D(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}});D(this,"cleanupCroppingState",()=>{this.editor.getCroppingShapeId()||this.editor.setCurrentTool("select.idle",{})})}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(n=!1){const{editor:{inputs:{keys:r}}}=this,s=r.has("ShiftLeft"),i=new Y(0,0);if(r.has("ArrowLeft")&&(i.x+=1),r.has("ArrowRight")&&(i.x-=1),r.has("ArrowUp")&&(i.y+=1),r.has("ArrowDown")&&(i.y-=1),i.equals(new Y(0,0)))return;s&&i.mul(10);const a=this.editor.getShape(this.editor.getCroppingShapeId());if(!a)return;const l=z3(this.editor,a,i);l&&(n||this.editor.mark("translate crop"),this.editor.updateShapes([l]))}},D(Xv,"id","idle"),Xv);class G3 extends bt{constructor(){super(...arguments);D(this,"onCancel",()=>{this.editor.setCurrentTool("select.crop.idle",{})});D(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",n)});D(this,"onPointerUp",n=>{this.editor.setCurrentTool("select.crop.idle",n)})}}D(G3,"id","pointing_crop");class V3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"markId","translating crop");D(this,"snapshot",{});D(this,"onEnter",n=>{this.info=n,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()});D(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});D(this,"onPointerMove",()=>{this.updateShapes()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onKeyDown",n=>{switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}});D(this,"onKeyUp",n=>{switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:s}=this.editor.inputs,i=s.clone().sub(r),a=z3(this.editor,n,i);a&&this.editor.updateShapes([a],{squashing:!0})}}D(V3,"id","translating_crop");class hm extends bt{}D(hm,"id","crop"),D(hm,"initial","idle"),D(hm,"children",()=>[Cq,V3,G3]);const cs=8,_u={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class H3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n,this.updateCursor()});D(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startResizing()});D(this,"onLongPress",()=>{this.startResizing()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.editor.getSelectedShapes(),r=_u[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:n.length===1?this.editor.getSelectionRotation():0}})}startResizing(){this.editor.getInstanceState().isReadonly||this.parent.transition("resizing",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}D(H3,"id","pointing_resize_handle");class W3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"markId","");D(this,"snapshot",{});D(this,"onEnter",n=>{this.info=n,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()});D(this,"onPointerMove",()=>{this.updateShapes()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){if(!this.editor.getSelectedShapes()[0])return;const r=_u[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:this.editor.getSelectionRotation()}})}updateShapes(){const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n||!this.editor.getShapeUtil("image"))return;const i=n.props,a=this.editor.inputs.currentPagePoint.clone().sub(r),l=this.editor.inputs.originPagePoint.clone().sub(r),c=a.clone().sub(l).rot(-n.rotation),u=i.crop??this.getDefaultCrop(),f=_r(u),h=new Y(n.x,n.y),d=new Y(0,0),p=1/(u.bottomRight.x-u.topLeft.x)*i.w,m=1/(u.bottomRight.y-u.topLeft.y)*i.h;let g=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(m<cs)break;g=!0,f.topLeft.y=f.topLeft.y+c.y/m,m*(f.bottomRight.y-f.topLeft.y)<cs?(f.topLeft.y=f.bottomRight.y-cs/m,d.y=(f.topLeft.y-u.topLeft.y)*m):f.topLeft.y<=0?(f.topLeft.y=0,d.y=(f.topLeft.y-u.topLeft.y)*m):d.y=c.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(m<cs)break;g=!0,f.bottomRight.y=Math.min(1,f.bottomRight.y+c.y/m),m*(f.bottomRight.y-f.topLeft.y)<cs&&(f.bottomRight.y=f.topLeft.y+cs/m);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(p<cs)break;g=!0,f.topLeft.x=f.topLeft.x+c.x/p,p*(f.bottomRight.x-f.topLeft.x)<cs?(f.topLeft.x=f.bottomRight.x-cs/p,d.x=(f.topLeft.x-u.topLeft.x)*p):f.topLeft.x<=0?(f.topLeft.x=0,d.x=(f.topLeft.x-u.topLeft.x)*p):d.x=c.x;break}case"right":case"top_right":case"bottom_right":{if(p<cs)break;g=!0,f.bottomRight.x=Math.min(1,f.bottomRight.x+c.x/p),p*(f.bottomRight.x-f.topLeft.x)<cs&&(f.bottomRight.x=f.topLeft.x+cs/p);break}}if(!g)return;h.add(d.rot(n.rotation));const b={id:n.id,type:n.type,x:h.x,y:h.y,props:{crop:f,w:(f.bottomRight.x-f.topLeft.x)*p,h:(f.bottomRight.y-f.topLeft.y)*m}};this.editor.updateShapes([b],{squashing:!0}),this.updateCursor()}complete(){this.updateShapes(),xr(this.editor,[this.snapshot.shape.id]),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}createSnapshot(){const n=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,s=this.editor.getOnlySelectedShape(),i=this.editor.getSelectionRotatedPageBounds(),a=Y.RotWith(i.getHandlePoint(this.info.handle),i.point,n),l=Y.Sub(r,a);return{shape:s,cursorHandleOffset:l}}}D(W3,"id","cropping");class Y3 extends bt{constructor(){super(...arguments);D(this,"shapeId","");D(this,"initialHandle",{});D(this,"initialAdjacentHandle",null);D(this,"initialPagePoint",{});D(this,"markId","");D(this,"initialPageTransform");D(this,"initialPageRotation");D(this,"info",{});D(this,"isPrecise",!1);D(this,"isPreciseId",null);D(this,"pointingId",null);D(this,"onEnter",n=>{const{shape:r,isCreating:s,handle:i}=n;if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.shapeId=r.id,this.markId=s?`creating:${r.id}`:"dragging handle",s||this.editor.mark(this.markId),this.initialHandle=_r(i),this.editor.isShapeOfType(r,"line")&&this.initialHandle.type==="create"){this.editor.updateShape({...r,props:{points:{...r.props.points,[i.index]:{id:i.index,index:i.index,x:i.x,y:i.y}}}});const u=this.editor.getShapeHandles(r).find(f=>f.index===i.index);this.initialHandle=_r(u)}this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:s?"cross":"grabbing",rotation:0}},{ephemeral:!0});const a=this.editor.getShapeHandles(r).sort(qn),l=a.findIndex(c=>c.id===n.handle.id);this.initialAdjacentHandle=null;for(let c=l+1;c<a.length;c++){const u=a[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=a.length-1;c>=0;c--){const u=a[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==n.handle.id){this.initialAdjacentHandle=u;break}}if(this.editor.isShapeOfType(r,"arrow")){const c=r.props[n.handle.id];this.isPrecise=!1,(c==null?void 0:c.type)==="binding"?(this.editor.setHintingShapes([c.boundShapeId]),this.isPrecise=c.isPrecise,this.isPrecise?this.isPreciseId=c.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([])}this.update(),this.editor.select(this.shapeId)});D(this,"exactTimeout",-1);D(this,"onPointerMove",()=>{this.update()});D(this,"onKeyDown",()=>{this.update()});D(this,"onKeyUp",()=>{this.update()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.update(),this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clearIndicators(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clearIndicators(),xr(this.editor,[this.shapeId]);const{onInteractionEnd:n}=this.info;if(this.editor.getInstanceState().isToolLocked&&n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators();const{onInteractionEnd:n}=this.info;if(n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var j;const{editor:n,shapeId:r,initialPagePoint:s}=this,{initialHandle:i,initialPageRotation:a,initialAdjacentHandle:l}=this,c=this.editor.getHintingShapeIds(),u=this.editor.user.getIsSnapMode(),{snaps:f,inputs:{currentPagePoint:h,shiftKey:d,ctrlKey:p,altKey:m,pointerVelocity:g}}=n,b=this.info.shape,y=n.getShape(r);if(!y)return;const v=n.getShapeUtil(y);let x=h.clone().sub(s).rot(-a).add(i);if(d&&l&&i.id!=="middle"){const P=Y.Angle(l,x),O=ag(P,24)-P;x=Y.RotWith(x,l,O)}n.snaps.clearIndicators();let S={...i,x:x.x,y:x.y};if(i.canSnap&&(u?!p:p)){if(!n.getShapePageTransform(y.id))throw Error("Expected a page transform");const M=f.handles.snapHandle({currentShapeId:r,handle:S});M&&(M.nudge.rot(-n.getShapeParentTransform(y).rotation()),x.add(M.nudge),S={...i,x:x.x,y:x.y})}const w=(j=v.onHandleDrag)==null?void 0:j.call(v,y,{handle:S,isPrecise:this.isPrecise||m,initial:b}),E={...y,...w};if(i.canBind){const P=E.props[i.id];(P==null?void 0:P.type)==="binding"?c[0]!==P.boundShapeId&&(n.setHintingShapes([P.boundShapeId]),this.pointingId=P.boundShapeId,this.isPrecise=g.len()<.5||m,this.isPreciseId=this.isPrecise?P.boundShapeId:null,this.resetExactTimeout()):c.length>0&&(n.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}w&&n.updateShapes([E],{squashing:!0})}}D(Y3,"id","dragging_handle");function X3(t){return t.isLabel?[t]:t instanceof Vs?t.children.filter(o=>o.isLabel):[]}class q3 extends bt{constructor(){super(...arguments);D(this,"hitShapeForPointerUp",null);D(this,"onEnter",()=>{const n=this.editor.getEditingShape();if(!n)throw Error("Entered editing state without an editing shape");this.hitShapeForPointerUp=null,iu(this.editor),this.editor.select(n)});D(this,"onExit",()=>{var i;const{editingShapeId:n}=this.editor.getCurrentPageState();if(!n)return;this.editor.setEditingShape(null);const r=this.editor.getShape(n),s=this.editor.getShapeUtil(r);(i=s.onEditEnd)==null||i.call(s,r)});D(this,"onPointerMove",n=>{if(this.hitShapeForPointerUp&&this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.editor.select(this.hitShapeForPointerUp),this.parent.transition("translating",n),this.hitShapeForPointerUp=null;return}switch(n.target){case"shape":case"canvas":{iu(this.editor);return}}});D(this,"onPointerDown",n=>{switch(this.hitShapeForPointerUp=null,n.target){case"canvas":{const r=rw(this.editor,!0);if(r){this.onPointerDown({...n,shape:r,target:"shape"});return}break}case"shape":{const{shape:r}=n,s=this.editor.getEditingShape();if(!s)throw Error("Expected an editing shape!");const i=this.editor.getShapeUtil(r).getGeometry(r),a=X3(i),l=a.length===1?a[0]:void 0,c=this.editor.isShapeOfType(s,"text")&&s.props.text.trim()==="";if(l&&!c){const u=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(l.bounds.containsPoint(u,0)&&l.hitTestPoint(u)){if(r.id===s.id)return;this.hitShapeForPointerUp=r,this.editor.mark("editing on pointer up"),this.editor.select(r.id);return}}else{if(r.id===s.id)this.editor.isShapeOfType(r,"frame")&&this.editor.setEditingShape(null);else{this.parent.transition("pointing_shape",n);return}return}break}}this.parent.transition("idle",n),this.editor.root.handleEvent(n)});D(this,"onPointerUp",n=>{const r=this.hitShapeForPointerUp;if(!r)return;this.hitShapeForPointerUp=null;const s=this.editor.getShapeUtil(r);if(this.editor.getInstanceState().isReadonly&&!s.canEditInReadOnly(r)){this.parent.transition("pointing_shape",n);return}this.editor.select(r.id),this.editor.setEditingShape(r.id),iu(this.editor)});D(this,"onComplete",n=>{this.parent.transition("idle",n)});D(this,"onCancel",n=>{this.parent.transition("idle",n)})}}D(q3,"id","editing_shape");function kE(t){const o=t.getOnlySelectedShape();return!!(o&&!t.isShapeOrAncestorLocked(o)&&t.getShapeUtil(o).canCrop(o))}function _g(t){const o=t.getSelectedShapeIds(),{shiftKey:n,altKey:r,currentPagePoint:s}=t.inputs,i=t.getShapeAtPoint(s,{hitInside:!1,margin:Vi/t.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:a=>!a.isLocked});if(i){const a=t.getOutermostSelectableShape(i);if(n&&!r)t.cancelDoubleClick(),o.includes(a.id)?(t.mark("deselecting shape"),t.deselect(a)):(t.mark("shift selecting shape"),t.setSelectedShapes([...o,a.id]));else{let l;a===i||a.id===t.getFocusedGroupId()||o.includes(a.id)?l=i:l=a,l&&!o.includes(l.id)&&(t.mark("selecting shape"),t.select(l.id))}}else{if(n)return;{o.length>0&&(t.mark("selecting none"),t.selectNone());const a=t.getFocusedGroupId();if(Vo(a)){const l=t.getShape(a);t.isPointInShape(l,s,{margin:0,hitInside:!0})||t.setFocusedGroup(null)}}}}const Pq=["Delete","Backspace","[","]","Enter"," ","Shift","Tab"];var qv;let Tq=(qv=class extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{this.parent.setCurrentToolIdMask(void 0),iu(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});D(this,"onPointerMove",()=>{iu(this.editor)});D(this,"onPointerDown",n=>{if(this.editor.getIsMenuOpen())return;const r=n.ctrlKey&&kE(this.editor);if(n.ctrlKey&&!r){if(n.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_shape",n);return}this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{const s=rw(this.editor);if(s&&!s.isLocked){this.onPointerDown({...n,shape:s,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),a=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:l}}=this.editor;if((i.length>1||a&&!this.editor.getShapeUtil(a).hideSelectionBoundsBg(a))&&IE(this.editor,l)){this.onPointerDown({...n,target:"selection"});return}this.parent.transition("pointing_canvas",n);break}case"shape":{const{shape:s}=n;if(this.isOverArrowLabelTest(s)){this.parent.transition("pointing_arrow_label",n);break}if(this.editor.isShapeOrAncestorLocked(s)){this.parent.transition("pointing_canvas",n);break}this.parent.transition("pointing_shape",n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:{const s=this.editor.getHoveredShape();if(s&&!this.editor.getSelectedShapeIds().includes(s.id)&&!s.isLocked){this.onPointerDown({...n,shape:s,target:"shape"});return}this.parent.transition("pointing_selection",n)}}break}}});D(this,"onDoubleClick",n=>{var r,s,i,a;if(!(this.editor.inputs.shiftKey||n.phase!=="up"))switch(n.target){case"canvas":{const l=this.editor.getHoveredShape(),c=l&&!this.editor.isShapeOfType(l,"group")?l:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:Vi/this.editor.getZoomLevel(),hitInside:!1}),u=this.editor.getFocusedGroupId();if(c){if(this.editor.isShapeOfType(c,"group")){_g(this.editor);return}else{const f=this.editor.getShape(c.parentId);if(f&&this.editor.isShapeOfType(f,"group")&&!(u&&f.id===u)){_g(this.editor);return}}this.onDoubleClick({...n,shape:c,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(n);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const l=this.editor.getOnlySelectedShape();if(l){const c=this.editor.getShapeUtil(l);if(!this.canInteractWithShapeInReadOnly(l))return;if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const u=(r=c.onDoubleClickEdge)==null?void 0:r.call(c,l);if(u){this.editor.mark("double click edge"),this.editor.updateShapes([u]),xr(this.editor,[l.id]);return}}if(c.canCrop(l)&&!this.editor.isShapeOrAncestorLocked(l)){this.parent.transition("crop",n);return}this.shouldStartEditingShape(l)&&this.startEditingShape(l,n,!0)}break}case"shape":{const{shape:l}=n,c=this.editor.getShapeUtil(l);if(l.type!=="video"&&l.type!=="embed"&&this.editor.getInstanceState().isReadonly)break;if(c.onDoubleClick){const u=(s=c.onDoubleClick)==null?void 0:s.call(c,l);if(u){this.editor.updateShapes([u]);return}else if(c.canCrop(l)&&!this.editor.isShapeOrAncestorLocked(l)){this.editor.mark("select and crop"),this.editor.select((i=n.shape)==null?void 0:i.id),this.parent.transition("crop",n);return}}this.shouldStartEditingShape(l)?this.startEditingShape(l,n,!0):this.handleDoubleClickOnCanvas(n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:l,handle:c}=n,u=this.editor.getShapeUtil(l),f=(a=u.onDoubleClickHandle)==null?void 0:a.call(u,l,c);f?this.editor.updateShapes([f]):this.shouldStartEditingShape(l)&&this.startEditingShape(l,n,!0)}}});D(this,"onRightClick",n=>{switch(n.target){case"canvas":{const r=this.editor.getHoveredShape(),s=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:Vi/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(s){this.onRightClick({...n,shape:s,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),a=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:l}}=this.editor;if((i.length>1||a&&!this.editor.getShapeUtil(a).hideSelectionBoundsBg(a))&&IE(this.editor,l)){this.onRightClick({...n,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:r}=this.editor.getCurrentPageState(),{shape:s}=n,i=this.editor.getOutermostSelectableShape(s,a=>!r.includes(a.id));r.includes(i.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([i.id]));break}}});D(this,"onCancel",()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())});D(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);return}}if(wn.editOnType.get()&&!Pq.includes(n.key)&&!n.altKey&&!n.ctrlKey){const r=this.editor.getOnlySelectedShape();if(r&&this.editor.isShapeOfType(r,"note")&&this.shouldStartEditingShape(r)){this.startEditingShape(r,{...n,target:"shape",shape:r},!0);return}}});D(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});D(this,"onKeyUp",n=>{switch(n.code){case"Enter":{const r=this.editor.getSelectedShapes();if(r.every(i=>this.editor.isShapeOfType(i,"group"))){this.editor.setSelectedShapes(r.flatMap(i=>this.editor.getSortedChildIdsForParent(i.id)));return}const s=this.editor.getOnlySelectedShape();if(s&&this.shouldStartEditingShape(s)){this.startEditingShape(s,{...n,target:"shape",shape:s},!0);return}kE(this.editor)&&this.parent.transition("crop",n);break}}});D(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1)}shouldStartEditingShape(n=this.editor.getOnlySelectedShape()){return!n||this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||!this.canInteractWithShapeInReadOnly(n)?!1:this.editor.getShapeUtil(n).canEdit(n)}startEditingShape(n,r,s){this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||(this.editor.mark("editing shape"),Sg(this.editor,n,s),this.parent.transition("editing_shape",r))}isOverArrowLabelTest(n){if(!n)return!1;const r=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint);if(this.editor.isShapeOfType(n,"arrow")){const s=this.editor.getShapeGeometry(n).children[1];if(s&&Zo(r,s.vertices))return!0}return!1}handleDoubleClickOnCanvas(n){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const r=hr(),{x:s,y:i}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:s,y:i,props:{text:"",autoSize:!0}}]);const a=this.editor.getShape(r);if(!a)return;const l=this.editor.getShapeUtil(a);this.editor.getInstanceState().isReadonly&&!l.canEditInReadOnly(a)||(this.editor.setEditingShape(r),this.editor.select(r),this.parent.transition("editing_shape",n))}nudgeSelectedShapes(n=!1){const{editor:{inputs:{keys:r}}}=this,s=r.has("ShiftLeft"),i=new Y(0,0);if(r.has("ArrowLeft")&&(i.x-=1),r.has("ArrowRight")&&(i.x+=1),r.has("ArrowUp")&&(i.y-=1),r.has("ArrowDown")&&(i.y+=1),i.equals(new Y(0,0)))return;n||this.editor.mark("nudge shapes");const{gridSize:a}=this.editor.getDocumentSettings(),l=this.editor.getInstanceState().isGridMode?s?a*Mq:a:s?kq:Iq,c=this.editor.getSelectedShapeIds();this.editor.nudgeShapes(c,i.mul(l)),xr(this.editor,c)}canInteractWithShapeInReadOnly(n){return!!(!this.editor.getInstanceState().isReadonly||this.editor.getShapeUtil(n).canEditInReadOnly(n))}},D(qv,"id","idle"),qv);const kq=10,Iq=1,Mq=5;function IE(t,o){const n=t.getSelectionRotatedPageBounds();if(!n)return!1;const r=t.getSelectionRotation();return r?Zo(o,n.corners.map(s=>Y.RotWith(s,n.point,r))):n.containsPoint(o)}class K3 extends bt{constructor(){super(...arguments);D(this,"shapeId","");D(this,"markId","");D(this,"wasAlreadySelected",!1);D(this,"didDrag",!1);D(this,"info",{});D(this,"onEnter",n=>{const{shape:r}=n;this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.shapeId=r.id,this.didDrag=!1,this.wasAlreadySelected=this.editor.getOnlySelectedShapeId()===r.id,this.updateCursor();const i=this.editor.getShapeGeometry(r).children[1];if(!i)throw Error(`Expected to find an arrow label geometry for shape: ${r.id}`);const{currentPagePoint:a}=this.editor.inputs,l=this.editor.getPointInShapeSpace(r,a);this._labelDragOffset=Y.Sub(i.center,l),this.markId="label-drag start",this.editor.mark(this.markId),this.editor.setSelectedShapes([this.shapeId])});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});D(this,"_labelDragOffset",new Y(0,0));D(this,"onPointerMove",()=>{const{isDragging:n}=this.editor.inputs;if(!n)return;const r=this.editor.getShape(this.shapeId);if(!r)return;const s=this.editor.getArrowInfo(r),i=this.editor.getShapeGeometry(r),a=i.children[0],l=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint),c=a.nearestPoint(Y.Add(l,this._labelDragOffset));let u;if(s.isStraight){const f=Y.Dist(s.start.point,s.end.point);u=1-Y.Dist(s.end.point,c)/f}else{const{_center:f,measure:h,angleEnd:d,angleStart:p}=i.children[0];u=Qb(h,p,d,f.angle(c))}isNaN(u)&&(u=.5),this.didDrag=!0,this.editor.updateShape({id:r.id,type:r.type,props:{labelPosition:u}},{squashing:!0})});D(this,"onPointerUp",()=>{const n=this.editor.getShape(this.shapeId);n&&(this.didDrag||!this.wasAlreadySelected?this.complete():(this.editor.setEditingShape(n.id),this.editor.setCurrentTool("select.editing_shape")))});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:"grabbing",rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}D(K3,"id","pointing_arrow_label");class Z3 extends bt{constructor(){super(...arguments);D(this,"onEnter",()=>{const{inputs:n}=this.editor;n.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});D(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",n)});D(this,"onPointerUp",()=>{_g(this.editor),this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onInterrupt",()=>{this.parent.transition("idle")})}complete(){this.parent.transition("idle")}}D(Z3,"id","pointing_canvas");class Q3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];if(!r)return;const s=_u[this.info.handle];this.editor.updateInstanceState({cursor:{type:s,rotation:this.editor.getSelectionRotation()}}),this.editor.setCroppingShape(r.id)});D(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});D(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startCropping()});D(this,"onLongPress",()=>{this.startCropping()});D(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}startCropping(){this.editor.getInstanceState().isReadonly||this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}}D(Q3,"id","pointing_crop_handle");class J3 extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n;const{shape:r}=n;if(this.editor.isShapeOfType(r,"arrow")){const s=r.props[n.handle.id];(s==null?void 0:s.type)==="binding"&&this.editor.setHintingShapes([s.boundShapeId])}this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});D(this,"onExit",()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});D(this,"onPointerUp",()=>{const{shape:n,handle:r}=this.info;if(this.editor.isShapeOfType(n,"note")){const{editor:s}=this,i=ME(s,n,r,!1);if(i){Sg(s,i,!0);return}}this.parent.transition("idle",this.info)});D(this,"onPointerMove",()=>{const{editor:n}=this;n.inputs.isDragging&&this.startDraggingHandle()});D(this,"onLongPress",()=>{this.startDraggingHandle()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}startDraggingHandle(){const{editor:n}=this;if(n.getInstanceState().isReadonly)return;const{shape:r,handle:s}=this.info;if(n.isShapeOfType(r,"note")){const i=ME(n,r,s,!0);if(i){const a=n.getPointInParentSpace(i,n.inputs.originPagePoint).sub(Y.Rot(qS,i.rotation));n.updateShape({...i,x:a.x,y:a.y}),n.setHoveredShape(i.id).select(i.id).setCurrentTool("select.translating",{...this.info,target:"shape",shape:n.getShape(i),onInteractionEnd:"note",isCreating:!0,onCreate:()=>{Sg(n,i,!0)}});return}}this.parent.transition("dragging_handle",this.info)}cancel(){this.parent.transition("idle")}}D(J3,"id","pointing_handle");function ME(t,o,n,r){const s=t.getShapePageTransform(o.id),i=s.point(),a=s.rotation(),c=u3(i,a,o.props.growY,0)[n.index];if(c)return h3(t,o,c,a,r)}class eO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.updateCursor()});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});D(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startRotating()});D(this,"onLongPress",()=>{this.startRotating()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.updateInstanceState({cursor:{type:_u[this.info.handle],rotation:this.editor.getSelectionRotation()}})}startRotating(){this.editor.getInstanceState().isReadonly||this.parent.transition("rotating",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}D(eO,"id","pointing_rotate_handle");class tO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n});D(this,"onPointerUp",n=>{_g(this.editor),this.parent.transition("idle",n)});D(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startTranslating(n)});D(this,"onLongPress",n=>{this.startTranslating(n)});D(this,"onDoubleClick",n=>{var i,a;const r=this.editor.getHoveredShape(),s=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(s){this.parent.transition("idle"),(a=(i=this.parent).onDoubleClick)==null||a.call(i,{...n,target:"shape",shape:this.editor.getShape(s)});return}});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}startTranslating(n){this.editor.getInstanceState().isReadonly||this.parent.transition("translating",n)}cancel(){this.parent.transition("idle")}}D(tO,"id","pointing_selection");class rO extends bt{constructor(){super(...arguments);D(this,"hitShape",{});D(this,"hitShapeForPointerUp",{});D(this,"isDoubleClick",!1);D(this,"didSelectOnEnter",!1);D(this,"onEnter",n=>{const r=this.editor.getSelectedShapeIds(),s=this.editor.getSelectionRotatedPageBounds(),i=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:a,shiftKey:l,altKey:c}}=this.editor;this.hitShape=n.shape,this.isDoubleClick=!1;const u=this.editor.getOutermostSelectableShape(n.shape),f=this.editor.findShapeAncestor(u,h=>r.includes(h.id));if(this.editor.getShapeUtil(n.shape).onClick||u.id===i||r.includes(u.id)||f||r.length>1&&(s!=null&&s.containsPoint(a))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=u;return}this.didSelectOnEnter=!0,l&&!c?(this.editor.cancelDoubleClick(),r.includes(u.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...r,u.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([u.id]))});D(this,"onPointerUp",n=>{var f;const r=this.editor.getSelectedShapeIds(),s=this.editor.getFocusedGroupId(),i=this.editor.getZoomLevel(),{inputs:{currentPagePoint:a,shiftKey:l}}=this.editor,c=this.editor.getShapeAtPoint(a,{margin:Vi/i,hitInside:!0,renderingOnly:!0})??this.hitShape,u=c?this.editor.getOutermostSelectableShape(c):this.hitShapeForPointerUp;if(u){const h=this.editor.getShapeUtil(u);if(h.onClick){const d=(f=h.onClick)==null?void 0:f.call(h,u);if(d){this.editor.mark("shape on click"),this.editor.updateShapes([d]),this.parent.transition("idle",n);return}}if(u.id===s){r.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",n);return}}if(!this.didSelectOnEnter){const h=this.editor.getOutermostSelectableShape(c,d=>!r.includes(d.id));if(r.includes(h.id))if(l)this.editor.mark("deselecting on pointer up"),this.editor.deselect(u);else if(r.includes(u.id)){if(r.length===1){const d=this.editor.getShapeUtil(u).getGeometry(u),p=X3(d),m=p.length===1?p[0]:void 0;if(m){const g=this.editor.getPointInShapeSpace(u,a);if(m.bounds.containsPoint(g,0)&&m.hitTestPoint(g)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(u.id);const b=this.editor.getShapeUtil(u);this.editor.getInstanceState().isReadonly&&!b.canEditInReadOnly(u)||(this.editor.setEditingShape(u.id),this.editor.setCurrentTool("select.editing_shape"),this.isDoubleClick&&this.editor.emit("select-all-text",{shapeId:u.id}))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(u.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(u);else if(l){const d=this.editor.getShapeAncestors(h);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(p=>!d.find(m=>m.id===p)),h.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([h.id])}this.parent.transition("idle",n)});D(this,"onDoubleClick",()=>{this.isDoubleClick=!0});D(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startTranslating(n)});D(this,"onLongPress",n=>{this.startTranslating(n)});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.cancel()});D(this,"onInterrupt",()=>{this.cancel()})}startTranslating(n){this.editor.getInstanceState().isReadonly||(this.editor.getContainer().focus(),this.parent.transition("translating",n))}cancel(){this.parent.transition("idle")}}D(rO,"id","pointing_shape");class nO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"markId","");D(this,"didHoldCommand",!1);D(this,"creationCursorOffset",{x:0,y:0});D(this,"snapshot",{});D(this,"onEnter",n=>{const{isCreating:r=!1,creationCursorOffset:s={x:0,y:0}}=n;this.info=n,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.creationCursorOffset=s,this.snapshot=this._createSnapshot(),r?(this.markId=`creating:${this.editor.getOnlySelectedShape().id}`,this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0})):(this.markId="starting resizing",this.editor.mark(this.markId)),this.handleResizeStart(),this.updateShapes()});D(this,"onTick",()=>{CS(this.editor)});D(this,"onPointerMove",()=>{this.updateShapes()});D(this,"onKeyDown",()=>{this.updateShapes()});D(this,"onKeyUp",()=>{this.updateShapes()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clearIndicators()});D(this,"_createSnapshot",()=>{const n=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:s}}=this.editor,i=this.editor.getSelectionRotatedPageBounds(),a=Y.RotWith(i.getHandlePoint(this.info.handle),i.point,r),l=Y.Sub(s,a),c=new Map,u=[];n.forEach(h=>{const d=this.editor.getShape(h);if(d){if(d.type==="frame"&&u.push({id:h,children:Rt(this.editor.getSortedChildIdsForParent(d).map(p=>this.editor.getShape(p)))}),c.set(d.id,this._createShapeSnapshot(d)),this.editor.isShapeOfType(d,"frame")&&n.length===1)return;this.editor.visitDescendants(d.id,p=>{const m=this.editor.getShape(p);if(m&&(c.set(m.id,this._createShapeSnapshot(m)),this.editor.isShapeOfType(m,"frame")))return!1})}});const f=![...c.values()].some(h=>!Hk(h.pageRotation,r)||h.isAspectRatioLocked);return{shapeSnapshots:c,selectionBounds:i,cursorHandleOffset:l,selectionRotation:r,selectedShapeIds:n,canShapesDeform:f,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:u}});D(this,"_createShapeSnapshot",n=>{const r=this.editor.getShapePageTransform(n),s=this.editor.getShapeUtil(n);return{shape:n,bounds:this.editor.getShapeGeometry(n).bounds,pageTransform:r,pageRotation:vt.Decompose(r).rotation,isAspectRatioLocked:s.isAspectRatioLocked(n)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var n,r;if(xr(this.editor,this.snapshot.selectedShapeIds),this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(n=this.info).onCreate)==null||r.call(n,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:s})=>{var l;const i=this.editor.getShapeUtil(s),a=(l=i.onResizeStart)==null?void 0:l.call(i,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:s})=>{var c;const i=this.editor.getShape(s.id),a=this.editor.getShapeUtil(s),l=(c=a.onResizeEnd)==null?void 0:c.call(a,s,i);l&&r.push(l)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.editor.inputs,{frames:s,shapeSnapshots:i,selectionBounds:a,cursorHandleOffset:l,selectedShapeIds:c,selectionRotation:u,canShapesDeform:f}=this.snapshot,h=r||!f,{ctrlKey:d}=this.editor.inputs,p=this.editor.inputs.currentPagePoint.clone().sub(l).sub(this.creationCursorOffset),m=this.editor.inputs.originPagePoint.clone().sub(l);if(this.editor.getInstanceState().isGridMode&&!d){const{gridSize:P}=this.editor.getDocumentSettings();p.snapToGrid(P)}const g=this.info.handle,b=OE(g,Math.PI);if(this.editor.snaps.clearIndicators(),(this.editor.user.getIsSnapMode()?!d:d)&&u%dr===0){const{nudge:P}=this.editor.snaps.shapeBounds.snapResizeShapes({dragDelta:Y.Sub(p,m),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:OE(g,u),isAspectRatioLocked:h,isResizingFromCenter:n});p.add(P)}const v=Y.RotWith(n?a.center:a.getHandlePoint(b),a.point,u),x=Y.Sub(p,v).rot(-u),S=Y.Sub(m,v).rot(-u),w=Y.DivV(x,S);Number.isFinite(w.x)||(w.x=1),Number.isFinite(w.y)||(w.y=1);const E=g==="top"||g==="bottom",j=g==="left"||g==="right";h?j?w.y=Math.abs(w.x):E?w.x=Math.abs(w.y):Math.abs(w.x)>Math.abs(w.y)?w.y=Math.abs(w.x)*(w.y<0?-1:1):w.x=Math.abs(w.y)*(w.x<0?-1:1):(E&&(w.x=1),j&&(w.y=1)),this.info.isCreating||this.updateCursor({dragHandle:g,isFlippedX:w.x<0,isFlippedY:w.y<0,rotation:u});for(const P of i.keys()){const M=i.get(P);this.editor.resizeShape(P,w,{initialShape:M.shape,initialBounds:M.bounds,initialPageTransform:M.pageTransform,dragHandle:g,mode:c.length===1&&P===c[0]?"resize_bounds":"scale_shape",scaleOrigin:v,scaleAxisRotation:u})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:P,children:M}of s){if(!M.length)continue;const O=i.get(P).shape,k=this.editor.getShape(P);if(!(O&&k))continue;const F=k.x-O.x,A=k.y-O.y,N=new Y(F,A).rot(-O.rotation);if(N.x!==0||N.y!==0)for(const $ of M)this.editor.updateShape({id:$.id,type:$.type,x:$.x-N.x,y:$.y-N.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:P}of s)if(P.length)for(const M of P)this.editor.updateShape({id:M.id,type:M.type,x:M.x,y:M.y})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:s,rotation:i}){const a={...this.editor.getInstanceState().cursor};switch(n){case"top_left":case"bottom_right":{a.type="nwse-resize",r!==s&&(a.type="nesw-resize");break}case"top_right":case"bottom_left":{a.type="nesw-resize",r!==s&&(a.type="nwse-resize");break}}a.rotation=i,this.editor.setCursor(a)}}D(nO,"id","resizing");const pv=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function OE(t,o){o=o%or;const n=Math.round(o/(Yt/4)),r=pv.indexOf(t);return pv[(r+n)%pv.length]}const AE=Math.PI/180;class oO extends bt{constructor(){super(...arguments);D(this,"snapshot",{});D(this,"info",{});D(this,"markId","");D(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const r=AI({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r;const s=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Fp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:_u[this.info.handle],rotation:s+this.snapshot.initialSelectionRotation}})});D(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}});D(this,"onPointerMove",()=>{this.update()});D(this,"onKeyDown",()=>{this.update()});D(this,"onKeyUp",()=>{this.update()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"update",()=>{const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Fp({editor:this.editor,delta:n,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:_u[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation}})});D(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});D(this,"complete",()=>{Fp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),xr(this.editor,this.snapshot.shapeSnapshots.map(n=>n.shape.id)),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}_getRotationFromPointerPosition({snapToNearestDegree:n}){const r=this.editor.getSelectionRotation(),s=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:i,currentPagePoint:a}}=this.editor,{initialCursorAngle:l,initialSelectionRotation:c}=this.snapshot;if(!s)return c;const f=s.center.clone().rotWith(s.point,r).angle(a)-l;let h=c+f;if(i)h=ag(h,24);else if(n&&(h=Math.round(h/AE)*AE,this.editor.getInstanceState().isCoarsePointer)){const d=ag(h,4),p=Ap(h,d);Math.abs(p)<M6(5)&&(h=d)}return h-c}}D(oO,"id","rotating");class sO extends bt{constructor(){super(...arguments);D(this,"hits",new Set);D(this,"size",0);D(this,"scribbleId","id");D(this,"initialSelectedShapeIds",new Set);D(this,"newlySelectedShapeIds",new Set);D(this,"onEnter",()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const n=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=n.id,this.updateScribbleSelection(!0),this.editor.updateInstanceState({brush:null})});D(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});D(this,"onPointerMove",()=>{this.updateScribbleSelection(!0)});D(this,"onPointerUp",()=>{this.complete()});D(this,"onKeyDown",()=>{this.updateScribbleSelection(!1)});D(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")});D(this,"onCancel",()=>{this.cancel()});D(this,"onComplete",()=>{this.complete()});D(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)})}updateScribbleSelection(n){const{editor:r}=this,s=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:i,originPagePoint:a,previousPagePoint:l,currentPagePoint:c}}=this.editor,{newlySelectedShapeIds:u,initialSelectedShapeIds:f}=this;n&&this.pushPointToScribble();const h=s;let d,p,m,g;const b=0;for(let x=0,S=h.length;x<S;x++){if(d=h[x],r.isShapeOfType(d,"group")||u.has(d.id)||r.isShapeOrAncestorLocked(d)||(p=r.getShapeGeometry(d),r.isShapeOfType(d,"frame")&&p.bounds.containsPoint(r.getPointInShapeSpace(d,a))))continue;const w=r.getShapePageTransform(d);if(!p||!w)continue;const E=w.clone().invert();m=E.applyToPoint(l),g=E.applyToPoint(c);const{bounds:j}=p;if(!(j.minX-b>Math.max(m.x,g.x)||j.minY-b>Math.max(m.y,g.y)||j.maxX+b<Math.min(m.x,g.x)||j.maxY+b<Math.min(m.y,g.y))&&p.hitTestLineSegment(m,g,b)){const P=this.editor.getOutermostSelectableShape(d),M=this.editor.getShapeMask(P.id);if(M&&gS(l,c,M)!==null&&!Zo(c,M))continue;u.add(P.id)}}const y=r.getSelectedShapeIds(),v=new Set(i?[...u,...f]:[...u]);(y.length!==v.size||y.some(x=>!v.has(x)))&&this.editor.setSelectedShapes(Array.from(v),{squashing:!0})}complete(){this.updateScribbleSelection(!0),this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle")}}D(sO,"id","scribble_brushing");const Oq=20,Aq=100;class Rq{constructor(o){D(this,"prevDroppingShapeId",null);D(this,"droppingNodeTimer",null);D(this,"first",!0);D(this,"dispose",()=>{this.clear()});this.editor=o,o.disposables.add(this.dispose)}updateDroppingNode(o,n){var r;this.first&&(this.editor.setHintingShapes(o.map(s=>this.editor.findShapeAncestor(s,i=>i.type!=="group")).filter(s=>s)),this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,o))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(o,Oq,n):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(o,Aq,n))}setDragTimer(o,n,r){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,o,r)}),this.droppingNodeTimer=null},n)}handleDrag(o,n,r){var c,u,f,h,d;n=Rt(n.map(p=>this.editor.getShape(p.id)));const s=((c=this.editor.getDroppingOverShape(o,n))==null?void 0:c.id)??null;if(s===this.prevDroppingShapeId){this.hintParents(n);return}const{prevDroppingShapeId:i}=this,a=i&&this.editor.getShape(i),l=s&&this.editor.getShape(s);a&&((f=(u=this.editor.getShapeUtil(a)).onDragShapesOut)==null||f.call(u,a,n)),l&&((d=(h=this.editor.getShapeUtil(l)).onDragShapesOver)==null||d.call(h,l,n)),this.hintParents(n),r==null||r(),this.prevDroppingShapeId=s}hintParents(o){const n=new Map;for(const s of o){const i=this.editor.findShapeAncestor(s,a=>a.type!=="group");i&&(n.has(i.id)||n.set(i.id,[]),n.get(i.id).push(s.id))}const r=[];for(const[s,i]of n){const a=this.editor.getShape(s);a&&a3(this.editor,a).length<i.length&&r.push(a.id)}this.editor.setHintingShapes(r)}dropShapes(o){var r,s;const{prevDroppingShapeId:n}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,o),n){const i=this.editor.getShape(n);if(!i)return;(s=(r=this.editor.getShapeUtil(i)).onDropShapesOver)==null||s.call(r,i,o)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}}class iO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"selectionSnapshot",{});D(this,"snapshot",{});D(this,"markId","");D(this,"isCloning",!1);D(this,"isCreating",!1);D(this,"onCreate",()=>{});D(this,"dragAndDropManager",new Rq(this.editor));D(this,"onEnter",n=>{const{isCreating:r=!1,onCreate:s=()=>{}}=n;if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.isCreating=r,this.onCreate=s,r?this.markId=`creating:${this.editor.getOnlySelectedShape().id}`:(this.markId="translating",this.editor.mark(this.markId)),this.isCloning=!1,this.info=n,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=RE(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0}),this.dragAndDropManager.clear()});D(this,"onTick",()=>{this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),CS(this.editor)});D(this,"onPointerMove",()=>{this.updateShapes()});D(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});D(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onComplete",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()});D(this,"updateParentTransforms",()=>{const{editor:n,snapshot:{shapeSnapshots:r}}=this;r.forEach(s=>{const i=n.getShape(s.shape.id);if(!i)return null;const a=_o(i.parentId)?null:vt.Inverse(n.getShapePageTransform(i.parentId));s.parentTransform=a})})}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=RE(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var n;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),xr(this.editor,this.snapshot.movingShapes.map(r=>r.id)),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(n=this.onCreate)==null||n.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(s=>{var l;const i=this.editor.getShapeUtil(s),a=(l=i.onTranslateStart)==null?void 0:l.call(i,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:n}=this.snapshot;if(this.isCloning&&n.length>0){const s=Y.Average(n.map(a=>this.editor.getShapePageTransform(a.id).point())),i=Y.Sub(s,this.selectionSnapshot.averagePagePoint);Y.IsNaN(i)||this.editor.updateInstanceState({duplicateProps:{shapeIds:n.map(a=>a.id),offset:{x:i.x,y:i.y}}})}const r=[];n.forEach(s=>{var c;const i=this.editor.getShape(s.id),a=this.editor.getShapeUtil(s),l=(c=a.onTranslateEnd)==null?void 0:c.call(a,s,i);l&&r.push(l)}),r.length>0&&this.editor.updateShapes(r)}handleChange(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(s=>{var c;const i=this.editor.getShape(s.id),a=this.editor.getShapeUtil(s),l=(c=a.onTranslate)==null?void 0:c.call(a,s,i);l&&r.push(l)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms),Dq({editor:this.editor,snapshot:n}),this.handleChange()}}D(iO,"id","translating");function RE(t){var h;const o=[],n=[],r=t.getSelectedShapeIds(),s=Rt(r.map(d=>{const p=t.getShape(d);if(!p)return null;o.push(p);const m=t.getShapePageTransform(d),g=m.point(),b=m.rotation();n.push(g);const y=Gi.isId(p.parentId)?null:vt.Inverse(t.getShapePageTransform(p.parentId));return{shape:p,pagePoint:g,pageRotation:b,parentTransform:y}})),i=t.getOnlySelectedShape();let a=[];if(i)a=t.snaps.shapeBounds.getSnapPoints(i.id);else{const d=t.getSelectionPageBounds();d&&(a=d.cornersAndCenter.map((p,m)=>({id:"selection:"+m,x:p.x,y:p.y})))}let l,c;const{originPagePoint:u}=t.inputs,f=s.filter(d=>t.isShapeOfType(d.shape,"note")&&t.isPointInShape(d.shape,u));if(f.length!==0)if(f.length===1)c=f[0];else{const d=t.getCurrentPageShapesSorted();c=(h=f.map(p=>({snapshot:p,index:d.findIndex(m=>m.id===p.shape.id)})).sort((p,m)=>m.index-p.index)[0])==null?void 0:h.snapshot}return c&&(l=d3(t,c.pageRotation,c.shape.props.growY??0)),{averagePagePoint:Y.Average(n),movingShapes:o,shapeSnapshots:s,initialPageBounds:t.getSelectionPageBounds(),initialSnapPoints:a,noteAdjacentPositions:l,noteSnapshot:c}}function Dq({editor:t,snapshot:o}){const{inputs:n}=t,{noteSnapshot:r,noteAdjacentPositions:s,initialPageBounds:i,initialSnapPoints:a,shapeSnapshots:l,averagePagePoint:c}=o,u=t.getInstanceState().isGridMode,f=t.getDocumentSettings().gridSize,h=Y.Sub(n.currentPagePoint,n.originPagePoint),d=t.inputs.shiftKey?Math.abs(h.x)<Math.abs(h.y)?"x":"y":null;if(d==="x"?h.x=0:d==="y"&&(h.y=0),t.snaps.clearIndicators(),(t.user.getIsSnapMode()?!n.ctrlKey:n.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){const{nudge:b}=t.snaps.shapeBounds.snapTranslateShapes({dragDelta:h,initialSelectionPageBounds:i,lockedAxis:d,initialSelectionSnapPoints:a});h.add(b)}else if(r&&s){let b=c3/t.getZoomLevel(),y=new Y(0,0);const v=Y.Add(Y.Add(r.pagePoint,h),new Y(er/2,er/2).rot(r.pageRotation));for(const x of s){const S=Y.Sub(v,x),w=S.len();w<b&&(b=w,y=S)}h.sub(y)}const m=Y.Add(c,h);u&&!n.ctrlKey&&m.snapToGrid(f);const g=Y.Sub(m,c);t.updateShapes(Rt(l.map(({shape:b,pagePoint:y,parentTransform:v})=>{const x=Y.Add(y,g),S=v?vt.applyToPoint(v,x):x;return{id:b.id,type:b.type,x:S.x,y:S.y}})),{squashing:!0})}class fm extends bt{constructor(){super(...arguments);D(this,"reactor");D(this,"cleanUpDuplicateProps",()=>{const n=this.editor.getSelectedShapeIds(),r=this.editor.getInstanceState();if(!r.duplicateProps)return;const s=new Set(r.duplicateProps.shapeIds);n.length===s.size&&n.every(i=>s.has(i))||this.editor.updateInstanceState({duplicateProps:null})});D(this,"onEnter",()=>{this.reactor=ku("clean duplicate props",()=>{try{this.cleanUpDuplicateProps()}catch(n){typeof process<"u",console.error(n)}})});D(this,"onExit",()=>{var n;(n=this.reactor)==null||n.call(this),this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)})}}D(fm,"id","select"),D(fm,"initial","idle"),D(fm,"children",()=>[hm,W3,Tq,Z3,rO,iO,B3,sO,Q3,tO,H3,q3,nO,oO,eO,K3,J3,Y3]);class aO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n});D(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}D(aO,"id","idle");class lO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n});D(this,"onPointerUp",()=>{this.complete()});D(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});D(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:n}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(n,{duration:220}):this.editor.zoomIn(n,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}D(lO,"id","pointing");class cO extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"zoomBrush",new mt);D(this,"onEnter",n=>{this.info=n,this.update()});D(this,"onExit",()=>{this.editor.updateInstanceState({zoomBrush:null})});D(this,"onPointerMove",()=>{this.update()});D(this,"onPointerUp",()=>{this.complete()});D(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(mt.FromPoints([n,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.editor.getZoomLevel();if(n.width<r&&n.height<r){const s=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(s,{duration:220}):this.editor.zoomIn(s,{duration:220})}else{const s=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(n,{targetZoom:s,duration:220})}this.parent.transition("idle",this.info)}}D(cO,"id","zoom_brushing");class pm extends bt{constructor(){super(...arguments);D(this,"info",{});D(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.updateCursor()});D(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});D(this,"onKeyDown",()=>{this.updateCursor()});D(this,"onKeyUp",n=>{this.updateCursor(),n.code==="KeyZ"&&this.complete()});D(this,"onInterrupt",()=>{this.complete()})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}}D(pm,"id","zoom"),D(pm,"initial","idle"),D(pm,"children",()=>[aO,cO,lO]);const Lq=[cm,um,dm,pm,fm];function ot(){return ot=Object.assign?Object.assign.bind():function(t){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ot.apply(this,arguments)}function xt(t,o,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return o==null?void 0:o(s)}}function Fq(t,o){typeof t=="function"?t(o):t!=null&&(t.current=o)}function by(...t){return o=>t.forEach(n=>Fq(n,o))}function jr(...t){return B.useCallback(by(...t),t)}function gi(t,o=[]){let n=[];function r(i,a){const l=B.createContext(a),c=n.length;n=[...n,a];function u(h){const{scope:d,children:p,...m}=h,g=(d==null?void 0:d[t][c])||l,b=B.useMemo(()=>m,Object.values(m));return B.createElement(g.Provider,{value:b},p)}function f(h,d){const p=(d==null?void 0:d[t][c])||l,m=B.useContext(p);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,f]}const s=()=>{const i=n.map(a=>B.createContext(a));return function(l){const c=(l==null?void 0:l[t])||i;return B.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Nq(s,...o)]}function Nq(...t){const o=t[0];if(t.length===1)return o;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return B.useMemo(()=>({[`__scope${o.scopeName}`]:a}),[a])}};return n.scopeName=o.scopeName,n}const zl=B.forwardRef((t,o)=>{const{children:n,...r}=t,s=B.Children.toArray(n),i=s.find(Uq);if(i){const a=i.props.children,l=s.map(c=>c===i?B.Children.count(a)>1?B.Children.only(null):B.isValidElement(a)?a.props.children:null:c);return B.createElement(M1,ot({},r,{ref:o}),B.isValidElement(a)?B.cloneElement(a,void 0,l):null)}return B.createElement(M1,ot({},r,{ref:o}),n)});zl.displayName="Slot";const M1=B.forwardRef((t,o)=>{const{children:n,...r}=t;return B.isValidElement(n)?B.cloneElement(n,{...Bq(r,n.props),ref:o?by(o,n.ref):n.ref}):B.Children.count(n)>1?B.Children.only(null):null});M1.displayName="SlotClone";const $q=({children:t})=>B.createElement(B.Fragment,null,t);function Uq(t){return B.isValidElement(t)&&t.type===$q}function Bq(t,o){const n={...o};for(const r in o){const s=t[r],i=o[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function xy(t){const o=t+"CollectionProvider",[n,r]=gi(o),[s,i]=n(o,{collectionRef:{current:null},itemMap:new Map}),a=p=>{const{scope:m,children:g}=p,b=Ut.useRef(null),y=Ut.useRef(new Map).current;return Ut.createElement(s,{scope:m,itemMap:y,collectionRef:b},g)},l=t+"CollectionSlot",c=Ut.forwardRef((p,m)=>{const{scope:g,children:b}=p,y=i(l,g),v=jr(m,y.collectionRef);return Ut.createElement(zl,{ref:v},b)}),u=t+"CollectionItemSlot",f="data-radix-collection-item",h=Ut.forwardRef((p,m)=>{const{scope:g,children:b,...y}=p,v=Ut.useRef(null),x=jr(m,v),S=i(u,g);return Ut.useEffect(()=>(S.itemMap.set(v,{ref:v,...y}),()=>void S.itemMap.delete(v))),Ut.createElement(zl,{[f]:"",ref:x},b)});function d(p){const m=i(t+"CollectionConsumer",p);return Ut.useCallback(()=>{const b=m.collectionRef.current;if(!b)return[];const y=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(m.itemMap.values()).sort((S,w)=>y.indexOf(S.ref.current)-y.indexOf(w.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:a,Slot:c,ItemSlot:h},d,r]}const zq=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],vr=zq.reduce((t,o)=>{const n=B.forwardRef((r,s)=>{const{asChild:i,...a}=r,l=i?zl:o;return B.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),B.createElement(l,ot({},a,{ref:s}))});return n.displayName=`Primitive.${o}`,{...t,[o]:n}},{});function nw(t,o){t&&Zl.flushSync(()=>t.dispatchEvent(o))}function Jn(t){const o=B.useRef(t);return B.useEffect(()=>{o.current=t}),B.useMemo(()=>(...n)=>{var r;return(r=o.current)===null||r===void 0?void 0:r.call(o,...n)},[])}function Gq(t,o=globalThis==null?void 0:globalThis.document){const n=Jn(t);B.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return o.addEventListener("keydown",r),()=>o.removeEventListener("keydown",r)},[n,o])}const O1="dismissableLayer.update",Vq="dismissableLayer.pointerDownOutside",Hq="dismissableLayer.focusOutside";let DE;const uO=B.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Sy=B.forwardRef((t,o)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:l,onDismiss:c,...u}=t,f=B.useContext(uO),[h,d]=B.useState(null),p=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,m]=B.useState({}),g=jr(o,P=>d(P)),b=Array.from(f.layers),[y]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),v=b.indexOf(y),x=h?b.indexOf(h):-1,S=f.layersWithOutsidePointerEventsDisabled.size>0,w=x>=v,E=Yq(P=>{const M=P.target,O=[...f.branches].some(k=>k.contains(M));!w||O||(i==null||i(P),l==null||l(P),P.defaultPrevented||c==null||c())},p),j=Xq(P=>{const M=P.target;[...f.branches].some(k=>k.contains(M))||(a==null||a(P),l==null||l(P),P.defaultPrevented||c==null||c())},p);return Gq(P=>{x===f.layers.size-1&&(s==null||s(P),!P.defaultPrevented&&c&&(P.preventDefault(),c()))},p),B.useEffect(()=>{if(h)return r&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(DE=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(h)),f.layers.add(h),LE(),()=>{r&&f.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=DE)}},[h,p,r,f]),B.useEffect(()=>()=>{h&&(f.layers.delete(h),f.layersWithOutsidePointerEventsDisabled.delete(h),LE())},[h,f]),B.useEffect(()=>{const P=()=>m({});return document.addEventListener(O1,P),()=>document.removeEventListener(O1,P)},[]),B.createElement(vr.div,ot({},u,{ref:g,style:{pointerEvents:S?w?"auto":"none":void 0,...t.style},onFocusCapture:xt(t.onFocusCapture,j.onFocusCapture),onBlurCapture:xt(t.onBlurCapture,j.onBlurCapture),onPointerDownCapture:xt(t.onPointerDownCapture,E.onPointerDownCapture)}))}),Wq=B.forwardRef((t,o)=>{const n=B.useContext(uO),r=B.useRef(null),s=jr(o,r);return B.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),B.createElement(vr.div,ot({},t,{ref:s}))});function Yq(t,o=globalThis==null?void 0:globalThis.document){const n=Jn(t),r=B.useRef(!1),s=B.useRef(()=>{});return B.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let f=function(){dO(Vq,n,u,{discrete:!0})};var c=f;const u={originalEvent:l};l.pointerType==="touch"?(o.removeEventListener("click",s.current),s.current=f,o.addEventListener("click",s.current,{once:!0})):f()}else o.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{o.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),o.removeEventListener("pointerdown",i),o.removeEventListener("click",s.current)}},[o,n]),{onPointerDownCapture:()=>r.current=!0}}function Xq(t,o=globalThis==null?void 0:globalThis.document){const n=Jn(t),r=B.useRef(!1);return B.useEffect(()=>{const s=i=>{i.target&&!r.current&&dO(Hq,n,{originalEvent:i},{discrete:!1})};return o.addEventListener("focusin",s),()=>o.removeEventListener("focusin",s)},[o,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function LE(){const t=new CustomEvent(O1);document.dispatchEvent(t)}function dO(t,o,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});o&&s.addEventListener(t,o,{once:!0}),r?nw(s,i):s.dispatchEvent(i)}const qq=Sy,Kq=Wq,wy=B.forwardRef((t,o)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?_L.createPortal(B.createElement(vr.div,ot({},s,{ref:o})),r):null}),Gl=globalThis!=null&&globalThis.document?B.useLayoutEffect:()=>{};function Zq(t,o){return B.useReducer((n,r)=>{const s=o[n][r];return s??n},t)}const yi=t=>{const{present:o,children:n}=t,r=Qq(o),s=typeof n=="function"?n({present:r.isPresent}):B.Children.only(n),i=jr(r.ref,s.ref);return typeof n=="function"||r.isPresent?B.cloneElement(s,{ref:i}):null};yi.displayName="Presence";function Qq(t){const[o,n]=B.useState(),r=B.useRef({}),s=B.useRef(t),i=B.useRef("none"),a=t?"mounted":"unmounted",[l,c]=Zq(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return B.useEffect(()=>{const u=np(r.current);i.current=l==="mounted"?u:"none"},[l]),Gl(()=>{const u=r.current,f=s.current;if(f!==t){const d=i.current,p=np(u);t?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&d!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Gl(()=>{if(o){const u=h=>{const p=np(r.current).includes(h.animationName);h.target===o&&p&&Zl.flushSync(()=>c("ANIMATION_END"))},f=h=>{h.target===o&&(i.current=np(r.current))};return o.addEventListener("animationstart",f),o.addEventListener("animationcancel",u),o.addEventListener("animationend",u),()=>{o.removeEventListener("animationstart",f),o.removeEventListener("animationcancel",u),o.removeEventListener("animationend",u)}}else c("ANIMATION_END")},[o,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:B.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function np(t){return(t==null?void 0:t.animationName)||"none"}function rl({prop:t,defaultProp:o,onChange:n=()=>{}}){const[r,s]=Jq({defaultProp:o,onChange:n}),i=t!==void 0,a=i?t:r,l=Jn(n),c=B.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[a,c]}function Jq({defaultProp:t,onChange:o}){const n=B.useState(t),[r]=n,s=B.useRef(r),i=Jn(o);return B.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}const hO=B.forwardRef((t,o)=>B.createElement(vr.span,ot({},t,{ref:o,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),fO="ToastProvider",[ow,eK,tK]=xy("Toast"),[pO,Ase]=gi("Toast",[tK]),[rK,_y]=pO(fO),mO=t=>{const{__scopeToast:o,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:a}=t,[l,c]=B.useState(null),[u,f]=B.useState(0),h=B.useRef(!1),d=B.useRef(!1);return B.createElement(ow.Provider,{scope:o},B.createElement(rK,{scope:o,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:B.useCallback(()=>f(p=>p+1),[]),onToastRemove:B.useCallback(()=>f(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:d},a))};mO.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const o=`Invalid prop \`label\` supplied to \`${fO}\`. Expected non-empty \`string\`.`;return new Error(o)}return null}};const nK="ToastViewport",oK=["F8"],A1="toast.viewportPause",R1="toast.viewportResume",sK=B.forwardRef((t,o)=>{const{__scopeToast:n,hotkey:r=oK,label:s="Notifications ({hotkey})",...i}=t,a=_y(nK,n),l=eK(n),c=B.useRef(null),u=B.useRef(null),f=B.useRef(null),h=B.useRef(null),d=jr(o,h,a.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=a.toastCount>0;B.useEffect(()=>{const b=y=>{var v;r.every(S=>y[S]||y.code===S)&&((v=h.current)===null||v===void 0||v.focus())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r]),B.useEffect(()=>{const b=c.current,y=h.current;if(m&&b&&y){const v=()=>{if(!a.isClosePausedRef.current){const E=new CustomEvent(A1);y.dispatchEvent(E),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const E=new CustomEvent(R1);y.dispatchEvent(E),a.isClosePausedRef.current=!1}},S=E=>{!b.contains(E.relatedTarget)&&x()},w=()=>{b.contains(document.activeElement)||x()};return b.addEventListener("focusin",v),b.addEventListener("focusout",S),b.addEventListener("pointermove",v),b.addEventListener("pointerleave",w),window.addEventListener("blur",v),window.addEventListener("focus",x),()=>{b.removeEventListener("focusin",v),b.removeEventListener("focusout",S),b.removeEventListener("pointermove",v),b.removeEventListener("pointerleave",w),window.removeEventListener("blur",v),window.removeEventListener("focus",x)}}},[m,a.isClosePausedRef]);const g=B.useCallback(({tabbingDirection:b})=>{const v=l().map(x=>{const S=x.ref.current,w=[S,...SK(S)];return b==="forwards"?w:w.reverse()});return(b==="forwards"?v.reverse():v).flat()},[l]);return B.useEffect(()=>{const b=h.current;if(b){const y=v=>{const x=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!x){const P=document.activeElement,M=v.shiftKey;if(v.target===b&&M){var w;(w=u.current)===null||w===void 0||w.focus();return}const F=g({tabbingDirection:M?"backwards":"forwards"}),A=F.findIndex(N=>N===P);if(mv(F.slice(A+1)))v.preventDefault();else{var E,j;M?(E=u.current)===null||E===void 0||E.focus():(j=f.current)===null||j===void 0||j.focus()}}};return b.addEventListener("keydown",y),()=>b.removeEventListener("keydown",y)}},[l,g]),B.createElement(Kq,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"}},m&&B.createElement(FE,{ref:u,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"forwards"});mv(b)}}),B.createElement(ow.Slot,{scope:n},B.createElement(vr.ol,ot({tabIndex:-1},i,{ref:d}))),m&&B.createElement(FE,{ref:f,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"backwards"});mv(b)}}))}),iK="ToastFocusProxy",FE=B.forwardRef((t,o)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=_y(iK,n);return B.createElement(hO,ot({"aria-hidden":!0,tabIndex:0},s,{ref:o,style:{position:"fixed"},onFocus:a=>{var l;const c=a.relatedTarget;!((l=i.viewport)!==null&&l!==void 0&&l.contains(c))&&r()}}))}),jy="Toast",aK="toast.swipeStart",lK="toast.swipeMove",cK="toast.swipeCancel",uK="toast.swipeEnd",dK=B.forwardRef((t,o)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...a}=t,[l=!0,c]=rl({prop:r,defaultProp:s,onChange:i});return B.createElement(yi,{present:n||l},B.createElement(gO,ot({open:l},a,{ref:o,onClose:()=>c(!1),onPause:Jn(t.onPause),onResume:Jn(t.onResume),onSwipeStart:xt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xt(t.onSwipeMove,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:xt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xt(t.onSwipeEnd,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})))}),[hK,fK]=pO(jy,{onClose(){}}),gO=B.forwardRef((t,o)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:a,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:f,onSwipeMove:h,onSwipeCancel:d,onSwipeEnd:p,...m}=t,g=_y(jy,n),[b,y]=B.useState(null),v=jr(o,N=>y(N)),x=B.useRef(null),S=B.useRef(null),w=s||g.duration,E=B.useRef(0),j=B.useRef(w),P=B.useRef(0),{onToastAdd:M,onToastRemove:O}=g,k=Jn(()=>{var N;(b==null?void 0:b.contains(document.activeElement))&&((N=g.viewport)===null||N===void 0||N.focus()),a()}),F=B.useCallback(N=>{!N||N===1/0||(window.clearTimeout(P.current),E.current=new Date().getTime(),P.current=window.setTimeout(k,N))},[k]);B.useEffect(()=>{const N=g.viewport;if(N){const $=()=>{F(j.current),u==null||u()},G=()=>{const X=new Date().getTime()-E.current;j.current=j.current-X,window.clearTimeout(P.current),c==null||c()};return N.addEventListener(A1,G),N.addEventListener(R1,$),()=>{N.removeEventListener(A1,G),N.removeEventListener(R1,$)}}},[g.viewport,w,c,u,F]),B.useEffect(()=>{i&&!g.isClosePausedRef.current&&F(w)},[i,w,g.isClosePausedRef,F]),B.useEffect(()=>(M(),()=>O()),[M,O]);const A=B.useMemo(()=>b?xO(b):null,[b]);return g.viewport?B.createElement(B.Fragment,null,A&&B.createElement(pK,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},A),B.createElement(hK,{scope:n,onClose:k},Zl.createPortal(B.createElement(ow.ItemSlot,{scope:n},B.createElement(qq,{asChild:!0,onEscapeKeyDown:xt(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||k(),g.isFocusedToastEscapeKeyDownRef.current=!1})},B.createElement(vr.li,ot({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection},m,{ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:xt(t.onKeyDown,N=>{N.key==="Escape"&&(l==null||l(N.nativeEvent),N.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,k()))}),onPointerDown:xt(t.onPointerDown,N=>{N.button===0&&(x.current={x:N.clientX,y:N.clientY})}),onPointerMove:xt(t.onPointerMove,N=>{if(!x.current)return;const $=N.clientX-x.current.x,G=N.clientY-x.current.y,X=!!S.current,W=["left","right"].includes(g.swipeDirection),V=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,q=W?V(0,$):0,J=W?0:V(0,G),ae=N.pointerType==="touch"?10:2,I={x:q,y:J},U={originalEvent:N,delta:I};X?(S.current=I,op(lK,h,U,{discrete:!1})):NE(I,g.swipeDirection,ae)?(S.current=I,op(aK,f,U,{discrete:!1}),N.target.setPointerCapture(N.pointerId)):(Math.abs($)>ae||Math.abs(G)>ae)&&(x.current=null)}),onPointerUp:xt(t.onPointerUp,N=>{const $=S.current,G=N.target;if(G.hasPointerCapture(N.pointerId)&&G.releasePointerCapture(N.pointerId),S.current=null,x.current=null,$){const X=N.currentTarget,W={originalEvent:N,delta:$};NE($,g.swipeDirection,g.swipeThreshold)?op(uK,p,W,{discrete:!0}):op(cK,d,W,{discrete:!0}),X.addEventListener("click",V=>V.preventDefault(),{once:!0})}})})))),g.viewport))):null});gO.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const o=`Invalid prop \`type\` supplied to \`${jy}\`. Expected \`foreground | background\`.`;return new Error(o)}return null}};const pK=t=>{const{__scopeToast:o,children:n,...r}=t,s=_y(jy,o),[i,a]=B.useState(!1),[l,c]=B.useState(!1);return bK(()=>a(!0)),B.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:B.createElement(wy,{asChild:!0},B.createElement(hO,r,i&&B.createElement(B.Fragment,null,s.label," ",n)))},mK=B.forwardRef((t,o)=>{const{__scopeToast:n,...r}=t;return B.createElement(vr.div,ot({},r,{ref:o}))}),gK=B.forwardRef((t,o)=>{const{__scopeToast:n,...r}=t;return B.createElement(vr.div,ot({},r,{ref:o}))}),yK="ToastAction",yO=B.forwardRef((t,o)=>{const{altText:n,...r}=t;return n?B.createElement(bO,{altText:n,asChild:!0},B.createElement(vO,ot({},r,{ref:o}))):null});yO.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${yK}\``)}};const vK="ToastClose",vO=B.forwardRef((t,o)=>{const{__scopeToast:n,...r}=t,s=fK(vK,n);return B.createElement(bO,{asChild:!0},B.createElement(vr.button,ot({type:"button"},r,{ref:o,onClick:xt(t.onClick,s.onClose)})))}),bO=B.forwardRef((t,o)=>{const{__scopeToast:n,altText:r,...s}=t;return B.createElement(vr.div,ot({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},s,{ref:o}))});function xO(t){const o=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&o.push(r.textContent),xK(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&o.push(a)}else o.push(...xO(r))}}),o}function op(t,o,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});o&&s.addEventListener(t,o,{once:!0}),r?nw(s,i):s.dispatchEvent(i)}const NE=(t,o,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return o==="left"||o==="right"?i&&r>n:!i&&s>n};function bK(t=()=>{}){const o=Jn(t);Gl(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(o)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[o])}function xK(t){return t.nodeType===t.ELEMENT_NODE}function SK(t){const o=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)o.push(n.currentNode);return o}function mv(t){const o=document.activeElement;return t.some(n=>n===o?!0:(n.focus(),document.activeElement!==o))}const wK=dK,_K=mK,jK=gK,EK=yO,$E=vO,CK=hR["useId".toString()]||(()=>{});let PK=0;function Ni(t){const[o,n]=B.useState(CK());return Gl(()=>{t||n(r=>r??String(PK++))},[t]),t||(o?`radix-${o}`:"")}const gv="focusScope.autoFocusOnMount",yv="focusScope.autoFocusOnUnmount",UE={bubbles:!1,cancelable:!0},sw=B.forwardRef((t,o)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=t,[l,c]=B.useState(null),u=Jn(s),f=Jn(i),h=B.useRef(null),d=jr(o,g=>c(g)),p=B.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;B.useEffect(()=>{if(r){let v=function(E){if(p.paused||!l)return;const j=E.target;l.contains(j)?h.current=j:va(h.current,{select:!0})},x=function(E){if(p.paused||!l)return;const j=E.relatedTarget;j!==null&&(l.contains(j)||va(h.current,{select:!0}))},S=function(E){if(document.activeElement===document.body)for(const P of E)P.removedNodes.length>0&&va(l)};var g=v,b=x,y=S;document.addEventListener("focusin",v),document.addEventListener("focusout",x);const w=new MutationObserver(S);return l&&w.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",x),w.disconnect()}}},[r,l,p.paused]),B.useEffect(()=>{if(l){zE.add(p);const g=document.activeElement;if(!l.contains(g)){const y=new CustomEvent(gv,UE);l.addEventListener(gv,u),l.dispatchEvent(y),y.defaultPrevented||(TK(AK(SO(l)),{select:!0}),document.activeElement===g&&va(l))}return()=>{l.removeEventListener(gv,u),setTimeout(()=>{const y=new CustomEvent(yv,UE);l.addEventListener(yv,f),l.dispatchEvent(y),y.defaultPrevented||va(g??document.body,{select:!0}),l.removeEventListener(yv,f),zE.remove(p)},0)}}},[l,u,f,p]);const m=B.useCallback(g=>{if(!n&&!r||p.paused)return;const b=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(b&&y){const v=g.currentTarget,[x,S]=kK(v);x&&S?!g.shiftKey&&y===S?(g.preventDefault(),n&&va(x,{select:!0})):g.shiftKey&&y===x&&(g.preventDefault(),n&&va(S,{select:!0})):y===v&&g.preventDefault()}},[n,r,p.paused]);return B.createElement(vr.div,ot({tabIndex:-1},a,{ref:d,onKeyDown:m}))});function TK(t,{select:o=!1}={}){const n=document.activeElement;for(const r of t)if(va(r,{select:o}),document.activeElement!==n)return}function kK(t){const o=SO(t),n=BE(o,t),r=BE(o.reverse(),t);return[n,r]}function SO(t){const o=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)o.push(n.currentNode);return o}function BE(t,o){for(const n of t)if(!IK(n,{upTo:o}))return n}function IK(t,{upTo:o}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(o!==void 0&&t===o)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function MK(t){return t instanceof HTMLInputElement&&"select"in t}function va(t,{select:o=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&MK(t)&&o&&t.select()}}const zE=OK();function OK(){let t=[];return{add(o){const n=t[0];o!==n&&(n==null||n.pause()),t=GE(t,o),t.unshift(o)},remove(o){var n;t=GE(t,o),(n=t[0])===null||n===void 0||n.resume()}}}function GE(t,o){const n=[...t],r=n.indexOf(o);return r!==-1&&n.splice(r,1),n}function AK(t){return t.filter(o=>o.tagName!=="A")}let vv=0;function iw(){B.useEffect(()=>{var t,o;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:VE()),document.body.insertAdjacentElement("beforeend",(o=n[1])!==null&&o!==void 0?o:VE()),vv++,()=>{vv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),vv--}},[])}function VE(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var ri=function(){return ri=Object.assign||function(o){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},ri.apply(this,arguments)};function wO(t,o){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&o.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)o.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function RK(t,o,n){if(n||arguments.length===2)for(var r=0,s=o.length,i;r<s;r++)(i||!(r in o))&&(i||(i=Array.prototype.slice.call(o,0,r)),i[r]=o[r]);return t.concat(i||Array.prototype.slice.call(o))}var mm="right-scroll-bar-position",gm="width-before-scroll-bar",DK="with-scroll-bars-hidden",LK="--removed-body-scroll-bar-size";function bv(t,o){return typeof t=="function"?t(o):t&&(t.current=o),t}function FK(t,o){var n=B.useState(function(){return{value:t,callback:o,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=o,n.facade}var NK=typeof window<"u"?B.useLayoutEffect:B.useEffect,HE=new WeakMap;function $K(t,o){var n=FK(o||null,function(r){return t.forEach(function(s){return bv(s,r)})});return NK(function(){var r=HE.get(n);if(r){var s=new Set(r),i=new Set(t),a=n.current;s.forEach(function(l){i.has(l)||bv(l,null)}),i.forEach(function(l){s.has(l)||bv(l,a)})}HE.set(n,t)},[t]),n}function UK(t){return t}function BK(t,o){o===void 0&&(o=UK);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=o(i,r);return n.push(a),function(){n=n.filter(function(l){return l!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var l=n;n=[],l.forEach(i),a=n}var c=function(){var f=a;a=[],f.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(f){a.push(f),u()},filter:function(f){return a=a.filter(f),n}}}};return s}function zK(t){t===void 0&&(t={});var o=BK(null);return o.options=ri({async:!0,ssr:!1},t),o}var _O=function(t){var o=t.sideCar,n=wO(t,["sideCar"]);if(!o)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=o.read();if(!r)throw new Error("Sidecar medium not found");return B.createElement(r,ri({},n))};_O.isSideCarExport=!0;function GK(t,o){return t.useMedium(o),_O}var jO=zK(),xv=function(){},Ey=B.forwardRef(function(t,o){var n=B.useRef(null),r=B.useState({onScrollCapture:xv,onWheelCapture:xv,onTouchMoveCapture:xv}),s=r[0],i=r[1],a=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,f=t.enabled,h=t.shards,d=t.sideCar,p=t.noIsolation,m=t.inert,g=t.allowPinchZoom,b=t.as,y=b===void 0?"div":b,v=wO(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),x=d,S=$K([n,o]),w=ri(ri({},v),s);return B.createElement(B.Fragment,null,f&&B.createElement(x,{sideCar:jO,removeScrollBar:u,shards:h,noIsolation:p,inert:m,setCallbacks:i,allowPinchZoom:!!g,lockRef:n}),a?B.cloneElement(B.Children.only(l),ri(ri({},w),{ref:S})):B.createElement(y,ri({},w,{className:c,ref:S}),l))});Ey.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ey.classNames={fullWidth:gm,zeroRight:mm};var WE,VK=function(){if(WE)return WE;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function HK(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var o=VK();return o&&t.setAttribute("nonce",o),t}function WK(t,o){t.styleSheet?t.styleSheet.cssText=o:t.appendChild(document.createTextNode(o))}function YK(t){var o=document.head||document.getElementsByTagName("head")[0];o.appendChild(t)}var XK=function(){var t=0,o=null;return{add:function(n){t==0&&(o=HK())&&(WK(o,n),YK(o)),t++},remove:function(){t--,!t&&o&&(o.parentNode&&o.parentNode.removeChild(o),o=null)}}},qK=function(){var t=XK();return function(o,n){B.useEffect(function(){return t.add(o),function(){t.remove()}},[o&&n])}},EO=function(){var t=qK(),o=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return o},KK={left:0,top:0,right:0,gap:0},Sv=function(t){return parseInt(t||"",10)||0},ZK=function(t){var o=window.getComputedStyle(document.body),n=o[t==="padding"?"paddingLeft":"marginLeft"],r=o[t==="padding"?"paddingTop":"marginTop"],s=o[t==="padding"?"paddingRight":"marginRight"];return[Sv(n),Sv(r),Sv(s)]},QK=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return KK;var o=ZK(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:o[0],top:o[1],right:o[2],gap:Math.max(0,r-n+o[2]-o[0])}},JK=EO(),au="data-scroll-locked",eZ=function(t,o,n,r){var s=t.left,i=t.top,a=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(DK,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(au,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([o&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(mm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(gm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(mm," .").concat(mm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(gm," .").concat(gm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(au,`] {
    `).concat(LK,": ").concat(l,`px;
  }
`)},YE=function(){var t=parseInt(document.body.getAttribute(au)||"0",10);return isFinite(t)?t:0},tZ=function(){B.useEffect(function(){return document.body.setAttribute(au,(YE()+1).toString()),function(){var t=YE()-1;t<=0?document.body.removeAttribute(au):document.body.setAttribute(au,t.toString())}},[])},rZ=function(t){var o=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;tZ();var i=B.useMemo(function(){return QK(s)},[s]);return B.createElement(JK,{styles:eZ(i,!o,s,n?"":"!important")})},D1=!1;if(typeof window<"u")try{var sp=Object.defineProperty({},"passive",{get:function(){return D1=!0,!0}});window.addEventListener("test",sp,sp),window.removeEventListener("test",sp,sp)}catch{D1=!1}var Sc=D1?{passive:!1}:!1,nZ=function(t){return t.tagName==="TEXTAREA"},CO=function(t,o){var n=window.getComputedStyle(t);return n[o]!=="hidden"&&!(n.overflowY===n.overflowX&&!nZ(t)&&n[o]==="visible")},oZ=function(t){return CO(t,"overflowY")},sZ=function(t){return CO(t,"overflowX")},XE=function(t,o){var n=o;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=PO(t,n);if(r){var s=TO(t,n),i=s[1],a=s[2];if(i>a)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},iZ=function(t){var o=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[o,n,r]},aZ=function(t){var o=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[o,n,r]},PO=function(t,o){return t==="v"?oZ(o):sZ(o)},TO=function(t,o){return t==="v"?iZ(o):aZ(o)},lZ=function(t,o){return t==="h"&&o==="rtl"?-1:1},cZ=function(t,o,n,r,s){var i=lZ(t,window.getComputedStyle(o).direction),a=i*r,l=n.target,c=o.contains(l),u=!1,f=a>0,h=0,d=0;do{var p=TO(t,l),m=p[0],g=p[1],b=p[2],y=g-b-i*m;(m||y)&&PO(t,l)&&(h+=y,d+=m),l=l.parentNode}while(!c&&l!==document.body||c&&(o.contains(l)||o===l));return(f&&(s&&h===0||!s&&a>h)||!f&&(s&&d===0||!s&&-a>d))&&(u=!0),u},ip=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},qE=function(t){return[t.deltaX,t.deltaY]},KE=function(t){return t&&"current"in t?t.current:t},uZ=function(t,o){return t[0]===o[0]&&t[1]===o[1]},dZ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},hZ=0,wc=[];function fZ(t){var o=B.useRef([]),n=B.useRef([0,0]),r=B.useRef(),s=B.useState(hZ++)[0],i=B.useState(function(){return EO()})[0],a=B.useRef(t);B.useEffect(function(){a.current=t},[t]),B.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var g=RK([t.lockRef.current],(t.shards||[]).map(KE),!0).filter(Boolean);return g.forEach(function(b){return b.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=B.useCallback(function(g,b){if("touches"in g&&g.touches.length===2)return!a.current.allowPinchZoom;var y=ip(g),v=n.current,x="deltaX"in g?g.deltaX:v[0]-y[0],S="deltaY"in g?g.deltaY:v[1]-y[1],w,E=g.target,j=Math.abs(x)>Math.abs(S)?"h":"v";if("touches"in g&&j==="h"&&E.type==="range")return!1;var P=XE(j,E);if(!P)return!0;if(P?w=j:(w=j==="v"?"h":"v",P=XE(j,E)),!P)return!1;if(!r.current&&"changedTouches"in g&&(x||S)&&(r.current=w),!w)return!0;var M=r.current||w;return cZ(M,b,g,M==="h"?x:S,!0)},[]),c=B.useCallback(function(g){var b=g;if(!(!wc.length||wc[wc.length-1]!==i)){var y="deltaY"in b?qE(b):ip(b),v=o.current.filter(function(w){return w.name===b.type&&w.target===b.target&&uZ(w.delta,y)})[0];if(v&&v.should){b.cancelable&&b.preventDefault();return}if(!v){var x=(a.current.shards||[]).map(KE).filter(Boolean).filter(function(w){return w.contains(b.target)}),S=x.length>0?l(b,x[0]):!a.current.noIsolation;S&&b.cancelable&&b.preventDefault()}}},[]),u=B.useCallback(function(g,b,y,v){var x={name:g,delta:b,target:y,should:v};o.current.push(x),setTimeout(function(){o.current=o.current.filter(function(S){return S!==x})},1)},[]),f=B.useCallback(function(g){n.current=ip(g),r.current=void 0},[]),h=B.useCallback(function(g){u(g.type,qE(g),g.target,l(g,t.lockRef.current))},[]),d=B.useCallback(function(g){u(g.type,ip(g),g.target,l(g,t.lockRef.current))},[]);B.useEffect(function(){return wc.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",c,Sc),document.addEventListener("touchmove",c,Sc),document.addEventListener("touchstart",f,Sc),function(){wc=wc.filter(function(g){return g!==i}),document.removeEventListener("wheel",c,Sc),document.removeEventListener("touchmove",c,Sc),document.removeEventListener("touchstart",f,Sc)}},[]);var p=t.removeScrollBar,m=t.inert;return B.createElement(B.Fragment,null,m?B.createElement(i,{styles:dZ(s)}):null,p?B.createElement(rZ,{gapMode:"margin"}):null)}const pZ=GK(jO,fZ);var kO=B.forwardRef(function(t,o){return B.createElement(Ey,ri({},t,{ref:o,sideCar:pZ}))});kO.classNames=Ey.classNames;const aw=kO;var mZ=function(t){if(typeof document>"u")return null;var o=Array.isArray(t)?t[0]:t;return o.ownerDocument.body},_c=new WeakMap,ap=new WeakMap,lp={},wv=0,IO=function(t){return t&&(t.host||IO(t.parentNode))},gZ=function(t,o){return o.map(function(n){if(t.contains(n))return n;var r=IO(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},yZ=function(t,o,n,r){var s=gZ(o,Array.isArray(t)?t:[t]);lp[n]||(lp[n]=new WeakMap);var i=lp[n],a=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var f=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(d){if(l.has(d))f(d);else try{var p=d.getAttribute(r),m=p!==null&&p!=="false",g=(_c.get(d)||0)+1,b=(i.get(d)||0)+1;_c.set(d,g),i.set(d,b),a.push(d),g===1&&m&&ap.set(d,!0),b===1&&d.setAttribute(n,"true"),m||d.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",d,y)}})};return f(o),l.clear(),wv++,function(){a.forEach(function(h){var d=_c.get(h)-1,p=i.get(h)-1;_c.set(h,d),i.set(h,p),d||(ap.has(h)||h.removeAttribute(r),ap.delete(h)),p||h.removeAttribute(n)}),wv--,wv||(_c=new WeakMap,_c=new WeakMap,ap=new WeakMap,lp={})}},lw=function(t,o,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=o||mZ(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),yZ(r,s,n,"aria-hidden")):function(){return null}};const MO="Dialog",[OO,Rse]=gi(MO),[vZ,oa]=OO(MO),bZ=t=>{const{__scopeDialog:o,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=t,l=B.useRef(null),c=B.useRef(null),[u=!1,f]=rl({prop:r,defaultProp:s,onChange:i});return B.createElement(vZ,{scope:o,triggerRef:l,contentRef:c,contentId:Ni(),titleId:Ni(),descriptionId:Ni(),open:u,onOpenChange:f,onOpenToggle:B.useCallback(()=>f(h=>!h),[f]),modal:a},n)},AO="DialogPortal",[xZ,RO]=OO(AO,{forceMount:void 0}),SZ=t=>{const{__scopeDialog:o,forceMount:n,children:r,container:s}=t,i=oa(AO,o);return B.createElement(xZ,{scope:o,forceMount:n},B.Children.map(r,a=>B.createElement(yi,{present:n||i.open},B.createElement(wy,{asChild:!0,container:s},a))))},L1="DialogOverlay",wZ=B.forwardRef((t,o)=>{const n=RO(L1,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=oa(L1,t.__scopeDialog);return i.modal?B.createElement(yi,{present:r||i.open},B.createElement(_Z,ot({},s,{ref:o}))):null}),_Z=B.forwardRef((t,o)=>{const{__scopeDialog:n,...r}=t,s=oa(L1,n);return B.createElement(aw,{as:zl,allowPinchZoom:!0,shards:[s.contentRef]},B.createElement(vr.div,ot({"data-state":LO(s.open)},r,{ref:o,style:{pointerEvents:"auto",...r.style}})))}),_h="DialogContent",jZ=B.forwardRef((t,o)=>{const n=RO(_h,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=oa(_h,t.__scopeDialog);return B.createElement(yi,{present:r||i.open},i.modal?B.createElement(EZ,ot({},s,{ref:o})):B.createElement(CZ,ot({},s,{ref:o})))}),EZ=B.forwardRef((t,o)=>{const n=oa(_h,t.__scopeDialog),r=B.useRef(null),s=jr(o,n.contentRef,r);return B.useEffect(()=>{const i=r.current;if(i)return lw(i)},[]),B.createElement(DO,ot({},t,{ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xt(t.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:xt(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&i.preventDefault()}),onFocusOutside:xt(t.onFocusOutside,i=>i.preventDefault())}))}),CZ=B.forwardRef((t,o)=>{const n=oa(_h,t.__scopeDialog),r=B.useRef(!1),s=B.useRef(!1);return B.createElement(DO,ot({},t,{ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a;if((a=t.onCloseAutoFocus)===null||a===void 0||a.call(t,i),!i.defaultPrevented){var l;r.current||(l=n.triggerRef.current)===null||l===void 0||l.focus(),i.preventDefault()}r.current=!1,s.current=!1},onInteractOutside:i=>{var a,l;(a=t.onInteractOutside)===null||a===void 0||a.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((l=n.triggerRef.current)===null||l===void 0?void 0:l.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}}))}),DO=B.forwardRef((t,o)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=t,l=oa(_h,n),c=B.useRef(null),u=jr(o,c);return iw(),B.createElement(B.Fragment,null,B.createElement(sw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i},B.createElement(Sy,ot({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":LO(l.open)},a,{ref:u,onDismiss:()=>l.onOpenChange(!1)}))),!1)}),PZ="DialogTitle",TZ=B.forwardRef((t,o)=>{const{__scopeDialog:n,...r}=t,s=oa(PZ,n);return B.createElement(vr.h2,ot({id:s.titleId},r,{ref:o}))}),kZ="DialogClose",IZ=B.forwardRef((t,o)=>{const{__scopeDialog:n,...r}=t,s=oa(kZ,n);return B.createElement(vr.button,ot({type:"button"},r,{ref:o,onClick:xt(t.onClick,()=>s.onOpenChange(!1))}))});function LO(t){return t?"open":"closed"}const MZ=bZ,OZ=SZ,AZ=wZ,RZ=jZ,FO=()=>{},NO=B.createContext({});function DZ({onEvent:t,children:o}){return C.jsx(NO.Provider,{value:t??FO,children:o})}function vi(){return B.useContext(NO)??FO}const $O=B.createContext({});function LZ({children:t}){const o=Ue(),n=vi(),[r,s]=B.useState([]),i=B.useCallback(u=>{const f=u.id??Mr();return s(h=>[...h.filter(d=>d.id!==u.id),{...u,id:f}]),n("open-menu",{source:"dialog",id:f}),o.addOpenMenu(f),f},[o,n]),a=B.useCallback((u,f)=>(s(h=>h.map(d=>d.id===u?{...d,...f}:d)),n("open-menu",{source:"dialog",id:u}),o.addOpenMenu(u),u),[o,n]),l=B.useCallback(u=>(s(f=>f.filter(h=>{var d;return h.id===u?((d=h.onClose)==null||d.call(h),!1):!0})),n("close-menu",{source:"dialog",id:u}),o.deleteOpenMenu(u),u),[o,n]),c=B.useCallback(()=>{s(u=>(u.forEach(f=>{var h;(h=f.onClose)==null||h.call(f),n("close-menu",{source:"dialog",id:f.id}),o.deleteOpenMenu(f.id)}),[]))},[o,n]);return C.jsx($O.Provider,{value:{dialogs:r,addDialog:i,removeDialog:l,clearDialogs:c,updateDialog:a},children:t})}function nc(){const t=B.useContext($O);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}const FZ=({id:t,component:o,onClose:n})=>{const{removeDialog:r}=nc(),s=to(),i=B.useCallback(a=>{if(!a){if(n)try{n()}catch(l){console.warn(l)}r(t)}},[t,n,r]);return C.jsx(MZ,{onOpenChange:i,defaultOpen:!0,children:C.jsx(OZ,{container:s,children:C.jsx(AZ,{dir:"ltr",className:"tlui-dialog__overlay",onClick:a=>{a.target===a.currentTarget&&i(!1)},children:C.jsx(RZ,{dir:"ltr",className:"tlui-dialog__content",children:C.jsx(o,{onClose:()=>i(!1)})})})})})};function NZ(){const{dialogs:t}=nc();return C.jsx(C.Fragment,{children:t.map(o=>C.jsx(FZ,{...o},o.id))})}const $Z=Ut.memo(NZ);function UZ(){const t=Ue(),o=He("follow",()=>t.getInstanceState().followingUserId,[t]);return o?C.jsx(BZ,{userId:o}):null}function BZ({userId:t}){const o=mI(t);return o?C.jsx("div",{className:"tlui-following-indicator",style:{borderColor:o.color}}):null}const UO=B.createContext({});function zZ({children:t}){const[o,n]=B.useState([]),r=B.useCallback(a=>{const l=a.id??Mr();return n(c=>[...c.filter(u=>u.id!==a.id),{...a,id:l}]),l},[]),s=B.useCallback(a=>(n(l=>l.filter(c=>c.id!==a)),a),[]),i=B.useCallback(()=>{n(()=>[])},[]);return C.jsx(UO.Provider,{value:{toasts:o,addToast:r,removeToast:s,clearToasts:i},children:t})}function Ws(){const t=B.useContext(UO);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}const Mt=B.forwardRef(function({children:o,disabled:n,type:r,...s},i){const a=Ue(),l=i==null?void 0:i.current;return n&&l===document.activeElement&&a.getContainer().focus(),C.jsx("button",{ref:i,type:"button",draggable:!1,disabled:n,...s,className:Tt("tlui-button",`tlui-button__${r}`,s.className),children:o})});function tn({children:t}){return C.jsx("span",{className:"tlui-button__label",children:t})}const Ha=B.memo(function({small:o,invertIcon:n,icon:r,color:s,className:i,...a}){const l=tw(),c=l.icons[r]??l.icons["question-mark-circle"],u=B.useRef(null);return B.useLayoutEffect(()=>{c||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),u!=null&&u.current&&(u.current.style.webkitMask=`url(${c}) center 100% / 100% no-repeat`)},[u,c,r]),C.jsx("div",{...a,ref:u,className:Tt("tlui-icon",{"tlui-icon__small":o},i),style:{color:s,mask:`url(${c}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),GZ={success:"check-circle",warning:"warning-triangle",error:"cross-circle",info:"info-circle"};function VZ({toast:t}){const{removeToast:o}=Ws(),n=tr(),r=a=>{a||o(t.id)},s=t.actions&&t.actions.length>0,i=t.icon||t.severity&&GZ[t.severity];return C.jsxs(wK,{onOpenChange:r,className:"tlui-toast__container",duration:t.keepOpen?1/0:5e3,"data-severity":t.severity,children:[i&&C.jsx("div",{className:"tlui-toast__icon",children:C.jsx(Ha,{icon:i})}),C.jsxs("div",{className:"tlui-toast__main",children:[C.jsxs("div",{className:"tlui-toast__content",children:[t.title&&C.jsx(_K,{className:"tlui-toast__title",children:t.title}),t.description&&C.jsx(jK,{className:"tlui-toast__description",children:t.description})]}),t.actions&&C.jsxs("div",{className:"tlui-toast__actions",children:[t.actions.map((a,l)=>C.jsx(EK,{altText:a.label,asChild:!0,onClick:a.onClick,children:C.jsx(Mt,{type:a.type,children:C.jsx(tn,{children:a.label})})},l)),C.jsx($E,{asChild:!0,children:C.jsx(Mt,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:C.jsx(tn,{children:t.closeLabel??n("toast.close")})})})]})]}),!s&&C.jsx($E,{asChild:!0,children:C.jsx(Mt,{type:"normal",className:"tlui-toast__close",children:C.jsx(tn,{children:t.closeLabel??n("toast.close")})})})]})}function HZ(){const{toasts:t}=Ws();return C.jsx(C.Fragment,{children:t.map(o=>C.jsx(VZ,{toast:o},o.id))})}const WZ=B.memo(HZ);function YZ(){const{toasts:t}=Ws(),[o,n]=B.useState(!1);return B.useEffect(()=>{let r=!1;return t.length?n(!0):setTimeout(()=>{r||n(!1)},1e3),()=>{r=!0}},[t.length,n]),o?C.jsx(sK,{className:"tlui-toast__viewport"}):null}function Zt({icon:t,small:o,invertIcon:n}){return C.jsx(Ha,{className:"tlui-button__icon",icon:t,small:o,invertIcon:n})}const _v=[0,390,428,468,580,640,840,1023];var Kr=(t=>(t[t.ZERO=0]="ZERO",t[t.MOBILE_XXS=1]="MOBILE_XXS",t[t.MOBILE_XS=2]="MOBILE_XS",t[t.MOBILE_SM=3]="MOBILE_SM",t[t.MOBILE=4]="MOBILE",t[t.TABLET_SM=5]="TABLET_SM",t[t.TABLET=6]="TABLET",t[t.DESKTOP=7]="DESKTOP",t))(Kr||{});const Tl="2.1.4";let F1={fonts:{draw:`https://unpkg.com/@tldraw/assets@${Tl}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`https://unpkg.com/@tldraw/assets@${Tl}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${Tl}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${Tl}/fonts/IBMPlexMono-Medium.woff2`}};function BO(t){return B.useMemo(()=>t?{fonts:{...F1.fonts,...t==null?void 0:t.fonts}}:F1,[t])}const XZ=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check-circle","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross-circle","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","error","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"];let pd={...F1,icons:Object.fromEntries(XZ.map(t=>[t,`https://unpkg.com/@tldraw/assets@${Tl}/icons/icon/${t}.svg`])),translations:Object.fromEntries(ph.map(t=>[t.locale,`https://unpkg.com/@tldraw/assets@${Tl}/translations/${t.locale}.json`])),embedIcons:Object.fromEntries($h.map(t=>[t.type,`https://unpkg.com/@tldraw/assets@${Tl}/embed-icons/${t.type}.png`]))};function qZ(t){return t?{fonts:Object.assign({...pd.fonts},{...t==null?void 0:t.fonts}),icons:Object.assign({...pd.icons},{...t==null?void 0:t.icons}),embedIcons:Object.assign({...pd.embedIcons},{...t==null?void 0:t.embedIcons}),translations:Object.assign({...pd.translations},{...t==null?void 0:t.translations})}:pd}function Cy({className:t,children:o}){return C.jsx("div",{className:Tt("tlui-dialog__header",t),children:o})}function Py({className:t,children:o}){return C.jsx(TZ,{dir:"ltr",className:Tt("tlui-dialog__header__title",t),children:o})}function Ty(){return C.jsx("div",{className:"tlui-dialog__header__close",children:C.jsx(IZ,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:C.jsx(Mt,{type:"icon","aria-label":"Close",onTouchEnd:t=>t.target.click(),children:C.jsx(Zt,{small:!0,icon:"cross-2"})})})})}function jh({className:t,children:o,style:n}){return C.jsx("div",{className:Tt("tlui-dialog__body",t),style:n,children:o})}function cw({className:t,children:o}){return C.jsx("div",{className:Tt("tlui-dialog__footer",t),children:o})}const uw=B.forwardRef(function({className:o,label:n,icon:r,iconLeft:s,autoselect:i=!1,autofocus:a=!1,defaultValue:l,placeholder:c,onComplete:u,onValueChange:f,onCancel:h,onBlur:d,shouldManuallyMaintainScrollPositionWhenFocused:p=!1,children:m,value:g},b){const y=Ue(),v=B.useRef(null);B.useImperativeHandle(b,()=>v.current);const x=tr(),S=B.useRef(l??""),w=B.useRef(l??""),[E,j]=B.useState(!1),P=B.useCallback(F=>{j(!0);const A=F.currentTarget;w.current=A.value,requestAnimationFrame(()=>{i&&A.select()})},[i]),M=B.useCallback(F=>{const A=F.currentTarget.value;w.current=A,f==null||f(A)},[f]),O=B.useCallback(F=>{switch(F.key){case"Enter":{F.currentTarget.blur(),Rn(F),u==null||u(F.currentTarget.value);break}case"Escape":{F.currentTarget.value=S.current,F.currentTarget.blur(),Rn(F),h==null||h(F.currentTarget.value);break}}},[u,h]),k=B.useCallback(F=>{j(!1);const A=F.currentTarget.value;d==null||d(A)},[d]);return B.useEffect(()=>{if(!y.environment.isIos)return;const F=window.visualViewport;if(E&&p&&F){const A=()=>{var N;(N=v.current)==null||N.scrollIntoView({block:"center"})};return F.addEventListener("resize",A),F.addEventListener("scroll",A),requestAnimationFrame(()=>{var N;(N=v.current)==null||N.scrollIntoView({block:"center"})}),()=>{F.removeEventListener("resize",A),F.removeEventListener("scroll",A)}}},[y,E,p]),C.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[m,n&&C.jsx("label",{children:x(n)}),s&&C.jsx(Ha,{icon:s,className:"tlui-icon-left",small:!0}),C.jsx("input",{ref:v,className:Tt("tlui-input",o),type:"text",defaultValue:l,onKeyUp:O,onChange:M,onFocus:P,onBlur:k,autoFocus:a,placeholder:c,value:g}),r&&C.jsx(Ha,{icon:r,small:!!n})]})}),zO=os(function({onClose:o}){const n=Ue(),r=tr(),s=tw(),[i,a]=B.useState(null),[l,c]=B.useState(""),[u,f]=B.useState(null),[h,d]=B.useState(!1),p=B.useRef(-1);return C.jsxs(C.Fragment,{children:[C.jsxs(Cy,{children:[C.jsx(Py,{children:i?`${r("embed-dialog.title")} — ${i.title}`:r("embed-dialog.title")}),C.jsx(Ty,{})]}),i?C.jsxs(C.Fragment,{children:[C.jsxs(jh,{className:"tlui-embed-dialog__enter",children:[C.jsx(uw,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:m=>{c(m);const g=Ta(m);f(g&&g.definition.type===i.type?g:null),d(!1),clearTimeout(p.current),p.current=setTimeout(()=>d(!g),320)}}),l===""?C.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[C.jsx("span",{children:r("embed-dialog.instruction")})," ",i.instructionLink&&C.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:i.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",C.jsx(Ha,{icon:"external-link",small:!0})]})]}):C.jsx("div",{className:"tlui-embed-dialog__warning",children:h?r("embed-dialog.invalid-url"):" "})]}),C.jsxs(cw,{className:"tlui-dialog__footer__actions",children:[C.jsx(Mt,{type:"normal",onClick:()=>{a(null),f(null),c("")},children:C.jsx(tn,{children:r("embed-dialog.back")})}),C.jsx("div",{className:"tlui-embed__spacer"}),C.jsx(Mt,{type:"normal",onClick:o,children:C.jsx(tn,{children:r("embed-dialog.cancel")})}),C.jsx(Mt,{type:"primary",disabled:!u,onClick:()=>{u&&(n.putExternalContent({type:"embed",url:l,point:n.getViewportPageCenter(),embed:u.definition}),o())},children:C.jsx(tn,{children:r("embed-dialog.create")})})]})]}):C.jsx(C.Fragment,{children:C.jsx(jh,{className:"tlui-embed-dialog__list",children:$h.map(m=>C.jsxs(Mt,{type:"menu",onClick:()=>a(m),children:[C.jsx(tn,{children:m.title}),C.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${s.embedIcons[m.type]})`}})]},m.type))})})]})});function GO(){const t=Ue(),o=B.useRef();return B.useEffect(()=>{const n=window.document.createElement("input");n.type="file",n.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",n.multiple=!0,o.current=n;async function r(s){const i=s.target.files;!i||i.length===0||(await t.putExternalContent({type:"files",files:Array.from(i),point:t.getViewportPageBounds().center,ignoreParent:!1}),n.value="")}return n.addEventListener("change",r),()=>{o.current=void 0,n.removeEventListener("change",r)}},[t]),B.useCallback(()=>{var n;(n=o.current)==null||n.click()},[o])}const VO=B.createContext({});function KZ({overrides:t,children:o}){const n=Ue(),r=vi(),{addDialog:s}=nc(),i=GO(),a=B.useMemo(()=>{const l=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(u){n.setCurrentTool("select"),r("select-tool",{source:u,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(u){n.setCurrentTool("hand"),r("select-tool",{source:u,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",onSelect(u){n.setCurrentTool("eraser"),r("select-tool",{source:u,id:"eraser"})}},{id:"draw",label:"tool.draw",icon:"tool-pencil",kbd:"d,b,x",onSelect(u){n.setCurrentTool("draw"),r("select-tool",{source:u,id:"draw"})}},...[...ii.values].map(u=>({id:u,label:`tool.${u}`,meta:{geo:u},kbd:u==="rectangle"?"r":u==="ellipse"?"o":void 0,icon:"geo-"+u,onSelect(f){n.batch(()=>{n.updateInstanceState({stylesForNextShape:{...n.getInstanceState().stylesForNextShape,[ii.id]:u}},{ephemeral:!0}),n.setCurrentTool("geo"),r("select-tool",{source:f,id:`geo-${u}`})})}})),{id:"arrow",label:"tool.arrow",icon:"tool-arrow",kbd:"a",onSelect(u){n.setCurrentTool("arrow"),r("select-tool",{source:u,id:"arrow"})}},{id:"line",label:"tool.line",icon:"tool-line",kbd:"l",onSelect(u){n.setCurrentTool("line"),r("select-tool",{source:u,id:"line"})}},{id:"frame",label:"tool.frame",icon:"tool-frame",kbd:"f",onSelect(u){n.setCurrentTool("frame"),r("select-tool",{source:u,id:"frame"})}},{id:"text",label:"tool.text",icon:"tool-text",kbd:"t",onSelect(u){n.setCurrentTool("text"),r("select-tool",{source:u,id:"text"})}},{id:"asset",label:"tool.asset",icon:"tool-media",kbd:"$u",onSelect(u){i(),r("select-tool",{source:u,id:"media"})}},{id:"note",label:"tool.note",icon:"tool-note",kbd:"n",onSelect(u){n.setCurrentTool("note"),r("select-tool",{source:u,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(u){n.setCurrentTool("laser"),r("select-tool",{source:u,id:"laser"})}},{id:"embed",label:"tool.embed",icon:"tool-embed",onSelect(u){s({component:zO}),r("select-tool",{source:u,id:"embed"})}},{id:"highlight",label:"tool.highlight",icon:"tool-highlight",kbd:"!d",onSelect(u){n.setCurrentTool("highlight"),r("select-tool",{source:u,id:"highlight"})}}];l.push();const c=Object.fromEntries(l.map(u=>[u.id,u]));return t?t(n,c,{insertMedia:i}):c},[t,n,r,i,s]);return C.jsx(VO.Provider,{value:a,children:o})}function sr(){const t=B.useContext(VO);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}const HO=Ut.createContext(0);function ZZ({forceMobile:t=!1,children:o}){const n=Ue(),r=He("breakpoint",()=>{const{width:s}=n.getViewportScreenBounds(),i=t?Kr.MOBILE_SM:_v.length-1;for(let a=0;a<i;a++)if(s>_v[a]&&s<=_v[a+1])return a;return i},[n]);return C.jsx(HO.Provider,{value:r,children:o})}function Fo(){return B.useContext(HO)}function QZ(){const{addToast:t,removeToast:o,clearToasts:n}=Ws(),{addDialog:r,clearDialogs:s,removeDialog:i,updateDialog:a}=nc(),c=Fo()<Kr.TABLET_SM,u=tr();return B.useMemo(()=>({addToast:t,removeToast:o,clearToasts:n,addDialog:r,clearDialogs:s,removeDialog:i,updateDialog:a,msg:u,isMobile:c}),[r,t,s,n,u,i,o,a,c])}function JZ(t,o){const n={};for(const r of t)if(r.translations)for(const[s,i]of Ao(r.translations)){let a=n[s];a||(a=n[s]={}),Object.assign(a,i)}return{actions:(r,s)=>{for(const i of t)i.actions&&(s=i.actions(r,s,o));return s},tools:(r,s,i)=>{for(const a of t)a.tools&&(s=a.tools(r,s,{...o,...i}));return s},translations:n}}function WO(t){return B.useMemo(()=>t,t)}function eQ(t){const o=WO(t==null?[]:Array.isArray(t)?t:[t]);return B.useMemo(()=>{const n={};for(const r of o)if(r.translations)for(const[s,i]of Ao(r.translations)){let a=n[s];a||(a=n[s]={}),Object.assign(a,i)}return n},[o])}function tQ(t){const o=QZ(),n=WO(t==null?[]:Array.isArray(t)?t:[t]);return B.useMemo(()=>JZ(n,o),[n,o])}function rQ(t,o){const n=Rt(o.map(s=>t.getShape(s)).filter(s=>s&&t.isShapeOfType(s,"frame")));if(!n.length)return;const r=[];t.batch(()=>{n.map(s=>{const i=t.getSortedChildIdsForParent(s.id);i.length&&(t.reparentShapes(i,s.parentId,s.index),r.push(...i))}),t.setSelectedShapes(r),t.deleteShapes(o)})}const nQ=50;function oQ(t,o,n={}){const r=t.getShape(o);if(!r)return;const s=t.getSortedChildIdsForParent(r.id),i=Rt(s.map(p=>t.getShape(p)));if(!i.length)return;const a=mt.FromPoints(i.flatMap(p=>{const m=t.getShapeGeometry(p.id);return t.getShapeLocalTransform(p).applyToPoints(m.vertices)})),{padding:l=nQ}=n,c=a.w+2*l,u=a.h+2*l,f=l-a.minX,h=l-a.minY;if(f===0&&h===0&&r.props.w===c&&r.props.h===u)return;const d=new Y(f,h).rot(r.rotation);t.batch(()=>{const p=s.map(m=>{const g=t.getShape(m);return{id:g.id,type:g.type,x:g.x+f,y:g.y+h}});p.push({id:r.id,type:r.type,x:r.x-d.x,y:r.y-d.y,props:{w:c,h:u}}),t.updateShapes(p)})}function ZE(t){return es.isValid(t)?{isValid:!0,hasProtocol:!0}:es.isValid("https://"+t)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const sQ=os(function({onClose:o}){const r=Ue().getOnlySelectedShape();return r&&"url"in r.props&&typeof r.props.url=="string"?C.jsx(iQ,{onClose:o,selectedShape:r}):null}),iQ=os(function({onClose:o,selectedShape:n}){const r=Ue(),s=tr(),i=B.useRef(null);B.useEffect(()=>{requestAnimationFrame(()=>{var m;return(m=i.current)==null?void 0:m.focus()})},[]);const a=B.useRef(n.props.url),[l,c]=B.useState(()=>{const m=ZE(n.props.url),g=m.isValid===!0?m.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:g,safe:g,valid:!0}}),u=B.useCallback(m=>{const g=m.replace(/https?:\/\/(https?:\/\/)/,(v,x)=>x),b=ZE(g),y=b.isValid===!0?b.hasProtocol?g:"https://"+g:"https://";c({actual:g,safe:y,valid:b.isValid})},[]),f=B.useCallback(()=>{const m=r.getOnlySelectedShape();m&&(r.updateShapes([{id:m.id,type:m.type,props:{url:""}}]),o())},[r,o]),h=B.useCallback(()=>{const m=r.getOnlySelectedShape();m&&(m&&"url"in m.props&&m.props.url!==l.safe&&r.updateShapes([{id:m.id,type:m.type,props:{url:l.safe}}]),o())},[r,o,l]),d=B.useCallback(()=>{o()},[o]);if(!n)return o(),null;const p=a.current&&!l.valid;return C.jsxs(C.Fragment,{children:[C.jsxs(Cy,{children:[C.jsx(Py,{children:s("edit-link-dialog.title")}),C.jsx(Ty,{})]}),C.jsx(jh,{children:C.jsxs("div",{className:"tlui-edit-link-dialog",children:[C.jsx(uw,{ref:i,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:l.actual,onValueChange:u,onComplete:h,onCancel:d}),C.jsx("div",{children:l.valid?s("edit-link-dialog.detail"):s("edit-link-dialog.invalid-url")})]})}),C.jsxs(cw,{className:"tlui-dialog__footer__actions",children:[C.jsx(Mt,{type:"normal",onClick:d,onTouchEnd:d,children:C.jsx(tn,{children:s("edit-link-dialog.cancel")})}),p?C.jsx(Mt,{type:"danger",onTouchEnd:f,onClick:f,children:C.jsx(tn,{children:s("edit-link-dialog.clear")})}):C.jsx(Mt,{type:"primary",disabled:!l.valid,onTouchEnd:h,onClick:h,children:C.jsx(tn,{children:s("edit-link-dialog.save")})})]})]})});var dw={exports:{}};dw.exports;(function(t){var o=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function a(c,u){if(!i[c]){i[c]={};for(var f=0;f<c.length;f++)i[c][c.charAt(f)]=f}return i[c][u]}var l={compressToBase64:function(c){if(c==null)return"";var u=l._compress(c,6,function(f){return r.charAt(f)});switch(u.length%4){default:case 0:return u;case 1:return u+"===";case 2:return u+"==";case 3:return u+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:l._decompress(c.length,32,function(u){return a(r,c.charAt(u))})},compressToUTF16:function(c){return c==null?"":l._compress(c,15,function(u){return n(u+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:l._decompress(c.length,16384,function(u){return c.charCodeAt(u)-32})},compressToUint8Array:function(c){for(var u=l.compress(c),f=new Uint8Array(u.length*2),h=0,d=u.length;h<d;h++){var p=u.charCodeAt(h);f[h*2]=p>>>8,f[h*2+1]=p%256}return f},decompressFromUint8Array:function(c){if(c==null)return l.decompress(c);for(var u=new Array(c.length/2),f=0,h=u.length;f<h;f++)u[f]=c[f*2]*256+c[f*2+1];var d=[];return u.forEach(function(p){d.push(n(p))}),l.decompress(d.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":l._compress(c,6,function(u){return s.charAt(u)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),l._decompress(c.length,32,function(u){return a(s,c.charAt(u))}))},compress:function(c){return l._compress(c,16,function(u){return n(u)})},_compress:function(c,u,f){if(c==null)return"";var h,d,p={},m={},g="",b="",y="",v=2,x=3,S=2,w=[],E=0,j=0,P;for(P=0;P<c.length;P+=1)if(g=c.charAt(P),Object.prototype.hasOwnProperty.call(p,g)||(p[g]=x++,m[g]=!0),b=y+g,Object.prototype.hasOwnProperty.call(p,b))y=b;else{if(Object.prototype.hasOwnProperty.call(m,y)){if(y.charCodeAt(0)<256){for(h=0;h<S;h++)E=E<<1,j==u-1?(j=0,w.push(f(E)),E=0):j++;for(d=y.charCodeAt(0),h=0;h<8;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1}else{for(d=1,h=0;h<S;h++)E=E<<1|d,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=0;for(d=y.charCodeAt(0),h=0;h<16;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1}v--,v==0&&(v=Math.pow(2,S),S++),delete m[y]}else for(d=p[y],h=0;h<S;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1;v--,v==0&&(v=Math.pow(2,S),S++),p[b]=x++,y=String(g)}if(y!==""){if(Object.prototype.hasOwnProperty.call(m,y)){if(y.charCodeAt(0)<256){for(h=0;h<S;h++)E=E<<1,j==u-1?(j=0,w.push(f(E)),E=0):j++;for(d=y.charCodeAt(0),h=0;h<8;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1}else{for(d=1,h=0;h<S;h++)E=E<<1|d,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=0;for(d=y.charCodeAt(0),h=0;h<16;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1}v--,v==0&&(v=Math.pow(2,S),S++),delete m[y]}else for(d=p[y],h=0;h<S;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1;v--,v==0&&(v=Math.pow(2,S),S++)}for(d=2,h=0;h<S;h++)E=E<<1|d&1,j==u-1?(j=0,w.push(f(E)),E=0):j++,d=d>>1;for(;;)if(E=E<<1,j==u-1){w.push(f(E));break}else j++;return w.join("")},decompress:function(c){return c==null?"":c==""?null:l._decompress(c.length,32768,function(u){return c.charCodeAt(u)})},_decompress:function(c,u,f){var h=[],d=4,p=4,m=3,g="",b=[],y,v,x,S,w,E,j,P={val:f(0),position:u,index:1};for(y=0;y<3;y+=1)h[y]=y;for(x=0,w=Math.pow(2,2),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;switch(x){case 0:for(x=0,w=Math.pow(2,8),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;j=n(x);break;case 1:for(x=0,w=Math.pow(2,16),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;j=n(x);break;case 2:return""}for(h[3]=j,v=j,b.push(j);;){if(P.index>c)return"";for(x=0,w=Math.pow(2,m),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;switch(j=x){case 0:for(x=0,w=Math.pow(2,8),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;h[p++]=n(x),j=p-1,d--;break;case 1:for(x=0,w=Math.pow(2,16),E=1;E!=w;)S=P.val&P.position,P.position>>=1,P.position==0&&(P.position=u,P.val=f(P.index++)),x|=(S>0?1:0)*E,E<<=1;h[p++]=n(x),j=p-1,d--;break;case 2:return b.join("")}if(d==0&&(d=Math.pow(2,m),m++),h[j])g=h[j];else if(j===p)g=v+v.charAt(0);else return null;b.push(g),h[p++]=v+g.charAt(0),d--,v=g,d==0&&(d=Math.pow(2,m),m++)}}};return l}();t!=null?t.exports=o:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return o})})(dw);var YO=dw.exports;async function aQ(t,o,n){var y,v,x;const{elements:r,files:s}=o,i={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},a=new Map,l=new Map,c=t.getCurrentPageId(),u=new Map,f=[],h=new Set;r.forEach(S=>{if(u.set(S.id,hr()),S.boundElements!==null)for(const w of S.boundElements)w.type==="text"&&h.add(w.id)});let d=qL;for(const S of r){if(h.has(S.id))continue;const w=u.get(S.id),E={id:w,typeName:"shape",parentId:c,index:d,x:S.x,y:S.y,rotation:0,isLocked:S.locked,opacity:lQ(S.opacity),meta:{}};switch(S.angle!==0&&l.set(w,S.angle),S.groupIds&&S.groupIds.length>0?a.has(S.groupIds[0])?(y=a.get(S.groupIds[0]))==null||y.push(w):a.set(S.groupIds[0],[w]):f.push(w),S.type){case"rectangle":case"ellipse":case"diamond":{let j="",P="middle";if(S.boundElements!==null){for(const O of S.boundElements)if(O.type==="text"){const k=r.find(F=>F.id===O.id);k&&(j=k.text,P=QE[k.textAlign])}}const M=S.backgroundColor==="transparent"?S.strokeColor:S.backgroundColor;i.shapes.push({...E,type:"geo",props:{geo:S.type,url:S.link??"",w:S.width,h:S.height,size:cp[S.strokeWidth]??"draw",color:md[M]??"black",text:j,align:P,dash:up(S),fill:mQ(S)}});break}case"freedraw":{i.shapes.push({...E,type:"draw",props:{dash:up(S),size:cp[S.strokeWidth],color:md[S.strokeColor]??"black",segments:[{type:"free",points:S.points.map(([j,P,M=.5])=>({x:j,y:P,z:M}))}]}});break}case"line":{const j=S.points[0],P=S.points[S.points.length-1],M=uh(S.points.length);i.shapes.push({...E,type:"line",props:{dash:up(S),size:cp[S.strokeWidth],color:md[S.strokeColor]??"black",spline:S.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:M[0],x:j[0],y:j[1]},end:{id:"end",type:"vertex",index:M[M.length-1],x:P[0],y:P[1]},...Object.fromEntries(S.points.slice(1,-1).map(([O,k],F)=>{const A=Mr();return[A,{id:A,type:"vertex",index:M[F+1],x:O,y:k}]}))}}});break}case"arrow":{let j="";if(S.boundElements!==null){for(const F of S.boundElements)if(F.type==="text"){const A=r.find(N=>N.id===F.id);A&&(j=A.text)}}const P=S.points[0],M=S.points[S.points.length-1],O=u.get((v=S.startBinding)==null?void 0:v.elementId),k=u.get((x=S.endBinding)==null?void 0:x.elementId);i.shapes.push({...E,type:"arrow",props:{text:j,bend:pQ(S,P,M),dash:up(S),size:cp[S.strokeWidth]??"m",color:md[S.strokeColor]??"black",start:O?{type:"binding",boundShapeId:O,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:P[0],y:P[1]},end:k?{type:"binding",boundShapeId:k,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:M[0],y:M[1]},arrowheadEnd:JE[S.endArrowhead]??"none",arrowheadStart:JE[S.startArrowhead]??"none"}});break}case"text":{const{size:j,scale:P}=uQ(S.fontSize);i.shapes.push({...E,type:"text",props:{size:j,scale:P,font:dQ[S.fontFamily]??"draw",color:md[S.strokeColor]??"black",text:S.text,align:QE[S.textAlign]}});break}case"image":{const j=s[S.fileId];if(!j)break;const P=Cl.createId();i.assets.push({id:P,typeName:"asset",type:"image",props:{w:S.width,h:S.height,name:S.id??"Untitled",isAnimated:!1,mimeType:j.mimeType,src:j.dataURL},meta:{}}),i.shapes.push({...E,type:"image",props:{w:S.width,h:S.height,assetId:P}})}}d=Ii(d)}const p=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContentOntoCurrentPage(i,{point:p,select:!1,preserveIds:!0});for(const S of a.values())if(S.length>1){t.groupShapes(S);const w=t.getShape(S[0]);w!=null&&w.parentId&&Vo(w.parentId)&&f.push(w.parentId)}for(const[S,w]of l)t.select(S),t.rotateShapesBy([S],w);const m=Rt(f.map(S=>t.getShape(S))),g=mt.Common(m.map(S=>t.getShapePageBounds(S))),b=t.getViewportPageBounds().center;t.updateShapes(m.map(S=>{const w={x:(S.x??0)-(g.x+g.w/2),y:(S.y??0)-(g.y+g.h/2)};return{id:S.id,type:S.type,x:b.x+w.x,y:b.y+w.y}})),t.setSelectedShapes(f)}const lQ=t=>{const o=t/100;return o<.2?.1:o<.4?.25:o<.6?.5:o<.8?.75:1},cp={1:"s",2:"m",3:"l",4:"xl"},cQ={16:"s",20:"m",28:"l",36:"xl"};function uQ(t){const o=cQ[t];return o?{size:o,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}const dQ={1:"draw",2:"sans",3:"mono"},md={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},hQ={solid:"draw",dashed:"dashed",dotted:"dotted"},fQ={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},QE={left:"start",center:"middle",right:"end"},JE={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function pQ(t,o,n){let r=0;if(t.points.length>2){const s=new Y(o[0],o[1]),i=new Y(n[0],n[1]),a=new Y(t.points[1][0],t.points[1][1]),l=Y.Sub(i,s),c=Y.Per(l),u=Y.Med(i,s),f=Y.Sub(u,c),h=Y.Add(u,c),d=Y.NearestPointOnLineSegment(f,h,a,!1);r=Y.Dist(d,u),Y.Clockwise(d,i,u)&&(r*=-1)}return r}const up=t=>{let o=hQ[t.strokeStyle]??"draw";return o==="draw"&&t.roughness===0&&(o="solid"),o},mQ=t=>t.backgroundColor==="transparent"?"none":fQ[t.fillStyle]??"solid";async function XO(t,o,n,r){const i=(await Promise.all(o.map(async a=>await(await fetch(a)).blob()))).map(a=>new File([a],"tldrawFile",{type:a.type}));t.mark("paste"),await t.putExternalContent({type:"files",files:i,point:n,ignoreParent:!1,sources:r}),o.forEach(a=>URL.revokeObjectURL(a))}function gQ(t,o,n){const r=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0),s=t.getSelectionPageBounds();t.mark("paste"),t.putContentOntoCurrentPage(o,{point:r,select:!0});const i=t.getSelectionPageBounds();s&&i&&(s!=null&&s.collides(i))&&(t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0}),setTimeout(()=>{t.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},150))}async function N1(t,o,n,r){var s;try{if(new URL(o).pathname.match(/\.(png|jpe?g|gif|svg|webp)$/i)&&(s=(await fetch(o,{method:"HEAD"})).headers.get("content-type"))!=null&&s.match(/^image\//)){t.mark("paste"),XO(t,[o]);return}}catch(i){i.message!=="Failed to fetch"&&console.error(i)}return t.mark("paste"),await t.putExternalContent({type:"url",point:n,url:o,sources:r})}function yQ(t){const o=document.implementation.createHTMLDocument("");return o.documentElement.innerHTML=t.trim(),o.body.textContent||o.body.innerText||""}const vQ=t=>{try{const o=new URL(t);return o.protocol==="http:"||o.protocol==="https:"}catch{return!1}},bQ=t=>{const o=t.split(/[\n\s]/);for(const n of o)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return pI(o)},xQ=t=>/^<svg/.test(t),SQ=["input","select","textarea"];function ym(t){const{activeElement:o}=document;return t.getIsMenuOpen()||o&&(o.getAttribute("contenteditable")||SQ.indexOf(o.tagName.toLowerCase())>-1)}const wQ=t=>t.types.find(o=>o.match(/^image\//)),jv=(t,o,n,r)=>{const s=bQ(o);if(s)for(const i of s)N1(t,i,n);else vQ(o)?N1(t,o,n):xQ(o)?(t.mark("paste"),t.putExternalContent({type:"svg-text",text:o,point:n,sources:r})):(t.mark("paste"),t.putExternalContent({type:"text",text:o,point:n,sources:r}))},_Q=async(t,o,n)=>{if(t.getEditingShapeId()!==null)return;if(!o)throw Error("No clipboard data");const r=[];for(const s of Object.values(o.items))switch(s.kind){case"file":{r.push({type:"file",source:new Promise(i=>i(s.getAsFile()))});break}case"string":{s.type==="text/html"?r.push({type:"html",source:new Promise(i=>s.getAsString(i))}):s.type==="text/plain"?r.push({type:"text",source:new Promise(i=>s.getAsString(i))}):r.push({type:s.type,source:new Promise(i=>s.getAsString(i))});break}}KO(t,r,n)},qO=async(t,o,n)=>{const r=[];for(const s of o){if(wQ(s))for(const i of s.types)i.match(/^image\//)&&r.push({type:"blob",source:s.getType(i)});s.types.includes("text/html")&&r.push({type:"html",source:(async()=>{const i=await s.getType("text/html");return await ru.blobToText(i)})()}),s.types.includes("text/uri-list")&&r.push({type:"url",source:(async()=>{const i=await s.getType("text/uri-list");return await ru.blobToText(i)})()}),s.types.includes("text/plain")&&r.push({type:"text",source:(async()=>{const i=await s.getType("text/plain");return await ru.blobToText(i)})()})}return await KO(t,r,n)};async function KO(t,o,n){const r=o.filter(i=>(i.type==="file"||i.type==="blob")&&i.source!==null);if(r.length){const a=(await Promise.all(r.map(l=>l.source))).filter(Boolean).map(l=>URL.createObjectURL(l));return await XO(t,a,n)}const s=await Promise.all(o.filter(i=>i.type!=="file").map(i=>new Promise(a=>{const l=i;if(l.type==="file"){a({type:"error",data:null,reason:"unexpected file"});return}l.source.then(c=>{var f;const u=(f=c.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:f[1];if(u)try{const h=YO.decompressFromBase64(u);if(h===null){a({type:"error",data:h,reason:"found tldraw data comment but could not parse base64"});return}else{const d=JSON.parse(h);if(d.type!=="application/tldraw"&&a({type:"error",data:d,reason:`found tldraw data comment but JSON was of a different type: ${d.type}`}),typeof d.data=="string"){a({type:"error",data:d,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}a({type:"tldraw",data:d.data});return}}catch{a({type:"error",data:u,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(l.type==="html"){a({type:"text",data:c,subtype:"html"});return}if(l.type==="url"){a({type:"text",data:c,subtype:"url"});return}try{const h=JSON.parse(c);if(h.type==="excalidraw/clipboard"){a({type:"excalidraw",data:h});return}else{a({type:"text",data:c,subtype:"json"});return}}catch{a({type:"text",data:c,subtype:"text"});return}}a({type:"error",data:c,reason:"unhandled case"})})})));for(const i of s)if(i.type==="tldraw"){gQ(t,i.data,n);return}for(const i of s)if(i.type==="excalidraw"){aQ(t,i.data,n);return}for(const i of s)if(i.type==="text"&&i.subtype==="html"){const l=new DOMParser().parseFromString(i.data,"text/html").querySelector("body");if(l&&Array.from(l.children).filter(u=>u.nodeType===1).length===1&&l.firstElementChild&&l.firstElementChild.tagName==="A"&&l.firstElementChild.hasAttribute("href")&&l.firstElementChild.getAttribute("href")!==""){const u=l.firstElementChild.getAttribute("href");jv(t,u,n,s);return}if(!s.some(u=>u.type==="text"&&u.subtype!=="html")&&i.data.trim()){jv(t,yQ(i.data),n,s);return}}for(const i of s)if(i.type==="text"&&i.subtype==="url"){N1(t,i.data,n,s);return}for(const i of s)if(i.type==="text"&&i.subtype==="text"&&i.data.trim()){jv(t,i.data,n,s);return}}const jg=t=>{var r;const o=t.getContentFromCurrentPage(t.getSelectedShapeIds());if(!o){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const n=YO.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:o}));if(!(typeof navigator>"u")){const s=o.shapes.map(i=>t.isShapeOfType(i,"text")||t.isShapeOfType(i,"geo")||t.isShapeOfType(i,"arrow")?i.props.text:t.isShapeOfType(i,"bookmark")||t.isShapeOfType(i,"embed")?i.props.url:null).filter(o4);if((r=navigator.clipboard)!=null&&r.write){const i=new Blob([`<tldraw>${n}</tldraw>`],{type:"text/html"});let a=s.join(" ");a===""&&(a=" "),navigator.clipboard.write([new ClipboardItem({"text/html":i,"text/plain":new Blob([a],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${n}</tldraw>`)}};function jQ(){const t=Ue(),o=vi(),n=B.useCallback(function(a){t.getSelectedShapeIds().length!==0&&(jg(t),o("copy",{source:a}))},[t,o]),r=B.useCallback(function(a){t.getSelectedShapeIds().length!==0&&(jg(t),t.deleteShapes(t.getSelectedShapeIds()),o("cut",{source:a}))},[t,o]),s=B.useCallback(async function(a,l,c){t.getEditingShapeId()!==null||ym(t)||(Array.isArray(a)&&a[0]instanceof ClipboardItem?(qO(t,a,c),o("paste",{source:"menu"})):navigator.clipboard.read().then(u=>{s(u,l,c)}))},[t,o]);return{copy:n,cut:r,paste:s}}function EQ(){const t=Ue(),o=vi(),n=He("editor.isFocused",()=>t.getInstanceState().isFocused,[t]);B.useEffect(()=>{if(!n)return;const r=c=>{t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||ym(t)||(qt(c),jg(t),o("copy",{source:"kbd"}))};function s(c){t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||ym(t)||(qt(c),jg(t),t.deleteShapes(t.getSelectedShapeIds()),o("cut",{source:"kbd"}))}let i=!1;const a=c=>{c.button===1&&(i=!0,requestAnimationFrame(()=>{i=!1}))},l=c=>{if(i){Rn(c);return}t.getEditingShapeId()!==null||ym(t)||(c.clipboardData&&!t.inputs.shiftKey?_Q(t,c.clipboardData):navigator.clipboard.read().then(u=>{Array.isArray(u)&&u[0]instanceof ClipboardItem&&qO(t,u,t.inputs.currentPagePoint)}),qt(c),o("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",s),document.addEventListener("paste",l),document.addEventListener("pointerup",a),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",s),document.removeEventListener("paste",l),document.removeEventListener("pointerup",a)}},[t,o,n])}async function ZO(t,o,n){const{type:r,quality:s,scale:i,width:a,height:l}=n;let[c,u]=await t3(a*i,l*i);c=Math.floor(c),u=Math.floor(u);const f=c/a,h=URL.createObjectURL(new Blob([t],{type:"image/svg+xml"})),d=await new Promise(m=>{const g=new Image;g.crossOrigin="anonymous",g.onload=async()=>{o&&await new Promise(v=>setTimeout(v,250));const b=document.createElement("canvas"),y=b.getContext("2d");b.width=c,b.height=u,y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="high",y.drawImage(g,0,0,c,u),URL.revokeObjectURL(h),m(b)},g.onerror=()=>{m(null)},g.src=h});if(!d)return null;const p=await new Promise(m=>d.toBlob(g=>{(!g||wn.throwToBlob.get())&&m(null),m(g)},"image/"+r,s));if(!p)return null;if(r==="png"){const m=new DataView(await p.arrayBuffer());return ei.setPhysChunk(m,f,{type:"image/"+r})}else return p}async function QO(t,o,n){const r=await t.getSvgString(o!=null&&o.length?o:[...t.getCurrentPageShapeIds()],{scale:1,background:t.getInstanceState().exportBackground,...n});if(!r)throw new Error("Could not construct SVG.");return r}async function $1(t,o,n,r={}){var s;switch(n){case"svg":return(s=await QO(t,o,r))==null?void 0:s.svg;case"json":{const i=t.getContentFromCurrentPage(o);return JSON.stringify(i)}default:Zi(n)}}async function JO({editor:t,ids:o,format:n,opts:r={}}){switch(n){case"svg":return new Blob([await $1(t,o,"svg",r)],{type:"text/plain"});case"json":return new Blob([await $1(t,o,"json",r)],{type:"text/plain"});case"jpeg":case"png":case"webp":{const s=await QO(t,o,r);if(!s)throw new Error("Could not construct image.");const i=await ZO(s.svg,t.environment.isSafari,{type:n,quality:1,scale:2,width:s.width,height:s.height});if(!i)throw new Error("Could not construct image.");return i}default:Zi(n)}}const CQ={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",json:"text/plain",svg:"text/plain"};function PQ(t,o,n,r={}){return{blobPromise:JO({editor:t,ids:o,format:n,opts:r}),mimeType:CQ[n]}}function TQ(t,o,n="svg",r={}){if(!window.navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(window.navigator.clipboard.write){const{blobPromise:s,mimeType:i}=PQ(t,o,n,r);return window.navigator.clipboard.write([new ClipboardItem({[i]:s})]).catch(a=>(console.error(a),s.then(l=>window.navigator.clipboard.write([new ClipboardItem({[i]:l})]))))}switch(n){case"json":case"svg":return kQ(async()=>$1(t,o,n,r));case"jpeg":case"png":throw new Error("Copy not supported");default:Zi(n)}}async function kQ(t){var o,n;await((n=(o=navigator.clipboard)==null?void 0:o.writeText)==null?void 0:n.call(o,await t()))}function IQ(){const t=Ue(),{addToast:o}=Ws(),n=tr();return B.useCallback((r,s="svg")=>{TQ(t,r,s).catch(()=>{o({id:"copy-fail",severity:"warning",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")})})},[t,o,n])}async function MQ(t,o,n="png",r,s={}){if(!r&&(r=`shapes at ${eC()}`,o.length===1)){const l=t.getShape(o[0]);t.isShapeOfType(l,"frame")?r=l.props.name??"frame":r=`${l.id.replace(/:/,"_")} at ${eC()}`}r+=`.${n}`;const i=await JO({editor:t,ids:o,format:n,opts:s}),a=new File([i],r,{type:i.type});OQ(a)}function eC(){const t=new Date,o=String(t.getFullYear()).slice(2),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0");return`${o}-${n}-${r} ${s}.${i}.${a}`}function OQ(t){const o=document.createElement("a"),n=URL.createObjectURL(t);o.href=n,o.download=t.name,o.click(),URL.revokeObjectURL(n)}function AQ(){const t=Ue(),{addToast:o}=Ws(),n=tr();return B.useCallback((r,s="png",i)=>{MQ(t,r,s,i,{scale:1,background:t.getInstanceState().exportBackground}).catch(a=>{console.error(a.message),o({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc"),severity:"error"})})},[t,o,n])}function RQ(){const t=Ue(),o=B.useRef(null),n=B.useRef(null);return B.useCallback(async function(){const s=document.createElement("div"),i=document.createElement("style"),a=(y,v)=>{y&&(y.innerHTML=""),v&&document.head.contains(v)&&document.head.removeChild(v),y&&document.body.contains(y)&&document.body.removeChild(y)};a(o.current,n.current),o.current=s,n.current=i;const l=`tl-print-surface-${Mr()}`;s.className=l,i.innerHTML=`
			.${l} {
				display: none;
			}

			.${l} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${l} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${l}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${l}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${l}__item__header {
					display: none;
				}

				.${l}__item__footer {
					display: none;
					text-align: right;
				}

				.${l}__item__footer__hide {
					display: none;
				}

				
			}

		`;const c=()=>{document.head.appendChild(i),document.body.appendChild(s)},u=()=>{t.once("change-history",()=>{a(s,i)})};window.addEventListener("beforeprint",c),window.addEventListener("afterprint",u);function f(y,v,x){try{s.innerHTML+=`<div class="${l}__item">
        <div class="${l}__item__header">
          ${y.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${l}__item__main">
          ${x}
        </div>
        <div class="${l}__item__footer ${l}__item__footer__${v?"":"hide"}">
          ${v??""}
        </div>
      </div>`}catch(S){console.error(S)}}function h(){t.environment.isChromeForIos?(c(),window.print()):t.environment.isSafari?(c(),document.execCommand("print",!1)):window.print()}const d=t.getSelectedShapeIds(),p=t.getCurrentPageId(),m=t.getPages(),b={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.getSelectedShapeIds().length>0){const y=await t.getSvgString(d,b);if(y){const v=m.find(x=>x.id===p);f(`tldraw — ${v==null?void 0:v.name}`,null,y.svg),h()}}else{const y=t.getCurrentPage(),v=await t.getSvgString(t.getSortedChildIdsForParent(y.id),b);v&&(f(`tldraw — ${y.name}`,null,v.svg),h())}window.removeEventListener("beforeprint",c),window.removeEventListener("afterprint",u)},[t])}const eA=B.createContext({});function DQ(t){return Object.fromEntries(t.map(o=>[o.id,o]))}function jc(t,o){if(t.getSelectedShapes().length===0)return t.getDocumentSettings().name||o}function LQ({overrides:t,children:o}){const n=Ue(),{addDialog:r,clearDialogs:s}=nc(),{clearToasts:i}=Ws(),a=tr(),l=GO(),c=RQ(),{cut:u,copy:f,paste:h}=jQ(),d=IQ(),p=AQ(),m=a("document.default-name"),g=vi(),b=B.useMemo(()=>{function y(){return n.isIn("select")||(n.complete(),n.setCurrentTool("select")),!1}function v(){return n.isIn("select")&&n.getSelectedShapeIds().length>0}const S=DQ([{id:"edit-link",label:"action.edit-link",icon:"link",onSelect(w){v()&&(y()||(g("edit-link",{source:w}),n.mark("edit-link"),r({component:sQ})))}},{id:"insert-embed",label:"action.insert-embed",kbd:"$i",onSelect(w){g("insert-embed",{source:w}),r({component:zO})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",onSelect(w){g("insert-media",{source:w}),l()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",onSelect(w){g("undo",{source:w}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",onSelect(w){g("redo",{source:w}),n.redo()}},{id:"export-as-svg",label:{default:"action.export-as-svg",menu:"action.export-as-svg.short","context-menu":"action.export-as-svg.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("export-as",{format:"svg",source:w}),p(E,"svg",jc(n,m)))}},{id:"export-as-png",label:{default:"action.export-as-png",menu:"action.export-as-png.short","context-menu":"action.export-as-png.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("export-as",{format:"png",source:w}),p(E,"png",jc(n,m)))}},{id:"export-as-json",label:{default:"action.export-as-json",menu:"action.export-as-json.short","context-menu":"action.export-as-json.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("export-as",{format:"json",source:w}),p(E,"json",jc(n,m)))}},{id:"export-all-as-svg",label:{default:"action.export-all-as-svg",menu:"action.export-all-as-svg.short","context-menu":"action.export-all-as-svg.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("export-all-as",{format:"svg",source:w}),p(Array.from(n.getCurrentPageShapeIds()),"svg",jc(n,m)))}},{id:"export-all-as-png",label:{default:"action.export-all-as-png",menu:"action.export-all-as-png.short","context-menu":"action.export-all-as-png.short"},readonlyOk:!0,onSelect(w){const E=Array.from(n.getCurrentPageShapeIds().values());E.length!==0&&(g("export-all-as",{format:"png",source:w}),p(E,"png",jc(n,m)))}},{id:"export-all-as-json",label:{default:"action.export-all-as-json",menu:"action.export-all-as-json.short","context-menu":"action.export-all-as-json.short"},readonlyOk:!0,onSelect(w){const E=Array.from(n.getCurrentPageShapeIds().values());E.length!==0&&(g("export-all-as",{format:"json",source:w}),p(E,"json",jc(n,m)))}},{id:"copy-as-svg",label:{default:"action.copy-as-svg",menu:"action.copy-as-svg.short","context-menu":"action.copy-as-svg.short"},kbd:"$!c",readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("copy-as",{format:"svg",source:w}),d(E,"svg"))}},{id:"copy-as-png",label:{default:"action.copy-as-png",menu:"action.copy-as-png.short","context-menu":"action.copy-as-png.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("copy-as",{format:"png",source:w}),d(E,"png"))}},{id:"copy-as-json",label:{default:"action.copy-as-json",menu:"action.copy-as-json.short","context-menu":"action.copy-as-json.short"},readonlyOk:!0,onSelect(w){let E=n.getSelectedShapeIds();E.length===0&&(E=Array.from(n.getCurrentPageShapeIds().values())),E.length!==0&&(g("copy-as",{format:"json",source:w}),d(E,"json"))}},{id:"toggle-auto-size",label:"action.toggle-auto-size",onSelect(w){if(!v()||y())return;g("toggle-auto-size",{source:w}),n.mark("toggling auto size");const E=n.getSelectedShapes().filter(j=>n.isShapeOfType(j,"text")&&j.props.autoSize===!1);n.updateShapes(E.map(j=>({id:j.id,type:j.type,props:{...j.props,w:8,autoSize:!0}}))),xr(n,E.map(j=>j.id))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(w){g("open-embed-link",{source:w});const E=n.getSelectedShapeIds(),j="No embed shapes selected";if(E.length!==1){console.error(j);return}const P=n.getShape(E[0]);if(!P||!n.isShapeOfType(P,"embed")){console.error(j);return}NB(P.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(w){var E,j;if(((E=n.root.getCurrent())==null?void 0:E.id)!=="zoom"&&(g("zoom-tool",{source:w}),!(n.inputs.shiftKey||n.inputs.ctrlKey))){const P=n.root.getCurrent();P&&((j=P.getCurrent())==null?void 0:j.id)==="idle"&&n.setCurrentTool("zoom",{onInteractionEnd:P.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",onSelect(w){v()&&(y()||n.batch(()=>{g("convert-to-bookmark",{source:w});const E=n.getSelectedShapes(),j=[],P=[];for(const M of E){if(!M||!n.isShapeOfType(M,"embed")||!M.props.url)continue;const O=new Y(M.x,M.y);O.rot(-M.rotation),O.add(new Y(M.props.w/2-300/2,M.props.h/2-320/2)),O.rot(M.rotation);const k={id:hr(),type:"bookmark",rotation:M.rotation,x:O.x,y:O.y,opacity:1,props:{url:M.props.url}};j.push(k),P.push(M.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(P),n.createShapes(j)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",onSelect(w){v()&&(y()||(g("convert-to-embed",{source:w}),n.batch(()=>{const E=n.getSelectedShapeIds(),j=Rt(E.map(O=>n.getShape(O))),P=[],M=[];for(const O of j){if(!n.isShapeOfType(O,"bookmark"))continue;const{url:k}=O.props,F=Ta(O.props.url);if(!F||!F.definition)continue;const{width:A,height:N}=F.definition,$=new Y(O.x,O.y);$.rot(-O.rotation),$.add(new Y(O.props.w/2-A/2,O.props.h/2-N/2)),$.rot(O.rotation);const G={id:hr(),type:"embed",x:$.x,y:$.y,rotation:O.rotation,props:{url:k,w:A,h:N}};P.push(G),M.push(O.id)}n.mark("convert shapes to embed"),n.deleteShapes(M),n.createShapes(P)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",onSelect(w){if(!v()||y())return;g("duplicate-shapes",{source:w});const E=n.getInstanceState();let j,P;if(E.duplicateProps)j=E.duplicateProps.shapeIds,P=E.duplicateProps.offset;else{j=n.getSelectedShapeIds();const M=mt.Common(Rt(j.map(O=>n.getShapePageBounds(O))));P=E.canMoveCamera?{x:M.width+20,y:0}:{x:20,y:20}}n.mark("duplicate shapes"),n.duplicateShapes(j,P),E.duplicateProps&&n.updateInstanceState({duplicateProps:{...E.duplicateProps,shapeIds:n.getSelectedShapeIds()}})}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",onSelect(w){v()&&(y()||(g("ungroup-shapes",{source:w}),n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",onSelect(w){if(!v()||y())return;g("group-shapes",{source:w});const E=n.getOnlySelectedShape();E&&n.isShapeOfType(E,"group")?(n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())):(n.mark("group"),n.groupShapes(n.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",onSelect(w){if(!v())return;g("remove-frame",{source:w});const E=n.getSelectedShapes();E.length>0&&E.every(j=>n.isShapeOfType(j,"frame"))&&(n.mark("remove-frame"),rQ(n,E.map(j=>j.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",onSelect(w){if(!v())return;g("fit-frame-to-content",{source:w});const E=n.getOnlySelectedShape();E&&n.isShapeOfType(E,"frame")&&(n.mark("fit-frame-to-content"),oQ(n,E.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"left",source:w}),n.mark("align left");const E=n.getSelectedShapeIds();n.alignShapes(E,"left"),xr(n,E)}},{id:"align-center-horizontal",label:{default:"action.align-center-horizontal","context-menu":"action.align-center-horizontal.short"},kbd:"?H",icon:"align-center-horizontal",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"center-horizontal",source:w}),n.mark("align center horizontal");const E=n.getSelectedShapeIds();n.alignShapes(E,"center-horizontal"),xr(n,E)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"right",source:w}),n.mark("align right");const E=n.getSelectedShapeIds();n.alignShapes(E,"right"),xr(n,E)}},{id:"align-center-vertical",label:{default:"action.align-center-vertical","context-menu":"action.align-center-vertical.short"},kbd:"?V",icon:"align-center-vertical",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"center-vertical",source:w}),n.mark("align center vertical");const E=n.getSelectedShapeIds();n.alignShapes(E,"center-vertical"),xr(n,E)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"top",source:w}),n.mark("align top");const E=n.getSelectedShapeIds();n.alignShapes(E,"top"),xr(n,E)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",onSelect(w){if(!v()||y())return;g("align-shapes",{operation:"bottom",source:w}),n.mark("align bottom");const E=n.getSelectedShapeIds();n.alignShapes(E,"bottom"),xr(n,E)}},{id:"distribute-horizontal",label:{default:"action.distribute-horizontal","context-menu":"action.distribute-horizontal.short"},icon:"distribute-horizontal",kbd:"?!h",onSelect(w){if(!v()||y())return;g("distribute-shapes",{operation:"horizontal",source:w}),n.mark("distribute horizontal");const E=n.getSelectedShapeIds();n.distributeShapes(E,"horizontal"),xr(n,E)}},{id:"distribute-vertical",label:{default:"action.distribute-vertical","context-menu":"action.distribute-vertical.short"},icon:"distribute-vertical",kbd:"?!V",onSelect(w){if(!v()||y())return;g("distribute-shapes",{operation:"vertical",source:w}),n.mark("distribute vertical");const E=n.getSelectedShapeIds();n.distributeShapes(E,"vertical"),xr(n,E)}},{id:"stretch-horizontal",label:{default:"action.stretch-horizontal","context-menu":"action.stretch-horizontal.short"},icon:"stretch-horizontal",onSelect(w){if(!v()||y())return;g("stretch-shapes",{operation:"horizontal",source:w}),n.mark("stretch horizontal");const E=n.getSelectedShapeIds();n.stretchShapes(E,"horizontal"),xr(n,E)}},{id:"stretch-vertical",label:{default:"action.stretch-vertical","context-menu":"action.stretch-vertical.short"},icon:"stretch-vertical",onSelect(w){if(!v()||y())return;g("stretch-shapes",{operation:"vertical",source:w}),n.mark("stretch vertical");const E=n.getSelectedShapeIds();n.stretchShapes(E,"vertical"),xr(n,E)}},{id:"flip-horizontal",label:{default:"action.flip-horizontal","context-menu":"action.flip-horizontal.short"},kbd:"!h",onSelect(w){if(!v()||y())return;g("flip-shapes",{operation:"horizontal",source:w}),n.mark("flip horizontal");const E=n.getSelectedShapeIds();n.flipShapes(E,"horizontal"),xr(n,E)}},{id:"flip-vertical",label:{default:"action.flip-vertical","context-menu":"action.flip-vertical.short"},kbd:"!v",onSelect(w){if(!v()||y())return;g("flip-shapes",{operation:"vertical",source:w}),n.mark("flip vertical");const E=n.getSelectedShapeIds();n.flipShapes(E,"vertical"),xr(n,E)}},{id:"pack",label:"action.pack",icon:"pack",onSelect(w){if(!v()||y())return;g("pack-shapes",{source:w}),n.mark("pack");const E=n.getSelectedShapeIds();n.packShapes(E,16),xr(n,E)}},{id:"stack-vertical",label:{default:"action.stack-vertical","context-menu":"action.stack-vertical.short"},icon:"stack-vertical",onSelect(w){if(!v()||y())return;g("stack-shapes",{operation:"vertical",source:w}),n.mark("stack-vertical");const E=n.getSelectedShapeIds();n.stackShapes(E,"vertical",16),xr(n,E)}},{id:"stack-horizontal",label:{default:"action.stack-horizontal","context-menu":"action.stack-horizontal.short"},icon:"stack-horizontal",onSelect(w){if(!v()||y())return;g("stack-shapes",{operation:"horizontal",source:w}),n.mark("stack-horizontal");const E=n.getSelectedShapeIds();n.stackShapes(E,"horizontal",16),xr(n,E)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",onSelect(w){v()&&(y()||(g("reorder-shapes",{operation:"toFront",source:w}),n.mark("bring to front"),n.bringToFront(n.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",onSelect(w){v()&&(y()||(g("reorder-shapes",{operation:"forward",source:w}),n.mark("bring forward"),n.bringForward(n.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",onSelect(w){v()&&(y()||(g("reorder-shapes",{operation:"backward",source:w}),n.mark("send backward"),n.sendBackward(n.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",onSelect(w){v()&&(y()||(g("reorder-shapes",{operation:"toBack",source:w}),n.mark("send to back"),n.sendToBack(n.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",onSelect(w){v()&&(y()||(n.mark("cut"),u(w)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(w){v()&&(y()||f(w))}},{id:"paste",label:"action.paste",kbd:"$v",onSelect(w){var E;(E=navigator.clipboard)==null||E.read().then(j=>{h(j,w,w==="context-menu"?n.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(w){n.batch(()=>{y()||(g("select-all-shapes",{source:w}),n.mark("select all kbd"),n.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(w){v()&&(y()||(g("select-none-shapes",{source:w}),n.mark("select none"),n.selectNone()))}},{id:"delete",label:"action.delete",kbd:"⌫,del,backspace",icon:"trash",onSelect(w){v()&&(y()||(g("delete-shapes",{source:w}),n.mark("delete"),n.deleteShapes(n.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",onSelect(w){if(!v()||y())return;g("rotate-cw",{source:w}),n.mark("rotate-cw");const E=n.getSelectionRotation()%(dr/2),j=Bd(E,0)||Bd(E,dr/2),P=n.getSelectedShapeIds();n.rotateShapesBy(P,dr/2-(j?0:E)),xr(n,P)}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",onSelect(w){if(!v()||y())return;g("rotate-ccw",{source:w}),n.mark("rotate-ccw");const E=n.getSelectionRotation()%(dr/2),j=Bd(E,0),P=n.getSelectedShapeIds();n.rotateShapesBy(P,j?-(dr/2):-E),xr(n,P)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(w){g("zoom-in",{source:w}),n.zoomIn(n.getViewportScreenCenter(),{duration:ti})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(w){g("zoom-out",{source:w}),n.zoomOut(n.getViewportScreenCenter(),{duration:ti})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(w){g("reset-zoom",{source:w}),n.resetZoom(n.getViewportScreenCenter(),{duration:ti})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(w){g("zoom-to-fit",{source:w}),n.zoomToFit({duration:ti})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(w){v()&&(y()||(g("zoom-to-selection",{source:w}),n.zoomToSelection({duration:ti})))}},{id:"toggle-snap-mode",label:{default:"action.toggle-snap-mode",menu:"action.toggle-snap-mode.menu"},onSelect(w){g("toggle-snap-mode",{source:w}),n.user.updateUserPreferences({isSnapMode:!n.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:{default:"action.toggle-dark-mode",menu:"action.toggle-dark-mode.menu"},kbd:"$/",readonlyOk:!0,onSelect(w){g("toggle-dark-mode",{source:w}),n.user.updateUserPreferences({isDarkMode:!n.user.getIsDarkMode()})},checkbox:!0},{id:"toggle-wrap-mode",label:{default:"action.toggle-wrap-mode",menu:"action.toggle-wrap-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-wrap-mode",{source:w}),n.user.updateUserPreferences({isWrapMode:!n.user.getIsWrapMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:{default:"action.toggle-reduce-motion",menu:"action.toggle-reduce-motion.menu"},readonlyOk:!0,onSelect(w){g("toggle-reduce-motion",{source:w}),n.user.updateUserPreferences({animationSpeed:n.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:{default:"action.toggle-edge-scrolling",menu:"action.toggle-edge-scrolling.menu"},readonlyOk:!0,onSelect(w){g("toggle-edge-scrolling",{source:w}),n.user.updateUserPreferences({edgeScrollSpeed:n.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:{default:"action.toggle-transparent",menu:"action.toggle-transparent.menu","context-menu":"action.toggle-transparent.context-menu"},readonlyOk:!0,onSelect(w){g("toggle-transparent",{source:w}),n.updateInstanceState({exportBackground:!n.getInstanceState().exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:{default:"action.toggle-tool-lock",menu:"action.toggle-tool-lock.menu"},kbd:"q",onSelect(w){g("toggle-tool-lock",{source:w}),n.updateInstanceState({isToolLocked:!n.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",onSelect(w){g("unlock-all",{source:w});const E=[];for(const j of n.getCurrentPageShapes())j.isLocked&&E.push({id:j.id,type:j.type,isLocked:!1});E.length>0&&n.updateShapes(E)}},{id:"toggle-focus-mode",label:{default:"action.toggle-focus-mode",menu:"action.toggle-focus-mode.menu"},readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(w){requestAnimationFrame(()=>{n.batch(()=>{g("toggle-focus-mode",{source:w}),s(),i(),n.updateInstanceState({isFocusMode:!n.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:{default:"action.toggle-grid",menu:"action.toggle-grid.menu"},readonlyOk:!0,kbd:"$'",onSelect(w){g("toggle-grid-mode",{source:w}),n.updateInstanceState({isGridMode:!n.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:{default:"action.toggle-debug-mode",menu:"action.toggle-debug-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-debug-mode",{source:w}),n.updateInstanceState({isDebugMode:!n.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(w){g("print",{source:w}),c()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(w){g("exit-pen-mode",{source:w}),n.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(w){g("stop-following",{source:w}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(w){g("zoom-to-content",{source:w}),n.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",kbd:"!l",onSelect(w){n.mark("locking"),g("toggle-lock",{source:w}),n.toggleLock(n.getSelectedShapeIds())}},{id:"new-page",label:"context.pages.new-page",onSelect(w){const E=Gi.createId(),j=n.getSelectedShapeIds();n.batch(()=>{n.mark("move_shapes_to_page"),n.createPage({name:a("page-menu.new-page-initial-name"),id:E}),n.moveShapesToPage(j,E)}),g("new-page",{source:w})}},{id:"select-white-color",label:"color-style.white",kbd:"?t",onSelect(w){const E=ts;n.batch(()=>{n.mark("change-color"),n.isIn("select")&&n.setStyleForSelectedShapes(E,"white",{squashing:!1}),n.setStyleForNextShapes(E,"white",{squashing:!1}),n.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),g("set-style",{source:w,id:E.id,value:"white"})}}]);return t?t(n,S,void 0):S},[n,g,t,r,l,p,d,u,f,h,s,i,c,a,m]);return C.jsx(eA.Provider,{value:b,children:o})}function jt(){const t=B.useContext(eA);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function Eh(t,o){return t?typeof t=="string"?t:o?t[o]??t.default:void 0:void 0}const FQ=["top","right","bottom","left"],Wa=Math.min,Wo=Math.max,Eg=Math.round,dp=Math.floor,Ya=t=>({x:t,y:t}),NQ={left:"right",right:"left",bottom:"top",top:"bottom"},$Q={start:"end",end:"start"};function U1(t,o,n){return Wo(t,Wa(o,n))}function Yi(t,o){return typeof t=="function"?t(o):t}function Xi(t){return t.split("-")[0]}function $u(t){return t.split("-")[1]}function hw(t){return t==="x"?"y":"x"}function fw(t){return t==="y"?"height":"width"}function Uu(t){return["top","bottom"].includes(Xi(t))?"y":"x"}function pw(t){return hw(Uu(t))}function UQ(t,o,n){n===void 0&&(n=!1);const r=$u(t),s=pw(t),i=fw(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return o.reference[i]>o.floating[i]&&(a=Cg(a)),[a,Cg(a)]}function BQ(t){const o=Cg(t);return[B1(t),o,B1(o)]}function B1(t){return t.replace(/start|end/g,o=>$Q[o])}function zQ(t,o,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?o?s:r:o?r:s;case"left":case"right":return o?i:a;default:return[]}}function GQ(t,o,n,r){const s=$u(t);let i=zQ(Xi(t),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),o&&(i=i.concat(i.map(B1)))),i}function Cg(t){return t.replace(/left|right|bottom|top/g,o=>NQ[o])}function VQ(t){return{top:0,right:0,bottom:0,left:0,...t}}function tA(t){return typeof t!="number"?VQ(t):{top:t,right:t,bottom:t,left:t}}function Pg(t){const{x:o,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:o,right:o+r,bottom:n+s,x:o,y:n}}function tC(t,o,n){let{reference:r,floating:s}=t;const i=Uu(o),a=pw(o),l=fw(a),c=Xi(o),u=i==="y",f=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,d=r[l]/2-s[l]/2;let p;switch(c){case"top":p={x:f,y:r.y-s.height};break;case"bottom":p={x:f,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch($u(o)){case"start":p[a]-=d*(n&&u?-1:1);break;case"end":p[a]+=d*(n&&u?-1:1);break}return p}const HQ=async(t,o,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,l=i.filter(Boolean),c=await(a.isRTL==null?void 0:a.isRTL(o));let u=await a.getElementRects({reference:t,floating:o,strategy:s}),{x:f,y:h}=tC(u,r,c),d=r,p={},m=0;for(let g=0;g<l.length;g++){const{name:b,fn:y}=l[g],{x:v,y:x,data:S,reset:w}=await y({x:f,y:h,initialPlacement:r,placement:d,strategy:s,middlewareData:p,rects:u,platform:a,elements:{reference:t,floating:o}});f=v??f,h=x??h,p={...p,[b]:{...p[b],...S}},w&&m<=50&&(m++,typeof w=="object"&&(w.placement&&(d=w.placement),w.rects&&(u=w.rects===!0?await a.getElementRects({reference:t,floating:o,strategy:s}):w.rects),{x:f,y:h}=tC(u,d,c)),g=-1)}return{x:f,y:h,placement:d,strategy:s,middlewareData:p}};async function Ch(t,o){var n;o===void 0&&(o={});const{x:r,y:s,platform:i,rects:a,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=Yi(o,t),m=tA(p),b=l[d?h==="floating"?"reference":"floating":h],y=Pg(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(b)))==null||n?b:b.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:c})),v=h==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),S=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},w=Pg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:x,strategy:c}):v);return{top:(y.top-w.top+m.top)/S.y,bottom:(w.bottom-y.bottom+m.bottom)/S.y,left:(y.left-w.left+m.left)/S.x,right:(w.right-y.right+m.right)/S.x}}const WQ=t=>({name:"arrow",options:t,async fn(o){const{x:n,y:r,placement:s,rects:i,platform:a,elements:l,middlewareData:c}=o,{element:u,padding:f=0}=Yi(t,o)||{};if(u==null)return{};const h=tA(f),d={x:n,y:r},p=pw(s),m=fw(p),g=await a.getDimensions(u),b=p==="y",y=b?"top":"left",v=b?"bottom":"right",x=b?"clientHeight":"clientWidth",S=i.reference[m]+i.reference[p]-d[p]-i.floating[m],w=d[p]-i.reference[p],E=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let j=E?E[x]:0;(!j||!await(a.isElement==null?void 0:a.isElement(E)))&&(j=l.floating[x]||i.floating[m]);const P=S/2-w/2,M=j/2-g[m]/2-1,O=Wa(h[y],M),k=Wa(h[v],M),F=O,A=j-g[m]-k,N=j/2-g[m]/2+P,$=U1(F,N,A),G=!c.arrow&&$u(s)!=null&&N!==$&&i.reference[m]/2-(N<F?O:k)-g[m]/2<0,X=G?N<F?N-F:N-A:0;return{[p]:d[p]+X,data:{[p]:$,centerOffset:N-$-X,...G&&{alignmentOffset:X}},reset:G}}}),YQ=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(o){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:l,platform:c,elements:u}=o,{mainAxis:f=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...b}=Yi(t,o);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=Xi(s),v=Xi(l)===l,x=await(c.isRTL==null?void 0:c.isRTL(u.floating)),S=d||(v||!g?[Cg(l)]:BQ(l));!d&&m!=="none"&&S.push(...GQ(l,g,m,x));const w=[l,...S],E=await Ch(o,b),j=[];let P=((r=i.flip)==null?void 0:r.overflows)||[];if(f&&j.push(E[y]),h){const F=UQ(s,a,x);j.push(E[F[0]],E[F[1]])}if(P=[...P,{placement:s,overflows:j}],!j.every(F=>F<=0)){var M,O;const F=(((M=i.flip)==null?void 0:M.index)||0)+1,A=w[F];if(A)return{data:{index:F,overflows:P},reset:{placement:A}};let N=(O=P.filter($=>$.overflows[0]<=0).sort(($,G)=>$.overflows[1]-G.overflows[1])[0])==null?void 0:O.placement;if(!N)switch(p){case"bestFit":{var k;const $=(k=P.map(G=>[G.placement,G.overflows.filter(X=>X>0).reduce((X,W)=>X+W,0)]).sort((G,X)=>G[1]-X[1])[0])==null?void 0:k[0];$&&(N=$);break}case"initialPlacement":N=l;break}if(s!==N)return{reset:{placement:N}}}return{}}}};function rC(t,o){return{top:t.top-o.height,right:t.right-o.width,bottom:t.bottom-o.height,left:t.left-o.width}}function nC(t){return FQ.some(o=>t[o]>=0)}const XQ=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(o){const{rects:n}=o,{strategy:r="referenceHidden",...s}=Yi(t,o);switch(r){case"referenceHidden":{const i=await Ch(o,{...s,elementContext:"reference"}),a=rC(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:nC(a)}}}case"escaped":{const i=await Ch(o,{...s,altBoundary:!0}),a=rC(i,n.floating);return{data:{escapedOffsets:a,escaped:nC(a)}}}default:return{}}}}};async function qQ(t,o){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Xi(n),l=$u(n),c=Uu(n)==="y",u=["left","top"].includes(a)?-1:1,f=i&&c?-1:1,h=Yi(o,t);let{mainAxis:d,crossAxis:p,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return l&&typeof m=="number"&&(p=l==="end"?m*-1:m),c?{x:p*f,y:d*u}:{x:d*u,y:p*f}}const KQ=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(o){var n,r;const{x:s,y:i,placement:a,middlewareData:l}=o,c=await qQ(o,t);return a===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:a}}}}},ZQ=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(o){const{x:n,y:r,placement:s}=o,{mainAxis:i=!0,crossAxis:a=!1,limiter:l={fn:b=>{let{x:y,y:v}=b;return{x:y,y:v}}},...c}=Yi(t,o),u={x:n,y:r},f=await Ch(o,c),h=Uu(Xi(s)),d=hw(h);let p=u[d],m=u[h];if(i){const b=d==="y"?"top":"left",y=d==="y"?"bottom":"right",v=p+f[b],x=p-f[y];p=U1(v,p,x)}if(a){const b=h==="y"?"top":"left",y=h==="y"?"bottom":"right",v=m+f[b],x=m-f[y];m=U1(v,m,x)}const g=l.fn({...o,[d]:p,[h]:m});return{...g,data:{x:g.x-n,y:g.y-r}}}}},QQ=function(t){return t===void 0&&(t={}),{options:t,fn(o){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=o,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Yi(t,o),f={x:n,y:r},h=Uu(s),d=hw(h);let p=f[d],m=f[h];const g=Yi(l,o),b=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const x=d==="y"?"height":"width",S=i.reference[d]-i.floating[x]+b.mainAxis,w=i.reference[d]+i.reference[x]-b.mainAxis;p<S?p=S:p>w&&(p=w)}if(u){var y,v;const x=d==="y"?"width":"height",S=["top","left"].includes(Xi(s)),w=i.reference[h]-i.floating[x]+(S&&((y=a.offset)==null?void 0:y[h])||0)+(S?0:b.crossAxis),E=i.reference[h]+i.reference[x]+(S?0:((v=a.offset)==null?void 0:v[h])||0)-(S?b.crossAxis:0);m<w?m=w:m>E&&(m=E)}return{[d]:p,[h]:m}}}},JQ=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(o){const{placement:n,rects:r,platform:s,elements:i}=o,{apply:a=()=>{},...l}=Yi(t,o),c=await Ch(o,l),u=Xi(n),f=$u(n),h=Uu(n)==="y",{width:d,height:p}=r.floating;let m,g;u==="top"||u==="bottom"?(m=u,g=f===(await(s.isRTL==null?void 0:s.isRTL(i.floating))?"start":"end")?"left":"right"):(g=u,m=f==="end"?"top":"bottom");const b=p-c[m],y=d-c[g],v=!o.middlewareData.shift;let x=b,S=y;if(h){const E=d-c.left-c.right;S=f||v?Wa(y,E):E}else{const E=p-c.top-c.bottom;x=f||v?Wa(b,E):E}if(v&&!f){const E=Wo(c.left,0),j=Wo(c.right,0),P=Wo(c.top,0),M=Wo(c.bottom,0);h?S=d-2*(E!==0||j!==0?E+j:Wo(c.left,c.right)):x=p-2*(P!==0||M!==0?P+M:Wo(c.top,c.bottom))}await a({...o,availableWidth:S,availableHeight:x});const w=await s.getDimensions(i.floating);return d!==w.width||p!==w.height?{reset:{rects:!0}}:{}}}};function Xa(t){return rA(t)?(t.nodeName||"").toLowerCase():"#document"}function Qo(t){var o;return(t==null||(o=t.ownerDocument)==null?void 0:o.defaultView)||window}function sa(t){var o;return(o=(rA(t)?t.ownerDocument:t.document)||window.document)==null?void 0:o.documentElement}function rA(t){return t instanceof Node||t instanceof Qo(t).Node}function qi(t){return t instanceof Element||t instanceof Qo(t).Element}function hi(t){return t instanceof HTMLElement||t instanceof Qo(t).HTMLElement}function oC(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Qo(t).ShadowRoot}function Qh(t){const{overflow:o,overflowX:n,overflowY:r,display:s}=vs(t);return/auto|scroll|overlay|hidden|clip/.test(o+r+n)&&!["inline","contents"].includes(s)}function eJ(t){return["table","td","th"].includes(Xa(t))}function mw(t){const o=gw(),n=vs(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!o&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!o&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function tJ(t){let o=ju(t);for(;hi(o)&&!ky(o);){if(mw(o))return o;o=ju(o)}return null}function gw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ky(t){return["html","body","#document"].includes(Xa(t))}function vs(t){return Qo(t).getComputedStyle(t)}function Iy(t){return qi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function ju(t){if(Xa(t)==="html")return t;const o=t.assignedSlot||t.parentNode||oC(t)&&t.host||sa(t);return oC(o)?o.host:o}function nA(t){const o=ju(t);return ky(o)?t.ownerDocument?t.ownerDocument.body:t.body:hi(o)&&Qh(o)?o:nA(o)}function Ph(t,o,n){var r;o===void 0&&(o=[]),n===void 0&&(n=!0);const s=nA(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),a=Qo(s);return i?o.concat(a,a.visualViewport||[],Qh(s)?s:[],a.frameElement&&n?Ph(a.frameElement):[]):o.concat(s,Ph(s,[],n))}function oA(t){const o=vs(t);let n=parseFloat(o.width)||0,r=parseFloat(o.height)||0;const s=hi(t),i=s?t.offsetWidth:n,a=s?t.offsetHeight:r,l=Eg(n)!==i||Eg(r)!==a;return l&&(n=i,r=a),{width:n,height:r,$:l}}function yw(t){return qi(t)?t:t.contextElement}function lu(t){const o=yw(t);if(!hi(o))return Ya(1);const n=o.getBoundingClientRect(),{width:r,height:s,$:i}=oA(o);let a=(i?Eg(n.width):n.width)/r,l=(i?Eg(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const rJ=Ya(0);function sA(t){const o=Qo(t);return!gw()||!o.visualViewport?rJ:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function nJ(t,o,n){return o===void 0&&(o=!1),!n||o&&n!==Qo(t)?!1:o}function Vl(t,o,n,r){o===void 0&&(o=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=yw(t);let a=Ya(1);o&&(r?qi(r)&&(a=lu(r)):a=lu(t));const l=nJ(i,n,r)?sA(i):Ya(0);let c=(s.left+l.x)/a.x,u=(s.top+l.y)/a.y,f=s.width/a.x,h=s.height/a.y;if(i){const d=Qo(i),p=r&&qi(r)?Qo(r):r;let m=d,g=m.frameElement;for(;g&&r&&p!==m;){const b=lu(g),y=g.getBoundingClientRect(),v=vs(g),x=y.left+(g.clientLeft+parseFloat(v.paddingLeft))*b.x,S=y.top+(g.clientTop+parseFloat(v.paddingTop))*b.y;c*=b.x,u*=b.y,f*=b.x,h*=b.y,c+=x,u+=S,m=Qo(g),g=m.frameElement}}return Pg({width:f,height:h,x:c,y:u})}const oJ=[":popover-open",":modal"];function iA(t){return oJ.some(o=>{try{return t.matches(o)}catch{return!1}})}function sJ(t){let{elements:o,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",a=sa(r),l=o?iA(o.floating):!1;if(r===a||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=Ya(1);const f=Ya(0),h=hi(r);if((h||!h&&!i)&&((Xa(r)!=="body"||Qh(a))&&(c=Iy(r)),hi(r))){const d=Vl(r);u=lu(r),f.x=d.x+r.clientLeft,f.y=d.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+f.x,y:n.y*u.y-c.scrollTop*u.y+f.y}}function iJ(t){return Array.from(t.getClientRects())}function aA(t){return Vl(sa(t)).left+Iy(t).scrollLeft}function aJ(t){const o=sa(t),n=Iy(t),r=t.ownerDocument.body,s=Wo(o.scrollWidth,o.clientWidth,r.scrollWidth,r.clientWidth),i=Wo(o.scrollHeight,o.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+aA(t);const l=-n.scrollTop;return vs(r).direction==="rtl"&&(a+=Wo(o.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:l}}function lJ(t,o){const n=Qo(t),r=sa(t),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,l=0,c=0;if(s){i=s.width,a=s.height;const u=gw();(!u||u&&o==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:a,x:l,y:c}}function cJ(t,o){const n=Vl(t,!0,o==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=hi(t)?lu(t):Ya(1),a=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:a,height:l,x:c,y:u}}function sC(t,o,n){let r;if(o==="viewport")r=lJ(t,n);else if(o==="document")r=aJ(sa(t));else if(qi(o))r=cJ(o,n);else{const s=sA(t);r={...o,x:o.x-s.x,y:o.y-s.y}}return Pg(r)}function lA(t,o){const n=ju(t);return n===o||!qi(n)||ky(n)?!1:vs(n).position==="fixed"||lA(n,o)}function uJ(t,o){const n=o.get(t);if(n)return n;let r=Ph(t,[],!1).filter(l=>qi(l)&&Xa(l)!=="body"),s=null;const i=vs(t).position==="fixed";let a=i?ju(t):t;for(;qi(a)&&!ky(a);){const l=vs(a),c=mw(a);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Qh(a)&&!c&&lA(t,a))?r=r.filter(f=>f!==a):s=l,a=ju(a)}return o.set(t,r),r}function dJ(t){let{element:o,boundary:n,rootBoundary:r,strategy:s}=t;const a=[...n==="clippingAncestors"?uJ(o,this._c):[].concat(n),r],l=a[0],c=a.reduce((u,f)=>{const h=sC(o,f,s);return u.top=Wo(h.top,u.top),u.right=Wa(h.right,u.right),u.bottom=Wa(h.bottom,u.bottom),u.left=Wo(h.left,u.left),u},sC(o,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function hJ(t){const{width:o,height:n}=oA(t);return{width:o,height:n}}function fJ(t,o,n){const r=hi(o),s=sa(o),i=n==="fixed",a=Vl(t,!0,i,o);let l={scrollLeft:0,scrollTop:0};const c=Ya(0);if(r||!r&&!i)if((Xa(o)!=="body"||Qh(s))&&(l=Iy(o)),r){const h=Vl(o,!0,i,o);c.x=h.x+o.clientLeft,c.y=h.y+o.clientTop}else s&&(c.x=aA(s));const u=a.left+l.scrollLeft-c.x,f=a.top+l.scrollTop-c.y;return{x:u,y:f,width:a.width,height:a.height}}function iC(t,o){return!hi(t)||vs(t).position==="fixed"?null:o?o(t):t.offsetParent}function cA(t,o){const n=Qo(t);if(!hi(t)||iA(t))return n;let r=iC(t,o);for(;r&&eJ(r)&&vs(r).position==="static";)r=iC(r,o);return r&&(Xa(r)==="html"||Xa(r)==="body"&&vs(r).position==="static"&&!mw(r))?n:r||tJ(t)||n}const pJ=async function(t){const o=this.getOffsetParent||cA,n=this.getDimensions,r=await n(t.floating);return{reference:fJ(t.reference,await o(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function mJ(t){return vs(t).direction==="rtl"}const gJ={convertOffsetParentRelativeRectToViewportRelativeRect:sJ,getDocumentElement:sa,getClippingRect:dJ,getOffsetParent:cA,getElementRects:pJ,getClientRects:iJ,getDimensions:hJ,getScale:lu,isElement:qi,isRTL:mJ};function yJ(t,o){let n=null,r;const s=sa(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function a(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const{left:u,top:f,width:h,height:d}=t.getBoundingClientRect();if(l||o(),!h||!d)return;const p=dp(f),m=dp(s.clientWidth-(u+h)),g=dp(s.clientHeight-(f+d)),b=dp(u),v={rootMargin:-p+"px "+-m+"px "+-g+"px "+-b+"px",threshold:Wo(0,Wa(1,c))||1};let x=!0;function S(w){const E=w[0].intersectionRatio;if(E!==c){if(!x)return a();E?a(!1,E):r=setTimeout(()=>{a(!1,1e-7)},1e3)}x=!1}try{n=new IntersectionObserver(S,{...v,root:s.ownerDocument})}catch{n=new IntersectionObserver(S,v)}n.observe(t)}return a(!0),i}function vJ(t,o,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=yw(t),f=s||i?[...u?Ph(u):[],...Ph(o)]:[];f.forEach(y=>{s&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const h=u&&l?yJ(u,n):null;let d=-1,p=null;a&&(p=new ResizeObserver(y=>{let[v]=y;v&&v.target===u&&p&&(p.unobserve(o),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=p)==null||x.observe(o)})),n()}),u&&!c&&p.observe(u),p.observe(o));let m,g=c?Vl(t):null;c&&b();function b(){const y=Vl(t);g&&(y.x!==g.x||y.y!==g.y||y.width!==g.width||y.height!==g.height)&&n(),g=y,m=requestAnimationFrame(b)}return n(),()=>{var y;f.forEach(v=>{s&&v.removeEventListener("scroll",n),i&&v.removeEventListener("resize",n)}),h==null||h(),(y=p)==null||y.disconnect(),p=null,c&&cancelAnimationFrame(m)}}const bJ=KQ,xJ=ZQ,SJ=YQ,wJ=JQ,_J=XQ,aC=WQ,jJ=QQ,EJ=(t,o,n)=>{const r=new Map,s={platform:gJ,...n},i={...s.platform,_c:r};return HQ(t,o,{...s,platform:i})},CJ=t=>{function o(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&o(r)?r.current!=null?aC({element:r.current,padding:s}).fn(n):{}:r?aC({element:r,padding:s}).fn(n):{}}}};var vm=typeof document<"u"?B.useLayoutEffect:B.useEffect;function Tg(t,o){if(t===o)return!0;if(typeof t!=typeof o)return!1;if(typeof t=="function"&&t.toString()===o.toString())return!0;let n,r,s;if(t&&o&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==o.length)return!1;for(r=n;r--!==0;)if(!Tg(t[r],o[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(o).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(o,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Tg(t[i],o[i]))return!1}return!0}return t!==t&&o!==o}function uA(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function lC(t,o){const n=uA(t);return Math.round(o*n)/n}function cC(t){const o=B.useRef(t);return vm(()=>{o.current=t}),o}function PJ(t){t===void 0&&(t={});const{placement:o="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[f,h]=B.useState({x:0,y:0,strategy:n,placement:o,middlewareData:{},isPositioned:!1}),[d,p]=B.useState(r);Tg(d,r)||p(r);const[m,g]=B.useState(null),[b,y]=B.useState(null),v=B.useCallback(X=>{X!==E.current&&(E.current=X,g(X))},[]),x=B.useCallback(X=>{X!==j.current&&(j.current=X,y(X))},[]),S=i||m,w=a||b,E=B.useRef(null),j=B.useRef(null),P=B.useRef(f),M=c!=null,O=cC(c),k=cC(s),F=B.useCallback(()=>{if(!E.current||!j.current)return;const X={placement:o,strategy:n,middleware:d};k.current&&(X.platform=k.current),EJ(E.current,j.current,X).then(W=>{const V={...W,isPositioned:!0};A.current&&!Tg(P.current,V)&&(P.current=V,Zl.flushSync(()=>{h(V)}))})},[d,o,n,k]);vm(()=>{u===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,h(X=>({...X,isPositioned:!1})))},[u]);const A=B.useRef(!1);vm(()=>(A.current=!0,()=>{A.current=!1}),[]),vm(()=>{if(S&&(E.current=S),w&&(j.current=w),S&&w){if(O.current)return O.current(S,w,F);F()}},[S,w,F,O,M]);const N=B.useMemo(()=>({reference:E,floating:j,setReference:v,setFloating:x}),[v,x]),$=B.useMemo(()=>({reference:S,floating:w}),[S,w]),G=B.useMemo(()=>{const X={position:n,left:0,top:0};if(!$.floating)return X;const W=lC($.floating,f.x),V=lC($.floating,f.y);return l?{...X,transform:"translate("+W+"px, "+V+"px)",...uA($.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:W,top:V}},[n,l,$.floating,f.x,f.y]);return B.useMemo(()=>({...f,update:F,refs:N,elements:$,floatingStyles:G}),[f,F,N,$,G])}function dA(t){const[o,n]=B.useState(void 0);return Gl(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;a=u.inlineSize,l=u.blockSize}else a=t.offsetWidth,l=t.offsetHeight;n({width:a,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),o}const hA="Popper",[fA,My]=gi(hA),[TJ,pA]=fA(hA),kJ=t=>{const{__scopePopper:o,children:n}=t,[r,s]=B.useState(null);return B.createElement(TJ,{scope:o,anchor:r,onAnchorChange:s},n)},IJ="PopperAnchor",MJ=B.forwardRef((t,o)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=pA(IJ,n),a=B.useRef(null),l=jr(o,a);return B.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:B.createElement(vr.div,ot({},s,{ref:l}))}),mA="PopperContent",[OJ,Dse]=fA(mA),AJ=B.forwardRef((t,o)=>{var n,r,s,i,a,l,c,u;const{__scopePopper:f,side:h="bottom",sideOffset:d=0,align:p="center",alignOffset:m=0,arrowPadding:g=0,avoidCollisions:b=!0,collisionBoundary:y=[],collisionPadding:v=0,sticky:x="partial",hideWhenDetached:S=!1,updatePositionStrategy:w="optimized",onPlaced:E,...j}=t,P=pA(mA,f),[M,O]=B.useState(null),k=jr(o,de=>O(de)),[F,A]=B.useState(null),N=dA(F),$=(n=N==null?void 0:N.width)!==null&&n!==void 0?n:0,G=(r=N==null?void 0:N.height)!==null&&r!==void 0?r:0,X=h+(p!=="center"?"-"+p:""),W=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},V=Array.isArray(y)?y:[y],q=V.length>0,J={padding:W,boundary:V.filter(RJ),altBoundary:q},{refs:ae,floatingStyles:I,placement:U,isPositioned:z,middlewareData:K}=PJ({strategy:"fixed",placement:X,whileElementsMounted:(...de)=>vJ(...de,{animationFrame:w==="always"}),elements:{reference:P.anchor},middleware:[bJ({mainAxis:d+G,alignmentAxis:m}),b&&xJ({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?jJ():void 0,...J}),b&&SJ({...J}),wJ({...J,apply:({elements:de,rects:xe,availableWidth:Te,availableHeight:Se})=>{const{width:je,height:Oe}=xe.reference,We=de.floating.style;We.setProperty("--radix-popper-available-width",`${Te}px`),We.setProperty("--radix-popper-available-height",`${Se}px`),We.setProperty("--radix-popper-anchor-width",`${je}px`),We.setProperty("--radix-popper-anchor-height",`${Oe}px`)}}),F&&CJ({element:F,padding:g}),DJ({arrowWidth:$,arrowHeight:G}),S&&_J({strategy:"referenceHidden",...J})]}),[te,ne]=gA(U),le=Jn(E);Gl(()=>{z&&(le==null||le())},[z,le]);const me=(s=K.arrow)===null||s===void 0?void 0:s.x,ce=(i=K.arrow)===null||i===void 0?void 0:i.y,ge=((a=K.arrow)===null||a===void 0?void 0:a.centerOffset)!==0,[pe,oe]=B.useState();return Gl(()=>{M&&oe(window.getComputedStyle(M).zIndex)},[M]),B.createElement("div",{ref:ae.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:z?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pe,"--radix-popper-transform-origin":[(l=K.transformOrigin)===null||l===void 0?void 0:l.x,(c=K.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},B.createElement(OJ,{scope:f,placedSide:te,onArrowChange:A,arrowX:me,arrowY:ce,shouldHideArrow:ge},B.createElement(vr.div,ot({"data-side":te,"data-align":ne},j,{ref:k,style:{...j.style,animation:z?void 0:"none",opacity:(u=K.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function RJ(t){return t!==null}const DJ=t=>({name:"transformOrigin",options:t,fn(o){var n,r,s,i,a;const{placement:l,rects:c,middlewareData:u}=o,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,d=h?0:t.arrowWidth,p=h?0:t.arrowHeight,[m,g]=gA(l),b={start:"0%",center:"50%",end:"100%"}[g],y=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+d/2,v=((i=(a=u.arrow)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0)+p/2;let x="",S="";return m==="bottom"?(x=h?b:`${y}px`,S=`${-p}px`):m==="top"?(x=h?b:`${y}px`,S=`${c.floating.height+p}px`):m==="right"?(x=`${-p}px`,S=h?b:`${v}px`):m==="left"&&(x=`${c.floating.width+p}px`,S=h?b:`${v}px`),{data:{x,y:S}}}});function gA(t){const[o,n="center"]=t.split("-");return[o,n]}const vw=kJ,yA=MJ,vA=AJ,bA="Popover",[xA,Lse]=gi(bA,[My]),bw=My(),[LJ,Bu]=xA(bA),FJ=t=>{const{__scopePopover:o,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=t,l=bw(o),c=B.useRef(null),[u,f]=B.useState(!1),[h=!1,d]=rl({prop:r,defaultProp:s,onChange:i});return B.createElement(vw,l,B.createElement(LJ,{scope:o,contentId:Ni(),triggerRef:c,open:h,onOpenChange:d,onOpenToggle:B.useCallback(()=>d(p=>!p),[d]),hasCustomAnchor:u,onCustomAnchorAdd:B.useCallback(()=>f(!0),[]),onCustomAnchorRemove:B.useCallback(()=>f(!1),[]),modal:a},n))},NJ="PopoverTrigger",$J=B.forwardRef((t,o)=>{const{__scopePopover:n,...r}=t,s=Bu(NJ,n),i=bw(n),a=jr(o,s.triggerRef),l=B.createElement(vr.button,ot({type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":_A(s.open)},r,{ref:a,onClick:xt(t.onClick,s.onOpenToggle)}));return s.hasCustomAnchor?l:B.createElement(yA,ot({asChild:!0},i),l)}),SA="PopoverPortal",[UJ,BJ]=xA(SA,{forceMount:void 0}),zJ=t=>{const{__scopePopover:o,forceMount:n,children:r,container:s}=t,i=Bu(SA,o);return B.createElement(UJ,{scope:o,forceMount:n},B.createElement(yi,{present:n||i.open},B.createElement(wy,{asChild:!0,container:s},r)))},Th="PopoverContent",GJ=B.forwardRef((t,o)=>{const n=BJ(Th,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Bu(Th,t.__scopePopover);return B.createElement(yi,{present:r||i.open},i.modal?B.createElement(VJ,ot({},s,{ref:o})):B.createElement(HJ,ot({},s,{ref:o})))}),VJ=B.forwardRef((t,o)=>{const n=Bu(Th,t.__scopePopover),r=B.useRef(null),s=jr(o,r),i=B.useRef(!1);return B.useEffect(()=>{const a=r.current;if(a)return lw(a)},[]),B.createElement(aw,{as:zl,allowPinchZoom:!0},B.createElement(wA,ot({},t,{ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xt(t.onCloseAutoFocus,a=>{var l;a.preventDefault(),i.current||(l=n.triggerRef.current)===null||l===void 0||l.focus()}),onPointerDownOutside:xt(t.onPointerDownOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:xt(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})))}),HJ=B.forwardRef((t,o)=>{const n=Bu(Th,t.__scopePopover),r=B.useRef(!1),s=B.useRef(!1);return B.createElement(wA,ot({},t,{ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a;if((a=t.onCloseAutoFocus)===null||a===void 0||a.call(t,i),!i.defaultPrevented){var l;r.current||(l=n.triggerRef.current)===null||l===void 0||l.focus(),i.preventDefault()}r.current=!1,s.current=!1},onInteractOutside:i=>{var a,l;(a=t.onInteractOutside)===null||a===void 0||a.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((l=n.triggerRef.current)===null||l===void 0?void 0:l.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}}))}),wA=B.forwardRef((t,o)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:f,...h}=t,d=Bu(Th,n),p=bw(n);return iw(),B.createElement(sw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i},B.createElement(Sy,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>d.onOpenChange(!1)},B.createElement(vA,ot({"data-state":_A(d.open),role:"dialog",id:d.contentId},p,h,{ref:o,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function _A(t){return t?"open":"closed"}const WJ=FJ,YJ=$J,XJ=zJ,qJ=GJ;function nl(t,o){const n=Ue(),r=B.useRef(!1),s=vi(),i=B.useCallback(l=>{r.current=l,n.batch(()=>{l?(n.complete(),n.addOpenMenu(t)):n.updateInstanceState({openMenus:n.getOpenMenus().filter(c=>!c.startsWith(t))}),o==null||o(l)})},[n,t,o]),a=He("is menu open",()=>n.getOpenMenus().includes(t),[n,t]);return B.useEffect(()=>(r.current&&(s("open-menu",{source:"unknown",id:t}),n.addOpenMenu(t)),()=>{r.current&&(n.deleteOpenMenu(t),n.getOpenMenus().forEach(l=>{l.startsWith(t)&&(s("close-menu",{source:"unknown",id:t}),n.deleteOpenMenu(l))}),r.current=!1)}),[n,t,s]),[a,i]}function xw({id:t,children:o,onOpenChange:n,open:r}){const[s,i]=nl(t,n);return C.jsx(WJ,{onOpenChange:i,open:r||s,children:C.jsx("div",{className:"tlui-popover",children:o})})}function Sw({children:t}){return C.jsx(YJ,{asChild:!0,dir:"ltr",children:t})}function ww({side:t,children:o,align:n="center",sideOffset:r=8,alignOffset:s=0}){const i=to();return C.jsx(XJ,{container:i,children:C.jsx(qJ,{className:"tlui-popover__content",side:t,sideOffset:r,align:n,alignOffset:s,dir:"ltr",children:o})})}const jA=B.createContext({type:"menu",sourceId:"main-menu"});function Oy(){return B.useContext(jA)}function bs({type:t,sourceId:o,children:n}){return C.jsx(jA.Provider,{value:{type:t,sourceId:o},children:n})}const KJ=B.createContext(void 0);function _w(t){const o=B.useContext(KJ);return t||o||"ltr"}const Ev="rovingFocusGroup.onEntryFocus",ZJ={bubbles:!1,cancelable:!0},jw="RovingFocusGroup",[z1,EA,QJ]=xy(jw),[JJ,CA]=gi(jw,[QJ]),[eee,tee]=JJ(jw),ree=B.forwardRef((t,o)=>B.createElement(z1.Provider,{scope:t.__scopeRovingFocusGroup},B.createElement(z1.Slot,{scope:t.__scopeRovingFocusGroup},B.createElement(nee,ot({},t,{ref:o}))))),nee=B.forwardRef((t,o)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,...f}=t,h=B.useRef(null),d=jr(o,h),p=_w(i),[m=null,g]=rl({prop:a,defaultProp:l,onChange:c}),[b,y]=B.useState(!1),v=Jn(u),x=EA(n),S=B.useRef(!1),[w,E]=B.useState(0);return B.useEffect(()=>{const j=h.current;if(j)return j.addEventListener(Ev,v),()=>j.removeEventListener(Ev,v)},[v]),B.createElement(eee,{scope:n,orientation:r,dir:p,loop:s,currentTabStopId:m,onItemFocus:B.useCallback(j=>g(j),[g]),onItemShiftTab:B.useCallback(()=>y(!0),[]),onFocusableItemAdd:B.useCallback(()=>E(j=>j+1),[]),onFocusableItemRemove:B.useCallback(()=>E(j=>j-1),[])},B.createElement(vr.div,ot({tabIndex:b||w===0?-1:0,"data-orientation":r},f,{ref:d,style:{outline:"none",...t.style},onMouseDown:xt(t.onMouseDown,()=>{S.current=!0}),onFocus:xt(t.onFocus,j=>{const P=!S.current;if(j.target===j.currentTarget&&P&&!b){const M=new CustomEvent(Ev,ZJ);if(j.currentTarget.dispatchEvent(M),!M.defaultPrevented){const O=x().filter($=>$.focusable),k=O.find($=>$.active),F=O.find($=>$.id===m),N=[k,F,...O].filter(Boolean).map($=>$.ref.current);PA(N)}}S.current=!1}),onBlur:xt(t.onBlur,()=>y(!1))})))}),oee="RovingFocusGroupItem",see=B.forwardRef((t,o)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,...a}=t,l=Ni(),c=i||l,u=tee(oee,n),f=u.currentTabStopId===c,h=EA(n),{onFocusableItemAdd:d,onFocusableItemRemove:p}=u;return B.useEffect(()=>{if(r)return d(),()=>p()},[r,d,p]),B.createElement(z1.ItemSlot,{scope:n,id:c,focusable:r,active:s},B.createElement(vr.span,ot({tabIndex:f?0:-1,"data-orientation":u.orientation},a,{ref:o,onMouseDown:xt(t.onMouseDown,m=>{r?u.onItemFocus(c):m.preventDefault()}),onFocus:xt(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:xt(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){u.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const g=lee(m,u.orientation,u.dir);if(g!==void 0){m.preventDefault();let y=h().filter(v=>v.focusable).map(v=>v.ref.current);if(g==="last")y.reverse();else if(g==="prev"||g==="next"){g==="prev"&&y.reverse();const v=y.indexOf(m.currentTarget);y=u.loop?cee(y,v+1):y.slice(v+1)}setTimeout(()=>PA(y))}})})))}),iee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function aee(t,o){return o!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function lee(t,o,n){const r=aee(t.key,n);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return iee[r]}function PA(t){const o=document.activeElement;for(const n of t)if(n===o||(n.focus(),document.activeElement!==o))return}function cee(t,o){return t.map((n,r)=>t[(o+r)%t.length])}const uee=ree,dee=see,G1=["Enter"," "],hee=["ArrowDown","PageUp","Home"],TA=["ArrowUp","PageDown","End"],fee=[...hee,...TA],pee={ltr:[...G1,"ArrowRight"],rtl:[...G1,"ArrowLeft"]},mee={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ay="Menu",[kh,gee,yee]=xy(Ay),[oc,Ry]=gi(Ay,[yee,My,CA]),Dy=My(),kA=CA(),[IA,ol]=oc(Ay),[vee,Jh]=oc(Ay),bee=t=>{const{__scopeMenu:o,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=t,l=Dy(o),[c,u]=B.useState(null),f=B.useRef(!1),h=Jn(i),d=_w(s);return B.useEffect(()=>{const p=()=>{f.current=!0,document.addEventListener("pointerdown",m,{capture:!0,once:!0}),document.addEventListener("pointermove",m,{capture:!0,once:!0})},m=()=>f.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",m,{capture:!0}),document.removeEventListener("pointermove",m,{capture:!0})}},[]),B.createElement(vw,l,B.createElement(IA,{scope:o,open:n,onOpenChange:h,content:c,onContentChange:u},B.createElement(vee,{scope:o,onClose:B.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:f,dir:d,modal:a},r)))},MA=B.forwardRef((t,o)=>{const{__scopeMenu:n,...r}=t,s=Dy(n);return B.createElement(yA,ot({},s,r,{ref:o}))}),OA="MenuPortal",[xee,AA]=oc(OA,{forceMount:void 0}),See=t=>{const{__scopeMenu:o,forceMount:n,children:r,container:s}=t,i=ol(OA,o);return B.createElement(xee,{scope:o,forceMount:n},B.createElement(yi,{present:n||i.open},B.createElement(wy,{asChild:!0,container:s},r)))},zs="MenuContent",[wee,Ew]=oc(zs),_ee=B.forwardRef((t,o)=>{const n=AA(zs,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=ol(zs,t.__scopeMenu),a=Jh(zs,t.__scopeMenu);return B.createElement(kh.Provider,{scope:t.__scopeMenu},B.createElement(yi,{present:r||i.open},B.createElement(kh.Slot,{scope:t.__scopeMenu},a.modal?B.createElement(jee,ot({},s,{ref:o})):B.createElement(Eee,ot({},s,{ref:o})))))}),jee=B.forwardRef((t,o)=>{const n=ol(zs,t.__scopeMenu),r=B.useRef(null),s=jr(o,r);return B.useEffect(()=>{const i=r.current;if(i)return lw(i)},[]),B.createElement(Cw,ot({},t,{ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:xt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),Eee=B.forwardRef((t,o)=>{const n=ol(zs,t.__scopeMenu);return B.createElement(Cw,ot({},t,{ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),Cw=B.forwardRef((t,o)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:d,onDismiss:p,disableOutsideScroll:m,...g}=t,b=ol(zs,n),y=Jh(zs,n),v=Dy(n),x=kA(n),S=gee(n),[w,E]=B.useState(null),j=B.useRef(null),P=jr(o,j,b.onContentChange),M=B.useRef(0),O=B.useRef(""),k=B.useRef(0),F=B.useRef(null),A=B.useRef("right"),N=B.useRef(0),$=m?aw:B.Fragment,G=m?{as:zl,allowPinchZoom:!0}:void 0,X=V=>{var q,J;const ae=O.current+V,I=S().filter(le=>!le.disabled),U=document.activeElement,z=(q=I.find(le=>le.ref.current===U))===null||q===void 0?void 0:q.textValue,K=I.map(le=>le.textValue),te=$ee(K,ae,z),ne=(J=I.find(le=>le.textValue===te))===null||J===void 0?void 0:J.ref.current;(function le(me){O.current=me,window.clearTimeout(M.current),me!==""&&(M.current=window.setTimeout(()=>le(""),1e3))})(ae),ne&&setTimeout(()=>ne.focus())};B.useEffect(()=>()=>window.clearTimeout(M.current),[]),iw();const W=B.useCallback(V=>{var q,J;return A.current===((q=F.current)===null||q===void 0?void 0:q.side)&&Bee(V,(J=F.current)===null||J===void 0?void 0:J.area)},[]);return B.createElement(wee,{scope:n,searchRef:O,onItemEnter:B.useCallback(V=>{W(V)&&V.preventDefault()},[W]),onItemLeave:B.useCallback(V=>{var q;W(V)||((q=j.current)===null||q===void 0||q.focus(),E(null))},[W]),onTriggerLeave:B.useCallback(V=>{W(V)&&V.preventDefault()},[W]),pointerGraceTimerRef:k,onPointerGraceIntentChange:B.useCallback(V=>{F.current=V},[])},B.createElement($,G,B.createElement(sw,{asChild:!0,trapped:s,onMountAutoFocus:xt(i,V=>{var q;V.preventDefault(),(q=j.current)===null||q===void 0||q.focus()}),onUnmountAutoFocus:a},B.createElement(Sy,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:d,onDismiss:p},B.createElement(uee,ot({asChild:!0},x,{dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:w,onCurrentTabStopIdChange:E,onEntryFocus:xt(c,V=>{y.isUsingKeyboardRef.current||V.preventDefault()})}),B.createElement(vA,ot({role:"menu","aria-orientation":"vertical","data-state":NA(b.open),"data-radix-menu-content":"",dir:y.dir},v,g,{ref:P,style:{outline:"none",...g.style},onKeyDown:xt(g.onKeyDown,V=>{const J=V.target.closest("[data-radix-menu-content]")===V.currentTarget,ae=V.ctrlKey||V.altKey||V.metaKey,I=V.key.length===1;J&&(V.key==="Tab"&&V.preventDefault(),!ae&&I&&X(V.key));const U=j.current;if(V.target!==U||!fee.includes(V.key))return;V.preventDefault();const K=S().filter(te=>!te.disabled).map(te=>te.ref.current);TA.includes(V.key)&&K.reverse(),Fee(K)}),onBlur:xt(t.onBlur,V=>{V.currentTarget.contains(V.target)||(window.clearTimeout(M.current),O.current="")}),onPointerMove:xt(t.onPointerMove,Ih(V=>{const q=V.target,J=N.current!==V.clientX;if(V.currentTarget.contains(q)&&J){const ae=V.clientX>N.current?"right":"left";A.current=ae,N.current=V.clientX}}))})))))))}),Cee=B.forwardRef((t,o)=>{const{__scopeMenu:n,...r}=t;return B.createElement(vr.div,ot({role:"group"},r,{ref:o}))}),V1="MenuItem",uC="menu.itemSelect",RA=B.forwardRef((t,o)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=B.useRef(null),a=Jh(V1,t.__scopeMenu),l=Ew(V1,t.__scopeMenu),c=jr(o,i),u=B.useRef(!1),f=()=>{const h=i.current;if(!n&&h){const d=new CustomEvent(uC,{bubbles:!0,cancelable:!0});h.addEventListener(uC,p=>r==null?void 0:r(p),{once:!0}),nw(h,d),d.defaultPrevented?u.current=!1:a.onClose()}};return B.createElement(DA,ot({},s,{ref:c,disabled:n,onClick:xt(t.onClick,f),onPointerDown:h=>{var d;(d=t.onPointerDown)===null||d===void 0||d.call(t,h),u.current=!0},onPointerUp:xt(t.onPointerUp,h=>{var d;u.current||(d=h.currentTarget)===null||d===void 0||d.click()}),onKeyDown:xt(t.onKeyDown,h=>{const d=l.searchRef.current!=="";n||d&&h.key===" "||G1.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}))}),DA=B.forwardRef((t,o)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,a=Ew(V1,n),l=kA(n),c=B.useRef(null),u=jr(o,c),[f,h]=B.useState(!1),[d,p]=B.useState("");return B.useEffect(()=>{const m=c.current;if(m){var g;p(((g=m.textContent)!==null&&g!==void 0?g:"").trim())}},[i.children]),B.createElement(kh.ItemSlot,{scope:n,disabled:r,textValue:s??d},B.createElement(dee,ot({asChild:!0},l,{focusable:!r}),B.createElement(vr.div,ot({role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},i,{ref:u,onPointerMove:xt(t.onPointerMove,Ih(m=>{r?a.onItemLeave(m):(a.onItemEnter(m),m.defaultPrevented||m.currentTarget.focus())})),onPointerLeave:xt(t.onPointerLeave,Ih(m=>a.onItemLeave(m))),onFocus:xt(t.onFocus,()=>h(!0)),onBlur:xt(t.onBlur,()=>h(!1))}))))}),Pee=B.forwardRef((t,o)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return B.createElement(Iee,{scope:t.__scopeMenu,checked:n},B.createElement(RA,ot({role:"menuitemcheckbox","aria-checked":H1(n)?"mixed":n},s,{ref:o,"data-state":Lee(n),onSelect:xt(s.onSelect,()=>r==null?void 0:r(H1(n)?!0:!n),{checkForDefaultPrevented:!1})})))}),Tee="MenuRadioGroup";oc(Tee,{value:void 0,onValueChange:()=>{}});const kee="MenuItemIndicator",[Iee,Fse]=oc(kee,{checked:!1}),LA="MenuSub",[Mee,FA]=oc(LA),Oee=t=>{const{__scopeMenu:o,children:n,open:r=!1,onOpenChange:s}=t,i=ol(LA,o),a=Dy(o),[l,c]=B.useState(null),[u,f]=B.useState(null),h=Jn(s);return B.useEffect(()=>(i.open===!1&&h(!1),()=>h(!1)),[i.open,h]),B.createElement(vw,a,B.createElement(IA,{scope:o,open:r,onOpenChange:h,content:u,onContentChange:f},B.createElement(Mee,{scope:o,contentId:Ni(),triggerId:Ni(),trigger:l,onTriggerChange:c},n)))},hp="MenuSubTrigger",Aee=B.forwardRef((t,o)=>{const n=ol(hp,t.__scopeMenu),r=Jh(hp,t.__scopeMenu),s=FA(hp,t.__scopeMenu),i=Ew(hp,t.__scopeMenu),a=B.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},f=B.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return B.useEffect(()=>f,[f]),B.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),B.createElement(MA,ot({asChild:!0},u),B.createElement(DA,ot({id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":NA(n.open)},t,{ref:by(o,s.onTriggerChange),onClick:h=>{var d;(d=t.onClick)===null||d===void 0||d.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:xt(t.onPointerMove,Ih(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),f()},100))})),onPointerLeave:xt(t.onPointerLeave,Ih(h=>{var d;f();const p=(d=n.content)===null||d===void 0?void 0:d.getBoundingClientRect();if(p){var m;const g=(m=n.content)===null||m===void 0?void 0:m.dataset.side,b=g==="right",y=b?-5:5,v=p[b?"left":"right"],x=p[b?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+y,y:h.clientY},{x:v,y:p.top},{x,y:p.top},{x,y:p.bottom},{x:v,y:p.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:xt(t.onKeyDown,h=>{const d=i.searchRef.current!=="";if(!(t.disabled||d&&h.key===" ")&&pee[r.dir].includes(h.key)){var p;n.onOpenChange(!0),(p=n.content)===null||p===void 0||p.focus(),h.preventDefault()}})})))}),Ree="MenuSubContent",Dee=B.forwardRef((t,o)=>{const n=AA(zs,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=ol(zs,t.__scopeMenu),a=Jh(zs,t.__scopeMenu),l=FA(Ree,t.__scopeMenu),c=B.useRef(null),u=jr(o,c);return B.createElement(kh.Provider,{scope:t.__scopeMenu},B.createElement(yi,{present:r||i.open},B.createElement(kh.Slot,{scope:t.__scopeMenu},B.createElement(Cw,ot({id:l.contentId,"aria-labelledby":l.triggerId},s,{ref:u,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var h;a.isUsingKeyboardRef.current&&((h=c.current)===null||h===void 0||h.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:xt(t.onFocusOutside,f=>{f.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:xt(t.onEscapeKeyDown,f=>{a.onClose(),f.preventDefault()}),onKeyDown:xt(t.onKeyDown,f=>{const h=f.currentTarget.contains(f.target),d=mee[a.dir].includes(f.key);if(h&&d){var p;i.onOpenChange(!1),(p=l.trigger)===null||p===void 0||p.focus(),f.preventDefault()}})})))))});function NA(t){return t?"open":"closed"}function H1(t){return t==="indeterminate"}function Lee(t){return H1(t)?"indeterminate":t?"checked":"unchecked"}function Fee(t){const o=document.activeElement;for(const n of t)if(n===o||(n.focus(),document.activeElement!==o))return}function Nee(t,o){return t.map((n,r)=>t[(o+r)%t.length])}function $ee(t,o,n){const s=o.length>1&&Array.from(o).every(u=>u===o[0])?o[0]:o,i=n?t.indexOf(n):-1;let a=Nee(t,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==n));const c=a.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function Uee(t,o){const{x:n,y:r}=t;let s=!1;for(let i=0,a=o.length-1;i<o.length;a=i++){const l=o[i].x,c=o[i].y,u=o[a].x,f=o[a].y;c>r!=f>r&&n<(u-l)*(r-c)/(f-c)+l&&(s=!s)}return s}function Bee(t,o){if(!o)return!1;const n={x:t.clientX,y:t.clientY};return Uee(n,o)}function Ih(t){return o=>o.pointerType==="mouse"?t(o):void 0}const $A=bee,UA=MA,BA=See,zA=_ee,GA=Cee,VA=RA,HA=Pee,WA=Oee,YA=Aee,XA=Dee,qA="ContextMenu",[zee,Nse]=gi(qA,[Ry]),bi=Ry(),[Gee,KA]=zee(qA),Vee=t=>{const{__scopeContextMenu:o,children:n,onOpenChange:r,dir:s,modal:i=!0}=t,[a,l]=B.useState(!1),c=bi(o),u=Jn(r),f=B.useCallback(h=>{l(h),u(h)},[u]);return B.createElement(Gee,{scope:o,open:a,onOpenChange:f,modal:i},B.createElement($A,ot({},c,{dir:s,open:a,onOpenChange:f,modal:i}),n))},Hee="ContextMenuTrigger",Wee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=t,i=KA(Hee,n),a=bi(n),l=B.useRef({x:0,y:0}),c=B.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),u=B.useRef(0),f=B.useCallback(()=>window.clearTimeout(u.current),[]),h=d=>{l.current={x:d.clientX,y:d.clientY},i.onOpenChange(!0)};return B.useEffect(()=>f,[f]),B.useEffect(()=>void(r&&f()),[r,f]),B.createElement(B.Fragment,null,B.createElement(UA,ot({},a,{virtualRef:c})),B.createElement(vr.span,ot({"data-state":i.open?"open":"closed","data-disabled":r?"":void 0},s,{ref:o,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:r?t.onContextMenu:xt(t.onContextMenu,d=>{f(),h(d),d.preventDefault()}),onPointerDown:r?t.onPointerDown:xt(t.onPointerDown,fp(d=>{f(),u.current=window.setTimeout(()=>h(d),700)})),onPointerMove:r?t.onPointerMove:xt(t.onPointerMove,fp(f)),onPointerCancel:r?t.onPointerCancel:xt(t.onPointerCancel,fp(f)),onPointerUp:r?t.onPointerUp:xt(t.onPointerUp,fp(f))})))}),ZA=t=>{const{__scopeContextMenu:o,...n}=t,r=bi(o);return B.createElement(BA,ot({},r,n))},Yee="ContextMenuContent",Xee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=KA(Yee,n),i=bi(n),a=B.useRef(!1);return B.createElement(zA,ot({},i,r,{ref:o,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{var c;(c=t.onCloseAutoFocus)===null||c===void 0||c.call(t,l),!l.defaultPrevented&&a.current&&l.preventDefault(),a.current=!1},onInteractOutside:l=>{var c;(c=t.onInteractOutside)===null||c===void 0||c.call(t,l),!l.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),qee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=bi(n);return B.createElement(GA,ot({},s,r,{ref:o}))}),Kee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=bi(n);return B.createElement(VA,ot({},s,r,{ref:o}))}),Zee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=bi(n);return B.createElement(HA,ot({},s,r,{ref:o}))}),Qee=t=>{const{__scopeContextMenu:o,children:n,onOpenChange:r,open:s,defaultOpen:i}=t,a=bi(o),[l,c]=rl({prop:s,defaultProp:i,onChange:r});return B.createElement(WA,ot({},a,{open:l,onOpenChange:c}),n)},Jee=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=bi(n);return B.createElement(YA,ot({},s,r,{ref:o}))}),ete=B.forwardRef((t,o)=>{const{__scopeContextMenu:n,...r}=t,s=bi(n);return B.createElement(XA,ot({},s,r,{ref:o,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function fp(t){return o=>o.pointerType!=="mouse"?t(o):void 0}const tte=Vee,rte=Wee,nte=ZA,ote=Xee,ste=Zee,QA=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,ite=QA?"⌘":"Ctrl",ate=QA?"⌥":"Alt";function JA(t){return t.split(",")[0].split("").map(o=>{const n=o.replace(/\$/g,ite).replace(/\?/g,ate).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)})}function W1(t){return"— "+JA(t).join(" ")}function lte(t){return C.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:C.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[C.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),C.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:C.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const e5="DropdownMenu",[cte,$se]=gi(e5,[Ry]),xi=Ry(),[ute,t5]=cte(e5),dte=t=>{const{__scopeDropdownMenu:o,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:l=!0}=t,c=xi(o),u=B.useRef(null),[f=!1,h]=rl({prop:s,defaultProp:i,onChange:a});return B.createElement(ute,{scope:o,triggerId:Ni(),triggerRef:u,contentId:Ni(),open:f,onOpenChange:h,onOpenToggle:B.useCallback(()=>h(d=>!d),[h]),modal:l},B.createElement($A,ot({},c,{open:f,onOpenChange:h,dir:r,modal:l}),n))},hte="DropdownMenuTrigger",fte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=t5(hte,n),a=xi(n);return B.createElement(UA,ot({asChild:!0},a),B.createElement(vr.button,ot({type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},s,{ref:by(o,i.triggerRef),onPointerDown:xt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:xt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})))}),pte=t=>{const{__scopeDropdownMenu:o,...n}=t,r=xi(o);return B.createElement(BA,ot({},r,n))},mte="DropdownMenuContent",gte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=t5(mte,n),i=xi(n),a=B.useRef(!1);return B.createElement(zA,ot({id:s.contentId,"aria-labelledby":s.triggerId},i,r,{ref:o,onCloseAutoFocus:xt(t.onCloseAutoFocus,l=>{var c;a.current||(c=s.triggerRef.current)===null||c===void 0||c.focus(),a.current=!1,l.preventDefault()}),onInteractOutside:xt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,f=c.button===2||u;(!s.modal||f)&&(a.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),yte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=xi(n);return B.createElement(GA,ot({},s,r,{ref:o}))}),vte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=xi(n);return B.createElement(VA,ot({},s,r,{ref:o}))}),bte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=xi(n);return B.createElement(HA,ot({},s,r,{ref:o}))}),xte=t=>{const{__scopeDropdownMenu:o,children:n,open:r,onOpenChange:s,defaultOpen:i}=t,a=xi(o),[l=!1,c]=rl({prop:r,defaultProp:i,onChange:s});return B.createElement(WA,ot({},a,{open:l,onOpenChange:c}),n)},Ste=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=xi(n);return B.createElement(YA,ot({},s,r,{ref:o}))}),wte=B.forwardRef((t,o)=>{const{__scopeDropdownMenu:n,...r}=t,s=xi(n);return B.createElement(XA,ot({},s,r,{ref:o,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),Pw=dte,Tw=fte,Ly=pte,kw=gte,_te=yte,jte=vte,Ete=bte,Cte=xte,Pte=Ste,Tte=wte;function Hl({id:t,children:o,modal:n=!1,debugOpen:r=!1}){const[s,i]=nl(t);return C.jsx(Pw,{open:r||s,dir:"ltr",modal:n,onOpenChange:i,children:o})}function Wl({children:t,...o}){return C.jsx(Tw,{dir:"ltr",asChild:!0,onTouchEnd:n=>qt(n),...o,children:t})}function Yl({side:t="bottom",align:o="start",sideOffset:n=8,alignOffset:r=8,children:s}){const i=to();return C.jsx(Ly,{container:i,children:C.jsx(kw,{className:"tlui-menu",side:t,sideOffset:n,align:o,alignOffset:r,collisionPadding:4,children:s})})}function kte({id:t,children:o}){const[n,r]=nl(t);return C.jsx(Cte,{open:n,onOpenChange:r,children:o})}function Ite({id:t,label:o,title:n,disabled:r}){return C.jsx(Pte,{dir:"ltr",asChild:!0,disabled:r,children:C.jsxs(Mt,{"data-testid":t,type:"menu",className:"tlui-menu__submenu__trigger",disabled:r,title:n,children:[C.jsx(tn,{children:o}),C.jsx(Zt,{icon:"chevron-right",small:!0})]})})}function Mte({id:t,alignOffset:o=-1,sideOffset:n=-4,size:r="small",children:s}){const i=to();return C.jsx(Ly,{container:i,children:C.jsx(Tte,{"data-testid":t,className:"tlui-menu tlui-menu__submenu__content",alignOffset:o,sideOffset:n,collisionPadding:4,"data-size":r,children:s})})}function Ote({children:t}){return C.jsx(_te,{dir:"ltr",className:"tlui-menu__group",children:t})}function Mh({noClose:t,children:o}){return C.jsx(jte,{dir:"ltr",asChild:!0,onClick:t?qt:void 0,children:o})}function Hd({children:t,visibleOnMobileLayout:o=!1}){const n=Fo();return!o&&n<Kr.MOBILE?null:C.jsx("kbd",{className:"tlui-kbd",children:JA(t).map((r,s)=>C.jsx("span",{children:r},s))})}function Re({disabled:t=!1,spinner:o=!1,readonlyOk:n=!1,id:r,kbd:s,label:i,icon:a,onSelect:l,noClose:c,isSelected:u}){const{type:f,sourceId:h}=Oy(),d=tr(),[p,m]=B.useState(!1);if(na()&&!n)return null;const b=Eh(i,f),y=s?W1(s):void 0,v=b?d(b):void 0,x=v&&y?`${v} ${y}`:v;switch(f){case"menu":return C.jsx(Mh,{children:C.jsxs(Mt,{type:"menu","data-testid":`${h}.${r}`,disabled:t,title:x,onClick:S=>{c&&qt(S),p?m(!1):l(h)},children:[C.jsx(tn,{children:v}),s&&C.jsx(Hd,{children:s})]})});case"context-menu":return t?null:C.jsxs(Kee,{dir:"ltr",title:x,draggable:!1,className:"tlui-button tlui-button__menu","data-testid":`${h}.${r}`,onSelect:S=>{c&&qt(S),p?m(!1):l(h)},children:[C.jsx("span",{className:"tlui-button__label",draggable:!1,children:v}),s&&C.jsx(Hd,{children:s}),o&&C.jsx(lte,{})]});case"panel":return C.jsxs(Mt,{"data-testid":`${h}.${r}`,type:"menu",title:x,disabled:t,onClick:()=>l(h),children:[C.jsx(tn,{children:v}),a&&C.jsx(Zt,{icon:a})]});case"small-icons":case"icons":return C.jsx(Mt,{"data-testid":`${h}.${r}`,type:"icon",title:x,disabled:t,onClick:()=>l(h),children:C.jsx(Zt,{icon:a,small:f==="small-icons"})});case"keyboard-shortcuts":return s?C.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair","data-testid":`${h}.${r}`,children:[C.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:v}),C.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:C.jsx(Hd,{visibleOnMobileLayout:!0,children:s})})]}):(console.warn(`Menu item '${i}' isn't shown in the keyboard shortcuts dialog because it doesn't have a keyboard shortcut.`),null);case"helper-buttons":return C.jsxs(Mt,{type:"low",onClick:()=>l(h),children:[C.jsx(Zt,{icon:a}),C.jsx(tn,{children:v})]});case"toolbar":return C.jsx(Mt,{type:"tool","data-testid":`tools.${r}`,"aria-label":b,"data-value":r,onClick:()=>l("toolbar"),title:x,onTouchStart:S=>{qt(S),l("toolbar")},role:"radio","aria-checked":u?"true":"false",children:C.jsx(Zt,{icon:a})});case"toolbar-overflow":return C.jsx(Mh,{"aria-label":i,children:C.jsx(Mt,{type:"icon",className:"tlui-button-grid__button",onClick:()=>{l("toolbar")},"data-testid":`tools.more.${r}`,title:x,role:"radio","aria-checked":u?"true":"false","data-value":r,children:C.jsx(Zt,{icon:a})})});default:throw Zi(f)}}function Ate(){return C.jsxs(C.Fragment,{children:[C.jsx(Rte,{}),C.jsx(Dte,{}),C.jsx(Lte,{}),C.jsx(Fte,{}),C.jsx(Nte,{}),C.jsx(Bte,{}),C.jsx(zte,{}),C.jsx(Gte,{})]})}function Rte(){const t=jt(),o=So(2);return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t["align-left"],disabled:!o}),C.jsx(Re,{...t["align-center-horizontal"],disabled:!o}),C.jsx(Re,{...t["align-right"],disabled:!o}),C.jsx(Re,{...t["stretch-horizontal"],disabled:!o}),C.jsx(Re,{...t["align-top"],disabled:!o}),C.jsx(Re,{...t["align-center-vertical"],disabled:!o}),C.jsx(Re,{...t["align-bottom"],disabled:!o}),C.jsx(Re,{...t["stretch-vertical"],disabled:!o})]})}function Dte(){const t=jt(),o=So(3);return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t["distribute-horizontal"],disabled:!o}),C.jsx(Re,{...t["distribute-vertical"],disabled:!o})]})}function Lte(){const t=jt(),o=YM();return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t["stack-horizontal"],disabled:!o}),C.jsx(Re,{...t["stack-vertical"],disabled:!o})]})}function Fte(){const t=jt(),o=So(1);return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t["send-to-back"],disabled:!o}),C.jsx(Re,{...t["send-backward"],disabled:!o}),C.jsx(Re,{...t["bring-forward"],disabled:!o}),C.jsx(Re,{...t["bring-to-front"],disabled:!o})]})}function Nte(){return Fo()<Kr.TABLET_SM?C.jsx($te,{}):C.jsx(Ute,{})}function $te(){const t=jt(),o=Ue(),n=He("zoom is 1",()=>o.getZoomLevel()===1,[o]);return C.jsx(Re,{...t["zoom-to-100"],disabled:n})}function Ute(){const t=jt(),o=So(1);return C.jsx(Re,{...t["rotate-ccw"],disabled:!o})}function Bte(){const t=jt(),o=So(1);return C.jsx(Re,{...t["rotate-cw"],disabled:!o})}function zte(){const t=jt(),o=KM();return C.jsx(Re,{...t["edit-link"],disabled:!o})}function Gte(){const t=XM(),o=qM();return t?C.jsx(dC,{}):o?C.jsx(Vte,{}):C.jsx(dC,{})}function dC(){const t=jt(),o=So(2);return C.jsx(Re,{...t.group,disabled:!o})}function Vte(){const t=jt();return C.jsx(Re,{...t.ungroup})}const Hte=B.memo(function({children:o}){const n=tr(),r=Fo(),s=na(),i=Ue(),a=He("should display quick actions when in readonly",()=>i.isInAny("hand","zoom"),[i]),l=o??C.jsx(Ate,{});if(!(s&&!a))return C.jsxs(xw,{id:"actions-menu",children:[C.jsx(Sw,{children:C.jsx(Mt,{type:"icon","data-testid":"actions-menu.button",title:n("actions-menu.title"),children:C.jsx(Zt,{icon:"dots-vertical",small:!0})})}),C.jsx(ww,{side:r>=Kr.TABLET?"bottom":"top",sideOffset:6,children:C.jsx("div",{className:"tlui-actions-menu tlui-buttons__grid","data-testid":"actions-menu.content",children:C.jsx(bs,{type:"icons",sourceId:"actions-menu",children:l})})})]})});function Ss({id:t,kbd:o,label:n,readonlyOk:r,onSelect:s,disabled:i=!1,checked:a=!1}){const{type:l,sourceId:c}=Oy(),u=na(),f=tr();if(u&&!r)return null;const h=Eh(n,l),d=h?f(h):void 0;switch(l){case"menu":return C.jsxs(Ete,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",title:d,onSelect:p=>{s==null||s(c),qt(p)},disabled:i,checked:a,children:[C.jsx(Ha,{small:!0,icon:a?"check":"checkbox-empty"}),d&&C.jsx("span",{className:"tlui-button__label",draggable:!1,children:d}),o&&C.jsx(Hd,{children:o})]});case"context-menu":return C.jsxs(ste,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",title:d,onSelect:p=>{s(c),qt(p)},disabled:i,checked:a,children:[C.jsx(Ha,{small:!0,icon:a?"check":"checkbox-empty"}),d&&C.jsx("span",{className:"tlui-button__label",draggable:!1,children:d}),o&&C.jsx(Hd,{children:o})]},t);default:return null}}function Nt({id:t,label:o,children:n}){const{type:r,sourceId:s}=Oy(),i=tr(),a=Eh(o,r),l=a?i(a):void 0;switch(r){case"panel":return C.jsx("div",{className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:n});case"menu":return C.jsx(Ote,{"data-testid":`${s}-group.${t}`,children:n});case"context-menu":return C.jsx(qee,{dir:"ltr",className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:n});case"keyboard-shortcuts":return C.jsxs("div",{className:"tlui-shortcuts-dialog__group","data-testid":`${s}-group.${t}`,children:[C.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:l}),C.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:n})]});default:return n}}function ws({id:t,disabled:o=!1,label:n,size:r="small",children:s}){const{type:i,sourceId:a}=Oy(),l=to(),c=tr(),u=n?typeof n=="string"?n:n[i]??n.default:void 0,f=u?c(u):void 0;switch(i){case"menu":return C.jsxs(kte,{id:`${a}-sub.${t}`,children:[C.jsx(Ite,{id:`${a}-sub.${f?f.toLowerCase()+"-button":""}`,disabled:o,label:f,title:f}),C.jsx(Mte,{id:`${a}-sub.${f?f.toLowerCase()+"-content":""}`,size:r,children:s})]});case"context-menu":return o?null:C.jsxs(Wte,{id:`${a}-sub.${t}`,children:[C.jsx(Jee,{dir:"ltr",disabled:o,asChild:!0,children:C.jsxs(Mt,{"data-testid":`${a}-sub-trigger.${t}`,type:"menu",className:"tlui-menu__submenu__trigger",children:[C.jsx(tn,{children:f}),C.jsx(Zt,{icon:"chevron-right",small:!0})]})}),C.jsx(ZA,{container:l,children:C.jsx(ete,{"data-testid":`${a}-sub-content.${t}`,className:"tlui-menu tlui-menu__submenu__content",alignOffset:-1,sideOffset:-4,collisionPadding:4,"data-size":r,children:s})})]});default:return s}}function Wte({id:t,children:o}){const[n,r]=nl(t);return C.jsx(Qee,{open:n,onOpenChange:r,children:o})}function r5(){const t=jt();return OW()?C.jsx(Re,{...t["toggle-auto-size"]}):null}function n5(){const t=jt();return KM()?C.jsx(Re,{...t["edit-link"]}):null}function Yte(){const t=jt();return So(1)?C.jsx(Re,{...t.duplicate}):null}function o5(){const t=jt();return XM()?C.jsx(Re,{...t.group}):null}function s5(){const t=jt();return qM()?C.jsx(Re,{...t.ungroup}):null}function i5(){const t=Ue(),o=jt();return He("allow unframe",()=>{const r=t.getSelectedShapes();return r.length===0?!1:r.every(s=>t.isShapeOfType(s,"frame"))},[t])?C.jsx(Re,{...o["remove-frame"]}):null}function a5(){const t=Ue(),o=jt();return He("allow fit frame to content",()=>{const r=t.getOnlySelectedShape();return r?t.isShapeOfType(r,"frame")&&t.getSortedChildIdsForParent(r).length>0:!1},[t])?C.jsx(Re,{...o["fit-frame-to-content"]}):null}function l5(){const t=Ue(),o=jt();return He("selected shapes",()=>t.getSelectedShapes().length>0,[t])?C.jsx(Re,{...o["toggle-lock"]}):null}function Iw(){const t=jt(),o=Ue(),n=He("isTransparentBg",()=>!o.getInstanceState().exportBackground,[o]);return C.jsx(Ss,{...t["toggle-transparent"],checked:n})}function Xte(){const t=Ue(),o=jt(),n=He("any shapes",()=>t.getCurrentPageShapeIds().size>0,[t]);return C.jsx(Re,{...o["unlock-all"],disabled:!n})}function c5(){const t=Ue(),o=He("zoomed to 100",()=>t.getZoomLevel()===1,[t]),n=jt();return C.jsx(Re,{...n["zoom-to-100"],noClose:!0,disabled:o})}function u5(){const t=Ue(),o=He("has shapes",()=>t.getCurrentPageShapeIds().size>0,[t]),n=jt();return C.jsx(Re,{...n["zoom-to-fit"],disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0})}function d5(){const t=Ue(),o=He("has shapes",()=>t.getSelectedShapeIds().length>0,[t]),n=jt();return C.jsx(Re,{...n["zoom-to-selection"],disabled:!o,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})}function h5(){return C.jsxs(Nt,{id:"clipboard",children:[C.jsx(Kte,{}),C.jsx(Zte,{}),C.jsx(Qte,{}),C.jsx(Yte,{}),C.jsx(Jte,{})]})}function qte(){var r;const t=Ue(),o=jt(),n=He("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t]);return C.jsxs(ws,{id:"copy-as",label:"context-menu.copy-as",size:"small",disabled:!n,children:[C.jsxs(Nt,{id:"copy-as-group",children:[C.jsx(Re,{...o["copy-as-svg"]}),!!((r=window.navigator.clipboard)!=null&&r.write)&&C.jsx(Re,{...o["copy-as-png"]}),C.jsx(Re,{...o["copy-as-json"]})]}),C.jsx(Nt,{id:"copy-as-bg",children:C.jsx(Iw,{})})]})}function Kte(){const t=jt(),o=So(1);return C.jsx(Re,{...t.cut,disabled:!o})}function Zte(){const t=jt(),o=MW(1);return C.jsx(Re,{...t.copy,disabled:!o})}function Qte(){const t=jt(),o=IW;return C.jsx(Re,{...t.paste,disabled:!o})}function f5(){const t=Ue(),o=jt();return He("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t])?C.jsxs(Nt,{id:"conversions",children:[C.jsx(qte,{}),C.jsxs(ws,{id:"export-as",label:"context-menu.export-as",size:"small",children:[C.jsxs(Nt,{id:"export-as-group",children:[C.jsx(Re,{...o["export-as-svg"]}),C.jsx(Re,{...o["export-as-png"]}),C.jsx(Re,{...o["export-as-json"]})]}),C.jsx(Nt,{id:"export-as-bg",children:C.jsx(Iw,{})})]})]}):null}function p5(){const t=jt(),o=Ue(),n=He("atLeastOneShapeOnPage",()=>o.getCurrentPageShapeIds().size>0,[o]);return C.jsx(Re,{...t["select-all"],disabled:!n})}function Jte(){const t=jt(),o=So(1);return C.jsx(Re,{...t.delete,disabled:!o})}function ere(){const t=So(2),o=AW(),n=jt();return t||o?C.jsxs(ws,{id:"arrange",label:"context-menu.arrange",size:"small",children:[t&&C.jsxs(Nt,{id:"align",children:[C.jsx(Re,{...n["align-left"]}),C.jsx(Re,{...n["align-center-horizontal"]}),C.jsx(Re,{...n["align-right"]}),C.jsx(Re,{...n["align-top"]}),C.jsx(Re,{...n["align-center-vertical"]}),C.jsx(Re,{...n["align-bottom"]})]}),C.jsx(tre,{}),t&&C.jsxs(Nt,{id:"stretch",children:[C.jsx(Re,{...n["stretch-horizontal"]}),C.jsx(Re,{...n["stretch-vertical"]})]}),(t||o)&&C.jsxs(Nt,{id:"flip",children:[C.jsx(Re,{...n["flip-horizontal"]}),C.jsx(Re,{...n["flip-vertical"]})]}),C.jsx(rre,{})]}):null}function tre(){const t=jt();return So(3)?C.jsxs(Nt,{id:"distribute",children:[C.jsx(Re,{...t["distribute-horizontal"]}),C.jsx(Re,{...t["distribute-vertical"]})]}):null}function rre(){const t=jt(),o=So(2),n=YM();return o?C.jsxs(Nt,{id:"order",children:[C.jsx(Re,{...t.pack}),n&&C.jsx(Re,{...t["stack-horizontal"]}),n&&C.jsx(Re,{...t["stack-vertical"]})]}):null}function nre(){const t=jt();return So(1)?C.jsx(ws,{id:"reorder",label:"context-menu.reorder",size:"small",children:C.jsxs(Nt,{id:"reorder",children:[C.jsx(Re,{...t["bring-to-front"]}),C.jsx(Re,{...t["bring-forward"]}),C.jsx(Re,{...t["send-backward"]}),C.jsx(Re,{...t["send-to-back"]})]})}):null}function ore(){const t=Ue(),o=He("pages",()=>t.getPages(),[t]),n=He("current page id",()=>t.getCurrentPageId(),[t]),{addToast:r}=Ws(),s=jt(),i=vi();return So(1)?C.jsxs(ws,{id:"move-to-page",label:"context-menu.move-to-page",size:"small",children:[C.jsx(Nt,{id:"pages",children:o.map(l=>C.jsx(Re,{id:l.id,disabled:n===l.id,label:l.name,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.getSelectedShapeIds(),l.id);const c=t.getPage(l.id);c&&r({title:"Changed Page",description:`Moved to ${c.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPage(n)}}]}),i("move-to-page",{source:"context-menu"})}},l.id))}),C.jsx(Nt,{id:"new-page",children:C.jsx(Re,{...s["new-page"]})})]}):null}function m5(){const t=Ue(),o=jt();return He("oneEmbedSelected",()=>{const r=t.getOnlySelectedShape();return r?!!(t.isShapeOfType(r,"embed")&&r.props.url&&!t.isShapeOrAncestorLocked(r)):!1},[t])?C.jsx(Re,{...o["convert-to-bookmark"]}):null}function g5(){const t=Ue(),o=jt();return He("oneEmbeddableBookmarkSelected",()=>{const r=t.getOnlySelectedShape();return r?!!(t.isShapeOfType(r,"bookmark")&&r.props.url&&Ta(r.props.url)&&!t.isShapeOrAncestorLocked(r)):!1},[t])?C.jsx(Re,{...o["convert-to-embed"]}):null}function sre(){const t=jt(),o=Ue(),n=He("isSnapMode",()=>o.user.getIsSnapMode(),[o]);return C.jsx(Ss,{...t["toggle-snap-mode"],checked:n})}function ire(){const t=jt(),o=Ue(),n=He("isToolLock",()=>o.getInstanceState().isToolLocked,[o]);return C.jsx(Ss,{...t["toggle-tool-lock"],checked:n})}function are(){const t=jt(),o=Ue(),n=He("isGridMode",()=>o.getInstanceState().isGridMode,[o]);return C.jsx(Ss,{...t["toggle-grid"],checked:n})}function lre(){const t=jt(),o=Ue(),n=He("isWrapMode",()=>o.user.getIsWrapMode(),[o]);return C.jsx(Ss,{...t["toggle-wrap-mode"],checked:n})}function cre(){const t=jt(),o=Ue(),n=He("isDarkMode",()=>o.user.getIsDarkMode(),[o]);return C.jsx(Ss,{...t["toggle-dark-mode"],checked:n})}function ure(){const t=jt(),o=Ue(),n=He("isFocusMode",()=>o.getInstanceState().isFocusMode,[o]);return C.jsx(Ss,{...t["toggle-focus-mode"],checked:n})}function dre(){const t=jt(),o=Ue(),n=He("edgeScrollSpeed",()=>o.user.getEdgeScrollSpeed(),[o]);return C.jsx(Ss,{...t["toggle-edge-scrolling"],checked:n===1})}function hre(){const t=jt(),o=Ue(),n=He("animationSpeed",()=>o.user.getAnimationSpeed(),[o]);return C.jsx(Ss,{...t["toggle-reduce-motion"],checked:n===0})}function fre(){const t=jt(),o=Ue(),n=He("isDebugMode",()=>o.getInstanceState().isDebugMode,[o]);return C.jsx(Ss,{...t["toggle-debug-mode"],checked:n})}function pre(){const t=Ue();return He("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t])?C.jsxs(C.Fragment,{children:[C.jsxs(Nt,{id:"misc",children:[C.jsx(o5,{}),C.jsx(s5,{}),C.jsx(n5,{}),C.jsx(r5,{}),C.jsx(i5,{}),C.jsx(a5,{}),C.jsx(g5,{}),C.jsx(m5,{}),C.jsx(l5,{})]}),C.jsxs(Nt,{id:"modify",children:[C.jsx(ere,{}),C.jsx(nre,{}),C.jsx(ore,{})]}),C.jsx(h5,{}),C.jsx(f5,{}),C.jsx(Nt,{id:"select-all",children:C.jsx(p5,{})})]}):null}const mre=B.memo(function({children:o}){const n=Ue(),{Canvas:r}=Vr(),s=B.useCallback(u=>{if(u){if(n.getInstanceState().isCoarsePointer){const f=n.getSelectedShapes(),{inputs:{currentPagePoint:h}}=n,d=n.getShapesAtPoint(h);if(!n.getSelectedShapes().length||!d.some(p=>f.includes(p))){const p=d.filter(m=>n.isShapeOrAncestorLocked(m));p.length&&n.select(...p.map(m=>m.id))}}}else{const f=n.getOnlySelectedShape();f&&n.isShapeOrAncestorLocked(f)&&n.setSelectedShapes([])}},[n]),i=to(),[a,l]=nl("context menu",s),c=o??C.jsx(pre,{});return C.jsxs(tte,{dir:"ltr",onOpenChange:l,modal:!1,children:[C.jsx(rte,{onContextMenu:void 0,dir:"ltr",children:r?C.jsx(r,{}):null}),a&&C.jsx(nte,{container:i,children:C.jsx(ote,{className:"tlui-menu scrollable","data-testid":"context-menu",alignOffset:-4,collisionPadding:4,onContextMenu:qt,children:C.jsx(bs,{type:"context-menu",sourceId:"context-menu",children:c})})})]})});function Y1({checked:t}){return C.jsx(Ha,{icon:t?"check":"checkbox-empty",className:"tlui-button__icon",small:!0})}function gre(){const t=Ue(),{addToast:o}=Ws(),{addDialog:n}=nc(),[r,s]=Ut.useState(!1);return C.jsxs(C.Fragment,{children:[C.jsxs(Nt,{id:"items",children:[C.jsx(Re,{id:"add-toast",onSelect:()=>{o({id:Mr(),title:"Something good happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"success"}),o({id:Mr(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"info",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),o({id:Mr(),title:"Something maybe bad happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"warning",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),o({id:Mr(),title:"Something bad happened",severity:"error",keepOpen:!0})},label:"Show toast"}),C.jsx(Re,{id:"show-dialog",label:"Show dialog",onSelect:()=>{n({component:({onClose:i})=>C.jsx(bre,{displayDontShowAgain:!0,onCancel:()=>i(),onContinue:()=>i()}),onClose:()=>{}})}}),C.jsx(Re,{id:"create-shapes",label:"Create 100 shapes",onSelect:()=>xre(t,100)}),C.jsx(Re,{id:"count-nodes",label:"Count shapes / nodes",onSelect:()=>{var l;const i=t.getSelectedShapes(),a=i.length===0?t.getRenderingShapes():i;window.alert(`Shapes ${a.length}, DOM nodes:${(l=document.querySelector(".tl-shapes").querySelectorAll("*"))==null?void 0:l.length}`)}}),(()=>{if(r)throw Error("oh no!");return null})(),C.jsx(Re,{id:"throw-error",onSelect:()=>s(!0),label:"Throw error"}),C.jsx(Re,{id:"hard-reset",onSelect:xI,label:"Hard reset"})]}),C.jsxs(Nt,{id:"flags",children:[C.jsx(yre,{}),C.jsx(vre,{})]})]})}function yre(){const t=Object.values(wn);return t.length?C.jsx(ws,{id:"debug flags",label:"Debug Flags",children:C.jsx(Nt,{id:"debug flags",children:t.map(o=>C.jsx(y5,{flag:o},o.name))})}):null}function vre(){const t=Object.values(Z6);return t.length?C.jsx(ws,{id:"feature flags",label:"Feature Flags",children:C.jsx(Nt,{id:"feature flags",children:t.map(o=>C.jsx(y5,{flag:o},o.name))})}):null}function bre({title:t="title",body:o="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:s=!1,onCancel:i,onContinue:a}){const[l,c]=Ut.useState(!1);return C.jsxs(C.Fragment,{children:[C.jsxs(Cy,{children:[C.jsx(Py,{children:t}),C.jsx(Ty,{})]}),C.jsx(jh,{style:{maxWidth:350},children:o}),C.jsxs(cw,{className:"tlui-dialog__footer__actions",children:[s&&C.jsxs(Mt,{type:"normal",onClick:()=>c(!l),style:{marginRight:"auto"},children:[C.jsx(Y1,{checked:l}),C.jsx(tn,{children:"Don't show again"})]}),C.jsx(Mt,{type:"normal",onClick:i,children:C.jsx(tn,{children:n})}),C.jsx(Mt,{type:"primary",onClick:async()=>a(),children:C.jsx(tn,{children:r})})]})]})}const y5=os(function({flag:o,onChange:n}){const r=o.get();return C.jsx(Ss,{id:o.name,title:o.name,label:o.name.replace(/([a-z0-9])([A-Z])/g,s=>`${s[0]} ${s[1].toLowerCase()}`).replace(/^[a-z]/,s=>s.toUpperCase()),checked:r,onSelect:()=>{o.set(!r),n==null||n(!r)}})});let hC=0;function xre(t,o){const n=Array(o),r=Math.floor(Math.sqrt(o));for(let s=0;s<o;s++)hC++,n[s]={id:hr("box"+hC),type:"geo",x:s%r*132,y:Math.floor(s/r)*132};t.batch(()=>{t.createShapes(n).setSelectedShapes(n.map(s=>s.id))})}function Sre({children:t}){const o=t??C.jsx(gre,{});return C.jsxs(Hl,{id:"debug",children:[C.jsx(Wl,{children:C.jsx(Mt,{type:"icon",title:"Debug menu",children:C.jsx(Zt,{icon:"dots-horizontal"})})}),C.jsx(Yl,{side:"top",align:"end",alignOffset:0,children:C.jsx(bs,{type:"menu",sourceId:"debug-panel",children:o})})]})}const wre=B.memo(function(){const{DebugMenu:o}=il();return C.jsxs("div",{className:"tlui-debug-panel",children:[C.jsx(jre,{}),C.jsx(Ere,{}),o&&C.jsx(o,{})]})});function _re(t=!0){const[o,n]=B.useState(0),r=Ue();B.useEffect(()=>{if(!t)return;const s=()=>n(i=>i+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const jre=os(function(){_re();const o=Ue(),n=o.getPath(),r=o.getHoveredShape(),s=o.getOnlySelectedShape(),i=n==="select.idle"||!n.includes("select.")?r:s,a=i&&n.includes("select.")?` / ${i.type||""}${"geo"in i.props?" / "+i.props.geo:""} / [${Y.ToFixed(o.getPointInShapeSpace(i,o.inputs.currentPagePoint),0)}]`:"",l=n.startsWith("select.")&&!n.includes(".idle")?` / [${Y.ToFixed(o.inputs.originPagePoint,0)}] → [${Y.ToFixed(o.inputs.currentPagePoint,0)}] = ${Y.Dist(o.inputs.originPagePoint,o.inputs.currentPagePoint).toFixed(0)}`:"";return C.jsx("div",{className:"tlui-debug-panel__current-state",children:`${n}${a}${l}`})});function Ere(){const t=He("show_fps",()=>wn.showFps.get(),[wn]),o=B.useRef(null);return B.useEffect(()=>{if(!t)return;const n=250;let r=0,s=!1,i=performance.now(),a=0,l=0,c=!1;function u(){if(!s){if(l++,a=performance.now()-i,a>n){const f=Math.round(l*(n/a)*(1e3/n));f>r&&(r=f);const h=r*.75;(f<h&&!c||f>=h&&c)&&(c=!c),o.current.innerHTML=`FPS ${f.toString()}`,o.current.className="tlui-debug-panel__fps"+(c?" tlui-debug-panel__fps__slow":""),a-=n,l=0,i=performance.now()}requestAnimationFrame(u)}}return u(),()=>{s=!0}},[t]),t?C.jsx("div",{ref:o}):null}function v5(){const t=Ue(),o=vi(),n=He("locale",()=>t.user.getLocale(),[t]);return C.jsx(ws,{id:"help menu language",label:"menu.language",children:C.jsx(Nt,{id:"languages",children:ph.map(({locale:r,label:s})=>C.jsx(Ss,{id:`language-${r}`,title:r,label:s,checked:r===n,onSelect:()=>{t.user.updateUserPreferences({locale:r}),o("change-language",{source:"menu",locale:r})}},r))})})}function Cre(){return C.jsxs(C.Fragment,{children:[C.jsx(v5,{}),C.jsx(Pre,{})]})}function Pre(){const{KeyboardShortcutsDialog:t}=il(),{addDialog:o}=nc();return t?C.jsx(Re,{id:"keyboard-shortcuts-button",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:()=>{o({component:t})}}):null}const Tre=B.memo(function({children:o}){const n=tr(),r=Fo(),s=o??C.jsx(Cre,{});return r<Kr.MOBILE?null:C.jsx("div",{className:"tlui-help-menu",children:C.jsxs(Hl,{id:"help menu",children:[C.jsx(Wl,{children:C.jsx(Mt,{type:"help",title:n("help-menu.title"),"data-testid":"help-menu.button",children:C.jsx(Zt,{icon:"question-mark",small:!0})})}),C.jsx(Yl,{side:"top",align:"end",alignOffset:0,sideOffset:8,children:C.jsx(bs,{type:"menu",sourceId:"help-menu",children:s})})]})})});function kre(){const t=Ue(),o=jt(),[n,r]=B.useState(!1),s=B.useRef(!1);return Fa("toggle showback to content",()=>{const i=s.current,a=t.getCurrentPageShapeIds();let l=!1;a.size&&(l=a.size===t.getCulledShapes().size),i!==l&&(r(l),s.current=l)},[t]),n?C.jsx(Re,{...o["back-to-content"],onSelect:()=>{o["back-to-content"].onSelect("helper-buttons"),r(!1)}}):null}function Ire(){const t=Ue(),o=jt();return He("is pen mode",()=>t.getInstanceState().isPenMode,[t])?C.jsx(Re,{...o["exit-pen-mode"]}):null}function Mre(){const t=Ue(),o=jt();return He("is following user",()=>!!t.getInstanceState().followingUserId,[t])?C.jsx(Re,{...o["stop-following"]}):null}function Ore(){return C.jsxs(C.Fragment,{children:[C.jsx(Ire,{}),C.jsx(kre,{}),C.jsx(Mre,{})]})}function Are({children:t}){const o=t??C.jsx(Ore,{});return C.jsx("div",{className:"tlui-helper-buttons",children:C.jsx(bs,{type:"helper-buttons",sourceId:"helper-buttons",children:o})})}function Rre(){const t=jt(),o=sr();return C.jsxs(C.Fragment,{children:[C.jsxs(Nt,{label:"shortcuts-dialog.tools",id:"tools",children:[C.jsx(Re,{...t["toggle-tool-lock"]}),C.jsx(Re,{...t["insert-media"]}),C.jsx(Re,{...o.select}),C.jsx(Re,{...o.draw}),C.jsx(Re,{...o.eraser}),C.jsx(Re,{...o.hand}),C.jsx(Re,{...o.rectangle}),C.jsx(Re,{...o.ellipse}),C.jsx(Re,{...o.arrow}),C.jsx(Re,{...o.line}),C.jsx(Re,{...o.text}),C.jsx(Re,{...o.frame}),C.jsx(Re,{...o.note}),C.jsx(Re,{...o.laser})]}),C.jsxs(Nt,{label:"shortcuts-dialog.preferences",id:"preferences",children:[C.jsx(Re,{...t["toggle-dark-mode"]}),C.jsx(Re,{...t["toggle-focus-mode"]}),C.jsx(Re,{...t["toggle-grid"]})]}),C.jsxs(Nt,{label:"shortcuts-dialog.edit",id:"edit",children:[C.jsx(Re,{...t.undo}),C.jsx(Re,{...t.redo}),C.jsx(Re,{...t.cut}),C.jsx(Re,{...t.copy}),C.jsx(Re,{...t.paste}),C.jsx(Re,{...t["select-all"]}),C.jsx(Re,{...t.delete}),C.jsx(Re,{...t.duplicate})]}),C.jsxs(Nt,{label:"shortcuts-dialog.view",id:"view",children:[C.jsx(Re,{...t["zoom-in"]}),C.jsx(Re,{...t["zoom-out"]}),C.jsx(Re,{...t["zoom-to-100"]}),C.jsx(Re,{...t["zoom-to-fit"]}),C.jsx(Re,{...t["zoom-to-selection"]})]}),C.jsxs(Nt,{label:"shortcuts-dialog.transform",id:"transform",children:[C.jsx(Re,{...t["bring-to-front"]}),C.jsx(Re,{...t["bring-forward"]}),C.jsx(Re,{...t["send-backward"]}),C.jsx(Re,{...t["send-to-back"]}),C.jsx(Re,{...t.group}),C.jsx(Re,{...t.ungroup}),C.jsx(Re,{...t["flip-horizontal"]}),C.jsx(Re,{...t["flip-vertical"]}),C.jsx(Re,{...t["align-top"]}),C.jsx(Re,{...t["align-center-vertical"]}),C.jsx(Re,{...t["align-bottom"]}),C.jsx(Re,{...t["align-left"]}),C.jsx(Re,{...t["align-center-horizontal"]}),C.jsx(Re,{...t["align-right"]})]})]})}const Dre=B.memo(function({children:o}){const n=tr(),r=Fo(),s=o??C.jsx(Rre,{});return C.jsxs(C.Fragment,{children:[C.jsxs(Cy,{className:"tlui-shortcuts-dialog__header",children:[C.jsx(Py,{children:n("shortcuts-dialog.title")}),C.jsx(Ty,{})]}),C.jsx(jh,{className:Tt("tlui-shortcuts-dialog__body",{"tlui-shortcuts-dialog__body__mobile":r<=Kr.MOBILE_XS,"tlui-shortcuts-dialog__body__tablet":r<=Kr.TABLET}),children:C.jsx(bs,{type:"keyboard-shortcuts",sourceId:"kbd",children:s})}),C.jsx("div",{className:"tlui-dialog__scrim"})]})});function Lre(){return C.jsxs(C.Fragment,{children:[C.jsx(Nre,{}),C.jsx(zre,{}),C.jsx(Fre,{}),C.jsx(Gre,{}),C.jsx(Vre,{})]})}function Fre(){const t=jt();return C.jsxs(ws,{id:"export-all-as",label:"context-menu.export-all-as",size:"small",children:[C.jsxs(Nt,{id:"export-all-as-group",children:[C.jsx(Re,{...t["export-all-as-svg"]}),C.jsx(Re,{...t["export-all-as-png"]}),C.jsx(Re,{...t["export-all-as-json"]})]}),C.jsx(Nt,{id:"export-all-as-bg",children:C.jsx(Iw,{})})]})}function Nre(){const t=Ue(),o=He("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t]);return C.jsxs(ws,{id:"edit",label:"menu.edit",disabled:!o,children:[C.jsx(Bre,{}),C.jsx(h5,{}),C.jsx(f5,{}),C.jsx($re,{}),C.jsx(Ure,{}),C.jsx(Nt,{id:"select-all",children:C.jsx(p5,{})})]})}function $re(){return C.jsxs(Nt,{id:"misc",children:[C.jsx(o5,{}),C.jsx(s5,{}),C.jsx(n5,{}),C.jsx(r5,{}),C.jsx(i5,{}),C.jsx(a5,{}),C.jsx(g5,{}),C.jsx(m5,{})]})}function Ure(){return C.jsxs(Nt,{id:"lock",children:[C.jsx(l5,{}),C.jsx(Xte,{})]})}function Bre(){const t=jt(),o=QM(),n=ZM();return C.jsxs(Nt,{id:"undo-redo",children:[C.jsx(Re,{...t.undo,disabled:!o}),C.jsx(Re,{...t.redo,disabled:!n})]})}function zre(){const t=jt();return C.jsx(ws,{id:"view",label:"menu.view",children:C.jsxs(Nt,{id:"view-actions",children:[C.jsx(Re,{...t["zoom-in"]}),C.jsx(Re,{...t["zoom-out"]}),C.jsx(c5,{}),C.jsx(u5,{}),C.jsx(d5,{})]})})}function Gre(){const t=jt();return C.jsxs(Nt,{id:"extras",children:[C.jsx(Re,{...t["insert-embed"]}),C.jsx(Re,{...t["insert-media"]})]})}function Vre(){return C.jsx(Nt,{id:"preferences",children:C.jsxs(ws,{id:"preferences",label:"menu.preferences",children:[C.jsxs(Nt,{id:"preferences-actions",children:[C.jsx(sre,{}),C.jsx(ire,{}),C.jsx(are,{}),C.jsx(lre,{}),C.jsx(cre,{}),C.jsx(ure,{}),C.jsx(dre,{}),C.jsx(hre,{}),C.jsx(fre,{})]}),C.jsx(Nt,{id:"language",children:C.jsx(v5,{})})]})})}const Hre=B.memo(function({children:o}){const n=to(),[r,s]=nl("main menu"),i=tr(),a=o??C.jsx(Lre,{});return C.jsxs(Pw,{dir:"ltr",open:r,onOpenChange:s,modal:!1,children:[C.jsx(Tw,{asChild:!0,dir:"ltr",children:C.jsx(Mt,{type:"icon","data-testid":"main-menu.button",title:i("menu.title"),children:C.jsx(Zt,{icon:"menu",small:!0})})}),C.jsx(Ly,{container:n,children:C.jsx(kw,{className:"tlui-menu",side:"bottom",align:"start",collisionPadding:4,alignOffset:0,sideOffset:6,children:C.jsx(bs,{type:"menu",sourceId:"main-menu",children:a})})})]})}),Wre=B.memo(function(){const o=Fo(),{MainMenu:n,QuickActions:r,ActionsMenu:s,PageMenu:i}=il();return!n&&!i&&o<6?null:C.jsx("div",{className:"tlui-menu-zone",children:C.jsxs("div",{className:"tlui-buttons__horizontal",children:[n&&C.jsx(n,{}),i&&C.jsx(i,{}),o<6?null:C.jsxs(C.Fragment,{children:[r&&C.jsx(r,{}),s&&C.jsx(s,{})]})]})})}),Cv={};function gd(t){if(Cv[t])return Cv[t];const n=document.createElement("canvas").getContext("2d");n.fillStyle=t,n.fillRect(0,0,1,1);const[r,s,i,a]=n.getImageData(0,0,1,1).data,l=new Float32Array([r/255,s/255,i/255,a/255]);return Cv[t]=l,l}const bm=10,b5=4*6*bm+12+4*12;function Cc(t,{center:o,radius:n,numArcSegments:r=20,startAngle:s=0,endAngle:i=or,offset:a=0}){const l=(i-s)/r;let c=a;for(let u=s;u<i;u+=l)t[c++]=o.x,t[c++]=o.y,t[c++]=o.x+Math.cos(u)*n,t[c++]=o.y+Math.sin(u)*n,t[c++]=o.x+Math.cos(u+l)*n,t[c++]=o.y+Math.sin(u+l)*n;return t}function Pc(t,o,n,r,s,i){t[o++]=n,t[o++]=r,t[o++]=n,t[o++]=r+i,t[o++]=n+s,t[o++]=r,t[o++]=n+s,t[o++]=r,t[o++]=n,t[o++]=r+i,t[o++]=n+s,t[o++]=r+i}function Yre(t,o,n){const r=bm;n=Math.min(n,Math.min(o.w,o.h)/2);const s=mt.ExpandBy(o,-n);if(s.w<=0||s.h<=0)return Cc(t,{center:o.center,radius:n,numArcSegments:bm*4}),bm*4*6;let i=0;return Pc(t,i,s.minX,s.minY,s.w,s.h),i+=12,Pc(t,i,s.minX,o.minY,s.w,n),i+=12,Pc(t,i,s.maxX,s.minY,n,s.h),i+=12,Pc(t,i,s.minX,s.maxY,s.w,n),i+=12,Pc(t,i,o.minX,s.minY,n,s.h),i+=12,Cc(t,{numArcSegments:r,offset:i,center:s.point,radius:n,startAngle:Yt,endAngle:Yt*1.5}),i+=r*6,Cc(t,{numArcSegments:r,offset:i,center:Y.Add(s.point,new Y(s.w,0)),radius:n,startAngle:Yt*1.5,endAngle:or}),i+=r*6,Cc(t,{numArcSegments:r,offset:i,center:Y.Add(s.point,s.size),radius:n,startAngle:0,endAngle:dr}),i+=r*6,Cc(t,{numArcSegments:r,offset:i,center:Y.Add(s.point,new Y(0,s.h)),radius:n,startAngle:dr,endAngle:Yt}),b5}function Xre(t){if(!t)throw new Error("Canvas element not found");const o=t.getContext("webgl2",{premultipliedAlpha:!1});if(!o)throw new Error("Failed to get webgl2 context");const n=`#version 300 es
  precision mediump float;
  
  in vec2 shapeVertexPosition;

	uniform vec4 canvasPageBounds;

	// taken (with thanks) from
	// https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html
  void main() {
		// convert the position from pixels to 0.0 to 1.0
		vec2 zeroToOne = (shapeVertexPosition - canvasPageBounds.xy) / canvasPageBounds.zw;
	
		// convert from 0->1 to 0->2
		vec2 zeroToTwo = zeroToOne * 2.0;
	
		// convert from 0->2 to -1->+1 (clipspace)
		vec2 clipSpace = zeroToTwo - 1.0;
	
		gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }`,r=o.createShader(o.VERTEX_SHADER);if(!r)throw new Error("Failed to create vertex shader");if(o.shaderSource(r,n),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS))throw new Error("Failed to compile vertex shader");const s=`#version 300 es
  precision mediump float;
  
	uniform vec4 fillColor;
  out vec4 outputColor;

  void main() {
	outputColor = fillColor;
  }`,i=o.createShader(o.FRAGMENT_SHADER);if(!i)throw new Error("Failed to create fragment shader");if(o.shaderSource(i,s),o.compileShader(i),!o.getShaderParameter(i,o.COMPILE_STATUS))throw new Error("Failed to compile fragment shader");const a=o.createProgram();if(!a)throw new Error("Failed to create program");if(o.attachShader(a,r),o.attachShader(a,i),o.linkProgram(a),!o.getProgramParameter(a,o.LINK_STATUS))throw new Error("Failed to link program");o.useProgram(a);const l=o.getAttribLocation(a,"shapeVertexPosition");if(l<0)throw new Error("Failed to get shapeVertexPosition attribute location");o.enableVertexAttribArray(l);const c=o.getUniformLocation(a,"canvasPageBounds"),u=o.getUniformLocation(a,"fillColor");if(!o.createBuffer())throw new Error("Failed to create buffer");if(!o.createBuffer())throw new Error("Failed to create buffer");return{context:o,selectedShapes:pp(o,1024),unselectedShapes:pp(o,4096),viewport:pp(o,b5),collaborators:pp(o,1024),prepareTriangles(d,p){o.bindBuffer(o.ARRAY_BUFFER,d.buffer),o.bufferData(o.ARRAY_BUFFER,d.vertices,o.STATIC_DRAW,0,p),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0)},drawTrianglesTransparently(d){o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.drawArrays(o.TRIANGLES,0,d/2),o.disable(o.BLEND)},drawTriangles(d){o.drawArrays(o.TRIANGLES,0,d/2)},setFillColor(d){o.uniform4fv(u,d)},setCanvasPageBounds(d){o.uniform4fv(c,d)}}}function pp(t,o){const n=t.createBuffer();if(!n)throw new Error("Failed to create buffer");return{buffer:n,vertices:new Float32Array(o)}}function fC(t,o,n){let r=t.vertices.length;for(;r<o+n.length;)r*=2;if(r!=t.vertices.length){const s=new Float32Array(r);s.set(t.vertices),t.vertices=s}t.vertices.set(n,o)}var qre=Object.defineProperty,Kre=Object.getOwnPropertyDescriptor,sl=(t,o,n,r)=>{for(var s=r>1?void 0:r?Kre(o,n):o,i=t.length-1,a;i>=0;i--)(a=t[i])&&(s=(r?a(o,n,s):a(s))||s);return r&&s&&qre(o,n,s),s};class ia{constructor(o,n){D(this,"disposables",[]);D(this,"close",()=>this.disposables.forEach(o=>o()));D(this,"gl");D(this,"shapeGeometryCache");D(this,"colors");D(this,"id",Mr());D(this,"canvasBoundingClientRect",po("canvasBoundingClientRect",new mt));D(this,"originPagePoint",new Y);D(this,"originPageCenter",new Y);D(this,"isInViewport",!1);D(this,"getMinimapPagePoint",(o,n)=>{const r=this.getCanvasPageBounds(),s=this.getCanvasScreenBounds();let i=o-s.x,a=n-s.y;return i*=r.width/s.width,a*=r.height/s.height,i+=r.minX,a+=r.minY,new Y(i,a,1)});D(this,"minimapScreenPointToPagePoint",(o,n,r=!1,s=!1)=>{const{editor:i}=this,a=i.getViewportPageBounds();let{x:l,y:c}=this.getMinimapPagePoint(o,n);if(s){const u=this.editor.getCurrentPageBounds()??new mt,f=a,h=u.minX-f.width/2,d=u.maxX+f.width/2,p=u.minY-f.height/2,m=u.maxY+f.height/2,g=Math.max(0,h+f.width-l),b=Math.max(0,-(d-f.width-l)),y=Math.max(0,p+f.height-c),v=Math.max(0,-(m-f.height-c)),x=Math.max(0,g-b),S=Math.max(0,b-g),w=Math.max(0,y-v),E=Math.max(0,v-y);x&&x>S?l+=x/2:S&&(l-=S/2),w&&w>E?c+=w/2:E&&(c-=E/2),l=Ga(l,h,d),c=Ga(c,p,m)}if(r){const{originPagePoint:u}=this,f=Math.abs(l-u.x),h=Math.abs(c-u.y);f>h?c=u.y:l=u.x}return new Y(l,c)});D(this,"render",()=>{const o=this.gl.context,n=this.getCanvasSize();this.gl.setCanvasPageBounds(this.getCanvasPageBoundsArray()),this.elem.width=n.x,this.elem.height=n.y,o.viewport(0,0,n.x,n.y),o.clearColor(this.colors.background[0],this.colors.background[1],this.colors.background[2],1),o.clear(o.COLOR_BUFFER_BIT);const r=new Set(this.editor.getSelectedShapeIds()),s=this.colors;let i=0,a=0;const l=this.editor.getCurrentPageShapeIdsSorted();for(let c=0,u=l.length;c<u;c++){const f=l[c],h=this.shapeGeometryCache.get(f);if(!h)continue;const d=h.length;r.has(f)?(fC(this.gl.selectedShapes,i,h),i+=d):(fC(this.gl.unselectedShapes,a,h),a+=d)}this.drawShapes(this.gl.unselectedShapes,a,s.shapeFill),this.drawShapes(this.gl.selectedShapes,i,s.selectFill),this.drawViewport(),this.drawCollaborators()});this.editor=o,this.elem=n,this.gl=Xre(n),this.shapeGeometryCache=o.store.createComputedCache("webgl-geometry",r=>{const s=o.getShapeMaskedPageBounds(r.id);if(!s)return null;const i=new Float32Array(12);return Pc(i,0,s.x,s.y,s.w,s.h),i}),this.colors=this._getColors(),this.disposables.push(this._listenForCanvasResize(),ku("minimap render",this.render))}_getColors(){const o=getComputedStyle(this.editor.getContainer());return{shapeFill:gd(o.getPropertyValue("--color-text-3").trim()),selectFill:gd(o.getPropertyValue("--color-selected").trim()),viewportFill:gd(o.getPropertyValue("--color-muted-1").trim()),background:gd(o.getPropertyValue("--color-low").trim())}}updateColors(){this.colors=this._getColors()}getDpr(){return this.editor.getInstanceState().devicePixelRatio}getContentPageBounds(){const o=this.editor.getViewportPageBounds(),n=this.editor.getCurrentPageBounds();return n?mt.Expand(n,o):o}getContentScreenBounds(){const o=this.getContentPageBounds(),n=this.editor.pageToScreen(o.point),r=this.editor.pageToScreen(new Y(o.maxX,o.maxY));return new mt(n.x,n.y,r.x-n.x,r.y-n.y)}_getCanvasBoundingRect(){const{x:o,y:n,width:r,height:s}=this.elem.getBoundingClientRect();return new mt(o,n,r,s)}getCanvasScreenBounds(){return this.canvasBoundingClientRect.get()}_listenForCanvasResize(){const o=new ResizeObserver(()=>{const n=this._getCanvasBoundingRect();this.canvasBoundingClientRect.set(n)});return o.observe(this.elem),()=>o.disconnect()}getCanvasSize(){const o=this.canvasBoundingClientRect.get(),n=this.getDpr();return new Y(o.width*n,o.height*n)}getCanvasClientPosition(){return this.canvasBoundingClientRect.get().point}getCanvasPageBounds(){const o=this.getCanvasScreenBounds(),n=this.getContentPageBounds(),r=o.width/o.height;let s=n.width,i=s/r;i<n.height&&(i=n.height,s=i*r);const a=new mt(0,0,s,i);return a.center=n.center,a}getZoom(){return this.getCanvasPageBounds().width/this.getCanvasScreenBounds().width}getCanvasPageBoundsArray(){const{x:o,y:n,w:r,h:s}=this.getCanvasPageBounds();return new Float32Array([o,n,r,s])}drawShapes(o,n,r){this.gl.prepareTriangles(o,n),this.gl.setFillColor(r),this.gl.drawTriangles(n)}drawViewport(){const o=this.editor.getViewportPageBounds(),n=Yre(this.gl.viewport.vertices,o,4*this.getZoom());this.gl.prepareTriangles(this.gl.viewport,n),this.gl.setFillColor(this.colors.viewportFill),this.gl.drawTrianglesTransparently(n)}drawCollaborators(){const o=this.editor.getCollaboratorsOnCurrentPage();if(!o.length)return;const n=20,r=n*6,s=r*o.length;this.gl.collaborators.vertices.length<s&&(this.gl.collaborators.vertices=new Float32Array(s));const i=this.gl.collaborators.vertices;let a=0;const l=this.getZoom();for(const{cursor:c}of o)Cc(i,{center:Y.From(c),radius:3*l,offset:a,numArcSegments:n}),a+=r;this.gl.prepareTriangles(this.gl.collaborators,s),a=0;for(const{color:c}of o)this.gl.setFillColor(gd(c)),this.gl.context.drawArrays(this.gl.context.TRIANGLES,a/2,r/2),a+=r}}sl([Xe],ia.prototype,"getDpr",1);sl([Xe],ia.prototype,"getContentPageBounds",1);sl([Xe],ia.prototype,"getContentScreenBounds",1);sl([Xe],ia.prototype,"getCanvasSize",1);sl([Xe],ia.prototype,"getCanvasClientPosition",1);sl([Xe],ia.prototype,"getCanvasPageBounds",1);sl([Xe],ia.prototype,"getZoom",1);sl([Xe],ia.prototype,"getCanvasPageBoundsArray",1);function Zre(){const t=Ue(),o=B.useRef(null),n=B.useRef(!1),r=B.useRef();B.useEffect(()=>{const u=new ia(t,o.current);return r.current=u,r.current.close},[t]);const s=B.useCallback(u=>{if(!t.getCurrentPageShapeIds().size||!r.current)return;const f=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),h=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);r.current.originPagePoint.setTo(h),r.current.originPageCenter.setTo(t.getViewportPageBounds().center),t.centerOnPoint(f,{duration:ti})},[t]),i=B.useCallback(u=>{if(!r.current)return;const f=u.currentTarget;if(Bh(f,u),!t.getCurrentPageShapeIds().size)return;n.current=!0,r.current.isInViewport=!1;const h=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),d=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0),p=t.getViewportPageBounds();if(r.current.isInViewport=p.containsPoint(d),r.current.isInViewport)r.current.originPagePoint.setTo(d),r.current.originPageCenter.setTo(p.center);else{const g=Y.Sub(p.center,p.point),b=Y.Add(h,g);r.current.originPagePoint.setTo(b),r.current.originPageCenter.setTo(h),t.centerOnPoint(h,{duration:ti})}function m(g){f&&zh(f,g),n.current=!1,document.body.removeEventListener("pointerup",m)}document.body.addEventListener("pointerup",m)},[t]),a=B.useCallback(u=>{if(!r.current)return;const f=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,u.shiftKey,!0);if(n.current){if(r.current.isInViewport){const m=r.current.originPagePoint.clone().sub(r.current.originPageCenter);t.centerOnPoint(Y.Sub(f,m));return}t.centerOnPoint(f)}const h=r.current.getMinimapPagePoint(u.clientX,u.clientY),d=t.pageToScreen(h),p={type:"pointer",target:"canvas",name:"pointer_move",...To(u),point:d,isPen:t.getInstanceState().isPenMode};t.dispatch(p)},[t]),l=B.useCallback(u=>{const f=sI(u);t.dispatch({type:"wheel",name:"wheel",delta:f,point:new Y(u.clientX,u.clientY),shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey})},[t]),c=Wh();return B.useEffect(()=>{setTimeout(()=>{var u,f;(u=r.current)==null||u.updateColors(),(f=r.current)==null||f.render()})},[c]),C.jsx("div",{className:"tlui-minimap",children:C.jsx("canvas",{role:"img","aria-label":"minimap",ref:o,className:"tlui-minimap__canvas",onDoubleClick:s,onPointerMove:a,onPointerDown:i,onWheel:l})})}function Qre(t,o){const[n,r]=Ut.useState(o);Ut.useLayoutEffect(()=>{const i=qx(t);if(i)try{r(JSON.parse(i))}catch{console.error(`Could not restore value ${t} from local storage.`)}},[t]);const s=Ut.useCallback(i=>{r(a=>{const l=typeof i=="function"?i(a):i;return Kx(t,JSON.stringify(l)),l})},[t]);return[n,s]}const Jre=B.memo(function(){const o=jt(),n=tr(),r=Fo(),[s,i]=Qre("minimap",!0),a=B.useCallback(()=>{i(u=>!u)},[i]),{ZoomMenu:l,Minimap:c}=il();return r<Kr.MOBILE?null:C.jsxs("div",{className:"tlui-navigation-panel",children:[C.jsx("div",{className:"tlui-buttons__horizontal",children:l&&r<Kr.TABLET?C.jsx(l,{}):s?C.jsxs(C.Fragment,{children:[l&&C.jsx(l,{}),c&&C.jsx(Mt,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:a,children:C.jsx(Zt,{icon:s?"chevrons-ne":"chevrons-sw"})})]}):C.jsxs(C.Fragment,{children:[C.jsx(Mt,{type:"icon","data-testid":"minimap.zoom-out",title:`${n(Eh(o["zoom-out"].label))} ${W1(o["zoom-out"].kbd)}`,onClick:()=>o["zoom-out"].onSelect("navigation-zone"),children:C.jsx(Zt,{icon:"minus"})}),l&&C.jsx(l,{}),C.jsx(Mt,{type:"icon","data-testid":"minimap.zoom-in",title:`${n(Eh(o["zoom-in"].label))} ${W1(o["zoom-in"].kbd)}`,onClick:()=>o["zoom-in"].onSelect("navigation-zone"),children:C.jsx(Zt,{icon:"plus"})}),c&&C.jsx(Mt,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:a,children:C.jsx(Zt,{icon:s?"chevrons-ne":"chevrons-sw"})})]})}),c&&r>=Kr.TABLET&&!s&&C.jsx(c,{})]})}),ene=function({name:o,id:n,isCurrentPage:r}){const s=Ue(),i=B.useRef(null),a=B.useCallback(c=>{s.renamePage(n,c||"New Page",{ephemeral:!0})},[s,n]),l=B.useCallback(c=>{s.mark("rename page"),s.renamePage(n,c||"New Page",{ephemeral:!1})},[s,n]);return C.jsx(uw,{className:"tlui-page-menu__item__input",ref:c=>i.current=c,defaultValue:o,onValueChange:a,onComplete:l,onCancel:l,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:r,autoselect:!0})},X1=(t,o,n,r)=>{let s;const i=t.getPages(),a=n>r?i[r-1]:i[r],l=n>r?i[r]:i[r+1];a&&!l?s=Ii(a.index):!a&&l?s=ZL(i[0].index):s=Nd(a.index,l.index),s!==i[n].index&&(t.mark("moving page"),t.updatePage({id:o,index:s}))},pC=os(function({index:o,listSize:n,item:r,onRename:s}){const i=Ue(),a=tr(),l=i.getPages(),c=B.useCallback(()=>{i.mark("creating page");const d=Gi.createId();i.duplicatePage(r.id,d)},[i,r]),u=B.useCallback(()=>{X1(i,r.id,o,o-1)},[i,r,o]),f=B.useCallback(()=>{X1(i,r.id,o,o+1)},[i,r,o]),h=B.useCallback(()=>{i.mark("deleting page"),i.deletePage(r.id)},[i,r]);return C.jsxs(Hl,{id:`page item submenu ${o}`,children:[C.jsx(Wl,{children:C.jsx(Mt,{type:"icon",title:a("page-menu.submenu.title"),children:C.jsx(Zt,{icon:"dots-vertical"})})}),C.jsx(Yl,{alignOffset:0,side:"right",sideOffset:-4,children:C.jsxs(bs,{type:"menu",sourceId:"page-menu",children:[C.jsxs(Nt,{id:"modify",children:[s&&C.jsx(Re,{id:"rename",label:"page-menu.submenu.rename",onSelect:s}),C.jsx(Re,{id:"duplicate",label:"page-menu.submenu.duplicate-page",onSelect:c,disabled:l.length>=cg}),o>0&&C.jsx(Re,{id:"move-up",onSelect:u,label:"page-menu.submenu.move-up"}),o<n-1&&C.jsx(Re,{id:"move-down",label:"page-menu.submenu.move-down",onSelect:f})]}),n>1&&C.jsx(Nt,{id:"delete",children:C.jsx(Re,{id:"delete",onSelect:h,label:"page-menu.submenu.delete"})})]})})]})}),tne=B.memo(function(){const o=Ue(),n=tr(),r=Fo(),s=B.useCallback(()=>b(!1),[]),[i,a]=nl("page-menu",s),l=36,c=B.useRef(null),u=He("pages",()=>o.getPages(),[o]),f=He("currentPage",()=>o.getCurrentPage(),[o]),h=He("currentPageId",()=>o.getCurrentPageId(),[o]),d=na(),p=He("maxPageCountReached",()=>o.getPages().length>=cg,[o]),m=He("isCoarsePointer",()=>o.getInstanceState().isCoarsePointer,[o]),[g,b]=B.useState(!1),y=B.useCallback(()=>{d||b(O=>!O)},[d]),v=B.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[x,S]=B.useState(Object.fromEntries(u.map((O,k)=>[O.id,{y:k*l,offsetY:0,isSelected:!1}])));B.useLayoutEffect(()=>{S(Object.fromEntries(u.map((O,k)=>[O.id,{y:k*l,offsetY:0,isSelected:!1}])))},[l,u]),B.useEffect(()=>{i&&requestAnimationFrame(()=>{const O=document.querySelector(`[data-testid="page-menu-item-${h}"]`);if(O){const k=c.current;if(!k)return;const F=O.offsetTop,A=k.scrollTop;F<A&&k.scrollTo({top:F});const N=F+l,$=k.scrollTop+k.offsetHeight;N>$&&k.scrollTo({top:N-k.offsetHeight})}})},[l,h,i]);const w=B.useCallback(O=>{const{clientY:k,currentTarget:F}=O,{dataset:{id:A,index:N}}=F;if(!A||!N)return;const $=v.current;Bh(O.currentTarget,O),$.status="pointing",$.pointing={id:A,index:+N};const X=x[A].y;$.startY=k,$.startIndex=Math.max(0,Math.min(Math.round(X/l),u.length-1))},[l,u.length,x]),E=B.useCallback(O=>{const k=v.current;if(k.status==="pointing"){const{clientY:F}=O,A=F-k.startY;Math.abs(A)>5&&(k.status="dragging")}if(k.status==="dragging"){const{clientY:F}=O,A=F-k.startY,N=x[k.pointing.id],{startIndex:$,pointing:G}=k,X=N.y+A,W=Math.max(0,Math.min(Math.round(X/l),u.length-1)),V={...x};if(V[G.id]={y:N.y,offsetY:A,isSelected:!0},W!==k.dragIndex){k.dragIndex=W;for(let q=0;q<u.length;q++){const J=u[q];if(J.id===k.pointing.id)continue;let{y:ae}=V[J.id];W===$?ae=q*l:W<$?W<=q&&q<$?ae=(q+1)*l:ae=q*l:W>$&&(W>=q&&q>$?ae=(q-1)*l:ae=q*l),ae!==V[J.id].y&&(V[J.id]={y:ae,offsetY:0,isSelected:!0})}}S(V)}},[l,u,x]),j=B.useCallback(O=>{const k=v.current;if(k.status==="dragging"){const{id:F,index:A}=k.pointing;X1(o,F,A,k.dragIndex)}zh(O.currentTarget,O),k.status="idle"},[o]),P=B.useCallback(O=>{const k=v.current;O.key==="Escape"&&(k.status==="dragging"&&S(Object.fromEntries(u.map((F,A)=>[F.id,{y:A*l,offsetY:0,isSelected:!1}]))),k.status="idle")},[l,u]),M=B.useCallback(()=>{d||o.batch(()=>{o.mark("creating page");const O=Gi.createId();o.createPage({name:n("page-menu.new-page-initial-name"),id:O}),o.setCurrentPage(O),b(!0)})},[o,n,d]);return C.jsxs(xw,{id:"pages",onOpenChange:a,open:i,children:[C.jsx(Sw,{"data-testid":"main.page-menu",children:C.jsxs(Mt,{type:"menu",title:f.name,"data-testid":"page-menu.button",className:"tlui-page-menu__trigger",children:[C.jsx("div",{className:"tlui-page-menu__name",children:f.name}),C.jsx(Zt,{icon:"chevron-down",small:!0})]})}),C.jsx(ww,{side:"bottom",align:"start",sideOffset:6,children:C.jsxs("div",{className:"tlui-page-menu__wrapper",children:[C.jsxs("div",{className:"tlui-page-menu__header",children:[C.jsx("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!d&&C.jsxs("div",{className:"tlui-buttons__horizontal",children:[C.jsx(Mt,{type:"icon","data-testid":"page-menu.edit",title:n(g?"page-menu.edit-done":"page-menu.edit-start"),onClick:y,children:C.jsx(Zt,{icon:g?"check":"edit"})}),C.jsx(Mt,{type:"icon","data-testid":"page-menu.create",title:n(p?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:p,onClick:M,children:C.jsx(Zt,{icon:"plus"})})]})]}),C.jsx("div",{"data-testid":"page-menu.list",className:"tlui-page-menu__list tlui-menu__group",style:{height:l*u.length+4},ref:c,children:u.map((O,k)=>{const F=x[O.id]??{position:k*40,offsetY:0};return g?C.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page_menu__item__sortable",style:{zIndex:O.id===f.id?888:k,transform:`translate(0px, ${F.y+F.offsetY}px)`},children:[C.jsx(Mt,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",onPointerDown:w,onPointerUp:j,onPointerMove:E,onKeyDown:P,"data-id":O.id,"data-index":k,children:C.jsx(Zt,{icon:"drag-handle-dots"})}),r<Kr.TABLET_SM&&m?C.jsxs(Mt,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const A=window.prompt("Rename page",O.name);A&&A!==O.name&&o.renamePage(O.id,A)},onDoubleClick:y,children:[C.jsx(Y1,{checked:O.id===f.id}),C.jsx(tn,{children:O.name})]}):C.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:l},children:C.jsx(ene,{id:O.id,name:O.name,isCurrentPage:O.id===f.id})}),!d&&C.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":g,children:C.jsx(pC,{index:k,item:O,listSize:u.length})})]},O.id+"_editing"):C.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page-menu__item",children:[C.jsxs(Mt,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>o.setCurrentPage(O.id),onDoubleClick:y,title:n("page-menu.go-to-page"),children:[C.jsx(Y1,{checked:O.id===f.id}),C.jsx(tn,{children:O.name})]}),!d&&C.jsx("div",{className:"tlui-page_menu__item__submenu",children:C.jsx(pC,{index:k,item:O,listSize:u.length,onRename:()=>{if(o.environment.isIos){const A=window.prompt("Rename page",O.name);A&&A!==O.name&&o.renamePage(O.id,A)}else o.batch(()=>{b(!0),o.setCurrentPage(O.id)})}})})]},O.id)})})]})})]})});function rne(){const t=jt(),o=Ue(),n=QM(),r=ZM(),s=So(1),i=na(),a=He("should display quick actions",()=>o.isInAny("select","hand","zoom"),[o]);if(!(i&&!a))return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t.undo,disabled:!n}),C.jsx(Re,{...t.redo,disabled:!r}),C.jsx(Re,{...t.delete,disabled:!s}),C.jsx(Re,{...t.duplicate,disabled:!s})]})}const nne=B.memo(function({children:o}){const n=o??C.jsx(rne,{});return C.jsx(bs,{type:"small-icons",sourceId:"quick-actions",children:n})}),one=Object.freeze([ts,Fl,yu,ui]);function x5(t=one){const o=Ue();return He("getRelevantStyles",()=>{var i;const n=new o1(o.getSharedStyles()),r=!!((i=o.root.getCurrent())!=null&&i.shapeType),s=o.isIn("select")&&o.getSelectedShapeIds().length>0;if(n.size===0&&o.isIn("select")&&o.getSelectedShapeIds().length===0)for(const a of t)n.applyValue(a,o.getStyleForNextShape(a));return r||s||n.size>0?n:null},[o])}const Fs={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]};function sne(t){const{uiType:o,items:n,title:r,style:s,value:i,onValueChange:a,theme:l}=t,c=Ue(),u=tr(),f=B.useRef(!1),{handleButtonClick:h,handleButtonPointerDown:d,handleButtonPointerEnter:p,handleButtonPointerUp:m}=B.useMemo(()=>{const g=()=>{f.current=!1,window.removeEventListener("pointerup",g)};return{handleButtonClick:S=>{const{id:w}=S.currentTarget.dataset;i.type==="shared"&&i.value===w||(c.mark("point picker item"),a(s,w,!1))},handleButtonPointerDown:S=>{const{id:w}=S.currentTarget.dataset;c.mark("point picker item"),a(s,w,!0),f.current=!0,window.addEventListener("pointerup",g)},handleButtonPointerEnter:S=>{if(!f.current)return;const{id:w}=S.currentTarget.dataset;a(s,w,!0)},handleButtonPointerUp:S=>{const{id:w}=S.currentTarget.dataset;i.type==="shared"&&i.value===w||a(s,w,!1)}}},[i,c,a,s]);return C.jsx("div",{"data-testid":`style.${o}`,className:Tt("tlui-buttons__grid"),children:n.map(g=>C.jsx(Mt,{type:"icon","data-id":g.value,"data-testid":`style.${o}.${g.value}`,"aria-label":g.value,"data-state":i.type==="shared"&&i.value===g.value?"hinted":void 0,title:r+" — "+u(`${o}-style.${g.value}`),className:Tt("tlui-button-grid__button"),style:s===ts?{color:l[g.value].solid}:void 0,onPointerEnter:p,onPointerDown:d,onPointerUp:m,onClick:h,children:C.jsx(Zt,{icon:g.icon})},g.value))})}const Xc=B.memo(sne);function S5(t,[o,n]){return Math.min(n,Math.max(o,t))}function ine(t){const o=B.useRef({value:t,previous:t});return B.useMemo(()=>(o.current.value!==t&&(o.current.previous=o.current.value,o.current.value=t),o.current.previous),[t])}const w5=["PageUp","PageDown"],_5=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],j5={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ef="Slider",[q1,ane,lne]=xy(ef),[E5,Use]=gi(ef,[lne]),[cne,Fy]=E5(ef),une=B.forwardRef((t,o)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[r],value:f,onValueChange:h=()=>{},onValueCommit:d=()=>{},inverted:p=!1,...m}=t,[g,b]=B.useState(null),y=jr(o,N=>b(N)),v=B.useRef(new Set),x=B.useRef(0),S=a==="horizontal",w=g?!!g.closest("form"):!0,E=S?dne:hne,[j=[],P]=rl({prop:f,defaultProp:u,onChange:N=>{var $;($=[...v.current][x.current])===null||$===void 0||$.focus(),h(N)}}),M=B.useRef(j);function O(N){const $=Sne(j,N);A(N,$)}function k(N){A(N,x.current)}function F(){const N=M.current[x.current];j[x.current]!==N&&d(j)}function A(N,$,{commit:G}={commit:!1}){const X=Ene(i),W=Cne(Math.round((N-r)/i)*i+r,X),V=S5(W,[r,s]);P((q=[])=>{const J=bne(q,V,$);if(jne(J,c*i)){x.current=J.indexOf(V);const ae=String(J)!==String(q);return ae&&G&&d(J),ae?J:q}else return q})}return B.createElement(cne,{scope:t.__scopeSlider,disabled:l,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:j,orientation:a},B.createElement(q1.Provider,{scope:t.__scopeSlider},B.createElement(q1.Slot,{scope:t.__scopeSlider},B.createElement(E,ot({"aria-disabled":l,"data-disabled":l?"":void 0},m,{ref:y,onPointerDown:xt(m.onPointerDown,()=>{l||(M.current=j)}),min:r,max:s,inverted:p,onSlideStart:l?void 0:O,onSlideMove:l?void 0:k,onSlideEnd:l?void 0:F,onHomeKeyDown:()=>!l&&A(r,0,{commit:!0}),onEndKeyDown:()=>!l&&A(s,j.length-1,{commit:!0}),onStepKeyDown:({event:N,direction:$})=>{if(!l){const W=w5.includes(N.key)||N.shiftKey&&_5.includes(N.key)?10:1,V=x.current,q=j[V],J=i*W*$;A(q+J,V,{commit:!0})}}})))),w&&j.map((N,$)=>B.createElement(vne,{key:$,name:n?n+(j.length>1?"[]":""):void 0,value:N})))}),[C5,P5]=E5(ef,{startEdge:"left",endEdge:"right",size:"width",direction:1}),dne=B.forwardRef((t,o)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:l,onSlideEnd:c,onStepKeyDown:u,...f}=t,[h,d]=B.useState(null),p=jr(o,x=>d(x)),m=B.useRef(),g=_w(s),b=g==="ltr",y=b&&!i||!b&&i;function v(x){const S=m.current||h.getBoundingClientRect(),w=[0,S.width],j=Mw(w,y?[n,r]:[r,n]);return m.current=S,j(x-S.left)}return B.createElement(C5,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width"},B.createElement(T5,ot({dir:g,"data-orientation":"horizontal"},f,{ref:p,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:x=>{const S=v(x.clientX);a==null||a(S)},onSlideMove:x=>{const S=v(x.clientX);l==null||l(S)},onSlideEnd:()=>{m.current=void 0,c==null||c()},onStepKeyDown:x=>{const w=j5[y?"from-left":"from-right"].includes(x.key);u==null||u({event:x,direction:w?-1:1})}})))}),hne=B.forwardRef((t,o)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,f=B.useRef(null),h=jr(o,f),d=B.useRef(),p=!s;function m(g){const b=d.current||f.current.getBoundingClientRect(),y=[0,b.height],x=Mw(y,p?[r,n]:[n,r]);return d.current=b,x(g-b.top)}return B.createElement(C5,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1},B.createElement(T5,ot({"data-orientation":"vertical"},u,{ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const b=m(g.clientY);i==null||i(b)},onSlideMove:g=>{const b=m(g.clientY);a==null||a(b)},onSlideEnd:()=>{d.current=void 0,l==null||l()},onStepKeyDown:g=>{const y=j5[p?"from-bottom":"from-top"].includes(g.key);c==null||c({event:g,direction:y?-1:1})}})))}),T5=B.forwardRef((t,o)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:l,onStepKeyDown:c,...u}=t,f=Fy(ef,n);return B.createElement(vr.span,ot({},u,{ref:o,onKeyDown:xt(t.onKeyDown,h=>{h.key==="Home"?(a(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):w5.concat(_5).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:xt(t.onPointerDown,h=>{const d=h.target;d.setPointerCapture(h.pointerId),h.preventDefault(),f.thumbs.has(d)?d.focus():r(h)}),onPointerMove:xt(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&s(h)}),onPointerUp:xt(t.onPointerUp,h=>{const d=h.target;d.hasPointerCapture(h.pointerId)&&(d.releasePointerCapture(h.pointerId),i(h))})}))}),fne="SliderTrack",pne=B.forwardRef((t,o)=>{const{__scopeSlider:n,...r}=t,s=Fy(fne,n);return B.createElement(vr.span,ot({"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation},r,{ref:o}))}),mC="SliderRange",mne=B.forwardRef((t,o)=>{const{__scopeSlider:n,...r}=t,s=Fy(mC,n),i=P5(mC,n),a=B.useRef(null),l=jr(o,a),c=s.values.length,u=s.values.map(d=>k5(d,s.min,s.max)),f=c>1?Math.min(...u):0,h=100-Math.max(...u);return B.createElement(vr.span,ot({"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0},r,{ref:l,style:{...t.style,[i.startEdge]:f+"%",[i.endEdge]:h+"%"}}))}),gC="SliderThumb",gne=B.forwardRef((t,o)=>{const n=ane(t.__scopeSlider),[r,s]=B.useState(null),i=jr(o,l=>s(l)),a=B.useMemo(()=>r?n().findIndex(l=>l.ref.current===r):-1,[n,r]);return B.createElement(yne,ot({},t,{ref:i,index:a}))}),yne=B.forwardRef((t,o)=>{const{__scopeSlider:n,index:r,...s}=t,i=Fy(gC,n),a=P5(gC,n),[l,c]=B.useState(null),u=jr(o,b=>c(b)),f=dA(l),h=i.values[r],d=h===void 0?0:k5(h,i.min,i.max),p=xne(r,i.values.length),m=f==null?void 0:f[a.size],g=m?wne(m,d,a.direction):0;return B.useEffect(()=>{if(l)return i.thumbs.add(l),()=>{i.thumbs.delete(l)}},[l,i.thumbs]),B.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${d}% + ${g}px)`}},B.createElement(q1.ItemSlot,{scope:t.__scopeSlider},B.createElement(vr.span,ot({role:"slider","aria-label":t["aria-label"]||p,"aria-valuemin":i.min,"aria-valuenow":h,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0},s,{ref:u,style:h===void 0?{display:"none"}:t.style,onFocus:xt(t.onFocus,()=>{i.valueIndexToChangeRef.current=r})}))))}),vne=t=>{const{value:o,...n}=t,r=B.useRef(null),s=ine(o);return B.useEffect(()=>{const i=r.current,a=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(a,"value").set;if(s!==o&&c){const u=new Event("input",{bubbles:!0});c.call(i,o),i.dispatchEvent(u)}},[s,o]),B.createElement("input",ot({style:{display:"none"}},n,{ref:r,defaultValue:o}))};function bne(t=[],o,n){const r=[...t];return r[n]=o,r.sort((s,i)=>s-i)}function k5(t,o,n){const i=100/(n-o)*(t-o);return S5(i,[0,100])}function xne(t,o){return o>2?`Value ${t+1} of ${o}`:o===2?["Minimum","Maximum"][t]:void 0}function Sne(t,o){if(t.length===1)return 0;const n=t.map(s=>Math.abs(s-o)),r=Math.min(...n);return n.indexOf(r)}function wne(t,o,n){const r=t/2,i=Mw([0,50],[0,r]);return(r-i(o)*n)*n}function _ne(t){return t.slice(0,-1).map((o,n)=>t[n+1]-o)}function jne(t,o){if(o>0){const n=_ne(t);return Math.min(...n)>=o}return!0}function Mw(t,o){return n=>{if(t[0]===t[1]||o[0]===o[1])return o[0];const r=(o[1]-o[0])/(t[1]-t[0]);return o[0]+r*(n-t[0])}}function Ene(t){return(String(t).split(".")[1]||"").length}function Cne(t,o){const n=Math.pow(10,o);return Math.round(t*n)/n}const Pne=une,Tne=pne,kne=mne,Ine=gne,Mne=B.memo(function(o){const{title:n,steps:r,value:s,label:i,onValueChange:a}=o,l=Ue(),c=tr(),u=B.useCallback(d=>{a(d[0],!0)},[a]),f=B.useCallback(()=>{l.mark("click slider")},[l]),h=B.useCallback(()=>{s&&a(s,!1)},[s,a]);return C.jsx("div",{className:"tlui-slider__container",children:C.jsxs(Pne,{"data-testid":o["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:s?[s]:void 0,onPointerDown:f,onValueChange:u,onPointerUp:h,title:n+" — "+c(i),children:[C.jsx(Tne,{className:"tlui-slider__track",dir:"ltr",children:s!==null&&C.jsx(kne,{className:"tlui-slider__range",dir:"ltr"})}),s!==null&&C.jsx(Ine,{className:"tlui-slider__thumb",dir:"ltr"})]})})});function One({label:t,uiTypeA:o,uiTypeB:n,labelA:r,labelB:s,itemsA:i,itemsB:a,styleA:l,styleB:c,valueA:u,valueB:f,onValueChange:h}){const d=tr(),p=B.useMemo(()=>{var g;return((g=i.find(b=>u.type==="shared"&&u.value===b.value))==null?void 0:g.icon)??"mixed"},[i,u]),m=B.useMemo(()=>{var g;return((g=a.find(b=>f.type==="shared"&&f.value===b.value))==null?void 0:g.icon)??"mixed"},[a,f]);return u===void 0&&f===void 0?null:C.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[C.jsx("div",{title:d(t),className:"tlui-style-panel__double-select-picker-label",children:d(t)}),C.jsxs("div",{className:"tlui-buttons__horizontal",children:[C.jsxs(Hl,{id:`style panel ${o} A`,children:[C.jsx(Wl,{children:C.jsx(Mt,{type:"icon","data-testid":`style.${o}`,title:d(r)+" — "+(u===null||u.type==="mixed"?d("style-panel.mixed"):d(`${o}-style.${u.value}`)),children:C.jsx(Zt,{icon:p,small:!0,invertIcon:!0})})}),C.jsx(Yl,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:C.jsx("div",{className:"tlui-buttons__grid",children:i.map((g,b)=>C.jsx(Mh,{"data-testid":`style.${o}.${g.value}`,children:C.jsx(Mt,{type:"icon",onClick:()=>h(l,g.value,!1),title:`${d(r)} — ${d(`${o}-style.${g.value}`)}`,children:C.jsx(Zt,{icon:g.icon,invertIcon:!0})},g.value)},b))})})]}),C.jsxs(Hl,{id:`style panel ${n}`,children:[C.jsx(Wl,{children:C.jsx(Mt,{type:"icon","data-testid":`style.${n}`,title:d(s)+" — "+(f===null||f.type==="mixed"?d("style-panel.mixed"):d(`${n}-style.${f.value}`)),children:C.jsx(Zt,{icon:m,small:!0})})}),C.jsx(Yl,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:C.jsx("div",{className:"tlui-buttons__grid",children:a.map(g=>C.jsx(Mh,{children:C.jsx(Mt,{type:"icon",title:`${d(s)} — ${d(`${n}-style.${g.value}`)}`,"data-testid":`style.${n}.${g.value}`,onClick:()=>h(c,g.value,!1),children:C.jsx(Zt,{icon:g.icon})})},g.value))})})]})]})]})}const Ane=B.memo(One);function Rne({id:t,label:o,uiType:n,style:r,items:s,type:i,value:a,onValueChange:l}){const c=tr(),u=Ue(),f=B.useMemo(()=>{var p;return(p=s.find(m=>a.type==="shared"&&m.value===a.value))==null?void 0:p.icon},[s,a]),h=a.type==="mixed"?c("style-panel.mixed"):c(`${n}-style.${a.value}`),d=o?c(o):"";return C.jsxs(Hl,{id:`style panel ${t}`,children:[C.jsx(Wl,{children:C.jsxs(Mt,{type:i,"data-testid":`style.${n}`,title:h,children:[C.jsx(tn,{children:d}),C.jsx(Zt,{icon:f??"mixed"})]})}),C.jsx(Yl,{side:"left",align:"center",alignOffset:0,children:C.jsx("div",{className:"tlui-buttons__grid",children:s.map(p=>C.jsx(Mh,{children:C.jsx(Mt,{type:"icon","data-testid":`style.${n}.${p.value}`,title:c(`${n}-style.${p.value}`),onClick:()=>{u.mark("select style dropdown item"),l(r,p.value,!1)},children:C.jsx(Zt,{icon:p.icon})})},p.value))})})]})}const Ow=B.memo(Rne);function Dne({styles:t}){const o=Wh();if(!t)return null;const n=t.get(ii),r=t.get(ng),s=t.get(rg),i=t.get(sg),a=t.get(ci),l=n===void 0,c=r===void 0&&s===void 0,u=i===void 0,f=a===void 0,h=ea({isDarkMode:o});return C.jsxs(C.Fragment,{children:[C.jsx(Lne,{theme:h,styles:t}),!f&&C.jsx(Fne,{theme:h,styles:t}),!(l&&c&&u)&&C.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[C.jsx(Nne,{styles:t}),C.jsx(Une,{styles:t}),C.jsx($ne,{styles:t})]})]})}function tf(){const t=Ue(),o=vi();return Ut.useMemo(()=>function(r,s,i){t.batch(()=>{t.isIn("select")&&t.setStyleForSelectedShapes(r,s,{squashing:i}),t.setStyleForNextShapes(r,s,{squashing:i}),t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),o("set-style",{source:"style-panel",id:r.id,value:s})},[t,o])}function Lne({styles:t,theme:o}){const n=tr(),r=Ue(),s=tf(),i=t.get(ts),a=t.get(yu),l=t.get(Fl),c=t.get(ui),u=a!==void 0||l!==void 0||c!==void 0;return C.jsxs(C.Fragment,{children:[C.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles","data-testid":"style.panel",children:[i===void 0?null:C.jsx(Xc,{title:n("style-panel.color"),uiType:"color",style:ts,items:Fs.color,value:i,onValueChange:s,theme:o}),C.jsx(Bne,{})]}),u&&C.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[a===void 0?null:C.jsx(Xc,{title:n("style-panel.fill"),uiType:"fill",style:yu,items:Fs.fill,value:a,onValueChange:s,theme:o}),l===void 0?null:C.jsx(Xc,{title:n("style-panel.dash"),uiType:"dash",style:Fl,items:Fs.dash,value:l,onValueChange:s,theme:o}),c===void 0?null:C.jsx(Xc,{title:n("style-panel.size"),uiType:"size",style:ui,items:Fs.size,value:c,onValueChange:(f,h,d)=>{s(f,h,d);const p=r.getSelectedShapeIds();p.length>0&&xr(r,p)},theme:o})]})]})}function Fne({theme:t,styles:o}){const n=tr(),r=tf(),s=o.get(ci),i=o.get(fh),a=o.get(og);return s===void 0&&i===void 0?null:C.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[s===void 0?null:C.jsx(Xc,{title:n("style-panel.font"),uiType:"font",style:ci,items:Fs.font,value:s,onValueChange:r,theme:t}),i===void 0?null:C.jsxs("div",{className:"tlui-style-panel__row",children:[C.jsx(Xc,{title:n("style-panel.align"),uiType:"align",style:fh,items:Fs.horizontalAlign,value:i,onValueChange:r,theme:t}),C.jsx("div",{className:"tlui-style-panel__row__extra-button",children:a===void 0?C.jsx(Mt,{type:"icon",title:n("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:C.jsx(Zt,{icon:"vertical-align-center"})}):C.jsx(Ow,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:og,items:Fs.verticalAlign,value:a,onValueChange:r})})]})]})}function Nne({styles:t}){const o=tf(),n=t.get(ii);return n===void 0?null:C.jsx(Ow,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:ii,items:Fs.geo,value:n,onValueChange:o})}function $ne({styles:t}){const o=tf(),n=t.get(sg);return n===void 0?null:C.jsx(Ow,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:sg,items:Fs.spline,value:n,onValueChange:o})}function Une({styles:t}){const o=tf(),n=t.get(ng),r=t.get(rg);return!n||!r?null:C.jsx(Ane,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:rg,itemsA:Fs.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:ng,itemsB:Fs.arrowheadEnd,valueB:n,onValueChange:o,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}const yd=[.1,.25,.5,.75,1];function Bne(){const t=Ue(),o=He("opacity",()=>t.getSharedOpacity(),[t]),n=vi(),r=tr(),s=Ut.useCallback((a,l)=>{const c=yd[a];t.batch(()=>{t.isIn("select")&&t.setOpacityForSelectedShapes(c,{squashing:l}),t.setOpacityForNextShapes(c,{squashing:l}),t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),n("set-style",{source:"style-panel",id:"opacity",value:a})},[t,n]);if(o===void 0)return null;const i=o.type==="mixed"?-1:yd.indexOf(GL(yd,a=>Math.abs(a-o.value)));return C.jsx(Mne,{"data-testid":"style.opacity",value:i>=0?i:yd.length-1,label:o.type==="mixed"?"style-panel.mixed":`opacity-style.${o.value}`,onValueChange:s,steps:yd.length-1,title:r("style-panel.opacity")})}const zne=B.memo(function({isMobile:o,children:n}){const r=Ue(),s=x5(),i=B.useCallback(()=>{o||r.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},[r,o]),a=n??C.jsx(Dne,{styles:s});return C.jsx("div",{className:Tt("tlui-style-panel",{"tlui-style-panel__wrapper":!o}),"data-ismobile":o,onPointerLeave:i,children:a})});function Gne(){const t=Ue(),o=tr(),n=x5(),r=n==null?void 0:n.get(ts),s=ea({isDarkMode:t.user.getIsDarkMode()}),i=((r==null?void 0:r.type)==="shared"?s[r.value]:s.black).solid,a=He("disable style panel",()=>t.isInAny("hand","zoom","eraser","laser"),[t]),l=B.useCallback(u=>{u||t.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},[t]),{StylePanel:c}=il();return c?C.jsxs(xw,{id:"mobile style menu",onOpenChange:l,children:[C.jsx(Sw,{children:C.jsx(Mt,{type:"tool","data-testid":"mobile-styles.button",style:{color:a?"var(--color-muted-1)":i},title:o("style-panel.title"),disabled:a,children:C.jsx(Zt,{icon:a?"blob":(r==null?void 0:r.type)==="mixed"?"mixed":"blob"})})}),C.jsx(ww,{side:"top",align:"end",children:c&&C.jsx(c,{isMobile:!0})})]}):null}function Vne(){return C.jsxs(C.Fragment,{children:[C.jsx(Hne,{}),C.jsx(Wne,{}),C.jsx(Yne,{}),C.jsx(Xne,{}),C.jsx(qne,{}),C.jsx(Kne,{}),C.jsx(Zne,{}),C.jsx(Qne,{}),C.jsx(Jne,{}),C.jsx(eoe,{}),C.jsx(toe,{}),C.jsx(roe,{}),C.jsx(noe,{}),C.jsx(ooe,{}),C.jsx(soe,{}),C.jsx(ioe,{}),C.jsx(aoe,{}),C.jsx(loe,{}),C.jsx(coe,{}),C.jsx(uoe,{}),C.jsx(doe,{}),C.jsx(hoe,{}),C.jsx(foe,{}),C.jsx(poe,{}),C.jsx(moe,{}),C.jsx(goe,{}),C.jsx(yoe,{}),C.jsx(voe,{})]})}function fr(t){var r;const o=Ue(),n=(r=t.meta)==null?void 0:r.geo;return He("is tool selected",()=>{const s=o.getCurrentToolId(),i=o.getSharedStyles().getAsKnownValue(ii);return n?s==="geo"&&i===n:s===t.id},[o,t.id,n])}function Hne(){const t=sr(),o=fr(t.select);return C.jsx(Re,{...t.select,isSelected:o})}function Wne(){const t=sr(),o=fr(t.hand);return C.jsx(Re,{...t.hand,isSelected:o})}function Yne(){const t=sr(),o=fr(t.draw);return C.jsx(Re,{...t.draw,isSelected:o})}function Xne(){const t=sr(),o=fr(t.eraser);return C.jsx(Re,{...t.eraser,isSelected:o})}function qne(){const t=sr(),o=fr(t.arrow);return C.jsx(Re,{...t.arrow,isSelected:o})}function Kne(){const t=sr(),o=fr(t.text);return C.jsx(Re,{...t.text,isSelected:o})}function Zne(){const t=sr(),o=fr(t.note);return C.jsx(Re,{...t.note,isSelected:o})}function Qne(){const t=sr(),o=fr(t.asset);return C.jsx(Re,{...t.asset,isSelected:o})}function Jne(){const t=sr(),o=fr(t.rectangle);return C.jsx(Re,{...t.rectangle,isSelected:o})}function eoe(){const t=sr(),o=fr(t.ellipse);return C.jsx(Re,{...t.ellipse,isSelected:o})}function toe(){const t=sr(),o=fr(t.diamond);return C.jsx(Re,{...t.diamond,isSelected:o})}function roe(){const t=sr(),o=fr(t.triangle);return C.jsx(Re,{...t.triangle,isSelected:o})}function noe(){const t=sr(),o=fr(t.trapezoid);return C.jsx(Re,{...t.trapezoid,isSelected:o})}function ooe(){const t=sr(),o=fr(t.rhombus);return C.jsx(Re,{...t.rhombus,isSelected:o})}function soe(){const t=sr(),o=fr(t.hexagon);return C.jsx(Re,{...t.hexagon,isSelected:o})}function ioe(){const t=sr(),o=fr(t.cloud);return C.jsx(Re,{...t.cloud,isSelected:o})}function aoe(){const t=sr(),o=fr(t.star);return C.jsx(Re,{...t.star,isSelected:o})}function loe(){const t=sr(),o=fr(t.oval);return C.jsx(Re,{...t.oval,isSelected:o})}function coe(){const t=sr(),o=fr(t["x-box"]);return C.jsx(Re,{...t["x-box"],isSelected:o})}function uoe(){const t=sr(),o=fr(t["check-box"]);return C.jsx(Re,{...t["check-box"],isSelected:o})}function doe(){const t=sr(),o=fr(t["arrow-left"]);return C.jsx(Re,{...t["arrow-left"],isSelected:o})}function hoe(){const t=sr(),o=fr(t["arrow-up"]);return C.jsx(Re,{...t["arrow-up"],isSelected:o})}function foe(){const t=sr(),o=fr(t["arrow-down"]);return C.jsx(Re,{...t["arrow-down"],isSelected:o})}function poe(){const t=sr(),o=fr(t["arrow-right"]);return C.jsx(Re,{...t["arrow-right"],isSelected:o})}function moe(){const t=sr(),o=fr(t.line);return C.jsx(Re,{...t.line,isSelected:o})}function goe(){const t=sr(),o=fr(t.highlight);return C.jsx(Re,{...t.highlight,isSelected:o})}function yoe(){const t=sr(),o=fr(t.frame);return C.jsx(Re,{...t.frame,isSelected:o})}function voe(){const t=sr(),o=fr(t.laser);return C.jsx(Re,{...t.laser,isSelected:o})}const Pv=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Tv(t,o,n,r){t.addEventListener?t.addEventListener(o,n,r):t.attachEvent&&t.attachEvent("on".concat(o),n)}function vd(t,o,n,r){t.removeEventListener?t.removeEventListener(o,n,r):t.detachEvent&&t.detachEvent("on".concat(o),n)}function I5(t,o){const n=o.slice(0,o.length-1);for(let r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function M5(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const o=t.split(",");let n=o.lastIndexOf("");for(;n>=0;)o[n-1]+=",",o.splice(n,1),n=o.lastIndexOf("");return o}function boe(t,o){const n=t.length>=o.length?t:o,r=t.length>=o.length?o:t;let s=!0;for(let i=0;i<n.length;i++)r.indexOf(n[i])===-1&&(s=!1);return s}const Oh={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Pv?173:189,"=":Pv?61:187,";":Pv?59:186,"'":222,"[":219,"]":221,"\\":220},fi={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},K1={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},kn={16:!1,18:!1,17:!1,91:!1},Br={};for(let t=1;t<20;t++)Oh["f".concat(t)]=111+t;let Sr=[],Wd=null,O5="all";const Ti=new Map,rf=t=>Oh[t.toLowerCase()]||fi[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),xoe=t=>Object.keys(Oh).find(o=>Oh[o]===t),Soe=t=>Object.keys(fi).find(o=>fi[o]===t);function A5(t){O5=t||"all"}function Ah(){return O5||"all"}function woe(){return Sr.slice(0)}function _oe(){return Sr.map(t=>xoe(t)||Soe(t)||String.fromCharCode(t))}function joe(){const t=[];return Object.keys(Br).forEach(o=>{Br[o].forEach(n=>{let{key:r,scope:s,mods:i,shortcut:a}=n;t.push({scope:s,shortcut:a,mods:i,keys:r.split("+").map(l=>rf(l))})})}),t}function Eoe(t){const o=t.target||t.srcElement,{tagName:n}=o;let r=!0;const s=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(o.type);return(o.isContentEditable||(s||n==="TEXTAREA"||n==="SELECT")&&!o.readOnly)&&(r=!1),r}function Coe(t){return typeof t=="string"&&(t=rf(t)),Sr.indexOf(t)!==-1}function Poe(t,o){let n,r;t||(t=Ah());for(const s in Br)if(Object.prototype.hasOwnProperty.call(Br,s))for(n=Br[s],r=0;r<n.length;)n[r].scope===t?n.splice(r,1).forEach(a=>{let{element:l}=a;return Aw(l)}):r++;Ah()===t&&A5(o||"all")}function Toe(t){let o=t.keyCode||t.which||t.charCode;const n=Sr.indexOf(o);if(n>=0&&Sr.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&Sr.splice(0,Sr.length),(o===93||o===224)&&(o=91),o in kn){kn[o]=!1;for(const r in fi)fi[r]===o&&(ko[r]=!1)}}function R5(t){if(typeof t>"u")Object.keys(Br).forEach(s=>{Array.isArray(Br[s])&&Br[s].forEach(i=>mp(i)),delete Br[s]}),Aw(null);else if(Array.isArray(t))t.forEach(s=>{s.key&&mp(s)});else if(typeof t=="object")t.key&&mp(t);else if(typeof t=="string"){for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];let[s,i]=n;typeof s=="function"&&(i=s,s=""),mp({key:t,scope:s,method:i,splitKey:"+"})}}const mp=t=>{let{key:o,scope:n,method:r,splitKey:s="+"}=t;M5(o).forEach(a=>{const l=a.split(s),c=l.length,u=l[c-1],f=u==="*"?"*":rf(u);if(!Br[f])return;n||(n=Ah());const h=c>1?I5(fi,l):[],d=[];Br[f]=Br[f].filter(p=>{const g=(r?p.method===r:!0)&&p.scope===n&&boe(p.mods,h);return g&&d.push(p.element),!g}),d.forEach(p=>Aw(p))})};function yC(t,o,n,r){if(o.element!==r)return;let s;if(o.scope===n||o.scope==="all"){s=o.mods.length>0;for(const i in kn)Object.prototype.hasOwnProperty.call(kn,i)&&(!kn[i]&&o.mods.indexOf(+i)>-1||kn[i]&&o.mods.indexOf(+i)===-1)&&(s=!1);(o.mods.length===0&&!kn[16]&&!kn[18]&&!kn[17]&&!kn[91]||s||o.shortcut==="*")&&(o.keys=[],o.keys=o.keys.concat(Sr),o.method(t,o)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function vC(t,o){const n=Br["*"];let r=t.keyCode||t.which||t.charCode;if(!ko.filter.call(this,t))return;if((r===93||r===224)&&(r=91),Sr.indexOf(r)===-1&&r!==229&&Sr.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(l=>{const c=K1[l];t[l]&&Sr.indexOf(c)===-1?Sr.push(c):!t[l]&&Sr.indexOf(c)>-1?Sr.splice(Sr.indexOf(c),1):l==="metaKey"&&t[l]&&Sr.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(Sr=Sr.slice(Sr.indexOf(c))))}),r in kn){kn[r]=!0;for(const l in fi)fi[l]===r&&(ko[l]=!0);if(!n)return}for(const l in kn)Object.prototype.hasOwnProperty.call(kn,l)&&(kn[l]=t[K1[l]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(Sr.indexOf(17)===-1&&Sr.push(17),Sr.indexOf(18)===-1&&Sr.push(18),kn[17]=!0,kn[18]=!0);const s=Ah();if(n)for(let l=0;l<n.length;l++)n[l].scope===s&&(t.type==="keydown"&&n[l].keydown||t.type==="keyup"&&n[l].keyup)&&yC(t,n[l],s,o);if(!(r in Br))return;const i=Br[r],a=i.length;for(let l=0;l<a;l++)if((t.type==="keydown"&&i[l].keydown||t.type==="keyup"&&i[l].keyup)&&i[l].key){const c=i[l],{splitKey:u}=c,f=c.key.split(u),h=[];for(let d=0;d<f.length;d++)h.push(rf(f[d]));h.sort().join("")===Sr.sort().join("")&&yC(t,c,s,o)}}function ko(t,o,n){Sr=[];const r=M5(t);let s=[],i="all",a=document,l=0,c=!1,u=!0,f="+",h=!1,d=!1;for(n===void 0&&typeof o=="function"&&(n=o),Object.prototype.toString.call(o)==="[object Object]"&&(o.scope&&(i=o.scope),o.element&&(a=o.element),o.keyup&&(c=o.keyup),o.keydown!==void 0&&(u=o.keydown),o.capture!==void 0&&(h=o.capture),typeof o.splitKey=="string"&&(f=o.splitKey),o.single===!0&&(d=!0)),typeof o=="string"&&(i=o),d&&R5(t,i);l<r.length;l++)t=r[l].split(f),s=[],t.length>1&&(s=I5(fi,t)),t=t[t.length-1],t=t==="*"?"*":rf(t),t in Br||(Br[t]=[]),Br[t].push({keyup:c,keydown:u,scope:i,mods:s,shortcut:r[l],method:n,key:r[l],splitKey:f,element:a});if(typeof a<"u"&&window){if(!Ti.has(a)){const p=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return vC(g,a)},m=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;vC(g,a),Toe(g)};Ti.set(a,{keydownListener:p,keyupListenr:m,capture:h}),Tv(a,"keydown",p,h),Tv(a,"keyup",m,h)}if(!Wd){const p=()=>{Sr=[]};Wd={listener:p,capture:h},Tv(window,"focus",p,h)}}}function koe(t){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(Br).forEach(n=>{Br[n].filter(s=>s.scope===o&&s.shortcut===t).forEach(s=>{s&&s.method&&s.method()})})}function Aw(t){const o=Object.values(Br).flat();if(o.findIndex(r=>{let{element:s}=r;return s===t})<0){const{keydownListener:r,keyupListenr:s,capture:i}=Ti.get(t)||{};r&&s&&(vd(t,"keyup",s,i),vd(t,"keydown",r,i),Ti.delete(t))}if((o.length<=0||Ti.size<=0)&&(Object.keys(Ti).forEach(s=>{const{keydownListener:i,keyupListenr:a,capture:l}=Ti.get(s)||{};i&&a&&(vd(s,"keyup",a,l),vd(s,"keydown",i,l),Ti.delete(s))}),Ti.clear(),Object.keys(Br).forEach(s=>delete Br[s]),Wd)){const{listener:s,capture:i}=Wd;vd(window,"focus",s,i),Wd=null}}const kv={getPressedKeyString:_oe,setScope:A5,getScope:Ah,deleteScope:Poe,getPressedKeyCodes:woe,getAllKeyCodes:joe,isPressed:Coe,filter:Eoe,trigger:koe,unbind:R5,keyMap:Oh,modifier:fi,modifierMap:K1};for(const t in kv)Object.prototype.hasOwnProperty.call(kv,t)&&(ko[t]=kv[t]);if(typeof window<"u"){const t=window.hotkeys;ko.noConflict=o=>(o&&window.hotkeys===ko&&(window.hotkeys=t),ko),window.hotkeys=ko}const bC=["copy","cut","paste","asset"];function Ioe(){const t=Ue(),o=na(),n=jt(),r=sr(),s=He("is focused",()=>t.getInstanceState().isFocused,[t]);B.useEffect(()=>{if(!s)return;const i=t.getContainer();ko.setScope(t.store.id);const a=(c,u)=>{ko(c,{element:document.body,scope:t.store.id},u)},l=(c,u)=>{ko(c,{element:document.body,keyup:!0,keydown:!1,scope:t.store.id},u)};for(const c of Object.values(n))c.kbd&&(o&&!c.readonlyOk||bC.includes(c.id)||a(xC(c.kbd),u=>{Td(t)||(qt(u),c.onSelect("kbd"))}));for(const c of Object.values(r))!c.kbd||!c.readonlyOk&&t.getInstanceState().isReadonly||bC.includes(c.id)||a(xC(c.kbd),u=>{Td(t)||(qt(u),c.onSelect("kbd"))});return a(",",c=>{if(Td(t)||t.inputs.keys.has("Comma"))return;qt(c),i.focus(),t.inputs.keys.add("Comma");const{x:u,y:f,z:h}=t.inputs.currentScreenPoint,d={type:"pointer",name:"pointer_down",point:{x:u,y:f,z:h},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(d)}),l(",",c=>{if(Td(t)||!t.inputs.keys.has("Comma"))return;t.inputs.keys.delete("Comma");const{x:u,y:f,z:h}=t.inputs.currentScreenPoint,d={type:"pointer",name:"pointer_up",point:{x:u,y:f,z:h},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(d)}),()=>{ko.deleteScope(t.store.id)}},[n,r,o,t,s])}function xC(t){return Moe(t).map(o=>{let n="";const r=o.split("");return r.length===1?n=r[0]:r[0]==="!"?n=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?n=`alt+shift+${r[2]}`:n=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?n=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?n=`cmd+⌥+${r[2]},ctrl+alt+${r[2]}`:n=`cmd+${r[1]},ctrl+${r[1]}`:n=o,n}).join(",")}function Moe(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const o=t.split(",");let n=o.lastIndexOf("");for(;n>=0;)o[n-1]+=",",o.splice(n,1),n=o.lastIndexOf("");return o}function Td(t){return t.getIsMenuOpen()||t.getEditingShapeId()!==null||t.getCrashingError()}const Ooe=B.createContext(!1);function Aoe({children:t}){const o=Ue(),n=IB(),r=Fo(),s=tr(),i=Math.min(8,5+r),[a,l]=B.useState(0),c=B.useRef(null),[u,f]=B.useState(null),h=B.useMemo(()=>{const p=[],m=[];u?p.push(`[data-value="${u}"]`):p.push(`:nth-child(${i+1})`);for(let g=0;g<i;g++)p.push(`:nth-child(${g+1})`),m.push(`:nth-child(${g+1})`);return`
			#${n}_main > *:not(${p.join(", ")}) {
				display: none;
			}
			${m.map(g=>`#${n}_more > *${g}`).join(", ")} {
				display: none;
			}
        `},[u,n,i]),d=SS(()=>{if(!c.current)return;const p=Array.from(c.current.children);l(p.length),p.findIndex(b=>b.getAttribute("data-value")===u)<=i&&f(null);const g=Array.from(c.current.children).findIndex(b=>b.getAttribute("aria-checked")==="true");g!==-1&&g>=i&&f(p[g].getAttribute("data-value"))});return B.useLayoutEffect(()=>{d()}),B.useLayoutEffect(()=>{if(!c.current)return;const p=new MutationObserver(d);return p.observe(c.current,{childList:!0,subtree:!0,attributeFilter:["data-value","aria-checked"]}),()=>{p.disconnect()}},[d]),B.useEffect(()=>{const p=[["1",0],["2",1],["3",2],["4",3],["5",4],["6",5],["7",6],["8",7],["9",8],["0",9]];for(const[m,g]of p)ko(m,b=>{var x;if(Td(o))return;qt(b);const v=Array.from(((x=c.current)==null?void 0:x.children)??[]).filter(S=>!(S instanceof HTMLElement)||S.tagName.toLowerCase()!=="button"?!1:!!(S.offsetWidth||S.offsetHeight))[g];v&&v.click()});return()=>{ko.unbind("1,2,3,4,5,6,7,8,9,0")}},[o]),C.jsxs(C.Fragment,{children:[C.jsx("style",{children:h}),C.jsxs("div",{className:Tt("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<Kr.TABLET_SM}),role:"radiogroup",children:[C.jsx("div",{id:`${n}_main`,ref:c,className:"tlui-toolbar__tools__list",children:C.jsx(bs,{type:"toolbar",sourceId:"toolbar",children:t})}),a>i&&C.jsx(Ooe.Provider,{value:!0,children:C.jsxs(Hl,{id:"toolbar overflow",modal:!1,children:[C.jsx(Wl,{children:C.jsx(Mt,{title:s("tool-panel.more"),type:"tool",className:"tlui-toolbar__overflow","data-testid":"tools.more-button",children:C.jsx(Zt,{icon:"chevron-up"})})}),C.jsx(Yl,{side:"top",align:"center",children:C.jsx("div",{className:"tlui-buttons__grid","data-testid":"tools.more-content",id:`${n}_more`,children:C.jsx(bs,{type:"toolbar-overflow",sourceId:"toolbar",children:t})})})]})})]})]})}const Roe=["select","hand","draw","eraser","text","zoom","laser","highlight"];function Doe({activeToolId:t}){const o=Ue(),n=Fo(),r=tr(),s=He("is tool locked",()=>o.getInstanceState().isToolLocked,[o]);return!t||Roe.includes(t)?null:C.jsx(Mt,{type:"normal",title:r("action.toggle-tool-lock"),"data-testid":"tool-lock",className:Tt("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<Kr.TABLET_SM}),onClick:()=>o.updateInstanceState({isToolLocked:!s}),children:C.jsx(Zt,{icon:s?"lock":"unlock",small:!0})})}const Loe=B.memo(function({children:o}){const n=Ue(),r=Fo(),s=na(),i=He("current tool id",()=>n.getCurrentToolId(),[n]),{ActionsMenu:a,QuickActions:l}=il();return C.jsx("div",{className:"tlui-toolbar",children:C.jsxs("div",{className:"tlui-toolbar__inner",children:[C.jsxs("div",{className:"tlui-toolbar__left",children:[!s&&C.jsxs("div",{className:"tlui-toolbar__extras",children:[r<Kr.TABLET&&C.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[l&&C.jsx(l,{}),a&&C.jsx(a,{})]}),C.jsx(Doe,{activeToolId:i})]}),C.jsx(Aoe,{children:o??C.jsx(Vne,{})})]}),r<Kr.TABLET_SM&&!s&&C.jsx("div",{className:"tlui-toolbar__tools",children:C.jsx(Gne,{})})]})})});function Foe(){const t=jt();return C.jsxs(C.Fragment,{children:[C.jsx(Re,{...t["zoom-in"],noClose:!0}),C.jsx(Re,{...t["zoom-out"],noClose:!0}),C.jsx(c5,{}),C.jsx(u5,{}),C.jsx(d5,{})]})}const Noe=B.memo(function({children:o}){const n=to(),[r,s]=nl("zoom menu"),i=o??C.jsx(Foe,{});return C.jsxs(Pw,{dir:"ltr",open:r,onOpenChange:s,modal:!1,children:[C.jsx(Tw,{asChild:!0,dir:"ltr",children:C.jsx($oe,{})}),C.jsx(Ly,{container:n,children:C.jsx(kw,{className:"tlui-menu",side:"top",align:"start",alignOffset:0,sideOffset:8,collisionPadding:4,children:C.jsx(bs,{type:"menu",sourceId:"zoom-menu",children:i})})})]})}),$oe=B.forwardRef(function(o,n){const r=Ue(),s=Fo(),i=He("zoom",()=>r.getZoomLevel(),[r]),a=tr(),l=B.useCallback(()=>{r.resetZoom(r.getViewportScreenCenter(),{duration:ti})},[r]);return C.jsx(Mt,{ref:n,...o,type:"icon",title:`${a("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu-button",className:s<Kr.TABLET_SM?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,icon:s<Kr.MOBILE?"zoom-in":void 0,children:s<Kr.MOBILE?null:C.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(i*100),"%"]})})}),D5=B.createContext({});function Uoe({overrides:t={},children:o}){const n=hS(t);return C.jsx(D5.Provider,{value:B.useMemo(()=>({ContextMenu:mre,ActionsMenu:Hte,HelpMenu:Tre,ZoomMenu:Noe,MainMenu:Hre,Minimap:Zre,StylePanel:zne,PageMenu:tne,NavigationPanel:Jre,Toolbar:Loe,KeyboardShortcutsDialog:Dre,QuickActions:nne,HelperButtons:Are,DebugPanel:wre,DebugMenu:Sre,MenuPanel:Wre,...n}),[n]),children:o})}function il(){return B.useContext(D5)}function Boe({overrides:t,components:o,assetUrls:n,onUiEvent:r,forceMobile:s,children:i}){return C.jsx(lq,{assetUrls:qZ(n),children:C.jsx(dq,{overrides:eQ(t),children:C.jsx(DZ,{onEvent:r,children:C.jsx(zZ,{children:C.jsx(LZ,{children:C.jsx(ZZ,{forceMobile:s,children:C.jsx(Uoe,{overrides:o,children:C.jsx(zoe,{overrides:t,children:i})})})})})})})})}function zoe({overrides:t,children:o}){const n=tQ(t);return C.jsx(LQ,{overrides:n.actions,children:C.jsx(KZ,{overrides:n.tools,children:o})})}function Goe(){const t=Ue(),{addToast:o}=Ws();B.useEffect(()=>{function n({name:r,count:s}){o({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${s}). Please delete some shapes or move to a different page to continue.`,severity:"warning"})}return t.addListener("max-shapes",n),()=>{t.removeListener("max-shapes",n)}},[t,o])}const Voe=Ut.memo(function({renderDebugMenuItems:o,children:n,hideUi:r,components:s,...i}){return C.jsx(Boe,{...i,components:s,children:C.jsx(Hoe,{hideUi:r,renderDebugMenuItems:o,children:n})})}),Hoe=Ut.memo(function({children:o,hideUi:n,...r}){return C.jsxs(C.Fragment,{children:[o,n?null:C.jsx(Woe,{...r})]})}),Woe=Ut.memo(function(){const o=Ue(),n=tr(),r=Fo(),s=na(),i=He("focus",()=>o.getInstanceState().isFocusMode,[o]),a=He("debug",()=>o.getInstanceState().isDebugMode,[o]),{SharePanel:l,TopPanel:c,MenuPanel:u,StylePanel:f,Toolbar:h,HelpMenu:d,NavigationPanel:p,HelperButtons:m,DebugPanel:g}=il();Ioe(),EQ(),Goe();const{"toggle-focus-mode":b}=jt();return C.jsx(mO,{children:C.jsxs("div",{className:Tt("tlui-layout",{"tlui-layout__mobile":r<Kr.TABLET_SM}),"data-breakpoint":r,children:[i?C.jsx("div",{className:"tlui-layout__top",children:C.jsx(Mt,{type:"icon",className:"tlui-focus-button",title:n("focus-mode.toggle-focus-mode"),onClick:()=>b.onSelect("menu"),children:C.jsx(Zt,{icon:"dot"})})}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{className:"tlui-layout__top",children:[C.jsxs("div",{className:"tlui-layout__top__left",children:[u&&C.jsx(u,{}),m&&C.jsx(m,{})]}),C.jsx("div",{className:"tlui-layout__top__center",children:c&&C.jsx(c,{})}),C.jsxs("div",{className:"tlui-layout__top__right",children:[l&&C.jsx(l,{}),f&&r>=Kr.TABLET_SM&&!s&&C.jsx(f,{})]})]}),C.jsxs("div",{className:"tlui-layout__bottom",children:[C.jsxs("div",{className:"tlui-layout__bottom__main",children:[p&&C.jsx(p,{}),h&&C.jsx(h,{}),d&&C.jsx(d,{})]}),a&&g&&C.jsx(g,{})]})]}),C.jsx(WZ,{}),C.jsx($Z,{}),C.jsx(YZ,{}),C.jsx(UZ,{})]})})}),gp=(t,o)=>{const[n,r]=B.useState(2);return B.useEffect(()=>{let s=!1;return r(2),jL(t,o).then(()=>{s||r(0)}).catch(i=>{s||(console.error(i),r(1))}),()=>{s=!0}},[t,o]),n};function Yoe(t){return{draw:{url:t.fonts.draw,format:t.fonts.draw.split(".").pop()},serif:{url:t.fonts.serif,format:t.fonts.serif.split(".").pop()},sansSerif:{url:t.fonts.sansSerif,format:t.fonts.sansSerif.split(".").pop()},monospace:{url:t.fonts.monospace,format:t.fonts.monospace.split(".").pop()}}}function L5(t){const o=B.useMemo(()=>Yoe(t),[t]),n=[gp("tldraw_draw",o.draw),gp("tldraw_serif",o.serif),gp("tldraw_sans",o.sansSerif),gp("tldraw_mono",o.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}function Xoe(t){const{children:o,maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:i,onMount:a,components:l={},shapeUtils:c=[],tools:u=[],...f}=t,h=hS(l),d=B.useMemo(()=>({Scribble:Jj,CollaboratorScribble:Jj,SelectionForeground:BW,SelectionBackground:$W,Handles:RW,...h}),[h]),p=r1(c),m=B.useMemo(()=>[...F3,...p],[p]),g=r1(u),b=B.useMemo(()=>[...Lq,...NY,...g],[g]),y=BO(f.assetUrls),{done:v,error:x}=L5(y);return x?C.jsx(XI,{children:"Could not load assets. Please refresh the page."}):v?C.jsx(_B,{initialState:"select",...f,components:d,shapeUtils:m,tools:b,children:C.jsxs(Voe,{...f,components:d,children:[C.jsx(Zoe,{maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:i,onMount:a}),o]})}):C.jsx(YI,{children:"Loading assets..."})}const qoe=Object.freeze(["image/jpeg","image/png","image/gif","image/svg+xml"]),Koe=Object.freeze(["video/mp4","video/quicktime"]);function Zoe({maxImageDimension:t=1e3,maxAssetSize:o=10*1024*1024,acceptedImageMimeTypes:n=qoe,acceptedVideoMimeTypes:r=Koe,onMount:s}){const i=Ue(),a=Ws(),l=tr(),c=SS(h=>{const d=[];return d.push(...xq(h)),SY(h,{maxImageDimension:t,maxAssetSize:o,acceptedImageMimeTypes:n,acceptedVideoMimeTypes:r},{toasts:a,msg:l}),d.push(s==null?void 0:s(h)),()=>{d.forEach(p=>p==null?void 0:p())}});B.useLayoutEffect(()=>{if(i)return c==null?void 0:c(i)},[i,c]);const{Canvas:u}=Vr(),{ContextMenu:f}=il();return f?C.jsx(f,{}):u?C.jsx(u,{}):null}B.memo(function(o){const[n,r]=B.useState(null),[s,i]=B.useState(null),a=r1(o.shapeUtils??[]),l=B.useMemo(()=>[...F3,...a],[a]),c=GI({snapshot:o.snapshot,shapeUtils:l}),u=BO(),{done:f,error:h}=L5(u),{pageId:d,bounds:p,scale:m,background:g,padding:b,darkMode:y,preserveAspectRatio:v,format:x="svg"}=o;return B.useLayoutEffect(()=>{if(!s||!c||!f)return;let S=!1;const w=document.createElement("div");s.appendChild(w),s.classList.add("tl-container","tl-theme__light");const E=new ft({store:c,shapeUtils:l??[],tools:[],getContainer:()=>w});d&&E.setCurrentPage(d);const j=E.getCurrentPageShapeIds();async function P(){const M=await E.getSvgString([...j],{bounds:p,scale:m,background:g,padding:b,darkMode:y,preserveAspectRatio:v});if(M&&!S){if(x==="svg"){if(!S){const O=new Blob([M.svg],{type:"image/svg+xml"}),k=URL.createObjectURL(O);r(k)}}else if(x==="png"){const O=await ZO(M.svg,E.environment.isSafari,{type:x,quality:1,scale:2,width:M.width,height:M.height});if(O&&!S){const k=URL.createObjectURL(O);r(k)}}}E.dispose()}return P(),()=>{S=!0}},[x,s,c,l,d,p,m,g,b,y,v,f,h]),h?C.jsx(XI,{children:"Could not load assets."}):f?C.jsx("div",{ref:i,style:{position:"relative",width:"100%",height:"100%"},children:n&&C.jsx("img",{src:n,style:{width:"100%",height:"100%"}})}):C.jsx(YI,{children:"Loading assets..."})});const Qoe=zt({schemaVersion:Qn(1),storeVersion:Op,recordVersions:Jm(Lt,zt({version:Op,subTypeVersions:Jm(Lt,Op).optional(),subTypeKey:Lt.optional()}))}),Joe=zt({schemaVersion:Qn(2),sequences:Jm(Lt,Op)});zt({tldrawFileFormatVersion:S4,schema:w4("schemaVersion",{1:Qoe,2:Joe}),records:Mn(zt({id:Lt,typeName:Lt}).allowUnknownProperties())});class Rw{constructor(o){D(this,"editor");D(this,"enabled",!1);this.editor=o}}function yp(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var F5={exports:{}};/*! p5.js v1.9.3 April 24, 2024 */(function(t,o){(function(n){t.exports=n()})(function(){var n;return function r(s,i,a){function l(f,h){if(!i[f]){if(!s[f]){var d=typeof yp=="function"&&yp;if(!h&&d)return d(f,!0);if(c)return c(f,!0);throw(h=new Error("Cannot find module '"+f+"'")).code="MODULE_NOT_FOUND",h}d=i[f]={exports:{}},s[f][0].call(d.exports,function(p){return l(s[f][1][p]||p)},d,d.exports,r,s,i,a)}return i[f].exports}for(var c=typeof yp=="function"&&yp,u=0;u<a.length;u++)l(a[u]);return l}({1:[function(r,s,i){i.byteLength=function(g){var g=d(g),m=g[0],g=g[1];return 3*(m+g)/4-g},i.toByteArray=function(p){var m,g,y=d(p),b=y[0],y=y[1],v=new c(function(w,E){return 3*(w+E)/4-E}(b,y)),x=0,S=0<y?b-4:b;for(g=0;g<S;g+=4)m=l[p.charCodeAt(g)]<<18|l[p.charCodeAt(g+1)]<<12|l[p.charCodeAt(g+2)]<<6|l[p.charCodeAt(g+3)],v[x++]=m>>16&255,v[x++]=m>>8&255,v[x++]=255&m;return y===2&&(m=l[p.charCodeAt(g)]<<2|l[p.charCodeAt(g+1)]>>4,v[x++]=255&m),y===1&&(m=l[p.charCodeAt(g)]<<10|l[p.charCodeAt(g+1)]<<4|l[p.charCodeAt(g+2)]>>2,v[x++]=m>>8&255,v[x++]=255&m),v},i.fromByteArray=function(p){for(var m,g=p.length,b=g%3,y=[],v=0,x=g-b;v<x;v+=16383)y.push(function(S,w,E){for(var j,P=[],M=w;M<E;M+=3)j=(S[M]<<16&16711680)+(S[M+1]<<8&65280)+(255&S[M+2]),P.push(function(O){return a[O>>18&63]+a[O>>12&63]+a[O>>6&63]+a[63&O]}(j));return P.join("")}(p,v,x<v+16383?x:v+16383));return b==1?(m=p[g-1],y.push(a[m>>2]+a[m<<4&63]+"==")):b==2&&(m=(p[g-2]<<8)+p[g-1],y.push(a[m>>10]+a[m>>4&63]+a[m<<2&63]+"=")),y.join("")};for(var a=[],l=[],c=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,h=u.length;f<h;++f)a[f]=u[f],l[u.charCodeAt(f)]=f;function d(p){var m=p.length;if(0<m%4)throw new Error("Invalid string. Length must be a multiple of 4");return p=p.indexOf("="),m=(p=p===-1?m:p)===m?0:4-p%4,[p,m]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],2:[function(r,s,i){},{}],3:[function(r,s,i){},{}],4:[function(r,s,i){(function(d){var l=r("base64-js"),c=r("ieee754"),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,f=(i.Buffer=d,i.SlowBuffer=function(I){return+I!=I&&(I=0),d.alloc(+I)},i.INSPECT_MAX_BYTES=50,2147483647);function h(I){if(f<I)throw new RangeError('The value "'+I+'" is invalid for option "size"');return I=new Uint8Array(I),Object.setPrototypeOf(I,d.prototype),I}function d(I,U,z){if(typeof I!="number")return p(I,U,z);if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(I)}function p(I,U,z){if(typeof I=="string"){var K=I,te=U;if(d.isEncoding(te=typeof te=="string"&&te!==""?te:"utf8"))return ne=0|v(K,te),le=h(ne),le=(K=le.write(K,te))!==ne?le.slice(0,K):le;throw new TypeError("Unknown encoding: "+te)}if(ArrayBuffer.isView(I))return b(I);if(I!=null){if(q(I,ArrayBuffer)||I&&q(I.buffer,ArrayBuffer)){var ne=I,K=U,le=z;if(K<0||ne.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(ne.byteLength<K+(le||0))throw new RangeError('"length" is outside of buffer bounds');return ne=K===void 0&&le===void 0?new Uint8Array(ne):le===void 0?new Uint8Array(ne,K):new Uint8Array(ne,K,le),Object.setPrototypeOf(ne,d.prototype),ne}if(typeof I=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');if(te=I.valueOf&&I.valueOf(),te!=null&&te!==I)return d.from(te,U,z);var me=function(ce){{var ge,pe;if(d.isBuffer(ce))return ge=0|y(ce.length),(pe=h(ge)).length!==0&&ce.copy(pe,0,0,ge),pe}if(ce.length!==void 0)return typeof ce.length!="number"||J(ce.length)?h(0):b(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return b(ce.data)}(I);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof I[Symbol.toPrimitive]=="function")return d.from(I[Symbol.toPrimitive]("string"),U,z)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I)}function m(I){if(typeof I!="number")throw new TypeError('"size" argument must be of type number');if(I<0)throw new RangeError('The value "'+I+'" is invalid for option "size"')}function g(I){return m(I),h(I<0?0:0|y(I))}function b(I){for(var U=I.length<0?0:0|y(I.length),z=h(U),K=0;K<U;K+=1)z[K]=255&I[K];return z}function y(I){if(f<=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return 0|I}function v(I,U){if(d.isBuffer(I))return I.length;if(ArrayBuffer.isView(I)||q(I,ArrayBuffer))return I.byteLength;if(typeof I!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof I);var z=I.length,K=2<arguments.length&&arguments[2]===!0;if(!K&&z===0)return 0;for(var te=!1;;)switch(U){case"ascii":case"latin1":case"binary":return z;case"utf8":case"utf-8":return X(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*z;case"hex":return z>>>1;case"base64":return W(I).length;default:if(te)return K?-1:X(I).length;U=(""+U).toLowerCase(),te=!0}}function x(I,U,z){var K,te=!1;if((U=U===void 0||U<0?0:U)>this.length||(z=z===void 0||z>this.length?this.length:z)<=0||(z>>>=0)<=(U>>>=0))return"";for(I=I||"utf8";;)switch(I){case"hex":var ne=this,Se=U,le=z,pe=ne.length;(!le||le<0||pe<le)&&(le=pe);for(var me="",ce=Se=!Se||Se<0?0:Se;ce<le;++ce)me+=ae[ne[ce]];return me;case"utf8":case"utf-8":return M(this,U,z);case"ascii":var ge=this,pe=U,oe=z,de="";oe=Math.min(ge.length,oe);for(var xe=pe;xe<oe;++xe)de+=String.fromCharCode(127&ge[xe]);return de;case"latin1":case"binary":var Te=this,Se=U,je=z,Oe="";je=Math.min(Te.length,je);for(var We=Se;We<je;++We)Oe+=String.fromCharCode(Te[We]);return Oe;case"base64":return Fe=this,K=z,(ut=U)===0&&K===Fe.length?l.fromByteArray(Fe):l.fromByteArray(Fe.slice(ut,K));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var Fe=U,ut=z,tt=this.slice(Fe,ut),rt="",it=0;it<tt.length;it+=2)rt+=String.fromCharCode(tt[it]+256*tt[it+1]);return rt;default:if(te)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),te=!0}}function S(I,U,z){var K=I[U];I[U]=I[z],I[z]=K}function w(I,U,z,K,te){if(I.length===0)return-1;if(typeof z=="string"?(K=z,z=0):2147483647<z?z=2147483647:z<-2147483648&&(z=-2147483648),(z=(z=J(z=+z)?te?0:I.length-1:z)<0?I.length+z:z)>=I.length){if(te)return-1;z=I.length-1}else if(z<0){if(!te)return-1;z=0}if(typeof U=="string"&&(U=d.from(U,K)),d.isBuffer(U))return U.length===0?-1:E(I,U,z,K,te);if(typeof U=="number")return U&=255,typeof Uint8Array.prototype.indexOf=="function"?(te?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(I,U,z):E(I,[U],z,K,te);throw new TypeError("val must be string, number or Buffer")}function E(I,U,z,K,te){var ne=1,le=I.length,me=U.length;if(K!==void 0&&((K=String(K).toLowerCase())==="ucs2"||K==="ucs-2"||K==="utf16le"||K==="utf-16le")){if(I.length<2||U.length<2)return-1;le/=ne=2,me/=2,z/=2}function ce(xe,Te){return ne===1?xe[Te]:xe.readUInt16BE(Te*ne)}if(te)for(var ge=-1,pe=z;pe<le;pe++)if(ce(I,pe)===ce(U,ge===-1?0:pe-ge)){if(pe-(ge=ge===-1?pe:ge)+1===me)return ge*ne}else ge!==-1&&(pe-=pe-ge),ge=-1;else for(pe=z=le<z+me?le-me:z;0<=pe;pe--){for(var oe=!0,de=0;de<me;de++)if(ce(I,pe+de)!==ce(U,de)){oe=!1;break}if(oe)return pe}return-1}function j(I,U,z,K){return V(function(te){for(var ne=[],le=0;le<te.length;++le)ne.push(255&te.charCodeAt(le));return ne}(U),I,z,K)}function P(I,U,z,K){return V(function(te,ne){for(var le,me,ce=[],ge=0;ge<te.length&&!((ne-=2)<0);++ge)me=te.charCodeAt(ge),le=me>>8,me=me%256,ce.push(me),ce.push(le);return ce}(U,I.length-z),I,z,K)}function M(I,U,z){z=Math.min(I.length,z);for(var K=[],te=U;te<z;){var ne,le,me,ce,ge=I[te],pe=null,oe=239<ge?4:223<ge?3:191<ge?2:1;if(te+oe<=z)switch(oe){case 1:ge<128&&(pe=ge);break;case 2:(192&(ne=I[te+1]))==128&&127<(ce=(31&ge)<<6|63&ne)&&(pe=ce);break;case 3:ne=I[te+1],le=I[te+2],(192&ne)==128&&(192&le)==128&&2047<(ce=(15&ge)<<12|(63&ne)<<6|63&le)&&(ce<55296||57343<ce)&&(pe=ce);break;case 4:ne=I[te+1],le=I[te+2],me=I[te+3],(192&ne)==128&&(192&le)==128&&(192&me)==128&&65535<(ce=(15&ge)<<18|(63&ne)<<12|(63&le)<<6|63&me)&&ce<1114112&&(pe=ce)}pe===null?(pe=65533,oe=1):65535<pe&&(pe-=65536,K.push(pe>>>10&1023|55296),pe=56320|1023&pe),K.push(pe),te+=oe}var de=K,xe=de.length;if(xe<=O)return String.fromCharCode.apply(String,de);for(var Te="",Se=0;Se<xe;)Te+=String.fromCharCode.apply(String,de.slice(Se,Se+=O));return Te}i.kMaxLength=f,(d.TYPED_ARRAY_SUPPORT=function(){try{var I=new Uint8Array(1),U={foo:function(){return 42}};return Object.setPrototypeOf(U,Uint8Array.prototype),Object.setPrototypeOf(I,U),I.foo()===42}catch{return!1}}())||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=p,Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(I,U,z){return U=U,z=z,m(I=I),!(I<=0)&&U!==void 0?typeof z=="string"?h(I).fill(U,z):h(I).fill(U):h(I)},d.allocUnsafe=g,d.allocUnsafeSlow=g,d.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==d.prototype},d.compare=function(I,U){if(q(I,Uint8Array)&&(I=d.from(I,I.offset,I.byteLength)),q(U,Uint8Array)&&(U=d.from(U,U.offset,U.byteLength)),!d.isBuffer(I)||!d.isBuffer(U))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===U)return 0;for(var z=I.length,K=U.length,te=0,ne=Math.min(z,K);te<ne;++te)if(I[te]!==U[te]){z=I[te],K=U[te];break}return z<K?-1:K<z?1:0},d.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(I,U){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return d.alloc(0);if(U===void 0)for(te=U=0;te<I.length;++te)U+=I[te].length;for(var z=d.allocUnsafe(U),K=0,te=0;te<I.length;++te){var ne=I[te];if(q(ne,Uint8Array)&&(ne=d.from(ne)),!d.isBuffer(ne))throw new TypeError('"list" argument must be an Array of Buffers');ne.copy(z,K),K+=ne.length}return z},d.byteLength=v,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var I=this.length;if(I%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var U=0;U<I;U+=2)S(this,U,U+1);return this},d.prototype.swap32=function(){var I=this.length;if(I%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var U=0;U<I;U+=4)S(this,U,U+3),S(this,U+1,U+2);return this},d.prototype.swap64=function(){var I=this.length;if(I%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var U=0;U<I;U+=8)S(this,U,U+7),S(this,U+1,U+6),S(this,U+2,U+5),S(this,U+3,U+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?M(this,0,I):x.apply(this,arguments)},d.prototype.equals=function(I){if(d.isBuffer(I))return this===I||d.compare(this,I)===0;throw new TypeError("Argument must be a Buffer")},d.prototype.inspect=function(){var U="",I=i.INSPECT_MAX_BYTES,U=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim();return this.length>I&&(U+=" ... "),"<Buffer "+U+">"},u&&(d.prototype[u]=d.prototype.inspect),d.prototype.compare=function(I,U,z,K,te){if(q(I,Uint8Array)&&(I=d.from(I,I.offset,I.byteLength)),!d.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(z===void 0&&(z=I?I.length:0),K===void 0&&(K=0),te===void 0&&(te=this.length),(U=U===void 0?0:U)<0||z>I.length||K<0||te>this.length)throw new RangeError("out of range index");if(te<=K&&z<=U)return 0;if(te<=K)return-1;if(z<=U)return 1;if(this===I)return 0;for(var ne=(te>>>=0)-(K>>>=0),le=(z>>>=0)-(U>>>=0),me=Math.min(ne,le),ce=this.slice(K,te),ge=I.slice(U,z),pe=0;pe<me;++pe)if(ce[pe]!==ge[pe]){ne=ce[pe],le=ge[pe];break}return ne<le?-1:le<ne?1:0},d.prototype.includes=function(I,U,z){return this.indexOf(I,U,z)!==-1},d.prototype.indexOf=function(I,U,z){return w(this,I,U,z,!0)},d.prototype.lastIndexOf=function(I,U,z){return w(this,I,U,z,!1)},d.prototype.write=function(I,U,z,K){if(U===void 0)K="utf8",z=this.length,U=0;else if(z===void 0&&typeof U=="string")K=U,z=this.length,U=0;else{if(!isFinite(U))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");U>>>=0,isFinite(z)?(z>>>=0,K===void 0&&(K="utf8")):(K=z,z=void 0)}var te=this.length-U;if((z===void 0||te<z)&&(z=te),0<I.length&&(z<0||U<0)||U>this.length)throw new RangeError("Attempt to write outside buffer bounds");K=K||"utf8";for(var ne,le,me,ce=!1;;)switch(K){case"hex":var ge=this,pe=I,oe=U,de=z,xe=(oe=Number(oe)||0,ge.length-oe);(!de||xe<(de=Number(de)))&&(de=xe),(xe=pe.length)/2<de&&(de=xe/2);for(var Te=0;Te<de;++Te){var Se=parseInt(pe.substr(2*Te,2),16);if(J(Se))return Te;ge[oe+Te]=Se}return Te;case"utf8":case"utf-8":return xe=U,me=z,V(X(I,(le=this).length-xe),le,xe,me);case"ascii":return j(this,I,U,z);case"latin1":case"binary":return j(this,I,U,z);case"base64":return le=this,me=U,ne=z,V(W(I),le,me,ne);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,I,U,z);default:if(ce)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase(),ce=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function k(I,U,z){if(I%1!=0||I<0)throw new RangeError("offset is not uint");if(z<I+U)throw new RangeError("Trying to access beyond buffer length")}function F(I,U,z,K,te,ne){if(!d.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(te<U||U<ne)throw new RangeError('"value" argument is out of bounds');if(z+K>I.length)throw new RangeError("Index out of range")}function A(I,U,z,K){if(z+K>I.length)throw new RangeError("Index out of range");if(z<0)throw new RangeError("Index out of range")}function N(I,U,z,K,te){return U=+U,z>>>=0,te||A(I,0,z,4),c.write(I,U,z,K,23,4),z+4}function $(I,U,z,K,te){return U=+U,z>>>=0,te||A(I,0,z,8),c.write(I,U,z,K,52,8),z+8}d.prototype.slice=function(I,U){var z=this.length,z=((I=~~I)<0?(I+=z)<0&&(I=0):z<I&&(I=z),(U=U===void 0?z:~~U)<0?(U+=z)<0&&(U=0):z<U&&(U=z),U<I&&(U=I),this.subarray(I,U));return Object.setPrototypeOf(z,d.prototype),z},d.prototype.readUIntLE=function(I,U,z){I>>>=0,U>>>=0,z||k(I,U,this.length);for(var K=this[I],te=1,ne=0;++ne<U&&(te*=256);)K+=this[I+ne]*te;return K},d.prototype.readUIntBE=function(I,U,z){I>>>=0,U>>>=0,z||k(I,U,this.length);for(var K=this[I+--U],te=1;0<U&&(te*=256);)K+=this[I+--U]*te;return K},d.prototype.readUInt8=function(I,U){return I>>>=0,U||k(I,1,this.length),this[I]},d.prototype.readUInt16LE=function(I,U){return I>>>=0,U||k(I,2,this.length),this[I]|this[I+1]<<8},d.prototype.readUInt16BE=function(I,U){return I>>>=0,U||k(I,2,this.length),this[I]<<8|this[I+1]},d.prototype.readUInt32LE=function(I,U){return I>>>=0,U||k(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+16777216*this[I+3]},d.prototype.readUInt32BE=function(I,U){return I>>>=0,U||k(I,4,this.length),16777216*this[I]+(this[I+1]<<16|this[I+2]<<8|this[I+3])},d.prototype.readIntLE=function(I,U,z){I>>>=0,U>>>=0,z||k(I,U,this.length);for(var K=this[I],te=1,ne=0;++ne<U&&(te*=256);)K+=this[I+ne]*te;return(te*=128)<=K&&(K-=Math.pow(2,8*U)),K},d.prototype.readIntBE=function(I,U,z){I>>>=0,U>>>=0,z||k(I,U,this.length);for(var K=U,te=1,ne=this[I+--K];0<K&&(te*=256);)ne+=this[I+--K]*te;return(te*=128)<=ne&&(ne-=Math.pow(2,8*U)),ne},d.prototype.readInt8=function(I,U){return I>>>=0,U||k(I,1,this.length),128&this[I]?-1*(255-this[I]+1):this[I]},d.prototype.readInt16LE=function(I,U){return I>>>=0,U||k(I,2,this.length),U=this[I]|this[I+1]<<8,32768&U?4294901760|U:U},d.prototype.readInt16BE=function(I,U){return I>>>=0,U||k(I,2,this.length),U=this[I+1]|this[I]<<8,32768&U?4294901760|U:U},d.prototype.readInt32LE=function(I,U){return I>>>=0,U||k(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},d.prototype.readInt32BE=function(I,U){return I>>>=0,U||k(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},d.prototype.readFloatLE=function(I,U){return I>>>=0,U||k(I,4,this.length),c.read(this,I,!0,23,4)},d.prototype.readFloatBE=function(I,U){return I>>>=0,U||k(I,4,this.length),c.read(this,I,!1,23,4)},d.prototype.readDoubleLE=function(I,U){return I>>>=0,U||k(I,8,this.length),c.read(this,I,!0,52,8)},d.prototype.readDoubleBE=function(I,U){return I>>>=0,U||k(I,8,this.length),c.read(this,I,!1,52,8)},d.prototype.writeUIntLE=function(I,U,z,K){I=+I,U>>>=0,z>>>=0,K||F(this,I,U,z,Math.pow(2,8*z)-1,0);var te=1,ne=0;for(this[U]=255&I;++ne<z&&(te*=256);)this[U+ne]=I/te&255;return U+z},d.prototype.writeUIntBE=function(I,U,z,K){I=+I,U>>>=0,z>>>=0,K||F(this,I,U,z,Math.pow(2,8*z)-1,0);var te=z-1,ne=1;for(this[U+te]=255&I;0<=--te&&(ne*=256);)this[U+te]=I/ne&255;return U+z},d.prototype.writeUInt8=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,1,255,0),this[U]=255&I,U+1},d.prototype.writeUInt16LE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,2,65535,0),this[U]=255&I,this[U+1]=I>>>8,U+2},d.prototype.writeUInt16BE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,2,65535,0),this[U]=I>>>8,this[U+1]=255&I,U+2},d.prototype.writeUInt32LE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,4,4294967295,0),this[U+3]=I>>>24,this[U+2]=I>>>16,this[U+1]=I>>>8,this[U]=255&I,U+4},d.prototype.writeUInt32BE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,4,4294967295,0),this[U]=I>>>24,this[U+1]=I>>>16,this[U+2]=I>>>8,this[U+3]=255&I,U+4},d.prototype.writeIntLE=function(I,U,z,K){I=+I,U>>>=0,K||F(this,I,U,z,(K=Math.pow(2,8*z-1))-1,-K);var te=0,ne=1,le=0;for(this[U]=255&I;++te<z&&(ne*=256);)I<0&&le===0&&this[U+te-1]!==0&&(le=1),this[U+te]=(I/ne>>0)-le&255;return U+z},d.prototype.writeIntBE=function(I,U,z,K){I=+I,U>>>=0,K||F(this,I,U,z,(K=Math.pow(2,8*z-1))-1,-K);var te=z-1,ne=1,le=0;for(this[U+te]=255&I;0<=--te&&(ne*=256);)I<0&&le===0&&this[U+te+1]!==0&&(le=1),this[U+te]=(I/ne>>0)-le&255;return U+z},d.prototype.writeInt8=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,1,127,-128),this[U]=255&(I=I<0?255+I+1:I),U+1},d.prototype.writeInt16LE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,2,32767,-32768),this[U]=255&I,this[U+1]=I>>>8,U+2},d.prototype.writeInt16BE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,2,32767,-32768),this[U]=I>>>8,this[U+1]=255&I,U+2},d.prototype.writeInt32LE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,4,2147483647,-2147483648),this[U]=255&I,this[U+1]=I>>>8,this[U+2]=I>>>16,this[U+3]=I>>>24,U+4},d.prototype.writeInt32BE=function(I,U,z){return I=+I,U>>>=0,z||F(this,I,U,4,2147483647,-2147483648),this[U]=(I=I<0?4294967295+I+1:I)>>>24,this[U+1]=I>>>16,this[U+2]=I>>>8,this[U+3]=255&I,U+4},d.prototype.writeFloatLE=function(I,U,z){return N(this,I,U,!0,z)},d.prototype.writeFloatBE=function(I,U,z){return N(this,I,U,!1,z)},d.prototype.writeDoubleLE=function(I,U,z){return $(this,I,U,!0,z)},d.prototype.writeDoubleBE=function(I,U,z){return $(this,I,U,!1,z)},d.prototype.copy=function(I,U,z,K){if(!d.isBuffer(I))throw new TypeError("argument should be a Buffer");if(z=z||0,K||K===0||(K=this.length),U>=I.length&&(U=I.length),(K=0<K&&K<z?z:K)===z||I.length===0||this.length===0)return 0;if((U=U||0)<0)throw new RangeError("targetStart out of bounds");if(z<0||z>=this.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);var te=(K=I.length-U<K-z?I.length-U+z:K)-z;if(this===I&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(U,z,K);else if(this===I&&z<U&&U<K)for(var ne=te-1;0<=ne;--ne)I[ne+U]=this[ne+z];else Uint8Array.prototype.set.call(I,this.subarray(z,K),U);return te},d.prototype.fill=function(I,U,z,K){if(typeof I=="string"){if(typeof U=="string"?(K=U,U=0,z=this.length):typeof z=="string"&&(K=z,z=this.length),K!==void 0&&typeof K!="string")throw new TypeError("encoding must be a string");if(typeof K=="string"&&!d.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var te;I.length===1&&(te=I.charCodeAt(0),(K==="utf8"&&te<128||K==="latin1")&&(I=te))}else typeof I=="number"?I&=255:typeof I=="boolean"&&(I=Number(I));if(U<0||this.length<U||this.length<z)throw new RangeError("Out of range index");var ne;if(!(z<=U))if(U>>>=0,z=z===void 0?this.length:z>>>0,typeof(I=I||0)=="number")for(ne=U;ne<z;++ne)this[ne]=I;else{var le=d.isBuffer(I)?I:d.from(I,K),me=le.length;if(me===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(ne=0;ne<z-U;++ne)this[ne+U]=le[ne%me]}return this};var G=/[^+/0-9A-Za-z-_]/g;function X(I,U){U=U||1/0;for(var z,K=I.length,te=null,ne=[],le=0;le<K;++le){if(55295<(z=I.charCodeAt(le))&&z<57344){if(!te){if(56319<z){-1<(U-=3)&&ne.push(239,191,189);continue}if(le+1===K){-1<(U-=3)&&ne.push(239,191,189);continue}te=z;continue}if(z<56320){-1<(U-=3)&&ne.push(239,191,189),te=z;continue}z=65536+(te-55296<<10|z-56320)}else te&&-1<(U-=3)&&ne.push(239,191,189);if(te=null,z<128){if(--U<0)break;ne.push(z)}else if(z<2048){if((U-=2)<0)break;ne.push(z>>6|192,63&z|128)}else if(z<65536){if((U-=3)<0)break;ne.push(z>>12|224,z>>6&63|128,63&z|128)}else{if(!(z<1114112))throw new Error("Invalid code point");if((U-=4)<0)break;ne.push(z>>18|240,z>>12&63|128,z>>6&63|128,63&z|128)}}return ne}function W(I){return l.toByteArray(function(U){if((U=(U=U.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;U.length%4!=0;)U+="=";return U}(I))}function V(I,U,z,K){for(var te=0;te<K&&!(te+z>=U.length||te>=I.length);++te)U[te+z]=I[te];return te}function q(I,U){return I instanceof U||I!=null&&I.constructor!=null&&I.constructor.name!=null&&I.constructor.name===U.name}function J(I){return I!=I}var ae=function(){for(var I="0123456789abcdef",U=new Array(256),z=0;z<16;++z)for(var K=16*z,te=0;te<16;++te)U[K+te]=I[z]+I[te];return U}()}).call(this,r("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:251}],5:[function(r,s,i){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},{}],6:[function(r,s,i){var a=r("../internals/is-object");s.exports=function(l){if(a(l)||l===null)return l;throw TypeError("Can't set "+String(l)+" as a prototype")}},{"../internals/is-object":75}],7:[function(c,s,i){var a=c("../internals/well-known-symbol"),l=c("../internals/object-create"),c=c("../internals/object-define-property"),u=a("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},{"../internals/object-create":91,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],8:[function(r,s,i){var a=r("../internals/string-multibyte").charAt;s.exports=function(l,c,u){return c+(u?a(l,c).length:1)}},{"../internals/string-multibyte":124}],9:[function(r,s,i){s.exports=function(a,l,c){if(a instanceof l)return a;throw TypeError("Incorrect "+(c?c+" ":"")+"invocation")}},{}],10:[function(r,s,i){var a=r("../internals/is-object");s.exports=function(l){if(a(l))return l;throw TypeError(String(l)+" is not an object")}},{"../internals/is-object":75}],11:[function(r,s,i){s.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},{}],12:[function(A,s,i){function a($){return h($)&&d(N,p($))}var l,c=A("../internals/array-buffer-native"),u=A("../internals/descriptors"),f=A("../internals/global"),h=A("../internals/is-object"),d=A("../internals/has"),p=A("../internals/classof"),m=A("../internals/create-non-enumerable-property"),g=A("../internals/redefine"),b=A("../internals/object-define-property").f,y=A("../internals/object-get-prototype-of"),v=A("../internals/object-set-prototype-of"),O=A("../internals/well-known-symbol"),A=A("../internals/uid"),x=f.Int8Array,S=x&&x.prototype,w=f.Uint8ClampedArray,w=w&&w.prototype,E=x&&y(x),j=S&&y(S),P=Object.prototype,M=P.isPrototypeOf,O=O("toStringTag"),k=A("TYPED_ARRAY_TAG"),F=c&&!!v&&p(f.opera)!=="Opera",A=!1,N={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(l in N)f[l]||(F=!1);if((!F||typeof E!="function"||E===Function.prototype)&&(E=function(){throw TypeError("Incorrect invocation")},F))for(l in N)f[l]&&v(f[l],E);if((!F||!j||j===P)&&(j=E.prototype,F))for(l in N)f[l]&&v(f[l].prototype,j);if(F&&y(w)!==j&&v(w,j),u&&!d(j,O))for(l in A=!0,b(j,O,{get:function(){return h(this)?this[k]:void 0}}),N)f[l]&&m(f[l],k,l);s.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_TAG:A&&k,aTypedArray:function($){if(a($))return $;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function($){if(v){if(M.call(E,$))return $}else for(var G in N)if(d(N,l)&&(G=f[G],G&&($===G||M.call(G,$))))return $;throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function($,G,X){if(u){if(X)for(var W in N)W=f[W],W&&d(W.prototype,$)&&delete W.prototype[$];j[$]&&!X||g(j,$,!X&&F&&S[$]||G)}},exportTypedArrayStaticMethod:function($,G,X){var W,V;if(u){if(v){if(X)for(W in N)(V=f[W])&&d(V,$)&&delete V[$];if(E[$]&&!X)return;try{return g(E,$,!X&&F&&x[$]||G)}catch{}}for(W in N)!(V=f[W])||V[$]&&!X||g(V,$,G)}},isView:function($){return $=p($),$==="DataView"||d(N,$)},isTypedArray:a,TypedArray:E,TypedArrayPrototype:j}},{"../internals/array-buffer-native":11,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/global":60,"../internals/has":61,"../internals/is-object":75,"../internals/object-define-property":93,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine":109,"../internals/uid":146,"../internals/well-known-symbol":149}],13:[function(z,s,i){function a(oe){return[255&oe]}function l(oe){return[255&oe,oe>>8&255]}function c(oe){return[255&oe,oe>>8&255,oe>>16&255,oe>>24&255]}function u(oe){return oe[3]<<24|oe[2]<<16|oe[1]<<8|oe[0]}function f(oe){return ne(oe,23,4)}function h(oe){return ne(oe,52,8)}function d(oe,de){A(oe[q],de,{get:function(){return G(this)[de]}})}function p(Oe,de,je,Te){if(je=P(je),Oe=G(Oe),je+de>Oe.byteLength)throw te(J);var Se=G(Oe.buffer).bytes,je=je+Oe.byteOffset,Oe=Se.slice(je,je+de);return Te?Oe:Oe.reverse()}function m(oe,de,xe,Te,Se,je){if(xe=P(xe),oe=G(oe),xe+de>oe.byteLength)throw te(J);for(var Oe=G(oe.buffer).bytes,We=xe+oe.byteOffset,Fe=Te(+Se),ut=0;ut<de;ut++)Oe[We+ut]=Fe[je?ut:de-ut-1]}var g=z("../internals/global"),b=z("../internals/descriptors"),y=z("../internals/array-buffer-native"),v=z("../internals/create-non-enumerable-property"),x=z("../internals/redefine-all"),S=z("../internals/fails"),w=z("../internals/an-instance"),E=z("../internals/to-integer"),j=z("../internals/to-length"),P=z("../internals/to-index"),M=z("../internals/ieee754"),O=z("../internals/object-get-prototype-of"),k=z("../internals/object-set-prototype-of"),F=z("../internals/object-get-own-property-names").f,A=z("../internals/object-define-property").f,N=z("../internals/array-fill"),$=z("../internals/set-to-string-tag"),z=z("../internals/internal-state"),G=z.get,X=z.set,W="ArrayBuffer",V="DataView",q="prototype",J="Wrong index",ae=g[W],I=ae,U=g[V],z=U&&U[q],K=Object.prototype,te=g.RangeError,ne=M.pack,le=M.unpack;if(y){if(!S(function(){ae(1)})||!S(function(){new ae(-1)})||S(function(){return new ae,new ae(1.5),new ae(NaN),ae.name!=W})){for(var me,g=(I=function(xe){return w(this,I),new ae(P(xe))})[q]=ae[q],ce=F(ae),ge=0;ce.length>ge;)(me=ce[ge++])in I||v(I,me,ae[me]);g.constructor=I}k&&O(z)!==K&&k(z,K);var M=new U(new I(2)),pe=z.setInt8;M.setInt8(0,2147483648),M.setInt8(1,2147483649),!M.getInt8(0)&&M.getInt8(1)||x(z,{setInt8:function(de,xe){pe.call(this,de,xe<<24>>24)},setUint8:function(de,xe){pe.call(this,de,xe<<24>>24)}},{unsafe:!0})}else I=function(oe){w(this,I,W),oe=P(oe),X(this,{bytes:N.call(new Array(oe),0),byteLength:oe}),b||(this.byteLength=oe)},U=function(oe,Se,xe){w(this,U,V),w(oe,I,V);var Te=G(oe).byteLength,Se=E(Se);if(Se<0||Te<Se)throw te("Wrong offset");if(Te<Se+(xe=xe===void 0?Te-Se:j(xe)))throw te("Wrong length");X(this,{buffer:oe,byteLength:xe,byteOffset:Se}),b||(this.buffer=oe,this.byteLength=xe,this.byteOffset=Se)},b&&(d(I,"byteLength"),d(U,"buffer"),d(U,"byteLength"),d(U,"byteOffset")),x(U[q],{getInt8:function(oe){return p(this,1,oe)[0]<<24>>24},getUint8:function(oe){return p(this,1,oe)[0]},getInt16:function(oe){return oe=p(this,2,oe,1<arguments.length?arguments[1]:void 0),(oe[1]<<8|oe[0])<<16>>16},getUint16:function(oe){return oe=p(this,2,oe,1<arguments.length?arguments[1]:void 0),oe[1]<<8|oe[0]},getInt32:function(oe){return u(p(this,4,oe,1<arguments.length?arguments[1]:void 0))},getUint32:function(oe){return u(p(this,4,oe,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(oe){return le(p(this,4,oe,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(oe){return le(p(this,8,oe,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(oe,de){m(this,1,oe,a,de)},setUint8:function(oe,de){m(this,1,oe,a,de)},setInt16:function(oe,de){m(this,2,oe,l,de,2<arguments.length?arguments[2]:void 0)},setUint16:function(oe,de){m(this,2,oe,l,de,2<arguments.length?arguments[2]:void 0)},setInt32:function(oe,de){m(this,4,oe,c,de,2<arguments.length?arguments[2]:void 0)},setUint32:function(oe,de){m(this,4,oe,c,de,2<arguments.length?arguments[2]:void 0)},setFloat32:function(oe,de){m(this,4,oe,f,de,2<arguments.length?arguments[2]:void 0)},setFloat64:function(oe,de){m(this,8,oe,h,de,2<arguments.length?arguments[2]:void 0)}});$(I,W),$(U,V),s.exports={ArrayBuffer:I,DataView:U}},{"../internals/an-instance":9,"../internals/array-buffer-native":11,"../internals/array-fill":15,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/ieee754":66,"../internals/internal-state":71,"../internals/object-define-property":93,"../internals/object-get-own-property-names":96,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine-all":108,"../internals/set-to-string-tag":118,"../internals/to-index":134,"../internals/to-integer":136,"../internals/to-length":137}],14:[function(r,s,i){var a=r("../internals/to-object"),l=r("../internals/to-absolute-index"),c=r("../internals/to-length"),u=Math.min;s.exports=[].copyWithin||function(b,h){var d=a(this),p=c(d.length),m=l(b,p),g=l(h,p),b=2<arguments.length?arguments[2]:void 0,y=u((b===void 0?p:l(b,p))-g,p-m),v=1;for(g<m&&m<g+y&&(v=-1,g+=y-1,m+=y-1);0<y--;)g in d?d[m]=d[g]:delete d[m],m+=v,g+=v;return d}},{"../internals/to-absolute-index":133,"../internals/to-length":137,"../internals/to-object":138}],15:[function(r,s,i){var a=r("../internals/to-object"),l=r("../internals/to-absolute-index"),c=r("../internals/to-length");s.exports=function(u){for(var f=a(this),h=c(f.length),p=arguments.length,d=l(1<p?arguments[1]:void 0,h),p=2<p?arguments[2]:void 0,m=p===void 0?h:l(p,h);d<m;)f[d++]=u;return f}},{"../internals/to-absolute-index":133,"../internals/to-length":137,"../internals/to-object":138}],16:[function(c,s,i){var a=c("../internals/array-iteration").forEach,l=c("../internals/array-method-is-strict"),c=c("../internals/array-method-uses-to-length"),l=l("forEach"),c=c("forEach");s.exports=l&&c?[].forEach:function(u){return a(this,u,1<arguments.length?arguments[1]:void 0)}},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23}],17:[function(r,s,i){var a=r("../internals/function-bind-context"),l=r("../internals/to-object"),c=r("../internals/call-with-safe-iteration-closing"),u=r("../internals/is-array-iterator-method"),f=r("../internals/to-length"),h=r("../internals/create-property"),d=r("../internals/get-iterator-method");s.exports=function(w){var m,g,b,y,v,x,S=l(w),w=typeof this=="function"?this:Array,E=arguments.length,j=1<E?arguments[1]:void 0,P=j!==void 0,M=d(S),O=0;if(P&&(j=a(j,2<E?arguments[2]:void 0,2)),M==null||w==Array&&u(M))for(g=new w(m=f(S.length));O<m;O++)x=P?j(S[O],O):S[O],h(g,O,x);else for(v=(y=M.call(S)).next,g=new w;!(b=v.call(y)).done;O++)x=P?c(y,j,[b.value,O],!0):b.value,h(g,O,x);return g.length=O,g}},{"../internals/call-with-safe-iteration-closing":26,"../internals/create-property":40,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137,"../internals/to-object":138}],18:[function(r,s,i){function a(f){return function(h,d,p){var m,g=l(h),b=c(g.length),y=u(p,b);if(f&&d!=d){for(;y<b;)if((m=g[y++])!=m)return!0}else for(;y<b;y++)if((f||y in g)&&g[y]===d)return f||y||0;return!f&&-1}}var l=r("../internals/to-indexed-object"),c=r("../internals/to-length"),u=r("../internals/to-absolute-index");s.exports={includes:a(!0),indexOf:a(!1)}},{"../internals/to-absolute-index":133,"../internals/to-indexed-object":135,"../internals/to-length":137}],19:[function(r,s,i){function a(p){var m=p==1,g=p==2,b=p==3,y=p==4,v=p==6,x=p==5||v;return function(S,w,E,j){for(var P,M,O=u(S),k=c(O),F=l(w,E,3),A=f(k.length),N=0,w=j||h,$=m?w(S,A):g?w(S,0):void 0;N<A;N++)if((x||N in k)&&(M=F(P=k[N],N,O),p)){if(m)$[N]=M;else if(M)switch(p){case 3:return!0;case 5:return P;case 6:return N;case 2:d.call($,P)}else if(y)return!1}return v?-1:b||y?y:$}}var l=r("../internals/function-bind-context"),c=r("../internals/indexed-object"),u=r("../internals/to-object"),f=r("../internals/to-length"),h=r("../internals/array-species-create"),d=[].push;s.exports={forEach:a(0),map:a(1),filter:a(2),some:a(3),every:a(4),find:a(5),findIndex:a(6)}},{"../internals/array-species-create":25,"../internals/function-bind-context":55,"../internals/indexed-object":67,"../internals/to-length":137,"../internals/to-object":138}],20:[function(p,s,i){var a=p("../internals/to-indexed-object"),l=p("../internals/to-integer"),c=p("../internals/to-length"),d=p("../internals/array-method-is-strict"),p=p("../internals/array-method-uses-to-length"),u=Math.min,f=[].lastIndexOf,h=!!f&&1/[1].lastIndexOf(1,-0)<0,d=d("lastIndexOf"),p=p("indexOf",{ACCESSORS:!0,1:0});s.exports=h||!d||!p?function(m){if(h)return f.apply(this,arguments)||0;var g=a(this),b=c(g.length),y=b-1;for((y=1<arguments.length?u(y,l(arguments[1])):y)<0&&(y=b+y);0<=y;y--)if(y in g&&g[y]===m)return y||0;return-1}:f},{"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/to-indexed-object":135,"../internals/to-integer":136,"../internals/to-length":137}],21:[function(r,s,i){var a=r("../internals/fails"),l=r("../internals/well-known-symbol"),c=r("../internals/engine-v8-version"),u=l("species");s.exports=function(f){return 51<=c||!a(function(){var h=[];return(h.constructor={})[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},{"../internals/engine-v8-version":48,"../internals/fails":51,"../internals/well-known-symbol":149}],22:[function(r,s,i){var a=r("../internals/fails");s.exports=function(l,c){var u=[][l];return!!u&&a(function(){u.call(null,c||function(){throw 1},1)})}},{"../internals/fails":51}],23:[function(r,s,i){function a(d){throw d}var l=r("../internals/descriptors"),c=r("../internals/fails"),u=r("../internals/has"),f=Object.defineProperty,h={};s.exports=function(d,p){var m,g,b,y;return u(h,d)?h[d]:(m=[][d],g=!!u(p=p||{},"ACCESSORS")&&p.ACCESSORS,b=u(p,0)?p[0]:a,y=u(p,1)?p[1]:void 0,h[d]=!!m&&!c(function(){if(g&&!l)return!0;var v={length:-1};g?f(v,1,{enumerable:!0,get:a}):v[1]=1,m.call(v,b,y)}))}},{"../internals/descriptors":43,"../internals/fails":51,"../internals/has":61}],24:[function(r,s,i){function a(h){return function(d,p,m,g){l(p);var b=c(d),y=u(b),v=f(b.length),x=h?v-1:0,S=h?-1:1;if(m<2)for(;;){if(x in y){g=y[x],x+=S;break}if(x+=S,h?x<0:v<=x)throw TypeError("Reduce of empty array with no initial value")}for(;h?0<=x:x<v;x+=S)x in y&&(g=p(g,y[x],x,b));return g}}var l=r("../internals/a-function"),c=r("../internals/to-object"),u=r("../internals/indexed-object"),f=r("../internals/to-length");s.exports={left:a(!1),right:a(!0)}},{"../internals/a-function":5,"../internals/indexed-object":67,"../internals/to-length":137,"../internals/to-object":138}],25:[function(r,s,i){var a=r("../internals/is-object"),l=r("../internals/is-array"),c=r("../internals/well-known-symbol")("species");s.exports=function(u,f){var h;return new((h=l(u)&&(typeof(h=u.constructor)=="function"&&(h===Array||l(h.prototype))||a(h)&&(h=h[c])===null)?void 0:h)===void 0?Array:h)(f===0?0:f)}},{"../internals/is-array":73,"../internals/is-object":75,"../internals/well-known-symbol":149}],26:[function(r,s,i){var a=r("../internals/an-object");s.exports=function(l,c,u,f){try{return f?c(a(u)[0],u[1]):c(u)}catch(h){throw f=l.return,f!==void 0&&a(f.call(l)),h}}},{"../internals/an-object":10}],27:[function(r,s,i){var a=r("../internals/well-known-symbol")("iterator"),l=!1;try{var c=0,u={next:function(){return{done:!!c++}},return:function(){l=!0}};u[a]=function(){return this},Array.from(u,function(){throw 2})}catch{}s.exports=function(f,h){if(!h&&!l)return!1;var d=!1;try{var p={};p[a]=function(){return{next:function(){return{done:d=!0}}}},f(p)}catch{}return d}},{"../internals/well-known-symbol":149}],28:[function(r,s,i){var a={}.toString;s.exports=function(l){return a.call(l).slice(8,-1)}},{}],29:[function(r,s,i){var a=r("../internals/to-string-tag-support"),l=r("../internals/classof-raw"),c=r("../internals/well-known-symbol")("toStringTag"),u=l(function(){return arguments}())=="Arguments";s.exports=a?l:function(f){var h;return f===void 0?"Undefined":f===null?"Null":typeof(h=function(d,p){try{return d[p]}catch{}}(f=Object(f),c))=="string"?h:u?l(f):(h=l(f))=="Object"&&typeof f.callee=="function"?"Arguments":h}},{"../internals/classof-raw":28,"../internals/to-string-tag-support":142,"../internals/well-known-symbol":149}],30:[function(b,s,i){var a=b("../internals/object-define-property").f,l=b("../internals/object-create"),c=b("../internals/redefine-all"),u=b("../internals/function-bind-context"),f=b("../internals/an-instance"),h=b("../internals/iterate"),d=b("../internals/define-iterator"),p=b("../internals/set-species"),m=b("../internals/descriptors"),g=b("../internals/internal-metadata").fastKey,b=b("../internals/internal-state"),y=b.set,v=b.getterFor;s.exports={getConstructor:function(x,S,w,E){function j(k,F,A){var N,$=O(k),G=P(k,F);return G?G.value=A:($.last=G={index:N=g(F,!0),key:F,value:A,previous:F=$.last,next:void 0,removed:!1},$.first||($.first=G),F&&(F.next=G),m?$.size++:k.size++,N!=="F"&&($.index[N]=G)),k}function P(N,F){var A,N=O(N),$=g(F);if($!=="F")return N.index[$];for(A=N.first;A;A=A.next)if(A.key==F)return A}var M=x(function(k,F){f(k,M,S),y(k,{type:S,index:l(null),first:void 0,last:void 0,size:0}),m||(k.size=0),F!=null&&h(F,k[E],k,w)}),O=v(S);return c(M.prototype,{clear:function(){for(var k=O(this),F=k.index,A=k.first;A;)A.removed=!0,A.previous&&(A.previous=A.previous.next=void 0),delete F[A.index],A=A.next;k.first=k.last=void 0,m?k.size=0:this.size=0},delete:function($){var F,A,N=O(this),$=P(this,$);return $&&(F=$.next,A=$.previous,delete N.index[$.index],$.removed=!0,A&&(A.next=F),F&&(F.previous=A),N.first==$&&(N.first=F),N.last==$&&(N.last=A),m?N.size--:this.size--),!!$},forEach:function(k){for(var F,A=O(this),N=u(k,1<arguments.length?arguments[1]:void 0,3);F=F?F.next:A.first;)for(N(F.value,F.key,this);F&&F.removed;)F=F.previous},has:function(k){return!!P(this,k)}}),c(M.prototype,w?{get:function(k){return k=P(this,k),k&&k.value},set:function(k,F){return j(this,k===0?0:k,F)}}:{add:function(k){return j(this,k=k===0?0:k,k)}}),m&&a(M.prototype,"size",{get:function(){return O(this).size}}),M},setStrong:function(x,S,w){var E=S+" Iterator",j=v(S),P=v(E);d(x,S,function(M,O){y(this,{type:E,target:M,state:j(M),kind:O,last:void 0})},function(){for(var M=P(this),O=M.kind,k=M.last;k&&k.removed;)k=k.previous;return M.target&&(M.last=k=k?k.next:M.state.first)?O=="keys"?{value:k.key,done:!1}:O=="values"?{value:k.value,done:!1}:{value:[k.key,k.value],done:!1}:{value:M.target=void 0,done:!0}},w?"entries":"values",!w,!0),p(S)}}},{"../internals/an-instance":9,"../internals/define-iterator":41,"../internals/descriptors":43,"../internals/function-bind-context":55,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/iterate":78,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/redefine-all":108,"../internals/set-species":117}],31:[function(y,s,i){function a(j){return j.frozen||(j.frozen=new l)}function l(){this.entries=[]}function c(j,P){return S(j.entries,function(M){return M[0]===P})}var u=y("../internals/redefine-all"),f=y("../internals/internal-metadata").getWeakData,h=y("../internals/an-object"),d=y("../internals/is-object"),p=y("../internals/an-instance"),m=y("../internals/iterate"),g=y("../internals/array-iteration"),b=y("../internals/has"),y=y("../internals/internal-state"),v=y.set,x=y.getterFor,S=g.find,w=g.findIndex,E=0;l.prototype={get:function(j){if(j=c(this,j),j)return j[1]},has:function(j){return!!c(this,j)},set:function(j,P){var M=c(this,j);M?M[1]=P:this.entries.push([j,P])},delete:function(j){var P=w(this.entries,function(M){return M[0]===j});return~P&&this.entries.splice(P,1),!!~P}},s.exports={getConstructor:function(j,P,M,O){function k(N,$,G){var X=A(N),W=f(h($),!0);return W===!0?a(X).set($,G):W[X.id]=G,N}var F=j(function(N,$){p(N,F,P),v(N,{type:P,id:E++,frozen:void 0}),$!=null&&m($,N[O],N,M)}),A=x(P);return u(F.prototype,{delete:function(N){var $,G=A(this);return!!d(N)&&(($=f(N))===!0?a(G).delete(N):$&&b($,G.id)&&delete $[G.id])},has:function(N){var $,G=A(this);return!!d(N)&&(($=f(N))===!0?a(G).has(N):$&&b($,G.id))}}),u(F.prototype,M?{get:function(N){var $,G=A(this);if(d(N))return($=f(N))===!0?a(G).get(N):$?$[G.id]:void 0},set:function(N,$){return k(this,N,$)}}:{add:function(N){return k(this,N,!0)}}),F}}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/array-iteration":19,"../internals/has":61,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/is-object":75,"../internals/iterate":78,"../internals/redefine-all":108}],32:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/global"),c=r("../internals/is-forced"),u=r("../internals/redefine"),f=r("../internals/internal-metadata"),h=r("../internals/iterate"),d=r("../internals/an-instance"),p=r("../internals/is-object"),m=r("../internals/fails"),g=r("../internals/check-correctness-of-iteration"),b=r("../internals/set-to-string-tag"),y=r("../internals/inherit-if-required");s.exports=function(v,x,S){function w(W){var V=$[W];u($,W,W=="add"?function(q){return V.call(this,q===0?0:q),this}:W=="delete"?function(q){return!(F&&!p(q))&&V.call(this,q===0?0:q)}:W=="get"?function(q){return F&&!p(q)?void 0:V.call(this,q===0?0:q)}:W=="has"?function(q){return!(F&&!p(q))&&V.call(this,q===0?0:q)}:function(q,J){return V.call(this,q===0?0:q,J),this})}var E,j,P,M,O,k=v.indexOf("Map")!==-1,F=v.indexOf("Weak")!==-1,A=k?"set":"add",N=l[v],$=N&&N.prototype,G=N,X={};return c(v,typeof N!="function"||!(F||$.forEach&&!m(function(){new N().entries().next()})))?(G=S.getConstructor(x,v,k,A),f.REQUIRED=!0):c(v,!0)&&(j=(E=new G)[A](F?{}:-0,1)!=E,P=m(function(){E.has(1)}),M=g(function(W){new N(W)}),O=!F&&m(function(){for(var W=new N,V=5;V--;)W[A](V,V);return!W.has(-0)}),M||(((G=x(function(W,V){return d(W,G,v),W=y(new N,W,G),V!=null&&h(V,W[A],W,k),W})).prototype=$).constructor=G),(P||O)&&(w("delete"),w("has"),k&&w("get")),(O||j)&&w(A),F&&$.clear&&delete $.clear),X[v]=G,a({global:!0,forced:G!=N},X),b(G,v),F||S.setStrong(G,v,k),G}},{"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/export":50,"../internals/fails":51,"../internals/global":60,"../internals/inherit-if-required":68,"../internals/internal-metadata":70,"../internals/is-forced":74,"../internals/is-object":75,"../internals/iterate":78,"../internals/redefine":109,"../internals/set-to-string-tag":118}],33:[function(r,s,i){var a=r("../internals/has"),l=r("../internals/own-keys"),c=r("../internals/object-get-own-property-descriptor"),u=r("../internals/object-define-property");s.exports=function(f,h){for(var d=l(h),p=u.f,m=c.f,g=0;g<d.length;g++){var b=d[g];a(f,b)||p(f,b,m(h,b))}}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/own-keys":104}],34:[function(r,s,i){var a=r("../internals/well-known-symbol")("match");s.exports=function(l){var c=/./;try{"/./"[l](c)}catch{try{return c[a]=!1,"/./"[l](c)}catch{}}return!1}},{"../internals/well-known-symbol":149}],35:[function(r,s,i){r=r("../internals/fails"),s.exports=!r(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})},{"../internals/fails":51}],36:[function(r,s,i){var a=r("../internals/require-object-coercible"),l=/"/g;s.exports=function(d,u,f,h){var d=String(a(d)),p="<"+u;return f!==""&&(p+=" "+f+'="'+String(h).replace(l,"&quot;")+'"'),p+">"+d+"</"+u+">"}},{"../internals/require-object-coercible":114}],37:[function(r,s,i){function a(){return this}var l=r("../internals/iterators-core").IteratorPrototype,c=r("../internals/object-create"),u=r("../internals/create-property-descriptor"),f=r("../internals/set-to-string-tag"),h=r("../internals/iterators");s.exports=function(d,p,m){return p+=" Iterator",d.prototype=c(l,{next:u(1,m)}),f(d,p,!1,!0),h[p]=a,d}},{"../internals/create-property-descriptor":39,"../internals/iterators":80,"../internals/iterators-core":79,"../internals/object-create":91,"../internals/set-to-string-tag":118}],38:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=a?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/object-define-property":93}],39:[function(r,s,i){s.exports=function(a,l){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:l}}},{}],40:[function(r,s,i){var a=r("../internals/to-primitive"),l=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=function(u,f,h){f=a(f),f in u?l.f(u,f,c(0,h)):u[f]=h}},{"../internals/create-property-descriptor":39,"../internals/object-define-property":93,"../internals/to-primitive":141}],41:[function(y,s,i){function a(){return this}var l=y("../internals/export"),c=y("../internals/create-iterator-constructor"),u=y("../internals/object-get-prototype-of"),f=y("../internals/object-set-prototype-of"),h=y("../internals/set-to-string-tag"),d=y("../internals/create-non-enumerable-property"),p=y("../internals/redefine"),m=y("../internals/well-known-symbol"),g=y("../internals/is-pure"),b=y("../internals/iterators"),y=y("../internals/iterators-core"),v=y.IteratorPrototype,x=y.BUGGY_SAFARI_ITERATORS,S=m("iterator"),w="values",E="entries";s.exports=function(j,P,M,X,k,F,A){c(M,P,X);function N(I){if(I===k&&J)return J;if(!x&&I in V)return V[I];switch(I){case"keys":case w:case E:return function(){return new M(this,I)}}return function(){return new M(this)}}var $,G,X=P+" Iterator",W=!1,V=j.prototype,q=V[S]||V["@@iterator"]||k&&V[k],J=!x&&q||N(k),ae=P=="Array"&&V.entries||q;if(ae&&(ae=u(ae.call(new j)),v!==Object.prototype&&ae.next&&(g||u(ae)===v||(f?f(ae,v):typeof ae[S]!="function"&&d(ae,S,a)),h(ae,X,!0,!0),g&&(b[X]=a))),k==w&&q&&q.name!==w&&(W=!0,J=function(){return q.call(this)}),g&&!A||V[S]===J||d(V,S,J),b[P]=J,k)if($={values:N(w),keys:F?J:N("keys"),entries:N(E)},A)for(G in $)!x&&!W&&G in V||p(V,G,$[G]);else l({target:P,proto:!0,forced:x||W},$);return $}},{"../internals/create-iterator-constructor":37,"../internals/create-non-enumerable-property":38,"../internals/export":50,"../internals/is-pure":76,"../internals/iterators":80,"../internals/iterators-core":79,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/well-known-symbol":149}],42:[function(r,s,i){var a=r("../internals/path"),l=r("../internals/has"),c=r("../internals/well-known-symbol-wrapped"),u=r("../internals/object-define-property").f;s.exports=function(f){var h=a.Symbol||(a.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/path":105,"../internals/well-known-symbol-wrapped":148}],43:[function(r,s,i){r=r("../internals/fails"),s.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},{"../internals/fails":51}],44:[function(l,s,i){var a=l("../internals/global"),l=l("../internals/is-object"),c=a.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},{"../internals/global":60,"../internals/is-object":75}],45:[function(r,s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],46:[function(r,s,i){r=r("../internals/engine-user-agent"),s.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},{"../internals/engine-user-agent":47}],47:[function(r,s,i){r=r("../internals/get-built-in"),s.exports=r("navigator","userAgent")||""},{"../internals/get-built-in":57}],48:[function(c,s,i){var a,l,u=c("../internals/global"),c=c("../internals/engine-user-agent"),u=u.process,u=u&&u.versions,u=u&&u.v8;u?l=(a=u.split("."))[0]+a[1]:c&&(!(a=c.match(/Edge\/(\d+)/))||74<=a[1])&&(a=c.match(/Chrome\/(\d+)/))&&(l=a[1]),s.exports=l&&+l},{"../internals/engine-user-agent":47,"../internals/global":60}],49:[function(r,s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],50:[function(r,s,i){var a=r("../internals/global"),l=r("../internals/object-get-own-property-descriptor").f,c=r("../internals/create-non-enumerable-property"),u=r("../internals/redefine"),f=r("../internals/set-global"),h=r("../internals/copy-constructor-properties"),d=r("../internals/is-forced");s.exports=function(p,m){var g,b,y,v=p.target,x=p.global,S=p.stat,w=x?a:S?a[v]||f(v,{}):(a[v]||{}).prototype;if(w)for(g in m){if(b=m[g],y=p.noTargetGet?(y=l(w,g))&&y.value:w[g],!d(x?g:v+(S?".":"#")+g,p.forced)&&y!==void 0){if(typeof b==typeof y)continue;h(b,y)}(p.sham||y&&y.sham)&&c(b,"sham",!0),u(w,g,b,p)}}},{"../internals/copy-constructor-properties":33,"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/is-forced":74,"../internals/object-get-own-property-descriptor":94,"../internals/redefine":109,"../internals/set-global":116}],51:[function(r,s,i){s.exports=function(a){try{return!!a()}catch{return!0}}},{}],52:[function(m,s,i){m("../modules/es.regexp.exec");var a=m("../internals/redefine"),l=m("../internals/fails"),c=m("../internals/well-known-symbol"),u=m("../internals/regexp-exec"),f=m("../internals/create-non-enumerable-property"),h=c("species"),d=!l(function(){var y=/./;return y.exec=function(){var v=[];return v.groups={a:"7"},v},"".replace(y,"$<a>")!=="7"}),p="a".replace(/./,"$0")==="$0",m=c("replace"),g=!!/./[m]&&/./[m]("a","$0")==="",b=!l(function(){var v=/(?:)/,y=v.exec,v=(v.exec=function(){return y.apply(this,arguments)},"ab".split(v));return v.length!==2||v[0]!=="a"||v[1]!=="b"});s.exports=function(y,v,x,S){var w,E,j=c(y),P=!l(function(){var O={};return O[j]=function(){return 7},""[y](O)!=7}),M=P&&!l(function(){var O=!1,k=/a/;return y==="split"&&((k={constructor:{}}).constructor[h]=function(){return k},k.flags="",k[j]=/./[j]),k.exec=function(){return O=!0,null},k[j](""),!O});P&&M&&(y!=="replace"||d&&p&&!g)&&(y!=="split"||b)||(w=/./[j],x=(M=x(j,""[y],function(O,k,F,A,N){return k.exec===u?P&&!N?{done:!0,value:w.call(k,F,A)}:{done:!0,value:O.call(F,k,A)}:{done:!1}},{REPLACE_KEEPS_$0:p,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:g}))[0],E=M[1],a(String.prototype,y,x),a(RegExp.prototype,j,v==2?function(O,k){return E.call(O,this,k)}:function(O){return E.call(O,this)})),S&&f(RegExp.prototype[j],"sham",!0)}},{"../internals/create-non-enumerable-property":38,"../internals/fails":51,"../internals/redefine":109,"../internals/regexp-exec":111,"../internals/well-known-symbol":149,"../modules/es.regexp.exec":192}],53:[function(r,s,i){function a(f,h,d,p,m,g,b,y){for(var v,x=m,S=0,w=!!b&&u(b,y,3);S<p;){if(S in d){if(v=w?w(d[S],S,h):d[S],0<g&&l(v))x=a(f,h,v,c(v.length),x,g-1)-1;else{if(9007199254740991<=x)throw TypeError("Exceed the acceptable array length");f[x]=v}x++}S++}return x}var l=r("../internals/is-array"),c=r("../internals/to-length"),u=r("../internals/function-bind-context");s.exports=a},{"../internals/function-bind-context":55,"../internals/is-array":73,"../internals/to-length":137}],54:[function(r,s,i){r=r("../internals/fails"),s.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},{"../internals/fails":51}],55:[function(r,s,i){var a=r("../internals/a-function");s.exports=function(l,c,u){if(a(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,d){return l.call(c,f,h,d)}}return function(){return l.apply(c,arguments)}}},{"../internals/a-function":5}],56:[function(r,s,i){var a=r("../internals/a-function"),l=r("../internals/is-object"),c=[].slice,u={};s.exports=Function.bind||function(f){var h=a(this),d=c.call(arguments,1),p=function(){var m=d.concat(c.call(arguments));if(this instanceof p){var g=h,b=m.length,y=m;if(!(b in u)){for(var v=[],x=0;x<b;x++)v[x]="a["+x+"]";u[b]=Function("C,a","return new C("+v.join(",")+")")}return u[b](g,y)}return h.apply(f,m)};return l(h.prototype)&&(p.prototype=h.prototype),p}},{"../internals/a-function":5,"../internals/is-object":75}],57:[function(r,s,i){function a(u){return typeof u=="function"?u:void 0}var l=r("../internals/path"),c=r("../internals/global");s.exports=function(u,f){return arguments.length<2?a(l[u])||a(c[u]):l[u]&&l[u][f]||c[u]&&c[u][f]}},{"../internals/global":60,"../internals/path":105}],58:[function(r,s,i){var a=r("../internals/classof"),l=r("../internals/iterators"),c=r("../internals/well-known-symbol")("iterator");s.exports=function(u){if(u!=null)return u[c]||u["@@iterator"]||l[a(u)]}},{"../internals/classof":29,"../internals/iterators":80,"../internals/well-known-symbol":149}],59:[function(r,s,i){var a=r("../internals/an-object"),l=r("../internals/get-iterator-method");s.exports=function(c){var u=l(c);if(typeof u!="function")throw TypeError(String(c)+" is not iterable");return a(u.call(c))}},{"../internals/an-object":10,"../internals/get-iterator-method":58}],60:[function(r,s,i){(function(a){function l(c){return c&&c.Math==Math&&c}s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof a=="object"&&a)||Function("return this")()}).call(this,typeof fn<"u"?fn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],61:[function(r,s,i){var a={}.hasOwnProperty;s.exports=function(l,c){return a.call(l,c)}},{}],62:[function(r,s,i){s.exports={}},{}],63:[function(r,s,i){var a=r("../internals/global");s.exports=function(l,c){var u=a.console;u&&u.error&&(arguments.length===1?u.error(l):u.error(l,c))}},{"../internals/global":60}],64:[function(r,s,i){r=r("../internals/get-built-in"),s.exports=r("document","documentElement")},{"../internals/get-built-in":57}],65:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/fails"),c=r("../internals/document-create-element");s.exports=!a&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},{"../internals/descriptors":43,"../internals/document-create-element":44,"../internals/fails":51}],66:[function(r,s,i){var a=Math.abs,l=Math.pow,c=Math.floor,u=Math.log,f=Math.LN2;s.exports={pack:function(h,d,x){var m,g,b,y=new Array(x),v=8*x-d-1,x=(1<<v)-1,S=x>>1,w=d===23?l(2,-24)-l(2,-77):0,E=h<0||h===0&&1/h<0?1:0,j=0;for((h=a(h))!=h||h===1/0?(g=h!=h?1:0,m=x):(m=c(u(h)/f),h*(b=l(2,-m))<1&&(m--,b*=2),2<=(h+=1<=m+S?w/b:w*l(2,1-S))*b&&(m++,b/=2),x<=m+S?(g=0,m=x):1<=m+S?(g=(h*b-1)*l(2,d),m+=S):(g=h*l(2,S-1)*l(2,d),m=0));8<=d;y[j++]=255&g,g/=256,d-=8);for(m=m<<d|g,v+=d;0<v;y[j++]=255&m,m/=256,v-=8);return y[--j]|=128*E,y},unpack:function(h,d){var p,m=h.length,x=8*m-d-1,g=(1<<x)-1,b=g>>1,y=x-7,v=m-1,x=h[v--],S=127&x;for(x>>=7;0<y;S=256*S+h[v],v--,y-=8);for(p=S&(1<<-y)-1,S>>=-y,y+=d;0<y;p=256*p+h[v],v--,y-=8);if(S===0)S=1-b;else{if(S===g)return p?NaN:x?-1/0:1/0;p+=l(2,d),S-=b}return(x?-1:1)*p*l(2,S-d)}}},{}],67:[function(r,s,i){var a=r("../internals/fails"),l=r("../internals/classof-raw"),c="".split;s.exports=a(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},{"../internals/classof-raw":28,"../internals/fails":51}],68:[function(r,s,i){var a=r("../internals/is-object"),l=r("../internals/object-set-prototype-of");s.exports=function(c,u,f){return l&&typeof(u=u.constructor)=="function"&&u!==f&&a(u=u.prototype)&&u!==f.prototype&&l(c,u),c}},{"../internals/is-object":75,"../internals/object-set-prototype-of":102}],69:[function(a,s,i){var a=a("../internals/shared-store"),l=Function.toString;typeof a.inspectSource!="function"&&(a.inspectSource=function(c){return l.call(c)}),s.exports=a.inspectSource},{"../internals/shared-store":120}],70:[function(r,s,i){function a(y){f(y,p,{value:{objectID:"O"+ ++m,weakData:{}}})}var l=r("../internals/hidden-keys"),c=r("../internals/is-object"),u=r("../internals/has"),f=r("../internals/object-define-property").f,h=r("../internals/uid"),d=r("../internals/freezing"),p=h("meta"),m=0,g=Object.isExtensible||function(){return!0},b=s.exports={REQUIRED:!1,fastKey:function(y,v){if(!c(y))return typeof y=="symbol"?y:(typeof y=="string"?"S":"P")+y;if(!u(y,p)){if(!g(y))return"F";if(!v)return"E";a(y)}return y[p].objectID},getWeakData:function(y,v){if(!u(y,p)){if(!g(y))return!0;if(!v)return!1;a(y)}return y[p].weakData},onFreeze:function(y){return d&&b.REQUIRED&&g(y)&&!u(y,p)&&a(y),y}};l[p]=!0},{"../internals/freezing":54,"../internals/has":61,"../internals/hidden-keys":62,"../internals/is-object":75,"../internals/object-define-property":93,"../internals/uid":146}],71:[function(x,s,i){var a,l,c,u,f,h,d,p,m=x("../internals/native-weak-map"),S=x("../internals/global"),g=x("../internals/is-object"),b=x("../internals/create-non-enumerable-property"),y=x("../internals/has"),v=x("../internals/shared-key"),x=x("../internals/hidden-keys"),S=S.WeakMap;d=m?(a=new S,l=a.get,c=a.has,u=a.set,f=function(w,E){return u.call(a,w,E),E},h=function(w){return l.call(a,w)||{}},function(w){return c.call(a,w)}):(x[p=v("state")]=!0,f=function(w,E){return b(w,p,E),E},h=function(w){return y(w,p)?w[p]:{}},function(w){return y(w,p)}),s.exports={set:f,get:h,has:d,enforce:function(w){return d(w)?h(w):f(w,{})},getterFor:function(w){return function(E){if(g(E)&&(E=h(E)).type===w)return E;throw TypeError("Incompatible receiver, "+w+" required")}}}},{"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/has":61,"../internals/hidden-keys":62,"../internals/is-object":75,"../internals/native-weak-map":86,"../internals/shared-key":119}],72:[function(r,s,i){var a=r("../internals/well-known-symbol"),l=r("../internals/iterators"),c=a("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},{"../internals/iterators":80,"../internals/well-known-symbol":149}],73:[function(r,s,i){var a=r("../internals/classof-raw");s.exports=Array.isArray||function(l){return a(l)=="Array"}},{"../internals/classof-raw":28}],74:[function(r,s,i){function a(p,m){return(p=f[u(p)])==d||p!=h&&(typeof m=="function"?l(m):!!m)}var l=r("../internals/fails"),c=/#|\.prototype\./,u=a.normalize=function(p){return String(p).replace(c,".").toLowerCase()},f=a.data={},h=a.NATIVE="N",d=a.POLYFILL="P";s.exports=a},{"../internals/fails":51}],75:[function(r,s,i){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},{}],76:[function(r,s,i){s.exports=!1},{}],77:[function(r,s,i){var a=r("../internals/is-object"),l=r("../internals/classof-raw"),c=r("../internals/well-known-symbol")("match");s.exports=function(u){var f;return a(u)&&((f=u[c])!==void 0?!!f:l(u)=="RegExp")}},{"../internals/classof-raw":28,"../internals/is-object":75,"../internals/well-known-symbol":149}],78:[function(r,s,i){function a(p,m){this.stopped=p,this.result=m}var l=r("../internals/an-object"),c=r("../internals/is-array-iterator-method"),u=r("../internals/to-length"),f=r("../internals/function-bind-context"),h=r("../internals/get-iterator-method"),d=r("../internals/call-with-safe-iteration-closing");(s.exports=function(p,m,g,b,y){var v,x,S,w,E,j,P=f(m,g,b?2:1);if(y)v=p;else{if(typeof(m=h(p))!="function")throw TypeError("Target is not iterable");if(c(m)){for(x=0,S=u(p.length);x<S;x++)if((w=b?P(l(j=p[x])[0],j[1]):P(p[x]))&&w instanceof a)return w;return new a(!1)}v=m.call(p)}for(E=v.next;!(j=E.call(v)).done;)if(typeof(w=d(v,P,j.value,b))=="object"&&w&&w instanceof a)return w;return new a(!1)}).stop=function(p){return new a(!0,p)}},{"../internals/an-object":10,"../internals/call-with-safe-iteration-closing":26,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137}],79:[function(h,s,i){var a,l,c=h("../internals/object-get-prototype-of"),u=h("../internals/create-non-enumerable-property"),f=h("../internals/has"),d=h("../internals/well-known-symbol"),h=h("../internals/is-pure"),d=d("iterator"),p=!1;[].keys&&("next"in(l=[].keys())?(c=c(c(l)))!==Object.prototype&&(a=c):p=!0),a==null&&(a={}),h||f(a,d)||u(a,d,function(){return this}),s.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:p}},{"../internals/create-non-enumerable-property":38,"../internals/has":61,"../internals/is-pure":76,"../internals/object-get-prototype-of":98,"../internals/well-known-symbol":149}],80:[function(r,s,i){s.exports={}},{}],81:[function(r,s,i){s.exports=Math.sign||function(a){return(a=+a)==0||a!=a?a:a<0?-1:1}},{}],82:[function(b,s,i){var a,l,c,u,f,h,d,p,m=b("../internals/global"),E=b("../internals/object-get-own-property-descriptor").f,w=b("../internals/classof-raw"),g=b("../internals/task").set,b=b("../internals/engine-is-ios"),y=m.MutationObserver||m.WebKitMutationObserver,v=m.process,x=m.Promise,S=w(v)=="process",w=E(m,"queueMicrotask"),E=w&&w.value;E||(a=function(){var j,P;for(S&&(j=v.domain)&&j.exit();l;){P=l.fn,l=l.next;try{P()}catch(M){throw l?u():c=void 0,M}}c=void 0,j&&j.enter()},u=S?function(){v.nextTick(a)}:y&&!b?(f=!0,h=document.createTextNode(""),new y(a).observe(h,{characterData:!0}),function(){h.data=f=!f}):x&&x.resolve?(d=x.resolve(void 0),p=d.then,function(){p.call(d,a)}):function(){g.call(m,a)}),s.exports=E||function(j){j={fn:j,next:void 0},c&&(c.next=j),l||(l=j,u()),c=j}},{"../internals/classof-raw":28,"../internals/engine-is-ios":46,"../internals/global":60,"../internals/object-get-own-property-descriptor":94,"../internals/task":131}],83:[function(r,s,i){r=r("../internals/global"),s.exports=r.Promise},{"../internals/global":60}],84:[function(r,s,i){r=r("../internals/fails"),s.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())})},{"../internals/fails":51}],85:[function(r,s,i){var a=r("../internals/fails"),l=r("../internals/well-known-symbol"),c=r("../internals/is-pure"),u=l("iterator");s.exports=!a(function(){var f=new URL("b?a=1&b=2&c=3","http://a"),h=f.searchParams,d="";return f.pathname="c%20d",h.forEach(function(p,m){h.delete("b"),d+=m+p}),c&&!f.toJSON||!h.sort||f.href!=="http://a/c%20d?a=1&c=3"||h.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!h[u]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"})},{"../internals/fails":51,"../internals/is-pure":76,"../internals/well-known-symbol":149}],86:[function(a,s,i){var l=a("../internals/global"),a=a("../internals/inspect-source"),l=l.WeakMap;s.exports=typeof l=="function"&&/native code/.test(a(l))},{"../internals/global":60,"../internals/inspect-source":69}],87:[function(r,s,i){function a(c){var u,f;this.promise=new c(function(h,d){if(u!==void 0||f!==void 0)throw TypeError("Bad Promise constructor");u=h,f=d}),this.resolve=l(u),this.reject=l(f)}var l=r("../internals/a-function");s.exports.f=function(c){return new a(c)}},{"../internals/a-function":5}],88:[function(r,s,i){var a=r("../internals/is-regexp");s.exports=function(l){if(a(l))throw TypeError("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":77}],89:[function(r,s,i){var a=r("../internals/global").isFinite;s.exports=Number.isFinite||function(l){return typeof l=="number"&&a(l)}},{"../internals/global":60}],90:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/fails"),c=r("../internals/object-keys"),u=r("../internals/object-get-own-property-symbols"),f=r("../internals/object-property-is-enumerable"),h=r("../internals/to-object"),d=r("../internals/indexed-object"),p=Object.assign,m=Object.defineProperty;s.exports=!p||l(function(){var g,b,y,v;return!(!a||p({b:1},p(m({},"a",{enumerable:!0,get:function(){m(this,"b",{value:3,enumerable:!1})}}),{b:2})).b===1)||(b={},v="abcdefghijklmnopqrst",(g={})[y=Symbol()]=7,v.split("").forEach(function(x){b[x]=x}),p({},g)[y]!=7||c(p({},b)).join("")!=v)})?function(g,b){for(var y=h(g),v=arguments.length,x=1,S=u.f,w=f.f;x<v;)for(var E,j=d(arguments[x++]),P=S?c(j).concat(S(j)):c(j),M=P.length,O=0;O<M;)E=P[O++],a&&!w.call(j,E)||(y[E]=j[E]);return y}:p},{"../internals/descriptors":43,"../internals/fails":51,"../internals/indexed-object":67,"../internals/object-get-own-property-symbols":97,"../internals/object-keys":100,"../internals/object-property-is-enumerable":101,"../internals/to-object":138}],91:[function(m,s,i){function a(){}var l,c=m("../internals/an-object"),u=m("../internals/object-define-properties"),f=m("../internals/enum-bug-keys"),h=m("../internals/hidden-keys"),d=m("../internals/html"),p=m("../internals/document-create-element"),m=m("../internals/shared-key"),g="prototype",b="script",y=m("IE_PROTO"),v=function(S){return"<"+b+">"+S+"</"+b+">"},x=function(){try{l=document.domain&&new ActiveXObject("htmlfile")}catch{}x=l?((S=l).write(v("")),S.close(),w=S.parentWindow.Object,S=null,w):(S=p("iframe"),w="java"+b+":",S.style.display="none",d.appendChild(S),S.src=String(w),(w=S.contentWindow.document).open(),w.write(v("document.F=Object")),w.close(),w.F);for(var S,w,E=f.length;E--;)delete x[g][f[E]];return x()};h[y]=!0,s.exports=Object.create||function(S,w){var E;return S!==null?(a[g]=c(S),E=new a,a[g]=null,E[y]=S):E=x(),w===void 0?E:u(E,w)}},{"../internals/an-object":10,"../internals/document-create-element":44,"../internals/enum-bug-keys":49,"../internals/hidden-keys":62,"../internals/html":64,"../internals/object-define-properties":92,"../internals/shared-key":119}],92:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/object-define-property"),c=r("../internals/an-object"),u=r("../internals/object-keys");s.exports=a?Object.defineProperties:function(f,h){c(f);for(var d,p=u(h),m=p.length,g=0;g<m;)l.f(f,d=p[g++],h[d]);return f}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/object-define-property":93,"../internals/object-keys":100}],93:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/ie8-dom-define"),c=r("../internals/an-object"),u=r("../internals/to-primitive"),f=Object.defineProperty;i.f=a?f:function(h,d,p){if(c(h),d=u(d,!0),c(p),l)try{return f(h,d,p)}catch{}if("get"in p||"set"in p)throw TypeError("Accessors not supported");return"value"in p&&(h[d]=p.value),h}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/ie8-dom-define":65,"../internals/to-primitive":141}],94:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/object-property-is-enumerable"),c=r("../internals/create-property-descriptor"),u=r("../internals/to-indexed-object"),f=r("../internals/to-primitive"),h=r("../internals/has"),d=r("../internals/ie8-dom-define"),p=Object.getOwnPropertyDescriptor;i.f=a?p:function(m,g){if(m=u(m),g=f(g,!0),d)try{return p(m,g)}catch{}if(h(m,g))return c(!l.f.call(m,g),m[g])}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/has":61,"../internals/ie8-dom-define":65,"../internals/object-property-is-enumerable":101,"../internals/to-indexed-object":135,"../internals/to-primitive":141}],95:[function(r,s,i){var a=r("../internals/to-indexed-object"),l=r("../internals/object-get-own-property-names").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];s.exports.f=function(f){if(!u||c.call(f)!="[object Window]")return l(a(f));try{return l(f)}catch{return u.slice()}}},{"../internals/object-get-own-property-names":96,"../internals/to-indexed-object":135}],96:[function(r,s,i){var a=r("../internals/object-keys-internal"),l=r("../internals/enum-bug-keys").concat("length","prototype");i.f=Object.getOwnPropertyNames||function(c){return a(c,l)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":99}],97:[function(r,s,i){i.f=Object.getOwnPropertySymbols},{}],98:[function(u,s,i){var a=u("../internals/has"),l=u("../internals/to-object"),c=u("../internals/shared-key"),u=u("../internals/correct-prototype-getter"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(d){return d=l(d),a(d,f)?d[f]:typeof d.constructor=="function"&&d instanceof d.constructor?d.constructor.prototype:d instanceof Object?h:null}},{"../internals/correct-prototype-getter":35,"../internals/has":61,"../internals/shared-key":119,"../internals/to-object":138}],99:[function(r,s,i){var a=r("../internals/has"),l=r("../internals/to-indexed-object"),c=r("../internals/array-includes").indexOf,u=r("../internals/hidden-keys");s.exports=function(f,h){var d,p=l(f),m=0,g=[];for(d in p)!a(u,d)&&a(p,d)&&g.push(d);for(;h.length>m;)!a(p,d=h[m++])||~c(g,d)||g.push(d);return g}},{"../internals/array-includes":18,"../internals/has":61,"../internals/hidden-keys":62,"../internals/to-indexed-object":135}],100:[function(r,s,i){var a=r("../internals/object-keys-internal"),l=r("../internals/enum-bug-keys");s.exports=Object.keys||function(c){return a(c,l)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":99}],101:[function(r,s,i){var a={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!a.call({1:2},1);i.f=c?function(u){return u=l(this,u),!!u&&u.enumerable}:a},{}],102:[function(r,s,i){var a=r("../internals/an-object"),l=r("../internals/a-possible-prototype");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c,u=!1,f={};try{(c=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(f,[]),u=f instanceof Array}catch{}return function(h,d){return a(h),l(d),u?c.call(h,d):h.__proto__=d,h}}():void 0)},{"../internals/a-possible-prototype":6,"../internals/an-object":10}],103:[function(r,s,i){var a=r("../internals/to-string-tag-support"),l=r("../internals/classof");s.exports=a?{}.toString:function(){return"[object "+l(this)+"]"}},{"../internals/classof":29,"../internals/to-string-tag-support":142}],104:[function(r,s,i){var a=r("../internals/get-built-in"),l=r("../internals/object-get-own-property-names"),c=r("../internals/object-get-own-property-symbols"),u=r("../internals/an-object");s.exports=a("Reflect","ownKeys")||function(f){var h=l.f(u(f)),d=c.f;return d?h.concat(d(f)):h}},{"../internals/an-object":10,"../internals/get-built-in":57,"../internals/object-get-own-property-names":96,"../internals/object-get-own-property-symbols":97}],105:[function(r,s,i){r=r("../internals/global"),s.exports=r},{"../internals/global":60}],106:[function(r,s,i){s.exports=function(a){try{return{error:!1,value:a()}}catch(l){return{error:!0,value:l}}}},{}],107:[function(r,s,i){var a=r("../internals/an-object"),l=r("../internals/is-object"),c=r("../internals/new-promise-capability");s.exports=function(u,f){return a(u),l(f)&&f.constructor===u?f:((0,(u=c.f(u)).resolve)(f),u.promise)}},{"../internals/an-object":10,"../internals/is-object":75,"../internals/new-promise-capability":87}],108:[function(r,s,i){var a=r("../internals/redefine");s.exports=function(l,c,u){for(var f in c)a(l,f,c[f],u);return l}},{"../internals/redefine":109}],109:[function(h,s,i){var a=h("../internals/global"),l=h("../internals/create-non-enumerable-property"),c=h("../internals/has"),u=h("../internals/set-global"),f=h("../internals/inspect-source"),h=h("../internals/internal-state"),d=h.get,p=h.enforce,m=String(String).split("String");(s.exports=function(g,b,y,w){var x=!!w&&!!w.unsafe,S=!!w&&!!w.enumerable,w=!!w&&!!w.noTargetGet;typeof y=="function"&&(typeof b!="string"||c(y,"name")||l(y,"name",b),p(y).source=m.join(typeof b=="string"?b:"")),g===a?S?g[b]=y:u(b,y):(x?!w&&g[b]&&(S=!0):delete g[b],S?g[b]=y:l(g,b,y))})(Function.prototype,"toString",function(){return typeof this=="function"&&d(this).source||f(this)})},{"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/has":61,"../internals/inspect-source":69,"../internals/internal-state":71,"../internals/set-global":116}],110:[function(r,s,i){var a=r("./classof-raw"),l=r("./regexp-exec");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){if(f=f.call(c,u),typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(a(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},{"./classof-raw":28,"./regexp-exec":111}],111:[function(u,s,i){var a,l,c=u("./regexp-flags"),u=u("./regexp-sticky-helpers"),f=RegExp.prototype.exec,h=String.prototype.replace,d=f,p=(a=/a/,l=/b*/g,f.call(a,"a"),f.call(l,"a"),a.lastIndex!==0||l.lastIndex!==0),m=u.UNSUPPORTED_Y||u.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0;s.exports=d=p||g||m?function(b){var y,v,x,S,w=this,E=m&&w.sticky,j=c.call(w),P=w.source,M=0,O=b;return E&&((j=j.replace("y","")).indexOf("g")===-1&&(j+="g"),O=String(b).slice(w.lastIndex),0<w.lastIndex&&(!w.multiline||w.multiline&&b[w.lastIndex-1]!==`
`)&&(P="(?: "+P+")",O=" "+O,M++),v=new RegExp("^(?:"+P+")",j)),g&&(v=new RegExp("^"+P+"$(?!\\s)",j)),p&&(y=w.lastIndex),x=f.call(E?v:w,O),E?x?(x.input=x.input.slice(M),x[0]=x[0].slice(M),x.index=w.lastIndex,w.lastIndex+=x[0].length):w.lastIndex=0:p&&x&&(w.lastIndex=w.global?x.index+x[0].length:y),g&&x&&1<x.length&&h.call(x[0],v,function(){for(S=1;S<arguments.length-2;S++)arguments[S]===void 0&&(x[S]=void 0)}),x}:d},{"./regexp-flags":112,"./regexp-sticky-helpers":113}],112:[function(r,s,i){var a=r("../internals/an-object");s.exports=function(){var l=a(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},{"../internals/an-object":10}],113:[function(r,s,i){r=r("./fails");function a(l,c){return RegExp(l,c)}i.UNSUPPORTED_Y=r(function(){var l=a("a","y");return l.lastIndex=2,l.exec("abcd")!=null}),i.BROKEN_CARET=r(function(){var l=a("^r","gy");return l.lastIndex=2,l.exec("str")!=null})},{"./fails":51}],114:[function(r,s,i){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},{}],115:[function(r,s,i){s.exports=Object.is||function(a,l){return a===l?a!==0||1/a==1/l:a!=a&&l!=l}},{}],116:[function(r,s,i){var a=r("../internals/global"),l=r("../internals/create-non-enumerable-property");s.exports=function(c,u){try{l(a,c,u)}catch{a[c]=u}return u}},{"../internals/create-non-enumerable-property":38,"../internals/global":60}],117:[function(r,s,i){var a=r("../internals/get-built-in"),l=r("../internals/object-define-property"),c=r("../internals/well-known-symbol"),u=r("../internals/descriptors"),f=c("species");s.exports=function(d){var d=a(d),p=l.f;u&&d&&!d[f]&&p(d,f,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":43,"../internals/get-built-in":57,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],118:[function(r,s,i){var a=r("../internals/object-define-property").f,l=r("../internals/has"),c=r("../internals/well-known-symbol")("toStringTag");s.exports=function(u,f,h){u&&!l(u=h?u:u.prototype,c)&&a(u,c,{configurable:!0,value:f})}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],119:[function(r,s,i){var a=r("../internals/shared"),l=r("../internals/uid"),c=a("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},{"../internals/shared":121,"../internals/uid":146}],120:[function(a,s,i){var c=a("../internals/global"),a=a("../internals/set-global"),l="__core-js_shared__",c=c[l]||a(l,{});s.exports=c},{"../internals/global":60,"../internals/set-global":116}],121:[function(r,s,i){var a=r("../internals/is-pure"),l=r("../internals/shared-store");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:a?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":76,"../internals/shared-store":120}],122:[function(r,s,i){var a=r("../internals/an-object"),l=r("../internals/a-function"),c=r("../internals/well-known-symbol")("species");s.exports=function(h,f){var h=a(h).constructor;return h===void 0||(h=a(h)[c])==null?f:l(h)}},{"../internals/a-function":5,"../internals/an-object":10,"../internals/well-known-symbol":149}],123:[function(r,s,i){var a=r("../internals/fails");s.exports=function(l){return a(function(){var c=""[l]('"');return c!==c.toLowerCase()||3<c.split('"').length})}},{"../internals/fails":51}],124:[function(r,s,i){function a(u){return function(p,m){var d,p=String(c(p)),m=l(m),g=p.length;return m<0||g<=m?u?"":void 0:(d=p.charCodeAt(m))<55296||56319<d||m+1===g||(g=p.charCodeAt(m+1))<56320||57343<g?u?p.charAt(m):d:u?p.slice(m,m+2):g-56320+(d-55296<<10)+65536}}var l=r("../internals/to-integer"),c=r("../internals/require-object-coercible");s.exports={codeAt:a(!1),charAt:a(!0)}},{"../internals/require-object-coercible":114,"../internals/to-integer":136}],125:[function(r,s,i){r=r("../internals/engine-user-agent"),s.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},{"../internals/engine-user-agent":47}],126:[function(r,s,i){function a(h){return function(g,v,y){var g=String(u(g)),b=g.length,y=y===void 0?" ":String(y),v=l(v);return v<=b||y==""?g:((b=c.call(y,f((v=v-b)/y.length))).length>v&&(b=b.slice(0,v)),h?g+b:b+g)}}var l=r("../internals/to-length"),c=r("../internals/string-repeat"),u=r("../internals/require-object-coercible"),f=Math.ceil;s.exports={start:a(!1),end:a(!0)}},{"../internals/require-object-coercible":114,"../internals/string-repeat":128,"../internals/to-length":137}],127:[function(r,s,i){function a(x){return x+22+75*(x<26)}function l(x){var S,w=[],E=(x=function(q){for(var J=[],ae=0,I=q.length;ae<I;){var U,z=q.charCodeAt(ae++);55296<=z&&z<=56319&&ae<I?(64512&(U=q.charCodeAt(ae++)))==56320?J.push(((1023&z)<<10)+(1023&U)+65536):(J.push(z),ae--):J.push(z)}return J}(x)).length,j=128,P=0,M=72;for(A=0;A<x.length;A++)(S=x[A])<128&&w.push(v(S));var O=w.length,k=O;for(O&&w.push("-");k<E;){for(var F=c,A=0;A<x.length;A++)j<=(S=x[A])&&S<F&&(F=S);var N=k+1;if(F-j>y((c-P)/N))throw RangeError(g);for(P+=(F-j)*N,j=F,A=0;A<x.length;A++){if((S=x[A])<j&&++P>c)throw RangeError(g);if(S==j){for(var $=P,G=u;;G+=u){var X=G<=M?1:M+f<=G?f:G-M;if($<X)break;var W=$-X,V=u-X;w.push(v(a(X+W%V))),$=y(W/V)}w.push(v(a($))),M=function(q,J,ae){var I=0;for(q=ae?y(q/d):q>>1,q+=y(q/J);b*f>>1<q;I+=u)q=y(q/b);return y(I+(b+1)*q/(q+h))}(P,N,k==O),P=0,++k}}++P,++j}return w.join("")}var c=2147483647,u=36,f=26,h=38,d=700,p=/[^\0-\u007E]/,m=/[.\u3002\uFF0E\uFF61]/g,g="Overflow: input needs wider integers to process",b=u-1,y=Math.floor,v=String.fromCharCode;s.exports=function(x){for(var S,w=[],E=x.toLowerCase().replace(m,".").split("."),j=0;j<E.length;j++)S=E[j],w.push(p.test(S)?"xn--"+l(S):S);return w.join(".")}},{}],128:[function(r,s,i){var a=r("../internals/to-integer"),l=r("../internals/require-object-coercible");s.exports="".repeat||function(c){var u=String(l(this)),f="",h=a(c);if(h<0||h==1/0)throw RangeError("Wrong number of repetitions");for(;0<h;(h>>>=1)&&(u+=u))1&h&&(f+=u);return f}},{"../internals/require-object-coercible":114,"../internals/to-integer":136}],129:[function(r,s,i){var a=r("../internals/fails"),l=r("../internals/whitespaces");s.exports=function(c){return a(function(){return!!l[c]()||"​᠎"[c]()!="​᠎"||l[c].name!==c})}},{"../internals/fails":51,"../internals/whitespaces":150}],130:[function(c,s,i){function a(h){return function(d){return d=String(l(d)),1&h&&(d=d.replace(u,"")),d=2&h?d.replace(f,""):d}}var l=c("../internals/require-object-coercible"),c="["+c("../internals/whitespaces")+"]",u=RegExp("^"+c+c+"*"),f=RegExp(c+c+"*$");s.exports={start:a(1),end:a(2),trim:a(3)}},{"../internals/require-object-coercible":114,"../internals/whitespaces":150}],131:[function(b,s,i){function a(k){return function(){O(k)}}function l(k){O(k.data)}function c(k){f.postMessage(k+"",y.protocol+"//"+y.host)}var u,f=b("../internals/global"),h=b("../internals/fails"),d=b("../internals/classof-raw"),p=b("../internals/function-bind-context"),m=b("../internals/html"),g=b("../internals/document-create-element"),b=b("../internals/engine-is-ios"),y=f.location,v=f.setImmediate,x=f.clearImmediate,S=f.process,w=f.MessageChannel,E=f.Dispatch,j=0,P={},M="onreadystatechange",O=function(k){var F;P.hasOwnProperty(k)&&(F=P[k],delete P[k],F())};v&&x||(v=function(k){for(var F=[],A=1;A<arguments.length;)F.push(arguments[A++]);return P[++j]=function(){(typeof k=="function"?k:Function(k)).apply(void 0,F)},u(j),j},x=function(k){delete P[k]},d(S)=="process"?u=function(k){S.nextTick(a(k))}:E&&E.now?u=function(k){E.now(a(k))}:w&&!b?(b=(d=new w).port2,d.port1.onmessage=l,u=p(b.postMessage,b,1)):!f.addEventListener||typeof postMessage!="function"||f.importScripts||h(c)||y.protocol==="file:"?u=M in g("script")?function(k){m.appendChild(g("script"))[M]=function(){m.removeChild(this),O(k)}}:function(k){setTimeout(a(k),0)}:(u=c,f.addEventListener("message",l,!1))),s.exports={set:v,clear:x}},{"../internals/classof-raw":28,"../internals/document-create-element":44,"../internals/engine-is-ios":46,"../internals/fails":51,"../internals/function-bind-context":55,"../internals/global":60,"../internals/html":64}],132:[function(r,s,i){var a=r("../internals/classof-raw");s.exports=function(l){if(typeof l!="number"&&a(l)!="Number")throw TypeError("Incorrect invocation");return+l}},{"../internals/classof-raw":28}],133:[function(r,s,i){var a=r("../internals/to-integer"),l=Math.max,c=Math.min;s.exports=function(u,f){return u=a(u),u<0?l(u+f,0):c(u,f)}},{"../internals/to-integer":136}],134:[function(r,s,i){var a=r("../internals/to-integer"),l=r("../internals/to-length");s.exports=function(u){if(u===void 0)return 0;var u=a(u),f=l(u);if(u!==f)throw RangeError("Wrong length or index");return f}},{"../internals/to-integer":136,"../internals/to-length":137}],135:[function(r,s,i){var a=r("../internals/indexed-object"),l=r("../internals/require-object-coercible");s.exports=function(c){return a(l(c))}},{"../internals/indexed-object":67,"../internals/require-object-coercible":114}],136:[function(r,s,i){var a=Math.ceil,l=Math.floor;s.exports=function(c){return isNaN(c=+c)?0:(0<c?l:a)(c)}},{}],137:[function(r,s,i){var a=r("../internals/to-integer"),l=Math.min;s.exports=function(c){return 0<c?l(a(c),9007199254740991):0}},{"../internals/to-integer":136}],138:[function(r,s,i){var a=r("../internals/require-object-coercible");s.exports=function(l){return Object(a(l))}},{"../internals/require-object-coercible":114}],139:[function(r,s,i){var a=r("../internals/to-positive-integer");s.exports=function(l,c){if(l=a(l),l%c)throw RangeError("Wrong offset");return l}},{"../internals/to-positive-integer":140}],140:[function(r,s,i){var a=r("../internals/to-integer");s.exports=function(l){if(l=a(l),l<0)throw RangeError("The argument can't be less than 0");return l}},{"../internals/to-integer":136}],141:[function(r,s,i){var a=r("../internals/is-object");s.exports=function(l,c){if(!a(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!a(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!a(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!a(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":75}],142:[function(r,s,i){var a={};a[r("../internals/well-known-symbol")("toStringTag")]="z",s.exports=String(a)==="[object z]"},{"../internals/well-known-symbol":149}],143:[function(r,s,i){function a(Se,je){for(var Oe=0,We=je.length,Fe=new(oe(Se))(We);Oe<We;)Fe[Oe]=je[Oe++];return Fe}function l(Se,je){U(Se,je,{get:function(){return ae(this)[je]}})}function c(Se){return Se instanceof ne||(Se=O(Se))=="ArrayBuffer"||Se=="SharedArrayBuffer"}function u(Se,je){return de(Se)&&typeof je!="symbol"&&je in Se&&String(+je)==String(je)}function f(Se,je){return u(Se,je=P(je,!0))?x(2,Se[je]):z(Se,je)}function h(Se,je,Oe){return!(u(Se,je=P(je,!0))&&k(Oe)&&M(Oe,"value"))||M(Oe,"get")||M(Oe,"set")||Oe.configurable||M(Oe,"writable")&&!Oe.writable||M(Oe,"enumerable")&&!Oe.enumerable?U(Se,je,Oe):(Se[je]=Oe.value,Se)}var d=r("../internals/export"),p=r("../internals/global"),m=r("../internals/descriptors"),g=r("../internals/typed-array-constructors-require-wrappers"),b=r("../internals/array-buffer-view-core"),y=r("../internals/array-buffer"),v=r("../internals/an-instance"),x=r("../internals/create-property-descriptor"),S=r("../internals/create-non-enumerable-property"),w=r("../internals/to-length"),E=r("../internals/to-index"),j=r("../internals/to-offset"),P=r("../internals/to-primitive"),M=r("../internals/has"),O=r("../internals/classof"),k=r("../internals/is-object"),F=r("../internals/object-create"),A=r("../internals/object-set-prototype-of"),N=r("../internals/object-get-own-property-names").f,$=r("../internals/typed-array-from"),G=r("../internals/array-iteration").forEach,X=r("../internals/set-species"),W=r("../internals/object-define-property"),V=r("../internals/object-get-own-property-descriptor"),q=r("../internals/internal-state"),J=r("../internals/inherit-if-required"),ae=q.get,I=q.set,U=W.f,z=V.f,K=Math.round,te=p.RangeError,ne=y.ArrayBuffer,le=y.DataView,me=b.NATIVE_ARRAY_BUFFER_VIEWS,ce=b.TYPED_ARRAY_TAG,ge=b.TypedArray,pe=b.TypedArrayPrototype,oe=b.aTypedArrayConstructor,de=b.isTypedArray,xe="BYTES_PER_ELEMENT",Te="Wrong length";m?(me||(V.f=f,W.f=h,l(pe,"buffer"),l(pe,"byteOffset"),l(pe,"byteLength"),l(pe,"length")),d({target:"Object",stat:!0,forced:!me},{getOwnPropertyDescriptor:f,defineProperty:h}),s.exports=function(Ce,je,Oe){function We(Me,re){U(Me,re,{get:function(){var ie=this,ee=re;return(ie=ae(ie)).view[tt](ee*Fe+ie.byteOffset,!0)},set:function(ie){var ee=this,ue=re;ee=ae(ee),Oe&&(ie=(ie=K(ie))<0?0:255<ie?255:255&ie),ee.view[rt](ue*Fe+ee.byteOffset,ie,!0)},enumerable:!0})}var Fe=Ce.match(/\d+$/)[0]/8,ut=Ce+(Oe?"Clamped":"")+"Array",tt="get"+Ce,rt="set"+Ce,it=p[ut],nt=it,Ce=nt&&nt.prototype,Ge={};me?g&&(nt=je(function(Me,re,ie,ee){return v(Me,nt,ut),J(k(re)?c(re)?ee!==void 0?new it(re,j(ie,Fe),ee):ie!==void 0?new it(re,j(ie,Fe)):new it(re):de(re)?a(nt,re):$.call(nt,re):new it(E(re)),Me,nt)}),A&&A(nt,ge),G(N(it),function(Me){Me in nt||S(nt,Me,it[Me])}),nt.prototype=Ce):(nt=je(function(Me,re,ie,ee){v(Me,nt,ut);var ue,we,ke=0,$e=0;if(k(re)){if(!c(re))return de(re)?a(nt,re):$.call(nt,re);var Ke=re,$e=j(ie,Fe),ie=re.byteLength;if(ee===void 0){if(ie%Fe||(ue=ie-$e)<0)throw te(Te)}else if(ie<(ue=w(ee)*Fe)+$e)throw te(Te);we=ue/Fe}else we=E(re),Ke=new ne(ue=we*Fe);for(I(Me,{buffer:Ke,byteOffset:$e,byteLength:ue,length:we,view:new le(Ke)});ke<we;)We(Me,ke++)}),A&&A(nt,ge),Ce=nt.prototype=F(pe)),Ce.constructor!==nt&&S(Ce,"constructor",nt),ce&&S(Ce,ce,ut),Ge[ut]=nt,d({global:!0,forced:nt!=it,sham:!me},Ge),xe in nt||S(nt,xe,Fe),xe in Ce||S(Ce,xe,Fe),X(ut)}):s.exports=function(){}},{"../internals/an-instance":9,"../internals/array-buffer":13,"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/inherit-if-required":68,"../internals/internal-state":71,"../internals/is-object":75,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/object-set-prototype-of":102,"../internals/set-species":117,"../internals/to-index":134,"../internals/to-length":137,"../internals/to-offset":139,"../internals/to-primitive":141,"../internals/typed-array-constructors-require-wrappers":144,"../internals/typed-array-from":145}],144:[function(u,s,i){var a=u("../internals/global"),l=u("../internals/fails"),c=u("../internals/check-correctness-of-iteration"),u=u("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,f=a.ArrayBuffer,h=a.Int8Array;s.exports=!u||!l(function(){h(1)})||!l(function(){new h(-1)})||!c(function(d){new h,new h(null),new h(1.5),new h(d)},!0)||l(function(){return new h(new f(2),1,void 0).length!==1})},{"../internals/array-buffer-view-core":12,"../internals/check-correctness-of-iteration":27,"../internals/fails":51,"../internals/global":60}],145:[function(r,s,i){var a=r("../internals/to-object"),l=r("../internals/to-length"),c=r("../internals/get-iterator-method"),u=r("../internals/is-array-iterator-method"),f=r("../internals/function-bind-context"),h=r("../internals/array-buffer-view-core").aTypedArrayConstructor;s.exports=function(d){var p,m,g,b,y,v,x=a(d),S=arguments.length,w=1<S?arguments[1]:void 0,E=w!==void 0,j=c(x);if(j!=null&&!u(j))for(v=(y=j.call(x)).next,x=[];!(b=v.call(y)).done;)x.push(b.value);for(E&&2<S&&(w=f(w,arguments[2],2)),m=l(x.length),g=new(h(this))(m),p=0;p<m;p++)g[p]=E?w(x[p],p):x[p];return g}},{"../internals/array-buffer-view-core":12,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137,"../internals/to-object":138}],146:[function(r,s,i){var a=0,l=Math.random();s.exports=function(c){return"Symbol("+String(c===void 0?"":c)+")_"+(++a+l).toString(36)}},{}],147:[function(r,s,i){r=r("../internals/native-symbol"),s.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/native-symbol":84}],148:[function(r,s,i){r=r("../internals/well-known-symbol"),i.f=r},{"../internals/well-known-symbol":149}],149:[function(h,s,i){var a=h("../internals/global"),l=h("../internals/shared"),c=h("../internals/has"),u=h("../internals/uid"),f=h("../internals/native-symbol"),h=h("../internals/use-symbol-as-uid"),d=l("wks"),p=a.Symbol,m=h?p:p&&p.withoutSetter||u;s.exports=function(g){return c(d,g)||(f&&c(p,g)?d[g]=p[g]:d[g]=m("Symbol."+g)),d[g]}},{"../internals/global":60,"../internals/has":61,"../internals/native-symbol":84,"../internals/shared":121,"../internals/uid":146,"../internals/use-symbol-as-uid":147}],150:[function(r,s,i){s.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},{}],151:[function(c,s,i){var a=c("../internals/export"),l=c("../internals/global"),f=c("../internals/array-buffer"),c=c("../internals/set-species"),u="ArrayBuffer",f=f[u];a({global:!0,forced:l[u]!==f},{ArrayBuffer:f}),c(u)},{"../internals/array-buffer":13,"../internals/export":50,"../internals/global":60,"../internals/set-species":117}],152:[function(x,s,i){var a=x("../internals/export"),l=x("../internals/fails"),c=x("../internals/is-array"),u=x("../internals/is-object"),f=x("../internals/to-object"),h=x("../internals/to-length"),d=x("../internals/create-property"),p=x("../internals/array-species-create"),m=x("../internals/array-method-has-species-support"),v=x("../internals/well-known-symbol"),x=x("../internals/engine-v8-version"),g=v("isConcatSpreadable"),b=9007199254740991,y="Maximum allowed index exceeded",v=51<=x||!l(function(){var S=[];return S[g]=!1,S.concat()[0]!==S}),x=m("concat");a({target:"Array",proto:!0,forced:!v||!x},{concat:function(S){for(var w,E,j,P,M,O=f(this),k=p(O,0),F=0,A=-1,N=arguments.length;A<N;A++)if(M=void 0,!u(P=j=A===-1?O:arguments[A])||((M=P[g])!==void 0?!M:!c(P))){if(b<=F)throw TypeError(y);d(k,F++,j)}else{if(E=h(j.length),b<F+E)throw TypeError(y);for(w=0;w<E;w++,F++)w in j&&d(k,F,j[w])}return k.length=F,k}})},{"../internals/array-method-has-species-support":21,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/fails":51,"../internals/is-array":73,"../internals/is-object":75,"../internals/to-length":137,"../internals/to-object":138,"../internals/well-known-symbol":149}],153:[function(c,s,i){var a=c("../internals/export"),l=c("../internals/array-copy-within"),c=c("../internals/add-to-unscopables");a({target:"Array",proto:!0},{copyWithin:l}),c("copyWithin")},{"../internals/add-to-unscopables":7,"../internals/array-copy-within":14,"../internals/export":50}],154:[function(u,s,i){var a=u("../internals/export"),l=u("../internals/array-iteration").every,c=u("../internals/array-method-is-strict"),u=u("../internals/array-method-uses-to-length"),c=c("every"),u=u("every");a({target:"Array",proto:!0,forced:!c||!u},{every:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],155:[function(c,s,i){var a=c("../internals/export"),l=c("../internals/array-fill"),c=c("../internals/add-to-unscopables");a({target:"Array",proto:!0},{fill:l}),c("fill")},{"../internals/add-to-unscopables":7,"../internals/array-fill":15,"../internals/export":50}],156:[function(u,s,i){var a=u("../internals/export"),l=u("../internals/array-iteration").filter,c=u("../internals/array-method-has-species-support"),u=u("../internals/array-method-uses-to-length"),c=c("filter"),u=u("filter");a({target:"Array",proto:!0,forced:!c||!u},{filter:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],157:[function(h,s,i){var a=h("../internals/export"),l=h("../internals/array-iteration").findIndex,c=h("../internals/add-to-unscopables"),h=h("../internals/array-method-uses-to-length"),u="findIndex",f=!0,h=h(u);u in[]&&Array(1)[u](function(){f=!1}),a({target:"Array",proto:!0,forced:f||!h},{findIndex:function(d){return l(this,d,1<arguments.length?arguments[1]:void 0)}}),c(u)},{"../internals/add-to-unscopables":7,"../internals/array-iteration":19,"../internals/array-method-uses-to-length":23,"../internals/export":50}],158:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/flatten-into-array"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/a-function"),h=r("../internals/array-species-create");a({target:"Array",proto:!0},{flatMap:function(d){var p,m=c(this),g=u(m.length);return f(d),(p=h(m,0)).length=l(p,m,m,g,0,1,d,1<arguments.length?arguments[1]:void 0),p}})},{"../internals/a-function":5,"../internals/array-species-create":25,"../internals/export":50,"../internals/flatten-into-array":53,"../internals/to-length":137,"../internals/to-object":138}],159:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/flatten-into-array"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/to-integer"),h=r("../internals/array-species-create");a({target:"Array",proto:!0},{flat:function(){var d=arguments.length?arguments[0]:void 0,p=c(this),m=u(p.length),g=h(p,0);return g.length=l(g,p,p,m,0,d===void 0?1:f(d)),g}})},{"../internals/array-species-create":25,"../internals/export":50,"../internals/flatten-into-array":53,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],160:[function(l,s,i){var a=l("../internals/export"),l=l("../internals/array-for-each");a({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},{"../internals/array-for-each":16,"../internals/export":50}],161:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/array-from");a({target:"Array",stat:!0,forced:!r("../internals/check-correctness-of-iteration")(function(c){Array.from(c)})},{from:l})},{"../internals/array-from":17,"../internals/check-correctness-of-iteration":27,"../internals/export":50}],162:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/array-includes").includes,c=r("../internals/add-to-unscopables");a({target:"Array",proto:!0,forced:!r("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(u){return l(this,u,1<arguments.length?arguments[1]:void 0)}}),c("includes")},{"../internals/add-to-unscopables":7,"../internals/array-includes":18,"../internals/array-method-uses-to-length":23,"../internals/export":50}],163:[function(h,s,i){var a=h("../internals/export"),l=h("../internals/array-includes").indexOf,f=h("../internals/array-method-is-strict"),h=h("../internals/array-method-uses-to-length"),c=[].indexOf,u=!!c&&1/[1].indexOf(1,-0)<0,f=f("indexOf"),h=h("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:u||!f||!h},{indexOf:function(d){return u?c.apply(this,arguments)||0:l(this,d,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-includes":18,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],164:[function(f,s,i){var a=f("../internals/to-indexed-object"),l=f("../internals/add-to-unscopables"),c=f("../internals/iterators"),u=f("../internals/internal-state"),f=f("../internals/define-iterator"),h="Array Iterator",d=u.set,p=u.getterFor(h);s.exports=f(Array,"Array",function(m,g){d(this,{type:h,target:a(m),index:0,kind:g})},function(){var m=p(this),g=m.target,b=m.kind,y=m.index++;return!g||y>=g.length?{value:m.target=void 0,done:!0}:b=="keys"?{value:y,done:!1}:b=="values"?{value:g[y],done:!1}:{value:[y,g[y]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},{"../internals/add-to-unscopables":7,"../internals/define-iterator":41,"../internals/internal-state":71,"../internals/iterators":80,"../internals/to-indexed-object":135}],165:[function(f,s,i){var a=f("../internals/export"),u=f("../internals/indexed-object"),l=f("../internals/to-indexed-object"),f=f("../internals/array-method-is-strict"),c=[].join,u=u!=Object,f=f("join",",");a({target:"Array",proto:!0,forced:u||!f},{join:function(h){return c.call(l(this),h===void 0?",":h)}})},{"../internals/array-method-is-strict":22,"../internals/export":50,"../internals/indexed-object":67,"../internals/to-indexed-object":135}],166:[function(l,s,i){var a=l("../internals/export"),l=l("../internals/array-last-index-of");a({target:"Array",proto:!0,forced:l!==[].lastIndexOf},{lastIndexOf:l})},{"../internals/array-last-index-of":20,"../internals/export":50}],167:[function(u,s,i){var a=u("../internals/export"),l=u("../internals/array-iteration").map,c=u("../internals/array-method-has-species-support"),u=u("../internals/array-method-uses-to-length"),c=c("map"),u=u("map");a({target:"Array",proto:!0,forced:!c||!u},{map:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],168:[function(g,s,i){var a=g("../internals/export"),l=g("../internals/is-object"),c=g("../internals/is-array"),u=g("../internals/to-absolute-index"),f=g("../internals/to-length"),h=g("../internals/to-indexed-object"),d=g("../internals/create-property"),p=g("../internals/well-known-symbol"),m=g("../internals/array-method-has-species-support"),g=g("../internals/array-method-uses-to-length"),m=m("slice"),g=g("slice",{ACCESSORS:!0,0:0,1:2}),b=p("species"),y=[].slice,v=Math.max;a({target:"Array",proto:!0,forced:!m||!g},{slice:function(x,S){var w,E,j,P=h(this),M=f(P.length),O=u(x,M),k=u(S===void 0?M:S,M);if(c(P)&&((w=typeof(w=P.constructor)=="function"&&(w===Array||c(w.prototype))||l(w)&&(w=w[b])===null?void 0:w)===Array||w===void 0))return y.call(P,O,k);for(E=new(w===void 0?Array:w)(v(k-O,0)),j=0;O<k;O++,j++)O in P&&d(E,j,P[O]);return E.length=j,E}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/create-property":40,"../internals/export":50,"../internals/is-array":73,"../internals/is-object":75,"../internals/to-absolute-index":133,"../internals/to-indexed-object":135,"../internals/to-length":137,"../internals/well-known-symbol":149}],169:[function(u,s,i){var a=u("../internals/export"),l=u("../internals/array-iteration").some,c=u("../internals/array-method-is-strict"),u=u("../internals/array-method-uses-to-length"),c=c("some"),u=u("some");a({target:"Array",proto:!0,forced:!c||!u},{some:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],170:[function(m,s,i){var a=m("../internals/export"),l=m("../internals/to-absolute-index"),c=m("../internals/to-integer"),u=m("../internals/to-length"),f=m("../internals/to-object"),h=m("../internals/array-species-create"),d=m("../internals/create-property"),p=m("../internals/array-method-has-species-support"),m=m("../internals/array-method-uses-to-length"),p=p("splice"),m=m("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,b=Math.min;a({target:"Array",proto:!0,forced:!p||!m},{splice:function(F,v){var x,S,w,E,j,P,M=f(this),O=u(M.length),k=l(F,O),F=arguments.length;if(F===0?x=S=0:S=F===1?(x=0,O-k):(x=F-2,b(g(c(v),0),O-k)),9007199254740991<O+x-S)throw TypeError("Maximum allowed length exceeded");for(w=h(M,S),E=0;E<S;E++)(j=k+E)in M&&d(w,E,M[j]);if(x<(w.length=S)){for(E=k;E<O-S;E++)P=E+x,(j=E+S)in M?M[P]=M[j]:delete M[P];for(E=O;O-S+x<E;E--)delete M[E-1]}else if(S<x)for(E=O-S;k<E;E--)P=E+x-1,(j=E+S-1)in M?M[P]=M[j]:delete M[P];for(E=0;E<x;E++)M[E+k]=arguments[E+2];return M.length=O-S+x,w}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/export":50,"../internals/to-absolute-index":133,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],171:[function(r,s,i){r("../internals/add-to-unscopables")("flatMap")},{"../internals/add-to-unscopables":7}],172:[function(r,s,i){r("../internals/add-to-unscopables")("flat")},{"../internals/add-to-unscopables":7}],173:[function(l,s,i){var a=l("../internals/descriptors"),l=l("../internals/object-define-property").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/;!a||"name"in c||l(c,"name",{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},{"../internals/descriptors":43,"../internals/object-define-property":93}],174:[function(l,s,i){var a=l("../internals/collection"),l=l("../internals/collection-strong");s.exports=a("Map",function(c){return function(){return c(this,arguments.length?arguments[0]:void 0)}},l)},{"../internals/collection":32,"../internals/collection-strong":30}],175:[function(a,s,i){var a=a("../internals/export"),l=Math.hypot,c=Math.abs,u=Math.sqrt;a({target:"Math",stat:!0,forced:!!l&&l(1/0,NaN)!==1/0},{hypot:function(f,h){for(var d,p,m=0,g=0,b=arguments.length,y=0;g<b;)y<(d=c(arguments[g++]))?(m=m*(p=y/d)*p+1,y=d):m+=0<d?(p=d/y)*p:d;return y===1/0?1/0:y*u(m)}})},{"../internals/export":50}],176:[function(a,s,i){var a=a("../internals/export"),l=Math.log,c=Math.LN2;a({target:"Math",stat:!0},{log2:function(u){return l(u)/c}})},{"../internals/export":50}],177:[function(r,s,i){r("../internals/export")({target:"Math",stat:!0},{sign:r("../internals/math-sign")})},{"../internals/export":50,"../internals/math-sign":81}],178:[function(r,s,i){function a(A){var N,$,G,X,W,V,q,J=m(A,!1);if(typeof J=="string"&&2<J.length){if((A=(J=S(J)).charCodeAt(0))===43||A===45){if((N=J.charCodeAt(2))===88||N===120)return NaN}else if(A===48){switch(J.charCodeAt(1)){case 66:case 98:$=2,G=49;break;case 79:case 111:$=8,G=55;break;default:return+J}for(W=(X=J.slice(2)).length,V=0;V<W;V++)if((q=X.charCodeAt(V))<48||G<q)return NaN;return parseInt(X,$)}}return+J}var l=r("../internals/descriptors"),c=r("../internals/global"),u=r("../internals/is-forced"),f=r("../internals/redefine"),h=r("../internals/has"),d=r("../internals/classof-raw"),p=r("../internals/inherit-if-required"),m=r("../internals/to-primitive"),g=r("../internals/fails"),b=r("../internals/object-create"),y=r("../internals/object-get-own-property-names").f,v=r("../internals/object-get-own-property-descriptor").f,x=r("../internals/object-define-property").f,S=r("../internals/string-trim").trim,w="Number",E=c[w],j=E.prototype,P=d(b(j))==w;if(u(w,!E(" 0o1")||!E("0b1")||E("+0x1"))){for(var M,O=function(N){var N=arguments.length<1?0:N,$=this;return $ instanceof O&&(P?g(function(){j.valueOf.call($)}):d($)!=w)?p(new E(a(N)),$,O):a(N)},k=l?y(E):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),F=0;k.length>F;F++)h(E,M=k[F])&&!h(O,M)&&x(O,M,v(E,M));(O.prototype=j).constructor=O,f(c,w,O)}},{"../internals/classof-raw":28,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/has":61,"../internals/inherit-if-required":68,"../internals/is-forced":74,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/redefine":109,"../internals/string-trim":130,"../internals/to-primitive":141}],179:[function(r,s,i){r("../internals/export")({target:"Number",stat:!0},{isFinite:r("../internals/number-is-finite")})},{"../internals/export":50,"../internals/number-is-finite":89}],180:[function(h,s,i){function a(m,g,b){return g===0?b:g%2==1?a(m,g-1,b*m):a(m*m,g/2,b)}var l=h("../internals/export"),c=h("../internals/to-integer"),u=h("../internals/this-number-value"),f=h("../internals/string-repeat"),h=h("../internals/fails"),d=1 .toFixed,p=Math.floor;l({target:"Number",proto:!0,forced:d&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!h(function(){d.call({})})},{toFixed:function(w){function g(M,O){for(var k=-1,F=O;++k<6;)F+=M*E[k],E[k]=F%1e7,F=p(F/1e7)}function b(M){for(var O=6,k=0;0<=--O;)k+=E[O],E[O]=p(k/M),k=k%M*1e7}function y(){for(var M,O=6,k="";0<=--O;)k===""&&O!==0&&E[O]===0||(M=String(E[O]),k=k===""?M:k+f.call("0",7-M.length)+M);return k}var v,x,S=u(this),w=c(w),E=[0,0,0,0,0,0],j="",P="0";if(w<0||20<w)throw RangeError("Incorrect fraction digits");if(S!=S)return"NaN";if(S<=-1e21||1e21<=S)return String(S);if(S<0&&(j="-",S=-S),1e-21<S)if(S=(v=function(M){for(var O=0,k=M;4096<=k;)O+=12,k/=4096;for(;2<=k;)O+=1,k/=2;return O}(S*a(2,69,1))-69)<0?S*a(2,-v,1):S/a(2,v,1),S*=4503599627370496,0<(v=52-v)){for(g(0,S),x=w;7<=x;)g(1e7,0),x-=7;for(g(a(10,x,1),0),x=v-1;23<=x;)b(1<<23),x-=23;b(1<<x),g(1,1),b(2),P=y()}else g(0,S),g(1<<-v,0),P=y()+f.call("0",w);return P=0<w?j+((S=P.length)<=w?"0."+f.call("0",w-S)+P:P.slice(0,S-w)+"."+P.slice(S-w)):j+P}})},{"../internals/export":50,"../internals/fails":51,"../internals/string-repeat":128,"../internals/this-number-value":132,"../internals/to-integer":136}],181:[function(l,s,i){var a=l("../internals/export"),l=l("../internals/object-assign");a({target:"Object",stat:!0,forced:Object.assign!==l},{assign:l})},{"../internals/export":50,"../internals/object-assign":90}],182:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/iterate"),c=r("../internals/create-property");a({target:"Object",stat:!0},{fromEntries:function(u){var f={};return l(u,function(h,d){c(f,h,d)},void 0,!0),f}})},{"../internals/create-property":40,"../internals/export":50,"../internals/iterate":78}],183:[function(u,s,i){var a=u("../internals/export"),f=u("../internals/fails"),l=u("../internals/to-indexed-object"),c=u("../internals/object-get-own-property-descriptor").f,u=u("../internals/descriptors"),f=f(function(){c(1)});a({target:"Object",stat:!0,forced:!u||f,sham:!u},{getOwnPropertyDescriptor:function(h,d){return c(l(h),d)}})},{"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-descriptor":94,"../internals/to-indexed-object":135}],184:[function(c,s,i){var a=c("../internals/export"),l=c("../internals/fails"),c=c("../internals/object-get-own-property-names-external").f;a({target:"Object",stat:!0,forced:l(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:c})},{"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-names-external":95}],185:[function(f,s,i){var a=f("../internals/export"),l=f("../internals/fails"),c=f("../internals/to-object"),u=f("../internals/object-get-prototype-of"),f=f("../internals/correct-prototype-getter");a({target:"Object",stat:!0,forced:l(function(){u(1)}),sham:!f},{getPrototypeOf:function(h){return u(c(h))}})},{"../internals/correct-prototype-getter":35,"../internals/export":50,"../internals/fails":51,"../internals/object-get-prototype-of":98,"../internals/to-object":138}],186:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/to-object"),c=r("../internals/object-keys");a({target:"Object",stat:!0,forced:r("../internals/fails")(function(){c(1)})},{keys:function(u){return c(l(u))}})},{"../internals/export":50,"../internals/fails":51,"../internals/object-keys":100,"../internals/to-object":138}],187:[function(c,s,i){var a=c("../internals/to-string-tag-support"),l=c("../internals/redefine"),c=c("../internals/object-to-string");a||l(Object.prototype,"toString",c,{unsafe:!0})},{"../internals/object-to-string":103,"../internals/redefine":109,"../internals/to-string-tag-support":142}],188:[function(Oe,s,i){var a,l,c,u,f=Oe("../internals/export"),h=Oe("../internals/is-pure"),d=Oe("../internals/global"),p=Oe("../internals/get-built-in"),m=Oe("../internals/native-promise-constructor"),g=Oe("../internals/redefine"),b=Oe("../internals/redefine-all"),y=Oe("../internals/set-to-string-tag"),v=Oe("../internals/set-species"),x=Oe("../internals/is-object"),S=Oe("../internals/a-function"),w=Oe("../internals/an-instance"),E=Oe("../internals/classof-raw"),j=Oe("../internals/inspect-source"),P=Oe("../internals/iterate"),M=Oe("../internals/check-correctness-of-iteration"),O=Oe("../internals/species-constructor"),k=Oe("../internals/task").set,F=Oe("../internals/microtask"),A=Oe("../internals/promise-resolve"),N=Oe("../internals/host-report-errors"),$=Oe("../internals/new-promise-capability"),G=Oe("../internals/perform"),X=Oe("../internals/internal-state"),W=Oe("../internals/is-forced"),We=Oe("../internals/well-known-symbol"),V=Oe("../internals/engine-v8-version"),q=We("species"),J="Promise",ae=X.get,I=X.set,U=X.getterFor(J),z=m,K=d.TypeError,te=d.document,ne=d.process,le=p("fetch"),me=$.f,ce=me,ge=E(ne)=="process",pe=!!(te&&te.createEvent&&d.dispatchEvent),oe="unhandledrejection",de="rejectionhandled",xe=1,Te=2,Se=1,je=2,Oe=W(J,function(){var Ge,Me;return j(z)===String(z)&&(V===66||!ge&&typeof PromiseRejectionEvent!="function")?!0:!(!h||z.prototype.finally)||!(51<=V&&/native code/.test(z))&&(Me=function(re){re(function(){},function(){})},((Ge=z.resolve(1)).constructor={})[q]=Me,!(Ge.then(function(){})instanceof Me))}),We=Oe||!M(function(Ge){z.all(Ge).catch(function(){})}),Fe=function(Ge){var Me;return!(!x(Ge)||typeof(Me=Ge.then)!="function")&&Me},ut=function(Ge,Me,re){var ie;Me.notified||(Me.notified=!0,ie=Me.reactions,F(function(){for(var ee,ue,we=Me.value,ke=Me.state==xe,$e=0;ie.length>$e;){var Ke,Qe,et,at=ie[$e++],Ot=ke?at.ok:at.fail,Ct=at.resolve,dt=at.reject,Pt=at.domain;try{Ot?(ke||(Me.rejection===je&&function(Et,rr){k.call(d,function(){ge?ne.emit("rejectionHandled",Et):tt(de,Et,rr.value)})}(Ge,Me),Me.rejection=Se),Ot===!0?Ke=we:(Pt&&Pt.enter(),Ke=Ot(we),Pt&&(Pt.exit(),et=!0)),Ke===at.promise?dt(K("Promise-chain cycle")):(Qe=Fe(Ke))?Qe.call(Ke,Ct,dt):Ct(Ke)):dt(we)}catch(Et){Pt&&!et&&Pt.exit(),dt(Et)}}Me.reactions=[],Me.notified=!1,re&&!Me.rejection&&(ee=Ge,ue=Me,k.call(d,function(){var Et=ue.value,rr=rt(ue);if(rr&&(rr=G(function(){ge?ne.emit("unhandledRejection",Et,ee):tt(oe,ee,Et)}),ue.rejection=ge||rt(ue)?je:Se,rr.error))throw rr.value}))}))},tt=function(Ge,Me,re){var ie;pe?((ie=te.createEvent("Event")).promise=Me,ie.reason=re,ie.initEvent(Ge,!1,!0),d.dispatchEvent(ie)):ie={promise:Me,reason:re},(Me=d["on"+Ge])?Me(ie):Ge===oe&&N("Unhandled promise rejection",re)},rt=function(Ge){return Ge.rejection!==Se&&!Ge.parent},it=function(Ge,Me,re,ie){return function(ee){Ge(Me,re,ee,ie)}},nt=function(Ge,Me,re,ie){Me.done||(Me.done=!0,(Me=ie||Me).value=re,Me.state=Te,ut(Ge,Me,!0))},Ce=function(Ge,Me,re,ie){if(!Me.done){Me.done=!0,ie&&(Me=ie);try{if(Ge===re)throw K("Promise can't be resolved itself");var ee=Fe(re);ee?F(function(){var ue={done:!1};try{ee.call(re,it(Ce,Ge,ue,Me),it(nt,Ge,ue,Me))}catch(we){nt(Ge,ue,we,Me)}}):(Me.value=re,Me.state=xe,ut(Ge,Me,!1))}catch(ue){nt(Ge,{done:!1},ue,Me)}}};Oe&&(z=function(Ge){w(this,z,J),S(Ge),a.call(this);var Me=ae(this);try{Ge(it(Ce,this,Me),it(nt,this,Me))}catch(re){nt(this,Me,re)}},(a=function(Ge){I(this,{type:J,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=b(z.prototype,{then:function(Ge,Me){var re=U(this),ie=me(O(this,z));return ie.ok=typeof Ge!="function"||Ge,ie.fail=typeof Me=="function"&&Me,ie.domain=ge?ne.domain:void 0,re.parent=!0,re.reactions.push(ie),re.state!=0&&ut(this,re,!1),ie.promise},catch:function(Ge){return this.then(void 0,Ge)}}),l=function(){var Ge=new a,Me=ae(Ge);this.promise=Ge,this.resolve=it(Ce,Ge,Me),this.reject=it(nt,Ge,Me)},$.f=me=function(Ge){return Ge===z||Ge===c?new l:ce(Ge)},h||typeof m!="function"||(u=m.prototype.then,g(m.prototype,"then",function(Ge,Me){var re=this;return new z(function(ie,ee){u.call(re,ie,ee)}).then(Ge,Me)},{unsafe:!0}),typeof le=="function"&&f({global:!0,enumerable:!0,forced:!0},{fetch:function(Ge){return A(z,le.apply(d,arguments))}}))),f({global:!0,wrap:!0,forced:Oe},{Promise:z}),y(z,J,!1,!0),v(J),c=p(J),f({target:J,stat:!0,forced:Oe},{reject:function(Ge){var Me=me(this);return Me.reject.call(void 0,Ge),Me.promise}}),f({target:J,stat:!0,forced:h||Oe},{resolve:function(Ge){return A(h&&this===c?z:this,Ge)}}),f({target:J,stat:!0,forced:We},{all:function(Ge){var Me=this,re=me(Me),ie=re.resolve,ee=re.reject,ue=G(function(){var we=S(Me.resolve),ke=[],$e=0,Ke=1;P(Ge,function(Qe){var et=$e++,at=!1;ke.push(void 0),Ke++,we.call(Me,Qe).then(function(Ot){at||(at=!0,ke[et]=Ot,--Ke||ie(ke))},ee)}),--Ke||ie(ke)});return ue.error&&ee(ue.value),re.promise},race:function(Ge){var Me=this,re=me(Me),ie=re.reject,ee=G(function(){var ue=S(Me.resolve);P(Ge,function(we){ue.call(Me,we).then(re.resolve,ie)})});return ee.error&&ie(ee.value),re.promise}})},{"../internals/a-function":5,"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/classof-raw":28,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/get-built-in":57,"../internals/global":60,"../internals/host-report-errors":63,"../internals/inspect-source":69,"../internals/internal-state":71,"../internals/is-forced":74,"../internals/is-object":75,"../internals/is-pure":76,"../internals/iterate":78,"../internals/microtask":82,"../internals/native-promise-constructor":83,"../internals/new-promise-capability":87,"../internals/perform":106,"../internals/promise-resolve":107,"../internals/redefine":109,"../internals/redefine-all":108,"../internals/set-species":117,"../internals/set-to-string-tag":118,"../internals/species-constructor":122,"../internals/task":131,"../internals/well-known-symbol":149}],189:[function(d,s,i){var a=d("../internals/export"),b=d("../internals/get-built-in"),l=d("../internals/a-function"),c=d("../internals/an-object"),u=d("../internals/is-object"),f=d("../internals/object-create"),h=d("../internals/function-bind"),d=d("../internals/fails"),p=b("Reflect","construct"),m=d(function(){function y(){}return!(p(function(){},[],y)instanceof y)}),g=!d(function(){p(function(){})}),b=m||g;a({target:"Reflect",stat:!0,forced:b,sham:b},{construct:function(y,v){l(y),c(v);var x=arguments.length<3?y:l(arguments[2]);if(g&&!m)return p(y,v,x);if(y==x){switch(v.length){case 0:return new y;case 1:return new y(v[0]);case 2:return new y(v[0],v[1]);case 3:return new y(v[0],v[1],v[2]);case 4:return new y(v[0],v[1],v[2],v[3])}var S=[null];return S.push.apply(S,v),new(h.apply(y,S))}return S=x.prototype,x=f(u(S)?S:Object.prototype),S=Function.apply.call(y,x,v),u(S)?S:x}})},{"../internals/a-function":5,"../internals/an-object":10,"../internals/export":50,"../internals/fails":51,"../internals/function-bind":56,"../internals/get-built-in":57,"../internals/is-object":75,"../internals/object-create":91}],190:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/is-object"),c=r("../internals/an-object"),u=r("../internals/has"),f=r("../internals/object-get-own-property-descriptor"),h=r("../internals/object-get-prototype-of");a({target:"Reflect",stat:!0},{get:function d(p,m){var g,b=arguments.length<3?p:arguments[2];return c(p)===b?p[m]:(g=f.f(p,m))?u(g,"value")?g.value:g.get===void 0?void 0:g.get.call(b):l(g=h(p))?d(g,m,b):void 0}})},{"../internals/an-object":10,"../internals/export":50,"../internals/has":61,"../internals/is-object":75,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-prototype-of":98}],191:[function(r,s,i){var a=r("../internals/descriptors"),l=r("../internals/global"),c=r("../internals/is-forced"),u=r("../internals/inherit-if-required"),f=r("../internals/object-define-property").f,h=r("../internals/object-get-own-property-names").f,d=r("../internals/is-regexp"),p=r("../internals/regexp-flags"),m=r("../internals/regexp-sticky-helpers"),g=r("../internals/redefine"),b=r("../internals/fails"),y=r("../internals/internal-state").set,v=r("../internals/set-species"),x=r("../internals/well-known-symbol")("match"),S=l.RegExp,w=S.prototype,E=/a/g,j=/a/g,P=new S(E)!==E,M=m.UNSUPPORTED_Y;if(a&&c("RegExp",!P||M||b(function(){return j[x]=!1,S(E)!=E||S(j)==j||S(E,"i")!="/a/i"}))){for(var O=function(A,N){var $,G=this instanceof O,X=d(A),W=N===void 0;return!G&&X&&A.constructor===O&&W?A:(P?X&&!W&&(A=A.source):A instanceof O&&(W&&(N=p.call(A)),A=A.source),M&&($=!!N&&-1<N.indexOf("y"))&&(N=N.replace(/y/g,"")),X=u(P?new S(A,N):S(A,N),G?this:w,O),M&&$&&y(X,{sticky:$}),X)},k=h(S),F=0;k.length>F;)(function(A){A in O||f(O,A,{configurable:!0,get:function(){return S[A]},set:function(N){S[A]=N}})})(k[F++]);(w.constructor=O).prototype=w,g(l,"RegExp",O)}v("RegExp")},{"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/inherit-if-required":68,"../internals/internal-state":71,"../internals/is-forced":74,"../internals/is-regexp":77,"../internals/object-define-property":93,"../internals/object-get-own-property-names":96,"../internals/redefine":109,"../internals/regexp-flags":112,"../internals/regexp-sticky-helpers":113,"../internals/set-species":117,"../internals/well-known-symbol":149}],192:[function(l,s,i){var a=l("../internals/export"),l=l("../internals/regexp-exec");a({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},{"../internals/export":50,"../internals/regexp-exec":111}],193:[function(u,s,i){var a=u("../internals/redefine"),l=u("../internals/an-object"),d=u("../internals/fails"),c=u("../internals/regexp-flags"),u="toString",f=RegExp.prototype,h=f[u],d=d(function(){return h.call({source:"a",flags:"b"})!="/a/b"}),p=h.name!=u;(d||p)&&a(RegExp.prototype,u,function(){var m=l(this),g=String(m.source),b=m.flags;return"/"+g+"/"+String(b===void 0&&m instanceof RegExp&&!("flags"in f)?c.call(m):b)},{unsafe:!0})},{"../internals/an-object":10,"../internals/fails":51,"../internals/redefine":109,"../internals/regexp-flags":112}],194:[function(l,s,i){var a=l("../internals/collection"),l=l("../internals/collection-strong");s.exports=a("Set",function(c){return function(){return c(this,arguments.length?arguments[0]:void 0)}},l)},{"../internals/collection":32,"../internals/collection-strong":30}],195:[function(h,s,i){var a=h("../internals/export"),l=h("../internals/object-get-own-property-descriptor").f,c=h("../internals/to-length"),u=h("../internals/not-a-regexp"),f=h("../internals/require-object-coercible"),m=h("../internals/correct-is-regexp-logic"),h=h("../internals/is-pure"),d="".endsWith,p=Math.min,m=m("endsWith");a({target:"String",proto:!0,forced:!!(h||m||!(a=l(String.prototype,"endsWith"))||a.writable)&&!m},{endsWith:function(g){var b=String(f(this)),y=(u(g),1<arguments.length?arguments[1]:void 0),v=c(b.length),y=y===void 0?v:p(c(y),v),v=String(g);return d?d.call(b,v,y):b.slice(y-v.length,y)===v}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":76,"../internals/not-a-regexp":88,"../internals/object-get-own-property-descriptor":94,"../internals/require-object-coercible":114,"../internals/to-length":137}],196:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/not-a-regexp"),c=r("../internals/require-object-coercible");a({target:"String",proto:!0,forced:!r("../internals/correct-is-regexp-logic")("includes")},{includes:function(u){return!!~String(c(this)).indexOf(l(u),1<arguments.length?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/not-a-regexp":88,"../internals/require-object-coercible":114}],197:[function(c,s,i){var a=c("../internals/string-multibyte").charAt,l=c("../internals/internal-state"),c=c("../internals/define-iterator"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(d){f(this,{type:u,string:String(d),index:0})},function(){var d=h(this),p=d.string,m=d.index;return m>=p.length?{value:void 0,done:!0}:(p=a(p,m),d.index+=p.length,{value:p,done:!1})})},{"../internals/define-iterator":41,"../internals/internal-state":71,"../internals/string-multibyte":124}],198:[function(r,s,i){var a=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/to-length"),u=r("../internals/require-object-coercible"),f=r("../internals/advance-string-index"),h=r("../internals/regexp-exec-abstract");a("match",1,function(d,p,m){return[function(g){var b=u(this),y=g==null?void 0:g[d];return y!==void 0?y.call(g,b):new RegExp(g)[d](String(b))},function(g){var b=m(p,g,this);if(b.done)return b.value;var y=l(g),v=String(this);if(!y.global)return h(y,v);for(var x=y.unicode,S=[],w=y.lastIndex=0;(E=h(y,v))!==null;){var E=String(E[0]);(S[w]=E)===""&&(y.lastIndex=f(v,c(y.lastIndex),x)),w++}return w===0?null:S}]})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/to-length":137}],199:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/string-pad").start;a({target:"String",proto:!0,forced:r("../internals/string-pad-webkit-bug")},{padStart:function(c){return l(this,c,1<arguments.length?arguments[1]:void 0)}})},{"../internals/export":50,"../internals/string-pad":126,"../internals/string-pad-webkit-bug":125}],200:[function(r,s,i){r("../internals/export")({target:"String",proto:!0},{repeat:r("../internals/string-repeat")})},{"../internals/export":50,"../internals/string-repeat":128}],201:[function(r,s,i){var a=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/to-integer"),h=r("../internals/require-object-coercible"),d=r("../internals/advance-string-index"),p=r("../internals/regexp-exec-abstract"),m=Math.max,g=Math.min,b=Math.floor,y=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;a("replace",2,function(x,S,w,E){var j=E.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,P=E.REPLACE_KEEPS_$0,M=j?"$":"$0";return[function(O,k){var F=h(this),A=O==null?void 0:O[x];return A!==void 0?A.call(O,F,k):S.call(String(F),O,k)},function(O,k){if(!j&&P||typeof k=="string"&&k.indexOf(M)===-1){var F=w(S,O,this,k);if(F.done)return F.value}for(var A,N=l(O),$=String(this),G=typeof k=="function",X=(G||(k=String(k)),N.global),W=(X&&(A=N.unicode,N.lastIndex=0),[]);(I=p(N,$))!==null&&(W.push(I),X);)String(I[0])===""&&(N.lastIndex=d($,u(N.lastIndex),A));for(var V,q="",J=0,ae=0;ae<W.length;ae++){for(var I=W[ae],U=String(I[0]),z=m(g(f(I.index),$.length),0),K=[],te=1;te<I.length;te++)K.push((V=I[te])===void 0?V:String(V));var ne=I.groups,le=G?(le=[U].concat(K,z,$),ne!==void 0&&le.push(ne),String(k.apply(void 0,le))):function(me,ce,ge,pe,oe,de){var xe=ge+me.length,Te=pe.length,Se=v;return oe!==void 0&&(oe=c(oe),Se=y),S.call(de,Se,function(je,Oe){var We;switch(Oe.charAt(0)){case"$":return"$";case"&":return me;case"`":return ce.slice(0,ge);case"'":return ce.slice(xe);case"<":We=oe[Oe.slice(1,-1)];break;default:var Fe,ut=+Oe;if(ut==0)return je;if(Te<ut)return(Fe=b(ut/10))!==0&&Fe<=Te?pe[Fe-1]===void 0?Oe.charAt(1):pe[Fe-1]+Oe.charAt(1):je;We=pe[ut-1]}return We===void 0?"":We})}(U,$,z,K,ne,k);J<=z&&(q+=$.slice(J,z)+le,J=z+U.length)}return q+$.slice(J)}]})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],202:[function(r,s,i){var a=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/require-object-coercible"),u=r("../internals/same-value"),f=r("../internals/regexp-exec-abstract");a("search",1,function(h,d,p){return[function(m){var g=c(this),b=m==null?void 0:m[h];return b!==void 0?b.call(m,g):new RegExp(m)[h](String(g))},function(m){var g,b=p(d,m,this);return b.done?b.value:(b=l(m),m=String(this),g=b.lastIndex,u(g,0)||(b.lastIndex=0),m=f(b,m),u(b.lastIndex,g)||(b.lastIndex=g),m===null?-1:m.index)}]})},{"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/same-value":115}],203:[function(g,s,i){var a=g("../internals/fix-regexp-well-known-symbol-logic"),l=g("../internals/is-regexp"),c=g("../internals/an-object"),u=g("../internals/require-object-coercible"),f=g("../internals/species-constructor"),h=g("../internals/advance-string-index"),d=g("../internals/to-length"),p=g("../internals/regexp-exec-abstract"),m=g("../internals/regexp-exec"),g=g("../internals/fails"),b=[].push,y=Math.min,v=4294967295,x=!g(function(){return!RegExp(v,"y")});a("split",2,function(S,w,E){var j="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(P,M){var O=String(u(this)),k=M===void 0?v:M>>>0;if(k==0)return[];if(P===void 0)return[O];if(!l(P))return w.call(O,P,k);for(var F,A,N,$=[],M=(P.ignoreCase?"i":"")+(P.multiline?"m":"")+(P.unicode?"u":"")+(P.sticky?"y":""),G=0,X=new RegExp(P.source,M+"g");(F=m.call(X,O))&&!(G<(A=X.lastIndex)&&($.push(O.slice(G,F.index)),1<F.length&&F.index<O.length&&b.apply($,F.slice(1)),N=F[0].length,G=A,$.length>=k));)X.lastIndex===F.index&&X.lastIndex++;return G===O.length?!N&&X.test("")||$.push(""):$.push(O.slice(G)),$.length>k?$.slice(0,k):$}:"0".split(void 0,0).length?function(P,M){return P===void 0&&M===0?[]:w.call(this,P,M)}:w;return[function(P,M){var O=u(this),k=P==null?void 0:P[S];return k!==void 0?k.call(P,O,M):j.call(String(O),P,M)},function(F,M){var O=E(j,F,this,M,j!==w);if(O.done)return O.value;var O=c(F),k=String(this),F=f(O,RegExp),A=O.unicode,N=(O.ignoreCase?"i":"")+(O.multiline?"m":"")+(O.unicode?"u":"")+(x?"y":"g"),$=new F(x?O:"^(?:"+O.source+")",N),G=M===void 0?v:M>>>0;if(G==0)return[];if(k.length===0)return p($,k)===null?[k]:[];for(var X=0,W=0,V=[];W<k.length;){$.lastIndex=x?W:0;var q,J=p($,x?k:k.slice(W));if(J===null||(q=y(d($.lastIndex+(x?0:W)),k.length))===X)W=h(k,W,A);else{if(V.push(k.slice(X,W)),V.length===G)return V;for(var ae=1;ae<=J.length-1;ae++)if(V.push(J[ae]),V.length===G)return V;W=X=q}}return V.push(k.slice(X)),V}]},!x)},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fails":51,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/is-regexp":77,"../internals/regexp-exec":111,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/species-constructor":122,"../internals/to-length":137}],204:[function(h,s,i){var a=h("../internals/export"),l=h("../internals/object-get-own-property-descriptor").f,c=h("../internals/to-length"),u=h("../internals/not-a-regexp"),f=h("../internals/require-object-coercible"),m=h("../internals/correct-is-regexp-logic"),h=h("../internals/is-pure"),d="".startsWith,p=Math.min,m=m("startsWith");a({target:"String",proto:!0,forced:!!(h||m||!(a=l(String.prototype,"startsWith"))||a.writable)&&!m},{startsWith:function(v){var b=String(f(this)),y=(u(v),c(p(1<arguments.length?arguments[1]:void 0,b.length))),v=String(v);return d?d.call(b,v,y):b.slice(y,y+v.length)===v}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":76,"../internals/not-a-regexp":88,"../internals/object-get-own-property-descriptor":94,"../internals/require-object-coercible":114,"../internals/to-length":137}],205:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/create-html");a({target:"String",proto:!0,forced:r("../internals/string-html-forced")("sub")},{sub:function(){return l(this,"sub","","")}})},{"../internals/create-html":36,"../internals/export":50,"../internals/string-html-forced":123}],206:[function(r,s,i){var a=r("../internals/export"),l=r("../internals/string-trim").trim;a({target:"String",proto:!0,forced:r("../internals/string-trim-forced")("trim")},{trim:function(){return l(this)}})},{"../internals/export":50,"../internals/string-trim":130,"../internals/string-trim-forced":129}],207:[function(y,s,i){var a,l,c,u,f,h=y("../internals/export"),d=y("../internals/descriptors"),p=y("../internals/global"),m=y("../internals/has"),g=y("../internals/is-object"),b=y("../internals/object-define-property").f,y=y("../internals/copy-constructor-properties"),v=p.Symbol;!d||typeof v!="function"||"description"in v.prototype&&v().description===void 0||(a={},y(l=function(){var x=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),S=this instanceof l?new v(x):x===void 0?v():v(x);return x===""&&(a[S]=!0),S},v),(p=l.prototype=v.prototype).constructor=l,c=p.toString,u=String(v("test"))=="Symbol(test)",f=/^Symbol\((.*)\)[^)]+$/,b(p,"description",{configurable:!0,get:function(){var x=g(this)?this.valueOf():this,S=c.call(x);return m(a,x)?"":(x=u?S.slice(7,-1):S.replace(f,"$1"))===""?void 0:x}}),h({global:!0,forced:!0},{Symbol:l}))},{"../internals/copy-constructor-properties":33,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/is-object":75,"../internals/object-define-property":93}],208:[function(r,s,i){r("../internals/define-well-known-symbol")("iterator")},{"../internals/define-well-known-symbol":42}],209:[function(ce,s,i){function a(ee,ue){var we=We[ee]=O(de[me]);return ge(we,{type:le,tag:ee,description:ue}),m||(we.description=ue),we}function l(ee,ke){w(ee);var we=j(ke),ke=k(we).concat(ie(we));return te(ke,function($e){m&&!re.call(we,$e)||Me(ee,$e,we[$e])}),ee}function c(ke,$e){var we,ke=j(ke),$e=P($e,!0);if(ke!==oe||!v(We,$e)||v(Fe,$e))return!(we=Te(ke,$e))||!v(We,$e)||v(ke,ne)&&ke[ne][$e]||(we.enumerable=!0),we}function u(ue){var ue=je(j(ue)),we=[];return te(ue,function(ke){v(We,ke)||v(J,ke)||we.push(ke)}),we}var f=ce("../internals/export"),h=ce("../internals/global"),d=ce("../internals/get-built-in"),p=ce("../internals/is-pure"),m=ce("../internals/descriptors"),g=ce("../internals/native-symbol"),b=ce("../internals/use-symbol-as-uid"),y=ce("../internals/fails"),v=ce("../internals/has"),x=ce("../internals/is-array"),S=ce("../internals/is-object"),w=ce("../internals/an-object"),E=ce("../internals/to-object"),j=ce("../internals/to-indexed-object"),P=ce("../internals/to-primitive"),M=ce("../internals/create-property-descriptor"),O=ce("../internals/object-create"),k=ce("../internals/object-keys"),F=ce("../internals/object-get-own-property-names"),A=ce("../internals/object-get-own-property-names-external"),N=ce("../internals/object-get-own-property-symbols"),$=ce("../internals/object-get-own-property-descriptor"),G=ce("../internals/object-define-property"),X=ce("../internals/object-property-is-enumerable"),W=ce("../internals/create-non-enumerable-property"),V=ce("../internals/redefine"),q=ce("../internals/shared"),rt=ce("../internals/shared-key"),J=ce("../internals/hidden-keys"),ae=ce("../internals/uid"),I=ce("../internals/well-known-symbol"),U=ce("../internals/well-known-symbol-wrapped"),z=ce("../internals/define-well-known-symbol"),K=ce("../internals/set-to-string-tag"),it=ce("../internals/internal-state"),te=ce("../internals/array-iteration").forEach,ne=rt("hidden"),le="Symbol",me="prototype",ce=I("toPrimitive"),ge=it.set,pe=it.getterFor(le),oe=Object[me],de=h.Symbol,xe=d("JSON","stringify"),Te=$.f,Se=G.f,je=A.f,Oe=X.f,We=q("symbols"),Fe=q("op-symbols"),ut=q("string-to-symbol-registry"),tt=q("symbol-to-string-registry"),rt=q("wks"),it=h.QObject,nt=!it||!it[me]||!it[me].findChild,Ce=m&&y(function(){return O(Se({},"a",{get:function(){return Se(this,"a",{value:7}).a}})).a!=7})?function(ee,ue,we){var ke=Te(oe,ue);ke&&delete oe[ue],Se(ee,ue,we),ke&&ee!==oe&&Se(oe,ue,ke)}:Se,Ge=b?function(ee){return typeof ee=="symbol"}:function(ee){return Object(ee)instanceof de},Me=function(ee,ue,we){return ee===oe&&Me(Fe,ue,we),w(ee),ue=P(ue,!0),w(we),(v(We,ue)?(we.enumerable?(v(ee,ne)&&ee[ne][ue]&&(ee[ne][ue]=!1),we=O(we,{enumerable:M(0,!1)})):(v(ee,ne)||Se(ee,ne,M(1,{})),ee[ne][ue]=!0),Ce):Se)(ee,ue,we)},re=function(ue){var ue=P(ue,!0),we=Oe.call(this,ue);return!(this===oe&&v(We,ue)&&!v(Fe,ue))&&(!(we||!v(this,ue)||!v(We,ue)||v(this,ne)&&this[ne][ue])||we)},ie=function(we){var ue=we===oe,we=je(ue?Fe:j(we)),ke=[];return te(we,function($e){!v(We,$e)||ue&&!v(oe,$e)||ke.push(We[$e])}),ke};g||(V((de=function(){if(this instanceof de)throw TypeError("Symbol is not a constructor");var ee=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,ue=ae(ee),we=function(ke){this===oe&&we.call(Fe,ke),v(this,ne)&&v(this[ne],ue)&&(this[ne][ue]=!1),Ce(this,ue,M(1,ke))};return m&&nt&&Ce(oe,ue,{configurable:!0,set:we}),a(ue,ee)})[me],"toString",function(){return pe(this).tag}),V(de,"withoutSetter",function(ee){return a(ae(ee),ee)}),X.f=re,G.f=Me,$.f=c,F.f=A.f=u,N.f=ie,U.f=function(ee){return a(I(ee),ee)},m&&(Se(de[me],"description",{configurable:!0,get:function(){return pe(this).description}}),p||V(oe,"propertyIsEnumerable",re,{unsafe:!0}))),f({global:!0,wrap:!0,forced:!g,sham:!g},{Symbol:de}),te(k(rt),function(ee){z(ee)}),f({target:le,stat:!0,forced:!g},{for:function(we){var ue,we=String(we);return v(ut,we)?ut[we]:(ue=de(we),ut[we]=ue,tt[ue]=we,ue)},keyFor:function(ee){if(!Ge(ee))throw TypeError(ee+" is not a symbol");if(v(tt,ee))return tt[ee]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),f({target:"Object",stat:!0,forced:!g,sham:!m},{create:function(ee,ue){return ue===void 0?O(ee):l(O(ee),ue)},defineProperty:Me,defineProperties:l,getOwnPropertyDescriptor:c}),f({target:"Object",stat:!0,forced:!g},{getOwnPropertyNames:u,getOwnPropertySymbols:ie}),f({target:"Object",stat:!0,forced:y(function(){N.f(1)})},{getOwnPropertySymbols:function(ee){return N.f(E(ee))}}),xe&&f({target:"JSON",stat:!0,forced:!g||y(function(){var ee=de();return xe([ee])!="[null]"||xe({a:ee})!="{}"||xe(Object(ee))!="{}"})},{stringify:function(ee,ue,we){for(var ke,$e=[ee],Ke=1;Ke<arguments.length;)$e.push(arguments[Ke++]);if((S(ke=ue)||ee!==void 0)&&!Ge(ee))return x(ue)||(ue=function(Qe,et){if(typeof ke=="function"&&(et=ke.call(this,Qe,et)),!Ge(et))return et}),$e[1]=ue,xe.apply(null,$e)}}),de[me][ce]||W(de[me],ce,de[me].valueOf),K(de,le),J[ne]=!0},{"../internals/an-object":10,"../internals/array-iteration":19,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/define-well-known-symbol":42,"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/get-built-in":57,"../internals/global":60,"../internals/has":61,"../internals/hidden-keys":62,"../internals/internal-state":71,"../internals/is-array":73,"../internals/is-object":75,"../internals/is-pure":76,"../internals/native-symbol":84,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/object-get-own-property-names-external":95,"../internals/object-get-own-property-symbols":97,"../internals/object-keys":100,"../internals/object-property-is-enumerable":101,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/shared":121,"../internals/shared-key":119,"../internals/to-indexed-object":135,"../internals/to-object":138,"../internals/to-primitive":141,"../internals/uid":146,"../internals/use-symbol-as-uid":147,"../internals/well-known-symbol":149,"../internals/well-known-symbol-wrapped":148}],210:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-copy-within"),c=a.aTypedArray;(0,a.exportTypedArrayMethod)("copyWithin",function(u,f){return l.call(c(this),u,f,2<arguments.length?arguments[2]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-copy-within":14}],211:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").every,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("every",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],212:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-fill"),c=a.aTypedArray;(0,a.exportTypedArrayMethod)("fill",function(u){return l.apply(c(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-fill":15}],213:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").filter,c=r("../internals/species-constructor"),u=a.aTypedArray,f=a.aTypedArrayConstructor;(0,a.exportTypedArrayMethod)("filter",function(h){for(var d=l(u(this),h,1<arguments.length?arguments[1]:void 0),h=c(this,this.constructor),p=0,m=d.length,g=new(f(h))(m);p<m;)g[p]=d[p++];return g})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":122}],214:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").findIndex,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("findIndex",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],215:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").find,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("find",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],216:[function(r,s,i){r("../internals/typed-array-constructor")("Float32",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],217:[function(r,s,i){r("../internals/typed-array-constructor")("Float64",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],218:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").forEach,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("forEach",function(u){l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],219:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-includes").includes,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("includes",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],220:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-includes").indexOf,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("indexOf",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],221:[function(r,s,i){r("../internals/typed-array-constructor")("Int16",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],222:[function(r,s,i){r("../internals/typed-array-constructor")("Int32",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],223:[function(l,s,i){function a(){return c.call(h(this))}var m=l("../internals/global"),p=l("../internals/array-buffer-view-core"),d=l("../modules/es.array.iterator"),l=l("../internals/well-known-symbol")("iterator"),m=m.Uint8Array,c=d.values,u=d.keys,f=d.entries,h=p.aTypedArray,d=p.exportTypedArrayMethod,p=m&&m.prototype[l],m=!!p&&(p.name=="values"||p.name==null);d("entries",function(){return f.call(h(this))}),d("keys",function(){return u.call(h(this))}),d("values",a,!m),d(l,a,!m)},{"../internals/array-buffer-view-core":12,"../internals/global":60,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],224:[function(l,s,i){var l=l("../internals/array-buffer-view-core"),a=l.aTypedArray,l=l.exportTypedArrayMethod,c=[].join;l("join",function(u){return c.apply(a(this),arguments)})},{"../internals/array-buffer-view-core":12}],225:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-last-index-of"),c=a.aTypedArray;(0,a.exportTypedArrayMethod)("lastIndexOf",function(u){return l.apply(c(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-last-index-of":20}],226:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").map,c=r("../internals/species-constructor"),u=a.aTypedArray,f=a.aTypedArrayConstructor;(0,a.exportTypedArrayMethod)("map",function(h){return l(u(this),h,1<arguments.length?arguments[1]:void 0,function(d,p){return new(f(c(d,d.constructor)))(p)})})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":122}],227:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-reduce").right,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("reduceRight",function(u){return l(c(this),u,arguments.length,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],228:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-reduce").left,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("reduce",function(u){return l(c(this),u,arguments.length,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],229:[function(l,s,i){var l=l("../internals/array-buffer-view-core"),a=l.aTypedArray,l=l.exportTypedArrayMethod,c=Math.floor;l("reverse",function(){for(var u,f=a(this).length,h=c(f/2),d=0;d<h;)u=this[d],this[d++]=this[--f],this[f]=u;return this})},{"../internals/array-buffer-view-core":12}],230:[function(f,s,i){var a=f("../internals/array-buffer-view-core"),l=f("../internals/to-length"),c=f("../internals/to-offset"),u=f("../internals/to-object"),f=f("../internals/fails"),h=a.aTypedArray;(0,a.exportTypedArrayMethod)("set",function(d){h(this);var p=c(1<arguments.length?arguments[1]:void 0,1),m=this.length,g=u(d),b=l(g.length),y=0;if(m<b+p)throw RangeError("Wrong length");for(;y<b;)this[p+y]=g[y++]},f(function(){new Int8Array(1).set({})}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/to-length":137,"../internals/to-object":138,"../internals/to-offset":139}],231:[function(l,s,i){var f=l("../internals/array-buffer-view-core"),a=l("../internals/species-constructor"),l=l("../internals/fails"),c=f.aTypedArray,u=f.aTypedArrayConstructor,f=f.exportTypedArrayMethod,h=[].slice;f("slice",function(d,p){for(var m=h.call(c(this),d,p),d=a(this,this.constructor),g=0,b=m.length,y=new(u(d))(b);g<b;)y[g]=m[g++];return y},l(function(){new Int8Array(1).slice()}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/species-constructor":122}],232:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").some,c=a.aTypedArray;(0,a.exportTypedArrayMethod)("some",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],233:[function(l,s,i){var l=l("../internals/array-buffer-view-core"),a=l.aTypedArray,l=l.exportTypedArrayMethod,c=[].sort;l("sort",function(u){return c.call(a(this),u)})},{"../internals/array-buffer-view-core":12}],234:[function(r,s,i){var a=r("../internals/array-buffer-view-core"),l=r("../internals/to-length"),c=r("../internals/to-absolute-index"),u=r("../internals/species-constructor"),f=a.aTypedArray;(0,a.exportTypedArrayMethod)("subarray",function(g,d){var p=f(this),m=p.length,g=c(g,m);return new(u(p,p.constructor))(p.buffer,p.byteOffset+g*p.BYTES_PER_ELEMENT,l((d===void 0?m:c(d,m))-g))})},{"../internals/array-buffer-view-core":12,"../internals/species-constructor":122,"../internals/to-absolute-index":133,"../internals/to-length":137}],235:[function(l,s,i){var f=l("../internals/global"),a=l("../internals/array-buffer-view-core"),l=l("../internals/fails"),c=f.Int8Array,u=a.aTypedArray,f=a.exportTypedArrayMethod,h=[].toLocaleString,d=[].slice,p=!!c&&l(function(){h.call(new c(1))});f("toLocaleString",function(){return h.apply(p?d.call(u(this)):u(this),arguments)},l(function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()})||!l(function(){c.prototype.toLocaleString.call([1,2])}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":60}],236:[function(l,s,i){var a=l("../internals/array-buffer-view-core").exportTypedArrayMethod,f=l("../internals/fails"),l=l("../internals/global").Uint8Array,l=l&&l.prototype||{},c=[].toString,u=[].join,f=(f(function(){c.call({})})&&(c=function(){return u.call(this)}),l.toString!=c);a("toString",c,f)},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":60}],237:[function(r,s,i){r("../internals/typed-array-constructor")("Uint16",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],238:[function(r,s,i){r("../internals/typed-array-constructor")("Uint32",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],239:[function(r,s,i){r("../internals/typed-array-constructor")("Uint8",function(a){return function(l,c,u){return a(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],240:[function(r,s,i){r("../internals/typed-array-constructor")("Uint8",function(a){return function(l,c,u){return a(this,l,c,u)}},!0)},{"../internals/typed-array-constructor":143}],241:[function(v,w,i){function a(E){return function(){return E(this,arguments.length?arguments[0]:void 0)}}var l,c,u,f,h,x=v("../internals/global"),d=v("../internals/redefine-all"),p=v("../internals/internal-metadata"),m=v("../internals/collection"),g=v("../internals/collection-weak"),b=v("../internals/is-object"),y=v("../internals/internal-state").enforce,v=v("../internals/native-weak-map"),x=!x.ActiveXObject&&"ActiveXObject"in x,S=Object.isExtensible,w=w.exports=m("WeakMap",a,g);v&&x&&(l=g.getConstructor(a,"WeakMap",!0),p.REQUIRED=!0,m=w.prototype,c=m.delete,u=m.has,f=m.get,h=m.set,d(m,{delete:function(E){var j;return b(E)&&!S(E)?((j=y(this)).frozen||(j.frozen=new l),c.call(this,E)||j.frozen.delete(E)):c.call(this,E)},has:function(E){var j;return b(E)&&!S(E)?((j=y(this)).frozen||(j.frozen=new l),u.call(this,E)||j.frozen.has(E)):u.call(this,E)},get:function(E){var j;return!b(E)||S(E)||((j=y(this)).frozen||(j.frozen=new l),u.call(this,E))?f.call(this,E):j.frozen.get(E)},set:function(E,j){var P;return!b(E)||S(E)||((P=y(this)).frozen||(P.frozen=new l),u.call(this,E))?h.call(this,E,j):P.frozen.set(E,j),this}}))},{"../internals/collection":32,"../internals/collection-weak":31,"../internals/global":60,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/is-object":75,"../internals/native-weak-map":86,"../internals/redefine-all":108}],242:[function(r,s,i){var a,l=r("../internals/global"),c=r("../internals/dom-iterables"),u=r("../internals/array-for-each"),f=r("../internals/create-non-enumerable-property");for(a in c){var h=l[a],h=h&&h.prototype;if(h&&h.forEach!==u)try{f(h,"forEach",u)}catch{h.forEach=u}}},{"../internals/array-for-each":16,"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":60}],243:[function(h,s,i){var a,l=h("../internals/global"),c=h("../internals/dom-iterables"),u=h("../modules/es.array.iterator"),f=h("../internals/create-non-enumerable-property"),h=h("../internals/well-known-symbol"),d=h("iterator"),p=h("toStringTag"),m=u.values;for(a in c){var g=l[a],b=g&&g.prototype;if(b){if(b[d]!==m)try{f(b,d,m)}catch{b[d]=m}if(b[p]||f(b,p,a),c[a]){for(var y in u)if(b[y]!==u[y])try{f(b,y,u[y])}catch{b[y]=u[y]}}}}},{"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":60,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],244:[function(ne,s,i){ne("../modules/es.array.iterator");function a(le){try{return decodeURIComponent(le)}catch{return le}}function l(le){return z[le]}function c(le){return encodeURIComponent(le).replace(U,l)}function u(le){this.entries.length=0,K(this.entries,le)}function f(le,me){if(le<me)throw TypeError("Not enough arguments")}function h(){x(this,h,G);var le,me,ce,ge,pe,oe,de,xe,Te=0<arguments.length?arguments[0]:void 0,Se=[];if(W(this,{type:G,entries:Se,updateURL:function(){},updateSearchParams:u}),Te!==void 0)if(P(Te))if(typeof(le=F(Te))=="function")for(ce=(me=le.call(Te)).next;!(ge=ce.call(me)).done;){if((oe=(pe=(ge=k(j(ge.value))).next).call(ge)).done||(de=pe.call(ge)).done||!pe.call(ge).done)throw TypeError("Expected sequence with length 2");Se.push({key:oe.value+"",value:de.value+""})}else for(xe in Te)S(Te,xe)&&Se.push({key:xe,value:Te[xe]+""});else K(Se,typeof Te=="string"?Te.charAt(0)==="?"?Te.slice(1):Te:Te+"")}var d=ne("../internals/export"),$=ne("../internals/get-built-in"),p=ne("../internals/native-url"),m=ne("../internals/redefine"),g=ne("../internals/redefine-all"),b=ne("../internals/set-to-string-tag"),y=ne("../internals/create-iterator-constructor"),v=ne("../internals/internal-state"),x=ne("../internals/an-instance"),S=ne("../internals/has"),w=ne("../internals/function-bind-context"),E=ne("../internals/classof"),j=ne("../internals/an-object"),P=ne("../internals/is-object"),M=ne("../internals/object-create"),O=ne("../internals/create-property-descriptor"),k=ne("../internals/get-iterator"),F=ne("../internals/get-iterator-method"),ne=ne("../internals/well-known-symbol"),A=$("fetch"),N=$("Headers"),$=ne("iterator"),G="URLSearchParams",X=G+"Iterator",W=v.set,V=v.getterFor(G),q=v.getterFor(X),J=/\+/g,ae=Array(4),I=function(le){var me,ce=le.replace(J," "),ge=4;try{return decodeURIComponent(ce)}catch{for(;ge;)ce=ce.replace((me=ge--,ae[me-1]||(ae[me-1]=RegExp("((?:%[\\da-f]{2}){"+me+"})","gi"))),a);return ce}},U=/[!'()~]|%20/g,z={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},K=function(le,me){if(me)for(var ce,ge=me.split("&"),pe=0;pe<ge.length;)(ce=ge[pe++]).length&&(ce=ce.split("="),le.push({key:I(ce.shift()),value:I(ce.join("="))}))},te=y(function(le,me){W(this,{type:X,iterator:k(V(le).entries),kind:me})},"Iterator",function(){var me=q(this),le=me.kind,me=me.iterator.next(),ce=me.value;return me.done||(me.value=le==="keys"?ce.key:le==="values"?ce.value:[ce.key,ce.value]),me}),ne=h.prototype;g(ne,{append:function(le,me){f(arguments.length,2);var ce=V(this);ce.entries.push({key:le+"",value:me+""}),ce.updateURL()},delete:function(le){f(arguments.length,1);for(var me=V(this),ce=me.entries,ge=le+"",pe=0;pe<ce.length;)ce[pe].key===ge?ce.splice(pe,1):pe++;me.updateURL()},get:function(le){f(arguments.length,1);for(var me=V(this).entries,ce=le+"",ge=0;ge<me.length;ge++)if(me[ge].key===ce)return me[ge].value;return null},getAll:function(le){f(arguments.length,1);for(var me=V(this).entries,ce=le+"",ge=[],pe=0;pe<me.length;pe++)me[pe].key===ce&&ge.push(me[pe].value);return ge},has:function(le){f(arguments.length,1);for(var me=V(this).entries,ce=le+"",ge=0;ge<me.length;)if(me[ge++].key===ce)return!0;return!1},set:function(le,me){f(arguments.length,1);for(var ce,ge=V(this),pe=ge.entries,oe=!1,de=le+"",xe=me+"",Te=0;Te<pe.length;Te++)(ce=pe[Te]).key===de&&(oe?pe.splice(Te--,1):(oe=!0,ce.value=xe));oe||pe.push({key:de,value:xe}),ge.updateURL()},sort:function(){for(var le,me,ce=V(this),ge=ce.entries,pe=ge.slice(),oe=ge.length=0;oe<pe.length;oe++){for(le=pe[oe],me=0;me<oe;me++)if(ge[me].key>le.key){ge.splice(me,0,le);break}me===oe&&ge.push(le)}ce.updateURL()},forEach:function(le){for(var me,ce=V(this).entries,ge=w(le,1<arguments.length?arguments[1]:void 0,3),pe=0;pe<ce.length;)ge((me=ce[pe++]).value,me.key,this)},keys:function(){return new te(this,"keys")},values:function(){return new te(this,"values")},entries:function(){return new te(this,"entries")}},{enumerable:!0}),m(ne,$,ne.entries),m(ne,"toString",function(){for(var le,me=V(this).entries,ce=[],ge=0;ge<me.length;)le=me[ge++],ce.push(c(le.key)+"="+c(le.value));return ce.join("&")},{enumerable:!0}),b(h,G),d({global:!0,forced:!p},{URLSearchParams:h}),p||typeof A!="function"||typeof N!="function"||d({global:!0,enumerable:!0,forced:!0},{fetch:function(pe){var me,ce,ge,pe=[pe];return 1<arguments.length&&(P(me=arguments[1])&&(ce=me.body,E(ce)===G&&((ge=me.headers?new N(me.headers):new N).has("content-type")||ge.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),me=M(me,{body:O(0,String(ce)),headers:O(0,ge)}))),pe.push(me)),A.apply(this,pe)}}),s.exports={URLSearchParams:h,getState:V}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/classof":29,"../internals/create-iterator-constructor":37,"../internals/create-property-descriptor":39,"../internals/export":50,"../internals/function-bind-context":55,"../internals/get-built-in":57,"../internals/get-iterator":59,"../internals/get-iterator-method":58,"../internals/has":61,"../internals/internal-state":71,"../internals/is-object":75,"../internals/native-url":85,"../internals/object-create":91,"../internals/redefine":109,"../internals/redefine-all":108,"../internals/set-to-string-tag":118,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],245:[function(k,s,i){k("../modules/es.string.iterator");function a(be){var Ze,ct,qe,$t;if(typeof be=="number"){for(Ze=[],ct=0;ct<4;ct++)Ze.unshift(be%256),be=X(be/256);return Ze.join(".")}if(typeof be!="object")return be;for(Ze="",qe=de(be),ct=0;ct<8;ct++)$t&&be[ct]===0||($t=$t&&!1,qe===ct?(Ze+=ct?":":"::",$t=!0):(Ze+=be[ct].toString(16),ct<7&&(Ze+=":")));return"["+Ze+"]"}function l(be){return!be.host||be.cannotBeABaseURL||be.scheme=="file"}function c(be,Ze,ct,qe){var $t,ze,Wt,st=ct||Ge,Bt=0,lt="",Fr=!1,Ar=!1,Rr=!1;for(ct||(be.scheme="",be.username="",be.password="",be.host=null,be.port=null,be.path=[],be.query=null,be.fragment=null,be.cannotBeABaseURL=!1,Ze=Ze.replace(ge,"")),Ze=Ze.replace(pe,""),$t=E(Ze);Bt<=$t.length;){switch(ze=$t[Bt],st){case Ge:if(!ze||!I.test(ze)){if(ct)return q;st=re;continue}lt+=ze.toLowerCase(),st=Me;break;case Me:if(ze&&(U.test(ze)||ze=="+"||ze=="-"||ze=="."))lt+=ze.toLowerCase();else{if(ze!=":"){if(ct)return q;lt="",st=re,Bt=0;continue}if(ct&&(Fe(be)!=S(We,lt)||lt=="file"&&(ut(be)||be.port!==null)||be.scheme=="file"&&!be.host))return;if(be.scheme=lt,ct)return void(Fe(be)&&We[be.scheme]==be.port&&(be.port=null));lt="",be.scheme=="file"?st=Ot:Fe(be)&&qe&&qe.scheme==be.scheme?st=ie:Fe(be)?st=ke:$t[Bt+1]=="/"?(st=ee,Bt++):(be.cannotBeABaseURL=!0,be.path.push(""),st=rr)}break;case re:if(!qe||qe.cannotBeABaseURL&&ze!="#")return q;if(qe.cannotBeABaseURL&&ze=="#"){be.scheme=qe.scheme,be.path=qe.path.slice(),be.query=qe.query,be.fragment="",be.cannotBeABaseURL=!0,st=Wr;break}st=qe.scheme=="file"?Ot:ue;continue;case ie:if(ze!="/"||$t[Bt+1]!="/"){st=ue;continue}st=$e,Bt++;break;case ee:if(ze=="/"){st=Ke;break}st=Et;continue;case ue:if(be.scheme=qe.scheme,ze==h)be.username=qe.username,be.password=qe.password,be.host=qe.host,be.port=qe.port,be.path=qe.path.slice(),be.query=qe.query;else if(ze=="/"||ze=="\\"&&Fe(be))st=we;else if(ze=="?")be.username=qe.username,be.password=qe.password,be.host=qe.host,be.port=qe.port,be.path=qe.path.slice(),be.query="",st=Hr;else{if(ze!="#"){be.username=qe.username,be.password=qe.password,be.host=qe.host,be.port=qe.port,be.path=qe.path.slice(),be.path.pop(),st=Et;continue}be.username=qe.username,be.password=qe.password,be.host=qe.host,be.port=qe.port,be.path=qe.path.slice(),be.query=qe.query,be.fragment="",st=Wr}break;case we:if(!Fe(be)||ze!="/"&&ze!="\\"){if(ze!="/"){be.username=qe.username,be.password=qe.password,be.host=qe.host,be.port=qe.port,st=Et;continue}st=Ke}else st=$e;break;case ke:if(st=$e,ze!="/"||lt.charAt(Bt+1)!="/")continue;Bt++;break;case $e:if(ze=="/"||ze=="\\")break;st=Ke;continue;case Ke:if(ze=="@"){Fr&&(lt="%40"+lt);for(var Fr=!0,nn=E(lt),mn=0;mn<nn.length;mn++){var no=nn[mn];no!=":"||Rr?(no=Oe(no,je),Rr?be.password+=no:be.username+=no):Rr=!0}lt=""}else if(ze==h||ze=="/"||ze=="?"||ze=="#"||ze=="\\"&&Fe(be)){if(Fr&&lt=="")return V;Bt-=E(lt).length+1,lt="",st=Qe}else lt+=ze;break;case Qe:case et:if(ct&&be.scheme=="file"){st=dt;continue}if(ze!=":"||Ar){if(ze==h||ze=="/"||ze=="?"||ze=="#"||ze=="\\"&&Fe(be)){if(Fe(be)&&lt=="")return J;if(ct&&lt==""&&(ut(be)||be.port!==null))return;if(Wt=oe(be,lt))return Wt;if(lt="",st=Pt,ct)return;continue}ze=="["?Ar=!0:ze=="]"&&(Ar=!1),lt+=ze}else{if(lt=="")return J;if(Wt=oe(be,lt))return Wt;if(lt="",st=at,ct==et)return}break;case at:if(!z.test(ze)){if(ze==h||ze=="/"||ze=="?"||ze=="#"||ze=="\\"&&Fe(be)||ct){if(lt!=""){var is=parseInt(lt,10);if(65535<is)return ae;be.port=Fe(be)&&is===We[be.scheme]?null:is,lt=""}if(ct)return;st=Pt;continue}return ae}lt+=ze;break;case Ot:if(be.scheme="file",ze=="/"||ze=="\\")st=Ct;else{if(!qe||qe.scheme!="file"){st=Et;continue}if(ze==h)be.host=qe.host,be.path=qe.path.slice(),be.query=qe.query;else if(ze=="?")be.host=qe.host,be.path=qe.path.slice(),be.query="",st=Hr;else{if(ze!="#"){rt($t.slice(Bt).join(""))||(be.host=qe.host,be.path=qe.path.slice(),it(be)),st=Et;continue}be.host=qe.host,be.path=qe.path.slice(),be.query=qe.query,be.fragment="",st=Wr}}break;case Ct:if(ze=="/"||ze=="\\"){st=dt;break}qe&&qe.scheme=="file"&&!rt($t.slice(Bt).join(""))&&(tt(qe.path[0],!0)?be.path.push(qe.path[0]):be.host=qe.host),st=Et;continue;case dt:if(ze==h||ze=="/"||ze=="\\"||ze=="?"||ze=="#"){if(!ct&&tt(lt))st=Et;else{if(lt==""){if(be.host="",ct)return}else{if(Wt=oe(be,lt))return Wt;if(be.host=="localhost"&&(be.host=""),ct)return;lt=""}st=Pt}continue}lt+=ze;break;case Pt:if(Fe(be)){if(st=Et,ze!="/"&&ze!="\\")continue}else if(ct||ze!="?")if(ct||ze!="#"){if(ze!=h&&(st=Et,ze!="/"))continue}else be.fragment="",st=Wr;else be.query="",st=Hr;break;case Et:if(ze==h||ze=="/"||ze=="\\"&&Fe(be)||!ct&&(ze=="?"||ze=="#")){if(Ce(lt)?(it(be),ze=="/"||ze=="\\"&&Fe(be)||be.path.push("")):nt(lt)?ze=="/"||ze=="\\"&&Fe(be)||be.path.push(""):(be.scheme=="file"&&!be.path.length&&tt(lt)&&(be.host&&(be.host=""),lt=lt.charAt(0)+":"),be.path.push(lt)),lt="",be.scheme=="file"&&(ze==h||ze=="?"||ze=="#"))for(;1<be.path.length&&be.path[0]==="";)be.path.shift();ze=="?"?(be.query="",st=Hr):ze=="#"&&(be.fragment="",st=Wr)}else lt+=Oe(ze,Se);break;case rr:ze=="?"?(be.query="",st=Hr):ze=="#"?(be.fragment="",st=Wr):ze!=h&&(be.path[0]+=Oe(ze,xe));break;case Hr:ct||ze!="#"?ze!=h&&(ze=="'"&&Fe(be)?be.query+="%27":be.query+=ze=="#"?"%23":Oe(ze,xe)):(be.fragment="",st=Wr);break;case Wr:ze!=h&&(be.fragment+=Oe(ze,Te))}Bt++}}function u(ze){var Ze,ct,qe=x(this,u,"URL"),$t=1<arguments.length?arguments[1]:void 0,ze=String(ze),Wt=$(qe,{type:"URL"});if($t!==void 0){if($t instanceof u)Ze=G($t);else if(ct=c(Ze={},String($t)))throw TypeError(ct)}if(ct=c(Wt,ze,null,Ze))throw TypeError(ct);var st=Wt.searchParams=new A;($t=N(st)).updateSearchParams(Wt.query),$t.updateURL=function(){Wt.query=String(st)||null},g||(qe.href=pr.call(qe),qe.origin=Ht.call(qe),qe.protocol=pn.call(qe),qe.username=Zr.call(qe),qe.password=Jt.call(qe),qe.host=Er.call(qe),qe.hostname=al.call(qe),qe.port=ll.call(qe),qe.pathname=cl.call(qe),qe.search=sc.call(qe),qe.searchParams=ul.call(qe),qe.hash=ro.call(qe))}function f(be,Ze){return{get:be,set:Ze,configurable:!0,enumerable:!0}}var h,d,p,m=k("../internals/export"),g=k("../internals/descriptors"),b=k("../internals/native-url"),Qt=k("../internals/global"),y=k("../internals/object-define-properties"),v=k("../internals/redefine"),x=k("../internals/an-instance"),S=k("../internals/has"),w=k("../internals/object-assign"),E=k("../internals/array-from"),j=k("../internals/string-multibyte").codeAt,P=k("../internals/string-punycode-to-ascii"),M=k("../internals/set-to-string-tag"),O=k("../modules/web.url-search-params"),k=k("../internals/internal-state"),F=Qt.URL,A=O.URLSearchParams,N=O.getState,$=k.set,G=k.getterFor("URL"),X=Math.floor,W=Math.pow,V="Invalid authority",q="Invalid scheme",J="Invalid host",ae="Invalid port",I=/[A-Za-z]/,U=/[\d+-.A-Za-z]/,z=/\d/,K=/^(0x|0X)/,te=/^[0-7]+$/,ne=/^\d+$/,le=/^[\dA-Fa-f]+$/,me=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,ce=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,ge=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,pe=/[\u0009\u000A\u000D]/g,oe=function(be,Ze){var ct,qe,$t;if(Ze.charAt(0)=="[")return Ze.charAt(Ze.length-1)=="]"&&(ct=function(ze){var Wt=[0,0,0,0,0,0,0,0],st=0,Bt=null,lt=0,Fr,Ar,Rr,nn,mn,no,is,on=function(){return ze.charAt(lt)};if(on()==":"){if(ze.charAt(1)!=":")return;lt+=2,st++,Bt=st}for(;on();){if(st==8)return;if(on()==":"){if(Bt!==null)return;lt++,st++,Bt=st;continue}for(Fr=Ar=0;Ar<4&&le.test(on());)Fr=Fr*16+parseInt(on(),16),lt++,Ar++;if(on()=="."){if(Ar==0||(lt-=Ar,st>6))return;for(Rr=0;on();){if(nn=null,Rr>0)if(on()=="."&&Rr<4)lt++;else return;if(!z.test(on()))return;for(;z.test(on());){if(mn=parseInt(on(),10),nn===null)nn=mn;else{if(nn==0)return;nn=nn*10+mn}if(nn>255)return;lt++}Wt[st]=Wt[st]*256+nn,Rr++,(Rr==2||Rr==4)&&st++}if(Rr!=4)return;break}else if(on()==":"){if(lt++,!on())return}else if(on())return;Wt[st++]=Fr}if(Bt!==null)for(no=st-Bt,st=7;st!=0&&no>0;)is=Wt[st],Wt[st--]=Wt[Bt+no-1],Wt[Bt+--no]=is;else if(st!=8)return;return Wt}(Ze.slice(1,-1)))?void(be.host=ct):J;if(Fe(be))return Ze=P(Ze),me.test(Ze)||(ct=function(ze){var Wt=ze.split("."),st,Bt,lt,Fr,Ar,Rr,nn;if(Wt.length&&Wt[Wt.length-1]==""&&Wt.pop(),(st=Wt.length)>4)return ze;for(Bt=[],lt=0;lt<st;lt++){if(Fr=Wt[lt],Fr=="")return ze;if(Ar=10,Fr.length>1&&Fr.charAt(0)=="0"&&(Ar=K.test(Fr)?16:8,Fr=Fr.slice(Ar==8?1:2)),Fr==="")Rr=0;else{if(!(Ar==10?ne:Ar==8?te:le).test(Fr))return ze;Rr=parseInt(Fr,Ar)}Bt.push(Rr)}for(lt=0;lt<st;lt++)if(Rr=Bt[lt],lt==st-1){if(Rr>=W(256,5-st))return null}else if(Rr>255)return null;for(nn=Bt.pop(),lt=0;lt<Bt.length;lt++)nn+=Bt[lt]*W(256,3-lt);return nn}(Ze))===null?J:void(be.host=ct);if(ce.test(Ze))return J;for(ct="",qe=E(Ze),$t=0;$t<qe.length;$t++)ct+=Oe(qe[$t],xe);be.host=ct},de=function(be){for(var Ze=null,ct=1,qe=null,$t=0,ze=0;ze<8;ze++)be[ze]!==0?(ct<$t&&(Ze=qe,ct=$t),qe=null,$t=0):(qe===null&&(qe=ze),++$t);return ct<$t&&(Ze=qe,ct=$t),Ze},xe={},Te=w({},xe,{" ":1,'"':1,"<":1,">":1,"`":1}),Se=w({},Te,{"#":1,"?":1,"{":1,"}":1}),je=w({},Se,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Oe=function(be,Ze){var ct=j(be,0);return 32<ct&&ct<127&&!S(Ze,be)?be:encodeURIComponent(be)},We={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Fe=function(be){return S(We,be.scheme)},ut=function(be){return be.username!=""||be.password!=""},tt=function(be,Ze){return be.length==2&&I.test(be.charAt(0))&&((be=be.charAt(1))==":"||!Ze&&be=="|")},rt=function(be){return 1<be.length&&tt(be.slice(0,2))&&(be.length==2||(be=be.charAt(2))==="/"||be==="\\"||be==="?"||be==="#")},it=function(be){var Ze=be.path,ct=Ze.length;!ct||be.scheme=="file"&&ct==1&&tt(Ze[0],!0)||Ze.pop()},nt=function(be){return be==="."||be.toLowerCase()==="%2e"},Ce=function(be){return(be=be.toLowerCase())===".."||be==="%2e."||be===".%2e"||be==="%2e%2e"},Ge={},Me={},re={},ie={},ee={},ue={},we={},ke={},$e={},Ke={},Qe={},et={},at={},Ot={},Ct={},dt={},Pt={},Et={},rr={},Hr={},Wr={},Qt=u.prototype,pr=function(){var be=G(this),Ze=be.scheme,ct=be.username,qe=be.password,$t=be.host,ze=be.port,Wt=be.path,st=be.query,Bt=be.fragment,lt=Ze+":";return $t!==null?(lt+="//",ut(be)&&(lt+=ct+(qe?":"+qe:"")+"@"),lt+=a($t),ze!==null&&(lt+=":"+ze)):Ze=="file"&&(lt+="//"),lt+=be.cannotBeABaseURL?Wt[0]:Wt.length?"/"+Wt.join("/"):"",st!==null&&(lt+="?"+st),Bt!==null&&(lt+="#"+Bt),lt},Ht=function(){var be=G(this),Ze=be.scheme,ct=be.port;if(Ze=="blob")try{return new URL(Ze.path[0]).origin}catch{return"null"}return Ze!="file"&&Fe(be)?Ze+"://"+a(be.host)+(ct!==null?":"+ct:""):"null"},pn=function(){return G(this).scheme+":"},Zr=function(){return G(this).username},Jt=function(){return G(this).password},Er=function(){var Ze=G(this),be=Ze.host,Ze=Ze.port;return be===null?"":Ze===null?a(be):a(be)+":"+Ze},al=function(){var be=G(this).host;return be===null?"":a(be)},ll=function(){var be=G(this).port;return be===null?"":String(be)},cl=function(){var be=G(this),Ze=be.path;return be.cannotBeABaseURL?Ze[0]:Ze.length?"/"+Ze.join("/"):""},sc=function(){var be=G(this).query;return be?"?"+be:""},ul=function(){return G(this).searchParams},ro=function(){var be=G(this).fragment;return be?"#"+be:""};g&&y(Qt,{href:f(pr,function(ct){var Ze=G(this),ct=String(ct),ct=c(Ze,ct);if(ct)throw TypeError(ct);N(Ze.searchParams).updateSearchParams(Ze.query)}),origin:f(Ht),protocol:f(pn,function(be){var Ze=G(this);c(Ze,String(be)+":",Ge)}),username:f(Zr,function(be){var Ze=G(this),ct=E(String(be));if(!l(Ze)){Ze.username="";for(var qe=0;qe<ct.length;qe++)Ze.username+=Oe(ct[qe],je)}}),password:f(Jt,function(be){var Ze=G(this),ct=E(String(be));if(!l(Ze)){Ze.password="";for(var qe=0;qe<ct.length;qe++)Ze.password+=Oe(ct[qe],je)}}),host:f(Er,function(be){var Ze=G(this);Ze.cannotBeABaseURL||c(Ze,String(be),Qe)}),hostname:f(al,function(be){var Ze=G(this);Ze.cannotBeABaseURL||c(Ze,String(be),et)}),port:f(ll,function(be){var Ze=G(this);l(Ze)||((be=String(be))==""?Ze.port=null:c(Ze,be,at))}),pathname:f(cl,function(be){var Ze=G(this);Ze.cannotBeABaseURL||(Ze.path=[],c(Ze,be+"",Pt))}),search:f(sc,function(be){var Ze=G(this);(be=String(be))==""?Ze.query=null:(be.charAt(0)=="?"&&(be=be.slice(1)),Ze.query="",c(Ze,be,Hr)),N(Ze.searchParams).updateSearchParams(Ze.query)}),searchParams:f(ul),hash:f(ro,function(be){var Ze=G(this);(be=String(be))==""?Ze.fragment=null:(be.charAt(0)=="#"&&(be=be.slice(1)),Ze.fragment="",c(Ze,be,Wr))})}),v(Qt,"toJSON",function(){return pr.call(this)},{enumerable:!0}),v(Qt,"toString",function(){return pr.call(this)},{enumerable:!0}),F&&(d=F.createObjectURL,p=F.revokeObjectURL,d&&v(u,"createObjectURL",function(be){return d.apply(F,arguments)}),p&&v(u,"revokeObjectURL",function(be){return p.apply(F,arguments)})),M(u,"URL"),m({global:!0,forced:!b,sham:!g},{URL:u})},{"../internals/an-instance":9,"../internals/array-from":17,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/internal-state":71,"../internals/native-url":85,"../internals/object-assign":90,"../internals/object-define-properties":92,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/string-multibyte":124,"../internals/string-punycode-to-ascii":127,"../modules/es.string.iterator":197,"../modules/web.url-search-params":244}],246:[function(r,s,i){s.exports=r("./").polyfill()},{"./":247}],247:[function(r,s,i){(function(a,l){var c,u;c=this,u=function(){function f(oe){return typeof oe=="function"}var h=Array.isArray||function(oe){return Object.prototype.toString.call(oe)==="[object Array]"},d=0,p=void 0,m=void 0,g=function(oe,de){w[d]=oe,w[d+1]=de,(d+=2)===2&&(m?m(E):A())},b=typeof window<"u"?window:void 0,y=b||{},y=y.MutationObserver||y.WebKitMutationObserver,v=typeof self>"u"&&a!==void 0&&{}.toString.call(a)==="[object process]",x=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function S(){var oe=setTimeout;return function(){return oe(E,1)}}var w=new Array(1e3);function E(){for(var oe=0;oe<d;oe+=2)(0,w[oe])(w[oe+1]),w[oe]=void 0,w[oe+1]=void 0;d=0}function j(){try{var oe=Function("return this")().require("vertx");return(p=oe.runOnLoop||oe.runOnContext)!==void 0?function(){p(E)}:S()}catch{return S()}}var P,M,O,A=void 0;function k(oe,de){var xe,Te=this,Se=new this.constructor($),je=(Se[N]===void 0&&le(Se),Te._state);return je?(xe=arguments[je-1],g(function(){return te(je,Se,xe,Te._result)})):z(Te,Se,oe,de),Se}function F(oe){var de;return oe&&typeof oe=="object"&&oe.constructor===this?oe:(J(de=new this($),oe),de)}var A=v?function(){return a.nextTick(E)}:y?(M=0,v=new y(E),O=document.createTextNode(""),v.observe(O,{characterData:!0}),function(){O.data=M=++M%2}):x?((P=new MessageChannel).port1.onmessage=E,function(){return P.port2.postMessage(0)}):(b===void 0&&typeof r=="function"?j:S)(),N=Math.random().toString(36).substring(2);function $(){}var G=void 0,X=1,W=2;function V(oe,de,xe){g(function(Te){var Se=!1,je=function(Oe,We,Fe,ut){try{Oe.call(We,Fe,ut)}catch(tt){return tt}}(xe,de,function(Oe){Se||(Se=!0,(de!==Oe?J:I)(Te,Oe))},function(Oe){Se||(Se=!0,U(Te,Oe))},Te._label);!Se&&je&&(Se=!0,U(Te,je))},oe)}function q(oe,de,xe){var Te,Se;de.constructor===oe.constructor&&xe===k&&de.constructor.resolve===F?(Te=oe,(Se=de)._state===X?I(Te,Se._result):Se._state===W?U(Te,Se._result):z(Se,void 0,function(je){return J(Te,je)},function(je){return U(Te,je)})):xe!==void 0&&f(xe)?V(oe,de,xe):I(oe,de)}function J(oe,de){if(oe===de)U(oe,new TypeError("You cannot resolve a promise with itself"));else if(xe=typeof de,de===null||xe!="object"&&xe!="function")I(oe,de);else{xe=void 0;try{xe=de.then}catch(Te){return void U(oe,Te)}q(oe,de,xe)}var xe}function ae(oe){oe._onerror&&oe._onerror(oe._result),K(oe)}function I(oe,de){oe._state===G&&(oe._result=de,oe._state=X,oe._subscribers.length!==0&&g(K,oe))}function U(oe,de){oe._state===G&&(oe._state=W,oe._result=de,g(ae,oe))}function z(oe,de,xe,Te){var Se=oe._subscribers,je=Se.length;oe._onerror=null,Se[je]=de,Se[je+X]=xe,Se[je+W]=Te,je===0&&oe._state&&g(K,oe)}function K(oe){var de=oe._subscribers,xe=oe._state;if(de.length!==0){for(var Te,Se=void 0,je=oe._result,Oe=0;Oe<de.length;Oe+=3)Te=de[Oe],Se=de[Oe+xe],Te?te(xe,Te,Se,je):Se(je);oe._subscribers.length=0}}function te(oe,de,xe,Te){var Se=f(xe),je=void 0,Oe=void 0,We=!0;if(Se){try{je=xe(Te)}catch(Fe){We=!1,Oe=Fe}if(de===je)return void U(de,new TypeError("A promises callback cannot return that same promise."))}else je=Te;de._state===G&&(Se&&We?J(de,je):We===!1?U(de,Oe):oe===X?I(de,je):oe===W&&U(de,je))}var ne=0;function le(oe){oe[N]=ne++,oe._state=void 0,oe._result=void 0,oe._subscribers=[]}ce.prototype._enumerate=function(oe){for(var de=0;this._state===G&&de<oe.length;de++)this._eachEntry(oe[de],de)},ce.prototype._eachEntry=function(oe,de){var xe=this._instanceConstructor,Te=xe.resolve;if(Te===F){var Se,je=void 0,Oe=void 0,We=!1;try{je=oe.then}catch(Fe){We=!0,Oe=Fe}je===k&&oe._state!==G?this._settledAt(oe._state,de,oe._result):typeof je!="function"?(this._remaining--,this._result[de]=oe):xe===ge?(Se=new xe($),We?U(Se,Oe):q(Se,oe,je),this._willSettleAt(Se,de)):this._willSettleAt(new xe(function(Fe){return Fe(oe)}),de)}else this._willSettleAt(Te(oe),de)},ce.prototype._settledAt=function(oe,de,xe){var Te=this.promise;Te._state===G&&(this._remaining--,oe===W?U(Te,xe):this._result[de]=xe),this._remaining===0&&I(Te,this._result)},ce.prototype._willSettleAt=function(oe,de){var xe=this;z(oe,void 0,function(Te){return xe._settledAt(X,de,Te)},function(Te){return xe._settledAt(W,de,Te)})};var me=ce;function ce(oe,de){this._instanceConstructor=oe,this.promise=new oe($),this.promise[N]||le(this.promise),h(de)?(this.length=de.length,this._remaining=de.length,this._result=new Array(this.length),this.length!==0&&(this.length=this.length||0,this._enumerate(de),this._remaining!==0)||I(this.promise,this._result)):U(this.promise,new Error("Array Methods must be provided an Array"))}pe.prototype.catch=function(oe){return this.then(null,oe)},pe.prototype.finally=function(oe){var de=this.constructor;return f(oe)?this.then(function(xe){return de.resolve(oe()).then(function(){return xe})},function(xe){return de.resolve(oe()).then(function(){throw xe})}):this.then(oe,oe)};var ge=pe;function pe(oe){if(this[N]=ne++,this._result=this._state=void 0,this._subscribers=[],$!==oe){if(typeof oe!="function")throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof pe))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var de=this;try{oe(function(xe){J(de,xe)},function(xe){U(de,xe)})}catch(xe){U(de,xe)}}}return ge.prototype.then=k,ge.all=function(oe){return new me(this,oe).promise},ge.race=function(oe){var de=this;return h(oe)?new de(function(xe,Te){for(var Se=oe.length,je=0;je<Se;je++)de.resolve(oe[je]).then(xe,Te)}):new de(function(xe,Te){return Te(new TypeError("You must pass an array to race."))})},ge.resolve=F,ge.reject=function(oe){var de=new this($);return U(de,oe),de},ge._setScheduler=function(oe){m=oe},ge._setAsap=function(oe){g=oe},ge._asap=g,ge.polyfill=function(){var oe=void 0;if(l!==void 0)oe=l;else if(typeof self<"u")oe=self;else try{oe=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var de=oe.Promise;if(de){var xe=null;try{xe=Object.prototype.toString.call(de.resolve())}catch{}if(xe==="[object Promise]"&&!de.cast)return}oe.Promise=ge},ge.Promise=ge},typeof i=="object"&&s!==void 0?s.exports=u():c.ES6Promise=u()}).call(this,r("_process"),typeof fn<"u"?fn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:256}],248:[function(r,s,i){var a,l;a=this,l=function(c,u){var f=5e3,h="callback";function d(m){try{delete window[m]}catch{window[m]=void 0}}function p(m){m=document.getElementById(m),m&&document.getElementsByTagName("head")[0].removeChild(m)}u.exports=function(m){var g=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],b=m,y=g.timeout||f,v=g.jsonpCallback||h,x=void 0;return new Promise(function(S,w){var E=g.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),j=v+"_"+E,P=(window[E]=function(M){S({ok:!0,json:function(){return Promise.resolve(M)}}),x&&clearTimeout(x),p(j),d(E)},b+=b.indexOf("?")===-1?"?":"&",document.createElement("script"));P.setAttribute("src",""+b+v+"="+E),g.charset&&P.setAttribute("charset",g.charset),P.id=j,document.getElementsByTagName("head")[0].appendChild(P),x=setTimeout(function(){w(new Error("JSONP request to "+m+" timed out")),d(E),p(j),window[E]=function(){d(E)}},y),P.onerror=function(){w(new Error("JSONP request to "+m+" failed")),d(E),p(j),x&&clearTimeout(x)}})}},i!==void 0&&s!==void 0?l(0,s):(l(l={exports:{}},l),a.fetchJsonp=l.exports)},{}],249:[function(r,s,i){var a=function(l){var c,u,f,h,d,p,m,g,b,y,v;if(!(l===void 0||typeof navigator<"u"&&/MSIE [1-9]\./.test(navigator.userAgent)))return v=l.document,c=function(){return l.URL||l.webkitURL||l},u=v.createElementNS("http://www.w3.org/1999/xhtml","a"),f="download"in u,h=/constructor/i.test(l.HTMLElement)||l.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent),p=function(x){(l.setImmediate||l.setTimeout)(function(){throw x},0)},m=4e4,g=function(x){setTimeout(function(){typeof x=="string"?c().revokeObjectURL(x):x.remove()},m)},b=function(x){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob([String.fromCharCode(65279),x],{type:x.type}):x},v=(y=function(x,S,M){M||(x=b(x));var E,j,P=this,M=x.type==="application/octet-stream",O=function(){for(var k=P,F="writestart progress write writeend".split(" "),A=void 0,N=(F=[].concat(F)).length;N--;){var $=k["on"+F[N]];if(typeof $=="function")try{$.call(k,A||k)}catch(G){p(G)}}};P.readyState=P.INIT,f?(E=c().createObjectURL(x),setTimeout(function(){var k,F;u.href=E,u.download=S,k=u,F=new MouseEvent("click"),k.dispatchEvent(F),O(),g(E),P.readyState=P.DONE})):(d||M&&h)&&l.FileReader?((j=new FileReader).onloadend=function(){var k=d?j.result:j.result.replace(/^data:[^;]*;/,"data:attachment/file;");l.open(k,"_blank")||(l.location.href=k),k=void 0,P.readyState=P.DONE,O()},j.readAsDataURL(x),P.readyState=P.INIT):(E=E||c().createObjectURL(x),!M&&l.open(E,"_blank")||(l.location.href=E),P.readyState=P.DONE,O(),g(E))}).prototype,typeof navigator<"u"&&navigator.msSaveOrOpenBlob?function(x,S,w){return S=S||x.name||"download",w||(x=b(x)),navigator.msSaveOrOpenBlob(x,S)}:(v.abort=function(){},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,function(x,S,w){return new y(x,S||x.name||"download",w)})}(typeof self<"u"&&self||typeof window<"u"&&window||this.content);s!==void 0&&s.exports?s.exports.saveAs=a:n!=null},{}],250:[function(r,s,i){var a,l=Object.defineProperty,c=(l(i,"__esModule",{value:!0}),i),u={GIFEncoder:()=>O,applyPalette:()=>function(G,X,W="rgb565"){if(!G||!G.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(G instanceof Uint8Array||G instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(256<X.length)throw new Error("applyPalette() only works with 256 colors or less");const V=new Uint32Array(G.buffer),q=V.length,J=W==="rgb444"?4096:65536,ae=new Uint8Array(q),I=new Array(J);if(W==="rgba4444")for(let pe=0;pe<q;pe++){var te=V[pe],U=te>>24&255,z=te>>16&255,K=te>>8&255,te=255&te,ne=g(te,K,z,U),ne=ne in I?I[ne]:I[ne]=function(oe,de,xe,Te,Se){let je=0,Oe=1e100;for(let tt=0;tt<Se.length;tt++){var We,Fe=Se[tt],ut=j(Fe[3]-Te);ut>Oe||(We=Fe[0],(ut+=j(We-oe))>Oe||(We=Fe[1],(ut+=j(We-de))>Oe||(We=Fe[2],(ut+=j(We-xe))>Oe||(Oe=ut,je=tt))))}return je}(te,K,z,U,X);ae[pe]=ne}else{const pe=W==="rgb444"?b:m;for(let oe=0;oe<q;oe++){var ce=V[oe],le=ce>>16&255,me=ce>>8&255,ce=255&ce,ge=pe(ce,me,le),ge=ge in I?I[ge]:I[ge]=function(de,xe,Te,Se){let je=0,Oe=1e100;for(let tt=0;tt<Se.length;tt++){var We,Fe=Se[tt],ut=j(Fe[0]-de);ut>Oe||(We=Fe[1],(ut+=j(We-xe))>Oe||(We=Fe[2],(ut+=j(We-Te))>Oe||(Oe=ut,je=tt)))}return je}(ce,me,le,X);ae[oe]=ge}}return ae},default:()=>$,nearestColor:()=>function(G,X,W=w){return G[P(G,X,W)]},nearestColorIndex:()=>P,nearestColorIndexWithDistance:()=>M,prequantize:()=>function(G,{roundRGB:X=5,roundAlpha:W=10,oneBitAlpha:V=null}={}){const q=new Uint32Array(G.buffer);for(let z=0;z<q.length;z++){var U=q[z];let K=U>>24&255;var J,ae=U>>16&255,I=U>>8&255,U=255&U;K=E(K,W),V&&(J=typeof V=="number"?V:127,K=K<=J?0:255),U=E(U,X),I=E(I,X),ae=E(ae,X),q[z]=K<<24|ae<<16|I<<8|U<<0}},quantize:()=>function(G,X,W={}){var{format:V="rgb565",clearAlpha:q=!0,clearAlphaColor:J=0,clearAlphaThreshold:ae=0,oneBitAlpha:I=!1}=W;if(!G||!G.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(G instanceof Uint8Array||G instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");G=new Uint32Array(G.buffer);let U=W.useSqrt!==!1;const z=V==="rgba4444",K=function(rt,it){const nt=it==="rgb444"?4096:65536,Ce=new Array(nt),Ge=rt.length;if(it==="rgba4444")for(let Ct=0;Ct<Ge;++Ct){var ee=rt[Ct],Me=ee>>24&255,re=ee>>16&255,ie=ee>>8&255,ee=255&ee,ue=g(ee,ie,re,Me);let dt=ue in Ce?Ce[ue]:Ce[ue]=S();dt.rc+=ee,dt.gc+=ie,dt.bc+=re,dt.ac+=Me,dt.cnt++}else if(it==="rgb444")for(let Ct=0;Ct<Ge;++Ct){var $e=rt[Ct],we=$e>>16&255,ke=$e>>8&255,$e=255&$e,Ke=b($e,ke,we);let dt=Ke in Ce?Ce[Ke]:Ce[Ke]=S();dt.rc+=$e,dt.gc+=ke,dt.bc+=we,dt.cnt++}else for(let Ct=0;Ct<Ge;++Ct){var at=rt[Ct],Qe=at>>16&255,et=at>>8&255,at=255&at,Ot=m(at,et,Qe);let dt=Ot in Ce?Ce[Ot]:Ce[Ot]=S();dt.rc+=at,dt.gc+=et,dt.bc+=Qe,dt.cnt++}return Ce}(G,V),te=K.length,ne=te-1,le=new Uint32Array(te+1);for(var me=0,ce=0;ce<te;++ce){const rt=K[ce];rt!=null&&(Fe=1/rt.cnt,z&&(rt.ac*=Fe),rt.rc*=Fe,rt.gc*=Fe,rt.bc*=Fe,K[me++]=rt)}v(X)/me<.022&&(U=!1);for(var ge,pe,oe,ce=0;ce<me-1;++ce)K[ce].fw=ce+1,K[ce+1].bk=ce,U&&(K[ce].cnt=Math.sqrt(K[ce].cnt));for(U&&(K[ce].cnt=Math.sqrt(K[ce].cnt)),ce=0;ce<me;++ce){x(K,ce,!1);var de=K[ce].err;for(pe=++le[0];1<pe&&(oe=pe>>1,!(K[ge=le[oe]].err<=de));pe=oe)le[pe]=ge;le[pe]=ce}var xe,Te=me-X;for(ce=0;ce<Te;){for(;;){var Se=le[1];if((xe=K[Se]).tm>=xe.mtm&&K[xe.nn].mtm<=xe.tm)break;for(xe.mtm==ne?Se=le[1]=le[le[0]--]:(x(K,Se,!1),xe.tm=ce),de=K[Se].err,pe=1;(oe=pe+pe)<=le[0]&&(oe<le[0]&&K[le[oe]].err>K[le[oe+1]].err&&oe++,!(de<=K[ge=le[oe]].err));pe=oe)le[pe]=ge;le[pe]=Se}var je=K[xe.nn],Oe=xe.cnt,We=je.cnt,Fe=1/(Oe+We);z&&(xe.ac=Fe*(Oe*xe.ac+We*je.ac)),xe.rc=Fe*(Oe*xe.rc+We*je.rc),xe.gc=Fe*(Oe*xe.gc+We*je.gc),xe.bc=Fe*(Oe*xe.bc+We*je.bc),xe.cnt+=je.cnt,xe.mtm=++ce,K[je.bk].fw=je.fw,K[je.fw].bk=je.bk,je.mtm=ne}let ut=[];for(ce=0;;0){let rt=y(Math.round(K[ce].rc),0,255),it=y(Math.round(K[ce].gc),0,255),nt=y(Math.round(K[ce].bc),0,255),Ce=255;z&&(Ce=y(Math.round(K[ce].ac),0,255),I&&(tt=typeof I=="number"?I:127,Ce=Ce<=tt?0:255),q&&Ce<=ae&&(rt=it=nt=J,Ce=0));var tt=z?[rt,it,nt,Ce]:[rt,it,nt];if(function(Ge,Me){for(let ee=0;ee<Ge.length;ee++){var ie=Ge[ee],re=ie[0]===Me[0]&&ie[1]===Me[1]&&ie[2]===Me[2],ie=!(4<=ie.length&&4<=Me.length)||ie[3]===Me[3];if(re&&ie)return!0}return!1}(ut,tt)||ut.push(tt),(ce=K[ce].fw)==0)break}return ut},snapColorsToPalette:()=>function(G,X,W=5){if(G.length&&X.length){var V=G.map(U=>U.slice(0,3)),q=W*W,J=G[0].length;for(let U=0;U<X.length;U++){let z=X[U];z=z.length<J?[z[0],z[1],z[2],255]:z.length>J?z.slice(0,3):z.slice();var I=M(V,z.slice(0,3),w),ae=I[0],I=I[1];0<I&&I<=q&&(G[ae]=z)}}}};for(a in u)l(c,a,{get:u[a],enumerable:!0});var f={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function h(G=256){let X=0,W=new Uint8Array(G);return{get buffer(){return W.buffer},reset(){X=0},bytesView(){return W.subarray(0,X)},bytes(){return W.slice(0,X)},writeByte(q){V(X+1),W[X]=q,X++},writeBytes(q,J=0,ae=q.length){V(X+ae);for(let I=0;I<ae;I++)W[X++]=q[I+J]},writeBytesView(q,J=0,ae=q.byteLength){V(X+ae),W.set(q.subarray(J,J+ae),X),X+=ae}};function V(q){var J=W.length;if(!(q<=J)){q=Math.max(q,J*(J<1048576?2:1.125)>>>0),J!=0&&(q=Math.max(q,256));const ae=W;W=new Uint8Array(q),0<X&&W.set(ae.subarray(0,X),0)}}}var d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],p=function(G,X,W,z,q=h(512),J=new Uint8Array(256),ae=new Int32Array(5003),I=new Int32Array(5003)){var U=ae.length,z=Math.max(2,z);J.fill(0),I.fill(0),ae.fill(-1);let K=0,te=0;var ne=z+1;const le=ne;let me=!1,ce=le,ge=(1<<ce)-1;var pe=1<<ne-1;const oe=1+pe;let de=2+pe,xe=0,Te=W[0],Se=0;for(let tt=U;tt<65536;tt*=2)++Se;Se=8-Se,q.writeByte(z),ut(pe);var je=W.length;for(let tt=1;tt<je;tt++)e:{var Oe=W[tt],We=(Oe<<12)+Te;let rt=Oe<<Se^Te;if(ae[rt]===We)Te=I[rt];else{for(var Fe=rt===0?1:U-rt;0<=ae[rt];)if((rt-=Fe)<0&&(rt+=U),ae[rt]===We){Te=I[rt];break e}ut(Te),Te=Oe,de<4096?(I[rt]=de++,ae[rt]=We):(ae.fill(-1),de=2+pe,me=!0,ut(pe))}}return ut(Te),ut(oe),q.writeByte(0),q.bytesView();function ut(tt){for(K&=d[te],0<te?K|=tt<<te:K=tt,te+=ce;8<=te;)J[xe++]=255&K,254<=xe&&(q.writeByte(xe),q.writeBytesView(J,0,xe),xe=0),K>>=8,te-=8;if((de>ge||me)&&(me?(ce=le,ge=(1<<ce)-1,me=!1):(++ce,ge=ce===12?1<<ce:(1<<ce)-1)),tt==oe){for(;0<te;)J[xe++]=255&K,254<=xe&&(q.writeByte(xe),q.writeBytesView(J,0,xe),xe=0),K>>=8,te-=8;0<xe&&(q.writeByte(xe),q.writeBytesView(J,0,xe),xe=0)}}};function m(G,X,W){return G<<8&63488|X<<2&992|W>>3}function g(G,X,W,V){return G>>4|240&X|(240&W)<<4|(240&V)<<8}function b(G,X,W){return G>>4<<8|240&X|W>>4}function y(G,X,W){return G<X?X:W<G?W:G}function v(G){return G*G}function x(G,X,W){var V=0,q=1e100;const J=G[X];for(var ae=J.cnt,I=J.ac,U=J.rc,z=J.gc,K=J.bc,te=J.fw;te!=0;te=G[te].fw){var ne,le=G[te],me=le.cnt,me=ae*me/(ae+me);q<=me||(ne=0,W&&q<=(ne+=me*v(le.ac-I))||q<=(ne+=me*v(le.rc-U))||q<=(ne+=me*v(le.gc-z))||q<=(ne+=me*v(le.bc-K))||(q=ne,V=te))}J.err=q,J.nn=V}function S(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function w(G,X){for(var W=0,V=0;V<G.length;V++){var q=G[V]-X[V];W+=q*q}return W}function E(G,X){return 1<X?Math.round(G/X)*X:G}function j(G){return G*G}function P(G,X,W=w){let V=1/0,q=-1;for(let ae=0;ae<G.length;ae++){var J=W(X,G[ae]);J<V&&(V=J,q=ae)}return q}function M(G,X,W=w){let V=1/0,q=-1;for(let ae=0;ae<G.length;ae++){var J=W(X,G[ae]);J<V&&(V=J,q=ae)}return[q,V]}function O(G={}){const{initialCapacity:X=4096,auto:W=!0}=G,V=h(X),q=new Uint8Array(256),J=new Int32Array(5003),ae=new Int32Array(5003);let I=!1;return{reset(){V.reset(),I=!1},finish(){V.writeByte(f.trailer)},bytes(){return V.bytes()},bytesView(){return V.bytesView()},get buffer(){return V.buffer},get stream(){return V},writeHeader:U,writeFrame(z,K,te,Te={}){var{transparent:le=!1,transparentIndex:me=0,delay:Fe=0,palette:ce=null,repeat:je=0,colorDepth:ge=8,dispose:pe=-1}=Te;let oe=!1;if(W?I||(oe=!0,U(),I=!0):oe=!!Te.first,K=Math.max(0,Math.floor(K)),te=Math.max(0,Math.floor(te)),oe){if(!ce)throw new Error("First frame must include a { palette } option");var[Te,Oe,xe,We,Se=8]=[V,K,te,ce,ge];We=N(We.length)-1,Se=128|Se-1<<4|We,F(Te,Oe),F(Te,xe),Te.writeBytes([Se,0,0]),k(V,ce),0<=je&&(We=V,Oe=je,We.writeByte(33),We.writeByte(255),We.writeByte(11),A(We,"NETSCAPE2.0"),We.writeByte(3),We.writeByte(1),F(We,Oe),We.writeByte(0))}var de,xe=Math.round(Fe/10),Te=V,Se=pe,je=xe,Oe=le,We=me,Fe=(Te.writeByte(33),Te.writeByte(249),Te.writeByte(4),We<0&&(We=0,Oe=!1),Oe=Oe?(de=1,2):de=0,0<=Se&&(Oe=7&Se),Oe<<=2,Te.writeByte(0|Oe|de),F(Te,je),Te.writeByte(We||0),Te.writeByte(0),!!ce&&!oe);pe=V,le=K,me=te,de=Fe?ce:null,pe.writeByte(44),F(pe,0),F(pe,0),F(pe,le),F(pe,me),de?(le=N(de.length)-1,pe.writeByte(128|le)):pe.writeByte(0),Fe&&k(V,ce),[je,Te,me,le,pe=8,Fe,ce,z]=[V,z,K,te,ge,q,J,ae],p(me,le,Te,pe,je,Fe,ce,z)}};function U(){A(V,"GIF89a")}}function k(G,X){var W=1<<N(X.length);for(let V=0;V<W;V++){let q=[0,0,0];V<X.length&&(q=X[V]),G.writeByte(q[0]),G.writeByte(q[1]),G.writeByte(q[2])}}function F(G,X){G.writeByte(255&X),G.writeByte(X>>8&255)}function A(G,X){for(var W=0;W<X.length;W++)G.writeByte(X.charCodeAt(W))}function N(G){return Math.max(Math.ceil(Math.log2(G)),1)}var $=O},{}],251:[function(r,s,i){i.read=function(a,l,c,u,x){var h,d,p=8*x-u-1,m=(1<<p)-1,g=m>>1,b=-7,y=c?x-1:0,v=c?-1:1,x=a[l+y];for(y+=v,h=x&(1<<-b)-1,x>>=-b,b+=p;0<b;h=256*h+a[l+y],y+=v,b-=8);for(d=h&(1<<-b)-1,h>>=-b,b+=u;0<b;d=256*d+a[l+y],y+=v,b-=8);if(h===0)h=1-g;else{if(h===m)return d?NaN:1/0*(x?-1:1);d+=Math.pow(2,u),h-=g}return(x?-1:1)*d*Math.pow(2,h-u)},i.write=function(a,l,c,u,f,S){var d,p,m=8*S-f-1,g=(1<<m)-1,b=g>>1,y=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=u?0:S-1,x=u?1:-1,S=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(p=isNaN(l)?1:0,d=g):(d=Math.floor(Math.log(l)/Math.LN2),l*(u=Math.pow(2,-d))<1&&(d--,u*=2),2<=(l+=1<=d+b?y/u:y*Math.pow(2,1-b))*u&&(d++,u/=2),g<=d+b?(p=0,d=g):1<=d+b?(p=(l*u-1)*Math.pow(2,f),d+=b):(p=l*Math.pow(2,b-1)*Math.pow(2,f),d=0));8<=f;a[c+v]=255&p,v+=x,p/=256,f-=8);for(d=d<<f|p,m+=f;0<m;a[c+v]=255&d,v+=x,d/=256,m-=8);a[c+v-x]|=128*S}},{}],252:[function(r,s,i){var a;function l(re,ie){return re.b===ie.b&&re.a===ie.a}function c(re,ie){return re.b<ie.b||re.b===ie.b&&re.a<=ie.a}function u(re,ie,ee){var ue=ie.b-re.b,we=ee.b-ie.b;return 0<ue+we?ue<we?ie.a-re.a+ue/(ue+we)*(re.a-ee.a):ie.a-ee.a+we/(ue+we)*(ee.a-re.a):0}function f(re,ie,ee){var ue=ie.b-re.b,we=ee.b-ie.b;return 0<ue+we?(ie.a-ee.a)*ue+(ie.a-re.a)*we:0}function h(re,ie){return re.a<ie.a||re.a===ie.a&&re.b<=ie.b}function d(re,ie,ee){var ue=ie.a-re.a,we=ee.a-ie.a;return 0<ue+we?ue<we?ie.b-re.b+ue/(ue+we)*(re.b-ee.b):ie.b-ee.b+we/(ue+we)*(ee.b-re.b):0}function p(re,ie,ee){var ue=ie.a-re.a,we=ee.a-ie.a;return 0<ue+we?(ie.b-ee.b)*ue+(ie.b-re.b)*we:0}function m(re,ie,ee,ue){return(re=re<0?0:re)<=(ee=ee<0?0:ee)?ee===0?(ie+ue)/2:ie+re/(re+ee)*(ue-ie):ue+ee/(re+ee)*(ie-ue)}function g(re){var ie=S(re.b);return E(ie,re.c),E(ie.b,re.c),j(ie,re.a),ie}function b(re,ie){var ee=!1,ue=!1;re!==ie&&(ie.a!==re.a&&(ue=!0,M(ie.a,re.a)),ie.d!==re.d&&(ee=!0,O(ie.d,re.d)),w(ie,re),ue||(E(ie,re.a),re.a.c=re),ee||(j(ie,re.d),re.d.a=re))}function y(re){var ie=re.b,ee=!1;re.d!==re.b.d&&(ee=!0,O(re.d,re.b.d)),re.c===re?M(re.a,null):(re.b.d.a=re.b.e,re.a.c=re.c,w(re,re.b.e),ee||j(re,re.d)),ie.c===ie?(M(ie.a,null),O(ie.d,null)):(re.d.a=ie.b.e,ie.a.c=ie.c,w(ie,ie.b.e)),P(re)}function v(re){var ie=S(re),ee=ie.b;return w(ie,re.e),ie.a=re.b.a,E(ee,ie.a),ie.d=ee.d=re.d,ie=ie.b,w(re.b,re.b.b.e),w(re.b,ie),re.b.a=ie.a,ie.b.a.c=ie.b,ie.b.d=re.b.d,ie.f=re.f,ie.b.f=re.b.f,ie}function x(re,ie){var ee=!1,ue=S(re),we=ue.b;return ie.d!==re.d&&(ee=!0,O(ie.d,re.d)),w(ue,re.e),w(we,ie),ue.a=re.b.a,we.a=ie.a,ue.d=we.d=re.d,re.d.a=we,ee||j(ue,re.d),ue}function S(re){var ie=new xe,ee=new xe,ue=re.b.h;return(((ee.h=ue).b.h=ie).h=re).b.h=ee,ie.b=ee,((ie.c=ie).e=ee).b=ie,(ee.c=ee).e=ie}function w(re,ie){var ee=re.c,ue=ie.c;ee.b.e=ie,(ue.b.e=re).c=ue,ie.c=ee}function E(re,ie){var ee=ie.f,ue=new Se(ie,ee);for(ee.e=ue,ee=(ie.f=ue).c=re;ee.a=ue,(ee=ee.c)!==re;);}function j(re,ie){var ee=ie.d,ue=new de(ie,ee);for(ee.b=ue,(ie.d=ue).a=re,ue.c=ie.c,ee=re;ee.d=ue,(ee=ee.e)!==re;);}function P(re){var ie=re.h;re=re.b.h,(ie.b.h=re).b.h=ie}function M(re,ie){for(var ee=re.c,ue=ee;ue.a=ie,(ue=ue.c)!==ee;);ee=re.f,((ue=re.e).f=ee).e=ue}function O(re,ie){for(var ee=re.a,ue=ee;ue.d=ie,(ue=ue.e)!==ee;);ee=re.d,((ue=re.b).d=ee).b=ue}function k(re){var ie=0;return Math.abs(re[1])>Math.abs(re[0])&&(ie=1),ie=Math.abs(re[2])>Math.abs(re[ie])?2:ie}function F(re,ie){re.f+=ie.f,re.b.f+=ie.b.f}function A(re,ie,ee){return re=re.a,ie=ie.a,ee=ee.a,ie.b.a===re?ee.b.a===re?c(ie.a,ee.a)?f(ee.b.a,ie.a,ee.a)<=0:0<=f(ie.b.a,ee.a,ie.a):f(ee.b.a,re,ee.a)<=0:ee.b.a===re?0<=f(ie.b.a,re,ie.a):(ie=u(ie.b.a,re,ie.a),(re=u(ee.b.a,re,ee.a))<=ie)}function N(re){re.a.i=null;var ie=re.e;ie.a.c=ie.c,ie.c.a=ie.a,re.e=null}function $(re,ie){y(re.a),re.c=!1,(re.a=ie).i=re}function G(re){for(var ie=re.a.a;(re=Me(re)).a.a===ie;);return re.c&&($(re,ie=x(Ge(re).a.b,re.a.e)),re=Me(re)),re}function X(re,ie,ee){var ue=new Ce;return ue.a=ee,ue.e=me(re.f,ie.e,ue),ee.i=ue}function W(re,ie){switch(re.s){case 100130:return(1&ie)!=0;case 100131:return ie!==0;case 100132:return 0<ie;case 100133:return ie<0;case 100134:return 2<=ie||ie<=-2}return!1}function V(re){var ie=re.a,ee=ie.d;ee.c=re.d,ee.a=ie,N(re)}function q(re,ie,ee){for(ie=(re=ie).a;re!==ee;){re.c=!1;var ue=Ge(re),we=ue.a;if(we.a!==ie.a){if(!ue.c){V(re);break}$(ue,we=x(ie.c.b,we.b))}ie.c!==we&&(b(we.b.e,we),b(ie,we)),V(re),ie=ue.a,re=ue}return ie}function J(re,ie,ee,ue,we,ke){for(var $e=!0;X(re,ie,ee.b),(ee=ee.c)!==ue;);for(we===null&&(we=Ge(ie).a.b.c);(ee=(ue=Ge(ie)).a.b).a===we.a;)ee.c!==we&&(b(ee.b.e,ee),b(we.b.e,ee)),ue.f=ie.f-ee.f,ue.d=W(re,ue.f),ie.b=!0,!$e&&z(re,ie)&&(F(ee,we),N(ie),y(we)),$e=!1,ie=ue,we=ee;ie.b=!0,ke&&te(re,ie)}function ae(re,ie,ee,ue,we){var ke=[ie.g[0],ie.g[1],ie.g[2]];ie.d=null,ie.d=re.o&&re.o(ke,ee,ue,re.c)||null,ie.d===null&&(we?re.n||(oe(re,100156),re.n=!0):ie.d=ee[0])}function I(re,ie,ee){var ue=[null,null,null,null];ue[0]=ie.a.d,ue[1]=ee.a.d,ae(re,ie.a,ue,[.5,.5,0,0],!1),b(ie,ee)}function U(re,ie,ee,ue,we){var ke=Math.abs(ie.b-re.b)+Math.abs(ie.a-re.a),$e=Math.abs(ee.b-re.b)+Math.abs(ee.a-re.a),Ke=we+1;ue[we]=.5*$e/(ke+$e),ue[Ke]=.5*ke/(ke+$e),re.g[0]+=ue[we]*ie.g[0]+ue[Ke]*ee.g[0],re.g[1]+=ue[we]*ie.g[1]+ue[Ke]*ee.g[1],re.g[2]+=ue[we]*ie.g[2]+ue[Ke]*ee.g[2]}function z(re,ie){var ee=Ge(ie),ue=ie.a,we=ee.a;if(c(ue.a,we.a)){if(0<f(we.b.a,ue.a,we.a))return;if(l(ue.a,we.a)){if(ue.a!==we.a){var ee=re.e,ke=ue.a.h;if(0<=ke){var $e=(ee=ee.b).d,Ke=ee.e,Qe=ee.c,et=Qe[ke];$e[et]=$e[ee.a],(Qe[$e[et]]=et)<=--ee.a&&(et<=1||c(Ke[$e[et>>1]],Ke[$e[et]])?it:nt)(ee,et),Ke[ke]=null,Qe[ke]=ee.b,ee.b=ke}else for(ee.c[-(ke+1)]=null;0<ee.a&&ee.c[ee.d[ee.a-1]]===null;)--ee.a;I(re,we.b.e,ue)}}else v(we.b),b(ue,we.b.e),ie.b=ee.b=!0}else{if(f(ue.b.a,we.a,ue.a)<0)return;Me(ie).b=ie.b=!0,v(ue.b),b(we.b.e,ue)}return 1}function K(re,ie){var ee=Ge(ie),ue=ie.a,we=ee.a,ke=ue.a,$e=we.a,Ke=ue.b.a,Qe=we.b.a,et=new Se;if(f(Ke,re.a,ke),f(Qe,re.a,$e),!(ke===$e||Math.min(ke.a,Ke.a)>Math.max($e.a,Qe.a))){if(c(ke,$e)){if(0<f(Qe,ke,$e))return}else if(f(Ke,$e,ke)<0)return;var at,Ot,Ct=Ke,dt=ke,Pt=Qe,Et=$e;if(c(Ct,dt)||(at=Ct,Ct=dt,dt=at),c(Pt,Et)||(at=Pt,Pt=Et,Et=at),c(Ct,Pt)||(at=Ct,Ct=Pt,Pt=at,at=dt,dt=Et,Et=at),c(Pt,dt)?c(dt,Et)?((at=u(Ct,Pt,dt))+(Ot=u(Pt,dt,Et))<0&&(at=-at,Ot=-Ot),et.b=m(at,Pt.b,Ot,dt.b)):((at=f(Ct,Pt,dt))+(Ot=-f(Ct,Et,dt))<0&&(at=-at,Ot=-Ot),et.b=m(at,Pt.b,Ot,Et.b)):et.b=(Pt.b+dt.b)/2,h(Ct,dt)||(at=Ct,Ct=dt,dt=at),h(Pt,Et)||(at=Pt,Pt=Et,Et=at),h(Ct,Pt)||(at=Ct,Ct=Pt,Pt=at,at=dt,dt=Et,Et=at),h(Pt,dt)?h(dt,Et)?((at=d(Ct,Pt,dt))+(Ot=d(Pt,dt,Et))<0&&(at=-at,Ot=-Ot),et.a=m(at,Pt.a,Ot,dt.a)):((at=p(Ct,Pt,dt))+(Ot=-p(Ct,Et,dt))<0&&(at=-at,Ot=-Ot),et.a=m(at,Pt.a,Ot,Et.a)):et.a=(Pt.a+dt.a)/2,c(et,re.a)&&(et.b=re.a.b,et.a=re.a.a),Ct=c(ke,$e)?ke:$e,c(Ct,et)&&(et.b=Ct.b,et.a=Ct.a),l(et,ke)||l(et,$e))return z(re,ie),0;if(!l(Ke,re.a)&&0<=f(Ke,re.a,et)||!l(Qe,re.a)&&f(Qe,re.a,et)<=0){if(Qe===re.a)v(ue.b),b(we.b,ue),ue=Ge(ie=G(ie)).a,q(re,Ge(ie),ee),J(re,ie,ue.b.e,ue,ue,!0);else{if(Ke!==re.a)return 0<=f(Ke,re.a,et)&&(Me(ie).b=ie.b=!0,v(ue.b),ue.a.b=re.a.b,ue.a.a=re.a.a),void(f(Qe,re.a,et)<=0&&(ie.b=ee.b=!0,v(we.b),we.a.b=re.a.b,we.a.a=re.a.a));for(v(we.b),b(ue.e,we.b.e),$e=(ke=ee=ie).a.b.a;(ke=Me(ke)).a.b.a===$e;);ke=Ge(ie=ke).a.b.c,ee.a=we.b.e,J(re,ie,(we=q(re,ee,null)).c,ue.b.c,ke,!0)}return 1}v(ue.b),v(we.b),b(we.b.e,ue),ue.a.b=et.b,ue.a.a=et.a,ue.a.h=Oe(re.e,ue.a),ue=ue.a,we=[0,0,0,0],et=[ke.d,Ke.d,$e.d,Qe.d],ue.g[0]=ue.g[1]=ue.g[2]=0,U(ue,ke,Ke,we,0),U(ue,$e,Qe,we,2),ae(re,ue,et,we,!0),Me(ie).b=ie.b=ee.b=!0}}function te(re,ie){for(var ee=Ge(ie);;){for(;ee.b;)ee=Ge(ie=ee);if(!ie.b&&((ie=Me(ee=ie))===null||!ie.b))break;ie.b=!1;var ue=ie.a,we=ee.a;if(ke=ue.b.a!==we.b.a)e:{var ke,$e=Ge(ke=ie),Ke=ke.a,Qe=$e.a,et=void 0;if(c(Ke.b.a,Qe.b.a)){if(f(Ke.b.a,Qe.b.a,Ke.a)<0){ke=!1;break e}Me(ke).b=ke.b=!0,et=v(Ke),b(Qe.b,et),et.d.c=ke.d}else{if(0<f(Qe.b.a,Ke.b.a,Qe.a)){ke=!1;break e}ke.b=$e.b=!0,et=v(Qe),b(Ke.e,Qe.b),et.b.d.c=ke.d}ke=!0}if(ke&&(ee.c?(N(ee),y(we),we=(ee=Ge(ie)).a):ie.c&&(N(ie),y(ue),ue=(ie=Me(ee)).a)),ue.a!==we.a){if(ue.b.a===we.b.a||ie.c||ee.c||ue.b.a!==re.a&&we.b.a!==re.a)z(re,ie);else if(K(re,ie))break}ue.a===we.a&&ue.b.a===we.b.a&&(F(we,ue),N(ie),y(ue),ie=Me(ee))}}function ne(re,ie){var ee=new Ce,ue=g(re.b);ue.a.b=4e150,ue.a.a=ie,ue.b.a.b=-4e150,ue.b.a.a=ie,re.a=ue.b.a,ee.a=ue,ee.f=0,ee.d=!1,ee.c=!1,ee.h=!0,ee.b=!1,ue=me(ue=re.f,ue.a,ee),ee.e=ue}function le(re){this.a=new ce,this.b=re,this.c=A}function me(re,ie,ee){for(;(ie=ie.c).b!==null&&!re.c(re.b,ie.b,ee););return re=new ce(ee,ie.a,ie),ie.a.c=re,ie.a=re}function ce(re,ie,ee){this.b=re||null,this.a=ie||this,this.c=ee||this}function ge(){this.d=0,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}function pe(re,ie){if(re.d!==ie)for(;re.d!==ie;)if(re.d<ie)switch(re.d){case 0:oe(re,100151),re.u(null);break;case 1:oe(re,100152),re.t()}else switch(re.d){case 2:oe(re,100154),re.v();break;case 1:oe(re,100153),re.w()}}function oe(re,ie){re.p&&re.p(ie,re.c)}function de(re,ie){this.b=re||this,this.d=ie||this,this.a=null,this.c=!1}function xe(){(this.h=this).i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function Te(){this.c=new Se,this.a=new de,this.b=new xe,this.d=new xe,this.b.b=this.d,this.d.b=this.b}function Se(re,ie){this.e=re||this,this.f=ie||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function je(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Fe}function Oe(re,ie){var ee,ue,we;return re.e?(2*(ue=++(ee=re.b).a)>ee.f&&(ee.f*=2,ee.c=ut(ee.c,ee.f+1)),ee.b===0?we=ue:(we=ee.b,ee.b=ee.c[ee.b]),ee.e[we]=ie,ee.c[we]=ue,ee.d[ue]=we,ee.h&&nt(ee,ue),we):(ee=re.a++,re.c[ee]=ie,-(ee+1))}function We(re){if(re.a===0)return rt(re.b);var ie=re.c[re.d[re.a-1]];if(re.b.a!==0&&c(tt(re.b),ie))return rt(re.b);for(;--re.a,0<re.a&&re.c[re.d[re.a-1]]===null;);return ie}function Fe(){this.d=ut([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function ut(re,ie){for(var ee=Array(ie),ue=0;ue<re.length;ue++)ee[ue]=re[ue];for(;ue<ie;ue++)ee[ue]=0;return ee}function tt(re){return re.e[re.d[1]]}function rt(re){var ie=re.d,ee=re.e,ue=re.c,we=ie[1],ke=ee[we];return 0<re.a&&(ie[1]=ie[re.a],ue[ie[1]]=1,ee[we]=null,ue[we]=re.b,re.b=we,0<--re.a&&it(re,1)),ke}function it(re,ie){for(var ee=re.d,ue=re.e,we=re.c,ke=ie,$e=ee[ke];;){var Ke=ke<<1,Qe=(Ke<re.a&&c(ue[ee[Ke+1]],ue[ee[Ke]])&&(Ke+=1),ee[Ke]);if(Ke>re.a||c(ue[$e],ue[Qe])){we[ee[ke]=$e]=ke;break}we[ee[ke]=Qe]=ke,ke=Ke}}function nt(re,ie){for(var ee=re.d,ue=re.e,we=re.c,ke=ie,$e=ee[ke];;){var Ke=ke>>1,Qe=ee[Ke];if(Ke==0||c(ue[Qe],ue[$e])){we[ee[ke]=$e]=ke;break}we[ee[ke]=Qe]=ke,ke=Ke}}function Ce(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Ge(re){return re.e.c.b}function Me(re){return re.e.a.b}(a=ge.prototype).x=function(){pe(this,0)},a.B=function(re,ie){switch(re){case 100142:return;case 100140:switch(ie){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=ie)}break;case 100141:return void(this.m=!!ie);default:return void oe(this,100900)}oe(this,100901)},a.y=function(re){switch(re){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:oe(this,100900)}return!1},a.A=function(re,ie,ee){this.j[0]=re,this.j[1]=ie,this.j[2]=ee},a.z=function(re,ie){var ee=ie||null;switch(re){case 100100:case 100106:this.h=ee;break;case 100104:case 100110:this.l=ee;break;case 100101:case 100107:this.k=ee;break;case 100102:case 100108:this.i=ee;break;case 100103:case 100109:this.p=ee;break;case 100105:case 100111:this.o=ee;break;case 100112:this.r=ee;break;default:oe(this,100900)}},a.C=function(re,ie){var ee=!1,ue=[0,0,0];pe(this,2);for(var we=0;we<3;++we){var ke=re[we];ke<-1e150&&(ke=-1e150,ee=!0),1e150<ke&&(ke=1e150,ee=!0),ue[we]=ke}ee&&oe(this,100155),(ee=this.q)===null?b(ee=g(this.b),ee.b):(v(ee),ee=ee.e),ee.a.d=ie,ee.a.g[0]=ue[0],ee.a.g[1]=ue[1],ee.a.g[2]=ue[2],ee.f=1,ee.b.f=-1,this.q=ee},a.u=function(re){pe(this,0),this.d=1,this.b=new Te,this.c=re},a.t=function(){pe(this,1),this.d=2,this.q=null},a.v=function(){pe(this,2),this.d=1},a.w=function(){pe(this,1),this.d=0;var re,ie,ee=this.j[0],ue=this.j[1],we=this.j[2],ke=!1,$e=[ee,ue,we];if(ee===0&&ue===0&&we===0){for(var ue=[-2e150,-2e150,-2e150],Ke=[2e150,2e150,2e150],we=[],Qe=[],ee=(ke=this.b.c).e;ee!==ke;ee=ee.e)for(var et=0;et<3;++et){var at=ee.g[et];at<Ke[et]&&(Ke[et]=at,Qe[et]=ee),at>ue[et]&&(ue[et]=at,we[et]=ee)}if(ue[1]-Ke[1]>ue[ee=0]-Ke[0]&&(ee=1),Ke[ee=ue[2]-Ke[2]>ue[ee]-Ke[ee]?2:ee]>=ue[ee])$e[0]=0,$e[1]=0,$e[2]=1;else{for(Ke=Qe[ee],we=we[ee],Qe=[ue=0,0,0],Ke=[Ke.g[0]-we.g[0],Ke.g[1]-we.g[1],Ke.g[2]-we.g[2]],et=[0,0,0],ee=ke.e;ee!==ke;ee=ee.e)et[0]=ee.g[0]-we.g[0],et[1]=ee.g[1]-we.g[1],et[2]=ee.g[2]-we.g[2],Qe[0]=Ke[1]*et[2]-Ke[2]*et[1],Qe[1]=Ke[2]*et[0]-Ke[0]*et[2],Qe[2]=Ke[0]*et[1]-Ke[1]*et[0],ue<(at=Qe[0]*Qe[0]+Qe[1]*Qe[1]+Qe[2]*Qe[2])&&(ue=at,$e[0]=Qe[0],$e[1]=Qe[1],$e[2]=Qe[2]);ue<=0&&($e[0]=$e[1]=$e[2]=0,$e[k(Ke)]=1)}ke=!0}for(Qe=k($e),ee=this.b.c,ue=(Qe+1)%3,we=(Qe+2)%3,Qe=0<$e[Qe]?1:-1,$e=ee.e;$e!==ee;$e=$e.e)$e.b=$e.g[ue],$e.a=Qe*$e.g[we];if(ke){for($e=0,ee=(ke=this.b.a).b;ee!==ke;ee=ee.b)if(!((ue=ee.a).f<=0))for(;$e+=(ue.a.b-ue.b.a.b)*(ue.a.a+ue.b.a.a),(ue=ue.e)!==ee.a;);if($e<0)for(ke=($e=this.b.c).e;ke!==$e;ke=ke.e)ke.a=-ke.a}for(this.n=!1,$e=this.b.b,ee=$e.h;ee!==$e;ee=ke)ke=ee.h,ue=ee.e,l(ee.a,ee.b.a)&&ee.e.e!==ee&&(I(this,ue,ee),y(ee),ue=(ee=ue).e),ue.e===ee&&(ue!==ee&&(ue!==ke&&ue!==ke.b||(ke=ke.h),y(ue)),ee!==ke&&ee!==ke.b||(ke=ke.h),y(ee));for(this.e=$e=new je,ke=this.b.c,ee=ke.e;ee!==ke;ee=ee.e)ee.h=Oe($e,ee);var Ot=$e;Ot.d=[];for(var Ct=0;Ct<Ot.a;Ct++)Ot.d[Ct]=Ct;Ot.d.sort(function(Et){return function(rr,Hr){return c(Et[rr],Et[Hr])?1:-1}}(Ot.c)),Ot.e=!0;for(var dt=Ot.b,Pt=dt.a;1<=Pt;--Pt)it(dt,Pt);for(dt.h=!0,this.f=new le(this),ne(this,-4e150),ne(this,4e150);($e=We(this.e))!==null;){for(;;){e:if((ee=this.e).a===0)ke=tt(ee.b);else if(ke=ee.c[ee.d[ee.a-1]],ee.b.a!==0&&c(ee=tt(ee.b),ke)){ke=ee;break e}if(ke===null||!l(ke,$e))break;ke=We(this.e),I(this,$e.c,ke.c)}(function Et(rr,Hr){for(var Wr,Qt=(rr.a=Hr).c;Qt.i===null;)if((Qt=Qt.c)===Hr.c){var Qt=rr,pr=Hr;(Jt=new Ce).a=pr.c.b;for(var Er=(Ht=Qt.f).a;(Er=Er.a).b!==null&&!Ht.c(Ht.b,Jt,Er.b););var Ht,pn,Zr=Ge(Ht=Er.b),Jt=Ht.a,Er=Zr.a;return void(f(Jt.b.a,pr,Jt.a)===0?l((Jt=Ht.a).a,pr)||l(Jt.b.a,pr)||(v(Jt.b),Ht.c&&(y(Jt.c),Ht.c=!1),b(pr.c,Jt),Et(Qt,pr)):(pn=c(Er.b.a,Jt.b.a)?Ht:Zr,Zr=void 0,Ht.d||pn.c?(Zr=pn===Ht?x(pr.c.b,Jt.e):x(Er.b.c.b,pr.c).b,pn.c?$(pn,Zr):((Ht=X(Jt=Qt,Ht,Zr)).f=Me(Ht).f+Ht.a.f,Ht.d=W(Jt,Ht.f)),Et(Qt,pr)):J(Qt,Ht,pr.c,pr.c,null,!0)))}Ht=(Jt=Ge(Qt=G(Qt.i))).a,(Jt=q(rr,Jt,null)).c===Ht?(Jt=(Ht=Jt).c,Er=Ge(Qt),Zr=Qt.a,pn=Er.a,Wr=!1,Zr.b.a!==pn.b.a&&K(rr,Qt),l(Zr.a,rr.a)&&(b(Jt.b.e,Zr),Jt=Ge(Qt=G(Qt)).a,q(rr,Ge(Qt),Er),Wr=!0),l(pn.a,rr.a)&&(b(Ht,pn.b.e),Ht=q(rr,Er,null),Wr=!0),Wr?J(rr,Qt,Ht.c,Jt,Jt,!0):(pr=c(pn.a,Zr.a)?pn.b.e:Zr,J(rr,Qt,pr=x(Ht.c.b,pr),pr.c,pr.c,!1),pr.b.i.c=!0,te(rr,Qt))):J(rr,Qt,Jt.c,Ht,Ht,!0)})(this,$e)}for(this.a=this.f.a.a.b.a.a,$e=0;(ke=this.f.a.a.b)!==null;)ke.h||++$e,N(ke);for(this.f=null,($e=this.e).b=null,$e.d=null,this.e=$e.c=null,$e=this.b,ee=$e.a.b;ee!==$e.a;ee=ke)ke=ee.b,(ee=ee.a).e.e===ee&&(F(ee.c,ee),y(ee));if(!this.n){if($e=this.b,this.m)for(ee=$e.b.h;ee!==$e.b;ee=ke)ke=ee.h,ee.b.d.c!==ee.d.c?ee.f=ee.d.c?1:-1:y(ee);else for(ee=$e.a.b;ee!==$e.a;ee=ke)if(ke=ee.b,ee.c){for(ee=ee.a;c(ee.b.a,ee.a);ee=ee.c.b);for(;c(ee.a,ee.b.a);ee=ee.e);for(ue=ee.c.b,we=void 0;ee.e!==ue;)if(c(ee.b.a,ue.a)){for(;ue.e!==ee&&(c((ie=ue.e).b.a,ie.a)||f(ue.a,ue.b.a,ue.e.b.a)<=0);)ue=(we=x(ue.e,ue)).b;ue=ue.c.b}else{for(;ue.e!==ee&&(c((re=ee.c.b).a,re.b.a)||0<=f(ee.b.a,ee.a,ee.c.b.a));)ee=(we=x(ee,ee.c.b)).b;ee=ee.e}for(;ue.e.e!==ee;)we=x(ue.e,ue),ue=we.b}if(this.h||this.i||this.k||this.l)if(this.m){for(ke=($e=this.b).a.b;ke!==$e.a;ke=ke.b)if(ke.c){for(this.h&&this.h(2,this.c),ee=ke.a;this.k&&this.k(ee.a.d,this.c),(ee=ee.e)!==ke.a;);this.i&&this.i(this.c)}}else{for($e=this.b,ke=!!this.l,ee=!1,ue=-1,we=$e.a.d;we!==$e.a;we=we.d)if(we.c)for(ee||(this.h&&this.h(4,this.c),ee=!0),Qe=we.a;ke&&(Ke=Qe.b.d.c?0:1,ue!==Ke&&(ue=Ke,this.l&&this.l(!!ue,this.c))),this.k&&this.k(Qe.a.d,this.c),(Qe=Qe.e)!==we.a;);ee&&this.i&&this.i(this.c)}if(this.r){for($e=this.b,ee=$e.a.b;ee!==$e.a;ee=ke)if(ke=ee.b,!ee.c){for(we=(ue=ee.a).e,Qe=void 0;we=(Qe=we).e,(Qe.d=null)===Qe.b.d&&(Qe.c===Qe?M(Qe.a,null):(Qe.a.c=Qe.c,w(Qe,Qe.b.e)),(Ke=Qe.b).c===Ke?M(Ke.a,null):(Ke.a.c=Ke.c,w(Ke,Ke.b.e)),P(Qe)),Qe!==ue;);ue=ee.d,((ee=ee.b).d=ue).b=ee}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:ge,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},ge.prototype.gluDeleteTess=ge.prototype.x,ge.prototype.gluTessProperty=ge.prototype.B,ge.prototype.gluGetTessProperty=ge.prototype.y,ge.prototype.gluTessNormal=ge.prototype.A,ge.prototype.gluTessCallback=ge.prototype.z,ge.prototype.gluTessVertex=ge.prototype.C,ge.prototype.gluTessBeginPolygon=ge.prototype.u,ge.prototype.gluTessBeginContour=ge.prototype.t,ge.prototype.gluTessEndContour=ge.prototype.v,ge.prototype.gluTessEndPolygon=ge.prototype.w,s!==void 0&&(s.exports=this.libtess)},{}],253:[function(r,s,i){function a(c,u,f,h){var d=0,p=(h=h===void 0?{}:h).loop===void 0?null:h.loop,m=h.palette===void 0?null:h.palette;if(u<=0||f<=0||65535<u||65535<f)throw new Error("Width/Height invalid.");function g(j){if(j=j.length,j<2||256<j||j&j-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return j}c[d++]=71,c[d++]=73,c[d++]=70,c[d++]=56,c[d++]=57,c[d++]=97;var b=0,y=0;if(m!==null){for(var v=g(m);v>>=1;)++b;if(v=1<<b,--b,h.background!==void 0){if(v<=(y=h.background))throw new Error("Background index out of range.");if(y===0)throw new Error("Background index explicitly passed as 0.")}}if(c[d++]=255&u,c[d++]=u>>8&255,c[d++]=255&f,c[d++]=f>>8&255,c[d++]=(m!==null?128:0)|b,c[d++]=y,c[d++]=0,m!==null)for(var x=0,S=m.length;x<S;++x){var w=m[x];c[d++]=w>>16&255,c[d++]=w>>8&255,c[d++]=255&w}if(p!==null){if(p<0||65535<p)throw new Error("Loop count invalid.");c[d++]=33,c[d++]=255,c[d++]=11,c[d++]=78,c[d++]=69,c[d++]=84,c[d++]=83,c[d++]=67,c[d++]=65,c[d++]=80,c[d++]=69,c[d++]=50,c[d++]=46,c[d++]=48,c[d++]=3,c[d++]=1,c[d++]=255&p,c[d++]=p>>8&255,c[d++]=0}var E=!1;this.addFrame=function(j,P,M,O,k,F){if(E===!0&&(--d,E=!1),F=F===void 0?{}:F,j<0||P<0||65535<j||65535<P)throw new Error("x/y invalid.");if(M<=0||O<=0||65535<M||65535<O)throw new Error("Width/Height invalid.");if(k.length<M*O)throw new Error("Not enough pixels for the frame size.");var A=!0,N=F.palette;if(N==null&&(A=!1,N=m),N==null)throw new Error("Must supply either a local or global palette.");for(var G=g(N),$=0;G>>=1;)++$;var G=1<<$,X=F.delay===void 0?0:F.delay,W=F.disposal===void 0?0:F.disposal;if(W<0||3<W)throw new Error("Disposal out of range.");var V=!1,q=0;if(F.transparent!==void 0&&F.transparent!==null&&(V=!0,(q=F.transparent)<0||G<=q))throw new Error("Transparent color index.");if(W===0&&!V&&X===0||(c[d++]=33,c[d++]=249,c[d++]=4,c[d++]=W<<2|(V===!0?1:0),c[d++]=255&X,c[d++]=X>>8&255,c[d++]=q,c[d++]=0),c[d++]=44,c[d++]=255&j,c[d++]=j>>8&255,c[d++]=255&P,c[d++]=P>>8&255,c[d++]=255&M,c[d++]=M>>8&255,c[d++]=255&O,c[d++]=O>>8&255,c[d++]=A===!0?128|$-1:0,A===!0)for(var J=0,ae=N.length;J<ae;++J){var I=N[J];c[d++]=I>>16&255,c[d++]=I>>8&255,c[d++]=255&I}return d=function(U,z,K,te){U[z++]=K;var ne=z++,le=1<<K,me=le-1,ce=1+le,ge=1+ce,pe=K+1,oe=0,de=0;function xe(rt){for(;rt<=oe;)U[z++]=255&de,de>>=8,oe-=8,z===ne+256&&(U[ne]=255,ne=z++)}function Te(rt){de|=rt<<oe,oe+=pe,xe(8)}var Se=te[0]&me,je={};Te(le);for(var Oe=1,We=te.length;Oe<We;++Oe){var Fe=te[Oe]&me,ut=Se<<8|Fe,tt=je[ut];if(tt===void 0){for(de|=Se<<oe,oe+=pe;8<=oe;)U[z++]=255&de,de>>=8,oe-=8,z===ne+256&&(U[ne]=255,ne=z++);ge===4096?(Te(le),ge=1+ce,pe=K+1,je={}):(1<<pe<=ge&&++pe,je[ut]=ge++),Se=Fe}else Se=tt}return Te(Se),Te(ce),xe(1),ne+1===z?U[ne]=0:(U[ne]=z-ne-1,U[z++]=0),z}(c,d,$<2?2:$,k)},this.end=function(){return E===!1&&(c[d++]=59,E=!0),d},this.getOutputBuffer=function(){return c},this.setOutputBuffer=function(j){c=j},this.getOutputBufferPosition=function(){return d},this.setOutputBufferPosition=function(j){d=j}}function l(c,u,f,h){for(var d=c[u++],p=1<<d,m=1+p,g=1+m,b=d+1,y=(1<<b)-1,v=0,x=0,S=0,w=c[u++],E=new Int32Array(4096),j=null;;){for(;v<16&&w!==0;)x|=c[u++]<<v,v+=8,w===1?w=c[u++]:--w;if(v<b)break;var P=x&y;if(x>>=b,v-=b,P==p)g=1+m,y=(1<<(b=d+1))-1,j=null;else{if(P==m)break;for(var M=P<g?P:j,O=0,k=M;p<k;)k=E[k]>>8,++O;var F=k;if(h<S+O+(M!==P?1:0))return void console.log("Warning, gif stream longer than expected.");f[S++]=F;var A=S+=O;for(M!==P&&(f[S++]=F),k=M;O--;)k=E[k],f[--A]=255&k,k>>=8;j!==null&&g<4096&&(E[g++]=j<<8|F,y+1<=g&&b<12&&(++b,y=y<<1|1)),j=P}}S!==h&&console.log("Warning, gif stream shorter than expected.")}try{i.GifWriter=a,i.GifReader=function(c){var u=0;if(c[u++]!==71||c[u++]!==73||c[u++]!==70||c[u++]!==56||(c[u++]+1&253)!=56||c[u++]!==97)throw new Error("Invalid GIF 87a/89a header.");var f=c[u++]|c[u++]<<8,h=c[u++]|c[u++]<<8,d=c[u++],p=1<<1+(7&d),m=(c[u++],c[u++],null),g=null,b=(d>>7&&(m=u,u+=3*(g=p)),!0),y=[],v=0,x=null,S=0,w=null;for(this.width=f,this.height=h;b&&u<c.length;)switch(c[u++]){case 33:switch(c[u++]){case 255:if(c[u]!==11||c[u+1]==78&&c[u+2]==69&&c[u+3]==84&&c[u+4]==83&&c[u+5]==67&&c[u+6]==65&&c[u+7]==80&&c[u+8]==69&&c[u+9]==50&&c[u+10]==46&&c[u+11]==48&&c[u+12]==3&&c[u+13]==1&&c[u+16]==0)u+=14,w=c[u++]|c[u++]<<8,u++;else for(u+=12;;){if(!(0<=(j=c[u++])))throw Error("Invalid block size");if(j===0)break;u+=j}break;case 249:if(c[u++]!==4||c[u+4]!==0)throw new Error("Invalid graphics extension block.");var E=c[u++],v=c[u++]|c[u++]<<8,x=c[u++];!(1&E)&&(x=null),S=E>>2&7,u++;break;case 254:for(;;){if(!(0<=(j=c[u++])))throw Error("Invalid block size");if(j===0)break;u+=j}break;default:throw new Error("Unknown graphic control label: 0x"+c[u-1].toString(16))}break;case 44:var j,P=c[u++]|c[u++]<<8,M=c[u++]|c[u++]<<8,O=c[u++]|c[u++]<<8,k=c[u++]|c[u++]<<8,X=c[u++],F=X>>6&1,A=1<<1+(7&X),N=m,$=g,G=!1,X=(X>>7&&(G=!0,N=u,u+=3*($=A)),u);for(u++;;){if(!(0<=(j=c[u++])))throw Error("Invalid block size");if(j===0)break;u+=j}y.push({x:P,y:M,width:O,height:k,has_local_palette:G,palette_offset:N,palette_size:$,data_offset:X,data_length:u-X,transparent_index:x,interlaced:!!F,delay:v,disposal:S});break;case 59:b=!1;break;default:throw new Error("Unknown gif block: 0x"+c[u-1].toString(16))}this.numFrames=function(){return y.length},this.loopCount=function(){return w},this.frameInfo=function(W){if(W<0||W>=y.length)throw new Error("Frame index out of range.");return y[W]},this.decodeAndBlitFrameBGRA=function(W,V){for(var W=this.frameInfo(W),q=W.width*W.height,J=new Uint8Array(q),ae=(l(c,W.data_offset,J,q),W.palette_offset),I=W.transparent_index,U=(I===null&&(I=256),W.width),z=f-U,K=U,te=4*(W.y*f+W.x),ne=4*((W.y+W.height)*f+W.x),le=te,me=4*z,ce=(W.interlaced===!0&&(me+=4*f*7),8),ge=0,pe=J.length;ge<pe;++ge){var oe,de,xe=J[ge];K===0&&(K=U,ne<=(le+=me)&&(me=4*z+4*f*(ce-1),le=te+(U+z)*(ce<<1),ce>>=1)),xe===I?le+=4:(oe=c[ae+3*xe],de=c[ae+3*xe+1],xe=c[ae+3*xe+2],V[le++]=xe,V[le++]=de,V[le++]=oe,V[le++]=255),--K}},this.decodeAndBlitFrameRGBA=function(W,V){for(var W=this.frameInfo(W),q=W.width*W.height,J=new Uint8Array(q),ae=(l(c,W.data_offset,J,q),W.palette_offset),I=W.transparent_index,U=(I===null&&(I=256),W.width),z=f-U,K=U,te=4*(W.y*f+W.x),ne=4*((W.y+W.height)*f+W.x),le=te,me=4*z,ce=(W.interlaced===!0&&(me+=4*f*7),8),ge=0,pe=J.length;ge<pe;++ge){var oe,de,xe=J[ge];K===0&&(K=U,ne<=(le+=me)&&(me=4*z+4*f*(ce-1),le=te+(U+z)*(ce<<1),ce>>=1)),xe===I?le+=4:(oe=c[ae+3*xe],de=c[ae+3*xe+1],xe=c[ae+3*xe+2],V[le++]=oe,V[le++]=de,V[le++]=xe,V[le++]=255),--K}}}}catch{}},{}],254:[function(r,s,i){(function(a){var l,c;l=this,c=function(u){function f(H){if(this==null)throw TypeError();var T,R=String(this),L=R.length,H=H?Number(H):0;if(!((H=H!=H?0:H)<0||L<=H))return 55296<=(T=R.charCodeAt(H))&&T<=56319&&H+1<L&&56320<=(L=R.charCodeAt(H+1))&&L<=57343?1024*(T-55296)+L-56320+65536:T}String.prototype.codePointAt||((h=function(){try{var _={},T=Object.defineProperty,R=T(_,_,_)&&T}catch{}return R}())?h(String.prototype,"codePointAt",{value:f,configurable:!0,writable:!0}):String.prototype.codePointAt=f);var h,d=0,p=-3;function m(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function g(_,T){this.source=_,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=T,this.destLen=0,this.ltree=new m,this.dtree=new m}var b=new m,y=new m,v=new Uint8Array(30),x=new Uint16Array(30),S=new Uint8Array(30),w=new Uint16Array(30),E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),j=new m,P=new Uint8Array(320);function M(_,T,R,L){for(var H,Z=0;Z<R;++Z)_[Z]=0;for(Z=0;Z<30-R;++Z)_[Z+R]=Z/R|0;for(H=L,Z=0;Z<30;++Z)T[Z]=H,H+=1<<_[Z]}var O=new Uint16Array(16);function k(_,T,R,L){for(var H,Z=0;Z<16;++Z)_.table[Z]=0;for(Z=0;Z<L;++Z)_.table[T[R+Z]]++;for(Z=H=_.table[0]=0;Z<16;++Z)O[Z]=H,H+=_.table[Z];for(Z=0;Z<L;++Z)T[R+Z]&&(_.trans[O[T[R+Z]]++]=Z)}function F(_,T,R){if(!T)return R;for(;_.bitcount<24;)_.tag|=_.source[_.sourceIndex++]<<_.bitcount,_.bitcount+=8;var L=_.tag&65535>>>16-T;return _.tag>>>=T,_.bitcount-=T,L+R}function A(_,T){for(;_.bitcount<24;)_.tag|=_.source[_.sourceIndex++]<<_.bitcount,_.bitcount+=8;for(var R=0,L=0,H=0,Z=_.tag;L=2*L+(1&Z),Z>>>=1,R+=T.table[++H],0<=(L-=T.table[H]););return _.tag=Z,_.bitcount-=H,T.trans[R+L]}function N(_,T,R){for(;;){var L=A(_,T);if(L===256)return d;if(L<256)_.dest[_.destLen++]=L;else for(var H,Z=F(_,v[L-=257],x[L]),L=A(_,R),Q=H=_.destLen-F(_,S[L],w[L]);Q<H+Z;++Q)_.dest[_.destLen++]=_.dest[Q]}}for(var $=b,G=y,X=0;X<7;++X)$.table[X]=0;for($.table[7]=24,$.table[8]=152,$.table[9]=112,X=0;X<24;++X)$.trans[X]=256+X;for(X=0;X<144;++X)$.trans[24+X]=X;for(X=0;X<8;++X)$.trans[168+X]=280+X;for(X=0;X<112;++X)$.trans[176+X]=144+X;for(X=0;X<5;++X)G.table[X]=0;for(G.table[5]=32,X=0;X<32;++X)G.trans[X]=X;M(v,x,4,3),M(S,w,2,1),v[28]=0,x[28]=258;var W=function(_,T){var R,L,H,Z=new g(_,T);do{switch(H=void 0,(L=Z).bitcount--||(L.tag=L.source[L.sourceIndex++],L.bitcount=7),H=1&L.tag,L.tag>>>=1,L=H,F(Z,2,0)){case 0:R=function(Le){for(var St,At;8<Le.bitcount;)Le.sourceIndex--,Le.bitcount-=8;if((St=256*Le.source[Le.sourceIndex+1]+Le.source[Le.sourceIndex])!==(65535&~(256*Le.source[Le.sourceIndex+3]+Le.source[Le.sourceIndex+2])))return p;for(Le.sourceIndex+=4,At=St;At;--At)Le.dest[Le.destLen++]=Le.source[Le.sourceIndex++];return Le.bitcount=0,d}(Z);break;case 1:R=N(Z,b,y);break;case 2:Be=Ne=Ve=De=Q=ve=Pe=Ae=_e=he=fe=se=void 0;for(var Q,se=Z,fe=Z.ltree,he=Z.dtree,_e=F(se,5,257),Ae=F(se,5,1),Pe=F(se,4,4),ve=0;ve<19;++ve)P[ve]=0;for(ve=0;ve<Pe;++ve){var Ve=F(se,3,0);P[E[ve]]=Ve}for(k(j,P,0,19),Q=0;Q<_e+Ae;){var Ne=A(se,j);switch(Ne){case 16:for(var Be=P[Q-1],De=F(se,2,3);De;--De)P[Q++]=Be;break;case 17:for(De=F(se,3,3);De;--De)P[Q++]=0;break;case 18:for(De=F(se,7,11);De;--De)P[Q++]=0;break;default:P[Q++]=Ne}}k(fe,P,0,_e),k(he,P,_e,Ae),R=N(Z,Z.ltree,Z.dtree);break;default:R=p}if(R!==d)throw new Error("Data error")}while(!L);return Z.destLen<Z.dest.length?typeof Z.dest.slice=="function"?Z.dest.slice(0,Z.destLen):Z.dest.subarray(0,Z.destLen):Z.dest};function V(_,T,R,L,H){return Math.pow(1-H,3)*_+3*Math.pow(1-H,2)*H*T+3*(1-H)*Math.pow(H,2)*R+Math.pow(H,3)*L}function q(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function J(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function ae(_){throw new Error(_)}function I(_,T){_||ae(T)}q.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},q.prototype.addPoint=function(_,T){typeof _=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=_,this.x2=_),_<this.x1&&(this.x1=_),_>this.x2&&(this.x2=_)),typeof T=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=T,this.y2=T),T<this.y1&&(this.y1=T),T>this.y2&&(this.y2=T))},q.prototype.addX=function(_){this.addPoint(_,null)},q.prototype.addY=function(_){this.addPoint(null,_)},q.prototype.addBezier=function(_,T,R,L,H,Z,Q,se){var fe=[_,T],he=[R,L],_e=[H,Z],Ae=[Q,se];this.addPoint(_,T),this.addPoint(Q,se);for(var Pe=0;Pe<=1;Pe++){var ve,Ve=6*fe[Pe]-12*he[Pe]+6*_e[Pe],Ne=-3*fe[Pe]+9*he[Pe]-9*_e[Pe]+3*Ae[Pe],Be=3*he[Pe]-3*fe[Pe];Ne==0?Ve==0||0<(ve=-Be/Ve)&&ve<1&&(Pe===0&&this.addX(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],ve)),Pe===1&&this.addY(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],ve))):(ve=Math.pow(Ve,2)-4*Be*Ne)<0||(0<(Be=(-Ve+Math.sqrt(ve))/(2*Ne))&&Be<1&&(Pe===0&&this.addX(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],Be)),Pe===1&&this.addY(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],Be))),0<(Be=(-Ve-Math.sqrt(ve))/(2*Ne))&&Be<1&&(Pe===0&&this.addX(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],Be)),Pe===1&&this.addY(V(fe[Pe],he[Pe],_e[Pe],Ae[Pe],Be))))}},q.prototype.addQuad=function(_,T,R,L,H,Z){R=_+2/3*(R-_),L=T+2/3*(L-T),this.addBezier(_,T,R,L,R+1/3*(H-_),L+1/3*(Z-T),H,Z)},J.prototype.moveTo=function(_,T){this.commands.push({type:"M",x:_,y:T})},J.prototype.lineTo=function(_,T){this.commands.push({type:"L",x:_,y:T})},J.prototype.curveTo=J.prototype.bezierCurveTo=function(_,T,R,L,H,Z){this.commands.push({type:"C",x1:_,y1:T,x2:R,y2:L,x:H,y:Z})},J.prototype.quadTo=J.prototype.quadraticCurveTo=function(_,T,R,L){this.commands.push({type:"Q",x1:_,y1:T,x:R,y:L})},J.prototype.close=J.prototype.closePath=function(){this.commands.push({type:"Z"})},J.prototype.extend=function(_){var T;if(_.commands)_=_.commands;else if(_ instanceof q)return T=_,this.moveTo(T.x1,T.y1),this.lineTo(T.x2,T.y1),this.lineTo(T.x2,T.y2),this.lineTo(T.x1,T.y2),void this.close();Array.prototype.push.apply(this.commands,_)},J.prototype.getBoundingBox=function(){for(var _=new q,T=0,R=0,L=0,H=0,Z=0;Z<this.commands.length;Z++){var Q=this.commands[Z];switch(Q.type){case"M":_.addPoint(Q.x,Q.y),T=L=Q.x,R=H=Q.y;break;case"L":_.addPoint(Q.x,Q.y),L=Q.x,H=Q.y;break;case"Q":_.addQuad(L,H,Q.x1,Q.y1,Q.x,Q.y),L=Q.x,H=Q.y;break;case"C":_.addBezier(L,H,Q.x1,Q.y1,Q.x2,Q.y2,Q.x,Q.y),L=Q.x,H=Q.y;break;case"Z":L=T,H=R;break;default:throw new Error("Unexpected path command "+Q.type)}}return _.isEmpty()&&_.addPoint(0,0),_},J.prototype.draw=function(_){_.beginPath();for(var T=0;T<this.commands.length;T+=1){var R=this.commands[T];R.type==="M"?_.moveTo(R.x,R.y):R.type==="L"?_.lineTo(R.x,R.y):R.type==="C"?_.bezierCurveTo(R.x1,R.y1,R.x2,R.y2,R.x,R.y):R.type==="Q"?_.quadraticCurveTo(R.x1,R.y1,R.x,R.y):R.type==="Z"&&_.closePath()}this.fill&&(_.fillStyle=this.fill,_.fill()),this.stroke&&(_.strokeStyle=this.stroke,_.lineWidth=this.strokeWidth,_.stroke())},J.prototype.toPathData=function(_){function T(){for(var Z=arguments,Q="",se=0;se<arguments.length;se+=1){var fe=Z[se];0<=fe&&0<se&&(Q+=" "),Q+=(fe=fe,Math.round(fe)===fe?""+Math.round(fe):fe.toFixed(_))}return Q}_=_!==void 0?_:2;for(var R="",L=0;L<this.commands.length;L+=1){var H=this.commands[L];H.type==="M"?R+="M"+T(H.x,H.y):H.type==="L"?R+="L"+T(H.x,H.y):H.type==="C"?R+="C"+T(H.x1,H.y1,H.x2,H.y2,H.x,H.y):H.type==="Q"?R+="Q"+T(H.x1,H.y1,H.x,H.y):H.type==="Z"&&(R+="Z")}return R},J.prototype.toSVG=function(_){var T=(T='<path d="')+this.toPathData(_)+'"';return this.fill&&this.fill!=="black"&&(this.fill===null?T+=' fill="none"':T+=' fill="'+this.fill+'"'),this.stroke&&(T+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),T+="/>"},J.prototype.toDOMElement=function(T){var T=this.toPathData(T),R=document.createElementNS("http://www.w3.org/2000/svg","path");return R.setAttribute("d",T),R};var U={fail:ae,argument:I,assert:I},z={},K={},te={};function ne(_){return function(){return _}}K.BYTE=function(_){return U.argument(0<=_&&_<=255,"Byte value should be between 0 and 255."),[_]},te.BYTE=ne(1),K.CHAR=function(_){return[_.charCodeAt(0)]},te.CHAR=ne(1),K.CHARARRAY=function(_){for(var T=[],R=0;R<_.length;R+=1)T[R]=_.charCodeAt(R);return T},te.CHARARRAY=function(_){return _.length},K.USHORT=function(_){return[_>>8&255,255&_]},te.USHORT=ne(2),K.SHORT=function(_){return[(_=32768<=_?-(65536-_):_)>>8&255,255&_]},te.SHORT=ne(2),K.UINT24=function(_){return[_>>16&255,_>>8&255,255&_]},te.UINT24=ne(3),K.ULONG=function(_){return[_>>24&255,_>>16&255,_>>8&255,255&_]},te.ULONG=ne(4),K.LONG=function(_){return[(_=2147483648<=_?-(4294967296-_):_)>>24&255,_>>16&255,_>>8&255,255&_]},te.LONG=ne(4),K.FIXED=K.ULONG,te.FIXED=te.ULONG,K.FWORD=K.SHORT,te.FWORD=te.SHORT,K.UFWORD=K.USHORT,te.UFWORD=te.USHORT,K.LONGDATETIME=function(_){return[0,0,0,0,_>>24&255,_>>16&255,_>>8&255,255&_]},te.LONGDATETIME=ne(8),K.TAG=function(_){return U.argument(_.length===4,"Tag should be exactly 4 ASCII characters."),[_.charCodeAt(0),_.charCodeAt(1),_.charCodeAt(2),_.charCodeAt(3)]},te.TAG=ne(4),K.Card8=K.BYTE,te.Card8=te.BYTE,K.Card16=K.USHORT,te.Card16=te.USHORT,K.OffSize=K.BYTE,te.OffSize=te.BYTE,K.SID=K.USHORT,te.SID=te.USHORT,K.NUMBER=function(_){return-107<=_&&_<=107?[_+139]:108<=_&&_<=1131?[247+((_-=108)>>8),255&_]:-1131<=_&&_<=-108?[251+((_=-_-108)>>8),255&_]:-32768<=_&&_<=32767?K.NUMBER16(_):K.NUMBER32(_)},te.NUMBER=function(_){return K.NUMBER(_).length},K.NUMBER16=function(_){return[28,_>>8&255,255&_]},te.NUMBER16=ne(3),K.NUMBER32=function(_){return[29,_>>24&255,_>>16&255,_>>8&255,255&_]},te.NUMBER32=ne(5),K.REAL=function(_){for(var T=_.toString(),R=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(T),L=(R&&(R=parseFloat("1e"+((R[2]?+R[2]:0)+R[1].length)),T=(Math.round(_*R)/R).toString()),""),H=0,Z=T.length;H<Z;H+=1){var Q=T[H];L+=Q==="e"?T[++H]==="-"?"c":"b":Q==="."?"a":Q==="-"?"e":Q}for(var se=[30],fe=0,he=(L+=1&L.length?"f":"ff").length;fe<he;fe+=2)se.push(parseInt(L.substr(fe,2),16));return se},te.REAL=function(_){return K.REAL(_).length},K.NAME=K.CHARARRAY,te.NAME=te.CHARARRAY,K.STRING=K.CHARARRAY,te.STRING=te.CHARARRAY,z.UTF8=function(_,T,R){for(var L=[],H=R,Z=0;Z<H;Z++,T+=1)L[Z]=_.getUint8(T);return String.fromCharCode.apply(null,L)},z.UTF16=function(_,T,R){for(var L=[],H=R/2,Z=0;Z<H;Z++,T+=2)L[Z]=_.getUint16(T);return String.fromCharCode.apply(null,L)},K.UTF16=function(_){for(var T=[],R=0;R<_.length;R+=1){var L=_.charCodeAt(R);T[T.length]=L>>8&255,T[T.length]=255&L}return T},te.UTF16=function(_){return 2*_.length};var le,me={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"},ce=(z.MACSTRING=function(_,T,R,L){var H=me[L];if(H!==void 0){for(var Z="",Q=0;Q<R;Q++){var se=_.getUint8(T+Q);Z+=se<=127?String.fromCharCode(se):H[127&se]}return Z}},typeof WeakMap=="function"&&new WeakMap);function ge(_){return-128<=_&&_<=127}K.MACSTRING=function(_,T){var R=function(Q){if(!le)for(var se in le={},me)le[se]=new String(se);var fe=le[Q];if(fe!==void 0){if(ce){var he=ce.get(fe);if(he!==void 0)return he}var _e=me[Q];if(_e!==void 0){for(var Ae={},Pe=0;Pe<_e.length;Pe++)Ae[_e.charCodeAt(Pe)]=Pe+128;return ce&&ce.set(fe,Ae),Ae}}}(T);if(R!==void 0){for(var L=[],H=0;H<_.length;H++){var Z=_.charCodeAt(H);if(128<=Z&&(Z=R[Z])===void 0)return;L[H]=Z}return L}},te.MACSTRING=function(_,T){return _=K.MACSTRING(_,T),_!==void 0?_.length:0},K.VARDELTAS=function(_){for(var L=0,T=[];L<_.length;)var R=_[L],L=(R===0?function(H,Z,Q){for(var se=0,fe=H.length;Z<fe&&se<64&&H[Z]===0;)++Z,++se;return Q.push(128|se-1),Z}:-128<=R&&R<=127?function(H,Z,Q){for(var se=0,fe=H.length,he=Z;he<fe&&se<64;){var _e=H[he];if(!ge(_e)||_e===0&&he+1<fe&&H[he+1]===0)break;++he,++se}Q.push(se-1);for(var Ae=Z;Ae<he;++Ae)Q.push(H[Ae]+256&255);return he}:function(H,Z,Q){for(var se=0,fe=H.length,he=Z;he<fe&&se<64;){var _e=H[he];if(_e===0||ge(_e)&&he+1<fe&&ge(H[he+1]))break;++he,++se}Q.push(64|se-1);for(var Ae=Z;Ae<he;++Ae){var Pe=H[Ae];Q.push(Pe+65536>>8&255,Pe+256&255)}return he})(_,L,T);return T},K.INDEX=function(_){for(var T=1,R=[T],L=[],H=0;H<_.length;H+=1){var Z=K.OBJECT(_[H]);Array.prototype.push.apply(L,Z),T+=Z.length,R.push(T)}if(L.length===0)return[0,0];for(var Q=[],se=1+Math.floor(Math.log(T)/Math.log(2))/8|0,fe=[void 0,K.BYTE,K.USHORT,K.UINT24,K.ULONG][se],he=0;he<R.length;he+=1){var _e=fe(R[he]);Array.prototype.push.apply(Q,_e)}return Array.prototype.concat(K.Card16(_.length),K.OffSize(se),Q,L)},te.INDEX=function(_){return K.INDEX(_).length},K.DICT=function(_){for(var T=[],R=Object.keys(_),L=R.length,H=0;H<L;H+=1){var Z=parseInt(R[H],0),Q=_[Z];T=(T=T.concat(K.OPERAND(Q.value,Q.type))).concat(K.OPERATOR(Z))}return T},te.DICT=function(_){return K.DICT(_).length},K.OPERATOR=function(_){return _<1200?[_]:[12,_-1200]},K.OPERAND=function(_,T){var R=[];if(Array.isArray(T))for(var L=0;L<T.length;L+=1)U.argument(_.length===T.length,"Not enough arguments given for type"+T),R=R.concat(K.OPERAND(_[L],T[L]));else if(T==="SID")R=R.concat(K.NUMBER(_));else if(T==="offset")R=R.concat(K.NUMBER32(_));else if(T==="number")R=R.concat(K.NUMBER(_));else{if(T!=="real")throw new Error("Unknown operand type "+T);R=R.concat(K.REAL(_))}return R},K.OP=K.BYTE,te.OP=te.BYTE;var pe=typeof WeakMap=="function"&&new WeakMap;function oe(_,T,R){for(var L=0;L<T.length;L+=1){var H=T[L];this[H.name]=H.value}if(this.tableName=_,this.fields=T,R)for(var Z=Object.keys(R),Q=0;Q<Z.length;Q+=1){var se=Z[Q],fe=R[se];this[se]!==void 0&&(this[se]=fe)}}function de(_,T,R){R===void 0&&(R=T.length);var L=new Array(T.length+1);L[0]={name:_+"Count",type:"USHORT",value:R};for(var H=0;H<T.length;H++)L[H+1]={name:_+H,type:"USHORT",value:T[H]};return L}function xe(_,T,R){var L=T.length,H=new Array(L+1);H[0]={name:_+"Count",type:"USHORT",value:L};for(var Z=0;Z<L;Z++)H[Z+1]={name:_+Z,type:"TABLE",value:R(T[Z],Z)};return H}function Te(_,T,R){var L=T.length,H=[];H[0]={name:_+"Count",type:"USHORT",value:L};for(var Z=0;Z<L;Z++)H=H.concat(R(T[Z],Z));return H}function Se(_){_.format===1?oe.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(de("glyph",_.glyphs))):U.assert(!1,"Can't create coverage table format 2 yet.")}function je(_){oe.call(this,"scriptListTable",Te("scriptRecord",_,function(T,R){var L=T.script,H=L.defaultLangSys;return U.assert(!!H,"Unable to write GSUB: script "+T.tag+" has no default language system."),[{name:"scriptTag"+R,type:"TAG",value:T.tag},{name:"script"+R,type:"TABLE",value:new oe("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new oe("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:H.reqFeatureIndex}].concat(de("featureIndex",H.featureIndexes)))}].concat(Te("langSys",L.langSysRecords,function(Z,Q){var se=Z.langSys;return[{name:"langSysTag"+Q,type:"TAG",value:Z.tag},{name:"langSys"+Q,type:"TABLE",value:new oe("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:se.reqFeatureIndex}].concat(de("featureIndex",se.featureIndexes)))}]})))}]}))}function Oe(_){oe.call(this,"featureListTable",Te("featureRecord",_,function(T,R){var L=T.feature;return[{name:"featureTag"+R,type:"TAG",value:T.tag},{name:"feature"+R,type:"TABLE",value:new oe("featureTable",[{name:"featureParams",type:"USHORT",value:L.featureParams}].concat(de("lookupListIndex",L.lookupListIndexes)))}]}))}function We(_,T){oe.call(this,"lookupListTable",xe("lookup",_,function(R){var L=T[R.lookupType];return U.assert(!!L,"Unable to write GSUB lookup type "+R.lookupType+" tables."),new oe("lookupTable",[{name:"lookupType",type:"USHORT",value:R.lookupType},{name:"lookupFlag",type:"USHORT",value:R.lookupFlag}].concat(xe("subtable",R.subtables,L)))}))}K.CHARSTRING=function(_){if(pe){var T=pe.get(_);if(T!==void 0)return T}for(var Z=[],R=_.length,L=0;L<R;L+=1)var H=_[L],Z=Z.concat(K[H.type](H.value));return pe&&pe.set(_,Z),Z},te.CHARSTRING=function(_){return K.CHARSTRING(_).length},K.OBJECT=function(_){var T=K[_.type];return U.argument(T!==void 0,"No encoding function for type "+_.type),T(_.value)},te.OBJECT=function(_){var T=te[_.type];return U.argument(T!==void 0,"No sizeOf function for type "+_.type),T(_.value)},K.TABLE=function(_){for(var T=[],R=_.fields.length,L=[],H=[],Z=0;Z<R;Z+=1){var Q=_.fields[Z],fe=K[Q.type],se=(U.argument(fe!==void 0,"No encoding function for field type "+Q.type+" ("+Q.name+")"),_[Q.name]),fe=fe(se=se===void 0?Q.value:se);Q.type==="TABLE"?(H.push(T.length),T=T.concat([0,0]),L.push(fe)):T=T.concat(fe)}for(var he=0;he<L.length;he+=1){var _e=H[he],Ae=T.length;U.argument(Ae<65536,"Table "+_.tableName+" too big."),T[_e]=Ae>>8,T[_e+1]=255&Ae,T=T.concat(L[he])}return T},te.TABLE=function(_){for(var T=0,R=_.fields.length,L=0;L<R;L+=1){var H=_.fields[L],Z=te[H.type],Q=(U.argument(Z!==void 0,"No sizeOf function for field type "+H.type+" ("+H.name+")"),_[H.name]);T+=Z(Q=Q===void 0?H.value:Q),H.type==="TABLE"&&(T+=2)}return T},K.RECORD=K.TABLE,te.RECORD=te.TABLE,K.LITERAL=function(_){return _},te.LITERAL=function(_){return _.length},oe.prototype.encode=function(){return K.TABLE(this)},oe.prototype.sizeOf=function(){return te.TABLE(this)};var Fe={Table:oe,Record:oe,Coverage:(Se.prototype=Object.create(oe.prototype)).constructor=Se,ScriptList:(je.prototype=Object.create(oe.prototype)).constructor=je,FeatureList:(Oe.prototype=Object.create(oe.prototype)).constructor=Oe,LookupList:(We.prototype=Object.create(oe.prototype)).constructor=We,ushortList:de,tableList:xe,recordList:Te};function ut(_,T){return _.getUint8(T)}function tt(_,T){return _.getUint16(T,!1)}function rt(_,T){return _.getUint32(T,!1)}function it(_,T){return _.getInt16(T,!1)+_.getUint16(T+2,!1)/65535}var nt={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Ce(_,T){this.data=_,this.offset=T,this.relativeOffset=0}Ce.prototype.parseByte=function(){var _=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,_},Ce.prototype.parseChar=function(){var _=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,_},Ce.prototype.parseCard8=Ce.prototype.parseByte,Ce.prototype.parseCard16=Ce.prototype.parseUShort=function(){var _=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,_},Ce.prototype.parseSID=Ce.prototype.parseUShort,Ce.prototype.parseOffset16=Ce.prototype.parseUShort,Ce.prototype.parseShort=function(){var _=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,_},Ce.prototype.parseF2Dot14=function(){var _=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,_},Ce.prototype.parseOffset32=Ce.prototype.parseULong=function(){var _=rt(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,_},Ce.prototype.parseFixed=function(){var _=it(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,_},Ce.prototype.parseString=function(_){var T=this.data,R=this.offset+this.relativeOffset,L="";this.relativeOffset+=_;for(var H=0;H<_;H++)L+=String.fromCharCode(T.getUint8(R+H));return L},Ce.prototype.parseTag=function(){return this.parseString(4)},Ce.prototype.parseLongDateTime=function(){var _=rt(this.data,this.offset+this.relativeOffset+4);return _-=2082844800,this.relativeOffset+=8,_},Ce.prototype.parseVersion=function(_){var T=tt(this.data,this.offset+this.relativeOffset),R=tt(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,T+R/(_=_===void 0?4096:_)/10},Ce.prototype.skip=function(_,T){this.relativeOffset+=nt[_]*(T=T===void 0?1:T)},Ce.prototype.parseULongList=function(_){_===void 0&&(_=this.parseULong());for(var T=new Array(_),R=this.data,L=this.offset+this.relativeOffset,H=0;H<_;H++)T[H]=R.getUint32(L),L+=4;return this.relativeOffset+=4*_,T},Ce.prototype.parseOffset16List=Ce.prototype.parseUShortList=function(_){_===void 0&&(_=this.parseUShort());for(var T=new Array(_),R=this.data,L=this.offset+this.relativeOffset,H=0;H<_;H++)T[H]=R.getUint16(L),L+=2;return this.relativeOffset+=2*_,T},Ce.prototype.parseShortList=function(_){for(var T=new Array(_),R=this.data,L=this.offset+this.relativeOffset,H=0;H<_;H++)T[H]=R.getInt16(L),L+=2;return this.relativeOffset+=2*_,T},Ce.prototype.parseByteList=function(_){for(var T=new Array(_),R=this.data,L=this.offset+this.relativeOffset,H=0;H<_;H++)T[H]=R.getUint8(L++);return this.relativeOffset+=_,T},Ce.prototype.parseList=function(_,T){T||(T=_,_=this.parseUShort());for(var R=new Array(_),L=0;L<_;L++)R[L]=T.call(this);return R},Ce.prototype.parseList32=function(_,T){T||(T=_,_=this.parseULong());for(var R=new Array(_),L=0;L<_;L++)R[L]=T.call(this);return R},Ce.prototype.parseRecordList=function(_,T){T||(T=_,_=this.parseUShort());for(var R=new Array(_),L=Object.keys(T),H=0;H<_;H++){for(var Z={},Q=0;Q<L.length;Q++){var se=L[Q],fe=T[se];Z[se]=fe.call(this)}R[H]=Z}return R},Ce.prototype.parseRecordList32=function(_,T){T||(T=_,_=this.parseULong());for(var R=new Array(_),L=Object.keys(T),H=0;H<_;H++){for(var Z={},Q=0;Q<L.length;Q++){var se=L[Q],fe=T[se];Z[se]=fe.call(this)}R[H]=Z}return R},Ce.prototype.parseStruct=function(_){if(typeof _=="function")return _.call(this);for(var T=Object.keys(_),R={},L=0;L<T.length;L++){var H=T[L],Z=_[H];R[H]=Z.call(this)}return R},Ce.prototype.parseValueRecord=function(_){var T;if((_=_===void 0?this.parseUShort():_)!==0)return T={},1&_&&(T.xPlacement=this.parseShort()),2&_&&(T.yPlacement=this.parseShort()),4&_&&(T.xAdvance=this.parseShort()),8&_&&(T.yAdvance=this.parseShort()),16&_&&(T.xPlaDevice=void 0,this.parseShort()),32&_&&(T.yPlaDevice=void 0,this.parseShort()),64&_&&(T.xAdvDevice=void 0,this.parseShort()),128&_&&(T.yAdvDevice=void 0,this.parseShort()),T},Ce.prototype.parseValueRecordList=function(){for(var _=this.parseUShort(),T=this.parseUShort(),R=new Array(T),L=0;L<T;L++)R[L]=this.parseValueRecord(_);return R},Ce.prototype.parsePointer=function(_){var T=this.parseOffset16();if(0<T)return new Ce(this.data,this.offset+T).parseStruct(_)},Ce.prototype.parsePointer32=function(_){var T=this.parseOffset32();if(0<T)return new Ce(this.data,this.offset+T).parseStruct(_)},Ce.prototype.parseListOfLists=function(_){for(var T=this.parseOffset16List(),R=T.length,L=this.relativeOffset,H=new Array(R),Z=0;Z<R;Z++){var Q=T[Z];if(Q===0)H[Z]=void 0;else if(this.relativeOffset=Q,_){for(var se=this.parseOffset16List(),fe=new Array(se.length),he=0;he<se.length;he++)this.relativeOffset=Q+se[he],fe[he]=_.call(this);H[Z]=fe}else H[Z]=this.parseUShortList()}return this.relativeOffset=L,H},Ce.prototype.parseCoverage=function(){var _=this.offset+this.relativeOffset,T=this.parseUShort(),R=this.parseUShort();if(T===1)return{format:1,glyphs:this.parseUShortList(R)};if(T!==2)throw new Error("0x"+_.toString(16)+": Coverage format must be 1 or 2.");for(var L=new Array(R),H=0;H<R;H++)L[H]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:L}},Ce.prototype.parseClassDef=function(){var _=this.offset+this.relativeOffset,T=this.parseUShort();if(T===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(T===2)return{format:2,ranges:this.parseRecordList({start:Ce.uShort,end:Ce.uShort,classId:Ce.uShort})};throw new Error("0x"+_.toString(16)+": ClassDef format must be 1 or 2.")},Ce.list=function(_,T){return function(){return this.parseList(_,T)}},Ce.list32=function(_,T){return function(){return this.parseList32(_,T)}},Ce.recordList=function(_,T){return function(){return this.parseRecordList(_,T)}},Ce.recordList32=function(_,T){return function(){return this.parseRecordList32(_,T)}},Ce.pointer=function(_){return function(){return this.parsePointer(_)}},Ce.pointer32=function(_){return function(){return this.parsePointer32(_)}},Ce.tag=Ce.prototype.parseTag,Ce.byte=Ce.prototype.parseByte,Ce.uShort=Ce.offset16=Ce.prototype.parseUShort,Ce.uShortList=Ce.prototype.parseUShortList,Ce.uLong=Ce.offset32=Ce.prototype.parseULong,Ce.uLongList=Ce.prototype.parseULongList,Ce.struct=Ce.prototype.parseStruct,Ce.coverage=Ce.prototype.parseCoverage,Ce.classDef=Ce.prototype.parseClassDef;var Ge={reserved:Ce.uShort,reqFeatureIndex:Ce.uShort,featureIndexes:Ce.uShortList},Me=(Ce.prototype.parseScriptList=function(){return this.parsePointer(Ce.recordList({tag:Ce.tag,script:Ce.pointer({defaultLangSys:Ce.pointer(Ge),langSysRecords:Ce.recordList({tag:Ce.tag,langSys:Ce.pointer(Ge)})})}))||[]},Ce.prototype.parseFeatureList=function(){return this.parsePointer(Ce.recordList({tag:Ce.tag,feature:Ce.pointer({featureParams:Ce.offset16,lookupListIndexes:Ce.uShortList})}))||[]},Ce.prototype.parseLookupList=function(_){return this.parsePointer(Ce.list(Ce.pointer(function(){var T=this.parseUShort(),R=(U.argument(1<=T&&T<=9,"GPOS/GSUB lookup type "+T+" unknown."),this.parseUShort()),L=16&R;return{lookupType:T,lookupFlag:R,subtables:this.parseList(Ce.pointer(_[T])),markFilteringSet:L?this.parseUShort():void 0}})))||[]},Ce.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var _=this.parseUShort(),T=this.parseUShort();return U.argument(_===1&&T<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:Ce.offset32,featureTableSubstitutionOffset:Ce.offset32})})||[]},{getByte:ut,getCard8:ut,getUShort:tt,getCard16:tt,getShort:function(_,T){return _.getInt16(T,!1)},getULong:rt,getFixed:it,getTag:function(_,T){for(var R="",L=T;L<T+4;L+=1)R+=String.fromCharCode(_.getInt8(L));return R},getOffset:function(_,T,R){for(var L=0,H=0;H<R;H+=1)L=(L<<=8)+_.getUint8(T+H);return L},getBytes:function(_,T,R){for(var L=[],H=T;H<R;H+=1)L.push(_.getUint8(H));return L},bytesToString:function(_){for(var T="",R=0;R<_.length;R+=1)T+=String.fromCharCode(_[R]);return T},Parser:Ce}),re={parse:function(_,T){for(var R={},L=(R.version=Me.getUShort(_,T),U.argument(R.version===0,"cmap table version should be 0."),R.numTables=Me.getUShort(_,T+2),-1),H=R.numTables-1;0<=H;--H){var Z=Me.getUShort(_,T+4+8*H),Q=Me.getUShort(_,T+4+8*H+2);if(Z===3&&(Q===0||Q===1||Q===10)||Z===0&&(Q===0||Q===1||Q===2||Q===3||Q===4)){L=Me.getULong(_,T+4+8*H+4);break}}if(L===-1)throw new Error("No valid cmap sub-tables found.");var se=new Me.Parser(_,T+L);if(R.format=se.parseUShort(),R.format===12){var fe,he=R,_e=se;_e.parseUShort(),he.length=_e.parseULong(),he.language=_e.parseULong(),he.groupCount=fe=_e.parseULong(),he.glyphIndexMap={};for(var Ae=0;Ae<fe;Ae+=1)for(var Pe=_e.parseULong(),ve=_e.parseULong(),Ve=_e.parseULong(),Ne=Pe;Ne<=ve;Ne+=1)he.glyphIndexMap[Ne]=Ve,Ve++}else{if(R.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+R.format+").");var Be=R,De=_,Le=T,St=L;Be.length=se.parseUShort(),Be.language=se.parseUShort(),Be.segCount=At=se.parseUShort()>>1,se.skip("uShort",3),Be.glyphIndexMap={};for(var At,wt=new Me.Parser(De,Le+St+14),_t=new Me.Parser(De,Le+St+16+2*At),Ft=new Me.Parser(De,Le+St+16+4*At),br=new Me.Parser(De,Le+St+16+6*At),Yr=Le+St+16+8*At,ln=0;ln<At-1;ln+=1)for(var Nn=void 0,$n=wt.parseUShort(),Cs=_t.parseUShort(),yr=Ft.parseShort(),Pr=br.parseUShort(),ir=Cs;ir<=$n;ir+=1)Pr!==0?(Yr=(Yr=br.offset+br.relativeOffset-2)+Pr+2*(ir-Cs),(Nn=Me.getUShort(De,Yr))!==0&&(Nn=Nn+yr&65535)):Nn=ir+yr&65535,Be.glyphIndexMap[ir]=Nn}return R},make:function(_){for(var T=!0,R=_.length-1;0<R;--R)if(65535<_.get(R).unicode){console.log("Adding CMAP format 12 (needed!)"),T=!1;break}var L,H,Z=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:T?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:T?12:20}],Q=(Z=(Z=T?Z:Z.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])).concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),new Fe.Table("cmap",Z));for(Q.segments=[],R=0;R<_.length;R+=1){for(var se=_.get(R),fe=0;fe<se.unicodes.length;fe+=1)L=se.unicodes[fe],H=R,Q.segments.push({end:L,start:L,delta:-(L-H),offset:0,glyphIndex:H});Q.segments=Q.segments.sort(function(Le,St){return Le.start-St.start})}Q.segments.push({end:65535,start:65535,delta:1,offset:0});var he=Q.segments.length,_e=0,Ae=[],Pe=[],ve=[],Ve=[],Ne=[],Be=[];for(R=0;R<he;R+=1){var De=Q.segments[R];De.end<=65535&&De.start<=65535?(Ae=Ae.concat({name:"end_"+R,type:"USHORT",value:De.end}),Pe=Pe.concat({name:"start_"+R,type:"USHORT",value:De.start}),ve=ve.concat({name:"idDelta_"+R,type:"SHORT",value:De.delta}),Ve=Ve.concat({name:"idRangeOffset_"+R,type:"USHORT",value:De.offset}),De.glyphId!==void 0&&(Ne=Ne.concat({name:"glyph_"+R,type:"USHORT",value:De.glyphId}))):_e+=1,T||De.glyphIndex===void 0||(Be=(Be=(Be=Be.concat({name:"cmap12Start_"+R,type:"ULONG",value:De.start})).concat({name:"cmap12End_"+R,type:"ULONG",value:De.end})).concat({name:"cmap12Glyph_"+R,type:"ULONG",value:De.glyphIndex}))}return Q.segCountX2=2*(he-_e),Q.searchRange=2*Math.pow(2,Math.floor(Math.log(he-_e)/Math.log(2))),Q.entrySelector=Math.log(Q.searchRange/2)/Math.log(2),Q.rangeShift=Q.segCountX2-Q.searchRange,Q.fields=Q.fields.concat(Ae),Q.fields.push({name:"reservedPad",type:"USHORT",value:0}),Q.fields=Q.fields.concat(Pe),Q.fields=Q.fields.concat(ve),Q.fields=Q.fields.concat(Ve),Q.fields=Q.fields.concat(Ne),Q.cmap4Length=14+2*Ae.length+2+2*Pe.length+2*ve.length+2*Ve.length+2*Ne.length,T||(Z=16+4*Be.length,Q.cmap12Offset=20+Q.cmap4Length,Q.fields=Q.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:Z},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:Be.length/3}]),Q.fields=Q.fields.concat(Be)),Q}},ie=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ee=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],ue=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],we=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ke(_){this.font=_}function $e(_){this.cmap=_}function Ke(_,T){this.encoding=_,this.charset=T}function Qe(_){switch(_.version){case 1:this.names=we.slice();break;case 2:this.names=new Array(_.numberOfGlyphs);for(var T=0;T<_.numberOfGlyphs;T++)_.glyphNameIndex[T]<we.length?this.names[T]=we[_.glyphNameIndex[T]]:this.names[T]=_.names[_.glyphNameIndex[T]-we.length];break;case 2.5:this.names=new Array(_.numberOfGlyphs);for(var R=0;R<_.numberOfGlyphs;R++)this.names[R]=we[R+_.glyphNameIndex[R]];break;default:this.names=[]}}ke.prototype.charToGlyphIndex=function(_){var T=_.codePointAt(0),R=this.font.glyphs;if(R){for(var L=0;L<R.length;L+=1)for(var H=R.get(L),Z=0;Z<H.unicodes.length;Z+=1)if(H.unicodes[Z]===T)return L}return null},$e.prototype.charToGlyphIndex=function(_){return this.cmap.glyphIndexMap[_.codePointAt(0)]||0},Ke.prototype.charToGlyphIndex=function(_){return _=_.codePointAt(0),_=this.encoding[_],this.charset.indexOf(_)},Qe.prototype.nameToGlyphIndex=function(_){return this.names.indexOf(_)},Qe.prototype.glyphIndexToName=function(_){return this.names[_]};var et={line:function(_,T,R,L,H){_.beginPath(),_.moveTo(T,R),_.lineTo(L,H),_.stroke()}};function at(_){this.bindConstructorValues(_)}function Ot(_,T,R){Object.defineProperty(_,T,{get:function(){return _.path,_[R]},set:function(L){_[R]=L},enumerable:!0,configurable:!0})}function Ct(_,T){if(this.font=_,this.glyphs={},Array.isArray(T))for(var R=0;R<T.length;R++)this.glyphs[R]=T[R];this.length=T&&T.length||0}at.prototype.bindConstructorValues=function(_){var T;this.index=_.index||0,this.name=_.name||null,this.unicode=_.unicode||void 0,this.unicodes=_.unicodes||_.unicode!==void 0?[_.unicode]:[],_.xMin&&(this.xMin=_.xMin),_.yMin&&(this.yMin=_.yMin),_.xMax&&(this.xMax=_.xMax),_.yMax&&(this.yMax=_.yMax),_.advanceWidth&&(this.advanceWidth=_.advanceWidth),Object.defineProperty(this,"path",(_=_.path,T=_||new J,{configurable:!0,get:function(){return T=typeof T=="function"?T():T},set:function(R){T=R}}))},at.prototype.addUnicode=function(_){this.unicodes.length===0&&(this.unicode=_),this.unicodes.push(_)},at.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},at.prototype.getPath=function(_,T,R,L,H){_=_!==void 0?_:0,T=T!==void 0?T:0,R=R!==void 0?R:72;for(var Z,Q,se=(L=L||{}).xScale,fe=L.yScale,he=((Z=L.hinting&&H&&H.hinting?this.path&&H.hinting.exec(this,R):Z)?(Q=H.hinting.getCommands(Z),_=Math.round(_),T=Math.round(T),se=fe=1):(Q=this.path.commands,L=1/this.path.unitsPerEm*R,se===void 0&&(se=L),fe===void 0&&(fe=L)),new J),_e=0;_e<Q.length;_e+=1){var Ae=Q[_e];Ae.type==="M"?he.moveTo(_+Ae.x*se,T+-Ae.y*fe):Ae.type==="L"?he.lineTo(_+Ae.x*se,T+-Ae.y*fe):Ae.type==="Q"?he.quadraticCurveTo(_+Ae.x1*se,T+-Ae.y1*fe,_+Ae.x*se,T+-Ae.y*fe):Ae.type==="C"?he.curveTo(_+Ae.x1*se,T+-Ae.y1*fe,_+Ae.x2*se,T+-Ae.y2*fe,_+Ae.x*se,T+-Ae.y*fe):Ae.type==="Z"&&he.closePath()}return he},at.prototype.getContours=function(){if(this.points===void 0)return[];for(var _=[],T=[],R=0;R<this.points.length;R+=1){var L=this.points[R];T.push(L),L.lastPointOfContour&&(_.push(T),T=[])}return U.argument(T.length===0,"There are still points left in the current contour."),_},at.prototype.getMetrics=function(){for(var _=this.path.commands,T=[],R=[],L=0;L<_.length;L+=1){var H=_[L];H.type!=="Z"&&(T.push(H.x),R.push(H.y)),H.type!=="Q"&&H.type!=="C"||(T.push(H.x1),R.push(H.y1)),H.type==="C"&&(T.push(H.x2),R.push(H.y2))}var Z={xMin:Math.min.apply(null,T),yMin:Math.min.apply(null,R),xMax:Math.max.apply(null,T),yMax:Math.max.apply(null,R),leftSideBearing:this.leftSideBearing};return isFinite(Z.xMin)||(Z.xMin=0),isFinite(Z.xMax)||(Z.xMax=this.advanceWidth),isFinite(Z.yMin)||(Z.yMin=0),isFinite(Z.yMax)||(Z.yMax=0),Z.rightSideBearing=this.advanceWidth-Z.leftSideBearing-(Z.xMax-Z.xMin),Z},at.prototype.draw=function(_,T,R,L,H){this.getPath(T,R,L,H).draw(_)},at.prototype.drawPoints=function(_,T,R,L){function H(_e,Ae,Pe,ve){var Ve=2*Math.PI;_.beginPath();for(var Ne=0;Ne<_e.length;Ne+=1)_.moveTo(Ae+_e[Ne].x*ve,Pe+_e[Ne].y*ve),_.arc(Ae+_e[Ne].x*ve,Pe+_e[Ne].y*ve,2,0,Ve,!1);_.closePath(),_.fill()}T=T!==void 0?T:0,R=R!==void 0?R:0;for(var L=1/this.path.unitsPerEm*(L=L!==void 0?L:24),Z=[],Q=[],se=this.path,fe=0;fe<se.commands.length;fe+=1){var he=se.commands[fe];he.x!==void 0&&Z.push({x:he.x,y:-he.y}),he.x1!==void 0&&Q.push({x:he.x1,y:-he.y1}),he.x2!==void 0&&Q.push({x:he.x2,y:-he.y2})}_.fillStyle="blue",H(Z,T,R,L),_.fillStyle="red",H(Q,T,R,L)},at.prototype.drawMetrics=function(_,T,R,L){T=T!==void 0?T:0,R=R!==void 0?R:0,L=1/this.path.unitsPerEm*(L=L!==void 0?L:24),_.lineWidth=1,_.strokeStyle="black",et.line(_,T,-1e4,T,1e4),et.line(_,-1e4,R,1e4,R);var H=this.xMin||0,Z=this.yMin||0,Q=this.xMax||0,se=this.yMax||0,fe=this.advanceWidth||0;_.strokeStyle="blue",et.line(_,T+H*L,-1e4,T+H*L,1e4),et.line(_,T+Q*L,-1e4,T+Q*L,1e4),et.line(_,-1e4,R+-Z*L,1e4,R+-Z*L),et.line(_,-1e4,R+-se*L,1e4,R+-se*L),_.strokeStyle="green",et.line(_,T+fe*L,-1e4,T+fe*L,1e4)},Ct.prototype.get=function(_){return typeof this.glyphs[_]=="function"&&(this.glyphs[_]=this.glyphs[_]()),this.glyphs[_]},Ct.prototype.push=function(_,T){this.glyphs[_]=T,this.length++};var dt={GlyphSet:Ct,glyphLoader:function(_,T){return new at({index:T,font:_})},ttfGlyphLoader:function(_,T,R,L,H,Z){return function(){var Q=new at({index:T,font:_});return Q.path=function(){R(Q,L,H);var se=Z(_.glyphs,Q);return se.unitsPerEm=_.unitsPerEm,se},Ot(Q,"xMin","_xMin"),Ot(Q,"xMax","_xMax"),Ot(Q,"yMin","_yMin"),Ot(Q,"yMax","_yMax"),Q}},cffGlyphLoader:function(_,T,R,L){return function(){var H=new at({index:T,font:_});return H.path=function(){var Z=R(_,H,L);return Z.unitsPerEm=_.unitsPerEm,Z},H}}};function Pt(_){return _=_.length<1240?107:_.length<33900?1131:32768,_}function Et(_,T,R){var L,H=[],Z=[],Q=Me.getCard16(_,T);if(Q!==0){for(var se=Me.getByte(_,T+2),fe=T+(Q+1)*se+2,he=T+3,_e=0;_e<Q+1;_e+=1)H.push(Me.getOffset(_,he,se)),he+=se;L=fe+H[Q]}else L=T+2;for(var Ae=0;Ae<H.length-1;Ae+=1){var Pe=Me.getBytes(_,fe+H[Ae],fe+H[Ae+1]);R&&(Pe=R(Pe)),Z.push(Pe)}return{objects:Z,startOffset:T,endOffset:L}}function rr(_,T){if(T===28)return _.parseByte()<<8|_.parseByte();if(T===29)return _.parseByte()<<24|_.parseByte()<<16|_.parseByte()<<8|_.parseByte();if(T===30){for(var R=_,L="",H=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Q=R.parseByte(),Z=Q>>4,Q=15&Q;if(Z==15||(L+=H[Z],Q==15))break;L+=H[Q]}return parseFloat(L)}if(32<=T&&T<=246)return T-139;if(247<=T&&T<=250)return 256*(T-247)+_.parseByte()+108;if(251<=T&&T<=254)return 256*-(T-251)-_.parseByte()-108;throw new Error("Invalid b0 "+T)}function Hr(_,T,R){var L=new Me.Parser(_,T=T!==void 0?T:0),H=[],Z=[];for(R=R!==void 0?R:_.length;L.relativeOffset<R;){var Q=L.parseByte();Q<=21?(Q===12&&(Q=1200+L.parseByte()),H.push([Q,Z]),Z=[]):Z.push(rr(L,Q))}for(var se=H,fe={},he=0;he<se.length;he+=1){var _e=se[he][0],Ae=se[he][1],Pe=void 0,Pe=Ae.length===1?Ae[0]:Ae;if(fe.hasOwnProperty(_e)&&!isNaN(fe[_e]))throw new Error("Object "+fe+" already has key "+_e);fe[_e]=Pe}return fe}function Wr(_,T){return T=T<=390?ie[T]:_[T-391]}function Qt(_,T,R){for(var L,H={},Z=0;Z<T.length;Z+=1){var Q=T[Z];if(Array.isArray(Q.type)){var se=[];se.length=Q.type.length;for(var fe=0;fe<Q.type.length;fe++)(L=_[Q.op]!==void 0?_[Q.op][fe]:void 0)===void 0&&(L=Q.value!==void 0&&Q.value[fe]!==void 0?Q.value[fe]:null),Q.type[fe]==="SID"&&(L=Wr(R,L)),se[fe]=L;H[Q.name]=se}else(L=_[Q.op])===void 0&&(L=Q.value!==void 0?Q.value:null),Q.type==="SID"&&(L=Wr(R,L)),H[Q.name]=L}return H}var pr=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Ht=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function pn(_,T,R,L){return Qt(Hr(_,T,R),Ht,L)}function Zr(_,T,R,L){for(var H=[],Z=0;Z<R.length;Z+=1){var Q=new DataView(new Uint8Array(R[Z]).buffer),Q=(se=L,Qt(Hr(Q,0,Q.byteLength),pr,se)),se=(Q._subrs=[],Q._subrsBias=0,Q.private[0]),fe=Q.private[1];se!==0&&fe!==0&&(se=pn(_,fe+T,se,L),Q._defaultWidthX=se.defaultWidthX,Q._nominalWidthX=se.nominalWidthX,se.subrs!==0&&(fe=Et(_,fe+se.subrs+T),Q._subrs=fe.objects,Q._subrsBias=Pt(Q._subrs)),Q._privateDict=se),H.push(Q)}return H}function Jt(_,T,R){var L,H,Z,Q,se,fe,he,_e,Ae,Pe=new J,ve=[],Ve=0,Ne=!1,Be=!1,De=0,Le=0,St=(Ae=(_.isCIDFont?(se=_.tables.cff.topDict._fdSelect[T.index],se=_.tables.cff.topDict._fdArray[se],fe=se._subrs,he=se._subrsBias,_e=se._defaultWidthX,se):(fe=_.tables.cff.topDict._subrs,he=_.tables.cff.topDict._subrsBias,_e=_.tables.cff.topDict._defaultWidthX,_.tables.cff.topDict))._nominalWidthX,_e);function At(_t,Ft){Be&&Pe.closePath(),Pe.moveTo(_t,Ft),Be=!0}function wt(){ve.length%2==0||Ne||(St=ve.shift()+Ae),Ve+=ve.length>>1,ve.length=0,Ne=!0}return function _t(Ft){for(var br,Yr,ln,Nn,$n,Cs,yr,Pr,ir,Un,Nr,Pn,Tr=0;Tr<Ft.length;){var xn=Ft[Tr];switch(Tr+=1,xn){case 1:case 3:wt();break;case 4:1<ve.length&&!Ne&&(St=ve.shift()+Ae,Ne=!0),Le+=ve.pop(),At(De,Le);break;case 5:for(;0<ve.length;)De+=ve.shift(),Le+=ve.shift(),Pe.lineTo(De,Le);break;case 6:for(;0<ve.length&&(De+=ve.shift(),Pe.lineTo(De,Le),ve.length!==0);)Le+=ve.shift(),Pe.lineTo(De,Le);break;case 7:for(;0<ve.length&&(Le+=ve.shift(),Pe.lineTo(De,Le),ve.length!==0);)De+=ve.shift(),Pe.lineTo(De,Le);break;case 8:for(;0<ve.length;)L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q+ve.shift(),Pe.curveTo(L,H,Z,Q,De,Le);break;case 10:$n=ve.pop()+he,(Cs=fe[$n])&&_t(Cs);break;case 11:return;case 12:switch(xn=Ft[Tr],Tr+=1,xn){case 35:L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),yr=Z+ve.shift(),Pr=Q+ve.shift(),ir=yr+ve.shift(),Un=Pr+ve.shift(),Nr=ir+ve.shift(),Pn=Un+ve.shift(),De=Nr+ve.shift(),Le=Pn+ve.shift(),ve.shift(),Pe.curveTo(L,H,Z,Q,yr,Pr),Pe.curveTo(ir,Un,Nr,Pn,De,Le);break;case 34:L=De+ve.shift(),H=Le,Z=L+ve.shift(),Q=H+ve.shift(),yr=Z+ve.shift(),Pr=Q,ir=yr+ve.shift(),Un=Q,Nr=ir+ve.shift(),Pn=Le,De=Nr+ve.shift(),Pe.curveTo(L,H,Z,Q,yr,Pr),Pe.curveTo(ir,Un,Nr,Pn,De,Le);break;case 36:L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),yr=Z+ve.shift(),Pr=Q,ir=yr+ve.shift(),Un=Q,Nr=ir+ve.shift(),Pn=Un+ve.shift(),De=Nr+ve.shift(),Pe.curveTo(L,H,Z,Q,yr,Pr),Pe.curveTo(ir,Un,Nr,Pn,De,Le);break;case 37:L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),yr=Z+ve.shift(),Pr=Q+ve.shift(),ir=yr+ve.shift(),Un=Pr+ve.shift(),Nr=ir+ve.shift(),Pn=Un+ve.shift(),Math.abs(Nr-De)>Math.abs(Pn-Le)?De=Nr+ve.shift():Le=Pn+ve.shift(),Pe.curveTo(L,H,Z,Q,yr,Pr),Pe.curveTo(ir,Un,Nr,Pn,De,Le);break;default:console.log("Glyph "+T.index+": unknown operator 1200"+xn),ve.length=0}break;case 14:0<ve.length&&!Ne&&(St=ve.shift()+Ae,Ne=!0),Be&&(Pe.closePath(),Be=!1);break;case 18:wt();break;case 19:case 20:wt(),Tr+=Ve+7>>3;break;case 21:2<ve.length&&!Ne&&(St=ve.shift()+Ae,Ne=!0),Le+=ve.pop(),At(De+=ve.pop(),Le);break;case 22:1<ve.length&&!Ne&&(St=ve.shift()+Ae,Ne=!0),At(De+=ve.pop(),Le);break;case 23:wt();break;case 24:for(;2<ve.length;)L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q+ve.shift(),Pe.curveTo(L,H,Z,Q,De,Le);De+=ve.shift(),Le+=ve.shift(),Pe.lineTo(De,Le);break;case 25:for(;6<ve.length;)De+=ve.shift(),Le+=ve.shift(),Pe.lineTo(De,Le);L=De+ve.shift(),H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q+ve.shift(),Pe.curveTo(L,H,Z,Q,De,Le);break;case 26:for(ve.length%2&&(De+=ve.shift());0<ve.length;)L=De,H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z,Le=Q+ve.shift(),Pe.curveTo(L,H,Z,Q,De,Le);break;case 27:for(ve.length%2&&(Le+=ve.shift());0<ve.length;)L=De+ve.shift(),H=Le,Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q,Pe.curveTo(L,H,Z,Q,De,Le);break;case 28:br=Ft[Tr],Yr=Ft[Tr+1],ve.push((br<<24|Yr<<16)>>16),Tr+=2;break;case 29:$n=ve.pop()+_.gsubrsBias,(Cs=_.gsubrs[$n])&&_t(Cs);break;case 30:for(;0<ve.length&&(L=De,H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q+(ve.length===1?ve.shift():0),Pe.curveTo(L,H,Z,Q,De,Le),ve.length!==0);)L=De+ve.shift(),H=Le,Z=L+ve.shift(),Q=H+ve.shift(),Le=Q+ve.shift(),De=Z+(ve.length===1?ve.shift():0),Pe.curveTo(L,H,Z,Q,De,Le);break;case 31:for(;0<ve.length&&(L=De+ve.shift(),H=Le,Z=L+ve.shift(),Q=H+ve.shift(),Le=Q+ve.shift(),De=Z+(ve.length===1?ve.shift():0),Pe.curveTo(L,H,Z,Q,De,Le),ve.length!==0);)L=De,H=Le+ve.shift(),Z=L+ve.shift(),Q=H+ve.shift(),De=Z+ve.shift(),Le=Q+(ve.length===1?ve.shift():0),Pe.curveTo(L,H,Z,Q,De,Le);break;default:xn<32?console.log("Glyph "+T.index+": unknown operator "+xn):xn<247?ve.push(xn-139):xn<251?(br=Ft[Tr],Tr+=1,ve.push(256*(xn-247)+br+108)):xn<255?(br=Ft[Tr],Tr+=1,ve.push(256*-(xn-251)-br-108)):(br=Ft[Tr],Yr=Ft[Tr+1],ln=Ft[Tr+2],Nn=Ft[Tr+3],Tr+=4,ve.push((br<<24|Yr<<16|ln<<8|Nn)/65536))}}}(R),T.advanceWidth=St,Pe}function Er(_,T){var R,L=ie.indexOf(_);return 0<=L&&(R=L),0<=(L=T.indexOf(_))?R=L+ie.length:(R=ie.length+T.length,T.push(_)),R}function al(_,T,R){for(var L={},H=0;H<_.length;H+=1){var Z=_[H],Q=T[Z.name];Q===void 0||function se(fe,he){if(fe===he)return 1;if(Array.isArray(fe)&&Array.isArray(he)&&fe.length===he.length){for(var _e=0;_e<fe.length;_e+=1)if(!se(fe[_e],he[_e]))return;return 1}}(Q,Z.value)||(Z.type==="SID"&&(Q=Er(Q,R)),L[Z.op]={name:Z.name,type:Z.type,value:Q})}return L}function ll(_,T){var R=new Fe.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return R.dict=al(pr,_,T),R}function cl(_){var T=new Fe.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return T.topDicts=[{name:"topDict_0",type:"TABLE",value:_}],T}function sc(_){for(var T=new Fe.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),R=0;R<_.length;R+=1){var L=_.get(R),H=function(Z){for(var Q=[],se=Z.path,fe=(Q.push({name:"width",type:"NUMBER",value:Z.advanceWidth}),0),he=0,_e=0;_e<se.commands.length;_e+=1){var Ae,Pe,ve,Ve,Ne=void 0,Be=void 0,De=se.commands[_e];(De=De.type==="Q"?{type:"C",x:De.x,y:De.y,x1:1/3*fe+2/3*De.x1,y1:1/3*he+2/3*De.y1,x2:1/3*De.x+2/3*De.x1,y2:1/3*De.y+2/3*De.y1}:De).type==="M"?(Ne=Math.round(De.x-fe),Be=Math.round(De.y-he),Q.push({name:"dx",type:"NUMBER",value:Ne}),Q.push({name:"dy",type:"NUMBER",value:Be}),Q.push({name:"rmoveto",type:"OP",value:21}),fe=Math.round(De.x),he=Math.round(De.y)):De.type==="L"?(Ne=Math.round(De.x-fe),Be=Math.round(De.y-he),Q.push({name:"dx",type:"NUMBER",value:Ne}),Q.push({name:"dy",type:"NUMBER",value:Be}),Q.push({name:"rlineto",type:"OP",value:5}),fe=Math.round(De.x),he=Math.round(De.y)):De.type==="C"&&(Ae=Math.round(De.x1-fe),Pe=Math.round(De.y1-he),ve=Math.round(De.x2-De.x1),Ve=Math.round(De.y2-De.y1),Ne=Math.round(De.x-De.x2),Be=Math.round(De.y-De.y2),Q.push({name:"dx1",type:"NUMBER",value:Ae}),Q.push({name:"dy1",type:"NUMBER",value:Pe}),Q.push({name:"dx2",type:"NUMBER",value:ve}),Q.push({name:"dy2",type:"NUMBER",value:Ve}),Q.push({name:"dx",type:"NUMBER",value:Ne}),Q.push({name:"dy",type:"NUMBER",value:Be}),Q.push({name:"rrcurveto",type:"OP",value:8}),fe=Math.round(De.x),he=Math.round(De.y))}return Q.push({name:"endchar",type:"OP",value:14}),Q}(L);T.charStrings.push({name:L.name,type:"CHARSTRING",value:H})}return T}var ul={parse:function(_,T,R){R.tables.cff={},se=_,L=T,(H={}).formatMajor=Me.getCard8(se,L),H.formatMinor=Me.getCard8(se,L+1),H.size=Me.getCard8(se,L+2),H.offsetSize=Me.getCard8(se,L+3),H.startOffset=L,H.endOffset=L+4;var se=Et(_,H.endOffset,Me.bytesToString),L=Et(_,se.endOffset),H=Et(_,L.endOffset,Me.bytesToString),se=Et(_,H.endOffset);if(R.gsubrs=se.objects,R.gsubrsBias=Pt(R.gsubrs),(se=Zr(_,T,L.objects,H.objects)).length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+se.length);if(L=se[0],(R.tables.cff.topDict=L)._privateDict&&(R.defaultWidthX=L._privateDict.defaultWidthX,R.nominalWidthX=L._privateDict.nominalWidthX),L.ros[0]!==void 0&&L.ros[1]!==void 0&&(R.isCIDFont=!0),R.isCIDFont){var se=L.fdArray,Z=L.fdSelect;if(se===0||Z===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");se=Zr(_,T,Et(_,se+=T).objects,H.objects),L._fdArray=se,L._fdSelect=function(Pe,ve,Ve,Ne){var Be,De=[],Le=new Me.Parser(Pe,ve);if((Pe=Le.parseCard8())===0)for(var St=0;St<Ve;St++){if(Ne<=(Be=Le.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+Be+" (FD count "+Ne+")");De.push(Be)}else{if(Pe!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Pe);var At,wt=Le.parseCard16(),_t=Le.parseCard16();if(_t!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+_t);for(var Ft=0;Ft<wt;Ft++){if(Be=Le.parseCard8(),At=Le.parseCard16(),Ne<=Be)throw new Error("CFF table CID Font FDSelect has bad FD index value "+Be+" (FD count "+Ne+")");if(Ve<At)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+At);for(;_t<At;_t++)De.push(Be);_t=At}if(At!==Ve)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+At)}return De}(_,Z+=T,R.numGlyphs,se.length)}var Z=T+L.private[1],se=pn(_,Z,L.private[0],H.objects),Q=(R.defaultWidthX=se.defaultWidthX,R.nominalWidthX=se.nominalWidthX,se.subrs!==0?(Z=Et(_,Z+se.subrs),R.subrs=Z.objects,R.subrsBias=Pt(R.subrs)):(R.subrs=[],R.subrsBias=0),Et(_,T+L.charStrings)),se=(R.nGlyphs=Q.objects.length,function(_e,Ae,Pe,ve){var Ve=new Me.Parser(_e,Ae),Ne=(--Pe,[".notdef"]);if((_e=Ve.parseCard8())===0)for(var Be=0;Be<Pe;Be+=1)De=Ve.parseSID(),Ne.push(Wr(ve,De));else if(_e===1)for(;Ne.length<=Pe;)for(var De=Ve.parseSID(),Le=Ve.parseCard8(),St=0;St<=Le;St+=1)Ne.push(Wr(ve,De)),De+=1;else{if(_e!==2)throw new Error("Unknown charset format "+_e);for(;Ne.length<=Pe;){De=Ve.parseSID(),Le=Ve.parseCard16();for(var At=0;At<=Le;At+=1)Ne.push(Wr(ve,De)),De+=1}}return Ne}(_,T+L.charset,R.nGlyphs,H.objects));L.encoding===0?R.cffEncoding=new Ke(ee,se):L.encoding===1?R.cffEncoding=new Ke(ue,se):R.cffEncoding=function(_e,Ae,Pe){var ve={},Ve=new Me.Parser(_e,Ae);if((_e=Ve.parseCard8())===0)for(var Ne=Ve.parseCard8(),Be=0;Be<Ne;Be+=1)ve[Le=Ve.parseCard8()]=Be;else{if(_e!==1)throw new Error("Unknown encoding format "+_e);for(var De=Ve.parseCard8(),Le=1,St=0;St<De;St+=1)for(var At=Ve.parseCard8(),wt=Ve.parseCard8(),_t=At;_t<=At+wt;_t+=1)ve[_t]=Le,Le+=1}return new Ke(ve,Pe)}(_,T+L.encoding,se),R.encoding=R.encoding||R.cffEncoding,R.glyphs=new dt.GlyphSet(R);for(var fe=0;fe<R.nGlyphs;fe+=1){var he=Q.objects[fe];R.glyphs.push(fe,dt.cffGlyphLoader(R,fe,Jt,he))}},make:function(_,_e){for(var R,L=new Fe.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),H=1/_e.unitsPerEm,H={version:_e.version,fullName:_e.fullName,familyName:_e.familyName,weight:_e.weightName,fontBBox:_e.fontBBox||[0,0,0,0],fontMatrix:[H,0,0,H,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},Z=[],Q=1;Q<_.length;Q+=1)R=_.get(Q),Z.push(R.name);var se,fe,he=[],_e=(L.header=new Fe.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),L.nameIndex=function(Pe){var ve=new Fe.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);ve.names=[];for(var Ve=0;Ve<Pe.length;Ve+=1)ve.names.push({name:"name_"+Ve,type:"NAME",value:Pe[Ve]});return ve}([_e.postScriptName]),ll(H,he)),Ae=(L.topDictIndex=cl(_e),L.globalSubrIndex=new Fe.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),L.charsets=function(Pe,ve){for(var Ve=new Fe.Record("Charsets",[{name:"format",type:"Card8",value:0}]),Ne=0;Ne<Pe.length;Ne+=1){var Be=Er(Pe[Ne],ve);Ve.fields.push({name:"glyph_"+Ne,type:"SID",value:Be})}return Ve}(Z,he),L.charStringsIndex=sc(_),L.privateDict=(Ae={},se=he,(fe=new Fe.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=al(Ht,Ae,se),fe),L.stringIndex=function(Pe){var ve=new Fe.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);ve.strings=[];for(var Ve=0;Ve<Pe.length;Ve+=1)ve.strings.push({name:"string_"+Ve,type:"STRING",value:Pe[Ve]});return ve}(he),L.header.sizeOf()+L.nameIndex.sizeOf()+L.topDictIndex.sizeOf()+L.stringIndex.sizeOf()+L.globalSubrIndex.sizeOf());return H.charset=Ae,H.encoding=0,H.charStrings=H.charset+L.charsets.sizeOf(),H.private[1]=H.charStrings+L.charStringsIndex.sizeOf(),_e=ll(H,he),L.topDictIndex=cl(_e),L}},ro={parse:function(L,T){var R={},L=new Me.Parser(L,T);return R.version=L.parseVersion(),R.fontRevision=Math.round(1e3*L.parseFixed())/1e3,R.checkSumAdjustment=L.parseULong(),R.magicNumber=L.parseULong(),U.argument(R.magicNumber===1594834165,"Font header has wrong magic number."),R.flags=L.parseUShort(),R.unitsPerEm=L.parseUShort(),R.created=L.parseLongDateTime(),R.modified=L.parseLongDateTime(),R.xMin=L.parseShort(),R.yMin=L.parseShort(),R.xMax=L.parseShort(),R.yMax=L.parseShort(),R.macStyle=L.parseUShort(),R.lowestRecPPEM=L.parseUShort(),R.fontDirectionHint=L.parseShort(),R.indexToLocFormat=L.parseShort(),R.glyphDataFormat=L.parseShort(),R},make:function(_){var T=Math.round(new Date().getTime()/1e3)+2082844800,R=T;return _.createdTimestamp&&(R=_.createdTimestamp+2082844800),new Fe.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:R},{name:"modified",type:"LONGDATETIME",value:T},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],_)}},be={parse:function(L,T){var R={},L=new Me.Parser(L,T);return R.version=L.parseVersion(),R.ascender=L.parseShort(),R.descender=L.parseShort(),R.lineGap=L.parseShort(),R.advanceWidthMax=L.parseUShort(),R.minLeftSideBearing=L.parseShort(),R.minRightSideBearing=L.parseShort(),R.xMaxExtent=L.parseShort(),R.caretSlopeRise=L.parseShort(),R.caretSlopeRun=L.parseShort(),R.caretOffset=L.parseShort(),L.relativeOffset+=8,R.metricDataFormat=L.parseShort(),R.numberOfHMetrics=L.parseUShort(),R},make:function(_){return new Fe.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],_)}},Ze={parse:function(_,T,R,L,H){for(var Z,Q,se=new Me.Parser(_,T),fe=0;fe<L;fe+=1){fe<R&&(Z=se.parseUShort(),Q=se.parseShort());var he=H.get(fe);he.advanceWidth=Z,he.leftSideBearing=Q}},make:function(_){for(var T=new Fe.Table("hmtx",[]),R=0;R<_.length;R+=1){var H=_.get(R),L=H.advanceWidth||0,H=H.leftSideBearing||0;T.fields.push({name:"advanceWidth_"+R,type:"USHORT",value:L}),T.fields.push({name:"leftSideBearing_"+R,type:"SHORT",value:H})}return T}},ct={make:function(_){for(var T=new Fe.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:_.length}]),R="",L=12+4*_.length,H=0;H<_.length;++H){var Z=R.indexOf(_[H]);Z<0&&(Z=R.length,R+=_[H]),T.fields.push({name:"offset "+H,type:"USHORT",value:L+Z}),T.fields.push({name:"length "+H,type:"USHORT",value:_[H].length})}return T.fields.push({name:"stringPool",type:"CHARARRAY",value:R}),T},parse:function(_,T){for(var R=new Me.Parser(_,T),L=R.parseULong(),H=(U.argument(L===1,"Unsupported ltag table version."),R.skip("uLong",1),R.parseULong()),Z=[],Q=0;Q<H;Q++){for(var se="",fe=T+R.parseUShort(),he=R.parseUShort(),_e=fe;_e<fe+he;++_e)se+=String.fromCharCode(_.getInt8(_e));Z.push(se)}return Z}},qe={parse:function(L,T){var R={},L=new Me.Parser(L,T);return R.version=L.parseVersion(),R.numGlyphs=L.parseUShort(),R.version===1&&(R.maxPoints=L.parseUShort(),R.maxContours=L.parseUShort(),R.maxCompositePoints=L.parseUShort(),R.maxCompositeContours=L.parseUShort(),R.maxZones=L.parseUShort(),R.maxTwilightPoints=L.parseUShort(),R.maxStorage=L.parseUShort(),R.maxFunctionDefs=L.parseUShort(),R.maxInstructionDefs=L.parseUShort(),R.maxStackElements=L.parseUShort(),R.maxSizeOfInstructions=L.parseUShort(),R.maxComponentElements=L.parseUShort(),R.maxComponentDepth=L.parseUShort()),R},make:function(_){return new Fe.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:_}])}},$t=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],ze={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Wt={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},st={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},Bt="utf-16",lt={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Fr={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Ar(_,T,R){switch(_){case 0:return Bt;case 1:return Fr[R]||lt[T];case 3:if(T===1||T===10)return Bt}}function Rr(_){var T,R={};for(T in _)R[_[T]]=parseInt(T);return R}function nn(_,T,R,L,H,Z){return new Fe.Record("NameRecord",[{name:"platformID",type:"USHORT",value:_},{name:"encodingID",type:"USHORT",value:T},{name:"languageID",type:"USHORT",value:R},{name:"nameID",type:"USHORT",value:L},{name:"length",type:"USHORT",value:H},{name:"offset",type:"USHORT",value:Z}])}function mn(_,T){if((R=function(Z,Q){var se=Z.length,fe=Q.length-se+1;e:for(var he=0;he<fe;he++)for(;he<fe;he++){for(var _e=0;_e<se;_e++)if(Q[he+_e]!==Z[_e])continue e;return he}return-1}(_,T))<0)for(var R=T.length,L=0,H=_.length;L<H;++L)T.push(_[L]);return R}var no={parse:function(_,T,R){for(var L={},H=new Me.Parser(_,T),T=H.parseUShort(),Z=H.parseUShort(),Q=H.offset+H.parseUShort(),se=0;se<Z;se++){var Ve=H.parseUShort(),fe=H.parseUShort(),he=H.parseUShort(),_e=H.parseUShort(),_e=$t[_e]||_e,Ae=H.parseUShort(),Pe=H.parseUShort(),ve=function(Be,De,Le){switch(Be){case 0:if(De===65535)return"und";if(Le)return Le[De];break;case 1:return ze[De];case 3:return st[De]}}(Ve,he,R),Ve=Ar(Ve,fe,he);Ve!==void 0&&ve!==void 0&&(fe=void 0,(fe=Ve===Bt?z.UTF16(_,Q+Pe,Ae):z.MACSTRING(_,Q+Pe,Ae,Ve))&&((he=(he=L[_e])===void 0?L[_e]={}:he)[ve]=fe))}return T===1&&H.parseUShort(),L},make:function(_,T){var R,L=[],H={},Z=Rr($t);for(R in _){var Q=Z[R];if(Q===void 0&&(Q=R),Pe=parseInt(Q),isNaN(Pe))throw new Error('Name table entry "'+R+'" does not exist, see nameTableNames for complete list.');H[Pe]=_[R],L.push(Pe)}for(var se=Rr(ze),fe=Rr(st),he=[],_e=[],Ae=0;Ae<L.length;Ae++){var Pe,ve,Ve=H[Pe=L[Ae]];for(ve in Ve){var Ne=Ve[ve],At=1,Be=se[ve],De=Wt[Be],Le=Ar(At,De,Be),Le=K.MACSTRING(Ne,Le),St=(Le===void 0&&(At=0,(Be=T.indexOf(ve))<0&&(Be=T.length,T.push(ve)),De=4,Le=K.UTF16(Ne)),mn(Le,_e)),At=(he.push(nn(At,De,Be,Pe,Le.length,St)),fe[ve]);At!==void 0&&(Be=mn(De=K.UTF16(Ne),_e),he.push(nn(3,1,At,Pe,De.length,Be)))}}he.sort(function(Ft,br){return Ft.platformID-br.platformID||Ft.encodingID-br.encodingID||Ft.languageID-br.languageID||Ft.nameID-br.nameID});for(var wt=new Fe.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:he.length},{name:"stringOffset",type:"USHORT",value:6+12*he.length}]),_t=0;_t<he.length;_t++)wt.fields.push({name:"record_"+_t,type:"RECORD",value:he[_t]});return wt.fields.push({name:"strings",type:"LITERAL",value:_e}),wt}},is=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],on={parse:function(_,T){var R={},L=new Me.Parser(_,T);R.version=L.parseUShort(),R.xAvgCharWidth=L.parseShort(),R.usWeightClass=L.parseUShort(),R.usWidthClass=L.parseUShort(),R.fsType=L.parseUShort(),R.ySubscriptXSize=L.parseShort(),R.ySubscriptYSize=L.parseShort(),R.ySubscriptXOffset=L.parseShort(),R.ySubscriptYOffset=L.parseShort(),R.ySuperscriptXSize=L.parseShort(),R.ySuperscriptYSize=L.parseShort(),R.ySuperscriptXOffset=L.parseShort(),R.ySuperscriptYOffset=L.parseShort(),R.yStrikeoutSize=L.parseShort(),R.yStrikeoutPosition=L.parseShort(),R.sFamilyClass=L.parseShort(),R.panose=[];for(var H=0;H<10;H++)R.panose[H]=L.parseByte();return R.ulUnicodeRange1=L.parseULong(),R.ulUnicodeRange2=L.parseULong(),R.ulUnicodeRange3=L.parseULong(),R.ulUnicodeRange4=L.parseULong(),R.achVendID=String.fromCharCode(L.parseByte(),L.parseByte(),L.parseByte(),L.parseByte()),R.fsSelection=L.parseUShort(),R.usFirstCharIndex=L.parseUShort(),R.usLastCharIndex=L.parseUShort(),R.sTypoAscender=L.parseShort(),R.sTypoDescender=L.parseShort(),R.sTypoLineGap=L.parseShort(),R.usWinAscent=L.parseUShort(),R.usWinDescent=L.parseUShort(),1<=R.version&&(R.ulCodePageRange1=L.parseULong(),R.ulCodePageRange2=L.parseULong()),2<=R.version&&(R.sxHeight=L.parseShort(),R.sCapHeight=L.parseShort(),R.usDefaultChar=L.parseUShort(),R.usBreakChar=L.parseUShort(),R.usMaxContent=L.parseUShort()),R},make:function(_){return new Fe.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],_)},unicodeRanges:is,getUnicodeRange:function(_){for(var T=0;T<is.length;T+=1){var R=is[T];if(_>=R.begin&&_<R.end)return T}return-1}},nf={parse:function(_,T){var R={},L=new Me.Parser(_,T);switch(R.version=L.parseVersion(),R.italicAngle=L.parseFixed(),R.underlinePosition=L.parseShort(),R.underlineThickness=L.parseShort(),R.isFixedPitch=L.parseULong(),R.minMemType42=L.parseULong(),R.maxMemType42=L.parseULong(),R.minMemType1=L.parseULong(),R.maxMemType1=L.parseULong(),R.version){case 1:R.names=we.slice();break;case 2:R.numberOfGlyphs=L.parseUShort(),R.glyphNameIndex=new Array(R.numberOfGlyphs);for(var H=0;H<R.numberOfGlyphs;H++)R.glyphNameIndex[H]=L.parseUShort();R.names=[];for(var Z,Q=0;Q<R.numberOfGlyphs;Q++)R.glyphNameIndex[Q]>=we.length&&(Z=L.parseChar(),R.names.push(L.parseString(Z)));break;case 2.5:R.numberOfGlyphs=L.parseUShort(),R.offset=new Array(R.numberOfGlyphs);for(var se=0;se<R.numberOfGlyphs;se++)R.offset[se]=L.parseChar()}return R},make:function(){return new Fe.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},No=new Array(9),aa=(No[1]=function(){var _=this.offset+this.relativeOffset,T=this.parseUShort();return T===1?{substFormat:1,coverage:this.parsePointer(Ce.coverage),deltaGlyphId:this.parseUShort()}:T===2?{substFormat:2,coverage:this.parsePointer(Ce.coverage),substitute:this.parseOffset16List()}:void U.assert(!1,"0x"+_.toString(16)+": lookup type 1 format must be 1 or 2.")},No[2]=function(){var _=this.parseUShort();return U.argument(_===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:_,coverage:this.parsePointer(Ce.coverage),sequences:this.parseListOfLists()}},No[3]=function(){var _=this.parseUShort();return U.argument(_===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:_,coverage:this.parsePointer(Ce.coverage),alternateSets:this.parseListOfLists()}},No[4]=function(){var _=this.parseUShort();return U.argument(_===1,"GSUB ligature table identifier-format must be 1"),{substFormat:_,coverage:this.parsePointer(Ce.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}},{sequenceIndex:Ce.uShort,lookupListIndex:Ce.uShort});No[5]=function(){var _,T,R=this.offset+this.relativeOffset,L=this.parseUShort();return L===1?{substFormat:L,coverage:this.parsePointer(Ce.coverage),ruleSets:this.parseListOfLists(function(){var H=this.parseUShort(),Z=this.parseUShort();return{input:this.parseUShortList(H-1),lookupRecords:this.parseRecordList(Z,aa)}})}:L===2?{substFormat:L,coverage:this.parsePointer(Ce.coverage),classDef:this.parsePointer(Ce.classDef),classSets:this.parseListOfLists(function(){var H=this.parseUShort(),Z=this.parseUShort();return{classes:this.parseUShortList(H-1),lookupRecords:this.parseRecordList(Z,aa)}})}:L===3?(_=this.parseUShort(),T=this.parseUShort(),{substFormat:L,coverages:this.parseList(_,Ce.pointer(Ce.coverage)),lookupRecords:this.parseRecordList(T,aa)}):void U.assert(!1,"0x"+R.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},No[6]=function(){var _=this.offset+this.relativeOffset,T=this.parseUShort();return T===1?{substFormat:1,coverage:this.parsePointer(Ce.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(aa)}})}:T===2?{substFormat:2,coverage:this.parsePointer(Ce.coverage),backtrackClassDef:this.parsePointer(Ce.classDef),inputClassDef:this.parsePointer(Ce.classDef),lookaheadClassDef:this.parsePointer(Ce.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(aa)}})}:T===3?{substFormat:3,backtrackCoverage:this.parseList(Ce.pointer(Ce.coverage)),inputCoverage:this.parseList(Ce.pointer(Ce.coverage)),lookaheadCoverage:this.parseList(Ce.pointer(Ce.coverage)),lookupRecords:this.parseRecordList(aa)}:void U.assert(!1,"0x"+_.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},No[7]=function(){var _=this.parseUShort(),_=(U.argument(_===1,"GSUB Extension Substitution subtable identifier-format must be 1"),this.parseUShort()),T=new Ce(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:_,extension:No[_].call(T)}},No[8]=function(){var _=this.parseUShort();return U.argument(_===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:_,coverage:this.parsePointer(Ce.coverage),backtrackCoverage:this.parseList(Ce.pointer(Ce.coverage)),lookaheadCoverage:this.parseList(Ce.pointer(Ce.coverage)),substitutes:this.parseUShortList()}};var Si=new Array(9);Si[1]=function(_){return _.substFormat===1?new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(_.coverage)},{name:"deltaGlyphID",type:"USHORT",value:_.deltaGlyphId}]):new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Fe.Coverage(_.coverage)}].concat(Fe.ushortList("substitute",_.substitute)))},Si[3]=function(_){return U.assert(_.substFormat===1,"Lookup type 3 substFormat must be 1."),new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(_.coverage)}].concat(Fe.tableList("altSet",_.alternateSets,function(T){return new Fe.Table("alternateSetTable",Fe.ushortList("alternate",T))})))},Si[4]=function(_){return U.assert(_.substFormat===1,"Lookup type 4 substFormat must be 1."),new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(_.coverage)}].concat(Fe.tableList("ligSet",_.ligatureSets,function(T){return new Fe.Table("ligatureSetTable",Fe.tableList("ligature",T,function(R){return new Fe.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:R.ligGlyph}].concat(Fe.ushortList("component",R.components,R.components.length+1)))}))})))};var of={parse:function(_,T){return T=(_=new Ce(_,T=T||0)).parseVersion(1),U.argument(T===1||T===1.1,"Unsupported GSUB table version."),T===1?{version:T,scripts:_.parseScriptList(),features:_.parseFeatureList(),lookups:_.parseLookupList(No)}:{version:T,scripts:_.parseScriptList(),features:_.parseFeatureList(),lookups:_.parseLookupList(No),variations:_.parseFeatureVariationsList()}},make:function(_){return new Fe.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Fe.ScriptList(_.scripts)},{name:"features",type:"TABLE",value:new Fe.FeatureList(_.features)},{name:"lookups",type:"TABLE",value:new Fe.LookupList(_.lookups,Si)}])}},la={parse:function(_,T){for(var R=new Me.Parser(_,T),L=R.parseULong(),H=(U.argument(L===1,"Unsupported META table version."),R.parseULong(),R.parseULong(),R.parseULong()),Z={},Q=0;Q<H;Q++){var se=R.parseTag(),he=R.parseULong(),fe=R.parseULong(),he=z.UTF8(_,T+he,fe);Z[se]=he}return Z},make:function(_){var T,R=Object.keys(_).length,L="",H=16+12*R,Z=new Fe.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:H},{name:"numTags",type:"ULONG",value:R}]);for(T in _){var Q=L.length;L+=_[T],Z.fields.push({name:"tag "+T,type:"TAG",value:T}),Z.fields.push({name:"offset "+T,type:"ULONG",value:H+Q}),Z.fields.push({name:"length "+T,type:"ULONG",value:_[T].length})}return Z.fields.push({name:"stringPool",type:"CHARARRAY",value:L}),Z}};function zu(_){return Math.log(_)/Math.log(2)|0}function ic(_){for(;_.length%4!=0;)_.push(0);for(var T=0,R=0;R<_.length;R+=4)T+=(_[R]<<24)+(_[R+1]<<16)+(_[R+2]<<8)+_[R+3];return T%=Math.pow(2,32)}function sf(_,T,R,L){return new Fe.Record("Table Record",[{name:"tag",type:"TAG",value:_!==void 0?_:""},{name:"checkSum",type:"ULONG",value:T!==void 0?T:0},{name:"offset",type:"ULONG",value:R!==void 0?R:0},{name:"length",type:"ULONG",value:L!==void 0?L:0}])}function af(_){for(var T=new Fe.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),R=(T.tables=_,T.numTables=_.length,Math.pow(2,zu(T.numTables))),L=(T.searchRange=16*R,T.entrySelector=zu(R),T.rangeShift=16*T.numTables-T.searchRange,[]),H=[],Z=T.sizeOf()+sf().sizeOf()*T.numTables;Z%4!=0;)Z+=1,H.push({name:"padding",type:"BYTE",value:0});for(var Q=0;Q<_.length;Q+=1){var se=_[Q],fe=(U.argument(se.tableName.length===4,"Table name"+se.tableName+" is invalid."),se.sizeOf()),he=sf(se.tableName,ic(se.encode()),Z,fe);for(L.push({name:he.tag+" Table Record",type:"RECORD",value:he}),H.push({name:se.tableName+" table",type:"RECORD",value:se}),Z+=fe,U.argument(!isNaN(Z),"Something went wrong calculating the offset.");Z%4!=0;)Z+=1,H.push({name:"padding",type:"BYTE",value:0})}return L.sort(function(_e,Ae){return _e.value.tag>Ae.value.tag?1:-1}),T.fields=T.fields.concat(L),T.fields=T.fields.concat(H),T}function lf(_,T,R){for(var L=0;L<T.length;L+=1){var H=_.charToGlyphIndex(T[L]);if(0<H)return _.glyphs.get(H).getMetrics()}return R}var Ny={make:af,fontToTable:function(_){for(var T,R=[],L=[],H=[],Z=[],Q=[],se=[],fe=[],he=0,_e=0,Ae=0,Pe=0,ve=0,Ve=0;Ve<_.glyphs.length;Ve+=1){var Ne=_.glyphs.get(Ve),Be=0|Ne.unicode;if(isNaN(Ne.advanceWidth))throw new Error("Glyph "+Ne.name+" ("+Ve+"): advanceWidth is not a number.");(Be<T||T===void 0)&&0<Be&&(T=Be),he<Be&&(he=Be);var Be=on.getUnicodeRange(Be);if(Be<32)_e|=1<<Be;else if(Be<64)Ae|=1<<Be-32;else if(Be<96)Pe|=1<<Be-64;else{if(!(Be<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");ve|=1<<Be-96}Ne.name!==".notdef"&&(Be=Ne.getMetrics(),R.push(Be.xMin),L.push(Be.yMin),H.push(Be.xMax),Z.push(Be.yMax),se.push(Be.leftSideBearing),fe.push(Be.rightSideBearing),Q.push(Ne.advanceWidth))}var De,Le={xMin:Math.min.apply(null,R),yMin:Math.min.apply(null,L),xMax:Math.max.apply(null,H),yMax:Math.max.apply(null,Z),advanceWidthMax:Math.max.apply(null,Q),advanceWidthAvg:function(xn){for(var Xu=0,cc=0;cc<xn.length;cc+=1)Xu+=xn[cc];return Xu/xn.length}(Q),minLeftSideBearing:Math.min.apply(null,se),maxLeftSideBearing:Math.max.apply(null,se),minRightSideBearing:Math.min.apply(null,fe)},St=(Le.ascender=_.ascender,Le.descender=_.descender,ro.make({flags:3,unitsPerEm:_.unitsPerEm,xMin:Le.xMin,yMin:Le.yMin,xMax:Le.xMax,yMax:Le.yMax,lowestRecPPEM:3,createdTimestamp:_.createdTimestamp})),At=be.make({ascender:Le.ascender,descender:Le.descender,advanceWidthMax:Le.advanceWidthMax,minLeftSideBearing:Le.minLeftSideBearing,minRightSideBearing:Le.minRightSideBearing,xMaxExtent:Le.maxLeftSideBearing+(Le.xMax-Le.xMin),numberOfHMetrics:_.glyphs.length}),wt=qe.make(_.glyphs.length),_t=on.make({xAvgCharWidth:Math.round(Le.advanceWidthAvg),usWeightClass:_.tables.os2.usWeightClass,usWidthClass:_.tables.os2.usWidthClass,usFirstCharIndex:T,usLastCharIndex:he,ulUnicodeRange1:_e,ulUnicodeRange2:Ae,ulUnicodeRange3:Pe,ulUnicodeRange4:ve,fsSelection:_.tables.os2.fsSelection,sTypoAscender:Le.ascender,sTypoDescender:Le.descender,sTypoLineGap:0,usWinAscent:Le.yMax,usWinDescent:Math.abs(Le.yMin),ulCodePageRange1:1,sxHeight:lf(_,"xyvw",{yMax:Math.round(Le.ascender/2)}).yMax,sCapHeight:lf(_,"HIKLEFJMNTZBDPRAGOQSUVWXY",Le).yMax,usDefaultChar:_.hasChar(" ")?32:0,usBreakChar:_.hasChar(" ")?32:0}),Ft=Ze.make(_.glyphs),br=re.make(_.glyphs),Pr=_.getEnglishName("fontFamily"),ir=_.getEnglishName("fontSubfamily"),yr=Pr+" "+ir,Yr=(Yr=_.getEnglishName("postScriptName"))||Pr.replace(/\s/g,"")+"-"+ir,ln={};for(De in _.names)ln[De]=_.names[De];ln.uniqueID||(ln.uniqueID={en:_.getEnglishName("manufacturer")+":"+yr}),ln.postScriptName||(ln.postScriptName={en:Yr}),ln.preferredFamily||(ln.preferredFamily=_.names.fontFamily),ln.preferredSubfamily||(ln.preferredSubfamily=_.names.fontSubfamily);var $n=[],Nn=no.make(ln,$n),$n=0<$n.length?ct.make($n):void 0,Cs=nf.make(),yr=ul.make(_.glyphs,{version:_.getEnglishName("version"),fullName:yr,familyName:Pr,weightName:ir,postScriptName:Yr,unitsPerEm:_.unitsPerEm,fontBBox:[0,Le.yMin,Le.ascender,Le.advanceWidthMax]}),Pr=_.metas&&0<Object.keys(_.metas).length?la.make(_.metas):void 0,ir=[St,At,wt,_t,Nn,br,Cs,yr,Ft];$n&&ir.push($n),_.tables.gsub&&ir.push(of.make(_.tables.gsub)),Pr&&ir.push(Pr);for(var Un=ic((Yr=af(ir)).encode()),Nr=Yr.fields,Pn=!1,Tr=0;Tr<Nr.length;Tr+=1)if(Nr[Tr].name==="head table"){Nr[Tr].value.checkSumAdjustment=2981146554-Un,Pn=!0;break}if(Pn)return Yr;throw new Error("Could not find head table with checkSum to adjust.")},computeCheckSum:ic};function ac(_,T){for(var R=0,L=_.length-1;R<=L;){var H=R+L>>>1,Z=_[H].tag;if(Z===T)return H;Z<T?R=1+H:L=H-1}return-R-1}function cf(_,T){for(var R=0,L=_.length-1;R<=L;){var H=R+L>>>1,Z=_[H];if(Z===T)return H;Z<T?R=1+H:L=H-1}return-R-1}function uf(_,T){for(var R=0,L=_.length-1;R<=L;){var H,Z=R+L>>>1,Q=(H=_[Z]).start;if(Q===T)return H;Q<T?R=1+Z:L=Z-1}if(0<R)return T>(H=_[R-1]).end?0:H}function dl(_,T){this.font=_,this.tableName=T}function wi(_){dl.call(this,_,"gpos")}function Cn(_){dl.call(this,_,"gsub")}function df(_,T,R){for(var L=_.subtables,H=0;H<L.length;H++){var Z=L[H];if(Z.substFormat===T)return Z}if(R)return L.push(R),R}function hf(_){for(var T=new ArrayBuffer(_.length),R=new Uint8Array(T),L=0;L<_.length;++L)R[L]=_[L];return T}function oo(_,T){if(!_)throw T}function ff(_,T,R,L,H){var Z=0<(T&L)?(Z=_.parseByte(),R+(Z=T&H?Z:-Z)):0<(T&H)?R:R+_.parseShort();return Z}function $y(_,T,R){var L,H=new Me.Parser(T,R);if(_.numberOfContours=H.parseShort(),_._xMin=H.parseShort(),_._yMin=H.parseShort(),_._xMax=H.parseShort(),_._yMax=H.parseShort(),0<_.numberOfContours){for(var Z=_.endPointIndices=[],Q=0;Q<_.numberOfContours;Q+=1)Z.push(H.parseUShort());_.instructionLength=H.parseUShort(),_.instructions=[];for(var se=0;se<_.instructionLength;se+=1)_.instructions.push(H.parseByte());for(var fe=Z[Z.length-1]+1,he=[],_e=0;_e<fe;_e+=1)if(L=H.parseByte(),he.push(L),0<(8&L))for(var Ae=H.parseByte(),Pe=0;Pe<Ae;Pe+=1)he.push(L),_e+=1;if(U.argument(he.length===fe,"Bad flags."),0<Z.length){var ve,Ve=[];if(0<fe){for(var Ne=0;Ne<fe;Ne+=1)L=he[Ne],(ve={}).onCurve=!!(1&L),ve.lastPointOfContour=0<=Z.indexOf(Ne),Ve.push(ve);for(var Be=0,De=0;De<fe;De+=1)L=he[De],(ve=Ve[De]).x=ff(H,L,Be,2,16),Be=ve.x;for(var Le=0,St=0;St<fe;St+=1)L=he[St],(ve=Ve[St]).y=ff(H,L,Le,4,32),Le=ve.y}_.points=Ve}else _.points=[]}else if(_.numberOfContours===0)_.points=[];else{_.isComposite=!0,_.points=[],_.components=[];for(var At=!0;At;){he=H.parseUShort();var wt={glyphIndex:H.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&he)?0<(2&he)?(wt.dx=H.parseShort(),wt.dy=H.parseShort()):wt.matchedPoints=[H.parseUShort(),H.parseUShort()]:0<(2&he)?(wt.dx=H.parseChar(),wt.dy=H.parseChar()):wt.matchedPoints=[H.parseByte(),H.parseByte()],0<(8&he)?wt.xScale=wt.yScale=H.parseF2Dot14():0<(64&he)?(wt.xScale=H.parseF2Dot14(),wt.yScale=H.parseF2Dot14()):0<(128&he)&&(wt.xScale=H.parseF2Dot14(),wt.scale01=H.parseF2Dot14(),wt.scale10=H.parseF2Dot14(),wt.yScale=H.parseF2Dot14()),_.components.push(wt),At=!!(32&he)}if(256&he){_.instructionLength=H.parseUShort(),_.instructions=[];for(var _t=0;_t<_.instructionLength;_t+=1)_.instructions.push(H.parseByte())}}}function Gu(_,T){for(var R=[],L=0;L<_.length;L+=1){var H=_[L],H={x:T.xScale*H.x+T.scale01*H.y+T.dx,y:T.scale10*H.x+T.yScale*H.y+T.dy,onCurve:H.onCurve,lastPointOfContour:H.lastPointOfContour};R.push(H)}return R}function pf(_){var T=new J;if(_)for(var R=function(Ae){for(var Pe=[],ve=[],Ve=0;Ve<Ae.length;Ve+=1){var Ne=Ae[Ve];ve.push(Ne),Ne.lastPointOfContour&&(Pe.push(ve),ve=[])}return U.argument(ve.length===0,"There are still points left in the current contour."),Pe}(_),L=0;L<R.length;++L){var H,Z=R[L],Q=Z[Z.length-1],se=Z[0];Q.onCurve?T.moveTo(Q.x,Q.y):se.onCurve?T.moveTo(se.x,se.y):(H={x:.5*(Q.x+se.x),y:.5*(Q.y+se.y)},T.moveTo(H.x,H.y));for(var fe=0;fe<Z.length;++fe){var he,_e=Q,Q=se,se=Z[(fe+1)%Z.length];Q.onCurve?T.lineTo(Q.x,Q.y):(he=se,_e.onCurve||(Q.x,_e.x,Q.y,_e.y),se.onCurve||(he={x:.5*(Q.x+se.x),y:.5*(Q.y+se.y)}),T.quadraticCurveTo(Q.x,Q.y,he.x,he.y))}T.closePath()}return T}function Uy(_,T){if(T.isComposite)for(var R=0;R<T.components.length;R+=1){var L=T.components[R],H=_.get(L.glyphIndex);if(H.getPath(),H.points){var Z=void 0;if(L.matchedPoints===void 0)Z=Gu(H.points,L);else{if(L.matchedPoints[0]>T.points.length-1||L.matchedPoints[1]>H.points.length-1)throw Error("Matched points out of range in "+T.name);var Q=T.points[L.matchedPoints[0]],se=H.points[L.matchedPoints[1]],L={xScale:L.xScale,scale01:L.scale01,scale10:L.scale10,yScale:L.yScale,dx:0,dy:0},se=Gu([se],L)[0];L.dx=Q.x-se.x,L.dy=Q.y-se.y,Z=Gu(H.points,L)}T.points=T.points.concat(Z)}}return pf(T.points)}(wi.prototype=dl.prototype={searchTag:ac,binSearch:cf,getTable:function(_){var T=this.font.tables[this.tableName];return T=!T&&_?this.font.tables[this.tableName]=this.createDefaultTable():T},getScriptNames:function(){var _=this.getTable();return _?_.scripts.map(function(T){return T.tag}):[]},getDefaultScriptName:function(){var _=this.getTable();if(_){for(var T=!1,R=0;R<_.scripts.length;R++){var L=_.scripts[R].tag;if(L==="DFLT")return L;L==="latn"&&(T=!0)}return T?"latn":void 0}},getScriptTable:function(_,T){var R,L=this.getTable(T);if(L)return R=L.scripts,0<=(L=ac(L.scripts,_=_||"DFLT"))?R[L].script:T?(R.splice(-1-L,0,T={tag:_,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}),T.script):void 0},getLangSysTable:function(H,T,R){var L,H=this.getScriptTable(H,R);if(H)return T&&T!=="dflt"&&T!=="DFLT"?0<=(L=ac(H.langSysRecords,T))?H.langSysRecords[L].langSys:R?(H.langSysRecords.splice(-1-L,0,R={tag:T,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}}),R.langSys):void 0:H.defaultLangSys},getFeatureTable:function(_,T,R,L){if(_=this.getLangSysTable(_,T,L),_){for(var H,Z=_.featureIndexes,Q=this.font.tables[this.tableName].features,se=0;se<Z.length;se++)if((H=Q[Z[se]]).tag===R)return H.feature;if(L)return T=Q.length,U.assert(T===0||R>=Q[T-1].tag,"Features must be added in alphabetical order."),Q.push(H={tag:R,feature:{params:0,lookupListIndexes:[]}}),Z.push(T),H.feature}},getLookupTables:function(Z,T,R,L,H){var Z=this.getFeatureTable(Z,T,R,H),Q=[];if(Z){for(var se,fe=Z.lookupListIndexes,he=this.font.tables[this.tableName].lookups,_e=0;_e<fe.length;_e++)(se=he[fe[_e]]).lookupType===L&&Q.push(se);if(Q.length===0&&H)return T=he.length,he.push(se={lookupType:L,lookupFlag:0,subtables:[],markFilteringSet:void 0}),fe.push(T),[se]}return Q},getGlyphClass:function(_,T){switch(_.format){case 1:return _.startGlyph<=T&&T<_.startGlyph+_.classes.length?_.classes[T-_.startGlyph]:0;case 2:var R=uf(_.ranges,T);return R?R.classId:0}},getCoverageIndex:function(_,T){switch(_.format){case 1:var R=cf(_.glyphs,T);return 0<=R?R:-1;case 2:return R=uf(_.ranges,T),R?R.index+T-R.start:-1}},expandCoverage:function(_){if(_.format===1)return _.glyphs;for(var T=[],R=_.ranges,L=0;L<R.length;L++)for(var H=R[L],Z=H.start,Q=H.end,se=Z;se<=Q;se++)T.push(se);return T}}).init=function(){var _=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(_)},wi.prototype.getKerningValue=function(_,T,R){for(var L=0;L<_.length;L++)for(var H=_[L].subtables,Z=0;Z<H.length;Z++){var Q=H[Z],se=this.getCoverageIndex(Q.coverage,T);if(!(se<0))switch(Q.posFormat){case 1:for(var fe=Q.pairSets[se],he=0;he<fe.length;he++){var _e=fe[he];if(_e.secondGlyph===R)return _e.value1&&_e.value1.xAdvance||0}break;case 2:var Pe=this.getGlyphClass(Q.classDef1,T),Ae=this.getGlyphClass(Q.classDef2,R),Pe=Q.classRecords[Pe][Ae];return Pe.value1&&Pe.value1.xAdvance||0}}return 0},wi.prototype.getKerningTables=function(_,T){if(this.font.tables.gpos)return this.getLookupTables(_,T,"kern",2)},(Cn.prototype=dl.prototype).createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Cn.prototype.getSingle=function(_,T,R){for(var L=[],H=this.getLookupTables(T,R,_,1),Z=0;Z<H.length;Z++)for(var Q=H[Z].subtables,se=0;se<Q.length;se++){var fe=Q[se],he=this.expandCoverage(fe.coverage),_e=void 0;if(fe.substFormat===1)for(var Ae=fe.deltaGlyphId,_e=0;_e<he.length;_e++){var Pe=he[_e];L.push({sub:Pe,by:Pe+Ae})}else{var ve=fe.substitute;for(_e=0;_e<he.length;_e++)L.push({sub:he[_e],by:ve[_e]})}}return L},Cn.prototype.getAlternates=function(_,T,R){for(var L=[],H=this.getLookupTables(T,R,_,3),Z=0;Z<H.length;Z++)for(var Q=H[Z].subtables,se=0;se<Q.length;se++)for(var fe=Q[se],he=this.expandCoverage(fe.coverage),_e=fe.alternateSets,Ae=0;Ae<he.length;Ae++)L.push({sub:he[Ae],by:_e[Ae]});return L},Cn.prototype.getLigatures=function(_,T,R){for(var L=[],H=this.getLookupTables(T,R,_,4),Z=0;Z<H.length;Z++)for(var Q=H[Z].subtables,se=0;se<Q.length;se++)for(var fe=Q[se],he=this.expandCoverage(fe.coverage),_e=fe.ligatureSets,Ae=0;Ae<he.length;Ae++)for(var Pe=he[Ae],ve=_e[Ae],Ve=0;Ve<ve.length;Ve++){var Ne=ve[Ve];L.push({sub:[Pe].concat(Ne.components),by:Ne.ligGlyph})}return L},Cn.prototype.addSingle=function(_,T,R,L){R=df(this.getLookupTables(R,L,_,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]}),U.assert(R.coverage.format===1,"Ligature: unable to modify coverage table format "+R.coverage.format),L=T.sub,_=this.binSearch(R.coverage.glyphs,L),_<0&&(R.coverage.glyphs.splice(_=-1-_,0,L),R.substitute.splice(_,0,0)),R.substitute[_]=T.by},Cn.prototype.addAlternate=function(_,T,R,L){R=df(this.getLookupTables(R,L,_,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]}),U.assert(R.coverage.format===1,"Ligature: unable to modify coverage table format "+R.coverage.format),L=T.sub,_=this.binSearch(R.coverage.glyphs,L),_<0&&(R.coverage.glyphs.splice(_=-1-_,0,L),R.alternateSets.splice(_,0,0)),R.alternateSets[_]=T.by},Cn.prototype.addLigature=function(Z,fe,se,H){var se=this.getLookupTables(se,H,Z,4,!0)[0],H=se.subtables[0],Z=(H||(se.subtables[0]=H={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),U.assert(H.coverage.format===1,"Ligature: unable to modify coverage table format "+H.coverage.format),fe.sub[0]),Q=fe.sub.slice(1),se={ligGlyph:fe.by,components:Q},fe=this.binSearch(H.coverage.glyphs,Z);if(0<=fe){for(var he=H.ligatureSets[fe],_e=0;_e<he.length;_e++)if(function(Ae,Pe){var ve=Ae.length;if(ve===Pe.length){for(var Ve=0;Ve<ve;Ve++)if(Ae[Ve]!==Pe[Ve])return;return 1}}(he[_e].components,Q))return;he.push(se)}else H.coverage.glyphs.splice(fe=-1-fe,0,Z),H.ligatureSets.splice(fe,0,[se])},Cn.prototype.getFeature=function(_,T,R){if(/ss\d\d/.test(_))return this.getSingle(_,T,R);switch(_){case"aalt":case"salt":return this.getSingle(_,T,R).concat(this.getAlternates(_,T,R));case"dlig":case"liga":case"rlig":return this.getLigatures(_,T,R)}},Cn.prototype.add=function(_,T,R,L){if(/ss\d\d/.test(_))return this.addSingle(_,T,R,L);switch(_){case"aalt":case"salt":return typeof T.by=="number"?this.addSingle(_,T,R,L):this.addAlternate(_,T,R,L);case"dlig":case"liga":case"rlig":return this.addLigature(_,T,R,L)}};var Ys={getPath:pf,parse:function(_,T,R,L){for(var H=new dt.GlyphSet(L),Z=0;Z<R.length-1;Z+=1){var Q=R[Z];Q!==R[Z+1]?H.push(Z,dt.ttfGlyphLoader(L,Z,$y,_,T+Q,Uy)):H.push(Z,dt.glyphLoader(L,Z))}return H}};function Vu(_){this.font=_,this.getCommands=function(T){return Ys.getPath(T).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function By(_){return _}function hl(_){return Math.sign(_)*Math.round(Math.abs(_))}function zy(_){return Math.sign(_)*Math.round(Math.abs(2*_))/2}function Hu(_){return Math.sign(_)*(Math.round(Math.abs(_)+.5)-.5)}function Gy(_){return Math.sign(_)*Math.ceil(Math.abs(_))}function mf(_){return Math.sign(_)*Math.floor(Math.abs(_))}function Wu(_){var T=this.srPeriod,R=this.srPhase,L=1;return _<0&&(_=-_,L=-1),_+=this.srThreshold-R,_=Math.trunc(_/T)*T,(_+=R)<0?R*L:_*L}var $o={x:1,y:0,axis:"x",distance:function(_,T,R,L){return(R?_.xo:_.x)-(L?T.xo:T.x)},interpolate:function(_,T,R,L){var H,Z,Q,se,fe,he,_e;if(!L||L===this)return H=_.xo-T.xo,Z=_.xo-R.xo,fe=T.x-T.xo,he=R.x-R.xo,(_e=(Q=Math.abs(H))+(se=Math.abs(Z)))===0?void(_.x=_.xo+(fe+he)/2):void(_.x=_.xo+(fe*se+he*Q)/_e);H=L.distance(_,T,!0,!0),Z=L.distance(_,R,!0,!0),fe=L.distance(T,T,!1,!0),he=L.distance(R,R,!1,!0),(_e=(Q=Math.abs(H))+(se=Math.abs(Z)))===0?$o.setRelative(_,_,(fe+he)/2,L,!0):$o.setRelative(_,_,(fe*se+he*Q)/_e,L,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(_,T,R,L,H){var Z,Q;L&&L!==this?(Z=H?T.xo:T.x,Q=H?T.yo:T.y,Z+=R*L.x,Q+=R*L.y,_.x=Z+(_.y-Q)/L.normalSlope):_.x=(H?T.xo:T.x)+R},slope:0,touch:function(_){_.xTouched=!0},touched:function(_){return _.xTouched},untouch:function(_){_.xTouched=!1}},so={x:0,y:1,axis:"y",distance:function(_,T,R,L){return(R?_.yo:_.y)-(L?T.yo:T.y)},interpolate:function(_,T,R,L){var H,Z,Q,se,fe,he,_e;if(!L||L===this)return H=_.yo-T.yo,Z=_.yo-R.yo,fe=T.y-T.yo,he=R.y-R.yo,(_e=(Q=Math.abs(H))+(se=Math.abs(Z)))===0?void(_.y=_.yo+(fe+he)/2):void(_.y=_.yo+(fe*se+he*Q)/_e);H=L.distance(_,T,!0,!0),Z=L.distance(_,R,!0,!0),fe=L.distance(T,T,!1,!0),he=L.distance(R,R,!1,!0),(_e=(Q=Math.abs(H))+(se=Math.abs(Z)))===0?so.setRelative(_,_,(fe+he)/2,L,!0):so.setRelative(_,_,(fe*se+he*Q)/_e,L,!0)},normalSlope:0,setRelative:function(_,T,R,L,H){var Z,Q;L&&L!==this?(Z=H?T.xo:T.x,Q=H?T.yo:T.y,Z+=R*L.x,Q+=R*L.y,_.y=Q+L.normalSlope*(_.x-Z)):_.y=(H?T.yo:T.y)+R},slope:Number.POSITIVE_INFINITY,touch:function(_){_.yTouched=!0},touched:function(_){return _.yTouched},untouch:function(_){_.yTouched=!1}};function ca(_,T){this.x=_,this.y=T,this.axis=void 0,this.slope=T/_,this.normalSlope=-_/T,Object.freeze(this)}function fl(_,T){var R=Math.sqrt(_*_+T*T);return T/=R,(_/=R)===1&&T===0?$o:_===0&&T===1?so:new ca(_,T)}function _s(_,T,R,L){this.x=this.xo=Math.round(64*_)/64,this.y=this.yo=Math.round(64*T)/64,this.lastPointOfContour=R,this.onCurve=L,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze($o),Object.freeze(so),ca.prototype.distance=function(_,T,R,L){return this.x*$o.distance(_,T,R,L)+this.y*so.distance(_,T,R,L)},ca.prototype.interpolate=function(_,H,Z,L){var Q=L.distance(_,H,!0,!0),se=L.distance(_,Z,!0,!0),H=L.distance(H,H,!1,!0),Z=L.distance(Z,Z,!1,!0),Q=Math.abs(Q),se=Math.abs(se),fe=Q+se;fe===0?this.setRelative(_,_,(H+Z)/2,L,!0):this.setRelative(_,_,(H*se+Z*Q)/fe,L,!0)},ca.prototype.setRelative=function(_,Z,fe,he,se){var Q=se?Z.xo:Z.x,se=se?Z.yo:Z.y,Z=Q+fe*(he=he||this).x,Q=se+fe*he.y,se=he.normalSlope,fe=this.slope,he=_.x,_e=_.y;_.x=(fe*he-se*Z+Q-_e)/(fe-se),_.y=fe*(_.x-he)+_e},ca.prototype.touch=function(_){_.xTouched=!0,_.yTouched=!0},_s.prototype.nextTouched=function(_){for(var T=this.nextPointOnContour;!_.touched(T)&&T!==this;)T=T.nextPointOnContour;return T},_s.prototype.prevTouched=function(_){for(var T=this.prevPointOnContour;!_.touched(T)&&T!==this;)T=T.prevPointOnContour;return T};var pl=Object.freeze(new _s(0,0)),ye={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Ie(_,T){switch(this.env=_,this.stack=[],this.prog=T,_){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=$o,this.round=hl}}function Ye(_){for(var T=_.tZone=new Array(_.gZone.length),R=0;R<T.length;R++)T[R]=new _s(0,0)}function ht(_,T){var R,L=_.prog,H=_.ip,Z=1;do if((R=L[++H])===88)Z++;else if(R===89)Z--;else if(R===64)H+=L[H+1]+1;else if(R===65)H+=2*L[H+1]+1;else if(176<=R&&R<=183)H+=R-176+1;else if(184<=R&&R<=191)H+=2*(R-184+1);else if(T&&Z===1&&R===27)break;while(0<Z);_.ip=H}function cr(_,T){u.DEBUG&&console.log(T.step,"SVTCA["+_.axis+"]"),T.fv=T.pv=T.dpv=_}function Dt(_,T){u.DEBUG&&console.log(T.step,"SPVTCA["+_.axis+"]"),T.pv=T.dpv=_}function Cr(_,T){u.DEBUG&&console.log(T.step,"SFVTCA["+_.axis+"]"),T.fv=_}function Qr(_,T){var R,H=T.stack,L=H.pop(),H=H.pop(),Z=T.z2[L],Q=T.z1[H];u.DEBUG&&console.log("SPVTL["+_+"]",L,H),L=_?(R=Z.y-Q.y,Q.x-Z.x):(R=Q.x-Z.x,Q.y-Z.y),T.pv=T.dpv=fl(R,L)}function sn(_,T){var R,H=T.stack,L=H.pop(),H=H.pop(),Z=T.z2[L],Q=T.z1[H];u.DEBUG&&console.log("SFVTL["+_+"]",L,H),L=_?(R=Z.y-Q.y,Q.x-Z.x):(R=Q.x-Z.x,Q.y-Z.y),T.fv=fl(R,L)}function mr(_){u.DEBUG&&console.log(_.step,"POP[]"),_.stack.pop()}function Fn(_,T){var R=T.stack.pop(),L=T.z0[R],H=T.fv,Z=T.pv,Q=(u.DEBUG&&console.log(T.step,"MDAP["+_+"]",R),Z.distance(L,pl));_&&(Q=T.round(Q)),H.setRelative(L,pl,Q,Z),H.touch(L),T.rp0=T.rp1=R}function wo(_,T){var R,L,H,Z=T.z2,Q=Z.length-2;u.DEBUG&&console.log(T.step,"IUP["+_.axis+"]");for(var se=0;se<Q;se++)R=Z[se],_.touched(R)||(L=R.prevTouched(_))!==R&&(L===(H=R.nextTouched(_))&&_.setRelative(R,R,_.distance(L,L,!1,!0),_,!0),_.interpolate(R,L,H,_))}function gn(_,T){for(var R=T.stack,L=_?T.rp1:T.rp2,H=(_?T.z0:T.z1)[L],Z=T.fv,Q=T.pv,se=T.loop,fe=T.z2;se--;){var he=R.pop(),_e=fe[he],Ae=Q.distance(H,H,!1,!0);Z.setRelative(_e,_e,Ae,Q),Z.touch(_e),u.DEBUG&&console.log(T.step,(1<T.loop?"loop "+(T.loop-se)+": ":"")+"SHP["+(_?"rp1":"rp2")+"]",he)}T.loop=1}function io(_,T){for(var R=T.stack,Q=_?T.rp1:T.rp2,L=(_?T.z0:T.z1)[Q],H=T.fv,Z=T.pv,Q=R.pop(),se=T.z2[T.contours[Q]],fe=se,he=(u.DEBUG&&console.log(T.step,"SHC["+_+"]",Q),Z.distance(L,L,!1,!0));fe!==L&&H.setRelative(fe,fe,he,Z),(fe=fe.nextPointOnContour)!==se;);}function ao(_,T){var R,L,se=T.stack,H=_?T.rp1:T.rp2,H=(_?T.z0:T.z1)[H],Z=T.fv,Q=T.pv,se=se.pop();switch(u.DEBUG&&console.log(T.step,"SHZ["+_+"]",se),se){case 0:R=T.tZone;break;case 1:R=T.gZone;break;default:throw new Error("Invalid zone")}for(var fe=Q.distance(H,H,!1,!0),he=R.length-2,_e=0;_e<he;_e++)L=R[_e],Z.setRelative(L,L,fe,Q)}function js(_,T){var L=T.stack,R=L.pop()/64,L=L.pop(),H=T.z1[L],Z=T.z0[T.rp0],Q=T.fv,se=T.pv;Q.setRelative(H,Z,R,se),Q.touch(H),u.DEBUG&&console.log(T.step,"MSIRP["+_+"]",R,L),T.rp1=T.rp0,T.rp2=L,_&&(T.rp0=L)}function as(_,T){var R=T.stack,se=R.pop(),R=R.pop(),L=T.z0[R],H=T.fv,Z=T.pv,Q=T.cvt[se],se=(u.DEBUG&&console.log(T.step,"MIAP["+_+"]",se,"(",Q,")",R),Z.distance(L,pl));_&&(Math.abs(se-Q)<T.cvCutIn&&(se=Q),se=T.round(se)),H.setRelative(L,pl,se,Z),T.zp0===0&&(L.xo=L.x,L.yo=L.y),H.touch(L),T.rp0=T.rp1=R}function Xs(_,T){var R=T.stack,L=R.pop(),H=T.z2[L];u.DEBUG&&console.log(T.step,"GC["+_+"]",L),R.push(64*T.dpv.distance(H,pl,_,!1))}function Yu(_,T){var L=T.stack,R=L.pop(),L=L.pop(),H=T.z1[R],Z=T.z0[L],Z=T.dpv.distance(Z,H,_,_);u.DEBUG&&console.log(T.step,"MD["+_+"]",R,L,"->",Z),T.stack.push(Math.round(64*Z))}function ua(_,T){var R=T.stack,L=R.pop(),H=T.fv,Z=T.pv,Q=T.ppem,se=T.deltaBase+16*(_-1),fe=T.deltaShift,he=T.z0;u.DEBUG&&console.log(T.step,"DELTAP["+_+"]",L,R);for(var _e=0;_e<L;_e++){var Ae=R.pop(),Pe=R.pop();se+((240&Pe)>>4)===Q&&(0<=(Pe=(15&Pe)-8)&&Pe++,u.DEBUG&&console.log(T.step,"DELTAPFIX",Ae,"by",Pe*fe),Ae=he[Ae],H.setRelative(Ae,Ae,Pe*fe,Z))}}function _i(_,T){var R=T.stack,L=R.pop();u.DEBUG&&console.log(T.step,"ROUND[]"),R.push(64*T.round(L/64))}function Vy(_,T){var R=T.stack,L=R.pop(),H=T.ppem,Z=T.deltaBase+16*(_-1),Q=T.deltaShift;u.DEBUG&&console.log(T.step,"DELTAC["+_+"]",L,R);for(var se=0;se<L;se++){var fe=R.pop(),he=R.pop();Z+((240&he)>>4)===H&&(0<=(he=(15&he)-8)&&he++,he=he*Q,u.DEBUG&&console.log(T.step,"DELTACFIX",fe,"by",he),T.cvt[fe]+=he)}}function Dw(_,T){var R,H=T.stack,L=H.pop(),H=H.pop(),Z=T.z2[L],Q=T.z1[H];u.DEBUG&&console.log(T.step,"SDPVTL["+_+"]",L,H),L=_?(R=Z.y-Q.y,Q.x-Z.x):(R=Q.x-Z.x,Q.y-Z.y),T.dpv=fl(R,L)}function da(_,T){var R=T.stack,L=T.prog,H=T.ip;u.DEBUG&&console.log(T.step,"PUSHB["+_+"]");for(var Z=0;Z<_;Z++)R.push(L[++H]);T.ip=H}function ha(_,T){var R=T.ip,L=T.prog,H=T.stack;u.DEBUG&&console.log(T.ip,"PUSHW["+_+"]");for(var Z=0;Z<_;Z++){var Q=L[++R]<<8|L[++R];32768&Q&&(Q=-(1+(65535^Q))),H.push(Q)}T.ip=R}function yt(_,T,R,L,H,Z){var Q,se,he=Z.stack,fe=_&&he.pop(),he=he.pop(),_e=Z.rp0,_e=Z.z0[_e],Ae=Z.z1[he],Pe=Z.minDis,ve=Z.fv,Ve=Z.dpv,Ne=Q=Ve.distance(Ae,_e,!0,!0),Be=0<=Ne?1:-1;Ne=Math.abs(Ne),_&&(se=Z.cvt[fe],L&&Math.abs(Ne-se)<Z.cvCutIn&&(Ne=se)),R&&Ne<Pe&&(Ne=Pe),L&&(Ne=Z.round(Ne)),ve.setRelative(Ae,_e,Be*Ne,Ve),ve.touch(Ae),u.DEBUG&&console.log(Z.step,(_?"MIRP[":"MDRP[")+(T?"M":"m")+(R?">":"_")+(L?"R":"_")+(H===0?"Gr":H===1?"Bl":H===2?"Wh":"")+"]",_?fe+"("+Z.cvt[fe]+","+se+")":"",he,"(d =",Q,"->",Be*Ne,")"),Z.rp1=Z.rp0,Z.rp2=he,T&&(Z.rp0=he)}Vu.prototype.exec=function(_,T){if(typeof T!="number")throw new Error("Point size is not a number!");if(!(2<this._errorState)){var R=this.font,L=this._prepState;if(!L||L.ppem!==T){var H=this._fpgmState;if(!H){Ie.prototype=ye,(H=this._fpgmState=new Ie("fpgm",R.tables.fpgm)).funcs=[],H.font=R,u.DEBUG&&(console.log("---EXEC FPGM---"),H.step=-1);try{lc(H)}catch(he){return console.log("Hinting error in FPGM:"+he),void(this._errorState=3)}}Ie.prototype=H,(L=this._prepState=new Ie("prep",R.tables.prep)).ppem=T;var Z=R.tables.cvt;if(Z)for(var Q=L.cvt=new Array(Z.length),se=T/R.unitsPerEm,fe=0;fe<Z.length;fe++)Q[fe]=Z[fe]*se;else L.cvt=[];u.DEBUG&&(console.log("---EXEC PREP---"),L.step=-1);try{lc(L)}catch(he){this._errorState<2&&console.log("Hinting error in PREP:"+he),this._errorState=2}}if(!(1<this._errorState))try{return N5(_,L)}catch(he){this._errorState<1&&(console.log("Hinting error:"+he),console.log("Note: further hinting errors are silenced")),this._errorState=1}}};var N5=function(_,T){var R=T.ppem/T.font.unitsPerEm,L=R,H=_.components;if(Ie.prototype=T,H){for(var Z=T.font,Q=[],se=[],fe=0;fe<H.length;fe++){var he=H[fe],_e=Z.glyphs.get(he.glyphIndex),Ae=new Ie("glyf",_e.instructions);u.DEBUG&&(console.log("---EXEC COMP "+fe+"---"),Ae.step=-1),Lw(_e,Ae,R,L);for(var Pe=Math.round(he.dx*R),ve=Math.round(he.dy*L),Ve=Ae.gZone,Ne=Ae.contours,Be=0;Be<Ve.length;Be++){var De=Ve[Be];De.xTouched=De.yTouched=!1,De.xo=De.x=De.x+Pe,De.yo=De.y=De.y+ve}var Le=Q.length;Q.push.apply(Q,Ve);for(var St=0;St<Ne.length;St++)se.push(Ne[St]+Le)}_.instructions&&!Ae.inhibitGridFit&&((Ae=new Ie("glyf",_.instructions)).gZone=Ae.z0=Ae.z1=Ae.z2=Q,Ae.contours=se,Q.push(new _s(0,0),new _s(Math.round(_.advanceWidth*R),0)),u.DEBUG&&(console.log("---EXEC COMPOSITE---"),Ae.step=-1),lc(Ae),Q.length-=2)}else Ae=new Ie("glyf",_.instructions),u.DEBUG&&(console.log("---EXEC GLYPH---"),Ae.step=-1),Lw(_,Ae,R,L),Q=Ae.gZone;return Q},Lw=function(_,T,R,L){for(var H,Z,Q,se=_.points||[],fe=se.length,he=T.gZone=T.z0=T.z1=T.z2=[],_e=T.contours=[],Ae=0;Ae<fe;Ae++)H=se[Ae],he[Ae]=new _s(H.x*R,H.y*L,H.lastPointOfContour,H.onCurve);for(var Pe=0;Pe<fe;Pe++)H=he[Pe],Z||(Z=H,_e.push(Pe)),H.lastPointOfContour?((H.nextPointOnContour=Z).prevPointOnContour=H,Z=void 0):(Q=he[Pe+1],(H.nextPointOnContour=Q).prevPointOnContour=H);if(!T.inhibitGridFit){if(u.DEBUG){console.log("PROCESSING GLYPH",T.stack);for(var ve=0;ve<fe;ve++)console.log(ve,he[ve].x,he[ve].y)}if(he.push(new _s(0,0),new _s(Math.round(_.advanceWidth*R),0)),lc(T),he.length-=2,u.DEBUG){console.log("FINISHED GLYPH",T.stack);for(var Ve=0;Ve<fe;Ve++)console.log(Ve,he[Ve].x,he[Ve].y)}}},lc=function(_){var T=_.prog;if(T){var R,L=T.length;for(_.ip=0;_.ip<L;_.ip++){if(u.DEBUG&&_.step++,!(R=$5[T[_.ip]]))throw new Error("unknown instruction: 0x"+Number(T[_.ip]).toString(16));R(_)}}},$5=[cr.bind(void 0,so),cr.bind(void 0,$o),Dt.bind(void 0,so),Dt.bind(void 0,$o),Cr.bind(void 0,so),Cr.bind(void 0,$o),Qr.bind(void 0,0),Qr.bind(void 0,1),sn.bind(void 0,0),sn.bind(void 0,1),function(_){var T=(R=_.stack).pop(),R=R.pop();u.DEBUG&&console.log(_.step,"SPVFS[]",T,R),_.pv=_.dpv=fl(R,T)},function(_){var T=(R=_.stack).pop(),R=R.pop();u.DEBUG&&console.log(_.step,"SPVFS[]",T,R),_.fv=fl(R,T)},function(_){var T=_.stack,R=_.pv;u.DEBUG&&console.log(_.step,"GPV[]"),T.push(16384*R.x),T.push(16384*R.y)},function(_){var T=_.stack,R=_.fv;u.DEBUG&&console.log(_.step,"GFV[]"),T.push(16384*R.x),T.push(16384*R.y)},function(_){_.fv=_.pv,u.DEBUG&&console.log(_.step,"SFVTPV[]")},function(T){var R=(Q=T.stack).pop(),L=Q.pop(),H=Q.pop(),Z=Q.pop(),Q=Q.pop(),fe=T.z0,_e=T.z1,se=fe[R],fe=fe[L],he=_e[H],_e=_e[Z],T=T.z2[Q],R=(u.DEBUG&&console.log("ISECT[], ",R,L,H,Z,Q),se.x),L=se.y,H=fe.x,Z=fe.y,Q=he.x,se=he.y,fe=_e.x,he=_e.y,_e=(R-H)*(se-he)-(L-Z)*(Q-fe),Ae=R*Z-L*H,Pe=Q*he-se*fe;T.x=(Ae*(Q-fe)-Pe*(R-H))/_e,T.y=(Ae*(se-he)-Pe*(L-Z))/_e},function(_){_.rp0=_.stack.pop(),u.DEBUG&&console.log(_.step,"SRP0[]",_.rp0)},function(_){_.rp1=_.stack.pop(),u.DEBUG&&console.log(_.step,"SRP1[]",_.rp1)},function(_){_.rp2=_.stack.pop(),u.DEBUG&&console.log(_.step,"SRP2[]",_.rp2)},function(_){var T=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"SZP0[]",T),_.zp0=T){case 0:_.tZone||Ye(_),_.z0=_.tZone;break;case 1:_.z0=_.gZone;break;default:throw new Error("Invalid zone pointer")}},function(_){var T=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"SZP1[]",T),_.zp1=T){case 0:_.tZone||Ye(_),_.z1=_.tZone;break;case 1:_.z1=_.gZone;break;default:throw new Error("Invalid zone pointer")}},function(_){var T=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"SZP2[]",T),_.zp2=T){case 0:_.tZone||Ye(_),_.z2=_.tZone;break;case 1:_.z2=_.gZone;break;default:throw new Error("Invalid zone pointer")}},function(_){var T=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"SZPS[]",T),_.zp0=_.zp1=_.zp2=T){case 0:_.tZone||Ye(_),_.z0=_.z1=_.z2=_.tZone;break;case 1:_.z0=_.z1=_.z2=_.gZone;break;default:throw new Error("Invalid zone pointer")}},function(_){_.loop=_.stack.pop(),u.DEBUG&&console.log(_.step,"SLOOP[]",_.loop)},function(_){u.DEBUG&&console.log(_.step,"RTG[]"),_.round=hl},function(_){u.DEBUG&&console.log(_.step,"RTHG[]"),_.round=Hu},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SMD[]",T),_.minDis=T/64},function(_){u.DEBUG&&console.log(_.step,"ELSE[]"),ht(_,!1)},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"JMPR[]",T),_.ip+=T-1},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SCVTCI[]",T),_.cvCutIn=T/64},void 0,void 0,function(_){var T=_.stack;u.DEBUG&&console.log(_.step,"DUP[]"),T.push(T[T.length-1])},mr,function(_){u.DEBUG&&console.log(_.step,"CLEAR[]"),_.stack.length=0},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"SWAP[]"),T.push(R),T.push(L)},function(_){var T=_.stack;u.DEBUG&&console.log(_.step,"DEPTH[]"),T.push(T.length)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"CINDEX[]",R),T.push(T[T.length-R])},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"MINDEX[]",R),T.push(T.splice(T.length-R,1)[0])},void 0,void 0,void 0,function(_){var T=(L=_.stack).pop(),R=L.pop(),L=(u.DEBUG&&console.log(_.step,"LOOPCALL[]",T,R),_.ip),H=_.prog;_.prog=_.funcs[T];for(var Z=0;Z<R;Z++)lc(_),u.DEBUG&&console.log(++_.step,Z+1<R?"next loopcall":"done loopcall",Z);_.ip=L,_.prog=H},function(_){var T=_.stack.pop(),R=(u.DEBUG&&console.log(_.step,"CALL[]",T),_.ip),L=_.prog;_.prog=_.funcs[T],lc(_),_.ip=R,_.prog=L,u.DEBUG&&console.log(++_.step,"returning from",T)},function(_){if(_.env!=="fpgm")throw new Error("FDEF not allowed here");var L=_.stack,T=_.prog,R=_.ip,L=L.pop(),H=R;for(u.DEBUG&&console.log(_.step,"FDEF[]",L);T[++R]!==45;);_.ip=R,_.funcs[L]=T.slice(H+1,R)},void 0,Fn.bind(void 0,0),Fn.bind(void 0,1),wo.bind(void 0,so),wo.bind(void 0,$o),gn.bind(void 0,0),gn.bind(void 0,1),io.bind(void 0,0),io.bind(void 0,1),ao.bind(void 0,0),ao.bind(void 0,1),function(_){for(var T=_.stack,R=_.loop,L=_.fv,H=T.pop()/64,Z=_.z2;R--;){var Q=T.pop(),se=Z[Q];u.DEBUG&&console.log(_.step,(1<_.loop?"loop "+(_.loop-R)+": ":"")+"SHPIX[]",Q,H),L.setRelative(se,se,H),L.touch(se)}_.loop=1},function(_){for(var T=_.stack,R=_.rp1,L=_.rp2,H=_.loop,Z=_.z0[R],Q=_.z1[L],se=_.fv,fe=_.dpv,he=_.z2;H--;){var _e=T.pop(),Ae=he[_e];u.DEBUG&&console.log(_.step,(1<_.loop?"loop "+(_.loop-H)+": ":"")+"IP[]",_e,R,"<->",L),se.interpolate(Ae,Z,Q,fe),se.touch(Ae)}_.loop=1},js.bind(void 0,0),js.bind(void 0,1),function(_){for(var T=_.stack,R=_.rp0,L=_.z0[R],H=_.loop,Z=_.fv,Q=_.pv,se=_.z1;H--;){var fe=T.pop(),he=se[fe];u.DEBUG&&console.log(_.step,(1<_.loop?"loop "+(_.loop-H)+": ":"")+"ALIGNRP[]",fe),Z.setRelative(he,L,0,Q),Z.touch(he)}_.loop=1},function(_){u.DEBUG&&console.log(_.step,"RTDG[]"),_.round=zy},as.bind(void 0,0),as.bind(void 0,1),function(_){var T=_.prog,R=_.ip,L=_.stack,H=T[++R];u.DEBUG&&console.log(_.step,"NPUSHB[]",H);for(var Z=0;Z<H;Z++)L.push(T[++R]);_.ip=R},function(_){var T=_.ip,R=_.prog,L=_.stack,H=R[++T];u.DEBUG&&console.log(_.step,"NPUSHW[]",H);for(var Z=0;Z<H;Z++){var Q=R[++T]<<8|R[++T];32768&Q&&(Q=-(1+(65535^Q))),L.push(Q)}_.ip=T},function(_){var L=_.stack,T=(T=_.store)||(_.store=[]),R=L.pop(),L=L.pop();u.DEBUG&&console.log(_.step,"WS",R,L),T[L]=R},function(H){var T=H.stack,R=H.store,L=T.pop(),H=(u.DEBUG&&console.log(H.step,"RS",L),R&&R[L]||0);T.push(H)},function(_){var T=(R=_.stack).pop(),R=R.pop();u.DEBUG&&console.log(_.step,"WCVTP",T,R),_.cvt[R]=T/64},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"RCVT",R),T.push(64*_.cvt[R])},Xs.bind(void 0,0),Xs.bind(void 0,1),void 0,Yu.bind(void 0,0),Yu.bind(void 0,1),function(_){u.DEBUG&&console.log(_.step,"MPPEM[]"),_.stack.push(_.ppem)},void 0,function(_){u.DEBUG&&console.log(_.step,"FLIPON[]"),_.autoFlip=!0},void 0,void 0,function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"LT[]",R,L),T.push(L<R?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"LTEQ[]",R,L),T.push(L<=R?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"GT[]",R,L),T.push(R<L?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"GTEQ[]",R,L),T.push(R<=L?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"EQ[]",R,L),T.push(R===L?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"NEQ[]",R,L),T.push(R!==L?1:0)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"ODD[]",R),T.push(Math.trunc(R)%2?1:0)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"EVEN[]",R),T.push(Math.trunc(R)%2?0:1)},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"IF[]",T),T||(ht(_,!0),u.DEBUG&&console.log(_.step,"EIF[]"))},function(_){u.DEBUG&&console.log(_.step,"EIF[]")},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"AND[]",R,L),T.push(R&&L?1:0)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"OR[]",R,L),T.push(R||L?1:0)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"NOT[]",R),T.push(R?0:1)},ua.bind(void 0,1),function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SDB[]",T),_.deltaBase=T},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SDS[]",T),_.deltaShift=Math.pow(.5,T)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"ADD[]",R,L),T.push(L+R)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"SUB[]",R,L),T.push(L-R)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"DIV[]",R,L),T.push(64*L/R)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"MUL[]",R,L),T.push(L*R/64)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"ABS[]",R),T.push(Math.abs(R))},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"NEG[]",R),T.push(-R)},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"FLOOR[]",R),T.push(64*Math.floor(R/64))},function(_){var T=_.stack,R=T.pop();u.DEBUG&&console.log(_.step,"CEILING[]",R),T.push(64*Math.ceil(R/64))},_i.bind(void 0,0),_i.bind(void 0,1),_i.bind(void 0,2),_i.bind(void 0,3),void 0,void 0,void 0,void 0,function(_){var T=(R=_.stack).pop(),R=R.pop();u.DEBUG&&console.log(_.step,"WCVTF[]",T,R),_.cvt[R]=T*_.ppem/_.font.unitsPerEm},ua.bind(void 0,2),ua.bind(void 0,3),Vy.bind(void 0,1),Vy.bind(void 0,2),Vy.bind(void 0,3),function(_){var T,R=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"SROUND[]",R),_.round=Wu,192&R){case 0:T=.5;break;case 64:T=1;break;case 128:T=2;break;default:throw new Error("invalid SROUND value")}switch(_.srPeriod=T,48&R){case 0:_.srPhase=0;break;case 16:_.srPhase=.25*T;break;case 32:_.srPhase=.5*T;break;case 48:_.srPhase=.75*T;break;default:throw new Error("invalid SROUND value")}_.srThreshold=(R&=15)===0?0:(R/8-.5)*T},function(_){var T,R=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"S45ROUND[]",R),_.round=Wu,192&R){case 0:T=Math.sqrt(2)/2;break;case 64:T=Math.sqrt(2);break;case 128:T=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(_.srPeriod=T,48&R){case 0:_.srPhase=0;break;case 16:_.srPhase=.25*T;break;case 32:_.srPhase=.5*T;break;case 48:_.srPhase=.75*T;break;default:throw new Error("invalid S45ROUND value")}_.srThreshold=(R&=15)===0?0:(R/8-.5)*T},void 0,void 0,function(_){u.DEBUG&&console.log(_.step,"ROFF[]"),_.round=By},void 0,function(_){u.DEBUG&&console.log(_.step,"RUTG[]"),_.round=Gy},function(_){u.DEBUG&&console.log(_.step,"RDTG[]"),_.round=mf},mr,mr,void 0,void 0,void 0,void 0,void 0,function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SCANCTRL[]",T)},Dw.bind(void 0,0),Dw.bind(void 0,1),function(_){var T=_.stack,R=T.pop(),L=0;u.DEBUG&&console.log(_.step,"GETINFO[]",R),1&R&&(L=35),32&R&&(L|=4096),T.push(L)},void 0,function(_){var T=_.stack,R=T.pop(),L=T.pop(),H=T.pop();u.DEBUG&&console.log(_.step,"ROLL[]"),T.push(L),T.push(R),T.push(H)},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"MAX[]",R,L),T.push(Math.max(L,R))},function(_){var T=_.stack,R=T.pop(),L=T.pop();u.DEBUG&&console.log(_.step,"MIN[]",R,L),T.push(Math.min(L,R))},function(_){var T=_.stack.pop();u.DEBUG&&console.log(_.step,"SCANTYPE[]",T)},function(_){var T=_.stack.pop(),R=_.stack.pop();switch(u.DEBUG&&console.log(_.step,"INSTCTRL[]",T,R),T){case 1:return void(_.inhibitGridFit=!!R);case 2:return void(_.ignoreCvt=!!R);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,da.bind(void 0,1),da.bind(void 0,2),da.bind(void 0,3),da.bind(void 0,4),da.bind(void 0,5),da.bind(void 0,6),da.bind(void 0,7),da.bind(void 0,8),ha.bind(void 0,1),ha.bind(void 0,2),ha.bind(void 0,3),ha.bind(void 0,4),ha.bind(void 0,5),ha.bind(void 0,6),ha.bind(void 0,7),ha.bind(void 0,8),yt.bind(void 0,0,0,0,0,0),yt.bind(void 0,0,0,0,0,1),yt.bind(void 0,0,0,0,0,2),yt.bind(void 0,0,0,0,0,3),yt.bind(void 0,0,0,0,1,0),yt.bind(void 0,0,0,0,1,1),yt.bind(void 0,0,0,0,1,2),yt.bind(void 0,0,0,0,1,3),yt.bind(void 0,0,0,1,0,0),yt.bind(void 0,0,0,1,0,1),yt.bind(void 0,0,0,1,0,2),yt.bind(void 0,0,0,1,0,3),yt.bind(void 0,0,0,1,1,0),yt.bind(void 0,0,0,1,1,1),yt.bind(void 0,0,0,1,1,2),yt.bind(void 0,0,0,1,1,3),yt.bind(void 0,0,1,0,0,0),yt.bind(void 0,0,1,0,0,1),yt.bind(void 0,0,1,0,0,2),yt.bind(void 0,0,1,0,0,3),yt.bind(void 0,0,1,0,1,0),yt.bind(void 0,0,1,0,1,1),yt.bind(void 0,0,1,0,1,2),yt.bind(void 0,0,1,0,1,3),yt.bind(void 0,0,1,1,0,0),yt.bind(void 0,0,1,1,0,1),yt.bind(void 0,0,1,1,0,2),yt.bind(void 0,0,1,1,0,3),yt.bind(void 0,0,1,1,1,0),yt.bind(void 0,0,1,1,1,1),yt.bind(void 0,0,1,1,1,2),yt.bind(void 0,0,1,1,1,3),yt.bind(void 0,1,0,0,0,0),yt.bind(void 0,1,0,0,0,1),yt.bind(void 0,1,0,0,0,2),yt.bind(void 0,1,0,0,0,3),yt.bind(void 0,1,0,0,1,0),yt.bind(void 0,1,0,0,1,1),yt.bind(void 0,1,0,0,1,2),yt.bind(void 0,1,0,0,1,3),yt.bind(void 0,1,0,1,0,0),yt.bind(void 0,1,0,1,0,1),yt.bind(void 0,1,0,1,0,2),yt.bind(void 0,1,0,1,0,3),yt.bind(void 0,1,0,1,1,0),yt.bind(void 0,1,0,1,1,1),yt.bind(void 0,1,0,1,1,2),yt.bind(void 0,1,0,1,1,3),yt.bind(void 0,1,1,0,0,0),yt.bind(void 0,1,1,0,0,1),yt.bind(void 0,1,1,0,0,2),yt.bind(void 0,1,1,0,0,3),yt.bind(void 0,1,1,0,1,0),yt.bind(void 0,1,1,0,1,1),yt.bind(void 0,1,1,0,1,2),yt.bind(void 0,1,1,0,1,3),yt.bind(void 0,1,1,1,0,0),yt.bind(void 0,1,1,1,0,1),yt.bind(void 0,1,1,1,0,2),yt.bind(void 0,1,1,1,0,3),yt.bind(void 0,1,1,1,1,0),yt.bind(void 0,1,1,1,1,1),yt.bind(void 0,1,1,1,1,2),yt.bind(void 0,1,1,1,1,3)],U5=Array.from||function(_){return _.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function gr(_){(_=_||{}).empty||(oo(_.familyName,"When creating a new Font object, familyName is required."),oo(_.styleName,"When creating a new Font object, styleName is required."),oo(_.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),oo(_.ascender,"When creating a new Font object, ascender is required."),oo(_.descender,"When creating a new Font object, descender is required."),oo(_.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:_.familyName||" "},fontSubfamily:{en:_.styleName||" "},fullName:{en:_.fullName||_.familyName+" "+_.styleName},postScriptName:{en:_.postScriptName||(_.familyName+_.styleName).replace(/\s/g,"")},designer:{en:_.designer||" "},designerURL:{en:_.designerURL||" "},manufacturer:{en:_.manufacturer||" "},manufacturerURL:{en:_.manufacturerURL||" "},license:{en:_.license||" "},licenseURL:{en:_.licenseURL||" "},version:{en:_.version||"Version 0.1"},description:{en:_.description||" "},copyright:{en:_.copyright||" "},trademark:{en:_.trademark||" "}},this.unitsPerEm=_.unitsPerEm||1e3,this.ascender=_.ascender,this.descender=_.descender,this.createdTimestamp=_.createdTimestamp,this.tables={os2:{usWeightClass:_.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:_.widthClass||this.usWidthClasses.MEDIUM,fsSelection:_.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new dt.GlyphSet(this,_.glyphs||[]),this.encoding=new ke(this),this.position=new wi(this),this.substitution=new Cn(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting||(this.outlinesFormat==="truetype"?this._hinting=new Vu(this):void 0)}})}function Fw(_,T){var R,L=JSON.stringify(_),H=256;for(R in T){var Z=parseInt(R);if(Z&&!(Z<256)){if(JSON.stringify(T[R])===L)return Z;H<=Z&&(H=Z+1)}}return T[H]=_,H}gr.prototype.hasChar=function(_){return this.encoding.charToGlyphIndex(_)!==null},gr.prototype.charToGlyphIndex=function(_){return this.encoding.charToGlyphIndex(_)},gr.prototype.charToGlyph=function(_){return _=this.charToGlyphIndex(_),this.glyphs.get(_)||this.glyphs.get(0)},gr.prototype.stringToGlyphs=function(_,T){T=T||this.defaultRenderOptions;for(var R=U5(_),L=[],H=0;H<R.length;H+=1){var Z=R[H];L.push(this.charToGlyphIndex(Z))}var Q=L.length;if(T.features){var _=T.script||this.substitution.getDefaultScriptName(),se=[];T.features.liga&&(se=se.concat(this.substitution.getFeature("liga",_,T.language))),T.features.rlig&&(se=se.concat(this.substitution.getFeature("rlig",_,T.language)));for(var fe=0;fe<Q;fe+=1)for(var he=0;he<se.length;he++){for(var _e=se[he],Ae=_e.sub,Pe=Ae.length,ve=0;ve<Pe&&Ae[ve]===L[fe+ve];)ve++;ve===Pe&&(L.splice(fe,Pe,_e.by),Q=Q-Pe+1)}}for(var Ve=new Array(Q),Ne=this.glyphs.get(0),Be=0;Be<Q;Be+=1)Ve[Be]=this.glyphs.get(L[Be])||Ne;return Ve},gr.prototype.nameToGlyphIndex=function(_){return this.glyphNames.nameToGlyphIndex(_)},gr.prototype.nameToGlyph=function(_){return _=this.nameToGlyphIndex(_),this.glyphs.get(_)||this.glyphs.get(0)},gr.prototype.glyphIndexToName=function(_){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(_):""},gr.prototype.getKerningValue=function(_,T){_=_.index||_,T=T.index||T;var R=this.position.defaultKerningTables;return R?this.position.getKerningValue(R,_,T):this.kerningPairs[_+","+T]||0},gr.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},gr.prototype.forEachGlyph=function(_,T,R,L,H,Z){T=T!==void 0?T:0,R=R!==void 0?R:0,H=H||this.defaultRenderOptions;var Q,se=1/this.unitsPerEm*(L=L!==void 0?L:72),fe=this.stringToGlyphs(_,H);H.kerning&&(_=H.script||this.position.getDefaultScriptName(),Q=this.position.getKerningTables(_,H.language));for(var he=0;he<fe.length;he+=1){var _e=fe[he];Z.call(this,_e,T,R,L,H),_e.advanceWidth&&(T+=_e.advanceWidth*se),H.kerning&&he<fe.length-1&&(T+=(Q?this.position.getKerningValue(Q,_e.index,fe[he+1].index):this.getKerningValue(_e,fe[he+1]))*se),H.letterSpacing?T+=H.letterSpacing*L:H.tracking&&(T+=H.tracking/1e3*L)}return T},gr.prototype.getPath=function(_,T,R,L,H){var Z=new J;return this.forEachGlyph(_,T,R,L,H,function(Q,se,fe,he){Q=Q.getPath(se,fe,he,H,this),Z.extend(Q)}),Z},gr.prototype.getPaths=function(_,T,R,L,H){var Z=[];return this.forEachGlyph(_,T,R,L,H,function(Q,se,fe,he){Q=Q.getPath(se,fe,he,H,this),Z.push(Q)}),Z},gr.prototype.getAdvanceWidth=function(_,T,R){return this.forEachGlyph(_,0,0,T,R,function(){})},gr.prototype.draw=function(_,T,R,L,H,Z){this.getPath(T,R,L,H,Z).draw(_)},gr.prototype.drawPoints=function(_,T,R,L,H,Z){this.forEachGlyph(T,R,L,H,Z,function(Q,se,fe,he){Q.drawPoints(_,se,fe,he)})},gr.prototype.drawMetrics=function(_,T,R,L,H,Z){this.forEachGlyph(T,R,L,H,Z,function(Q,se,fe,he){Q.drawMetrics(_,se,fe,he)})},gr.prototype.getEnglishName=function(_){if(_=this.names[_],_)return _.en},gr.prototype.validate=function(){var _=this;function T(R){R=_.getEnglishName(R),R&&R.trim().length}T("fontFamily"),T("weightName"),T("manufacturer"),T("copyright"),T("version"),this.unitsPerEm},gr.prototype.toTables=function(){return Ny.fontToTable(this)},gr.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},gr.prototype.toArrayBuffer=function(){for(var _=this.toTables().encode(),T=new ArrayBuffer(_.length),R=new Uint8Array(T),L=0;L<_.length;L++)R[L]=_[L];return T},gr.prototype.download=function(_){var T=this.getEnglishName("fontFamily"),R=this.getEnglishName("fontSubfamily"),L=(_=_||T.replace(/\s/g,"")+"-"+R+".otf",this.toArrayBuffer());typeof window<"u"?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,L.byteLength,function(H){H.root.getFile(_,{create:!0},function(Z){Z.createWriter(function(Q){var se=new DataView(L),se=new Blob([se],{type:"font/opentype"});Q.write(se),Q.addEventListener("writeend",function(){location.href=Z.toURL()},!1)})})},function(H){throw new Error(H.name+": "+H.message)})):(T=r("fs"),R=function(H){for(var Z=new a(H.byteLength),Q=new Uint8Array(H),se=0;se<Z.length;++se)Z[se]=Q[se];return Z}(L),T.writeFileSync(_,R))},gr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},gr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},gr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var B5={make:function(_,T){var R=new Fe.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:_.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:_.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*_.axes.length}]);R.offsetToData=R.sizeOf();for(var L,H,Z,Q=0;Q<_.axes.length;Q++)R.fields=R.fields.concat((L=Q,H=_.axes[Q],Z=T,Z=Fw(H.name,T),[{name:"tag_"+L,type:"TAG",value:H.tag},{name:"minValue_"+L,type:"FIXED",value:H.minValue<<16},{name:"defaultValue_"+L,type:"FIXED",value:H.defaultValue<<16},{name:"maxValue_"+L,type:"FIXED",value:H.maxValue<<16},{name:"flags_"+L,type:"USHORT",value:0},{name:"nameID_"+L,type:"USHORT",value:Z}]));for(var se=0;se<_.instances.length;se++)R.fields=R.fields.concat(function(fe,he,_e,Ae){for(var Pe=[{name:"nameID_"+fe,type:"USHORT",value:Fw(he.name,Ae)},{name:"flags_"+fe,type:"USHORT",value:0}],ve=0;ve<_e.length;++ve){var Ve=_e[ve].tag;Pe.push({name:"axis_"+fe+" "+Ve,type:"FIXED",value:he.coordinates[Ve]<<16})}return Pe}(se,_.instances[se],_.axes,T));return R},parse:function(_,T,R){for(var L,H,Z,Q,se=new Me.Parser(_,T),fe=se.parseULong(),he=(U.argument(fe===65536,"Unsupported fvar table version."),se.parseOffset16()),_e=(se.skip("uShort",1),se.parseUShort()),Ae=se.parseUShort(),Pe=se.parseUShort(),ve=se.parseUShort(),Ve=[],Ne=0;Ne<_e;Ne++)Ve.push((L=_,H=T+he+Ne*Ae,Z=R,Q={},L=new Me.Parser(L,H),Q.tag=L.parseTag(),Q.minValue=L.parseFixed(),Q.defaultValue=L.parseFixed(),Q.maxValue=L.parseFixed(),L.skip("uShort",1),Q.name=Z[L.parseUShort()]||{},Q));for(var Be=[],De=T+he+_e*Ae,Le=0;Le<Pe;Le++)Be.push(function(St,At,wt,_t){var Ft={},br=new Me.Parser(St,At);Ft.name=_t[br.parseUShort()]||{},br.skip("uShort",1),Ft.coordinates={};for(var Yr=0;Yr<wt.length;++Yr)Ft.coordinates[wt[Yr].tag]=br.parseFixed();return Ft}(_,De+Le*ve,Ve,R));return{axes:Ve,instances:Be}}},Es=new Array(10);Es[1]=function(){var _=this.offset+this.relativeOffset,T=this.parseUShort();return T===1?{posFormat:1,coverage:this.parsePointer(Ce.coverage),value:this.parseValueRecord()}:T===2?{posFormat:2,coverage:this.parsePointer(Ce.coverage),values:this.parseValueRecordList()}:void U.assert(!1,"0x"+_.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Es[2]=function(){var _,T,R,L,Z=this.offset+this.relativeOffset,H=this.parseUShort(),Z=(U.assert(H===1||H===2,"0x"+Z.toString(16)+": GPOS lookup type 2 format must be 1 or 2."),this.parsePointer(Ce.coverage)),Q=this.parseUShort(),se=this.parseUShort();return H===1?{posFormat:H,coverage:Z,valueFormat1:Q,valueFormat2:se,pairSets:this.parseList(Ce.pointer(Ce.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(Q),value2:this.parseValueRecord(se)}})))}:H===2?(_=this.parsePointer(Ce.classDef),T=this.parsePointer(Ce.classDef),R=this.parseUShort(),L=this.parseUShort(),{posFormat:H,coverage:Z,valueFormat1:Q,valueFormat2:se,classDef1:_,classDef2:T,class1Count:R,class2Count:L,classRecords:this.parseList(R,Ce.list(L,function(){return{value1:this.parseValueRecord(Q),value2:this.parseValueRecord(se)}}))}):void 0},Es[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Es[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Es[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Es[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Es[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Es[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Es[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var z5=new Array(10),G5={parse:function(_,T){return T=(_=new Ce(_,T=T||0)).parseVersion(1),U.argument(T===1||T===1.1,"Unsupported GPOS table version "+T),T===1?{version:T,scripts:_.parseScriptList(),features:_.parseFeatureList(),lookups:_.parseLookupList(Es)}:{version:T,scripts:_.parseScriptList(),features:_.parseFeatureList(),lookups:_.parseLookupList(Es),variations:_.parseFeatureVariationsList()}},make:function(_){return new Fe.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Fe.ScriptList(_.scripts)},{name:"features",type:"TABLE",value:new Fe.FeatureList(_.features)},{name:"lookups",type:"TABLE",value:new Fe.LookupList(_.lookups,z5)}])}},V5={parse:function(_,T){if(_=new Me.Parser(_,T),(T=_.parseUShort())===0){var R=_,L={},Ae=(R.skip("uShort"),R.parseUShort()),H=(U.argument(Ae===0,"Unsupported kern sub-table version."),R.skip("uShort",2),R.parseUShort());R.skip("uShort",3);for(var Z=0;Z<H;Z+=1){var Q=R.parseUShort(),se=R.parseUShort(),fe=R.parseShort();L[Q+","+se]=fe}return L}if(T!==1)throw new Error("Unsupported kern table version ("+T+").");var he=_,_e={},Ae=(he.skip("uShort"),1<he.parseULong()&&console.warn("Only the first kern subtable is supported."),he.skip("uLong"),255&he.parseUShort());if(he.skip("uShort"),Ae==0){var Pe=he.parseUShort();he.skip("uShort",3);for(var ve=0;ve<Pe;ve+=1){var Ve=he.parseUShort(),Ne=he.parseUShort(),Be=he.parseShort();_e[Ve+","+Ne]=Be}}return _e}},H5={parse:function(_,T,R,L){for(var H=new Me.Parser(_,T),Z=L?H.parseUShort:H.parseULong,Q=[],se=0;se<R+1;se+=1){var fe=Z.call(H);L&&(fe*=2),Q.push(fe)}return Q}};function W5(_,T){r("fs").readFile(_,function(R,L){if(R)return T(R.message);T(null,hf(L))})}function Y5(_,T){var R=new XMLHttpRequest;R.open("get",_,!0),R.responseType="arraybuffer",R.onload=function(){return R.response?T(null,R.response):T("Font could not be loaded: "+R.statusText)},R.onerror=function(){T("Font could not be loaded")},R.send()}function Nw(_,T){for(var R=[],L=12,H=0;H<T;H+=1){var Z=Me.getTag(_,L),Q=Me.getULong(_,L+4),se=Me.getULong(_,L+8),fe=Me.getULong(_,L+12);R.push({tag:Z,checksum:Q,offset:se,length:fe,compression:!1}),L+=16}return R}function an(R,T){if(T.compression!=="WOFF")return{data:R,offset:T.offset};var R=new Uint8Array(R.buffer,T.offset+2,T.compressedLength-2),L=new Uint8Array(T.length);if(W(R,L),L.byteLength!==T.length)throw new Error("Decompression error: "+T.tag+" decompressed length doesn't match recorded length");return{data:new DataView(L.buffer,0),offset:0}}function Hy(Le){var T,R,L,H,Z,Q,se,fe,he,_e,Ae,Pe,ve,Ve,Ne=new gr({empty:!0}),Be=new DataView(Le,0),De=[],Le=Me.getTag(Be,0);if(Le===String.fromCharCode(0,1,0,0)||Le==="true"||Le==="typ1")Ne.outlinesFormat="truetype",De=Nw(Be,L=Me.getUShort(Be,4));else if(Le==="OTTO")Ne.outlinesFormat="cff",De=Nw(Be,L=Me.getUShort(Be,4));else{if(Le!=="wOFF")throw new Error("Unsupported OpenType signature "+Le);var St=Me.getTag(Be,4);if(St===String.fromCharCode(0,1,0,0))Ne.outlinesFormat="truetype";else{if(St!=="OTTO")throw new Error("Unsupported OpenType flavor "+Le);Ne.outlinesFormat="cff"}De=function(Pr,ir){for(var Un=[],Nr=44,Pn=0;Pn<ir;Pn+=1){var Tr=Me.getTag(Pr,Nr),xn=Me.getULong(Pr,Nr+4),Xu=Me.getULong(Pr,Nr+8),cc=Me.getULong(Pr,Nr+12),$w=void 0,$w=Xu<cc&&"WOFF";Un.push({tag:Tr,offset:xn,compression:$w,compressedLength:Xu,length:cc}),Nr+=20}return Un}(Be,L=Me.getUShort(Be,12))}for(var At=0;At<L;At+=1){var wt=De[At],_t=void 0;switch(wt.tag){case"cmap":_t=an(Be,wt),Ne.tables.cmap=re.parse(_t.data,_t.offset),Ne.encoding=new $e(Ne.tables.cmap);break;case"cvt ":_t=an(Be,wt),Ve=new Me.Parser(_t.data,_t.offset),Ne.tables.cvt=Ve.parseShortList(wt.length/2);break;case"fvar":Z=wt;break;case"fpgm":_t=an(Be,wt),Ve=new Me.Parser(_t.data,_t.offset),Ne.tables.fpgm=Ve.parseByteList(wt.length);break;case"head":_t=an(Be,wt),Ne.tables.head=ro.parse(_t.data,_t.offset),Ne.unitsPerEm=Ne.tables.head.unitsPerEm,T=Ne.tables.head.indexToLocFormat;break;case"hhea":_t=an(Be,wt),Ne.tables.hhea=be.parse(_t.data,_t.offset),Ne.ascender=Ne.tables.hhea.ascender,Ne.descender=Ne.tables.hhea.descender,Ne.numberOfHMetrics=Ne.tables.hhea.numberOfHMetrics;break;case"hmtx":he=wt;break;case"ltag":_t=an(Be,wt),R=ct.parse(_t.data,_t.offset);break;case"maxp":_t=an(Be,wt),Ne.tables.maxp=qe.parse(_t.data,_t.offset),Ne.numGlyphs=Ne.tables.maxp.numGlyphs;break;case"name":Pe=wt;break;case"OS/2":_t=an(Be,wt),Ne.tables.os2=on.parse(_t.data,_t.offset);break;case"post":_t=an(Be,wt),Ne.tables.post=nf.parse(_t.data,_t.offset),Ne.glyphNames=new Qe(Ne.tables.post);break;case"prep":_t=an(Be,wt),Ve=new Me.Parser(_t.data,_t.offset),Ne.tables.prep=Ve.parseByteList(wt.length);break;case"glyf":Q=wt;break;case"loca":Ae=wt;break;case"CFF ":H=wt;break;case"kern":_e=wt;break;case"GPOS":se=wt;break;case"GSUB":fe=wt;break;case"meta":ve=wt}}if(St=an(Be,Pe),Ne.tables.name=no.parse(St.data,St.offset,R),Ne.names=Ne.tables.name,Q&&Ae)Le=T===0,St=an(Be,Ae),St=H5.parse(St.data,St.offset,Ne.numGlyphs,Le),Le=an(Be,Q),Ne.glyphs=Ys.parse(Le.data,Le.offset,St,Ne);else{if(!H)throw new Error("Font doesn't contain TrueType or CFF outlines.");Le=an(Be,H),ul.parse(Le.data,Le.offset,Ne)}for(var St=an(Be,he),Ft=(Ze.parse(St.data,St.offset,Ne.numberOfHMetrics,Ne.numGlyphs,Ne.glyphs),Ne),br=Ft.tables.cmap.glyphIndexMap,Yr=Object.keys(br),ln=0;ln<Yr.length;ln+=1){var Nn,$n=Yr[ln],Cs=br[$n];(Nn=Ft.glyphs.get(Cs)).addUnicode(parseInt($n))}for(var yr=0;yr<Ft.glyphs.length;yr+=1)Nn=Ft.glyphs.get(yr),Ft.cffEncoding?Ft.isCIDFont?Nn.name="gid"+yr:Nn.name=Ft.cffEncoding.charset[yr]:Ft.glyphNames.names&&(Nn.name=Ft.glyphNames.glyphIndexToName(yr));return _e?(Le=an(Be,_e),Ne.kerningPairs=V5.parse(Le.data,Le.offset)):Ne.kerningPairs={},se&&(St=an(Be,se),Ne.tables.gpos=G5.parse(St.data,St.offset),Ne.position.init()),fe&&(Le=an(Be,fe),Ne.tables.gsub=of.parse(Le.data,Le.offset)),Z&&(St=an(Be,Z),Ne.tables.fvar=B5.parse(St.data,St.offset,Ne.names)),ve&&(Le=an(Be,ve),Ne.tables.meta=la.parse(Le.data,Le.offset),Ne.metas=Ne.tables.meta),Ne}u.Font=gr,u.Glyph=at,u.Path=J,u.BoundingBox=q,u._parse=Me,u.parse=Hy,u.load=function(_,T){(typeof window>"u"?W5:Y5)(_,function(R,L){if(R)return T(R);var H;try{H=Hy(L)}catch(Z){return T(Z,null)}return T(null,H)})},u.loadSync=function(_){return Hy(hf(r("fs").readFileSync(_)))},Object.defineProperty(u,"__esModule",{value:!0})},c(typeof i=="object"&&s!==void 0?i:l.opentype={})}).call(this,r("buffer").Buffer)},{buffer:4,fs:2}],255:[function(r,s,i){(function(a){function l(f,h){for(var d=0,p=f.length-1;0<=p;p--){var m=f[p];m==="."?f.splice(p,1):m===".."?(f.splice(p,1),d++):d&&(f.splice(p,1),d--)}if(h)for(;d--;)f.unshift("..");return f}function c(f,h){if(f.filter)return f.filter(h);for(var d=[],p=0;p<f.length;p++)h(f[p],p,f)&&d.push(f[p]);return d}i.resolve=function(){for(var f="",h=!1,d=arguments.length-1;-1<=d&&!h;d--){var p=0<=d?arguments[d]:a.cwd();if(typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");p&&(f=p+"/"+f,h=p.charAt(0)==="/")}return(h?"/":"")+(f=l(c(f.split("/"),function(m){return!!m}),!h).join("/"))||"."},i.normalize=function(f){var h=i.isAbsolute(f),d=u(f,-1)==="/";return(f=(f=l(c(f.split("/"),function(p){return!!p}),!h).join("/"))||h?f:".")&&d&&(f+="/"),(h?"/":"")+f},i.isAbsolute=function(f){return f.charAt(0)==="/"},i.join=function(){var f=Array.prototype.slice.call(arguments,0);return i.normalize(c(f,function(h,d){if(typeof h!="string")throw new TypeError("Arguments to path.join must be strings");return h}).join("/"))},i.relative=function(f,h){function d(x){for(var S=0;S<x.length&&x[S]==="";S++);for(var w=x.length-1;0<=w&&x[w]==="";w--);return w<S?[]:x.slice(S,w-S+1)}f=i.resolve(f).substr(1),h=i.resolve(h).substr(1);for(var p=d(f.split("/")),m=d(h.split("/")),g=Math.min(p.length,m.length),b=g,y=0;y<g;y++)if(p[y]!==m[y]){b=y;break}for(var v=[],y=b;y<p.length;y++)v.push("..");return(v=v.concat(m.slice(b))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(f){if(typeof f!="string"&&(f+=""),f.length===0)return".";for(var h=f.charCodeAt(0)===47,d=-1,p=!0,m=f.length-1;1<=m;--m)if(f.charCodeAt(m)===47){if(!p){d=m;break}}else p=!1;return d===-1?h?"/":".":h&&d===1?"/":f.slice(0,d)},i.basename=function(f,h){return f=function(d){typeof d!="string"&&(d+="");for(var p=0,m=-1,g=!0,b=d.length-1;0<=b;--b)if(d.charCodeAt(b)===47){if(!g){p=b+1;break}}else m===-1&&(g=!1,m=b+1);return m===-1?"":d.slice(p,m)}(f),f=h&&f.substr(-1*h.length)===h?f.substr(0,f.length-h.length):f},i.extname=function(f){typeof f!="string"&&(f+="");for(var h=-1,d=0,p=-1,m=!0,g=0,b=f.length-1;0<=b;--b){var y=f.charCodeAt(b);if(y===47){if(m)continue;d=b+1;break}p===-1&&(m=!1,p=b+1),y===46?h===-1?h=b:g!==1&&(g=1):h!==-1&&(g=-1)}return h===-1||p===-1||g===0||g===1&&h===p-1&&h===d+1?"":f.slice(h,p)};var u="ab".substr(-1)==="b"?function(f,h,d){return f.substr(h,d)}:function(f,h,d){return h<0&&(h=f.length+h),f.substr(h,d)}}).call(this,r("_process"))},{_process:256}],256:[function(r,c,i){var a,l,c=c.exports={};function u(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}try{a=typeof setTimeout=="function"?setTimeout:u}catch{a=u}try{l=typeof clearTimeout=="function"?clearTimeout:f}catch{l=f}function h(S){if(a===setTimeout)return setTimeout(S,0);if((a===u||!a)&&setTimeout)return(a=setTimeout)(S,0);try{return a(S,0)}catch{try{return a.call(null,S,0)}catch{return a.call(this,S,0)}}}var d,p=[],m=!1,g=-1;function b(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&y())}function y(){if(!m){for(var S=h(b),w=(m=!0,p.length);w;){for(d=p,p=[];++g<w;)d&&d[g].run();g=-1,w=p.length}d=null,m=!1,function(E){if(l===clearTimeout)return clearTimeout(E);if((l===f||!l)&&clearTimeout)return(l=clearTimeout)(E);try{l(E)}catch{try{return l.call(null,E)}catch{return l.call(this,E)}}}(S)}}function v(S,w){this.fun=S,this.array=w}function x(){}c.nextTick=function(S){var w=new Array(arguments.length-1);if(1<arguments.length)for(var E=1;E<arguments.length;E++)w[E-1]=arguments[E];p.push(new v(S,w)),p.length!==1||m||h(y)},v.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=x,c.addListener=x,c.once=x,c.off=x,c.removeListener=x,c.removeAllListeners=x,c.emit=x,c.prependListener=x,c.prependOnceListener=x,c.listeners=function(S){return[]},c.binding=function(S){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(S){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],257:[function(r,s,i){s=function(a){var l,c=Object.prototype,u=c.hasOwnProperty,j=typeof Symbol=="function"?Symbol:{},f=j.iterator||"@@iterator",h=j.asyncIterator||"@@asyncIterator",d=j.toStringTag||"@@toStringTag";function p(X,z,V,K){var J,ae,I,U,z=z&&z.prototype instanceof S?z:S,z=Object.create(z.prototype),K=new N(K||[]);return z._invoke=(J=X,ae=V,I=K,U=g,function(te,ne){if(U===y)throw new Error("Generator is already running");if(U===v){if(te==="throw")throw ne;return G()}for(I.method=te,I.arg=ne;;){var le=I.delegate;if(le&&(le=function me(ce,ge){var pe=ce.iterator[ge.method];if(pe===l){if(ge.delegate=null,ge.method==="throw"){if(ce.iterator.return&&(ge.method="return",ge.arg=l,me(ce,ge),ge.method==="throw"))return x;ge.method="throw",ge.arg=new TypeError("The iterator does not provide a 'throw' method")}return x}if(pe=m(pe,ce.iterator,ge.arg),pe.type==="throw")return ge.method="throw",ge.arg=pe.arg,ge.delegate=null,x;if(pe=pe.arg,!pe)return ge.method="throw",ge.arg=new TypeError("iterator result is not an object"),ge.delegate=null,x;{if(!pe.done)return pe;ge[ce.resultName]=pe.value,ge.next=ce.nextLoc,ge.method!=="return"&&(ge.method="next",ge.arg=l)}return ge.delegate=null,x}(le,I),le)){if(le===x)continue;return le}if(I.method==="next")I.sent=I._sent=I.arg;else if(I.method==="throw"){if(U===g)throw U=v,I.arg;I.dispatchException(I.arg)}else I.method==="return"&&I.abrupt("return",I.arg);if(U=y,le=m(J,ae,I),le.type==="normal"){if(U=I.done?v:b,le.arg!==x)return{value:le.arg,done:I.done}}else le.type==="throw"&&(U=v,I.method="throw",I.arg=le.arg)}}),z}function m(X,W,V){try{return{type:"normal",arg:X.call(W,V)}}catch(q){return{type:"throw",arg:q}}}a.wrap=p;var g="suspendedStart",b="suspendedYield",y="executing",v="completed",x={};function S(){}function w(){}function E(){}var j={},P=(j[f]=function(){return this},Object.getPrototypeOf),P=P&&P(P($([]))),M=(P&&P!==c&&u.call(P,f)&&(j=P),E.prototype=S.prototype=Object.create(j));function O(X){["next","throw","return"].forEach(function(W){X[W]=function(V){return this._invoke(W,V)}})}function k(X){var W;this._invoke=function(V,q){function J(){return new Promise(function(ae,I){(function U(me,K,te,ne){var le,me=m(X[me],X,K);if(me.type!=="throw")return(K=(le=me.arg).value)&&typeof K=="object"&&u.call(K,"__await")?Promise.resolve(K.__await).then(function(ce){U("next",ce,te,ne)},function(ce){U("throw",ce,te,ne)}):Promise.resolve(K).then(function(ce){le.value=ce,te(le)},function(ce){return U("throw",ce,te,ne)});ne(me.arg)})(V,q,ae,I)})}return W=W?W.then(J,J):J()}}function F(X){var W={tryLoc:X[0]};1 in X&&(W.catchLoc=X[1]),2 in X&&(W.finallyLoc=X[2],W.afterLoc=X[3]),this.tryEntries.push(W)}function A(X){var W=X.completion||{};W.type="normal",delete W.arg,X.completion=W}function N(X){this.tryEntries=[{tryLoc:"root"}],X.forEach(F,this),this.reset(!0)}function $(X){if(X){var W,V=X[f];if(V)return V.call(X);if(typeof X.next=="function")return X;if(!isNaN(X.length))return W=-1,(V=function q(){for(;++W<X.length;)if(u.call(X,W))return q.value=X[W],q.done=!1,q;return q.value=l,q.done=!0,q}).next=V}return{next:G}}function G(){return{value:l,done:!0}}return(w.prototype=M.constructor=E).constructor=w,E[d]=w.displayName="GeneratorFunction",a.isGeneratorFunction=function(X){return X=typeof X=="function"&&X.constructor,!!X&&(X===w||(X.displayName||X.name)==="GeneratorFunction")},a.mark=function(X){return Object.setPrototypeOf?Object.setPrototypeOf(X,E):(X.__proto__=E,d in X||(X[d]="GeneratorFunction")),X.prototype=Object.create(M),X},a.awrap=function(X){return{__await:X}},O(k.prototype),k.prototype[h]=function(){return this},a.AsyncIterator=k,a.async=function(X,W,V,q){var J=new k(p(X,W,V,q));return a.isGeneratorFunction(W)?J:J.next().then(function(ae){return ae.done?ae.value:J.next()})},O(M),M[d]="Generator",M[f]=function(){return this},M.toString=function(){return"[object Generator]"},a.keys=function(X){var W,V=[];for(W in X)V.push(W);return V.reverse(),function q(){for(;V.length;){var J=V.pop();if(J in X)return q.value=J,q.done=!1,q}return q.done=!0,q}},a.values=$,N.prototype={constructor:N,reset:function(X){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(A),!X)for(var W in this)W.charAt(0)==="t"&&u.call(this,W)&&!isNaN(+W.slice(1))&&(this[W]=l)},stop:function(){this.done=!0;var X=this.tryEntries[0].completion;if(X.type==="throw")throw X.arg;return this.rval},dispatchException:function(X){if(this.done)throw X;var W=this;function V(z,K){return ae.type="throw",ae.arg=X,W.next=z,K&&(W.method="next",W.arg=l),!!K}for(var q=this.tryEntries.length-1;0<=q;--q){var J=this.tryEntries[q],ae=J.completion;if(J.tryLoc==="root")return V("end");if(J.tryLoc<=this.prev){var I=u.call(J,"catchLoc"),U=u.call(J,"finallyLoc");if(I&&U){if(this.prev<J.catchLoc)return V(J.catchLoc,!0);if(this.prev<J.finallyLoc)return V(J.finallyLoc)}else if(I){if(this.prev<J.catchLoc)return V(J.catchLoc,!0)}else{if(!U)throw new Error("try statement without catch or finally");if(this.prev<J.finallyLoc)return V(J.finallyLoc)}}}},abrupt:function(X,W){for(var V=this.tryEntries.length-1;0<=V;--V){var q=this.tryEntries[V];if(q.tryLoc<=this.prev&&u.call(q,"finallyLoc")&&this.prev<q.finallyLoc){var J=q;break}}var ae=(J=J&&(X==="break"||X==="continue")&&J.tryLoc<=W&&W<=J.finallyLoc?null:J)?J.completion:{};return ae.type=X,ae.arg=W,J?(this.method="next",this.next=J.finallyLoc,x):this.complete(ae)},complete:function(X,W){if(X.type==="throw")throw X.arg;return X.type==="break"||X.type==="continue"?this.next=X.arg:X.type==="return"?(this.rval=this.arg=X.arg,this.method="return",this.next="end"):X.type==="normal"&&W&&(this.next=W),x},finish:function(X){for(var W=this.tryEntries.length-1;0<=W;--W){var V=this.tryEntries[W];if(V.finallyLoc===X)return this.complete(V.completion,V.afterLoc),A(V),x}},catch:function(X){for(var W=this.tryEntries.length-1;0<=W;--W){var V,q,J=this.tryEntries[W];if(J.tryLoc===X)return(V=J.completion).type==="throw"&&(q=V.arg,A(J)),q}throw new Error("illegal catch attempt")},delegateYield:function(X,W,V){return this.delegate={iterator:$(X),resultName:W,nextLoc:V},this.method==="next"&&(this.arg=l),x}},a}(typeof s=="object"?s.exports:{});try{regeneratorRuntime=s}catch{Function("r","regeneratorRuntime = r")(s)}},{}],258:[function(r,s,i){(function(a){var l,c,u,f,h,d,p,m,g,b;function y(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(A))throw new TypeError("Invalid character in header field name");return A.toLowerCase()}function v(A){return A=typeof A!="string"?String(A):A}function x(A){var N={next:function(){var $=A.shift();return{done:$===void 0,value:$}}};return c&&(N[Symbol.iterator]=function(){return N}),N}function S(A){this.map={},A instanceof S?A.forEach(function(N,$){this.append($,N)},this):Array.isArray(A)?A.forEach(function(N){this.append(N[0],N[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(N){this.append(N,A[N])},this)}function w(A){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}function E(A){return new Promise(function(N,$){A.onload=function(){N(A.result)},A.onerror=function(){$(A.error)}})}function j(A){var N=new FileReader,$=E(N);return N.readAsArrayBuffer(A),$}function P(A){var N;return A.slice?A.slice(0):((N=new Uint8Array(A.byteLength)).set(new Uint8Array(A)),N.buffer)}function M(){return this.bodyUsed=!1,this._initBody=function(A){if(this._bodyInit=A)if(typeof A=="string")this._bodyText=A;else if(u&&Blob.prototype.isPrototypeOf(A))this._bodyBlob=A;else if(f&&FormData.prototype.isPrototypeOf(A))this._bodyFormData=A;else if(l&&URLSearchParams.prototype.isPrototypeOf(A))this._bodyText=A.toString();else if(h&&u&&p(A))this._bodyArrayBuffer=P(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!h||!ArrayBuffer.prototype.isPrototypeOf(A)&&!m(A))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=P(A)}else this._bodyText="";this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var A=w(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?w(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(j)}),this.text=function(){var A,N,$=w(this);if($)return $;if(this._bodyBlob)return $=this._bodyBlob,A=new FileReader,N=E(A),A.readAsText($),N;if(this._bodyArrayBuffer)return Promise.resolve(function(G){for(var X=new Uint8Array(G),W=new Array(X.length),V=0;V<X.length;V++)W[V]=String.fromCharCode(X[V]);return W.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}function O(A,N){var $,G=(N=N||{}).body;if(A instanceof O){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,N.headers||(this.headers=new S(A.headers)),this.method=A.method,this.mode=A.mode,G||A._bodyInit==null||(G=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=N.credentials||this.credentials||"omit",!N.headers&&this.headers||(this.headers=new S(N.headers)),this.method=(A=N.method||this.method||"GET",$=A.toUpperCase(),-1<g.indexOf($)?$:A),this.mode=N.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(G)}function k(A){var N=new FormData;return A.trim().split("&").forEach(function($){var G;$&&(G=($=$.split("=")).shift().replace(/\+/g," "),$=$.join("=").replace(/\+/g," "),N.append(decodeURIComponent(G),decodeURIComponent($)))}),N}function F(A,N){N=N||{},this.type="default",this.status=N.status===void 0?200:N.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in N?N.statusText:"OK",this.headers=new S(N.headers),this.url=N.url||"",this._initBody(A)}a.fetch||(l="URLSearchParams"in a,c="Symbol"in a&&"iterator"in Symbol,u="FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),f="FormData"in a,(h="ArrayBuffer"in a)&&(d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(A){return A&&DataView.prototype.isPrototypeOf(A)},m=ArrayBuffer.isView||function(A){return A&&-1<d.indexOf(Object.prototype.toString.call(A))}),S.prototype.append=function(A,N){A=y(A),N=v(N);var $=this.map[A];this.map[A]=$?$+","+N:N},S.prototype.delete=function(A){delete this.map[y(A)]},S.prototype.get=function(A){return A=y(A),this.has(A)?this.map[A]:null},S.prototype.has=function(A){return this.map.hasOwnProperty(y(A))},S.prototype.set=function(A,N){this.map[y(A)]=v(N)},S.prototype.forEach=function(A,N){for(var $ in this.map)this.map.hasOwnProperty($)&&A.call(N,this.map[$],$,this)},S.prototype.keys=function(){var A=[];return this.forEach(function(N,$){A.push($)}),x(A)},S.prototype.values=function(){var A=[];return this.forEach(function(N){A.push(N)}),x(A)},S.prototype.entries=function(){var A=[];return this.forEach(function(N,$){A.push([$,N])}),x(A)},c&&(S.prototype[Symbol.iterator]=S.prototype.entries),g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],O.prototype.clone=function(){return new O(this,{body:this._bodyInit})},M.call(O.prototype),M.call(F.prototype),F.prototype.clone=function(){return new F(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new S(this.headers),url:this.url})},F.error=function(){var A=new F(null,{status:0,statusText:""});return A.type="error",A},b=[301,302,303,307,308],F.redirect=function(A,N){if(b.indexOf(N)===-1)throw new RangeError("Invalid status code");return new F(null,{status:N,headers:{location:A}})},a.Headers=S,a.Request=O,a.Response=F,a.fetch=function(A,N){return new Promise(function($,G){var X=new O(A,N),W=new XMLHttpRequest;W.onload=function(){var V,q={status:W.status,statusText:W.statusText,headers:(q=W.getAllResponseHeaders()||"",V=new S,q.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(I){var I=I.split(":"),U=I.shift().trim();U&&(I=I.join(":").trim(),V.append(U,I))}),V)},J=(q.url="responseURL"in W?W.responseURL:q.headers.get("X-Request-URL"),"response"in W?W.response:W.responseText);$(new F(J,q))},W.onerror=function(){G(new TypeError("Network request failed"))},W.ontimeout=function(){G(new TypeError("Network request failed"))},W.open(X.method,X.url,!0),X.credentials==="include"?W.withCredentials=!0:X.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&u&&(W.responseType="blob"),X.headers.forEach(function(V,q){W.setRequestHeader(q,V)}),W.send(X._bodyInit===void 0?null:X._bodyInit)})},a.fetch.polyfill=!0)})(typeof self<"u"?self:this)},{}],259:[function(r,s,i){r("core-js/modules/es.function.name"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a,l=u(r("../core/main")),c=u(r("../color/color_conversion"));function u(d){return d&&d.__esModule?d:{default:d}}var f=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],h=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];l.default.prototype._rgbColorName=function(g){var p,m,g=c.default._rgbaToHSBA(g),b=[(a=g)[0],g[1],g[2]];b[0]!==0&&(b[0]=Math.round(100*b[0]),(g=b[0].toString().split(""))[m=g.length-1]=parseInt(g[m]),g[m]<2.5?g[m]=0:2.5<=g[m]&&g[m]<7.5&&(g[m]=5),g.length===2?(g[0]=parseInt(g[0]),7.5<=g[m]&&(g[m]=0,g[0]=g[0]+1),b[0]=10*g[0]+g[1]):7.5<=g[m]?b[0]=10:b[0]=g[m]),b[2]=b[2]/255;for(var y=b.length-1;1<=y;y--)b[y]<=.25?b[y]=0:.25<b[y]&&b[y]<.75?b[y]=.5:b[y]=1;if(b[0]===0&&b[1]===0&&b[2]===1){for(var v=2;0<=v;v--)a[v]=Math.round(1e4*a[v])/1e4;for(var x=0;x<f.length;x++){if(f[x].h===a[0]&&f[x].s===a[1]&&f[x].b===a[2]){p=f[x].name;break}p="white"}}else for(var S=0;S<h.length;S++)if(h[S].h===b[0]&&h[S].s===b[1]&&h[S].b===b[2]){p=h[S].name;break}return p},r=l.default,i.default=r},{"../color/color_conversion":265,"../core/main":280,"core-js/modules/es.function.name":173,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.split":203}],260:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.replace"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r},l="_Description",c="_fallbackDesc",u="_fallbackTable",f="_Label",h="_labelDesc",d="_labelTable";function p(m){if(m==="label"||m==="fallback")throw new Error("description should not be LABEL or FALLBACK");return m.endsWith(".")||m.endsWith(";")||m.endsWith(",")||m.endsWith("?")||m.endsWith("!")||(m+="."),m}a.default.prototype.describe=function(m,g){var b;a.default._validateParameters("describe",arguments),typeof m=="string"&&(b=this.canvas.id,m=p(m),this.dummyDOM||(this.dummyDOM=document.getElementById(b).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==m&&(this.descriptions.fallback.innerHTML=m):this._describeHTML("fallback",m),g===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==m&&(this.descriptions.label.innerHTML=m):this._describeHTML("label",m)))},a.default.prototype.describeElement=function(m,g,b){var y,v;a.default._validateParameters("describeElement",arguments),typeof g=="string"&&typeof m=="string"&&(y=this.canvas.id,g=p(g),v=function(x){if(x==="label"||x==="fallback")throw new Error("element name should not be LABEL or FALLBACK");return x.endsWith(".")||x.endsWith(";")||x.endsWith(",")?x=x.replace(/.$/,":"):x.endsWith(":")||(x+=":"),x}(m),m=m.replace(/[^a-zA-Z0-9]/g,""),v='<th scope="row">'.concat(v,"</th><td>").concat(g,"</td>"),this.dummyDOM||(this.dummyDOM=document.getElementById(y).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[m]?this.descriptions.fallbackElements[m].innerHTML!==v&&(this.descriptions.fallbackElements[m].innerHTML=v):this._describeElementHTML("fallback",m,v),b===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[m]?this.descriptions.labelElements[m].innerHTML!==v&&(this.descriptions.labelElements[m].innerHTML=v):this._describeElementHTML("label",m,v)))},a.default.prototype._describeHTML=function(m,g){var b,y=this.canvas.id;m==="fallback"?(this.dummyDOM.querySelector("#".concat(y+l))?this.dummyDOM.querySelector("#"+y+u).insertAdjacentHTML("beforebegin",'<p id="'.concat(y+c,'"></p>')):(b='<div id="'.concat(y).concat(l,'" role="region" aria-label="Canvas Description"><p id="').concat(y).concat(c,'"></p></div>'),this.dummyDOM.querySelector("#".concat(y,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(y,"accessibleOutput")).insertAdjacentHTML("beforebegin",b):this.dummyDOM.querySelector("#".concat(y)).innerHTML=b),this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(y).concat(c)),this.descriptions.fallback.innerHTML=g):m==="label"&&(this.dummyDOM.querySelector("#".concat(y+f))?this.dummyDOM.querySelector("#".concat(y+d))&&this.dummyDOM.querySelector("#".concat(y+d)).insertAdjacentHTML("beforebegin",'<p id="'.concat(y).concat(h,'"></p>')):(b='<div id="'.concat(y).concat(f,'" class="p5Label"><p id="').concat(y).concat(h,'"></p></div>'),this.dummyDOM.querySelector("#".concat(y,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(y,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",b):this.dummyDOM.querySelector("#"+y).insertAdjacentHTML("afterend",b)),this.descriptions.label=this.dummyDOM.querySelector("#"+y+h),this.descriptions.label.innerHTML=g)},a.default.prototype._describeElementHTML=function(m,g,b){var y,v=this.canvas.id;m==="fallback"?(this.dummyDOM.querySelector("#".concat(v+l))?this.dummyDOM.querySelector("#"+v+u)||this.dummyDOM.querySelector("#"+v+c).insertAdjacentHTML("afterend",'<table id="'.concat(v).concat(u,'"><caption>Canvas elements and their descriptions</caption></table>')):(y='<div id="'.concat(v).concat(l,'" role="region" aria-label="Canvas Description"><table id="').concat(v).concat(u,'"><caption>Canvas elements and their descriptions</caption></table></div>'),this.dummyDOM.querySelector("#".concat(v,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutput")).insertAdjacentHTML("beforebegin",y):this.dummyDOM.querySelector("#"+v).innerHTML=y),(y=document.createElement("tr")).id=v+"_fte_"+g,this.dummyDOM.querySelector("#"+v+u).appendChild(y),this.descriptions.fallbackElements[g]=this.dummyDOM.querySelector("#".concat(v).concat("_fte_").concat(g)),this.descriptions.fallbackElements[g].innerHTML=b):m==="label"&&(this.dummyDOM.querySelector("#".concat(v+f))?this.dummyDOM.querySelector("#".concat(v+d))||this.dummyDOM.querySelector("#"+v+h).insertAdjacentHTML("afterend",'<table id="'.concat(v+d,'"></table>')):(y='<div id="'.concat(v).concat(f,'" class="p5Label"><table id="').concat(v).concat(d,'"></table></div>'),this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",y):this.dummyDOM.querySelector("#"+v).insertAdjacentHTML("afterend",y)),(m=document.createElement("tr")).id=v+"_lte_"+g,this.dummyDOM.querySelector("#"+v+d).appendChild(m),this.descriptions.labelElements[g]=this.dummyDOM.querySelector("#".concat(v).concat("_lte_").concat(g)),this.descriptions.labelElements[g].innerHTML=b)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.ends-with":195,"core-js/modules/es.string.replace":201}],261:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.map"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.map"),r("core-js/modules/es.string.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype._updateGridOutput=function(a){var l,c,u,f;this.dummyDOM.querySelector("#".concat(a,"_summary"))&&(l=this._accessibleOutputs[a],u=function(h,d,p,m){return d="".concat(d," canvas, ").concat(p," by ").concat(m," pixels, contains ").concat(h[0]),d=(h[0]===1?"".concat(d," shape: "):"".concat(d," shapes: ")).concat(h[1]),d}((c=function(h,d){var p,m="",g="",b=0;for(p in d){var y,v=0;for(y in d[p]){var x='<li id="'.concat(h,"shape").concat(b,'">').concat(d[p][y].color," ").concat(p,",");p==="line"?x+=" location = ".concat(d[p][y].pos,", length = ").concat(d[p][y].length," pixels"):(x+=" location = ".concat(d[p][y].pos),p!=="point"&&(x+=", area = ".concat(d[p][y].area," %")),x+="</li>"),m+=x,v++,b++}g=1<v?"".concat(g," ").concat(v," ").concat(p,"s"):"".concat(g," ").concat(v," ").concat(p)}return{numShapes:[b,g],details:m}}(a,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),f=function(h,d){var p,m,g=0,b="",y=Array.from(Array(10),function(){return Array(10)});for(p in d)for(var v in d[p]){var x=void 0;x=p!=="line"?'<a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][v].color," ").concat(p,"</a>"):'<a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][v].color," ").concat(p," midpoint</a>"),y[d[p][v].loc.locY][d[p][v].loc.locX]?y[d[p][v].loc.locY][d[p][v].loc.locX]=y[d[p][v].loc.locY][d[p][v].loc.locX]+"  "+x:y[d[p][v].loc.locY][d[p][v].loc.locX]=x,g++}for(m in y){var S,w="<tr>";for(S in y[m])w+="<td>",y[m][S]!==void 0&&(w+=y[m][S]),w+="</td>";b=b+w+"</tr>"}return b}(a,this.ingredients.shapes),u!==l.summary.innerHTML&&(l.summary.innerHTML=u),f!==l.map.innerHTML&&(l.map.innerHTML=f),c.details!==l.shapeDetails.innerHTML&&(l.shapeDetails.innerHTML=c.details),this._accessibleOutputs[a]=l)},r=r.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.from":161,"core-js/modules/es.array.map":167,"core-js/modules/es.string.iterator":197}],262:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.to-fixed"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u){return function(f){if(Array.isArray(f)){for(var h=0,d=new Array(f.length);h<f.length;h++)d[h]=f[h];return d}}(u)||function(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(u,f,h){return f=Math.floor(u[0]/f*10),u=Math.floor(u[1]/h*10),f===10&&(f-=1),u===10&&(u-=1),{locX:f,locY:u}}a.default.prototype.textOutput=function(u){a.default._validateParameters("textOutput",arguments),this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),u===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},a.default.prototype.gridOutput=function(u){a.default._validateParameters("gridOutput",arguments),this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),u===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},a.default.prototype._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},a.default.prototype._createOutput=function(u,f){var h,d,p,m=this.canvas.id,g=(this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:"",pBackground:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(m).parentNode),"");f==="Fallback"?(h=m+u,this.dummyDOM.querySelector("#".concat(d=m+"accessibleOutput"))||(this.dummyDOM.querySelector("#".concat(m,"_Description"))?this.dummyDOM.querySelector("#".concat(m,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(d,'" role="region" aria-label="Canvas Outputs"></div>')):this.dummyDOM.querySelector("#".concat(m)).innerHTML='<div id="'.concat(d,'" role="region" aria-label="Canvas Outputs"></div>'))):f==="Label"&&(h=m+u+(g=f),this.dummyDOM.querySelector("#".concat(d=m+"accessibleOutput"+f))||(this.dummyDOM.querySelector("#".concat(m,"_Label"))?this.dummyDOM.querySelector("#".concat(m,"_Label")):this.dummyDOM.querySelector("#".concat(m))).insertAdjacentHTML("afterend",'<div id="'.concat(d,'"></div>'))),this._accessibleOutputs[h]={},u==="textOutput"?(g="#".concat(m,"gridOutput").concat(g),p='<div id="'.concat(h,'">Text Output<div id="').concat(h,'Summary" aria-label="text output summary"><p id="').concat(h,'_summary"></p><ul id="').concat(h,'_list"></ul></div><table id="').concat(h,'_shapeDetails" summary="text output shape details"></table></div>'),this.dummyDOM.querySelector(g)?this.dummyDOM.querySelector(g).insertAdjacentHTML("beforebegin",p):this.dummyDOM.querySelector("#".concat(d)).innerHTML=p,this._accessibleOutputs[h].list=this.dummyDOM.querySelector("#".concat(h,"_list"))):u==="gridOutput"&&(g="#".concat(m,"textOutput").concat(g),p='<div id="'.concat(h,'">Grid Output<p id="').concat(h,'_summary" aria-label="grid output summary"><table id="').concat(h,'_map" summary="grid output content"></table><ul id="').concat(h,'_shapeDetails" aria-label="grid output shape details"></ul></div>'),this.dummyDOM.querySelector(g)?this.dummyDOM.querySelector(g).insertAdjacentHTML("afterend",p):this.dummyDOM.querySelector("#".concat(d)).innerHTML=p,this._accessibleOutputs[h].map=this.dummyDOM.querySelector("#".concat(h,"_map"))),this._accessibleOutputs[h].shapeDetails=this.dummyDOM.querySelector("#".concat(h,"_shapeDetails")),this._accessibleOutputs[h].summary=this.dummyDOM.querySelector("#".concat(h,"_summary"))},a.default.prototype._updateAccsOutput=function(){var u=this.canvas.id;JSON.stringify(this.ingredients.shapes)===this.ingredients.pShapes&&this.ingredients.colors.background===this.ingredients.pBackground||(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(u+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(u+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(u+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(u+"gridOutputLabel"))},a.default.prototype._accsBackground=function(u){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.pBackground=this.ingredients.colors.background,this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==u&&(this.ingredients.colors.backgroundRGBA=u,this.ingredients.colors.background=this._rgbColorName(u))},a.default.prototype._accsCanvasColors=function(u,f){u==="fill"?this.ingredients.colors.fillRGBA!==f&&(this.ingredients.colors.fillRGBA=f,this.ingredients.colors.fill=this._rgbColorName(f)):u==="stroke"&&this.ingredients.colors.strokeRGBA!==f&&(this.ingredients.colors.strokeRGBA=f,this.ingredients.colors.stroke=this._rgbColorName(f))},a.default.prototype._accsOutput=function(u,f){u==="ellipse"&&f[2]===f[3]?u="circle":u==="rectangle"&&f[2]===f[3]&&(u="square");var h,d,p={},m=!0,g=function(y,v){var x;return y=y==="rectangle"||y==="ellipse"||y==="arc"||y==="circle"||y==="square"?(x=Math.round(v[0]+v[2]/2),Math.round(v[1]+v[3]/2)):y==="triangle"?(x=(v[0]+v[2]+v[4])/3,(v[1]+v[3]+v[5])/3):y==="quadrilateral"?(x=(v[0]+v[2]+v[4]+v[6])/4,(v[1]+v[3]+v[5]+v[7])/4):y==="line"?(x=(v[0]+v[2])/2,(v[1]+v[3])/2):(x=v[0],v[1]),[x,y]}(u,f);if(u==="line"?(p.color=this.ingredients.colors.stroke,p.length=Math.round(this.dist(f[0],f[1],f[2],f[3])),h=this._getPos(f[0],[1]),d=this._getPos(f[2],[3]),p.loc=c(g,this.width,this.height),p.pos=h===d?"at ".concat(h):"from ".concat(h," to ").concat(d)):(u==="point"?p.color=this.ingredients.colors.stroke:(p.color=this.ingredients.colors.fill,p.area=this._getArea(u,f)),p.pos=this._getPos.apply(this,l(g)),p.loc=c(g,this.width,this.height)),this.ingredients.shapes[u]){if(this.ingredients.shapes[u]!==[p]){for(var b in this.ingredients.shapes[u])JSON.stringify(this.ingredients.shapes[u][b])===JSON.stringify(p)&&(m=!1);m===!0&&this.ingredients.shapes[u].push(p)}}else this.ingredients.shapes[u]=[p]},a.default.prototype._getPos=function(d,h){var d=new DOMPointReadOnly(d,h),h=this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform(),d=d.matrixTransform(h),h=d.x,d=d.y,p=this.width*this._pixelDensity,m=this.height*this._pixelDensity;return h<.4*p?d<.4*m?"top left":.6*m<d?"bottom left":"mid left":.6*p<h?d<.4*m?"top right":.6*m<d?"bottom right":"mid right":d<.4*m?"top middle":.6*m<d?"bottom middle":"middle"},a.default.prototype._getArea=function(u,f){var h,d,p=0,m=(u==="arc"?(p=(h=((f[5]-f[4])%(2*Math.PI)+2*Math.PI)%(2*Math.PI))*f[2]*f[3]/8,f[6]!=="open"&&f[6]!=="chord"||(d=f[0],v=f[1],m=f[0]+f[2]/2*Math.cos(f[4]).toFixed(2),x=f[1]+f[3]/2*Math.sin(f[4]).toFixed(2),b=f[0]+f[2]/2*Math.cos(f[5]).toFixed(2),g=f[1]+f[3]/2*Math.sin(f[5]).toFixed(2),d=Math.abs(d*(x-g)+m*(g-v)+b*(v-x))/2,h>Math.PI?p+=d:p-=d)):u==="ellipse"||u==="circle"?p=3.14*f[2]/2*f[3]/2:u==="line"||u==="point"?p=0:u==="quadrilateral"?p=Math.abs((f[6]+f[0])*(f[7]-f[1])+(f[0]+f[2])*(f[1]-f[3])+(f[2]+f[4])*(f[3]-f[5])+(f[4]+f[6])*(f[5]-f[7]))/2:u==="rectangle"||u==="square"?p=f[2]*f[3]:u==="triangle"&&(p=Math.abs(f[0]*(f[3]-f[5])+f[2]*(f[5]-f[1])+f[4]*(f[1]-f[3]))/2),this.width*this._pixelDensity),g=this.height*this._pixelDensity,b=[new DOMPoint(0,0),new DOMPoint(m,0),new DOMPoint(m,g),new DOMPoint(0,g)],y=(this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform()).inverse(),v=b.map(function(S){return S.matrixTransform(y)}),x=Math.abs((v[3].x+v[0].x)*(v[3].y-v[0].y)+(v[0].x+v[1].x)*(v[0].y-v[1].y)+(v[1].x+v[2].x)*(v[1].y-v[2].y)+(v[2].x+v[3].x)*(v[2].y-v[3].y))/2;return Math.round(100*p/x)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],263:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.concat"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype._updateTextOutput=function(a){var l,c,u,f;this.dummyDOM.querySelector("#".concat(a,"_summary"))&&(l=this._accessibleOutputs[a],u=function(h,d,p,m){return p="Your output is a, ".concat(p," by ").concat(m," pixels, ").concat(d," canvas containing the following"),p=h===1?"".concat(p," shape:"):"".concat(p," ").concat(h," shapes:"),p}((c=function(h,d){var p,m="",g=0;for(p in d)for(var b in d[p]){var y='<li><a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][b].color," ").concat(p,"</a>");p==="line"?y+=", ".concat(d[p][b].pos,", ").concat(d[p][b].length," pixels long.</li>"):(y+=", at ".concat(d[p][b].pos),p!=="point"&&(y+=", covering ".concat(d[p][b].area,"% of the canvas")),y+=".</li>"),m+=y,g++}return{numShapes:g,listShapes:m}}(a,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),f=function(h,d){var p,m="",g=0;for(p in d)for(var b in d[p]){var y='<tr id="'.concat(h,"shape").concat(g,'"><th>').concat(d[p][b].color," ").concat(p,"</th>");p==="line"?y+="<td>location = ".concat(d[p][b].pos,"</td><td>length = ").concat(d[p][b].length," pixels</td></tr>"):(y+="<td>location = ".concat(d[p][b].pos,"</td>"),p!=="point"&&(y+="<td> area = ".concat(d[p][b].area,"%</td>")),y+="</tr>"),m+=y,g++}return m}(a,this.ingredients.shapes),u!==l.summary.innerHTML&&(l.summary.innerHTML=u),c.listShapes!==l.list.innerHTML&&(l.list.innerHTML=c.listShapes),f!==l.shapeDetails.innerHTML&&(l.shapeDetails.innerHTML=f),this._accessibleOutputs[a]=l)},r=r.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152}],264:[function(r,s,i){var a=(a=r("./core/main"))&&a.__esModule?a:{default:a};r("./core/constants"),r("./core/environment"),r("./core/friendly_errors/stacktrace"),r("./core/friendly_errors/validate_params"),r("./core/friendly_errors/file_errors"),r("./core/friendly_errors/fes_core"),r("./core/friendly_errors/sketch_reader"),r("./core/helpers"),r("./core/legacy"),r("./core/preload"),r("./core/p5.Element"),r("./core/p5.Graphics"),r("./core/p5.Renderer"),r("./core/p5.Renderer2D"),r("./core/rendering"),r("./core/shim"),r("./core/structure"),r("./core/transform"),r("./core/shape/2d_primitives"),r("./core/shape/attributes"),r("./core/shape/curves"),r("./core/shape/vertex"),r("./accessibility/outputs"),r("./accessibility/textOutput"),r("./accessibility/gridOutput"),r("./accessibility/color_namer"),r("./color/color_conversion"),r("./color/creating_reading"),r("./color/p5.Color"),r("./color/setting"),r("./data/p5.TypedDict"),r("./data/local_storage.js"),r("./dom/dom"),r("./accessibility/describe"),r("./events/acceleration"),r("./events/keyboard"),r("./events/mouse"),r("./events/touch"),r("./image/filters"),r("./image/image"),r("./image/loading_displaying"),r("./image/p5.Image"),r("./image/pixels"),r("./io/files"),r("./io/p5.Table"),r("./io/p5.TableRow"),r("./io/p5.XML"),r("./math/calculation"),r("./math/math"),r("./math/noise"),r("./math/p5.Vector"),r("./math/random"),r("./math/trigonometry"),r("./typography/attributes"),r("./typography/loading_displaying"),r("./typography/p5.Font"),r("./utilities/array_functions"),r("./utilities/conversion"),r("./utilities/string_functions"),r("./utilities/time_date"),r("./webgl/3d_primitives"),r("./webgl/interaction"),r("./webgl/light"),r("./webgl/loading"),r("./webgl/material"),r("./webgl/p5.Camera"),r("./webgl/p5.DataArray"),r("./webgl/p5.Geometry"),r("./webgl/p5.Matrix"),r("./webgl/p5.RendererGL.Immediate"),r("./webgl/p5.RendererGL"),r("./webgl/p5.RendererGL.Retained"),r("./webgl/p5.Framebuffer"),r("./webgl/p5.Shader"),r("./webgl/p5.RenderBuffer"),r("./webgl/p5.Texture"),r("./webgl/text"),r("./core/init"),s.exports=a.default},{"./accessibility/color_namer":259,"./accessibility/describe":260,"./accessibility/gridOutput":261,"./accessibility/outputs":262,"./accessibility/textOutput":263,"./color/color_conversion":265,"./color/creating_reading":266,"./color/p5.Color":267,"./color/setting":268,"./core/constants":269,"./core/environment":270,"./core/friendly_errors/fes_core":271,"./core/friendly_errors/file_errors":272,"./core/friendly_errors/sketch_reader":273,"./core/friendly_errors/stacktrace":274,"./core/friendly_errors/validate_params":275,"./core/helpers":276,"./core/init":277,"./core/legacy":279,"./core/main":280,"./core/p5.Element":281,"./core/p5.Graphics":282,"./core/p5.Renderer":283,"./core/p5.Renderer2D":284,"./core/preload":285,"./core/rendering":286,"./core/shape/2d_primitives":287,"./core/shape/attributes":288,"./core/shape/curves":289,"./core/shape/vertex":290,"./core/shim":291,"./core/structure":292,"./core/transform":293,"./data/local_storage.js":294,"./data/p5.TypedDict":295,"./dom/dom":296,"./events/acceleration":297,"./events/keyboard":298,"./events/mouse":299,"./events/touch":300,"./image/filters":301,"./image/image":302,"./image/loading_displaying":303,"./image/p5.Image":304,"./image/pixels":305,"./io/files":306,"./io/p5.Table":307,"./io/p5.TableRow":308,"./io/p5.XML":309,"./math/calculation":310,"./math/math":311,"./math/noise":312,"./math/p5.Vector":313,"./math/random":314,"./math/trigonometry":315,"./typography/attributes":316,"./typography/loading_displaying":317,"./typography/p5.Font":318,"./utilities/array_functions":319,"./utilities/conversion":320,"./utilities/string_functions":321,"./utilities/time_date":322,"./webgl/3d_primitives":323,"./webgl/interaction":325,"./webgl/light":326,"./webgl/loading":327,"./webgl/material":328,"./webgl/p5.Camera":329,"./webgl/p5.DataArray":330,"./webgl/p5.Framebuffer":331,"./webgl/p5.Geometry":332,"./webgl/p5.Matrix":333,"./webgl/p5.RenderBuffer":334,"./webgl/p5.RendererGL":337,"./webgl/p5.RendererGL.Immediate":335,"./webgl/p5.RendererGL.Retained":336,"./webgl/p5.Shader":338,"./webgl/p5.Texture":339,"./webgl/text":340}],265:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.ColorConversion={_hsbaToHSLA:function(a){var l=a[0],c=a[1],u=a[2],f=(2-c)*u/2;return f!=0&&(f==1?c=0:f<.5?c/=2-c:c=c*u/(2-2*f)),[l,c,f,a[3]]},_hsbaToRGBA:function(a){var l,c,u,f,h,d=6*a[0],p=a[1],m=a[2];return p===0?[m,m,m,a[3]]:(c=m*(1-p),u=m*(1-p*(d-(l=Math.floor(d)))),p=m*(1-p*(1+l-d)),d=l===1?(f=u,h=m,c):l===2?(f=c,h=m,p):l===3?(f=c,h=u,m):l===4?(f=p,h=c,m):l===5?(f=m,h=c,u):(f=m,h=p,c),[f,h,d,a[3]])},_hslaToHSBA:function(a){var l=a[0],c=a[1],u=a[2],f=u<.5?(1+c)*u:u+c-u*c;return[l,c=2*(f-u)/f,f,a[3]]},_hslaToRGBA:function(a){var l,c=6*a[0],u=a[1],f=a[2];return u===0?[f,f,f,a[3]]:[(l=function(h,d,p){return h<0?h+=6:6<=h&&(h-=6),h<1?d+(p-d)*h:h<3?p:h<4?d+(p-d)*(4-h):d})(2+c,u=2*f-(f=f<.5?(1+u)*f:f+u-f*u),f),l(c,u,f),l(c-2,u,f),a[3]]},_rgbaToHSBA:function(a){var l,c,u=a[0],f=a[1],h=a[2],d=Math.max(u,f,h),p=d-Math.min(u,f,h);return p==0?c=l=0:(c=p/d,u===d?l=(f-h)/p:f===d?l=2+(h-u)/p:h===d&&(l=4+(u-f)/p),l<0?l+=6:6<=l&&(l-=6)),[l/6,c,d,a[3]]},_rgbaToHSLA:function(a){var l,c,u=a[0],f=a[1],h=a[2],d=Math.max(u,f,h),m=Math.min(u,f,h),p=d+m,m=d-m;return m==0?c=l=0:(c=p<1?m/p:m/(2-p),u===d?l=(f-h)/m:f===d?l=2+(h-u)/m:h===d&&(l=4+(u-f)/m),l<0?l+=6:6<=l&&(l-=6)),[l/6,c,p/2,a[3]]}},r=r.default.ColorConversion,i.default=r},{"../core/main":280}],266:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.map"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Color"),r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.alpha=function(d){return c.default._validateParameters("alpha",arguments),this.color(d)._getAlpha()},c.default.prototype.blue=function(d){return c.default._validateParameters("blue",arguments),this.color(d)._getBlue()},c.default.prototype.brightness=function(d){return c.default._validateParameters("brightness",arguments),this.color(d)._getBrightness()},c.default.prototype.color=function(){for(var d,p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return c.default._validateParameters("color",m),m[0]instanceof c.default.Color?m[0]:(d=Array.isArray(m[0])?m[0]:m,new c.default.Color(this,d))},c.default.prototype.green=function(d){return c.default._validateParameters("green",arguments),this.color(d)._getGreen()},c.default.prototype.hue=function(d){return c.default._validateParameters("hue",arguments),this.color(d)._getHue()},c.default.prototype.lerpColor=function(d,p,m){c.default._validateParameters("lerpColor",arguments);var g,b,y,v=this._colorMode,x=this._colorMaxes;if(v===u.RGB)b=d.levels.map(function(S){return S/255}),y=p.levels.map(function(S){return S/255});else if(v===u.HSB)d._getBrightness(),p._getBrightness(),b=d.hsba,y=p.hsba;else{if(v!==u.HSL)throw new Error("".concat(v," cannot be used for interpolation."));d._getLightness(),p._getLightness(),b=d.hsla,y=p.hsla}return m=Math.max(Math.min(m,1),0),this.lerp===void 0&&(this.lerp=function(S,w,E){return E*(w-S)+S}),v===u.RGB?g=this.lerp(b[0],y[0],m):(.5<Math.abs(b[0]-y[0])&&(b[0]>y[0]?y[0]+=1:b[0]+=1),1<=(g=this.lerp(b[0],y[0],m))&&--g),d=this.lerp(b[1],y[1],m),p=this.lerp(b[2],y[2],m),b=this.lerp(b[3],y[3],m),g*=x[v][0],d*=x[v][1],p*=x[v][2],b*=x[v][3],this.color(g,d,p,b)},c.default.prototype.lightness=function(d){return c.default._validateParameters("lightness",arguments),this.color(d)._getLightness()},c.default.prototype.red=function(d){return c.default._validateParameters("red",arguments),this.color(d)._getRed()},c.default.prototype.saturation=function(d){return c.default._validateParameters("saturation",arguments),this.color(d)._getSaturation()};var h=c.default;i.default=h},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"./p5.Color":267,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],267:[function(g,s,i){function a(S){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(S)}function l(S){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(w){return a(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":a(w)})(S)}g("core-js/modules/es.symbol"),g("core-js/modules/es.symbol.description"),g("core-js/modules/es.symbol.iterator"),g("core-js/modules/es.array.includes"),g("core-js/modules/es.array.iterator"),g("core-js/modules/es.array.join"),g("core-js/modules/es.array.map"),g("core-js/modules/es.array.slice"),g("core-js/modules/es.object.get-own-property-descriptor"),g("core-js/modules/es.object.to-string"),g("core-js/modules/es.regexp.constructor"),g("core-js/modules/es.regexp.exec"),g("core-js/modules/es.regexp.to-string"),g("core-js/modules/es.string.includes"),g("core-js/modules/es.string.iterator"),g("core-js/modules/es.string.trim"),g("core-js/modules/es.weak-map"),g("core-js/modules/web.dom-collections.iterator"),g("core-js/modules/es.array.includes"),g("core-js/modules/es.array.join"),g("core-js/modules/es.array.map"),g("core-js/modules/es.array.slice"),g("core-js/modules/es.object.to-string"),g("core-js/modules/es.regexp.constructor"),g("core-js/modules/es.regexp.exec"),g("core-js/modules/es.regexp.to-string"),g("core-js/modules/es.string.includes"),g("core-js/modules/es.string.trim"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=d(g("../core/main")),u=function(S){if(S&&S.__esModule)return S;if(S===null||l(S)!=="object"&&typeof S!="function")return{default:S};var w=h();if(w&&w.has(S))return w.get(S);var E,j={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(E in S){var M;Object.prototype.hasOwnProperty.call(S,E)&&((M=P?Object.getOwnPropertyDescriptor(S,E):null)&&(M.get||M.set)?Object.defineProperty(j,E,M):j[E]=S[E])}return j.default=S,w&&w.set(S,j),j}(g("../core/constants")),f=d(g("./color_conversion"));function h(){var S;return typeof WeakMap!="function"?null:(S=new WeakMap,h=function(){return S},S)}function d(S){return S&&S.__esModule?S:{default:S}}function p(S,w){for(var E=0;E<w.length;E++){var j=w[E];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(S,j.key,j)}}var m={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},g=/\s*/,x=/(\d{1,3})/,b=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,y=new RegExp("".concat(b.source,"%")),v={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",x.source,",",x.source,",",x.source,"\\)$"].join(g.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",y.source,",",y.source,",",y.source,"\\)$"].join(g.source),"i"),RGBA:new RegExp(["^rgba\\(",x.source,",",x.source,",",x.source,",",b.source,"\\)$"].join(g.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",y.source,",",y.source,",",y.source,",",b.source,"\\)$"].join(g.source),"i"),HSL:new RegExp(["^hsl\\(",x.source,",",y.source,",",y.source,"\\)$"].join(g.source),"i"),HSLA:new RegExp(["^hsla\\(",x.source,",",y.source,",",y.source,",",b.source,"\\)$"].join(g.source),"i"),HSB:new RegExp(["^hsb\\(",x.source,",",y.source,",",y.source,"\\)$"].join(g.source),"i"),HSBA:new RegExp(["^hsba\\(",x.source,",",y.source,",",y.source,",",b.source,"\\)$"].join(g.source),"i")},x=(c.default.Color=function(){function S(P,M){if(!(this instanceof S))throw new TypeError("Cannot call a class as a function");if(this._storeModeAndMaxes(P._colorMode,P._colorMaxes),![u.RGB,u.HSL,u.HSB].includes(this.mode))throw new Error("".concat(this.mode," is an invalid colorMode."));this._array=S._parseInputs.apply(this,M),this._calculateLevels()}var w,E,j;return w=S,j=[{key:"_parseInputs",value:function(P,M,O,k){var F,A=arguments.length,N=this.mode,$=this.maxes[N],G=[];if(3<=A){for(G[0]=P/$[0],G[1]=M/$[1],G[2]=O/$[2],G[3]=typeof k=="number"?k/$[3]:1,F=G.length-1;0<=F;--F){var X=G[F];X<0?G[F]=0:1<X&&(G[F]=1)}return N===u.HSL?f.default._hslaToRGBA(G):N===u.HSB?f.default._hsbaToRGBA(G):G}if(A===1&&typeof P=="string"){if(O=P.trim().toLowerCase(),m[O])return S._parseInputs.call(this,m[O]);if(v.HEX3.test(O))return(G=v.HEX3.exec(O).slice(1).map(function(W){return parseInt(W+W,16)/255}))[3]=1,G;if(v.HEX6.test(O))return(G=v.HEX6.exec(O).slice(1).map(function(W){return parseInt(W,16)/255}))[3]=1,G;if(v.HEX4.test(O))return G=v.HEX4.exec(O).slice(1).map(function(W){return parseInt(W+W,16)/255});if(v.HEX8.test(O))return G=v.HEX8.exec(O).slice(1).map(function(W){return parseInt(W,16)/255});if(v.RGB.test(O))return(G=v.RGB.exec(O).slice(1).map(function(W){return W/255}))[3]=1,G;if(v.RGB_PERCENT.test(O))return(G=v.RGB_PERCENT.exec(O).slice(1).map(function(W){return parseFloat(W)/100}))[3]=1,G;if(v.RGBA.test(O))return G=v.RGBA.exec(O).slice(1).map(function(W,V){return V===3?parseFloat(W):W/255});if(v.RGBA_PERCENT.test(O))return G=v.RGBA_PERCENT.exec(O).slice(1).map(function(W,V){return V===3?parseFloat(W):parseFloat(W)/100});if(v.HSL.test(O)?(G=v.HSL.exec(O).slice(1).map(function(W,V){return V===0?parseInt(W,10)/360:parseInt(W,10)/100}))[3]=1:v.HSLA.test(O)&&(G=v.HSLA.exec(O).slice(1).map(function(W,V){return V===0?parseInt(W,10)/360:V===3?parseFloat(W):parseInt(W,10)/100})),(G=G.map(function(W){return Math.max(Math.min(W,1),0)})).length)return f.default._hslaToRGBA(G);if(v.HSB.test(O)?(G=v.HSB.exec(O).slice(1).map(function(W,V){return V===0?parseInt(W,10)/360:parseInt(W,10)/100}))[3]=1:v.HSBA.test(O)&&(G=v.HSBA.exec(O).slice(1).map(function(W,V){return V===0?parseInt(W,10)/360:V===3?parseFloat(W):parseInt(W,10)/100})),G.length){for(F=G.length-1;0<=F;--F)G[F]=Math.max(Math.min(G[F],1),0);return f.default._hsbaToRGBA(G)}G=[1,1,1,1]}else{if(A!==1&&A!==2||typeof P!="number")throw new Error("".concat(arguments,"is not a valid color representation."));G[0]=P/$[2],G[1]=P/$[2],G[2]=P/$[2],G[3]=typeof M=="number"?M/$[3]:1,G=G.map(function(W){return Math.max(Math.min(W,1),0)})}return G}}],(E=[{key:"toString",value:function(P){var M=this.levels,O=this._array,k=O[3];switch(P){case"#rrggbb":return"#".concat(M[0]<16?"0".concat(M[0].toString(16)):M[0].toString(16),M[1]<16?"0".concat(M[1].toString(16)):M[1].toString(16),M[2]<16?"0".concat(M[2].toString(16)):M[2].toString(16));case"#rrggbbaa":return"#".concat(M[0]<16?"0".concat(M[0].toString(16)):M[0].toString(16),M[1]<16?"0".concat(M[1].toString(16)):M[1].toString(16),M[2]<16?"0".concat(M[2].toString(16)):M[2].toString(16),M[3]<16?"0".concat(M[3].toString(16)):M[3].toString(16));case"#rgb":return"#".concat(Math.round(15*O[0]).toString(16),Math.round(15*O[1]).toString(16),Math.round(15*O[2]).toString(16));case"#rgba":return"#".concat(Math.round(15*O[0]).toString(16),Math.round(15*O[1]).toString(16),Math.round(15*O[2]).toString(16),Math.round(15*O[3]).toString(16));case"rgb":return"rgb(".concat(M[0],", ",M[1],", ",M[2],")");case"rgb%":return"rgb(".concat((100*O[0]).toPrecision(3),"%, ",(100*O[1]).toPrecision(3),"%, ",(100*O[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*O[0]).toPrecision(3),"%, ",(100*O[1]).toPrecision(3),"%, ",(100*O[2]).toPrecision(3),"%, ",(100*O[3]).toPrecision(3),"%)");case"hsb":case"hsv":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsb(".concat(this.hsba[0]*this.maxes[u.HSB][0],", ",this.hsba[1]*this.maxes[u.HSB][1],", ",this.hsba[2]*this.maxes[u.HSB][2],")");case"hsb%":case"hsv%":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsba(".concat(this.hsba[0]*this.maxes[u.HSB][0],", ",this.hsba[1]*this.maxes[u.HSB][1],", ",this.hsba[2]*this.maxes[u.HSB][2],", ",k,")");case"hsba%":case"hsva%":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*k).toPrecision(3),"%)");case"hsl":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat(this.hsla[0]*this.maxes[u.HSL][0],", ",this.hsla[1]*this.maxes[u.HSL][1],", ",this.hsla[2]*this.maxes[u.HSL][2],")");case"hsl%":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsla(".concat(this.hsla[0]*this.maxes[u.HSL][0],", ",this.hsla[1]*this.maxes[u.HSL][1],", ",this.hsla[2]*this.maxes[u.HSL][2],", ",k,")");case"hsla%":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*k).toPrecision(3),"%)");default:return"rgba(".concat(M[0],",",M[1],",",M[2],",",k,")")}}},{key:"setRed",value:function(P){this._array[0]=P/this.maxes[u.RGB][0],this._calculateLevels()}},{key:"setGreen",value:function(P){this._array[1]=P/this.maxes[u.RGB][1],this._calculateLevels()}},{key:"setBlue",value:function(P){this._array[2]=P/this.maxes[u.RGB][2],this._calculateLevels()}},{key:"setAlpha",value:function(P){this._array[3]=P/this.maxes[this.mode][3],this._calculateLevels()}},{key:"_calculateLevels",value:function(){for(var P=this._array,M=this.levels=new Array(P.length),O=P.length-1;0<=O;--O)M[O]=Math.round(255*P[O]);this.hsla=null,this.hsba=null}},{key:"_getAlpha",value:function(){return this._array[3]*this.maxes[this.mode][3]}},{key:"_storeModeAndMaxes",value:function(P,M){this.mode=P,this.maxes=M}},{key:"_getMode",value:function(){return this.mode}},{key:"_getMaxes",value:function(){return this.maxes}},{key:"_getBlue",value:function(){return this._array[2]*this.maxes[u.RGB][2]}},{key:"_getBrightness",value:function(){return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[u.HSB][2]}},{key:"_getGreen",value:function(){return this._array[1]*this.maxes[u.RGB][1]}},{key:"_getHue",value:function(){return this.mode===u.HSB?(this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[u.HSB][0]):(this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[u.HSL][0])}},{key:"_getLightness",value:function(){return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[u.HSL][2]}},{key:"_getRed",value:function(){return this._array[0]*this.maxes[u.RGB][0]}},{key:"_getSaturation",value:function(){return this.mode===u.HSB?(this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[u.HSB][1]):(this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[u.HSL][1])}}])&&p(w.prototype,E),j&&p(w,j),S}(),c.default.Color);i.default=x},{"../core/constants":269,"../core/main":280,"./color_conversion":265,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],268:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.fill"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Color"),c.default.prototype.beginClip=function(){this._renderer.beginClip(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{})},c.default.prototype.endClip=function(){this._renderer.endClip()},c.default.prototype.clip=function(d,p){this._renderer.beginClip(p),d(),this._renderer.endClip(p)},c.default.prototype.background=function(){var d;return(d=this._renderer).background.apply(d,arguments),this},c.default.prototype.clear=function(){return this._renderer.clear((arguments.length<=0?void 0:arguments[0])||0,(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0,(arguments.length<=3?void 0:arguments[3])||0),this},c.default.prototype.colorMode=function(d,p,m,g,b){return c.default._validateParameters("colorMode",arguments),d!==u.RGB&&d!==u.HSB&&d!==u.HSL||(this._colorMode=d,d=this._colorMaxes[d],arguments.length===2?(d[0]=p,d[1]=p,d[2]=p,d[3]=p):arguments.length===4?(d[0]=p,d[1]=m,d[2]=g):arguments.length===5&&(d[0]=p,d[1]=m,d[2]=g,d[3]=b)),this},c.default.prototype.fill=function(){var d;return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),(d=this._renderer).fill.apply(d,arguments),this},c.default.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},c.default.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},c.default.prototype.stroke=function(){var d;return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),(d=this._renderer).stroke.apply(d,arguments),this},c.default.prototype.erase=function(){return this._renderer.erase(0<arguments.length&&arguments[0]!==void 0?arguments[0]:255,1<arguments.length&&arguments[1]!==void 0?arguments[1]:255),this},c.default.prototype.noErase=function(){return this._renderer.noErase(),this};var h=c.default;i.default=h},{"../core/constants":269,"../core/main":280,"./p5.Color":267,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],269:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.QUADRATIC=i.LINEAR=i._CTX_MIDDLE=i._DEFAULT_LEADMULT=i._DEFAULT_TEXT_FILL=i.WORD=i.CHAR=i.BOLDITALIC=i.BOLD=i.ITALIC=i.NORMAL=i.BLUR=i.ERODE=i.DILATE=i.POSTERIZE=i.INVERT=i.OPAQUE=i.GRAY=i.THRESHOLD=i.BURN=i.DODGE=i.SOFT_LIGHT=i.HARD_LIGHT=i.OVERLAY=i.REPLACE=i.SCREEN=i.MULTIPLY=i.EXCLUSION=i.SUBTRACT=i.DIFFERENCE=i.LIGHTEST=i.DARKEST=i.ADD=i.REMOVE=i.BLEND=i.UP_ARROW=i.TAB=i.SHIFT=i.RIGHT_ARROW=i.RETURN=i.OPTION=i.LEFT_ARROW=i.ESCAPE=i.ENTER=i.DOWN_ARROW=i.DELETE=i.CONTROL=i.BACKSPACE=i.ALT=i.AUTO=i.HSL=i.HSB=i.RGB=i.MITER=i.BEVEL=i.ROUND=i.SQUARE=i.PROJECT=i.PIE=i.CHORD=i.OPEN=i.CLOSE=i.TESS=i.QUAD_STRIP=i.QUADS=i.TRIANGLE_STRIP=i.TRIANGLE_FAN=i.TRIANGLES=i.LINE_LOOP=i.LINE_STRIP=i.LINES=i.POINTS=i.BASELINE=i.BOTTOM=i.TOP=i.CENTER=i.LEFT=i.RIGHT=i.RADIUS=i.CORNERS=i.CORNER=i.RAD_TO_DEG=i.DEG_TO_RAD=i.RADIANS=i.DEGREES=i.TWO_PI=i.TAU=i.QUARTER_PI=i.PI=i.HALF_PI=i.WAIT=i.TEXT=i.MOVE=i.HAND=i.CROSS=i.ARROW=i.WEBGL2=i.WEBGL=i.P2D=i.VERSION=void 0,i.RGBA=i.HALF_FLOAT=i.FLOAT=i.UNSIGNED_INT=i.UNSIGNED_BYTE=i.COVER=i.CONTAIN=i.FALLBACK=i.LABEL=i.AXES=i.GRID=i._DEFAULT_FILL=i._DEFAULT_STROKE=i.PORTRAIT=i.LANDSCAPE=i.SMOOTH=i.FLAT=i.MIRROR=i.CLAMP=i.REPEAT=i.NEAREST=i.IMAGE=i.IMMEDIATE=i.TEXTURE=i.FILL=i.STROKE=i.CURVE=i.BEZIER=void 0;var a=Math.PI,l=(i.VERSION="1.9.3",i.P2D="p2d",i.WEBGL="webgl",i.WEBGL2="webgl2",i.ARROW="default",i.CROSS="crosshair",i.HAND="pointer",i.MOVE="move",i.TEXT="text",i.WAIT="wait",a/2),l=(i.HALF_PI=l,a),l=(i.PI=l,a/4),l=(i.QUARTER_PI=l,2*a),l=(i.TAU=l,2*a),l=(i.TWO_PI=l,i.DEGREES="degrees",i.RADIANS="radians",a/180),l=(i.DEG_TO_RAD=l,180/a);i.RAD_TO_DEG=l,i.CORNER="corner",i.CORNERS="corners",i.RADIUS="radius",i.RIGHT="right",i.LEFT="left",i.CENTER="center",i.TOP="top",i.BOTTOM="bottom",i.BASELINE="alphabetic",i.POINTS=0,i.LINES=1,i.LINE_STRIP=3,i.LINE_LOOP=2,i.TRIANGLES=4,i.TRIANGLE_FAN=6,i.TRIANGLE_STRIP=5,i.QUADS="quads",i.QUAD_STRIP="quad_strip",i.TESS="tess",i.CLOSE="close",i.OPEN="open",i.CHORD="chord",i.PIE="pie",i.PROJECT="square",i.SQUARE="butt",i.ROUND="round",i.BEVEL="bevel",i.MITER="miter",i.RGB="rgb",i.HSB="hsb",i.HSL="hsl",i.AUTO="auto",i.ALT=18,i.BACKSPACE=8,i.CONTROL=17,i.DELETE=46,i.DOWN_ARROW=40,i.ENTER=13,i.ESCAPE=27,i.LEFT_ARROW=37,i.OPTION=18,i.RETURN=13,i.RIGHT_ARROW=39,i.SHIFT=16,i.TAB=9,i.UP_ARROW=38,i.BLEND="source-over",i.REMOVE="destination-out",i.ADD="lighter",i.DARKEST="darken",i.LIGHTEST="lighten",i.DIFFERENCE="difference",i.SUBTRACT="subtract",i.EXCLUSION="exclusion",i.MULTIPLY="multiply",i.SCREEN="screen",i.REPLACE="copy",i.OVERLAY="overlay",i.HARD_LIGHT="hard-light",i.SOFT_LIGHT="soft-light",i.DODGE="color-dodge",i.BURN="color-burn",i.THRESHOLD="threshold",i.GRAY="gray",i.OPAQUE="opaque",i.INVERT="invert",i.POSTERIZE="posterize",i.DILATE="dilate",i.ERODE="erode",i.BLUR="blur",i.NORMAL="normal",i.ITALIC="italic",i.BOLD="bold",i.BOLDITALIC="bold italic",i.CHAR="CHAR",i.WORD="WORD",i._DEFAULT_TEXT_FILL="#000000",i._DEFAULT_LEADMULT=1.25,i._CTX_MIDDLE="middle",i.LINEAR="linear",i.QUADRATIC="quadratic",i.BEZIER="bezier",i.CURVE="curve",i.STROKE="stroke",i.FILL="fill",i.TEXTURE="texture",i.IMMEDIATE="immediate",i.IMAGE="image",i.NEAREST="nearest",i.REPEAT="repeat",i.CLAMP="clamp",i.MIRROR="mirror",i.FLAT="flat",i.SMOOTH="smooth",i.LANDSCAPE="landscape",i.PORTRAIT="portrait",i._DEFAULT_STROKE="#000000",i._DEFAULT_FILL="#FFFFFF",i.GRID="grid",i.AXES="axes",i.LABEL="label",i.FALLBACK="fallback",i.CONTAIN="contain",i.COVER="cover",i.UNSIGNED_BYTE="unsigned-byte",i.UNSIGNED_INT="unsigned-int",i.FLOAT="float",i.HALF_FLOAT="half-float",i.RGBA="rgba"},{}],270:[function(r,s,i){function a(b){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(b)}function l(b){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(y){return a(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":a(y)})(b)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.search"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.search"),r("core-js/modules/es.string.split"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(u=r("./main"))&&u.__esModule?u:{default:u},u=function(b){if(b&&b.__esModule)return b;if(b===null||l(b)!=="object"&&typeof b!="function")return{default:b};var y=f();if(y&&y.has(b))return y.get(b);var v,x={},S=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(v in b){var w;Object.prototype.hasOwnProperty.call(b,v)&&((w=S?Object.getOwnPropertyDescriptor(b,v):null)&&(w.get||w.set)?Object.defineProperty(x,v,w):x[v]=b[v])}return x.default=b,y&&y.set(b,x),x}(r("./constants"));function f(){var b;return typeof WeakMap!="function"?null:(b=new WeakMap,f=function(){return b},b)}var h=[u.ARROW,u.CROSS,u.HAND,u.MOVE,u.TEXT,u.WAIT],d=(c.default.prototype._frameRate=0,c.default.prototype._lastFrameTime=window.performance.now(),c.default.prototype._targetFrameRate=60,window.print),p=!1;function m(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function g(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}c.default.prototype.print=function(){var b;arguments.length?(b=console).log.apply(b,arguments):p||(d(),window.confirm("You just tried to print the webpage. Do you want to prevent this from running again?")&&(p=!0))},c.default.prototype.frameCount=0,c.default.prototype.deltaTime=0,c.default.prototype.focused=document.hasFocus(),c.default.prototype.cursor=function(b,y,v){var x,S="auto",w=this._curElement.elt;h.includes(b)?S=b:typeof b=="string"&&(x="",y&&v&&typeof y=="number"&&typeof v=="number"&&(x="".concat(y," ").concat(v)),S=b.substring(0,7)==="http://"||b.substring(0,8)==="https://"||/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(b)?"url(".concat(b,") ").concat(x,", auto"):b),w.style.cursor=S},c.default.prototype.frameRate=function(b){return c.default._validateParameters("frameRate",arguments),typeof b!="number"||b<0?this._frameRate:(this._setProperty("_targetFrameRate",b),b===0&&this._setProperty("_frameRate",b),this)},c.default.prototype.getFrameRate=function(){return this.frameRate()},c.default.prototype.setFrameRate=function(b){return this.frameRate(b)},c.default.prototype.getTargetFrameRate=function(){return this._targetFrameRate},c.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},c.default.prototype.webglVersion=u.P2D,c.default.prototype.displayWidth=screen.width,c.default.prototype.displayHeight=screen.height,c.default.prototype.windowWidth=m(),c.default.prototype.windowHeight=g(),c.default.prototype._onresize=function(b){this._setProperty("windowWidth",m()),this._setProperty("windowHeight",g());var y=this._isGlobal?window:this;typeof y.windowResized!="function"||(y=y.windowResized(b))===void 0||y||b.preventDefault()},c.default.prototype.width=0,c.default.prototype.height=0,c.default.prototype.fullscreen=function(b){if(c.default._validateParameters("fullscreen",arguments),b===void 0)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(b){if(b=document.documentElement,!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen&&b.msRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},c.default.prototype.pixelDensity=function(b){var y;return c.default._validateParameters("pixelDensity",arguments),typeof b=="number"?(b!==this._pixelDensity&&(this._pixelDensity=this._maxAllowedPixelDimensions=b),(y=this).resizeCanvas(this.width,this.height,!0)):y=this._pixelDensity,y},c.default.prototype.displayDensity=function(){return window.devicePixelRatio},c.default.prototype.getURL=function(){return location.href},c.default.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(b){return b!==""})},c.default.prototype.getURLParams=function(){for(var b,y=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,v={};(b=y.exec(location.search))!=null;)b.index===y.lastIndex&&y.lastIndex++,v[b[1]]=b[2];return v},r=c.default,i.default=r},{"./constants":269,"./main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.search":202,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],271:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.starts-with"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.starts-with"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(h=r("../main"))&&h.__esModule?h:{default:h};r("../internationalization");function l(d,p){p=p||console.log.bind(console),c||f(),c.some(function(m){var g;if(d.message&&d.message.match("\\W?".concat(m.name,"\\W"))!==null)return g=m.type==="function"?"".concat(m.name,"()"):m.name,p("Did you just try to use p5.js's ".concat(g," ").concat(m.type,`? If so, you may want to move it into your sketch's setup() function.

For more details, see: `).concat(u)),!0})}var c=null,f=null,u=(a.default._friendlyError=a.default._checkForUserDefinedFunctions=a.default._fesErrorMonitor=function(){},c=null,"https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"),f=function(){function d(m){return Object.getOwnPropertyNames(m).filter(function(g){return g[0]!=="_"&&!(g in p)&&(p[g]=!0)}).map(function(g){var b=typeof m[g]=="function"?"function":g===g.toUpperCase()?"constant":"variable";return{name:g,type:b}})}var p={};(c=[].concat(d(a.default.prototype),d(r("../constants")))).sort(function(m,g){return g.name.length-m.name.length})},h=(a.default.prototype._helpForMisusedAtTopLevelCode=l,document.readyState!=="complete"&&(window.addEventListener("error",l,!1),window.addEventListener("load",function(){window.removeEventListener("error",l,!1)})),a.default);i.default=h},{"../constants":269,"../internationalization":278,"../main":280,"./browser_errors":void 0,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.function.name":173,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-names":184,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.starts-with":204,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],272:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(a=r("../main"))&&a.__esModule?a:{default:a};r("../internationalization"),a.default._friendlyFileLoadError=function(){},r=a.default,i.default=r},{"../internationalization":278,"../main":280}],273:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}function l(p){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=h(r("../main"));r("../internationalization"),f(r("../constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var m=u();if(m&&m.has(p))return m.get(p);var g,b,y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&((b=v?Object.getOwnPropertyDescriptor(p,g):null)&&(b.get||b.set)?Object.defineProperty(y,g,b):y[g]=p[g]);return y.default=p,m&&m.set(p,y),y}function h(p){return p&&p.__esModule?p:{default:p}}c.default._fesCodeReader=function(){};var d=c.default;i.default=d},{"../constants":269,"../internationalization":278,"../main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],274:[function(r,s,i){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../main"))&&r.__esModule?r:{default:r};function a(){var l=/(^|@)\S+:\d+/,c=/^\s*at .*(\S+:\d+|\(native\))/m,u=/^(eval@)?(\[native code])?$/;return{parse:function(f){return f.stacktrace!==void 0||f["opera#sourceloc"]!==void 0?this.parseOpera(f):f.stack&&f.stack.match(c)?this.parseV8OrIE(f):f.stack?this.parseFFOrSafari(f):void 0},extractLocation:function(f){return f.indexOf(":")===-1?[f]:[(f=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(f.replace(/[()]/g,"")))[1],f[2]||void 0,f[3]||void 0]},parseV8OrIE:function(f){return f.stack.split(`
`).filter(function(h){return!!h.match(c)},this).map(function(h){var d=(h=-1<h.indexOf("(eval ")?h.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""):h).replace(/^\s+/,"").replace(/\(eval code/g,"("),p=d.match(/ (\((.+):(\d+):(\d+)\)$)/),d=(d=p?d.replace(p[0],""):d).split(/\s+/).slice(1),p=this.extractLocation(p?p[1]:d.pop());return{functionName:d.join(" ")||void 0,fileName:-1<["eval","<anonymous>"].indexOf(p[0])?void 0:p[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)},parseFFOrSafari:function(f){return f.stack.split(`
`).filter(function(h){return!h.match(u)},this).map(function(h){var d,p;return(h=-1<h.indexOf(" > eval")?h.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):h).indexOf("@")===-1&&h.indexOf(":")===-1?{functionName:h}:{functionName:(p=h.match(d=/((.*".+"[^@]*)?[^@]*)(?:@)/))&&p[1]?p[1]:void 0,fileName:(p=this.extractLocation(h.replace(d,"")))[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)},parseOpera:function(f){return!f.stacktrace||-1<f.message.indexOf(`
`)&&f.message.split(`
`).length>f.stacktrace.split(`
`).length?this.parseOpera9(f):f.stack?this.parseOpera11(f):this.parseOpera10(f)},parseOpera9:function(f){for(var h=/Line (\d+).*script (?:in )?(\S+)/i,d=f.message.split(`
`),p=[],m=2,g=d.length;m<g;m+=2){var b=h.exec(d[m]);b&&p.push({fileName:b[2],lineNumber:b[1],source:d[m]})}return p},parseOpera10:function(f){for(var h=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=f.stacktrace.split(`
`),p=[],m=0,g=d.length;m<g;m+=2){var b=h.exec(d[m]);b&&p.push({functionName:b[3]||void 0,fileName:b[2],lineNumber:b[1],source:d[m]})}return p},parseOpera11:function(f){return f.stack.split(`
`).filter(function(h){return!!h.match(l)&&!h.match(/^Error created at/)},this).map(function(h){var d,m=h.split("@"),p=this.extractLocation(m.pop()),m=m.shift()||"";return{functionName:m.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,args:(d=m.match(/\(([^)]*)\)/)?m.replace(/^[^(]+\(([^)]*)\)$/,"$1"):d)===void 0||d==="[arguments not available]"?void 0:d.split(","),fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)}}}r.default._getErrorStackParser=function(){return new a},r=r.default,i.default=r},{"../main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203}],275:[function(r,s,i){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(l=r("../main"))&&l.__esModule?l:{default:l};(function(f){if(!(f&&f.__esModule)&&!(f===null||u(f)!=="object"&&typeof f!="function")){var h=c();if(h&&h.has(f))return h.get(f);var d,p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(d in f){var g;Object.prototype.hasOwnProperty.call(f,d)&&((g=m?Object.getOwnPropertyDescriptor(f,d):null)&&(g.get||g.set)?Object.defineProperty(p,d,g):p[d]=f[d])}p.default=f,h&&h.set(f,p)}})(r("../constants")),r("../internationalization");function c(){var f;return typeof WeakMap!="function"?null:(f=new WeakMap,c=function(){return f},f)}function u(f){return(u=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(h){return a(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":a(h)})(f)}l.default._validateParameters=l.default._clearValidateParamsCache=function(){},r=l.default,i.default=r},{"../../../docs/parameterData.json":void 0,"../constants":269,"../internationalization":278,"../main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.function.name":173,"core-js/modules/es.map":174,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],276:[function(r,s,i){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}function l(f){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(h){return a(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":a(h)})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=function(f){if(f&&f.__esModule)return f;if(f===null||l(f)!=="object"&&typeof f!="function")return{default:f};var h=u();if(h&&h.has(f))return h.get(f);var d,p={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(d in f){var g;Object.prototype.hasOwnProperty.call(f,d)&&((g=m?Object.getOwnPropertyDescriptor(f,d):null)&&(g.get||g.set)?Object.defineProperty(p,d,g):p[d]=f[d])}return p.default=f,h&&h.set(f,p),p}(r("./constants"));function u(){var f;return typeof WeakMap!="function"?null:(f=new WeakMap,u=function(){return f},f)}i.default={modeAdjust:function(f,h,d,p,m){return m===c.CORNER?{x:f,y:h,w:d,h:p}:m===c.CORNERS?{x:f,y:h,w:d-f,h:p-h}:m===c.RADIUS?{x:f-d,y:h-p,w:2*d,h:2*p}:m===c.CENTER?{x:f-.5*d,y:h-.5*p,w:d,h:p}:void 0}}},{"./constants":269,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],277:[function(r,s,i){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var a=(l=r("../core/main"))&&l.__esModule?l:{default:l};r("./internationalization");var l=Promise.resolve();Promise.all([new Promise(function(c,u){document.readyState==="complete"?c():window.addEventListener("load",c,!1)}),l]).then(function(){window._setupDone!==void 0?console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import"):window.mocha||(window.setup&&typeof window.setup=="function"||window.draw&&typeof window.draw=="function")&&!a.default.instance&&new a.default})},{"../core/main":280,"./internationalization":278,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.string.iterator":197,"core-js/modules/web.dom-collections.iterator":243}],278:[function(r,s,i){r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.setTranslatorLanguage=i.currentTranslatorLanguage=i.availableTranslatorLanguages=i.initialize=i.translator=void 0;var a,l,c=f(r("i18next")),u=f(r("i18next-browser-languagedetector"));function f(p){return p&&p.__esModule?p:{default:p}}function h(p,m){for(var g=0;g<m.length;g++){var b=m[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}var d=function(){function p(b,y){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");this.init(b,y)}var m,g;return m=p,(g=[{key:"fetchWithTimeout",value:function(b,y){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:2e3;return Promise.race([fetch(b,y),new Promise(function(x,S){return setTimeout(function(){return S(new Error("timeout"))},v)})])}},{key:"init",value:function(b){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};this.services=b,this.options=y}},{key:"read",value:function(b,y,v){var x=this.options.loadPath;b===this.options.fallback?v(null,a[b][y]):l.includes(b)?(x=this.services.interpolator.interpolate(x,{lng:b,ns:y}),this.loadUrl(x,v)):v("Not found",!1)}},{key:"loadUrl",value:function(b,y){this.fetchWithTimeout(b).then(function(v){if(v.ok)return v.json();throw new Error("failed loading ".concat(b))},function(){throw new Error("failed loading ".concat(b))}).then(function(v){return y(null,v)}).catch(y)}}])&&h(m.prototype,g),p}();d.type="backend",i.translator=function(p,m){console.debug("p5.js translator called before translations were loaded"),c.default.t(p,m)},i.initialize=function(){return c.default.use(u.default).use(d).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:a}).then(function(p){i.translator=p},function(p){return console.debug("Translations failed to load (".concat(p,")"))})},i.availableTranslatorLanguages=function(){return c.default.languages},i.currentTranslatorLanguage=function(p){return c.default.language},i.setTranslatorLanguage=function(p){return c.default.changeLanguage(p||void 0,function(m){return console.debug("Translations failed to load (".concat(m,")"))})}},{"../../translations":void 0,"../../translations/dev":void 0,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/web.dom-collections.iterator":243,i18next:3,"i18next-browser-languagedetector":3}],279:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("./main"))&&r.__esModule?r:{default:r},r.default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},r.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},r.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},r.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},r=r.default,i.default=r},{"./main":280}],280:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}function l(p){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r("./shim");var c=function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var m=u();if(m&&m.has(p))return m.get(p);var g,b={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=y?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,m&&m.set(p,b),b}(r("./constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p,m){for(var g=0;g<m.length;g++){var b=m[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}var h,d=function(){function p(b,x){var v=this;if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");this._setupDone=!1,this._preloadDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._maxAllowedPixelDimensions=0,this._userNode=x,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._startListener=null,this._initializeInstanceVariables(),this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this.touchstart=!1,this.touchend=!1,this._lcg_random_state=null,this._gaussian_previous=!1,this._events.wheel=null,this._loadingScreenId="p5_loading",this._registeredMethods={};var x=Object.getOwnPropertyNames(p.prototype._registeredMethods),S=!0,w=!1,E=void 0;try{for(var j,P=x[Symbol.iterator]();!(S=(j=P.next()).done);S=!0){var M=j.value;this._registeredMethods[M]=p.prototype._registeredMethods[M].slice()}}catch(W){w=!0,E=W}finally{try{S||P.return==null||P.return()}finally{if(w)throw E}}window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),p.prototype.callRegisteredHooksFor=function(W){var V=this||p.prototype,q=this._isGlobal?window:this;if(V._registeredMethods.hasOwnProperty(W)){var V=V._registeredMethods[W],J=!0,W=!1,ae=void 0;try{for(var I,U=V[Symbol.iterator]();!(J=(I=U.next()).done);J=!0){var z=I.value;typeof z=="function"&&z.call(q)}}catch(ne){W=!0,ae=ne}finally{try{J||U.return==null||U.return()}finally{if(W)throw ae}}}},this._start=function(){v._userNode&&typeof v._userNode=="string"&&(v._userNode=document.getElementById(v._userNode));var W=v._isGlobal?window:v;if(W.preload){v.callRegisteredHooksFor("beforePreload");var V,q=document.getElementById(v._loadingScreenId),J=(q||((q=document.createElement("div")).innerHTML="Loading...",q.style.position="absolute",q.id=v._loadingScreenId,(v._userNode||document.body).appendChild(q)),v._preloadMethods);for(V in J){J[V]=J[V]||p;var ae=J[V];ae!==p.prototype&&ae!==p||(v._isGlobal&&(window[V]=v._wrapPreload(v,V)),ae=v),v._registeredPreloadMethods[V]=ae[V],ae[V]=v._wrapPreload(ae,V)}W.preload(),v._runIfPreloadsAreDone()}else v._setup(),v._recording||v._draw()},this._runIfPreloadsAreDone=function(){var W,V=this._isGlobal?window:this;V._preloadCount===0&&((W=document.getElementById(V._loadingScreenId))&&W.parentNode.removeChild(W),this.callRegisteredHooksFor("afterPreload"),this._setupDone||(this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),V._setup(),this._recording||V._draw()))},this._decrementPreload=function(){var W=this._isGlobal?window:this;W._preloadDone||typeof W.preload!="function"||(W._setProperty("_preloadCount",W._preloadCount-1),W._runIfPreloadsAreDone())},this._wrapPreload=function(W,V){var q=this;return function(){q._incrementPreload();for(var J=arguments.length,ae=new Array(J),I=0;I<J;I++)ae[I]=arguments[I];return q._registeredPreloadMethods[V].apply(W,ae)}},this._incrementPreload=function(){var W=this._isGlobal?window:this;W._preloadDone||W._setProperty("_preloadCount",W._preloadCount+1)},this._setup=function(){v.callRegisteredHooksFor("beforeSetup"),v.createCanvas(v._defaultCanvasSize.width,v._defaultCanvasSize.height,"p2d");var W=v._isGlobal?window:v;if(typeof W.preload=="function")for(var V in v._preloadMethods)W[V]=v._preloadMethods[V][V],W[V]&&v&&(W[V]=W[V].bind(v));v._millisStart=window.performance.now(),W._preloadDone=!0,typeof W.setup=="function"&&W.setup();var q=document.getElementsByTagName("canvas"),J=!0,ae=!1,I=void 0;try{for(var U,z=q[Symbol.iterator]();!(J=(U=z.next()).done);J=!0){var K=U.value;K.dataset.hidden==="true"&&(K.style.visibility="",delete K.dataset.hidden)}}catch(te){ae=!0,I=te}finally{try{J||z.return==null||z.return()}finally{if(ae)throw I}}v._lastTargetFrameTime=window.performance.now(),v._lastRealFrameTime=window.performance.now(),v._setupDone=!0,(v._accessibleOutputs.grid||v._accessibleOutputs.text)&&v._updateAccsOutput(),v.callRegisteredHooksFor("afterSetup")},this._draw=function(){var W=window.performance.now(),V=W-v._lastTargetFrameTime,q=1e3/v._targetFrameRate;(!v._loop||q-5<=V)&&(v.deltaTime=W-v._lastRealFrameTime,v._setProperty("deltaTime",v.deltaTime),v._frameRate=1e3/v.deltaTime,v.redraw(),v._lastTargetFrameTime=Math.max(v._lastTargetFrameTime+q,W),v._lastRealFrameTime=W,v._updateMouseCoords!==void 0&&(v._updateMouseCoords(),v._setProperty("movedX",0),v._setProperty("movedY",0))),v._loop&&(v._requestAnimId=window.requestAnimationFrame(v._draw))},this._setProperty=function(W,V){v[W]=V,v._isGlobal&&(window[W]=V)},this.remove=function(){v._startListener&&window.removeEventListener("load",v._startListener,!1);var W=document.getElementById(v._loadingScreenId);if(W&&(W.parentNode.removeChild(W),v._incrementPreload()),v._curElement){for(var V in v._loop=!1,v._requestAnimId&&window.cancelAnimationFrame(v._requestAnimId),v._events)window.removeEventListener(V,v._events[V]);var q=!0,W=!1,J=void 0;try{for(var ae,I=v._elements[Symbol.iterator]();!(q=(ae=I.next()).done);q=!0){var U,z=ae.value;for(U in z.elt&&z.elt.parentNode&&z.elt.parentNode.removeChild(z.elt),z._events)z.elt.removeEventListener(U,z._events[U])}}catch(me){W=!0,J=me}finally{try{q||I.return==null||I.return()}finally{if(W)throw J}}var K=v;v._registeredMethods.remove.forEach(function(me){me!==void 0&&me.call(K)})}if(v._isGlobal){for(var te in p.prototype)try{delete window[te]}catch{window[te]=void 0}for(var ne in v)if(v.hasOwnProperty(ne))try{delete window[ne]}catch{window[ne]=void 0}p.instance=null}},this._registeredMethods.init.forEach(function(W){W!==void 0&&W.call(this)},this),this._setupPromisePreloads();var O,k,F=this._createFriendlyGlobalFunctionBinder();if(b)b(this),p._checkForUserDefinedFunctions(this);else{for(var A in this._isGlobal=!0,p.instance=this,p.prototype)typeof p.prototype[A]=="function"?(O=A.substring(2),this._events.hasOwnProperty(O)||(Math.hasOwnProperty(A)&&Math[A]===p.prototype[A]?F(A,p.prototype[A]):F(A,p.prototype[A].bind(this)))):F(A,p.prototype[A]);for(var N in this)this.hasOwnProperty(N)&&F(N,this[N])}for(k in this._events){var $=this["_on".concat(k)];$&&($=$.bind(this),window.addEventListener(k,$,{passive:!1}),this._events[k]=$)}function G(){v._setProperty("focused",!0)}function X(){v._setProperty("focused",!1)}window.addEventListener("focus",G),window.addEventListener("blur",X),this.registerMethod("remove",function(){window.removeEventListener("focus",G),window.removeEventListener("blur",X)}),document.readyState==="complete"?this._start():(this._startListener=this._start.bind(this),window.addEventListener("load",this._startListener,!1))}var m,g;return m=p,(g=[{key:"_initializeInstanceVariables",value:function(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._bezierDetail=20,this._curveDetail=20,this._colorMode=c.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},this._downKeys={}}},{key:"registerPreloadMethod",value:function(b,y){p.prototype._preloadMethods.hasOwnProperty(b)||(p.prototype._preloadMethods[b]=y)}},{key:"registerMethod",value:function(b,y){var v=this||p.prototype;v._registeredMethods.hasOwnProperty(b)||(v._registeredMethods[b]=[]),v._registeredMethods[b].push(y)}},{key:"unregisterMethod",value:function(b,y){var v=this||p.prototype;if(v._registeredMethods.hasOwnProperty(b)){for(var x=v._registeredMethods[b],S=[],w=0;w<x.length;w++)x[w]===y&&S.push(w);for(var E=S.length-1;0<=E;E--)x.splice(S[E],1)}}},{key:"_createFriendlyGlobalFunctionBinder",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},y=b.globalObject||window;return b.log||console.log.bind(console),function(v,x){p.disableFriendlyErrors,y[v]=x}}}])&&f(m.prototype,g),p}();for(h in d.instance=null,d.disableFriendlyErrors=!1,c)d.prototype[h]=c[h];d.VERSION=c.VERSION,d.prototype._preloadMethods={loadJSON:d.prototype,loadImage:d.prototype,loadStrings:d.prototype,loadXML:d.prototype,loadBytes:d.prototype,loadTable:d.prototype,loadFont:d.prototype,loadModel:d.prototype,loadShader:d.prototype},d.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},d.prototype._registeredPreloadMethods={},i.default=d},{"./constants":269,"./shim":291,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-own-property-names":184,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],281:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("./main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}a.default.Element=function(){function c(d,p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.elt=d,this._pInst=this._pixelsState=p,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight}var u,f,h;return u=c,h=[{key:"_adjustListener",value:function(d,p,m){return p===!1?a.default.Element._detachListener(d,m):a.default.Element._attachListener(d,p,m),this}},{key:"_attachListener",value:function(d,p,m){m._events[d]&&a.default.Element._detachListener(d,m),p=p.bind(m),m.elt.addEventListener(d,p,!1),m._events[d]=p}},{key:"_detachListener",value:function(d,p){var m=p._events[d];p.elt.removeEventListener(d,m,!1),p._events[d]=null}}],(f=[{key:"parent",value:function(d){return d===void 0?this.elt.parentNode:(typeof d=="string"?(d[0]==="#"&&(d=d.substring(1)),d=document.getElementById(d)):d instanceof a.default.Element&&(d=d.elt),d.appendChild(this.elt),this)}},{key:"id",value:function(d){return d===void 0?this.elt.id:(this.elt.id=d,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)}},{key:"class",value:function(d){return d===void 0?this.elt.className:(this.elt.className=d,this)}},{key:"mousePressed",value:function(d){return a.default.Element._adjustListener("mousedown",function(p){return this._pInst._setProperty("mouseIsPressed",!0),this._pInst._setMouseButton(p),d.call(this,p)},this),this}},{key:"doubleClicked",value:function(d){return a.default.Element._adjustListener("dblclick",d,this),this}},{key:"mouseWheel",value:function(d){return a.default.Element._adjustListener("wheel",d,this),this}},{key:"mouseReleased",value:function(d){return a.default.Element._adjustListener("mouseup",d,this),this}},{key:"mouseClicked",value:function(d){return a.default.Element._adjustListener("click",d,this),this}},{key:"mouseMoved",value:function(d){return a.default.Element._adjustListener("mousemove",d,this),this}},{key:"mouseOver",value:function(d){return a.default.Element._adjustListener("mouseover",d,this),this}},{key:"mouseOut",value:function(d){return a.default.Element._adjustListener("mouseout",d,this),this}},{key:"touchStarted",value:function(d){return a.default.Element._adjustListener("touchstart",d,this),this}},{key:"touchMoved",value:function(d){return a.default.Element._adjustListener("touchmove",d,this),this}},{key:"touchEnded",value:function(d){return a.default.Element._adjustListener("touchend",d,this),this}},{key:"dragOver",value:function(d){return a.default.Element._adjustListener("dragover",d,this),this}},{key:"dragLeave",value:function(d){return a.default.Element._adjustListener("dragleave",d,this),this}},{key:"_setProperty",value:function(d,p){this[d]=p}}])&&l(u.prototype,f),h&&l(u,h),c}(),r=a.default.Element,i.default=r},{"./main":280}],282:[function(r,s,i){function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function l(v){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(x){return a(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":a(x)})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-prototype-of"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(y=r("./main"))&&y.__esModule?y:{default:y},u=function(v){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var x=f();if(x&&x.has(v))return x.get(v);var S,w={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in v){var j;Object.prototype.hasOwnProperty.call(v,S)&&((j=E?Object.getOwnPropertyDescriptor(v,S):null)&&(j.get||j.set)?Object.defineProperty(w,S,j):w[S]=v[S])}return w.default=v,x&&x.set(v,w),w}(r("./constants"));function f(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,f=function(){return v},v)}function h(v,x){for(var S=0;S<x.length;S++){var w=x[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function d(v,x){return(d=Object.setPrototypeOf||function(S,w){return S.__proto__=w,S})(v,x)}function p(v){return function(){var x,S=b(v);return m(this,function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(x=b(this).constructor,Reflect.construct(S,arguments,x)):S.apply(this,arguments))}}function m(v,x){return!x||l(x)!=="object"&&typeof x!="function"?g(v):x}function g(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function b(v){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}c.default.Graphics=function(v){var x=w;if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(v&&v.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),v&&d(x,v);var S=p(w);function w(E,j,N,M,O){var k;if(!(this instanceof w))throw new TypeError("Cannot call a class as a function");A=O||document.createElement("canvas"),(k=S.call(this,A,M)).canvas=A;var F,A=N||u.P2D,N=M._userNode||document.body;for(F in O||N.appendChild(k.canvas),c.default.prototype)k[F]||(typeof c.default.prototype[F]=="function"?k[F]=c.default.prototype[F].bind(g(k)):k[F]=c.default.prototype[F]);return c.default.prototype._initializeInstanceVariables.apply(g(k)),k.width=E,k.height=j,k._pixelDensity=M._pixelDensity,A===u.WEBGL?(k._renderer=new c.default.RendererGL(k.canvas,g(k),!1),E=(O=k._renderer._adjustDimensions(E,j)).adjustedWidth,j=O.adjustedHeight):k._renderer=new c.default.Renderer2D(k.canvas,g(k),!1),M._elements.push(g(k)),Object.defineProperty(g(k),"deltaTime",{get:function(){return this._pInst.deltaTime}}),k._renderer.resize(E,j),k._renderer._applyDefaults(),m(k,g(k))}return x=w,(v=[{key:"reset",value:function(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()}},{key:"remove",value:function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);var E,j=this._pInst._elements.indexOf(this);for(E in j!==-1&&this._pInst._elements.splice(j,1),this._events)this.elt.removeEventListener(E,this._events[E])}},{key:"createFramebuffer",value:function(E){return new c.default.Framebuffer(this,E)}}])&&h(x.prototype,v),w}(c.default.Element);var y=c.default.Graphics;i.default=y},{"./constants":269,"./main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],283:[function(r,s,i){function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(b=r("./main"))&&b.__esModule?b:{default:b},c=function(v){if(v&&v.__esModule)return v;if(v===null||f(v)!=="object"&&typeof v!="function")return{default:v};var x=u();if(x&&x.has(v))return x.get(v);var S,w={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in v){var j;Object.prototype.hasOwnProperty.call(v,S)&&((j=E?Object.getOwnPropertyDescriptor(v,S):null)&&(j.get||j.set)?Object.defineProperty(w,S,j):w[S]=v[S])}return w.default=v,x&&x.set(v,w),w}(r("../core/constants"));function u(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,u=function(){return v},v)}function f(v){return(f=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(x){return a(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":a(x)})(v)}function h(v,x){for(var S=0;S<x.length;S++){var w=x[S];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function d(v,x){return(d=Object.setPrototypeOf||function(S,w){return S.__proto__=w,S})(v,x)}function p(v){return function(){var x,S,w=g(v);return x=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(x=g(this).constructor,Reflect.construct(w,arguments,x)):w.apply(this,arguments),w=this,!(S=x)||f(S)!=="object"&&typeof S!="function"?m(w):S}}function m(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function g(v){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}var b=function(v){var x=w;if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(v&&v.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),v&&d(x,v);var S=p(w);function w(E,j,P){var M;if(this instanceof w)return(M=S.call(this,E,j)).canvas=E,M._pixelsState=j,P?(M._isMainCanvas=!0,M._pInst._setProperty("_curElement",m(M)),M._pInst._setProperty("canvas",M.canvas),M._pInst._setProperty("width",M.width),M._pInst._setProperty("height",M.height)):(M.canvas.style.display="none",M._styles=[]),M._clipping=!1,M._clipInvert=!1,M._textSize=12,M._textLeading=15,M._textFont="sans-serif",M._textStyle=c.NORMAL,M._textAscent=null,M._textDescent=null,M._textAlign=c.LEFT,M._textBaseline=c.BASELINE,M._textWrap=c.WORD,M._rectMode=c.CORNER,M._ellipseMode=c.CENTER,M._curveTightness=0,M._imageMode=c.CORNER,M._tint=null,M._doStroke=!0,M._doFill=!0,M._strokeSet=!1,M._fillSet=!1,M._leadingSet=!1,M._pushPopDepth=0,M;throw new TypeError("Cannot call a class as a function")}return x=w,(v=[{key:"push",value:function(){return this._pushPopDepth++,{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}}},{key:"pop",value:function(E){this._pushPopDepth--,E.properties&&Object.assign(this,E.properties)}},{key:"beginClip",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};if(this._clipping)throw new Error("It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?");this._clipping=!0,this._clipInvert=E.invert}},{key:"endClip",value:function(){if(!this._clipping)throw new Error("It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?");this._clipping=!1}},{key:"resize",value:function(E,j){this.width=E,this.height=j,this.elt.width=E*this._pInst._pixelDensity,this.elt.height=j*this._pInst._pixelDensity,this.elt.style.width="".concat(E,"px"),this.elt.style.height="".concat(j,"px"),this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))}},{key:"get",value:function(E,j,P,M){var O=this._pixelsState,k=O._pixelDensity,F=this.canvas;if(E===void 0&&j===void 0)E=j=0,P=O.width,M=O.height;else if(E*=k,j*=k,P===void 0&&M===void 0)return E<0||j<0||E>=F.width||j>=F.height?[0,0,0,0]:this._getPixel(E,j);return O=new l.default.Image(P*k,M*k),O.pixelDensity(k),O.canvas.getContext("2d").drawImage(F,E,j,P*k,M*k,0,0,P*k,M*k),O}},{key:"textLeading",value:function(E){return typeof E=="number"?(this._setProperty("_leadingSet",!0),this._setProperty("_textLeading",E),this._pInst):this._textLeading}},{key:"textStyle",value:function(E){return E?(E!==c.NORMAL&&E!==c.ITALIC&&E!==c.BOLD&&E!==c.BOLDITALIC||this._setProperty("_textStyle",E),this._applyTextProperties()):this._textStyle}},{key:"textAscent",value:function(){return this._textAscent===null&&this._updateTextMetrics(),this._textAscent}},{key:"textDescent",value:function(){return this._textDescent===null&&this._updateTextMetrics(),this._textDescent}},{key:"textAlign",value:function(E,j){return E!==void 0?(this._setProperty("_textAlign",E),j!==void 0&&this._setProperty("_textBaseline",j),this._applyTextProperties()):{horizontal:this._textAlign,vertical:this._textBaseline}}},{key:"textWrap",value:function(E){return this._setProperty("_textWrap",E),this._textWrap}},{key:"text",value:function(E,j,P,M,O){var k,F,A,N,$=this._pInst,G=this._textWrap,X=Number.MAX_VALUE,W=P;if((this._doFill||this._doStroke)&&E!==void 0){if(k=(E=(E=typeof E!="string"?E.toString():E).replace(/(\t)/g,"  ")).split(`
`),M!==void 0){switch(this._rectMode===c.CENTER&&(j-=M/2),this._textAlign){case c.CENTER:j+=M/2;break;case c.RIGHT:j+=M}if(O!==void 0){this._rectMode===c.CENTER&&(P-=O/2,W-=O/2);var E=P,V=$.textAscent();switch(this._textBaseline){case c.BOTTOM:N=P+O,P=Math.max(N,P),W+=V;break;case c.CENTER:N=P+O/2,P=Math.max(N,P),W+=V/2}X=P+O-V,this._textBaseline===c.CENTER&&(X=E+O-V/2)}else this._textBaseline!==c.BOTTOM&&this._textBaseline!==c.CENTER||(W=P-(E=$.textSize()*this._textLeading)/2,X=P+E/2);if(G===c.WORD){for(var q=[],J=0;J<k.length;J++){for(var ae="",I=k[J].split(" "),U=0;U<I.length;U++)F="".concat(ae+I[U])+" ",ae=M<(A=this.textWidth(F))&&0<ae.length?(q.push(ae),"".concat(I[U])+" "):F;q.push(ae)}var z=0;this._textBaseline===c.CENTER?z=(q.length-1)*$.textLeading()/2:this._textBaseline===c.BOTTOM&&(z=(q.length-1)*$.textLeading());for(var K=0;K<k.length;K++){ae="",I=k[K].split(" ");for(var te=0;te<I.length;te++)F="".concat(ae+I[te])+" ",M<(A=this.textWidth(F))&&0<ae.length?(this._renderText($,ae.trim(),j,P-z,X,W),ae="".concat(I[te])+" ",P+=$.textLeading()):ae=F;this._renderText($,ae.trim(),j,P-z,X,W),P+=$.textLeading()}}else{for(var ne=[],le=0;le<k.length;le++)for(var me=k[le].split(ae=""),ce=0;ce<me.length;ce++)F="".concat(ae+me[ce]),(A=this.textWidth(F))<=M?ae+=me[ce]:M<A&&0<ae.length&&(ne.push(ae),ae="".concat(me[ce]));ne.push(ae);var ge=0;this._textBaseline===c.CENTER?ge=(ne.length-1)*$.textLeading()/2:this._textBaseline===c.BOTTOM&&(ge=(ne.length-1)*$.textLeading());for(var pe=0;pe<k.length;pe++){me=k[pe].split(ae="");for(var oe=0;oe<me.length;oe++)F="".concat(ae+me[oe]),(A=this.textWidth(F))<=M?ae+=me[oe]:M<A&&0<ae.length&&(this._renderText($,ae.trim(),j,P-ge,X,W),P+=$.textLeading(),ae="".concat(me[oe]))}this._renderText($,ae.trim(),j,P-ge,X,W),P+=$.textLeading()}}else{var de=0;this._textBaseline===c.CENTER?de=(k.length-1)*$.textLeading()/2:this._textBaseline===c.BOTTOM&&(de=(k.length-1)*$.textLeading());for(var xe=0;xe<k.length;xe++)this._renderText($,k[xe],j,P-de,X,W-de),P+=$.textLeading()}return $}}},{key:"_applyDefaults",value:function(){return this}},{key:"_isOpenType",value:function(){var E=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this._textFont;return f(E)==="object"&&E.font&&E.font.supported}},{key:"_updateTextMetrics",value:function(){var E,j,P,M,O,k;return this._isOpenType()?(this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent())):((E=document.createElement("span")).style.fontFamily=this._textFont,E.style.fontSize="".concat(this._textSize,"px"),E.innerHTML="ABCjgq|",(k=document.createElement("div")).style.display="inline-block",k.style.width="1px",k.style.height="0px",M=((j=document.createElement("div")).appendChild(E),j.appendChild(k),j.style.height="0px",j.style.overflow="hidden",document.body.appendChild(j),k.style.verticalAlign="baseline",y(k)),O=y(E),P=M[1]-O[1],M=(k.style.verticalAlign="bottom",y(k)),O=y(E),k=M[1]-O[1]-P,document.body.removeChild(j),this._setProperty("_textAscent",P),this._setProperty("_textDescent",k)),this}}])&&h(x.prototype,v),w}(l.default.Element);function y(v){var x=0,S=0;if(v.offsetParent)for(;x+=v.offsetLeft,S+=v.offsetTop,v=v.offsetParent;);else x+=v.offsetLeft,S+=v.offsetTop;return[x,S]}b.prototype.textSize=function(v){return typeof v=="number"?(this._setProperty("_textSize",v),this._leadingSet||this._setProperty("_textLeading",v*c._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},l.default.Renderer=b,r=l.default.Renderer,i.default=r},{"../core/constants":269,"./main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],284:[function(v,s,i){function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(x)}function l(x){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(S){return a(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":a(S)})(x)}v("core-js/modules/es.symbol"),v("core-js/modules/es.symbol.description"),v("core-js/modules/es.symbol.iterator"),v("core-js/modules/es.array.concat"),v("core-js/modules/es.array.fill"),v("core-js/modules/es.array.for-each"),v("core-js/modules/es.array.iterator"),v("core-js/modules/es.array.join"),v("core-js/modules/es.array.slice"),v("core-js/modules/es.function.name"),v("core-js/modules/es.number.to-fixed"),v("core-js/modules/es.object.get-own-property-descriptor"),v("core-js/modules/es.object.get-prototype-of"),v("core-js/modules/es.object.to-string"),v("core-js/modules/es.reflect.construct"),v("core-js/modules/es.reflect.get"),v("core-js/modules/es.regexp.exec"),v("core-js/modules/es.regexp.to-string"),v("core-js/modules/es.string.iterator"),v("core-js/modules/es.weak-map"),v("core-js/modules/web.dom-collections.iterator"),v("core-js/modules/es.array.concat"),v("core-js/modules/es.array.fill"),v("core-js/modules/es.array.for-each"),v("core-js/modules/es.array.join"),v("core-js/modules/es.array.slice"),v("core-js/modules/es.function.name"),v("core-js/modules/es.number.to-fixed"),v("core-js/modules/es.object.get-prototype-of"),v("core-js/modules/es.object.to-string"),v("core-js/modules/es.regexp.exec"),v("core-js/modules/es.regexp.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(y=v("./main"))&&y.__esModule?y:{default:y},u=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var S=f();if(S&&S.has(x))return S.get(x);var w,E={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in x){var P;Object.prototype.hasOwnProperty.call(x,w)&&((P=j?Object.getOwnPropertyDescriptor(x,w):null)&&(P.get||P.set)?Object.defineProperty(E,w,P):E[w]=x[w])}return E.default=x,S&&S.set(x,E),E}(v("./constants"));function f(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,f=function(){return x},x)}function h(x,S){for(var w=0;w<S.length;w++){var E=S[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}function d(x,S,w){return(d=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(M,j,P){var M=function(O,k){for(;!Object.prototype.hasOwnProperty.call(O,k)&&(O=g(O))!==null;);return O}(M,j);if(M)return(M=Object.getOwnPropertyDescriptor(M,j)).get?M.get.call(P):M.value})(x,S,w||x)}function p(x,S){return(p=Object.setPrototypeOf||function(w,E){return w.__proto__=E,w})(x,S)}function m(x){return function(){var S,w=g(x),w=(S=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(S=g(this).constructor,Reflect.construct(w,arguments,S)):w.apply(this,arguments),this);if(!S||l(S)!=="object"&&typeof S!="function"){if(w!==void 0)return w;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return S}}function g(x){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)})(x)}v("./p5.Renderer");var b="rgba(0,0,0,0)",y=function(x){var S=E;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(x&&x.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),x&&p(S,x);var w=m(E);function E(j,P,M){if(this instanceof E)return(j=w.call(this,j,P,M)).drawingContext=j.canvas.getContext("2d"),j._pInst._setProperty("drawingContext",j.drawingContext),j;throw new TypeError("Cannot call a class as a function")}return S=E,(x=[{key:"getFilterGraphicsLayer",value:function(){var j;return this.filterGraphicsLayer||(j=(this._pInst instanceof c.default.Graphics?this._pInst:this)._pInst,this.filterGraphicsLayer=new c.default.Graphics(this.width,this.height,u.WEBGL,j)),this.filterGraphicsLayer.width===this.width&&this.filterGraphicsLayer.height===this.height||this.filterGraphicsLayer.resizeCanvas(this.width,this.height),this.filterGraphicsLayer.pixelDensity()!==this._pInst.pixelDensity()&&this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity()),this.filterGraphicsLayer}},{key:"_applyDefaults",value:function(){this._cachedFillStyle=this._cachedStrokeStyle=void 0,this._cachedBlendMode=u.BLEND,this._setFill(u._DEFAULT_FILL),this._setStroke(u._DEFAULT_STROKE),this.drawingContext.lineCap=u.ROUND,this.drawingContext.font="normal 12px sans-serif"}},{key:"resize",value:function(j,P){d(g(E.prototype),"resize",this).call(this,j,P),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)}},{key:"background",value:function(){var j,P;this.drawingContext.save(),this.resetMatrix(),(arguments.length<=0?void 0:arguments[0])instanceof c.default.Image?0<=(arguments.length<=1?void 0:arguments[1])?(j=arguments.length<=0?void 0:arguments[0],this.drawingContext.globalAlpha=(arguments.length<=1?void 0:arguments[1])/255,this._pInst.image(j,0,0,this.width,this.height)):this._pInst.image(arguments.length<=0?void 0:arguments[0],0,0,this.width,this.height):(j=this._getFill(),P=(P=this._pInst).color.apply(P,arguments),this._pInst._addAccsOutput()&&this._pInst._accsBackground(P.levels),P=P.toString(),this._setFill(P),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(j),this._isErasing&&this._pInst.erase()),this.drawingContext.restore()}},{key:"clear",value:function(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()}},{key:"fill",value:function(){var j=(j=this._pInst).color.apply(j,arguments);this._setFill(j.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",j.levels)}},{key:"stroke",value:function(){var j=(j=this._pInst).color.apply(j,arguments);this._setStroke(j.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",j.levels)}},{key:"erase",value:function(j,P){this._isErasing||(this._cachedFillStyle=this.drawingContext.fillStyle,j=this._pInst.color(255,j).toString(),this.drawingContext.fillStyle=j,this._cachedStrokeStyle=this.drawingContext.strokeStyle,j=this._pInst.color(255,P).toString(),this.drawingContext.strokeStyle=j,P=this._cachedBlendMode,this.blendMode(u.REMOVE),this._cachedBlendMode=P,this._isErasing=!0)}},{key:"noErase",value:function(){this._isErasing&&(this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)}},{key:"beginClip",value:function(){var j=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},j=(d(g(E.prototype),"beginClip",this).call(this,j),this._cachedFillStyle=this.drawingContext.fillStyle,this._pInst.color(255,0).toString()),j=(this.drawingContext.fillStyle=j,this._cachedStrokeStyle=this.drawingContext.strokeStyle,this._pInst.color(255,0).toString()),j=(this.drawingContext.strokeStyle=j,this._cachedBlendMode);this.blendMode(u.BLEND),this._cachedBlendMode=j,this.drawingContext.beginPath(),this._clipInvert&&(this.drawingContext.moveTo(-2*this.width,-2*this.height),this.drawingContext.lineTo(-2*this.width,2*this.height),this.drawingContext.lineTo(2*this.width,2*this.height),this.drawingContext.lineTo(2*this.width,-2*this.height),this.drawingContext.closePath())}},{key:"endClip",value:function(){this._doFillStrokeClose(),this.drawingContext.clip(),d(g(E.prototype),"endClip",this).call(this),this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode)}},{key:"image",value:function(j,P,M,O,k,F,A,N,$){j.gifProperties&&j._animateGif(this._pInst);try{c.default.MediaElement&&j instanceof c.default.MediaElement&&j._ensureCanvas();var G=(G=this._tint&&j.canvas?this._getTintedImageCanvas(j):G)||j.canvas||j.elt,X=1;j.width&&0<j.width&&(X=G.width/j.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(G,X*P,X*M,X*O,X*k,F,A,N,$),this._isErasing&&this._pInst.erase()}catch(W){if(W.name!=="NS_ERROR_NOT_AVAILABLE")throw W}}},{key:"_getTintedImageCanvas",value:function(j){if(!j.canvas)return j;j.tintCanvas||(j.tintCanvas=document.createElement("canvas")),j.tintCanvas.width!==j.canvas.width&&(j.tintCanvas.width=j.canvas.width),j.tintCanvas.height!==j.canvas.height&&(j.tintCanvas.height=j.canvas.height);var P=j.tintCanvas.getContext("2d");return P.save(),P.clearRect(0,0,j.canvas.width,j.canvas.height),(this._tint[0]<255||this._tint[1]<255||this._tint[2]<255)&&(P.drawImage(j.canvas,0,0),P.globalCompositeOperation="luminosity",P.drawImage(j.canvas,0,0),P.globalCompositeOperation="color",P.drawImage(j.canvas,0,0),P.globalCompositeOperation="multiply",P.fillStyle="rgb(".concat(this._tint.slice(0,3).join(", "),")"),P.fillRect(0,0,j.canvas.width,j.canvas.height),P.globalCompositeOperation="destination-in"),P.globalAlpha=this._tint[3]/255,P.drawImage(j.canvas,0,0),P.restore(),j.tintCanvas}},{key:"blendMode",value:function(j){if(j===u.SUBTRACT)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else{if(j!==u.BLEND&&j!==u.REMOVE&&j!==u.DARKEST&&j!==u.LIGHTEST&&j!==u.DIFFERENCE&&j!==u.MULTIPLY&&j!==u.EXCLUSION&&j!==u.SCREEN&&j!==u.REPLACE&&j!==u.OVERLAY&&j!==u.HARD_LIGHT&&j!==u.SOFT_LIGHT&&j!==u.DODGE&&j!==u.BURN&&j!==u.ADD)throw new Error("Mode ".concat(j," not recognized."));this._cachedBlendMode=j,this.drawingContext.globalCompositeOperation=j}}},{key:"blend",value:function(){for(var j=this.drawingContext.globalCompositeOperation,P=arguments.length,M=new Array(P),O=0;O<P;O++)M[O]=arguments[O];var k=M[M.length-1],F=Array.prototype.slice.call(M,0,M.length-1);this.drawingContext.globalCompositeOperation=k,c.default.prototype.copy.apply(this,F),this.drawingContext.globalCompositeOperation=j}},{key:"_getPixel",value:function(j,P){return j=this.drawingContext.getImageData(j,P,1,1).data,[j[0],j[1],j[2],j[3]]}},{key:"loadPixels",value:function(){var j=this._pixelsState,P=j._pixelDensity,M=this.width*P,P=this.height*P,M=this.drawingContext.getImageData(0,0,M,P);j._setProperty("imageData",M),j._setProperty("pixels",M.data)}},{key:"set",value:function(j,P,M){j=Math.floor(j),P=Math.floor(P);var O=this._pixelsState;if(M instanceof c.default.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(O._pixelDensity,O._pixelDensity),this.drawingContext.clearRect(j,P,M.width,M.height),this.drawingContext.drawImage(M.canvas,j,P),this.drawingContext.restore();else{var k=0,F=0,A=0,N=0,$=4*(P*O._pixelDensity*(this.width*O._pixelDensity)+j*O._pixelDensity);if(O.imageData||O.loadPixels(),typeof M=="number")$<O.pixels.length&&(A=F=k=M,N=255);else if(Array.isArray(M)){if(M.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");$<O.pixels.length&&(k=M[0],F=M[1],A=M[2],N=M[3])}else M instanceof c.default.Color&&$<O.pixels.length&&(k=M.levels[0],F=M.levels[1],A=M.levels[2],N=M.levels[3]);for(var G=0;G<O._pixelDensity;G++)for(var X=0;X<O._pixelDensity;X++)$=4*((P*O._pixelDensity+X)*this.width*O._pixelDensity+(j*O._pixelDensity+G)),O.pixels[$]=k,O.pixels[$+1]=F,O.pixels[$+2]=A,O.pixels[$+3]=N}}},{key:"updatePixels",value:function(j,P,M,O){var k=this._pixelsState,F=k._pixelDensity;j===void 0&&P===void 0&&M===void 0&&O===void 0&&(P=j=0,M=this.width,O=this.height),j*=F,P*=F,M*=F,O*=F,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=k.imageData),this.drawingContext.putImageData(k.imageData,j,P,0,0,M,O)}},{key:"_acuteArcToBezier",value:function(j,P){var F=P/2,M=Math.cos(F),N=Math.sin(F),O=1/Math.tan(F),F=j+F,k=Math.cos(F),F=Math.sin(F),A=(4-M)/3,N=N+(M-A)*O;return{ax:Math.cos(j).toFixed(7),ay:Math.sin(j).toFixed(7),bx:(A*k+N*F).toFixed(7),by:(A*F-N*k).toFixed(7),cx:(A*k-N*F).toFixed(7),cy:(A*F+N*k).toFixed(7),dx:Math.cos(j+P).toFixed(7),dy:Math.sin(j+P).toFixed(7)}}},{key:"arc",value:function(j,P,M,O,k,F,A){var N,$=this.drawingContext,G=M/2,X=O/2,W=[];for(j+=G,P+=X;1e-5<=F-k;)N=Math.min(F-k,u.HALF_PI),W.push(this._acuteArcToBezier(k,N)),k+=N;return this._doFill&&(this._clipping||$.beginPath(),W.forEach(function(V,q){q===0&&$.moveTo(j+V.ax*G,P+V.ay*X),$.bezierCurveTo(j+V.bx*G,P+V.by*X,j+V.cx*G,P+V.cy*X,j+V.dx*G,P+V.dy*X)}),A!==u.PIE&&A!=null||$.lineTo(j,P),$.closePath(),this._clipping||$.fill()),this._doStroke&&(this._clipping||$.beginPath(),W.forEach(function(V,q){q===0&&$.moveTo(j+V.ax*G,P+V.ay*X),$.bezierCurveTo(j+V.bx*G,P+V.by*X,j+V.cx*G,P+V.cy*X,j+V.dx*G,P+V.dy*X)}),A===u.PIE?($.lineTo(j,P),$.closePath()):A===u.CHORD&&$.closePath(),this._clipping||$.stroke()),this}},{key:"ellipse",value:function(N){var P=this.drawingContext,M=this._doFill,O=this._doStroke,k=parseFloat(N[0]),F=parseFloat(N[1]),A=parseFloat(N[2]),N=parseFloat(N[3]);if(M&&!O){if(this._getFill()===b)return this}else if(!M&&O&&this._getStroke()===b)return this;k+=A/2,F+=N/2,A/=2,N/=2,this._clipping||P.beginPath(),P.ellipse(k,F,A,N,0,0,2*Math.PI),!this._clipping&&M&&P.fill(),!this._clipping&&O&&P.stroke()}},{key:"line",value:function(j,P,M,O){var k=this.drawingContext;return this._doStroke&&this._getStroke()!==b&&(this._clipping||k.beginPath(),k.moveTo(j,P),k.lineTo(M,O),k.stroke()),this}},{key:"point",value:function(j,P){var M,O,k=this.drawingContext;return!this._doStroke||this._getStroke()===b?this:(M=this._getStroke(),O=this._getFill(),this._clipping||this._setFill(M),this._clipping||k.beginPath(),k.arc(j,P,k.lineWidth/2,0,u.TWO_PI,!1),void(this._clipping||(k.fill(),this._setFill(O))))}},{key:"quad",value:function(j,P,M,O,k,F,A,N){var $=this.drawingContext,G=this._doFill,X=this._doStroke;if(G&&!X){if(this._getFill()===b)return this}else if(!G&&X&&this._getStroke()===b)return this;return this._clipping||$.beginPath(),$.moveTo(j,P),$.lineTo(M,O),$.lineTo(k,F),$.lineTo(A,N),$.closePath(),!this._clipping&&G&&$.fill(),!this._clipping&&X&&$.stroke(),this}},{key:"rect",value:function(X){var P,M,O=X[0],k=X[1],F=X[2],A=X[3],N=X[4],$=X[5],G=X[6],X=X[7],W=this.drawingContext,V=this._doFill,q=this._doStroke;if(V&&!q){if(this._getFill()===b)return this}else if(!V&&q&&this._getStroke()===b)return this;return this._clipping||W.beginPath(),N===void 0?W.rect(O,k,F,A):($===void 0&&($=N),G===void 0&&(G=$),X===void 0&&(X=G),q=(V=Math.abs(F))/2,M=(P=Math.abs(A))/2,P<2*(N=V<2*N?q:N)&&(N=M),P<2*($=V<2*$?q:$)&&($=M),P<2*(G=V<2*G?q:G)&&(G=M),P<2*(X=V<2*X?q:X)&&(X=M),this._clipping||W.beginPath(),W.moveTo(O+N,k),W.arcTo(O+F,k,O+F,k+A,$),W.arcTo(O+F,k+A,O,k+A,G),W.arcTo(O,k+A,O,k,X),W.arcTo(O,k,O+F,k,N),W.closePath()),!this._clipping&&this._doFill&&W.fill(),!this._clipping&&this._doStroke&&W.stroke(),this}},{key:"triangle",value:function(G){var P=this.drawingContext,M=this._doFill,O=this._doStroke,k=G[0],F=G[1],A=G[2],N=G[3],$=G[4],G=G[5];if(M&&!O){if(this._getFill()===b)return this}else if(!M&&O&&this._getStroke()===b)return this;this._clipping||P.beginPath(),P.moveTo(k,F),P.lineTo(A,N),P.lineTo($,G),P.closePath(),!this._clipping&&M&&P.fill(),!this._clipping&&O&&P.stroke()}},{key:"endShape",value:function(j,P,M,O,k,F,A){if(P.length!==0&&(this._doStroke||this._doFill)){var N,$,G,X=j===u.CLOSE,W=(X&&!F&&P.push(P[0]),P.length);if(M&&A===null){if(3<W){var V=[],q=1-this._curveTightness;for(this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(P[1][0],P[1][1]),$=1;$+2<W;$++)N=P[$],V[0]=[N[0],N[1]],V[1]=[N[0]+(q*P[$+1][0]-q*P[$-1][0])/6,N[1]+(q*P[$+1][1]-q*P[$-1][1])/6],V[2]=[P[$+1][0]+(q*P[$][0]-q*P[$+2][0])/6,P[$+1][1]+(q*P[$][1]-q*P[$+2][1])/6],V[3]=[P[$+1][0],P[$+1][1]],this.drawingContext.bezierCurveTo(V[1][0],V[1][1],V[2][0],V[2][1],V[3][0],V[3][1]);X&&this.drawingContext.lineTo(P[$+1][0],P[$+1][1]),this._doFillStrokeClose(X)}}else if(O&&A===null){for(this._clipping||this.drawingContext.beginPath(),$=0;$<W;$++)P[$].isVert?P[$].moveTo?this.drawingContext.moveTo(P[$][0],P[$][1]):this.drawingContext.lineTo(P[$][0],P[$][1]):this.drawingContext.bezierCurveTo(P[$][0],P[$][1],P[$][2],P[$][3],P[$][4],P[$][5]);this._doFillStrokeClose(X)}else if(k&&A===null){for(this._clipping||this.drawingContext.beginPath(),$=0;$<W;$++)P[$].isVert?P[$].moveTo?this.drawingContext.moveTo(P[$][0],P[$][1]):this.drawingContext.lineTo(P[$][0],P[$][1]):this.drawingContext.quadraticCurveTo(P[$][0],P[$][1],P[$][2],P[$][3]);this._doFillStrokeClose(X)}else if(A===u.POINTS)for($=0;$<W;$++)N=P[$],this._doStroke&&this._pInst.stroke(N[6]),this._pInst.point(N[0],N[1]);else if(A===u.LINES)for($=0;$+1<W;$+=2)N=P[$],this._doStroke&&this._pInst.stroke(P[$+1][6]),this._pInst.line(N[0],N[1],P[$+1][0],P[$+1][1]);else if(A===u.TRIANGLES)for($=0;$+2<W;$+=3)N=P[$],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(N[0],N[1]),this.drawingContext.lineTo(P[$+1][0],P[$+1][1]),this.drawingContext.lineTo(P[$+2][0],P[$+2][1]),this.drawingContext.closePath(),!this._clipping&&this._doFill&&(this._pInst.fill(P[$+2][5]),this.drawingContext.fill()),!this._clipping&&this._doStroke&&(this._pInst.stroke(P[$+2][6]),this.drawingContext.stroke());else if(A===u.TRIANGLE_STRIP)for($=0;$+1<W;$++)N=P[$],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(P[$+1][0],P[$+1][1]),this.drawingContext.lineTo(N[0],N[1]),!this._clipping&&this._doStroke&&this._pInst.stroke(P[$+1][6]),!this._clipping&&this._doFill&&this._pInst.fill(P[$+1][5]),$+2<W&&(this.drawingContext.lineTo(P[$+2][0],P[$+2][1]),!this._clipping&&this._doStroke&&this._pInst.stroke(P[$+2][6]),!this._clipping&&this._doFill&&this._pInst.fill(P[$+2][5])),this._doFillStrokeClose(X);else if(A===u.TRIANGLE_FAN){if(2<W){for(this._clipping||this.drawingContext.beginPath(),$=2;$<W;$++)N=P[$],this.drawingContext.moveTo(P[0][0],P[0][1]),this.drawingContext.lineTo(P[$-1][0],P[$-1][1]),this.drawingContext.lineTo(N[0],N[1]),this.drawingContext.lineTo(P[0][0],P[0][1]),$<W-1&&(this._doFill&&N[5]!==P[$+1][5]||this._doStroke&&N[6]!==P[$+1][6])&&(!this._clipping&&this._doFill&&(this._pInst.fill(N[5]),this.drawingContext.fill(),this._pInst.fill(P[$+1][5])),!this._clipping&&this._doStroke&&(this._pInst.stroke(N[6]),this.drawingContext.stroke(),this._pInst.stroke(P[$+1][6])),this.drawingContext.closePath(),this._clipping||this.drawingContext.beginPath());this._doFillStrokeClose(X)}}else if(A===u.QUADS)for($=0;$+3<W;$+=4){for(N=P[$],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(N[0],N[1]),G=1;G<4;G++)this.drawingContext.lineTo(P[$+G][0],P[$+G][1]);this.drawingContext.lineTo(N[0],N[1]),!this._clipping&&this._doFill&&this._pInst.fill(P[$+3][5]),!this._clipping&&this._doStroke&&this._pInst.stroke(P[$+3][6]),this._doFillStrokeClose(X)}else if(A===u.QUAD_STRIP){if(3<W)for($=0;$+1<W;$+=2)N=P[$],this._clipping||this.drawingContext.beginPath(),$+3<W?(this.drawingContext.moveTo(P[$+2][0],P[$+2][1]),this.drawingContext.lineTo(N[0],N[1]),this.drawingContext.lineTo(P[$+1][0],P[$+1][1]),this.drawingContext.lineTo(P[$+3][0],P[$+3][1]),!this._clipping&&this._doFill&&this._pInst.fill(P[$+3][5]),!this._clipping&&this._doStroke&&this._pInst.stroke(P[$+3][6])):(this.drawingContext.moveTo(N[0],N[1]),this.drawingContext.lineTo(P[$+1][0],P[$+1][1])),this._doFillStrokeClose(X)}else{for(this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(P[0][0],P[0][1]),$=1;$<W;$++)(N=P[$]).isVert&&(N.moveTo?(X&&this.drawingContext.closePath(),this.drawingContext.moveTo(N[0],N[1])):this.drawingContext.lineTo(N[0],N[1]));this._doFillStrokeClose(X)}F=k=O=M=!1,X&&P.pop()}return this}},{key:"strokeCap",value:function(j){return j!==u.ROUND&&j!==u.SQUARE&&j!==u.PROJECT||(this.drawingContext.lineCap=j),this}},{key:"strokeJoin",value:function(j){return j!==u.ROUND&&j!==u.BEVEL&&j!==u.MITER||(this.drawingContext.lineJoin=j),this}},{key:"strokeWeight",value:function(j){return this.drawingContext.lineWidth=j===void 0||j===0?1e-4:j,this}},{key:"_getFill",value:function(){return this._cachedFillStyle||(this._cachedFillStyle=this.drawingContext.fillStyle),this._cachedFillStyle}},{key:"_setFill",value:function(j){j!==this._cachedFillStyle&&(this.drawingContext.fillStyle=j,this._cachedFillStyle=j)}},{key:"_getStroke",value:function(){return this._cachedStrokeStyle||(this._cachedStrokeStyle=this.drawingContext.strokeStyle),this._cachedStrokeStyle}},{key:"_setStroke",value:function(j){j!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=j,this._cachedStrokeStyle=j)}},{key:"bezier",value:function(j,P,M,O,k,F,A,N){return this._pInst.beginShape(),this._pInst.vertex(j,P),this._pInst.bezierVertex(M,O,k,F,A,N),this._pInst.endShape(),this}},{key:"curve",value:function(j,P,M,O,k,F,A,N){return this._pInst.beginShape(),this._pInst.curveVertex(j,P),this._pInst.curveVertex(M,O),this._pInst.curveVertex(k,F),this._pInst.curveVertex(A,N),this._pInst.endShape(),this}},{key:"_doFillStrokeClose",value:function(j){j&&this.drawingContext.closePath(),!this._clipping&&this._doFill&&this.drawingContext.fill(),!this._clipping&&this._doStroke&&this.drawingContext.stroke()}},{key:"applyMatrix",value:function(j,P,M,O,k,F){this.drawingContext.transform(j,P,M,O,k,F)}},{key:"resetMatrix",value:function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this}},{key:"rotate",value:function(j){this.drawingContext.rotate(j)}},{key:"scale",value:function(j,P){return this.drawingContext.scale(j,P),this}},{key:"translate",value:function(j,P){return j instanceof c.default.Vector&&(P=j.y,j=j.x),this.drawingContext.translate(j,P),this}},{key:"_renderText",value:function(j,P,M,O,k,F){if(!(O<F||k<=O))return j.push(),this._isOpenType()?this._textFont._renderPath(P,M,O,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(P,M,O),!this._clipping&&this._doFill&&(this._fillSet||this._setFill(u._DEFAULT_TEXT_FILL),this.drawingContext.fillText(P,M,O))),j.pop(),j}},{key:"textWidth",value:function(j){return this._isOpenType()?this._textFont._textWidth(j,this._textSize):this.drawingContext.measureText(j).width}},{key:"_applyTextProperties",value:function(){var j=this._pInst,P=(this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),P=this._textFont,this._isOpenType()&&(P=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),P||"sans-serif");return/\s/.exec(P)&&(P='"'.concat(P,'"')),this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,"px ").concat(P),this.drawingContext.textAlign=this._textAlign,this._textBaseline===u.CENTER?this.drawingContext.textBaseline=u._CTX_MIDDLE:this.drawingContext.textBaseline=this._textBaseline,j}},{key:"push",value:function(){return this.drawingContext.save(),d(g(E.prototype),"push",this).call(this)}},{key:"pop",value:function(j){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle,d(g(E.prototype),"pop",this).call(this,j)}}])&&h(S.prototype,x),E}(c.default.Renderer),v=(y.prototype.text=function(x,S,w,M,j){M!==void 0&&this.drawingContext.textBaseline===u.BASELINE&&(P=!0,this.drawingContext.textBaseline=u.TOP);var P,M=c.default.Renderer.prototype.text.apply(this,arguments);return P&&(this.drawingContext.textBaseline=u.BASELINE),M},c.default.Renderer2D=y,c.default.Renderer2D);i.default=v},{"./constants":269,"./main":280,"./p5.Renderer":283,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.function.name":173,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],285:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var a=(r=r("./main"))&&r.__esModule?r:{default:r};a.default.prototype._promisePreloads=[];function l(){return{}}var c=!(a.default.prototype.registerPromisePreload=function(u){a.default.prototype._promisePreloads.push(u)});a.default.prototype._setupPromisePreloads=function(){var u=!0,f=!1,h=void 0;try{for(var d,p=this._promisePreloads[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var m=d.value,g=this,b=m.method,y=m.addCallbacks,v=m.legacyPreloadSetup,x=m.target||this,S=x[b].bind(x);if(x===a.default.prototype){if(c)continue;g=null,S=x[b]}x[b]=this._wrapPromisePreload(g,S,y),v&&(x[v.method]=this._legacyPreloadGenerator(g,v,x[b]))}}catch(w){f=!0,h=w}finally{try{u||p.return==null||p.return()}finally{if(f)throw h}}c=!0},a.default.prototype._wrapPromisePreload=function(u,f,h){var d=function(){for(var p=this,m=(this._incrementPreload(),null),g=null,b=arguments.length,y=new Array(b),v=0;v<b;v++)y[v]=arguments[v];if(h)for(var x=y.length-1;0<=x&&!g&&typeof y[x]=="function";x--)g=m,m=y.pop();var S=Promise.resolve(f.apply(this,y));return m&&S.then(m),g&&S.catch(g),S.then(function(){return p._decrementPreload()}),S};return d=u?d.bind(u):d},a.default.prototype._legacyPreloadGenerator=function(u,p,h){var d=p.createBaseObject||l,p=function(){var m=this;this._incrementPreload();for(var g=arguments.length,b=new Array(g),y=0;y<g;y++)b[y]=arguments[y];var v=d.apply(this,b);return h.apply(this,b).then(function(x){Object.assign(v,x),m._decrementPreload()}),v};return p=u?p.bind(u):p}},{"./main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],286:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(d=r("./main"))&&d.__esModule?d:{default:d},c=function(p){if(p&&p.__esModule)return p;if(p===null||f(p)!=="object"&&typeof p!="function")return{default:p};var m=u();if(m&&m.has(p))return m.get(p);var g,b={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=y?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,m&&m.set(p,b),b}(r("./constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p){return(f=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("./p5.Graphics"),r("./p5.Renderer2D"),r("../webgl/p5.RendererGL");var h="defaultCanvas0",d=(l.default.prototype.createCanvas=function(p,m,g,b){var y,v,x;if(l.default._validateParameters("createCanvas",arguments),arguments[2]instanceof HTMLCanvasElement?(g=c.P2D,b=arguments[2]):y=g||c.P2D,b)(x=document.getElementById(h))&&x.parentNode.removeChild(x),x=b,this._defaultGraphicsCreated=!1;else{if(y===c.WEBGL)(x=document.getElementById(h))&&(x.parentNode.removeChild(x),v=this._renderer,this._elements=this._elements.filter(function(w){return w!==v})),(x=document.createElement("canvas")).id=h,x.classList.add("p5Canvas");else if(this._defaultGraphicsCreated)x=this.canvas;else{x=b||document.createElement("canvas");for(var S=0;document.getElementById("defaultCanvas".concat(S));)S++;h="defaultCanvas".concat(S),x.id=h,x.classList.add("p5Canvas")}this._setupDone||(x.dataset.hidden=!0,x.style.visibility="hidden"),(this._userNode||(document.getElementsByTagName("main").length===0&&(g=document.createElement("main"),document.body.appendChild(g)),document.getElementsByTagName("main")[0])).appendChild(x)}return y===c.WEBGL?(this._setProperty("_renderer",new l.default.RendererGL(x,this,!0)),this._elements.push(this._renderer),p=(b=this._renderer._adjustDimensions(p,m)).adjustedWidth,m=b.adjustedHeight):this._defaultGraphicsCreated||(this._setProperty("_renderer",new l.default.Renderer2D(x,this,!0)),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer)),this._renderer.resize(p,m),this._renderer._applyDefaults(),this._renderer},l.default.prototype.resizeCanvas=function(p,m,g){if(l.default._validateParameters("resizeCanvas",arguments),this._renderer){var b,y,v,x={};for(b in this.drawingContext){var S=this.drawingContext[b];f(S)!=="object"&&typeof S!="function"&&(x[b]=S)}for(v in this._renderer instanceof l.default.RendererGL&&(p=(y=this._renderer._adjustDimensions(p,m)).adjustedWidth,m=y.adjustedHeight),this.width=p,this.height=m,this._renderer.resize(p,m),x)try{this.drawingContext[v]=x[v]}catch{}g||this.redraw()}this._addAccsOutput()&&this._updateAccsOutput()},l.default.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},l.default.prototype.createGraphics=function(p,m){for(var g=arguments.length,b=new Array(2<g?g-2:0),y=2;y<g;y++)b[y-2]=arguments[y];return b[0]instanceof HTMLCanvasElement&&(b[1]=b[0],b[0]=c.P2D),l.default._validateParameters("createGraphics",arguments),new l.default.Graphics(p,m,b[0],this,b[1])},l.default.prototype.createFramebuffer=function(p){return new l.default.Framebuffer(this,p)},l.default.prototype.clearDepth=function(p){this._assert3d("clearDepth"),this._renderer.clearDepth(p)},l.default.prototype.blendMode=function(p){l.default._validateParameters("blendMode",arguments),p===c.NORMAL&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),p=c.BLEND),this._renderer.blendMode(p)},l.default);i.default=d},{"../webgl/p5.RendererGL":337,"./constants":269,"./main":280,"./p5.Graphics":282,"./p5.Renderer2D":284,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],287:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function l(m){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.slice"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=d(r("../main")),u=function(m){if(m&&m.__esModule)return m;if(m===null||l(m)!=="object"&&typeof m!="function")return{default:m};var g=h();if(g&&g.has(m))return g.get(m);var b,y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in m){var x;Object.prototype.hasOwnProperty.call(m,b)&&((x=v?Object.getOwnPropertyDescriptor(m,b):null)&&(x.get||x.set)?Object.defineProperty(y,b,x):y[b]=m[b])}return y.default=m,g&&g.set(m,y),y}(r("../constants")),f=d(r("../helpers"));function h(){var m;return typeof WeakMap!="function"?null:(m=new WeakMap,h=function(){return m},m)}function d(m){return m&&m.__esModule?m:{default:m}}function p(m){return function(g){if(Array.isArray(g)){for(var b=0,y=new Array(g.length);b<g.length;b++)y[b]=g[b];return y}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r("../friendly_errors/fes_core"),r("../friendly_errors/file_errors"),r("../friendly_errors/validate_params"),c.default.prototype._normalizeArcAngles=function(m,g,b,y,v){var x;return m-=u.TWO_PI*Math.floor(m/u.TWO_PI),g-=u.TWO_PI*Math.floor(g/u.TWO_PI),x=Math.min(Math.abs(m-g),u.TWO_PI-Math.abs(m-g)),v&&(m=m<=u.HALF_PI?Math.atan(b/y*Math.tan(m)):m>u.HALF_PI&&m<=3*u.HALF_PI?Math.atan(b/y*Math.tan(m))+u.PI:Math.atan(b/y*Math.tan(m))+u.TWO_PI,g=g<=u.HALF_PI?Math.atan(b/y*Math.tan(g)):g>u.HALF_PI&&g<=3*u.HALF_PI?Math.atan(b/y*Math.tan(g))+u.PI:Math.atan(b/y*Math.tan(g))+u.TWO_PI),g<m&&(g+=u.TWO_PI),{start:m,stop:g,correspondToSamePoint:x<1e-5}},c.default.prototype.arc=function(m,g,b,y,v,x,S,w){return c.default._validateParameters("arc",arguments),(this._renderer._doStroke||this._renderer._doFill)&&v!==x&&(v=this._toRadians(v),x=this._toRadians(x),b=Math.abs(b),y=Math.abs(y),m=f.default.modeAdjust(m,g,b,y,this._renderer._ellipseMode),(g=this._normalizeArcAngles(v,x,m.w,m.h,!0)).correspondToSamePoint?this._renderer.ellipse([m.x,m.y,m.w,m.h,w]):(this._renderer.arc(m.x,m.y,m.w,m.h,g.start,g.stop,S,w),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[m.x,m.y,m.w,m.h,g.start,g.stop,S]))),this},c.default.prototype.ellipse=function(m,g,b,y,v){return c.default._validateParameters("ellipse",arguments),this._renderEllipse.apply(this,arguments)},c.default.prototype.circle=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];c.default._validateParameters("circle",g);var y=g.slice(0,2);return y.push(g[2],g[2]),this._renderEllipse.apply(this,p(y))},c.default.prototype._renderEllipse=function(m,g,b,y,v){return(this._renderer._doStroke||this._renderer._doFill)&&(b<0&&(b=Math.abs(b)),y===void 0?y=b:y<0&&(y=Math.abs(y)),m=f.default.modeAdjust(m,g,b,y,this._renderer._ellipseMode),this._renderer.ellipse([m.x,m.y,m.w,m.h,v]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[m.x,m.y,m.w,m.h])),this},c.default.prototype.line=function(){for(var m,g=arguments.length,b=new Array(g),y=0;y<g;y++)b[y]=arguments[y];return c.default._validateParameters("line",b),this._renderer._doStroke&&(m=this._renderer).line.apply(m,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",b),this},c.default.prototype.point=function(){for(var m,g=arguments.length,b=new Array(g),y=0;y<g;y++)b[y]=arguments[y];return c.default._validateParameters("point",b),this._renderer._doStroke&&(b.length===1&&b[0]instanceof c.default.Vector?this._renderer.point.call(this._renderer,b[0].x,b[0].y,b[0].z):((m=this._renderer).point.apply(m,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",b))),this},c.default.prototype.quad=function(){for(var m,g=arguments.length,b=new Array(g),y=0;y<g;y++)b[y]=arguments[y];return c.default._validateParameters("quad",b),(this._renderer._doStroke||this._renderer._doFill)&&(this._renderer.isP3D&&b.length<12?this._renderer.quad.call(this._renderer,b[0],b[1],0,b[2],b[3],0,b[4],b[5],0,b[6],b[7],0,b[8],b[9]):((m=this._renderer).quad.apply(m,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",b))),this},c.default.prototype.rect=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];return c.default._validateParameters("rect",g),this._renderRect.apply(this,g)},c.default.prototype.square=function(m,g,b,y,v,x,S){return c.default._validateParameters("square",arguments),this._renderRect.call(this,m,g,b,b,y,v,x,S)},c.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){arguments.length===3&&(arguments[3]=arguments[2]);for(var m=f.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode),g=[m.x,m.y,m.w,m.h],b=4;b<arguments.length;b++)g[b]=arguments[b];this._renderer.rect(g),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[m.x,m.y,m.w,m.h])}return this},c.default.prototype.triangle=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];return c.default._validateParameters("triangle",g),(this._renderer._doStroke||this._renderer._doFill)&&this._renderer.triangle(g),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",g),this},r=c.default,i.default=r},{"../constants":269,"../friendly_errors/fes_core":271,"../friendly_errors/file_errors":272,"../friendly_errors/validate_params":275,"../helpers":276,"../main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],288:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.prototype.ellipseMode=function(d){return c.default._validateParameters("ellipseMode",arguments),d!==u.CORNER&&d!==u.CORNERS&&d!==u.RADIUS&&d!==u.CENTER||(this._renderer._ellipseMode=d),this},c.default.prototype.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},c.default.prototype.rectMode=function(d){return c.default._validateParameters("rectMode",arguments),d!==u.CORNER&&d!==u.CORNERS&&d!==u.RADIUS&&d!==u.CENTER||(this._renderer._rectMode=d),this},c.default.prototype.smooth=function(){return this.setAttributes("antialias",!0),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},c.default.prototype.strokeCap=function(d){return c.default._validateParameters("strokeCap",arguments),d!==u.ROUND&&d!==u.SQUARE&&d!==u.PROJECT||this._renderer.strokeCap(d),this},c.default.prototype.strokeJoin=function(d){return c.default._validateParameters("strokeJoin",arguments),d!==u.ROUND&&d!==u.BEVEL&&d!==u.MITER||this._renderer.strokeJoin(d),this},c.default.prototype.strokeWeight=function(d){return c.default._validateParameters("strokeWeight",arguments),this._renderer.strokeWeight(d),this};var h=c.default;i.default=h},{"../constants":269,"../main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],289:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(l=r("../main"))&&l.__esModule?l:{default:l};r("../friendly_errors/fes_core"),r("../friendly_errors/file_errors"),r("../friendly_errors/validate_params"),a.default.prototype.bezier=function(){for(var c,u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("bezier",f),(this._renderer._doStroke||this._renderer._doFill)&&(c=this._renderer).bezier.apply(c,f),this},a.default.prototype.bezierDetail=function(c){return a.default._validateParameters("bezierDetail",arguments),this._bezierDetail=c,this},a.default.prototype.bezierPoint=function(c,u,f,h,d){a.default._validateParameters("bezierPoint",arguments);var p=1-d;return Math.pow(p,3)*c+3*Math.pow(p,2)*d*u+3*p*Math.pow(d,2)*f+Math.pow(d,3)*h},a.default.prototype.bezierTangent=function(c,u,f,h,d){a.default._validateParameters("bezierTangent",arguments);var p=1-d;return 3*h*Math.pow(d,2)-3*f*Math.pow(d,2)+6*f*p*d-6*u*p*d+3*u*Math.pow(p,2)-3*c*Math.pow(p,2)},a.default.prototype.curve=function(){for(var c,u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("curve",f),this._renderer._doStroke&&(c=this._renderer).curve.apply(c,f),this},a.default.prototype.curveDetail=function(c){return a.default._validateParameters("curveDetail",arguments),this._curveDetail=c<3?3:c,this},a.default.prototype.curveTightness=function(c){return a.default._validateParameters("curveTightness",arguments),this._renderer._curveTightness=c,this},a.default.prototype.curvePoint=function(c,u,f,h,d){a.default._validateParameters("curvePoint",arguments);var p=this._renderer._curveTightness,m=d*d*d,g=d*d;return c*((p-1)/2*m+(1-p)*g+(p-1)/2*d)+u*((p+3)/2*m+(-5-p)/2*g+1)+f*((-3-p)/2*m+(p+2)*g+(1-p)/2*d)+h*((1-p)/2*m+(p-1)/2*g)},a.default.prototype.curveTangent=function(c,u,f,h,g){a.default._validateParameters("curveTangent",arguments);var p=this._renderer._curveTightness,m=g*g*3,g=2*g;return c*((p-1)/2*m+(1-p)*g+(p-1)/2)+u*((p+3)/2*m+(-5-p)/2*g)+f*((-3-p)/2*m+(p+2)*g+(1-p)/2)+h*((1-p)/2*m+(p-1)/2*g)};var l=a.default;i.default=l},{"../friendly_errors/fes_core":271,"../friendly_errors/file_errors":272,"../friendly_errors/validate_params":275,"../main":280}],290:[function(r,s,i){function a(S){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(S)}function l(S){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(w){return a(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":a(w)})(S)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.slice"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(x=r("../main"))&&x.__esModule?x:{default:x},u=function(S){if(S&&S.__esModule)return S;if(S===null||l(S)!=="object"&&typeof S!="function")return{default:S};var w=f();if(w&&w.has(S))return w.get(S);var E,j={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(E in S){var M;Object.prototype.hasOwnProperty.call(S,E)&&((M=P?Object.getOwnPropertyDescriptor(S,E):null)&&(M.get||M.set)?Object.defineProperty(j,E,M):j[E]=S[E])}return j.default=S,w&&w.set(S,j),j}(r("../constants"));function f(){var S;return typeof WeakMap!="function"?null:(S=new WeakMap,f=function(){return S},S)}var h=null,d=[],p=[],m=!1,g=!1,b=!1,y=!1,v=!0,x=(c.default.prototype.beginContour=function(){return this._renderer.isP3D?this._renderer.beginContour():(p=[],y=!0),this},c.default.prototype.beginShape=function(S){var w;return c.default._validateParameters("beginShape",arguments),this._renderer.isP3D?(w=this._renderer).beginShape.apply(w,arguments):(h=S===u.POINTS||S===u.LINES||S===u.TRIANGLES||S===u.TRIANGLE_FAN||S===u.TRIANGLE_STRIP||S===u.QUADS||S===u.QUAD_STRIP?S:null,d=[],p=[]),this},c.default.prototype.bezierVertex=function(){for(var S,w=arguments.length,E=new Array(w),j=0;j<w;j++)E[j]=arguments[j];if(c.default._validateParameters("bezierVertex",E),this._renderer.isP3D)(S=this._renderer).bezierVertex.apply(S,E);else if(d.length===0)c.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex");else{m=!0;for(var P=[],M=0;M<E.length;M++)P[M]=E[M];P.isVert=!1,(y?p:d).push(P)}return this},c.default.prototype.curveVertex=function(){for(var S,w=arguments.length,E=new Array(w),j=0;j<w;j++)E[j]=arguments[j];return c.default._validateParameters("curveVertex",E),this._renderer.isP3D?(S=this._renderer).curveVertex.apply(S,E):(g=!0,this.vertex(E[0],E[1])),this},c.default.prototype.endContour=function(){if(!this._renderer.isP3D){var S=p[0].slice();S.isVert=p[0].isVert,S.moveTo=!1,p.push(S),v&&(d.push(d[0]),v=!1);for(var w=0;w<p.length;w++)d.push(p[w])}return this},c.default.prototype.endShape=function(S){var w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(c.default._validateParameters("endShape",arguments),w<1&&(console.log("🌸 p5.js says: You can not have less than one instance"),w=1),this._renderer.isP3D)this._renderer.endShape(S,g,m,b,y,h,w);else{if(w!==1&&console.log("🌸 p5.js says: Instancing is only supported in WebGL2 mode"),d.length===0)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;w=S===u.CLOSE,w&&!y&&d.push(d[0]),this._renderer.endShape(S,d,g,m,b,y,h),v=!(y=b=m=g=!1),w&&d.pop()}return this},c.default.prototype.quadraticVertex=function(){for(var S,w=arguments.length,E=new Array(w),j=0;j<w;j++)E[j]=arguments[j];if(c.default._validateParameters("quadraticVertex",E),this._renderer.isP3D)(S=this._renderer).quadraticVertex.apply(S,E);else{if(this._contourInited)return(S={}).x=E[0],S.y=E[1],S.x3=E[2],S.y3=E[3],S.type=u.QUADRATIC,this._contourVertices.push(S),this;if(0<d.length){b=!0;for(var P=[],M=0;M<E.length;M++)P[M]=E[M];P.isVert=!1,(y?p:d).push(P)}else c.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}return this},c.default.prototype.vertex=function(S,w,E,j,P){var M;return this._renderer.isP3D?(M=this._renderer).vertex.apply(M,arguments):((M=[]).isVert=!0,M[0]=S,M[1]=w,M[2]=0,M[3]=0,M[4]=0,M[5]=this._renderer._getFill(),M[6]=this._renderer._getStroke(),E&&(M.moveTo=E),(y?(p.length===0&&(M.moveTo=!0),p):d).push(M)),this},c.default.prototype.normal=function(S,w,E){var j;return this._assert3d("normal"),c.default._validateParameters("normal",arguments),(j=this._renderer).normal.apply(j,arguments),this},c.default);i.default=x},{"../constants":269,"../main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],291:[function(r,s,i){},{}],292:[function(r,s,i){r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.assign"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("./main"))&&r.__esModule?r:{default:r},r.default.prototype.noLoop=function(){this._loop=!1},r.default.prototype.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},r.default.prototype.isLooping=function(){return this._loop},r.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})},r.default.prototype.pop=function(){var a=this._styles.pop();a?(this._renderer.pop(a.renderer),Object.assign(this,a.props)):console.warn("pop() was called without matching push()")},r.default.prototype.redraw=function(a){if(!this._inUserDraw&&this._setupDone){var l=parseInt(a),c=((isNaN(l)||l<1)&&(l=1),this._isGlobal?window:this);if(typeof c.draw=="function"){c.setup===void 0&&c.scale(c._pixelDensity,c._pixelDensity);for(var u=0;u<l;u++){c.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),c._renderer.isP3D&&c._renderer._update(),c._setProperty("frameCount",c.frameCount+1),this.callRegisteredHooksFor("pre"),this._inUserDraw=!0;try{c.draw()}finally{this._inUserDraw=!1}this.callRegisteredHooksFor("post")}}}},r=r.default,i.default=r},{"./main":280,"core-js/modules/es.object.assign":181}],293:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("./main"))&&r.__esModule?r:{default:r};function l(c){return function(u){if(Array.isArray(u)){for(var f=0,h=new Array(u.length);f<u.length;f++)h[f]=u[f];return h}}(c)||function(u){if(Symbol.iterator in Object(u)||Object.prototype.toString.call(u)==="[object Arguments]")return Array.from(u)}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.default.prototype.applyMatrix=function(){var c=(arguments.length<=0?void 0:arguments[0])instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(arguments.length<=0?void 0:arguments[0])||c?(c=this._renderer).applyMatrix.apply(c,l(arguments.length<=0?void 0:arguments[0])):(c=this._renderer).applyMatrix.apply(c,arguments),this},a.default.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},a.default.prototype.rotate=function(c,u){return a.default._validateParameters("rotate",arguments),this._renderer.rotate(this._toRadians(c),u),this},a.default.prototype.rotateX=function(c){return this._assert3d("rotateX"),a.default._validateParameters("rotateX",arguments),this._renderer.rotateX(this._toRadians(c)),this},a.default.prototype.rotateY=function(c){return this._assert3d("rotateY"),a.default._validateParameters("rotateY",arguments),this._renderer.rotateY(this._toRadians(c)),this},a.default.prototype.rotateZ=function(c){return this._assert3d("rotateZ"),a.default._validateParameters("rotateZ",arguments),this._renderer.rotateZ(this._toRadians(c)),this},a.default.prototype.scale=function(c,u,f){var h;return a.default._validateParameters("scale",arguments),c instanceof a.default.Vector?(c=(h=c).x,u=h.y,f=h.z):Array.isArray(c)&&(c=(h=c)[0],u=h[1],f=h[2]||1),isNaN(u)?u=f=c:isNaN(f)&&(f=1),this._renderer.scale(c,u,f),this},a.default.prototype.shearX=function(c){return a.default._validateParameters("shearX",arguments),c=this._toRadians(c),this._renderer.applyMatrix(1,0,Math.tan(c),1,0,0),this},a.default.prototype.shearY=function(c){return a.default._validateParameters("shearY",arguments),c=this._toRadians(c),this._renderer.applyMatrix(1,Math.tan(c),0,1,0,0),this},a.default.prototype.translate=function(c,u,f){return a.default._validateParameters("translate",arguments),this._renderer.isP3D?this._renderer.translate(c,u,f):this._renderer.translate(c,u),this},r=a.default,i.default=r},{"./main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.iterator":243}],294:[function(r,s,i){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var l=(r=r("../core/main"))&&r.__esModule?r:{default:r};function c(f){return function(h){if(Array.isArray(h)){for(var d=0,p=new Array(h.length);d<h.length;d++)p[d]=h[d];return p}}(f)||function(h){if(Symbol.iterator in Object(h)||Object.prototype.toString.call(h)==="[object Arguments]")return Array.from(h)}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(f){return(u=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(h){return a(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":a(h)})(f)}l.default.prototype.storeItem=function(f,h){typeof f!="string"&&console.log("The argument that you passed to storeItem() - ".concat(f," is not a string.")),f.endsWith("p5TypeID")&&console.log("The argument that you passed to storeItem() - ".concat(f," must not end with 'p5TypeID'.")),h===void 0&&console.log("You cannot store undefined variables using storeItem().");var d=u(h);switch(d){case"number":case"boolean":h=h.toString();break;case"object":h instanceof l.default.Color?d="p5.Color":h instanceof l.default.Vector&&(d="p5.Vector",h=[h.x,h.y,h.z]),h=JSON.stringify(h)}localStorage.setItem(f,h),f="".concat(f,"p5TypeID"),localStorage.setItem(f,d)},l.default.prototype.getItem=function(f){var h=localStorage.getItem(f),d=localStorage.getItem("".concat(f,"p5TypeID"));if(d===void 0)console.log("Unable to determine type of item stored under ".concat(f,"in local storage. Did you save the item with something other than setItem()?"));else if(h!==null)switch(d){case"number":h=parseFloat(h);break;case"boolean":h=h==="true";break;case"object":h=JSON.parse(h);break;case"p5.Color":h=JSON.parse(h),h=this.color.apply(this,c(h.levels));break;case"p5.Vector":h=JSON.parse(h),h=this.createVector.apply(this,c(h))}return h},l.default.prototype.clearStorage=function(){localStorage.clear()},l.default.prototype.removeItem=function(f){typeof f!="string"&&console.log("The argument that you passed to removeItem() - ".concat(f," is not a string.")),localStorage.removeItem(f),localStorage.removeItem("".concat(f,"p5TypeID"))}},{"../core/main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.ends-with":195,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],295:[function(r,s,i){function a(b){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(b)}function l(b){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(y){return a(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":a(y)})(b)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.object.keys"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(r=r("../core/main"))&&r.__esModule?r:{default:r};function u(b,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(y&&y.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),y&&f(b,y)}function f(b,y){return(f=Object.setPrototypeOf||function(v,x){return v.__proto__=x,v})(b,y)}function h(b){return function(){var y,v=d(b),v=(y=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(y=d(this).constructor,Reflect.construct(v,arguments,y)):v.apply(this,arguments),this);if(!y||l(y)!=="object"&&typeof y!="function"){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return y}}function d(b){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(y){return y.__proto__||Object.getPrototypeOf(y)})(b)}function p(b,y){if(!(b instanceof y))throw new TypeError("Cannot call a class as a function")}function m(b,y){for(var v=0;v<y.length;v++){var x=y[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}function g(b,y,v){y&&m(b.prototype,y),v&&m(b,v)}c.default.prototype.createStringDict=function(b,y){return c.default._validateParameters("createStringDict",arguments),new c.default.StringDict(b,y)},c.default.prototype.createNumberDict=function(b,y){return c.default._validateParameters("createNumberDict",arguments),new c.default.NumberDict(b,y)},c.default.TypedDict=function(){function b(y,v){return p(this,b),y instanceof Object?this.data=y:(this.data={},this.data[y]=v),this}return g(b,[{key:"size",value:function(){return Object.keys(this.data).length}},{key:"hasKey",value:function(y){return this.data.hasOwnProperty(y)}},{key:"get",value:function(y){if(this.data.hasOwnProperty(y))return this.data[y];console.log("".concat(y," does not exist in this Dictionary"))}},{key:"set",value:function(y,v){this._validate(v)?this.data[y]=v:console.log("Those values dont work for this dictionary type.")}},{key:"_addObj",value:function(y){for(var v in y)this.set(v,y[v])}},{key:"create",value:function(y,v){y instanceof Object&&v===void 0?this._addObj(y):y!==void 0?this.set(y,v):console.log("In order to create a new Dictionary entry you must pass an object or a key, value pair")}},{key:"clear",value:function(){this.data={}}},{key:"remove",value:function(y){if(!this.data.hasOwnProperty(y))throw new Error("".concat(y," does not exist in this Dictionary"));delete this.data[y]}},{key:"print",value:function(){for(var y in this.data)console.log("key:".concat(y," value:").concat(this.data[y]))}},{key:"saveTable",value:function(y){var v,x="";for(v in this.data)x+="".concat(v,",").concat(this.data[v],`
`);var S=new Blob([x],{type:"text/csv"});c.default.prototype.downloadFile(S,y||"mycsv","csv")}},{key:"saveJSON",value:function(y,v){c.default.prototype.saveJSON(this.data,y,v)}},{key:"_validate",value:function(y){return!0}}]),b}(),c.default.StringDict=function(){u(y,c.default.TypedDict);var b=h(y);function y(){p(this,y);for(var v=arguments.length,x=new Array(v),S=0;S<v;S++)x[S]=arguments[S];return b.call.apply(b,[this].concat(x))}return g(y,[{key:"_validate",value:function(v){return typeof v=="string"}}]),y}(),c.default.NumberDict=function(){u(y,c.default.TypedDict);var b=h(y);function y(){p(this,y);for(var v=arguments.length,x=new Array(v),S=0;S<v;S++)x[S]=arguments[S];return b.call.apply(b,[this].concat(x))}return g(y,[{key:"_validate",value:function(v){return typeof v=="number"}},{key:"add",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]+=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"sub",value:function(v,x){this.add(v,-x)}},{key:"mult",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]*=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"div",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]/=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"_valueTest",value:function(v){if(Object.keys(this.data).length===0)throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict");if(Object.keys(this.data).length===1)return this.data[Object.keys(this.data)[0]];var x,S=this.data[Object.keys(this.data)[0]];for(x in this.data)this.data[x]*v<S*v&&(S=this.data[x]);return S}},{key:"minValue",value:function(){return this._valueTest(1)}},{key:"maxValue",value:function(){return this._valueTest(-1)}},{key:"_keyTest",value:function(v){if(Object.keys(this.data).length===0)throw new Error("Unable to use minValue on an empty NumberDict");if(Object.keys(this.data).length===1)return Object.keys(this.data)[0];for(var x=Object.keys(this.data)[0],S=1;S<Object.keys(this.data).length;S++)Object.keys(this.data)[S]*v<x*v&&(x=Object.keys(this.data)[S]);return x}},{key:"minKey",value:function(){return this._keyTest(1)}},{key:"maxKey",value:function(){return this._keyTest(-1)}}]),y}(),r=c.default.TypedDict,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],296:[function(r,s,i){function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(r=r("../core/main"))&&r.__esModule?r:{default:r};function c(x,S){for(var w=0;w<S.length;w++){var E=S[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}function u(x,S,w){S&&c(x.prototype,S),w&&c(x,w)}function f(x,S){return(f=Object.setPrototypeOf||function(w,E){return w.__proto__=E,w})(x,S)}function h(x){return function(){var S,w,E=p(x);return S=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(S=p(this).constructor,Reflect.construct(E,arguments,S)):E.apply(this,arguments),E=this,!(w=S)||g(w)!=="object"&&typeof w!="function"?d(E):w}}function d(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function p(x){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)})(x)}function m(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")}function g(x){return(g=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(S){return a(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":a(S)})(x)}function b(x,S,w){return(S._userNode||document.body).appendChild(x),w=new(w?l.default.MediaElement:l.default.Element)(x,S),S._elements.push(w),w}function y(x,M,w,E){var j=document.createElement(M),P=(typeof(w=w||"")=="string"&&(w=[w]),!0),M=!1,O=void 0;try{for(var k,F=w[Symbol.iterator]();!(P=(k=F.next()).done);P=!0){var A=k.value,N=document.createElement("source");N.setAttribute("src",A),j.appendChild(N)}}catch(G){M=!0,O=G}finally{try{P||F.return==null||F.return()}finally{if(M)throw O}}typeof E=="function"&&j.addEventListener("canplaythrough",function G(){E(),j.removeEventListener("canplaythrough",G)});var $=b(j,x,!0);return $.loadedmetadata=!1,j.addEventListener("loadedmetadata",function(){$.width=j.videoWidth,$.height=j.videoHeight,$.elt.width===0&&($.elt.width=j.videoWidth),$.elt.height===0&&($.elt.height=j.videoHeight),$.presetPlaybackRate&&($.elt.playbackRate=$.presetPlaybackRate,delete $.presetPlaybackRate),$.loadedmetadata=!0}),$}l.default.prototype.select=function(x,S){return l.default._validateParameters("select",arguments),S=this._getContainer(S).querySelector(x),S?this._wrapElement(S):null},l.default.prototype.selectAll=function(x,S){l.default._validateParameters("selectAll",arguments);var w=[],E=this._getContainer(S).querySelectorAll(x);if(E)for(var j=0;j<E.length;j++){var P=this._wrapElement(E[j]);w.push(P)}return w},l.default.prototype._getContainer=function(x){var S=document;return typeof x=="string"?S=document.querySelector(x)||document:x instanceof l.default.Element?S=x.elt:x instanceof HTMLElement&&(S=x),S},l.default.prototype._wrapElement=function(x){var S,w=Array.prototype.slice.call(x.children);return x.tagName==="INPUT"&&x.type==="checkbox"?((S=new l.default.Element(x,this)).checked=function(){return arguments.length===0?this.elt.checked:(this.elt.checked=!(arguments.length<=0||!arguments[0]),this)},S):x.tagName==="VIDEO"||x.tagName==="AUDIO"?new l.default.MediaElement(x,this):x.tagName==="SELECT"?this.createSelect(new l.default.Element(x,this)):0<w.length&&w.every(function(E){return E.tagName==="INPUT"||E.tagName==="LABEL"})?this.createRadio(new l.default.Element(x,this)):new l.default.Element(x,this)},l.default.prototype.removeElements=function(x){l.default._validateParameters("removeElements",arguments),this._elements.filter(function(S){return!(S.elt instanceof HTMLCanvasElement)}).map(function(S){return S.remove()})},l.default.Element.prototype.changed=function(x){return l.default.Element._adjustListener("change",x,this),this},l.default.Element.prototype.input=function(x){return l.default.Element._adjustListener("input",x,this),this},l.default.prototype.createDiv=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",S=document.createElement("div");return S.innerHTML=x,b(S,this)},l.default.prototype.createP=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",S=document.createElement("p");return S.innerHTML=x,b(S,this)},l.default.prototype.createSpan=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",S=document.createElement("span");return S.innerHTML=x,b(S,this)},l.default.prototype.createImg=function(){l.default._validateParameters("createImg",arguments);var x,S=document.createElement("img"),w=arguments;return 1<w.length&&typeof w[1]=="string"&&(S.alt=w[1]),2<w.length&&typeof w[2]=="string"&&(S.crossOrigin=w[2]),S.src=w[0],x=b(S,this),S.addEventListener("load",function(){x.width=S.offsetWidth||S.width,x.height=S.offsetHeight||S.height;var E=w[w.length-1];typeof E=="function"&&E(x)}),x},l.default.prototype.createA=function(x,S,w){l.default._validateParameters("createA",arguments);var E=document.createElement("a");return E.href=x,E.innerHTML=S,w&&(E.target=w),b(E,this)},l.default.prototype.createSlider=function(x,S,w,E){l.default._validateParameters("createSlider",arguments);var j=document.createElement("input");return j.type="range",j.min=x,j.max=S,E===0?j.step=1e-18:E&&(j.step=E),typeof w=="number"&&(j.value=w),b(j,this)},l.default.prototype.createButton=function(x,S){l.default._validateParameters("createButton",arguments);var w=document.createElement("button");return w.innerHTML=x,S&&(w.value=S),b(w,this)},l.default.prototype.createCheckbox=function(){for(var x=arguments.length,S=new Array(x),w=0;w<x;w++)S[w]=arguments[w];l.default._validateParameters("createCheckbox",S);var E=document.createElement("div"),j=document.createElement("input"),P=(j.type="checkbox",document.createElement("label")),M=(P.appendChild(j),E.appendChild(P),b(E,this));return M.checked=function(){var O=M.elt.firstElementChild.getElementsByTagName("input")[0];if(O){if(arguments.length===0)return O.checked;O.checked=!(arguments.length<=0||!arguments[0])}return M},this.value=function(O){return M.value=O,this},S[0]&&(M.value(S[0]),(E=document.createElement("span")).innerHTML=S[0],P.appendChild(E)),S[1]&&(j.checked=!0),M},l.default.prototype.createSelect=function(){for(var x,S=arguments.length,w=new Array(S),E=0;E<S;E++)w[E]=arguments[E];l.default._validateParameters("createSelect",w);var j,P=w[0];return P instanceof l.default.Element&&P.elt instanceof HTMLSelectElement?this.elt=(x=P).elt:P instanceof HTMLSelectElement?(x=b(P,this),this.elt=P):(j=document.createElement("select"),P&&typeof P=="boolean"&&j.setAttribute("multiple","true"),x=b(j,this),this.elt=j),x.option=function(M,O){var k;if(M!==void 0){for(var F,A=0;A<this.elt.length;A+=1)if(this.elt[A].textContent===M){k=A;break}k!==void 0?O===!1?this.elt.remove(k):this.elt[k].value=O:((F=document.createElement("option")).textContent=M,F.value=O===void 0?M:O,this.elt.appendChild(F),this._pInst._elements.push(F))}},x.selected=function(M){if(M!==void 0){for(var O=0;O<this.elt.length;O+=1)this.elt[O].value.toString()===M.toString()&&(this.elt.selectedIndex=O);return this}if(this.elt.getAttribute("multiple")){var k=[],F=!0,A=!1,N=void 0;try{for(var $,G=this.elt.selectedOptions[Symbol.iterator]();!(F=($=G.next()).done);F=!0){var X=$.value;k.push(X.value)}}catch(W){A=!0,N=W}finally{try{F||G.return==null||G.return()}finally{if(A)throw N}}return k}return this.elt.value},x.disable=function(M){if(typeof M=="string")for(var O=0;O<this.elt.length;O++)this.elt[O].value.toString()===M&&(this.elt[O].disabled=!0,this.elt[O].selected=!1);else this.elt.disabled=!0;return this},x.enable=function(M){if(typeof M=="string")for(var O=0;O<this.elt.length;O++)this.elt[O].value.toString()===M&&(this.elt[O].disabled=!1,this.elt[O].selected=!1);else{this.elt.disabled=!1;for(var k=0;k<this.elt.length;k++)this.elt[k].disabled=!1,this.elt[k].selected=!1}return this},x},l.default.prototype.createRadio=function(){function x(M){return M instanceof HTMLInputElement&&M.type==="radio"}function S(M){return M instanceof HTMLLabelElement}var w,E,j,P=arguments.length<=0?void 0:arguments[0];return P instanceof l.default.Element&&(P.elt instanceof HTMLDivElement||P.elt instanceof HTMLSpanElement)?(w=P,this.elt=P.elt):P instanceof HTMLDivElement||P instanceof HTMLSpanElement?(w=b(P,this),E=this.elt=P,typeof(arguments.length<=1?void 0:arguments[1])=="string"&&(j=arguments.length<=1?void 0:arguments[1])):(typeof P=="string"&&(j=P),E=document.createElement("div"),w=b(E,this),this.elt=E),w._name=j||"radioOption",w._getOptionsArray=function(){return Array.from(this.elt.children).filter(function(M){return x(M)||S(M)&&x(M.firstElementChild)}).map(function(M){return x(M)?M:M.firstElementChild})},w.option=function(M,O){var k,F,A,N=!0,$=!1,G=void 0;try{for(var X,W=w._getOptionsArray()[Symbol.iterator]();!(N=(X=W.next()).done);N=!0){var V=X.value;if(V.value===M){k=V;break}}}catch(q){$=!0,G=q}finally{try{N||W.return==null||W.return()}finally{if($)throw G}}return k===void 0&&((k=document.createElement("input")).setAttribute("type","radio"),k.setAttribute("value",M)),k.setAttribute("name",w._name),S(k.parentElement)?F=k.parentElement:(F=document.createElement("label")).insertAdjacentElement("afterbegin",k),F.lastElementChild instanceof HTMLSpanElement?A=F.lastElementChild:(A=document.createElement("span"),k.insertAdjacentElement("afterend",A)),A.innerHTML=O===void 0?M:O,this.elt.appendChild(F),k},w.remove=function(M){var O=!0,k=!1,F=void 0;try{for(var A,N=w._getOptionsArray()[Symbol.iterator]();!(O=(A=N.next()).done);O=!0){var $=A.value;if($.value===M)return void(S($.parentElement)?$.parentElement:$).remove()}}catch(G){k=!0,F=G}finally{try{O||N.return==null||N.return()}finally{if(k)throw F}}},w.value=function(){var M="",O=!0,k=!1,F=void 0;try{for(var A,N=w._getOptionsArray()[Symbol.iterator]();!(O=(A=N.next()).done);O=!0){var $=A.value;if($.checked){M=$.value;break}}}catch(G){k=!0,F=G}finally{try{O||N.return==null||N.return()}finally{if(k)throw F}}return M},w.selected=function(M){var O=null;if(M===void 0){var k=!0,F=!1,A=void 0;try{for(var N,$=w._getOptionsArray()[Symbol.iterator]();!(k=(N=$.next()).done);k=!0){var G=N.value;if(G.checked){O=G;break}}}catch(J){F=!0,A=J}finally{try{k||$.return==null||$.return()}finally{if(F)throw A}}}else{w._getOptionsArray().forEach(function(I){I.checked=!1,I.removeAttribute("checked")});var X=!0,F=!1,A=void 0;try{for(var W,V=w._getOptionsArray()[Symbol.iterator]();!(X=(W=V.next()).done);X=!0){var q=W.value;q.value===M&&(q.setAttribute("checked",!0),q.checked=!0,O=q)}}catch(I){F=!0,A=I}finally{try{X||V.return==null||V.return()}finally{if(F)throw A}}}return O},w.disable=function(){var M=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],O=!0,k=!1,F=void 0;try{for(var A,N=w._getOptionsArray()[Symbol.iterator]();!(O=(A=N.next()).done);O=!0)A.value.setAttribute("disabled",M)}catch($){k=!0,F=$}finally{try{O||N.return==null||N.return()}finally{if(k)throw F}}},w},l.default.prototype.createColorPicker=function(x){l.default._validateParameters("createColorPicker",arguments);var S=document.createElement("input");return S.type="color",x?x instanceof l.default.Color?S.value=x.toString("#rrggbb"):(l.default.prototype._colorMode="rgb",l.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},S.value=l.default.prototype.color(x).toString("#rrggbb")):S.value="#000000",(S=b(S,this)).color=function(){return x&&(x.mode&&(l.default.prototype._colorMode=x.mode),x.maxes&&(l.default.prototype._colorMaxes=x.maxes)),l.default.prototype.color(this.elt.value)},S},l.default.prototype.createInput=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"text",w=(l.default._validateParameters("createInput",arguments),document.createElement("input"));return w.setAttribute("value",x),w.setAttribute("type",S),b(w,this)},l.default.prototype.createFileInput=function(x){var S,w=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(l.default._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob)return(S=document.createElement("input")).setAttribute("type","file"),w&&S.setAttribute("multiple",!0),S.addEventListener("change",function(E){var j=!0,P=!1,M=void 0;try{for(var O,k=E.target.files[Symbol.iterator]();!(j=(O=k.next()).done);j=!0){var F=O.value;l.default.File._load(F,x)}}catch(A){P=!0,M=A}finally{try{j||k.return==null||k.return()}finally{if(P)throw M}}},!1),b(S,this);console.log("The File APIs are not fully supported in this browser. Cannot create element.")},l.default.prototype.createVideo=function(x,S){return l.default._validateParameters("createVideo",arguments),y(this,"video",x,S)},l.default.prototype.createAudio=function(x,S){return l.default._validateParameters("createAudio",arguments),y(this,"audio",x,S)},l.default.prototype.VIDEO="video",l.default.prototype.AUDIO="audio",navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(x){var S=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return S?new Promise(function(w,E){S.call(navigator,x,w,E)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),l.default.prototype.createCapture=function(){for(var x=arguments.length,S=new Array(x),w=0;w<x;w++)S[w]=arguments[w];if(l.default._validateParameters("createCapture",S),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new DOMException("getUserMedia not supported in this browser");for(var E,j=!0,P=!0,M=!1,O=0,k=S;O<k.length;O++){var F=k[O];F===l.default.prototype.VIDEO?P=!1:F===l.default.prototype.AUDIO?j=!1:g(F)==="object"?(F.flipped!==void 0&&(M=F.flipped,delete F.flipped),A=Object.assign({},A,F)):typeof F=="function"&&(E=F)}var A=Object.assign({},{video:j,audio:P},A),N=document.createElement("video"),$=(N.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(A).then(function(G){try{"srcObject"in N?N.srcObject=G:N.src=window.URL.createObjectURL(G)}catch{N.src=G}}).catch(function(G){G.name==="NotFoundError"&&l.default._friendlyError("No webcam found on this device","createCapture"),G.name==="NotAllowedError"&&l.default._friendlyError("Access to the camera was denied","createCapture"),console.error(G)}),b(N,this,!0));return $.loadedmetadata=!1,N.addEventListener("loadedmetadata",function(){N.play(),N.width?($.width=N.width,$.height=N.height,M&&($.elt.style.transform="scaleX(-1)")):($.width=$.elt.width=N.videoWidth,$.height=$.elt.height=N.videoHeight),$.loadedmetadata=!0,E&&E(N.srcObject)}),$.flipped=M,$},l.default.prototype.createElement=function(x,S){return l.default._validateParameters("createElement",arguments),x=document.createElement(x),S!==void 0&&(x.innerHTML=S),b(x,this)},l.default.Element.prototype.addClass=function(x){return this.elt.className?this.hasClass(x)||(this.elt.className=this.elt.className+" "+x):this.elt.className=x,this},l.default.Element.prototype.removeClass=function(x){return this.elt.classList.remove(x),this},l.default.Element.prototype.hasClass=function(x){return this.elt.classList.contains(x)},l.default.Element.prototype.toggleClass=function(x){return this.elt.classList.contains(x)?this.elt.classList.remove(x):this.elt.classList.add(x),this},l.default.Element.prototype.child=function(x){return x===void 0?this.elt.childNodes:(typeof x=="string"?(x[0]==="#"&&(x=x.substring(1)),x=document.getElementById(x)):x instanceof l.default.Element&&(x=x.elt),x instanceof HTMLElement&&this.elt.appendChild(x),this)},l.default.Element.prototype.center=function(x){var S=this.elt.style.display,w=this.elt.style.display==="none",E=this.parent().style.display==="none",j={x:this.elt.offsetLeft,y:this.elt.offsetTop},P=(w&&this.show(),E&&this.parent().show(),this.elt.style.display="block",this.position(0,0),Math.abs(this.parent().offsetWidth-this.elt.offsetWidth)),M=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return x==="both"||x===void 0?this.position(P/2+this.parent().offsetLeft,M/2+this.parent().offsetTop):x==="horizontal"?this.position(P/2+this.parent().offsetLeft,j.y):x==="vertical"&&this.position(j.x,M/2+this.parent().offsetTop),this.style("display",S),w&&this.hide(),E&&this.parent().hide(),this},l.default.Element.prototype.html=function(){return arguments.length===0?this.elt.innerHTML:(arguments.length<=1||!arguments[1]?this.elt.innerHTML=arguments.length<=0?void 0:arguments[0]:this.elt.insertAdjacentHTML("beforeend",arguments.length<=0?void 0:arguments[0]),this)},l.default.Element.prototype.position=function(){return arguments.length===0?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position=(arguments.length<=2?void 0:arguments[2])!=="static"&&(arguments.length<=2?void 0:arguments[2])!=="fixed"&&(arguments.length<=2?void 0:arguments[2])!=="relative"&&(arguments.length<=2?void 0:arguments[2])!=="sticky"&&(arguments.length<=2?void 0:arguments[2])!=="initial"&&(arguments.length<=2?void 0:arguments[2])!=="inherit"?"absolute":arguments.length<=2?void 0:arguments[2],this.elt.style.left=(arguments.length<=0?void 0:arguments[0])+"px",this.elt.style.top=(arguments.length<=1?void 0:arguments[1])+"px",this.x=arguments.length<=0?void 0:arguments[0],this.y=arguments.length<=1?void 0:arguments[1],this)},l.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var x="";return this.elt.style.transform&&(x=(x=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),arguments.length===2?this.elt.style.transform="translate("+(arguments.length<=0?void 0:arguments[0])+"px, "+(arguments.length<=1?void 0:arguments[1])+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+(arguments.length<=0?void 0:arguments[0])+"px,"+(arguments.length<=1?void 0:arguments[1])+"px,"+(arguments.length<=2?void 0:arguments[2])+"px)",this.elt.parentElement.style.perspective=arguments.length===3?"1000px":(arguments.length<=3?void 0:arguments[3])+"px"),this.elt.style.transform+=x,this},l.default.Element.prototype._rotate=function(){var x="";return this.elt.style.transform&&(x=(x=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,"")),arguments.length===1?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg)":arguments.length===2?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg, "+(arguments.length<=1?void 0:arguments[1])+"deg)":arguments.length===3&&(this.elt.style.transform="rotateX("+(arguments.length<=0?void 0:arguments[0])+"deg)",this.elt.style.transform+="rotateY("+(arguments.length<=1?void 0:arguments[1])+"deg)",this.elt.style.transform+="rotateZ("+(arguments.length<=2?void 0:arguments[2])+"deg)"),this.elt.style.transform+=x,this},l.default.Element.prototype.style=function(x,S){if((S=S instanceof l.default.Color?"rgba("+S.levels[0]+","+S.levels[1]+","+S.levels[2]+","+S.levels[3]/255+")":S)===void 0){if(x.indexOf(":")===-1)return window.getComputedStyle(this.elt).getPropertyValue(x);for(var w=x.split(";"),E=0;E<w.length;E++){var j=w[E].split(":");j[0]&&j[1]&&(this.elt.style[j[0].trim()]=j[1].trim())}}else this.elt.style[x]=S,x!=="width"&&x!=="height"&&x!=="left"&&x!=="top"||(S=window.getComputedStyle(this.elt).getPropertyValue(x).replace(/[^\d.]/g,""),this[x]=Math.round(parseFloat(S,10)));return this},l.default.Element.prototype.attribute=function(x,S){if(this.elt.firstChild==null||this.elt.firstChild.type!=="checkbox"&&this.elt.firstChild.type!=="radio")return S===void 0?this.elt.getAttribute(x):(this.elt.setAttribute(x,S),this);if(S===void 0)return this.elt.firstChild.getAttribute(x);for(var w=0;w<this.elt.childNodes.length;w++)this.elt.childNodes[w].setAttribute(x,S)},l.default.Element.prototype.removeAttribute=function(x){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(var S=0;S<this.elt.childNodes.length;S++)this.elt.childNodes[S].removeAttribute(x);return this.elt.removeAttribute(x),this},l.default.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments.length<=0?void 0:arguments[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value},l.default.Element.prototype.show=function(){return this.elt.style.display="block",this},l.default.Element.prototype.hide=function(){return this.elt.style.display="none",this},l.default.Element.prototype.size=function(x,S){if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var w=x,E=S,j=l.default.prototype.AUTO;if(w!==j||E!==j){if(w===j?w=S*this.width/this.height:E===j&&(E=x*this.height/this.width),this.elt instanceof HTMLCanvasElement){var P,M={},O=this.elt.getContext("2d");for(P in O)M[P]=O[P];for(P in this.elt.setAttribute("width",w*this._pInst._pixelDensity),this.elt.setAttribute("height",E*this._pInst._pixelDensity),this.elt.style.width=w+"px",this.elt.style.height=E+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),M)this.elt.getContext("2d")[P]=M[P]}else this.elt.style.width=w+"px",this.elt.style.height=E+"px",this.elt.width=w,this.elt.height=E;this.width=w,this.height=E,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",w),this._pInst._setProperty("height",E))}return this},l.default.Element.prototype.remove=function(){this instanceof l.default.MediaElement&&(this.stop(),(S=this.elt.srcObject)!==null&&S.getTracks().forEach(function(w){w.stop()}));var x,S=this._pInst._elements.indexOf(this);for(x in S!==-1&&this._pInst._elements.splice(S,1),this._events)this.elt.removeEventListener(x,this._events[x]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},l.default.Element.prototype.drop=function(x,S){var w;return window.File&&window.FileReader&&window.FileList&&window.Blob?(this._dragDisabled||(this._dragDisabled=!0,this.elt.addEventListener("dragover",w=function(E){E.preventDefault()}),this.elt.addEventListener("dragleave",w)),l.default.Element._attachListener("drop",function(j){j.preventDefault(),typeof S=="function"&&S.call(this,j);var j=j.dataTransfer.files,P=!0,M=!1,O=void 0;try{for(var k,F=j[Symbol.iterator]();!(P=(k=F.next()).done);P=!0){var A=k.value;l.default.File._load(A,x)}}catch(N){M=!0,O=N}finally{try{P||F.return==null||F.return()}finally{if(M)throw O}}},this)):console.log("The File APIs are not fully supported in this browser."),this},l.default.Element.prototype.draggable=function(x){var S,w="ontouchstart"in window,E=0,j=0,P=0,M=0,O=w?"touchend":"mouseup",k=w?"touchmove":"mousemove";function F(N){var $;N=N||window.event,M=w?($=N.changedTouches,E=P-parseInt($[0].clientX),j=M-parseInt($[0].clientY),P=parseInt($[0].clientX),parseInt($[0].clientY)):(E=P-parseInt(N.clientX),j=M-parseInt(N.clientY),P=parseInt(N.clientX),parseInt(N.clientY)),x.style.left=x.offsetLeft-E+"px",x.style.top=x.offsetTop-j+"px"}function A(){document.removeEventListener(O,A,!1),document.removeEventListener(k,F,!1)}return x===void 0?S=x=this.elt:x!==this.elt&&x.elt!==this.elt&&(x=x.elt,S=this.elt),S.addEventListener(w?"touchstart":"mousedown",function(N){{var $;N=N||window.event,M=w?($=N.changedTouches,P=parseInt($[0].clientX),parseInt($[0].clientY)):(P=parseInt(N.clientX),parseInt(N.clientY))}return document.addEventListener(O,A,!1),document.addEventListener(k,F,!1),!1},!1),S.style.cursor="move",this};function v(x,S,w,E){m(this,v),this.callback=x,this.time=S,this.id=w,this.val=E}r=function(x){var S=E;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(x&&x.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),x&&f(S,x);var w=h(E);function E(j,P){m(this,E);var M=d(P=w.call(this,j,P));return P.elt.crossOrigin="anonymous",P._prevTime=0,P._cueIDCounter=0,P._cues=[],P.pixels=[],P._pixelsState=d(P),P._pixelDensity=1,P._modified=!1,P._frameOnCanvas=-1,Object.defineProperty(M,"src",{get:function(){var O=M.elt.children[0].src,k=M.elt.src===window.location.href?"":M.elt.src;return O===window.location.href?k:O},set:function(O){for(var k=0;k<M.elt.children.length;k++)M.elt.removeChild(M.elt.children[k]);var F=document.createElement("source");F.src=O,j.appendChild(F),M.elt.src=O,M.modified=!0}}),M._onended=function(){},M.elt.onended=function(){M._onended(M)},P}return u(E,[{key:"play",value:function(){var j;return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),1<this.elt.readyState||this.elt.load(),(j=this.elt.play())&&j.catch&&j.catch(function(P){P.name==="NotAllowedError"?console.error(P):console.error("Media play method encountered an unexpected error",P)}),this}},{key:"stop",value:function(){return this.elt.pause(),this.elt.currentTime=0,this}},{key:"pause",value:function(){return this.elt.pause(),this}},{key:"loop",value:function(){return this.elt.setAttribute("loop",!0),this.play(),this}},{key:"noLoop",value:function(){return this.elt.removeAttribute("loop"),this}},{key:"_setupAutoplayFailDetection",value:function(){var j=setTimeout(function(){console.error(e)},500);this.elt.addEventListener("play",function(){return clearTimeout(j)},{passive:!0,once:!0})}},{key:"autoplay",value:function(j){var P=this,M=this.elt.getAttribute("autoplay");return this.elt.setAttribute("autoplay",j),j&&!M&&(j=function(){return P._setupAutoplayFailDetection()},this.elt.readyState===4?j():this.elt.addEventListener("canplay",j,{passive:!0,once:!0})),this}},{key:"volume",value:function(j){if(j===void 0)return this.elt.volume;this.elt.volume=j}},{key:"speed",value:function(j){if(j===void 0)return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=j:this.presetPlaybackRate=j}},{key:"time",value:function(j){return j===void 0?this.elt.currentTime:(this.elt.currentTime=j,this)}},{key:"duration",value:function(){return this.elt.duration}},{key:"_ensureCanvas",value:function(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0));var j=this._frameOnCanvas!==this._pInst.frameCount;this.loadedmetadata&&j&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&(this.drawingContext.save(),this.drawingContext.scale(-1,1),this.drawingContext.translate(-this.canvas.width,0)),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&this.drawingContext.restore(),this.setModified(!0),this._frameOnCanvas=this._pInst.frameCount)}},{key:"loadPixels",value:function(){this._ensureCanvas();for(var j=arguments.length,P=new Array(j),M=0;M<j;M++)P[M]=arguments[M];return l.default.Renderer2D.prototype.loadPixels.apply(this,P)}},{key:"updatePixels",value:function(j,P,M,O){return this.loadedmetadata&&(this._ensureCanvas(),l.default.Renderer2D.prototype.updatePixels.call(this,j,P,M,O)),this.setModified(!0),this}},{key:"get",value:function(){this._ensureCanvas();for(var j=arguments.length,P=new Array(j),M=0;M<j;M++)P[M]=arguments[M];return l.default.Renderer2D.prototype.get.apply(this,P)}},{key:"_getPixel",value:function(){this.loadPixels();for(var j=arguments.length,P=new Array(j),M=0;M<j;M++)P[M]=arguments[M];return l.default.Renderer2D.prototype._getPixel.apply(this,P)}},{key:"set",value:function(j,P,M){this.loadedmetadata&&(this._ensureCanvas(),l.default.Renderer2D.prototype.set.call(this,j,P,M),this.setModified(!0))}},{key:"copy",value:function(){this._ensureCanvas();for(var j=arguments.length,P=new Array(j),M=0;M<j;M++)P[M]=arguments[M];l.default.prototype.copy.apply(this,P)}},{key:"mask",value:function(){this.loadPixels(),this.setModified(!0);for(var j=arguments.length,P=new Array(j),M=0;M<j;M++)P[M]=arguments[M];l.default.Image.prototype.mask.apply(this,P)}},{key:"isModified",value:function(){return this._modified}},{key:"setModified",value:function(j){this._modified=j}},{key:"onended",value:function(j){return this._onended=j,this}},{key:"connect",value:function(j){var P,M;if(typeof l.default.prototype.getAudioContext=="function")P=l.default.prototype.getAudioContext(),M=l.default.soundOut.input;else try{M=(P=j.context).destination}catch{throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=P.createMediaElementSource(this.elt),this.audioSourceNode.connect(M)),j?j.input?this.audioSourceNode.connect(j.input):this.audioSourceNode.connect(j):this.audioSourceNode.connect(M)}},{key:"disconnect",value:function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()}},{key:"showControls",value:function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0}},{key:"hideControls",value:function(){this.elt.controls=!1}},{key:"addCue",value:function(j,k,M){var O=this._cueIDCounter++,k=new v(k,j,O,M);return this._cues.push(k),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),O}},{key:"removeCue",value:function(j){for(var P=0;P<this._cues.length;P++)this._cues[P].id===j&&(console.log(j),this._cues.splice(P,1));this._cues.length===0&&(this.elt.ontimeupdate=null)}},{key:"clearCues",value:function(){this._cues=[],this.elt.ontimeupdate=null}},{key:"_onTimeUpdate",value:function(){for(var j=this.time(),P=0;P<this._cues.length;P++){var M=this._cues[P].time,O=this._cues[P].val;this._prevTime<M&&M<=j&&this._cues[P].callback(O)}this._prevTime=j}}]),E}(l.default.Element),l.default.MediaElement=r,r=function(){function x(S,w){m(this,x),this.file=S,this._pInst=w,w=S.type.split("/"),this.type=w[0],this.subtype=w[1],this.name=S.name,this.size=S.size,this.data=void 0}return u(x,null,[{key:"_createLoader",value:function(S,w){var E=new FileReader;return E.onload=function(j){var P,M=new l.default.File(S);M.file.type==="application/json"?M.data=JSON.parse(j.target.result):M.file.type==="text/xml"?(P=new DOMParser().parseFromString(j.target.result,"text/xml"),M.data=new l.default.XML(P.documentElement)):M.data=j.target.result,w(M)},E}},{key:"_load",value:function(S,w){var E;/^text\//.test(S.type)||S.type==="application/json"?l.default.File._createLoader(S,w).readAsText(S):/^(video|audio)\//.test(S.type)?((E=new l.default.File(S)).data=URL.createObjectURL(S),w(E)):l.default.File._createLoader(S,w).readAsDataURL(S)}}]),x}(),l.default.File=r,r=l.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.every":154,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243,"core-js/modules/web.url":245}],297:[function(g,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(g=g("../core/main"))&&g.__esModule?g:{default:g};a.default.prototype.deviceOrientation=1<window.innerWidth/window.innerHeight?"landscape":"portrait",a.default.prototype.accelerationX=0,a.default.prototype.accelerationY=0,a.default.prototype.accelerationZ=0,a.default.prototype.pAccelerationX=0,a.default.prototype.pAccelerationY=0,a.default.prototype.pAccelerationZ=0,a.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},a.default.prototype.rotationX=0,a.default.prototype.rotationY=0,a.default.prototype.rotationZ=0,a.default.prototype.pRotationX=0,a.default.prototype.pRotationY=0;var l=a.default.prototype.pRotationZ=0,c=0,u=0,f="clockwise",h="clockwise",d="clockwise",p=(a.default.prototype.pRotateDirectionX=void 0,a.default.prototype.pRotateDirectionY=void 0,a.default.prototype.pRotateDirectionZ=void 0,a.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},a.default.prototype.turnAxis=void 0,.5),m=30,g=(a.default.prototype.setMoveThreshold=function(b){a.default._validateParameters("setMoveThreshold",arguments),p=b},a.default.prototype.setShakeThreshold=function(b){a.default._validateParameters("setShakeThreshold",arguments),m=b},a.default.prototype._ondeviceorientation=function(b){this._updatePRotations(),this._setProperty("rotationX",this._fromDegrees(b.beta)),this._setProperty("rotationY",this._fromDegrees(b.gamma)),this._setProperty("rotationZ",this._fromDegrees(b.alpha)),this._handleMotion()},a.default.prototype._ondevicemotion=function(b){this._updatePAccelerations(),this._setProperty("accelerationX",2*b.acceleration.x),this._setProperty("accelerationY",2*b.acceleration.y),this._setProperty("accelerationZ",2*b.acceleration.z),this._handleMotion()},a.default.prototype._handleMotion=function(){window.orientation===90||window.orientation===-90?this._setProperty("deviceOrientation","landscape"):window.orientation===0?this._setProperty("deviceOrientation","portrait"):window.orientation===void 0&&this._setProperty("deviceOrientation","undefined");var b,y,v,x,S,w=this._isGlobal?window:this;typeof w.deviceMoved=="function"&&(Math.abs(this.accelerationX-this.pAccelerationX)>p||Math.abs(this.accelerationY-this.pAccelerationY)>p||Math.abs(this.accelerationZ-this.pAccelerationZ)>p)&&w.deviceMoved(),typeof w.deviceTurned=="function"&&(y=this._toDegrees(this.rotationX)+180,v=this._toDegrees(this.pRotationX)+180,b=l+180,0<y-v&&y-v<270||y-v<-270?f="clockwise":(y-v<0||270<y-v)&&(f="counter-clockwise"),f!==this.pRotateDirectionX&&(b=y),90<Math.abs(y-b)&&Math.abs(y-b)<270&&(b=y,this._setProperty("turnAxis","X"),w.deviceTurned()),this.pRotateDirectionX=f,l=b-180,v=this._toDegrees(this.rotationY)+180,y=this._toDegrees(this.pRotationY)+180,b=c+180,0<v-y&&v-y<270||v-y<-270?h="clockwise":(v-y<0||270<v-this.pRotationY)&&(h="counter-clockwise"),h!==this.pRotateDirectionY&&(b=v),90<Math.abs(v-b)&&Math.abs(v-b)<270&&(b=v,this._setProperty("turnAxis","Y"),w.deviceTurned()),this.pRotateDirectionY=h,c=b-180,0<(y=this._toDegrees(this.rotationZ))-(v=this._toDegrees(this.pRotationZ))&&y-v<270||y-v<-270?d="clockwise":(y-v<0||270<y-v)&&(d="counter-clockwise"),d!==this.pRotateDirectionZ&&(u=y),90<Math.abs(y-u)&&Math.abs(y-u)<270&&(u=y,this._setProperty("turnAxis","Z"),w.deviceTurned()),this.pRotateDirectionZ=d,this._setProperty("turnAxis",void 0)),typeof w.deviceShaken=="function"&&(this.pAccelerationX!==null&&(x=Math.abs(this.accelerationX-this.pAccelerationX),S=Math.abs(this.accelerationY-this.pAccelerationY)),m<x+S&&w.deviceShaken())},a.default);i.default=g},{"../core/main":280}],298:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};a.default.prototype.isKeyPressed=!1,a.default.prototype.keyIsPressed=!1,a.default.prototype.key="",a.default.prototype.keyCode=0,a.default.prototype._onkeydown=function(l){var c;this._downKeys[l.which]||(this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",l.which),this._downKeys[l.which]=!0,this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),typeof(c=this._isGlobal?window:this).keyPressed!="function"||l.charCode||c.keyPressed(l)===!1&&l.preventDefault())},a.default.prototype._onkeyup=function(l){this._downKeys[l.which]=!1,this._areDownKeys()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null),this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),this._setProperty("keyCode",l.which);var c=this._isGlobal?window:this;typeof c.keyReleased=="function"&&c.keyReleased(l)===!1&&l.preventDefault()},a.default.prototype._onkeypress=function(l){var c;l.which!==this._lastKeyCodeTyped&&(this._setProperty("_lastKeyCodeTyped",l.which),this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),typeof(c=this._isGlobal?window:this).keyTyped=="function"&&c.keyTyped(l)===!1&&l.preventDefault())},a.default.prototype._onblur=function(l){this._downKeys={}},a.default.prototype.keyIsDown=function(l){return a.default._validateParameters("keyIsDown",arguments),this._downKeys[l]||!1},a.default.prototype._areDownKeys=function(){for(var l in this._downKeys)if(this._downKeys.hasOwnProperty(l)&&this._downKeys[l]===!0)return!0;return!1},r=a.default,i.default=r},{"../core/main":280}],299:[function(r,s,i){function a(h){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(h)}function l(h){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(d){return a(d)}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":a(d)})(h)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(c=r("../core/main"))&&c.__esModule?c:{default:c},u=function(h){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var d=f();if(d&&d.has(h))return d.get(h);var p,m={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(p in h){var b;Object.prototype.hasOwnProperty.call(h,p)&&((b=g?Object.getOwnPropertyDescriptor(h,p):null)&&(b.get||b.set)?Object.defineProperty(m,p,b):m[p]=h[p])}return m.default=h,d&&d.set(h,m),m}(r("../core/constants"));function f(){var h;return typeof WeakMap!="function"?null:(h=new WeakMap,f=function(){return h},h)}c.default.prototype.movedX=0,c.default.prototype.movedY=0,c.default.prototype._hasMouseInteracted=!1,c.default.prototype.mouseX=0,c.default.prototype.mouseY=0,c.default.prototype.pmouseX=0,c.default.prototype.pmouseY=0,c.default.prototype.winMouseX=0,c.default.prototype.winMouseY=0,c.default.prototype.pwinMouseX=0,c.default.prototype.pwinMouseY=0,c.default.prototype.mouseButton=0,c.default.prototype.mouseIsPressed=!1,c.default.prototype._updateNextMouseCoords=function(h){var d,p,m,g,b;this._curElement!==null&&(!h.touches||0<h.touches.length)&&(d=this._curElement.elt,p=this.width,m=this.height,(g=h)&&!g.clientX&&(g.touches?g=g.touches[0]:g.changedTouches&&(g=g.changedTouches[0])),b=d.getBoundingClientRect(),p=d.scrollWidth/p||1,d=d.scrollHeight/m||1,m={x:(g.clientX-b.left)/p,y:(g.clientY-b.top)/d,winX:g.clientX,winY:g.clientY,id:g.identifier},this._setProperty("movedX",h.movementX),this._setProperty("movedY",h.movementY),this._setProperty("mouseX",m.x),this._setProperty("mouseY",m.y),this._setProperty("winMouseX",m.winX),this._setProperty("winMouseY",m.winY)),this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},c.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY),this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)},c.default.prototype._setMouseButton=function(h){h.button===1?this._setProperty("mouseButton",u.CENTER):h.button===2?this._setProperty("mouseButton",u.RIGHT):this._setProperty("mouseButton",u.LEFT)},c.default.prototype._onmousemove=function(h){var d=this._isGlobal?window:this;this._updateNextMouseCoords(h),this.mouseIsPressed?typeof d.mouseDragged=="function"?d.mouseDragged(h)===!1&&h.preventDefault():typeof d.touchMoved=="function"&&d.touchMoved(h)===!1&&h.preventDefault():typeof d.mouseMoved=="function"&&d.mouseMoved(h)===!1&&h.preventDefault()},c.default.prototype._onmousedown=function(h){var d=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(h),this._updateNextMouseCoords(h),this.touchstart||(typeof d.mousePressed=="function"?d.mousePressed(h)===!1&&h.preventDefault():typeof d.touchStarted=="function"&&d.touchStarted(h)===!1&&h.preventDefault(),this.touchstart=!1)},c.default.prototype._onmouseup=function(h){var d=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),this.touchend||(typeof d.mouseReleased=="function"?d.mouseReleased(h)===!1&&h.preventDefault():typeof d.touchEnded=="function"&&d.touchEnded(h)===!1&&h.preventDefault(),this.touchend=!1)},c.default.prototype._ondragend=c.default.prototype._onmouseup,c.default.prototype._ondragover=c.default.prototype._onmousemove,c.default.prototype._onclick=function(h){var d=this._isGlobal?window:this;typeof d.mouseClicked=="function"&&d.mouseClicked(h)===!1&&h.preventDefault()},c.default.prototype._ondblclick=function(h){var d=this._isGlobal?window:this;typeof d.doubleClicked=="function"&&d.doubleClicked(h)===!1&&h.preventDefault()},c.default.prototype._mouseWheelDeltaY=0,c.default.prototype._pmouseWheelDeltaY=0,c.default.prototype._onwheel=function(h){var d=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",h.deltaY),typeof d.mouseWheel=="function"&&(h.delta=h.deltaY,d.mouseWheel(h)===!1&&h.preventDefault())},c.default.prototype.requestPointerLock=function(){var h=this._curElement.elt;return h.requestPointerLock=h.requestPointerLock||h.mozRequestPointerLock,h.requestPointerLock?(h.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},c.default.prototype.exitPointerLock=function(){document.exitPointerLock()},r=c.default,i.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],300:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.touches=[],r.default.prototype._updateTouchCoords=function(a){if(this._curElement!==null){for(var l=[],c=0;c<a.touches.length;c++)l[c]=function(b,g,y,d){var p=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,m=b.getBoundingClientRect(),g=b.scrollWidth/g||1,b=b.scrollHeight/y||1,y=d.touches[p]||d.changedTouches[p];return{x:(y.clientX-m.left)/g,y:(y.clientY-m.top)/b,winX:y.clientX,winY:y.clientY,id:y.identifier}}(this._curElement.elt,this.width,this.height,a,c);this._setProperty("touches",l)}},r.default.prototype._ontouchstart=function(a){var l=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(a),this._updateNextMouseCoords(a),this._updateMouseCoords(),typeof l.touchStarted=="function"&&(l.touchStarted(a)===!1&&a.preventDefault(),this.touchstart=!0)},r.default.prototype._ontouchmove=function(a){var l=this._isGlobal?window:this;this._updateTouchCoords(a),this._updateNextMouseCoords(a),typeof l.touchMoved=="function"?l.touchMoved(a)===!1&&a.preventDefault():typeof l.mouseDragged=="function"&&l.mouseDragged(a)===!1&&a.preventDefault()},r.default.prototype._ontouchend=function(a){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(a),this._updateNextMouseCoords(a);var l=this._isGlobal?window:this;typeof l.touchEnded=="function"&&(l.touchEnded(a)===!1&&a.preventDefault(),this.touchend=!0)},r=r.default,i.default=r},{"../core/main":280}],301:[function(r,s,i){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.int32-array"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.int32-array"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a,l,c,u,f={_toPixels:function(h){var d,p;return h instanceof ImageData?h.data:h.getContext("2d")?h.getContext("2d").getImageData(0,0,h.width,h.height).data:h.getContext("webgl")?(p=(d=h.getContext("webgl")).drawingBufferWidth*d.drawingBufferHeight*4,p=new Uint8Array(p),d.readPixels(0,0,h.width,h.height,d.RGBA,d.UNSIGNED_BYTE,p),p):void 0},_getARGB:function(h,d){return d*=4,h[3+d]<<24&4278190080|h[d]<<16&16711680|h[1+d]<<8&65280|255&h[2+d]},_setPixels:function(h,d){for(var p,m=0,g=h.length;m<g;m++)h[0+(p=4*m)]=(16711680&d[m])>>>16,h[1+p]=(65280&d[m])>>>8,h[2+p]=255&d[m],h[3+p]=(4278190080&d[m])>>>24},_toImageData:function(h){return h instanceof ImageData?h:h.getContext("2d").getImageData(0,0,h.width,h.height)},_createImageData:function(h,d){return f._tmpCanvas=document.createElement("canvas"),f._tmpCtx=f._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(h,d)},apply:function(h,b,p){var m=h.getContext("2d"),g=m.getImageData(0,0,h.width,h.height),b=b(g,p);b instanceof ImageData?m.putImageData(b,0,0,0,0,h.width,h.height):m.putImageData(g,0,0,0,0,h.width,h.height)},threshold:function(h){for(var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:.5,p=f._toPixels(h),m=Math.floor(255*d),g=0;g<p.length;g+=4){var b=void 0,b=m<=.2126*p[g]+.7152*p[g+1]+.0722*p[g+2]?255:0;p[g]=p[g+1]=p[g+2]=b}},gray:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4){var m=d[p],g=d[p+1],b=d[p+2];d[p]=d[p+1]=d[p+2]=.2126*m+.7152*g+.0722*b}},opaque:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4)d[p+3]=255;return d},invert:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4)d[p]=255-d[p],d[p+1]=255-d[p+1],d[p+2]=255-d[p+2]},posterize:function(h){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:4,p=f._toPixels(h);if(d<2||255<d)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var m=d-1,g=0;g<p.length;g+=4){var b=p[g],y=p[g+1],v=p[g+2];p[g]=255*(b*d>>8)/m,p[g+1]=255*(y*d>>8)/m,p[g+2]=255*(v*d>>8)/m}},dilate:function(h){for(var d,p,m,g,b,y,v,x,S,w=f._toPixels(h),E=0,j=w.length?w.length/4:0,P=new Int32Array(j);E<j;)for(p=(d=E)+h.width;E<p;)g=m=f._getARGB(w,E),(S=E-1)<d&&(S=E),p<=(x=E+1)&&(x=E),(b=E-h.width)<0&&(b=0),j<=(y=E+h.width)&&(y=E),b=f._getARGB(w,b),S=f._getARGB(w,S),y=f._getARGB(w,y),(g=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))<(v=77*(S>>16&255)+151*(S>>8&255)+28*(255&S))&&(m=S,g=v),g<(v=77*((S=f._getARGB(w,x))>>16&255)+151*(S>>8&255)+28*(255&S))&&(m=S,g=v),g<(x=77*(b>>16&255)+151*(b>>8&255)+28*(255&b))&&(m=b,g=x),g<(S=77*(y>>16&255)+151*(y>>8&255)+28*(255&y))&&(m=y,g=S),P[E++]=m;f._setPixels(w,P)},erode:function(h){for(var d,p,m,g,b,y,v,x,S,w=f._toPixels(h),E=0,j=w.length?w.length/4:0,P=new Int32Array(j);E<j;)for(p=(d=E)+h.width;E<p;)g=m=f._getARGB(w,E),(S=E-1)<d&&(S=E),p<=(x=E+1)&&(x=E),(b=E-h.width)<0&&(b=0),j<=(y=E+h.width)&&(y=E),b=f._getARGB(w,b),S=f._getARGB(w,S),y=f._getARGB(w,y),(v=77*(S>>16&255)+151*(S>>8&255)+28*(255&S))<(g=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))&&(m=S,g=v),(v=77*((S=f._getARGB(w,x))>>16&255)+151*(S>>8&255)+28*(255&S))<g&&(m=S,g=v),(x=77*(b>>16&255)+151*(b>>8&255)+28*(255&b))<g&&(m=b,g=x),(S=77*(y>>16&255)+151*(y>>8&255)+28*(255&y))<g&&(m=y,g=S),P[E++]=m;f._setPixels(w,P)},blur:function(h,d){for(var p,m,g,b,y,v,x,S,w,E,j=f._toPixels(h),P=h.width,M=h.height,O=P*M,k=new Int32Array(O),F=0;F<O;F++)k[F]=f._getARGB(j,F);var A,N,$,G,X,W,V,q,J=new Int32Array(O),ae=new Int32Array(O),I=new Int32Array(O),U=new Int32Array(O),z=0,K=3.5*d|0;if(a!==(K=K<1?1:K<248?K:248)){l=1+(a=K)<<1,c=new Int32Array(l),u=new Array(l);for(var te=0;te<l;te++)u[te]=new Int32Array(256);for(var ne=1,le=K-1;ne<K;ne++){c[K+ne]=c[le]=W=le*le,V=u[K+ne],q=u[le--];for(var me=0;me<256;me++)V[me]=q[me]=W*me}X=c[K]=K*K,V=u[K];for(var ce=0;ce<256;ce++)V[ce]=X*ce}for(N=0;N<M;N++){for(A=0;A<P;A++){if(b=g=m=y=p=0,(v=A-a)<0)E=-v,v=0;else{if(P<=v)break;E=0}for($=E;$<l&&!(P<=v);$++){var ge=k[v+z];G=u[$],y+=G[(-16777216&ge)>>>24],m+=G[(16711680&ge)>>16],g+=G[(65280&ge)>>8],b+=G[255&ge],p+=c[$],v++}J[x=z+A]=y/p,ae[x]=m/p,I[x]=g/p,U[x]=b/p}z+=P}for(w=(S=-a)*P,N=z=0;N<M;N++){for(A=0;A<P;A++){if(b=g=m=y=p=0,S<0)E=x=-S,v=A;else{if(M<=S)break;E=0,x=S,v=A+w}for($=E;$<l&&!(M<=x);$++)G=u[$],y+=G[J[v]],m+=G[ae[v]],g+=G[I[v]],b+=G[U[v]],p+=c[$],x++,v+=P;k[A+z]=y/p<<24|m/p<<16|g/p<<8|b/p}z+=P,w+=P,S++}f._setPixels(j,k)}};i.default=f},{"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.int32-array":222,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239}],302:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=c(r("../core/main")),l=c(r("omggif"));function c(f){return f&&f.__esModule?f:{default:f}}function u(f){return function(h){if(Array.isArray(h)){for(var d=0,p=new Array(h.length);d<h.length;d++)p[d]=h[d];return p}}(f)||function(h){if(Symbol.iterator in Object(h)||Object.prototype.toString.call(h)==="[object Arguments]")return Array.from(h)}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.default.prototype.createImage=function(f,h){return a.default._validateParameters("createImage",arguments),new a.default.Image(f,h)},a.default.prototype.saveCanvas=function(){for(var f,h,d,p,m,g,b=arguments.length,y=new Array(b),v=0;v<b;v++)y[v]=arguments[v];switch(a.default._validateParameters("saveCanvas",y),y[0]instanceof HTMLCanvasElement?(f=y[0],y.shift()):y[0]instanceof a.default.Element?(f=y[0].elt,y.shift()):y[0]instanceof a.default.Framebuffer?(p=y[0],(m=this.createGraphics(p.width,p.height)).pixelDensity(pixelDensity()),p.loadPixels(),m.loadPixels(),m.pixels.set(p.pixels),m.updatePixels(),f=m.elt,y.shift()):f=this._curElement&&this._curElement.elt,1<=y.length&&(h=y[0]),d=(d=2<=y.length?y[1]:d)||a.default.prototype._checkFileExtension(h,d)[1]||"png"){default:g="image/png";break;case"jpeg":case"jpg":g="image/jpeg"}f.toBlob(function(x){a.default.prototype.downloadFile(x,h,d),m&&m.remove()},g)},a.default.prototype.encodeAndDownloadGif=function(f,h){for(var d=f.gifProperties,p=d.loopLimit,m=(p===1?p=null:p===null&&(p=0),new Uint8Array(f.width*f.height*d.numFrames)),g=[],b={},y=0;y<d.numFrames;y++){for(var v=new Set,x=d.frames[y].image.data,S=x.length,w=new Uint32Array(f.width*f.height),E=0,j=0;E<S;E+=4,j++){var P=x[E+0]<<16|x[E+1]<<8|x[E+2]<<0;v.add(P),w[j]=P}var M=u(v).sort().toString();b[M]===void 0?b[M]={freq:1,frames:[y]}:(b[M].freq+=1,b[M].frames.push(y)),g.push(w)}for(var F=[],O=Object.keys(b).sort(function(I,U){return b[U].freq-b[I].freq}),k=O[0].split(",").map(function(I){return parseInt(I)}),F=F.concat(b[k].frames),A=new Set(k),N=1;N<O.length;N++){var $=O[N].split(",").map(function(I){return parseInt(I)}).filter(function(I){return!A.has(I)});if(k.length+$.length<=256){for(var G=0;G<$.length;G++)k.push($[G]),A.add($[G]);F=F.concat(b[O[N]].frames)}}F=new Set(F);for(var X={},W=0;W<k.length;W++)X[k[W]]||(X[k[W]]=W);for(var V=1;V<k.length;)V<<=1;k.length=V;for(var p={loop:p,palette:new Uint32Array(k)},q=new l.default.GifWriter(m,f.width,f.height,p),J={},ae=0;ae<d.numFrames;ae++)(function(U){var z=!F.has(U),K=z?[]:k,te=new Uint8Array(f.width*f.height),ne={},le=new Set,me=(g[U].forEach(function(de,xe){z?(ne[de]===void 0&&(ne[de]=K.length,K.push(de)),te[xe]=ne[de]):te[xe]=X[de],0<U&&g[U-1][xe]!==de&&le.add(de)}),{}),ce=K.filter(function(de){return!le.has(de)});if(0<ce.length){var ce=ce[0],ge=(z?ne:X)[ce];if(0<U){for(var pe=0;pe<g[U].length;pe++)g[U-1][pe]===g[U][pe]&&(te[pe]=ge);me.transparent=ge,J.frameOpts.disposal=1}}if(me.delay=d.frames[U].delay/10,z){for(var oe=1;oe<K.length;)oe<<=1;K.length=oe,me.palette=new Uint32Array(K)}0<U&&q.addFrame(0,0,f.width,f.height,J.pixelPaletteIndex,J.frameOpts),J={pixelPaletteIndex:te,frameOpts:me}})(ae);J.frameOpts.disposal=1,q.addFrame(0,0,f.width,f.height,J.pixelPaletteIndex,J.frameOpts),p=new Blob([m.slice(0,q.end())],{type:"image/gif"}),a.default.prototype.downloadFile(p,h,"gif")},a.default.prototype.saveFrames=function(f,h,d,g,m){a.default._validateParameters("saveFrames",arguments),d=a.default.prototype.constrain(d=d||3,0,15),d*=1e3;var g=a.default.prototype.constrain(g||15,0,22),b=0,y=a.default.prototype._makeFrame,v=this._curElement.elt,x=[],S=setInterval(function(){x.push(y(f+b,h,v)),b++},1e3/g);setTimeout(function(){if(clearInterval(S),m)m(x);else for(var w=0,E=x;w<E.length;w++){var j=E[w];a.default.prototype.downloadFile(j.imageData,j.filename,j.ext)}x=[]},.01+d)},a.default.prototype._makeFrame=function(f,h,m){var p,m=this?this._curElement.elt:m;if(h)switch(h.toLowerCase()){case"png":p="image/png";break;case"jpeg":case"jpg":p="image/jpeg";break;default:p="image/png"}else h="png",p="image/png";var m=(m=m.toDataURL(p)).replace(p,"image/octet-stream"),g={};return g.imageData=m,g.filename=f,g.ext=h,g},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243,omggif:253}],303:[function(r,s,i){function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function l(v){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(x){return a(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":a(x)})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.copy-within"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint8-clamped-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.copy-within"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint8-clamped-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r("regenerator-runtime/runtime");var c=m(r("../core/main")),u=m(r("../core/helpers")),f=function(v){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var x=p();if(x&&x.has(v))return x.get(v);var S,w={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in v){var j;Object.prototype.hasOwnProperty.call(v,S)&&((j=E?Object.getOwnPropertyDescriptor(v,S):null)&&(j.get||j.set)?Object.defineProperty(w,S,j):w[S]=v[S])}return w.default=v,x&&x.set(v,w),w}(r("../core/constants")),h=m(r("omggif")),d=r("gifenc");function p(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,p=function(){return v},v)}function m(v){return v&&v.__esModule?v:{default:v}}function g(v,x,S,w,E,j,P){try{var M=v[j](P),O=M.value}catch(k){return void S(k)}M.done?x(O):Promise.resolve(O).then(w,E)}function b(v,x,S,w,E,j,P,M,O,k,F){var A,N,$,G,X,W,V,q,J;return v===f.COVER&&(A=x,$=S,V=j,q=P,W=M,J=O,N=k,G=F,X=Math.max(V/N,q/G),V/=X,q/=X,X=W,W=J,A===f.CENTER?X+=(N-V)/2:A===f.RIGHT&&(X+=N-V),$===f.CENTER?W+=(G-q)/2:$===f.BOTTOM&&(W+=G-q),M=(J={x:X,y:W,w:V,h:q}).x,O=J.y,k=J.w,F=J.h),v===f.CONTAIN&&(A=x,N=S,$=w,G=E,X=j,W=P,V=k,q=F,J=Math.max(V/X,q/W),V/=J,q/=J,J=$,$=G,A===f.CENTER?J+=(X-V)/2:A===f.RIGHT&&(J+=X-V),N===f.CENTER?$+=(W-q)/2:N===f.BOTTOM&&($+=W-q),w=(v={x:J,y:$,w:V,h:q}).x,E=v.y,j=v.w,P=v.h),{sx:M,sy:O,sw:k,sh:F,dx:w,dy:E,dw:j,dh:P}}function y(v,x){return 0<v&&v<x?v:x}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.loadImage=function(v,x,S){c.default._validateParameters("loadImage",arguments);var w=new c.default.Image(1,1,this),E=this,j=new Request(v,{method:"GET",mode:"cors"});return fetch(v,j).then(function(P){var M,O=P.headers.get("content-type");O===null&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),O&&O.includes("image/gif")?P.arrayBuffer().then(function(k){if(k){for(var k=new Uint8Array(k),F=w,A=x,N=S,$=(function(z){E._decrementPreload()}).bind(E),G=new h.default.GifReader(k),X=(F.width=F.canvas.width=G.width,F.height=F.canvas.height=G.height,[]),W=G.numFrames(),V=new Uint8ClampedArray(F.width*F.height*4),q=0;q<W;q++){var J=G.frameInfo(q),ae=F.drawingContext.getImageData(0,0,F.width,F.height),I=(V=ae.data.slice(),function(z,K){try{K.decodeAndBlitFrameRGBA(z,V)}catch(te){c.default._friendlyFileLoadError(8,F.src),typeof N=="function"?N(te):console.error(te)}}(q,G),new ImageData(V,F.width,F.height)),I=(F.drawingContext.putImageData(I,0,0),J.delay);I===0&&(I=10),X.push({image:F.drawingContext.getImageData(0,0,F.width,F.height),delay:10*I}),J.disposal===2?F.drawingContext.clearRect(J.x,J.y,J.width,J.height):J.disposal===3&&F.drawingContext.putImageData(ae,0,0,J.x,J.y,J.width,J.height)}(k=G.loopCount())===null?k=1:k===0&&(k=null),F.drawingContext.putImageData(X[0].image,0,0),1<X.length&&(F.gifProperties={displayIndex:0,loopLimit:k,loopCount:0,frames:X,numFrames:W,playing:!0,timeDisplayed:0,lastChangeTime:0}),typeof A=="function"&&A(F),$()}},function(k){typeof S=="function"?(S(k),E._decrementPreload()):console.error(k)}):((M=new Image).onload=function(){w.width=w.canvas.width=M.width,w.height=w.canvas.height=M.height,w.drawingContext.drawImage(M,0,0),w.modified=!0,typeof x=="function"&&x(w),E._decrementPreload()},M.onerror=function(k){c.default._friendlyFileLoadError(0,M.src),typeof S=="function"?(S(k),E._decrementPreload()):console.error(k)},v.indexOf("data:image/")!==0&&(M.crossOrigin="Anonymous"),M.src=v),w.modified=!0}).catch(function(P){c.default._friendlyFileLoadError(0,v),typeof S=="function"?(S(P),E._decrementPreload()):console.error(P)}),w},c.default.prototype.saveGif=function(){v=regeneratorRuntime.mark(function S(w,E){var j,P,M,O,k,F,A,N,$,G,X,W,V,q,J,ae,I,U,z,K,te,ne,le,me,ce,ge,pe=arguments;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(j=2<pe.length&&pe[2]!==void 0?pe[2]:{delay:0,units:"seconds",silent:!1,notificationDuration:0,notificationID:"progressBar"},typeof w!="string")throw TypeError("fileName parameter must be a string");oe.next=3;break;case 3:if(typeof E!="number")throw TypeError("Duration parameter must be a number");oe.next=5;break;case 5:if(P=j&&j.delay||0,M=j&&j.units||"seconds",O=j&&j.silent||!1,k=j&&j.notificationDuration||0,F=j&&j.notificationID||"progressBar",typeof P!="number")throw TypeError("Delay parameter must be a number");oe.next=12;break;case 12:if(M!=="seconds"&&M!=="frames")throw TypeError('Units parameter must be either "frames" or "seconds"');oe.next=14;break;case 14:if(typeof O!="boolean")throw TypeError("Silent parameter must be a boolean");oe.next=16;break;case 16:if(typeof k!="number")throw TypeError("Notification duration parameter must be a number");oe.next=18;break;case 18:if(typeof F!="string")throw TypeError("Notification ID parameter must be a string");oe.next=20;break;case 20:return this._recording=!0,G=this._targetFrameRate,A=(A=1/(G=G!==1/0&&G!==void 0&&G!==0?G:60)*1e3)<20?20:A,$=(N=M==="seconds"?E*G:E)+(G=M==="seconds"?P*G:P),G=G,this.frameCount=G,X=this._pixelDensity,this.pixelDensity(1),W=[],document.getElementById(F)!==null&&document.getElementById(F).remove(),O||((V=this.createP("")).id(F),V.style("font-size","16px"),V.style("font-family","Montserrat"),V.style("background-color","#ffffffa0"),V.style("padding","8px"),V.style("border-radius","10px"),V.position(0,0)),this._renderer instanceof c.default.RendererGL&&(J=this.drawingContext,q=new Uint8Array(J.drawingBufferWidth*J.drawingBufferHeight*4)),this.noLoop(),oe.next=39,Promise.resolve();case 39:if(G<$)return this.redraw(),me=void 0,me=this._renderer instanceof c.default.RendererGL?(q=new Uint8Array(J.drawingBufferWidth*J.drawingBufferHeight*4),J.readPixels(0,0,J.drawingBufferWidth,J.drawingBufferHeight,J.RGBA,J.UNSIGNED_BYTE,q),function(de,xe,Te){for(var Se=parseInt(Te/2),je=4*xe,Oe=new Uint8Array(4*xe),We=0;We<Se;++We){var Fe=We*je,ut=(Te-We-1)*je;Oe.set(de.subarray(Fe,Fe+je)),de.copyWithin(Fe,ut,ut+je),de.set(Oe,ut)}return de}(q,this.width,this.height)):this.drawingContext.getImageData(0,0,this.width,this.height).data,W.push(me),G++,O||V.html("Saved frame <b>"+W.length.toString()+"</b> out of "+N.toString()),oe.next=48,new Promise(function(de){return setTimeout(de,0)});oe.next=50;break;case 48:oe.next=39;break;case 50:O||V.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(X),ae=(0,d.GIFEncoder)(),I=function(de){for(var xe=new Uint8Array(de.length*de[0].length),Te=0;Te<de.length;Te++)xe.set(de[Te],Te*de[0].length);var Se=(0,d.quantize)(xe,256,{format:"rgba4444",oneBitAlpha:!0});return Se.length===256?Se[Se.length-1]=[255*Math.random(),255*Math.random(),255*Math.random(),0]:Se.push([255*Math.random(),255*Math.random(),255*Math.random(),0]),Se}(W),U={},z=function(de){for(var xe=de.length/4,Te=new Uint8Array(xe),Se=0;Se<xe;Se++){var je=de[4*Se]<<24|de[4*Se+1]<<16|de[4*Se+2]<<8|de[4*Se+3];U[je]===void 0&&(U[je]=(0,d.nearestColorIndex)(I,de.slice(4*Se,4*(Se+1)))),Te[Se]=U[je]}return Te},K=I.length-1,te=[],ne=0;case 60:if(!(ne<W.length)){oe.next=71;break}if(le=z(W[ne]),me=le.slice(),ne===0)ae.writeFrame(le,this.width,this.height,{palette:I,delay:A,dispose:1});else{for(ce=0;ce<le.length;ce++)le[ce]===te[ce]&&(le[ce]=K);ae.writeFrame(le,this.width,this.height,{delay:A,transparent:!0,transparentIndex:K,dispose:1})}return te=me,O||V.html("Rendered frame <b>"+ne.toString()+"</b> out of "+N.toString()),oe.next=68,new Promise(function(de){return setTimeout(de,0)});case 68:ne++,oe.next=60;break;case 71:ae.finish(),ge=ae.bytesView(),ge=new Blob([ge],{type:"image/gif"}),W=[],this._recording=!1,this.loop(),O||(V.html("Done. Downloading your gif!🌸"),0<k&&setTimeout(function(){return V.remove()},1e3*k)),c.default.prototype.downloadFile(ge,w,"gif");case 80:case"end":return oe.stop()}},S,this)});var v,x=function(){var S=this,w=arguments;return new Promise(function(E,j){var P=v.apply(S,w);function M(k){g(P,E,j,M,O,"next",k)}function O(k){g(P,E,j,M,O,"throw",k)}M(void 0)})};return function(S,w){return x.apply(this,arguments)}}(),c.default.prototype.image=function(v,x,S,w,G,X,W,V,J,k,F,A){c.default._validateParameters("image",arguments);var q=v.width,N=v.height,$=(A=A||f.CENTER,F=F||f.CENTER,v.elt&&(q=q!==void 0?q:v.elt.width,N=N!==void 0?N:v.elt.height),v.elt&&v.elt.videoWidth&&!v.canvas&&(q=q!==void 0?q:v.elt.videoWidth,N=N!==void 0?N:v.elt.videoHeight),w||q),G=G||N,X=X||0,W=W||0,V=y(V!==void 0?V:q,q),q=y(J!==void 0?J:N,N),J=1;v.elt&&!v.canvas&&v.elt.style.width&&(J=v.elt.videoWidth&&!w?v.elt.videoWidth:v.elt.width,J/=parseInt(v.elt.style.width,10)),X*=J,W*=J,q*=J,V*=J,N=b(k,F,A,(N=u.default.modeAdjust(x,S,$,G,this._renderer._imageMode)).x,N.y,N.w,N.h,X,W,V,q),this._renderer.image(v,N.sx,N.sy,N.sw,N.sh,N.dx,N.dy,N.dw,N.dh)},c.default.prototype.tint=function(){for(var v=arguments.length,x=new Array(v),S=0;S<v;S++)x[S]=arguments[S];c.default._validateParameters("tint",x);var w=this.color.apply(this,x);this._renderer._tint=w.levels},c.default.prototype.noTint=function(){this._renderer._tint=null},c.default.prototype._getTintedImageCanvas=c.default.Renderer2D.prototype._getTintedImageCanvas,c.default.prototype.imageMode=function(v){c.default._validateParameters("imageMode",arguments),v!==f.CORNER&&v!==f.CORNERS&&v!==f.CENTER||(this._renderer._imageMode=v)},r=c.default,i.default=r},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/helpers":276,"../core/main":280,"core-js/modules/es.array.copy-within":153,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.typed-array.uint8-clamped-array":240,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,gifenc:250,omggif:253,"regenerator-runtime/runtime":257}],304:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=c(r("../core/main")),l=c(r("./filters"));function c(f){return f&&f.__esModule?f:{default:f}}function u(f,h){for(var d=0;d<h.length;d++){var p=h[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}a.default.Image=function(){function f(p,m){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this.width=p,this.height=m,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),(this._pixelsState=this)._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]}var h,d;return h=f,(d=[{key:"pixelDensity",value:function(p){return p!==void 0?(p<=0&&(a.default._friendlyParamError({type:"INVALID_VALUE",format:{types:["Number"]},position:1},"pixelDensity"),p=1),this._pixelDensity=p,this.width/=p,this.height/=p,this):this._pixelDensity}},{key:"_animateGif",value:function(b){var m,g=this.gifProperties,b=b._lastRealFrameTime||window.performance.now();g.lastChangeTime===0&&(g.lastChangeTime=b),g.playing&&(g.timeDisplayed=b-g.lastChangeTime,m=g.frames[g.displayIndex].delay,g.timeDisplayed>=m&&(m=Math.floor(g.timeDisplayed/m),g.timeDisplayed=0,g.lastChangeTime=b,g.displayIndex+=m,g.loopCount=Math.floor(g.displayIndex/g.numFrames),g.loopLimit!==null&&g.loopCount>=g.loopLimit?g.playing=!1:(b=g.displayIndex%g.numFrames,this.drawingContext.putImageData(g.frames[b].image,0,0),g.displayIndex=b,this.setModified(!0))))}},{key:"_setProperty",value:function(p,m){this[p]=m,this.setModified(!0)}},{key:"loadPixels",value:function(){a.default.Renderer2D.prototype.loadPixels.call(this),this.setModified(!0)}},{key:"updatePixels",value:function(p,m,g,b){a.default.Renderer2D.prototype.updatePixels.call(this,p,m,g,b),this.setModified(!0)}},{key:"get",value:function(p,m,g,b){return a.default._validateParameters("p5.Image.get",arguments),a.default.Renderer2D.prototype.get.apply(this,arguments)}},{key:"_getPixel",value:function(){for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];return a.default.Renderer2D.prototype._getPixel.apply(this,m)}},{key:"set",value:function(p,m,g){a.default.Renderer2D.prototype.set.call(this,p,m,g),this.setModified(!0)}},{key:"resize",value:function(p,m){p===0&&m===0?(p=this.canvas.width,m=this.canvas.height):p===0?p=this.canvas.width*m/this.canvas.height:m===0&&(m=this.canvas.height*p/this.canvas.width),p=Math.floor(p),m=Math.floor(m);var g=document.createElement("canvas");if(g.width=p,g.height=m,this.gifProperties)for(var b=this.gifProperties,y=0;y<b.numFrames;y++){for(var v=this.drawingContext.createImageData(p,m),x=(P=P=j=E=w=void 0,b.frames[y].image),S=v,w=0,E=0;E<S.height;E++)for(var j=0;j<S.width;j++){var P=Math.floor(j*x.width/S.width),P=4*(Math.floor(E*x.height/S.height)*x.width+P);S.data[w++]=x.data[P++],S.data[w++]=x.data[P++],S.data[w++]=x.data[P++],S.data[w++]=x.data[+P]}b.frames[y].image=v}g.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,g.width,g.height),this.canvas.width=this.width=p,this.canvas.height=this.height=m,this.drawingContext.drawImage(g,0,0,p,m,0,0,p,m),0<this.pixels.length&&this.loadPixels(),this.setModified(!0)}},{key:"copy",value:function(){for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];a.default.prototype.copy.apply(this,m)}},{key:"mask",value:function(p){var m=this.drawingContext.globalCompositeOperation,g=1,b=[p=p===void 0?this:p,0,0,(g=p instanceof a.default.Renderer?p._pInst._pixelDensity:g)*p.width,g*p.height,0,0,this.width,this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(var y=0;y<this.gifProperties.frames.length;y++)this.drawingContext.putImageData(this.gifProperties.frames[y].image,0,0),this.copy.apply(this,b),this.gifProperties.frames[y].image=this.drawingContext.getImageData(0,0,this.width,this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else this.copy.apply(this,b);this.drawingContext.globalCompositeOperation=m,this.setModified(!0)}},{key:"filter",value:function(p,m){l.default.apply(this.canvas,l.default[p],m),this.setModified(!0)}},{key:"blend",value:function(){for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];a.default._validateParameters("p5.Image.blend",arguments),a.default.prototype.blend.apply(this,m),this.setModified(!0)}},{key:"setModified",value:function(p){this._modified=p}},{key:"isModified",value:function(){return this._modified}},{key:"save",value:function(p,m){this.gifProperties?a.default.prototype.encodeAndDownloadGif(this,p):a.default.prototype.saveCanvas(this.canvas,p,m)}},{key:"reset",value:function(){var p;this.gifProperties&&((p=this.gifProperties).playing=!0,p.timeSinceStart=0,p.timeDisplayed=0,p.lastChangeTime=0,p.loopCount=0,p.displayIndex=0,this.drawingContext.putImageData(p.frames[0].image,0,0))}},{key:"getCurrentFrame",value:function(){var p;if(this.gifProperties)return(p=this.gifProperties).displayIndex%p.numFrames}},{key:"setFrame",value:function(p){var m;this.gifProperties&&(p<(m=this.gifProperties).numFrames&&0<=p?(m.timeDisplayed=0,m.lastChangeTime=0,m.displayIndex=p,this.drawingContext.putImageData(m.frames[p].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero."))}},{key:"numFrames",value:function(){if(this.gifProperties)return this.gifProperties.numFrames}},{key:"play",value:function(){this.gifProperties&&(this.gifProperties.playing=!0)}},{key:"pause",value:function(){this.gifProperties&&(this.gifProperties.playing=!1)}},{key:"delay",value:function(p,m){if(this.gifProperties){var g=this.gifProperties;if(m<g.numFrames&&0<=m)g.frames[m].delay=p;else{var b=!0,m=!1,y=void 0;try{for(var v,x=g.frames[Symbol.iterator]();!(b=(v=x.next()).done);b=!0)v.value.delay=p}catch(w){m=!0,y=w}finally{try{b||x.return==null||x.return()}finally{if(m)throw y}}}}}}])&&u(h.prototype,d),f}(),r=a.default.Image,i.default=r},{"../core/main":280,"./filters":301,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],305:[function(r,s,i){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.filter"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=c(r("../core/main")),l=c(r("./filters"));function c(u){return u&&u.__esModule?u:{default:u}}r("../color/p5.Color"),a.default.prototype.pixels=[],a.default.prototype.blend=function(){for(var u,f=arguments.length,h=new Array(f),d=0;d<f;d++)h[d]=arguments[d];a.default._validateParameters("blend",h),this._renderer?(u=this._renderer).blend.apply(u,h):a.default.Renderer2D.prototype.blend.apply(this,h)},a.default.prototype.copy=function(){for(var u,f,h,d,p,m,g,b,y,v=arguments.length,x=new Array(v),S=0;S<v;S++)x[S]=arguments[S];if(a.default._validateParameters("copy",x),x.length===9)u=x[0],f=x[1],h=x[2],d=x[3],p=x[4],m=x[5],g=x[6],b=x[7],y=x[8];else{if(x.length!==8)throw new Error("Signature not supported");u=this,f=x[0],h=x[1],d=x[2],p=x[3],m=x[4],g=x[5],b=x[6],y=x[7]}a.default.prototype._copyHelper(this,u,f,h,d,p,m,g,b,y)},a.default.prototype._copyHelper=function(u,f,h,d,p,m,g,b,y,v){var x=f.canvas.width/f.width,S=0,w=0;f._renderer&&f._renderer.isP3D&&(S=f.width/2,w=f.height/2),u._renderer&&u._renderer.isP3D?(u.push(),u.resetMatrix(),u.noLights(),u.blendMode(u.BLEND),u.imageMode(u.CORNER),a.default.RendererGL.prototype.image.call(u._renderer,f,h+S,d+w,p,m,g,b,y,v),u.pop()):u.drawingContext.drawImage(f.canvas,x*(h+S),x*(d+w),x*p,x*m,g,b,y,v)},a.default.prototype.getFilterGraphicsLayer=function(){return this._renderer.getFilterGraphicsLayer()},a.default.prototype.filter=function(){for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];a.default._validateParameters("filter",f);var g=(function(){var b,y={shader:void 0,operation:void 0,value:void 0,useWebGL:!0};return(arguments.length<=0?void 0:arguments[0])instanceof a.default.Shader?y.shader=arguments.length<=0?void 0:arguments[0]:(y.operation=arguments.length<=0?void 0:arguments[0],1<arguments.length&&typeof(arguments.length<=1?void 0:arguments[1])=="number"&&(y.value=arguments.length<=1?void 0:arguments[1]),((b=arguments.length-1)<0||arguments.length<=b?void 0:arguments[b])===!1&&(y.useWebGL=!1)),y}).apply(void 0,f),d=g.shader,p=g.operation,m=g.value,g=g.useWebGL;this._renderer.isP3D&&d?a.default.RendererGL.prototype.filter.call(this._renderer,d):g||this._renderer.isP3D?(!g&&this._renderer.isP3D&&console.warn("filter() with useWebGL=false is not supported in WEBGL"),this._renderer.isP3D?a.default.RendererGL.prototype.filter.call(this._renderer,p,m):((d=this.getFilterGraphicsLayer()).copy(this._renderer,0,0,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height),this._renderer.clear(),this._renderer.resetMatrix(),d.filter.apply(d,f),this.copy(d._renderer,0,0,this.width,this.height,0,0,this.width,this.height),d.clear())):this.canvas!==void 0?l.default.apply(this.canvas,l.default[p],m):l.default.apply(this.elt,l.default[p],m)},a.default.prototype.get=function(u,f,h,d){var p;return a.default._validateParameters("get",arguments),(p=this._renderer).get.apply(p,arguments)},a.default.prototype.loadPixels=function(){for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];a.default._validateParameters("loadPixels",f),this._renderer.loadPixels()},a.default.prototype.set=function(u,f,h){this._renderer.set(u,f,h)},a.default.prototype.updatePixels=function(u,f,h,d){a.default._validateParameters("updatePixels",arguments),this.pixels.length!==0&&this._renderer.updatePixels(u,f,h,d)},r=a.default,i.default=r},{"../color/p5.Color":267,"../core/main":280,"./filters":301,"core-js/modules/es.array.filter":156}],306:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=f(r("../core/main")),c=(r("whatwg-fetch"),r("es6-promise/auto"),f(r("fetch-jsonp"))),u=f(r("file-saver"));function f(m){return m&&m.__esModule?m:{default:m}}function h(m){return(h=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}function d(m){return m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function p(m,g){g&&g!==!0&&g!=="true"||(g="");var b="";return(m=m||"untitled")&&m.includes(".")&&(b=m.split(".").pop()),g&&b!==g&&(b=g,m="".concat(m,".").concat(b)),[m,b]}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),l.default.prototype.loadJSON=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];l.default._validateParameters("loadJSON",g);for(var y,v,x,S=g[0],w={},E="json",j=1;j<g.length;j++){var P=g[j];typeof P=="string"?P!=="jsonp"&&P!=="json"||(E=P):typeof P=="function"?y?v=P:y=P:h(P)==="object"&&(P.hasOwnProperty("jsonpCallback")||P.hasOwnProperty("jsonpCallbackFunction"))&&(E="jsonp",x=P)}var M=this;return this.httpDo(S,"GET",x,E,function(O){for(var k in O)w[k]=O[k];y!==void 0&&y(O),M._decrementPreload()},function(O){if(l.default._friendlyFileLoadError(5,S),!v)throw O;v(O)}),w},l.default.prototype.loadStrings=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];l.default._validateParameters("loadStrings",g);for(var y,v,x=[],S=1;S<g.length;S++){var w=g[S];typeof w=="function"&&(y===void 0?y=w:v===void 0&&(v=w))}var E=this;return l.default.prototype.httpDo.call(this,g[0],"GET","text",function(j){for(var P=j.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/),M=0,O=P.length;M<O;M+=32768)Array.prototype.push.apply(x,P.slice(M,Math.min(M+32768,O)));y!==void 0&&y(x),E._decrementPreload()},function(j){if(l.default._friendlyFileLoadError(3,j),!v)throw j;v(j)}),x},l.default.prototype.loadTable=function(m){var g,b,y,v=!1,x=m.substring(m.lastIndexOf(".")+1,m.length);x==="csv"?y=",":x==="ssv"?y=";":x==="tsv"&&(y="	");for(var S=1;S<arguments.length;S++)typeof arguments[S]=="function"?g===void 0?g=arguments[S]:b===void 0&&(b=arguments[S]):typeof arguments[S]=="string"&&(arguments[S]==="header"&&(v=!0),arguments[S]==="csv"?y=",":arguments[S]==="ssv"?y=";":arguments[S]==="tsv"&&(y="	"));var w=new l.default.Table,E=this;return this.httpDo(m,"GET","table",function(j){for(var P,M,O={},k=0,F=[],A=0,N=null,$=function(){O.currentState=k,O.token=""},G=function(){N.push(O.token),$()},X=function(){O.currentState=4,F.push(N),N=null};;){if((P=j[A++])==null){if(O.escaped)throw new Error("Unclosed quote in file.");if(N){G(),X();break}}if(N===null&&(O.escaped=!1,N=[],$()),O.currentState===k){if(P==='"'){O.escaped=!0,O.currentState=1;continue}O.currentState=1}if(O.currentState===1&&O.escaped)if(P==='"')j[A]==='"'?(O.token+='"',A++):(O.escaped=!1,O.currentState=2);else{if(P==="\r")continue;O.token+=P}else P==="\r"?(j[A]===`
`&&A++,G(),X()):P===`
`?(G(),X()):P===y?G():O.currentState===1&&(O.token+=P)}if(v)w.columns=F.shift();else for(var W=0;W<F[0].length;W++)w.columns[W]="null";for(var V=0;V<F.length;V++)(F[V].length!==1||F[V][0]!=="undefined"&&F[V][0]!=="")&&((M=new l.default.TableRow).arr=F[V],M.obj=function(q,J){if((J=J||[])===void 0)for(var ae=0;ae<q.length;ae++)J[ae.toString()]=ae;return Object.fromEntries(J.map(function(I,U){return[I,q[U]]}))}(F[V],w.columns),w.addRow(M));typeof g=="function"&&g(w),E._decrementPreload()},function(j){l.default._friendlyFileLoadError(2,m),b?b(j):console.error(j)}),w},l.default.prototype.loadXML=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];for(var y,v,x=new l.default.XML,S=1;S<g.length;S++){var w=g[S];typeof w=="function"&&(y===void 0?y=w:v===void 0&&(v=w))}var E=this;return this.httpDo(g[0],"GET","xml",function(j){for(var P in j)x[P]=j[P];y!==void 0&&y(x),E._decrementPreload()},function(j){if(l.default._friendlyFileLoadError(1,j),!v)throw j;v(j)}),x},l.default.prototype.loadBytes=function(m,g,b){var y={},v=this;return this.httpDo(m,"GET","arrayBuffer",function(x){y.bytes=new Uint8Array(x),typeof g=="function"&&g(y),v._decrementPreload()},function(x){if(l.default._friendlyFileLoadError(6,m),!b)throw x;b(x)}),y},l.default.prototype.httpGet=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];return l.default._validateParameters("httpGet",g),g.splice(1,0,"GET"),l.default.prototype.httpDo.apply(this,g)},l.default.prototype.httpPost=function(){for(var m=arguments.length,g=new Array(m),b=0;b<m;b++)g[b]=arguments[b];return l.default._validateParameters("httpPost",g),g.splice(1,0,"POST"),l.default.prototype.httpDo.apply(this,g)},l.default.prototype.httpDo=function(){for(var m,g,b,y={},v=0,x="text/plain",S=arguments.length-1;0<S&&typeof(S<0||arguments.length<=S?void 0:arguments[S])=="function";S--)v++;var w=arguments.length-v,E=arguments.length<=0?void 0:arguments[0];if(w==2&&typeof E=="string"&&h(arguments.length<=1?void 0:arguments[1])==="object")F=new Request(E,arguments.length<=1?void 0:arguments[1]),g=arguments.length<=2?void 0:arguments[2],b=arguments.length<=3?void 0:arguments[3];else{for(var j,P="GET",M=1;M<arguments.length;M++){var O=M<0||arguments.length<=M?void 0:arguments[M];if(typeof O=="string")O==="GET"||O==="POST"||O==="PUT"||O==="DELETE"?P=O:O==="json"||O==="jsonp"||O==="binary"||O==="arrayBuffer"||O==="xml"||O==="text"||O==="table"?m=O:j=O;else if(typeof O=="number")j=O.toString();else if(h(O)==="object")if(O.hasOwnProperty("jsonpCallback")||O.hasOwnProperty("jsonpCallbackFunction"))for(var k in O)y[k]=O[k];else x=O instanceof l.default.XML?(j=O.serialize(),"application/xml"):(j=JSON.stringify(O),"application/json");else typeof O=="function"&&(g?b=O:g=O)}var w=P==="GET"?new Headers:new Headers({"Content-Type":x}),F=new Request(E,{method:P,mode:"cors",body:j,headers:w})}return(w=(w=(m=m||(E.includes("json")?"json":E.includes("xml")?"xml":"text"))==="jsonp"?(0,c.default)(E,y):fetch(F)).then(function(A){if(!A.ok)throw(N=new Error(A.body)).status=A.status,N.ok=!1,N;var N=0;switch((N=m!=="jsonp"?A.headers.get("content-length"):N)&&64e6<N&&l.default._friendlyFileLoadError(7,E),m){case"json":case"jsonp":return A.json();case"binary":return A.blob();case"arrayBuffer":return A.arrayBuffer();case"xml":return A.text().then(function($){return $=new DOMParser().parseFromString($,"text/xml"),new l.default.XML($.documentElement)});default:return A.text()}})).then(g||function(){}),w.catch(b||console.error),w},window.URL=window.URL||window.webkitURL,l.default.prototype._pWriters=[],l.default.prototype.createWriter=function(m,g){var b,y;for(y in l.default.prototype._pWriters)if(l.default.prototype._pWriters[y].name===m)return b=new l.default.PrintWriter(m+this.millis(),g),l.default.prototype._pWriters.push(b),b;return b=new l.default.PrintWriter(m,g),l.default.prototype._pWriters.push(b),b},l.default.PrintWriter=function(m,g){var b=this;this.name=m,this.content="",this.write=function(y){this.content+=y},this.print=function(y){this.content+="".concat(y,`
`)},this.clear=function(){this.content=""},this.close=function(){var y,v=[];for(y in v.push(this.content),l.default.prototype.writeFile(v,m,g),l.default.prototype._pWriters)l.default.prototype._pWriters[y].name===this.name&&l.default.prototype._pWriters.splice(y,1);b.clear(),b={}}},l.default.prototype.save=function(m,g,b){var y=arguments,v=(this._curElement||this).elt;if(y.length===0)l.default.prototype.saveCanvas(v);else if(y[0]instanceof l.default.Renderer||y[0]instanceof l.default.Graphics)l.default.prototype.saveCanvas(y[0].elt,y[1],y[2]);else if(y.length===1&&typeof y[0]=="string")l.default.prototype.saveCanvas(v,y[0]);else switch(p(y[1],y[2])[1]){case"json":return void l.default.prototype.saveJSON(y[0],y[1],y[2]);case"txt":return void l.default.prototype.saveStrings(y[0],y[1],y[2]);default:y[0]instanceof Array?l.default.prototype.saveStrings(y[0],y[1],y[2]):y[0]instanceof l.default.Table?l.default.prototype.saveTable(y[0],y[1],y[2]):y[0]instanceof l.default.Image?l.default.prototype.saveCanvas(y[0].canvas,y[1]):y[0]instanceof l.default.SoundFile&&l.default.prototype.saveSound(y[0],y[1],y[2],y[3])}},l.default.prototype.saveJSON=function(m,g,b){l.default._validateParameters("saveJSON",arguments),b=b?JSON.stringify(m):JSON.stringify(m,void 0,2),this.saveStrings(b.split(`
`),g,"json")},l.default.prototype.saveJSONObject=l.default.prototype.saveJSON,l.default.prototype.saveJSONArray=l.default.prototype.saveJSON,l.default.prototype.saveStrings=function(m,g,b,y){l.default._validateParameters("saveStrings",arguments);for(var v=this.createWriter(g,b||"txt"),x=0;x<m.length;x++)y?v.write(m[x]+`\r
`):v.write(m[x]+`
`);v.close(),v.clear()},l.default.prototype.saveTable=function(m,g,b){l.default._validateParameters("saveTable",arguments),y=b===void 0?g.substring(g.lastIndexOf(".")+1,g.length):b;var y,v=this.createWriter(g,y),x=m.columns,S=y==="tsv"?"	":",";if(y!=="html"){if(x[0]!=="0"){for(var w=0;w<x.length;w++)w<x.length-1?v.write(x[w]+S):v.write(x[w]);v.write(`
`)}for(var E=0;E<m.rows.length;E++){for(var j=void 0,j=0;j<m.rows[E].arr.length;j++)j<m.rows[E].arr.length-1?y==="csv"&&String(m.rows[E].arr[j]).includes(",")?v.write('"'+m.rows[E].arr[j]+'"'+S):v.write(m.rows[E].arr[j]+S):y==="csv"&&String(m.rows[E].arr[j]).includes(",")?v.write('"'+m.rows[E].arr[j]+'"'):v.write(m.rows[E].arr[j]);v.write(`
`)}}else{if(v.print("<html>"),v.print("<head>"),v.print('  <meta http-equiv="content-type" content="text/html;charset=utf-8" />'),v.print("</head>"),v.print("<body>"),v.print("  <table>"),x[0]!=="0"){v.print("    <tr>");for(var P=0;P<x.length;P++){var M=d(x[P]);v.print("      <td>".concat(M)),v.print("      </td>")}v.print("    </tr>")}for(var O=0;O<m.rows.length;O++){v.print("    <tr>");for(var k=0;k<m.columns.length;k++){var F=d(m.rows[O].getString(k));v.print("      <td>".concat(F)),v.print("      </td>")}v.print("    </tr>")}v.print("  </table>"),v.print("</body>"),v.print("</html>")}v.close(),v.clear()},l.default.prototype.writeFile=function(v,g,b){var y="application/octet-stream",v=(l.default.prototype._isSafari()&&(y="text/plain"),new Blob(v,{type:y}));l.default.prototype.downloadFile(v,g,b)},l.default.prototype.downloadFile=function(m,v,x){var y,v=p(v,x),x=v[0];m instanceof Blob?u.default.saveAs(m,x):((y=document.createElement("a")).href=m,y.download=x,y.onclick=function(S){document.body.removeChild(S.target),S.stopPropagation()},y.style.display="none",document.body.appendChild(y),l.default.prototype._isSafari()&&(m=(m=`Hello, Safari user! To download this file...
1. Go to File --> Save As.
2. Choose "Page Source" as the Format.
`)+'3. Name it with this extension: ."'.concat(v[1],'"'),alert(m)),y.click())},l.default.prototype._checkFileExtension=p,l.default.prototype._isSafari=function(){return window.HTMLElement.toString().includes("Constructor")},r=l.default,i.default=r},{"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.object.from-entries":182,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.iterator":243,"core-js/modules/web.url":245,"es6-promise/auto":246,"fetch-jsonp":248,"file-saver":249,"whatwg-fetch":258}],307:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}a.default.Table=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.columns=[],this.rows=[]}var u,f;return u=c,(f=[{key:"addRow",value:function(h){if(h=h||new a.default.TableRow,h.arr===void 0||h.obj===void 0)throw new Error("invalid TableRow: ".concat(h));return(h.table=this).rows.push(h),h}},{key:"removeRow",value:function(h){this.rows[h].table=null,h=this.rows.splice(h+1,this.rows.length),this.rows.pop(),this.rows=this.rows.concat(h)}},{key:"getRow",value:function(h){return this.rows[h]}},{key:"getRows",value:function(){return this.rows}},{key:"findRow",value:function(h,d){if(typeof d=="string"){for(var p=0;p<this.rows.length;p++)if(this.rows[p].obj[d]===h)return this.rows[p]}else for(var m=0;m<this.rows.length;m++)if(this.rows[m].arr[d]===h)return this.rows[m];return null}},{key:"findRows",value:function(h,d){var p=[];if(typeof d=="string")for(var m=0;m<this.rows.length;m++)this.rows[m].obj[d]===h&&p.push(this.rows[m]);else for(var g=0;g<this.rows.length;g++)this.rows[g].arr[d]===h&&p.push(this.rows[g]);return p}},{key:"matchRow",value:function(h,d){if(typeof d=="number"){for(var p=0;p<this.rows.length;p++)if(this.rows[p].arr[d].match(h))return this.rows[p]}else for(var m=0;m<this.rows.length;m++)if(this.rows[m].obj[d].match(h))return this.rows[m];return null}},{key:"matchRows",value:function(h,d){var p=[];if(typeof d=="number")for(var m=0;m<this.rows.length;m++)this.rows[m].arr[d].match(h)&&p.push(this.rows[m]);else for(var g=0;g<this.rows.length;g++)this.rows[g].obj[d].match(h)&&p.push(this.rows[g]);return p}},{key:"getColumn",value:function(h){var d=[];if(typeof h=="string")for(var p=0;p<this.rows.length;p++)d.push(this.rows[p].obj[h]);else for(var m=0;m<this.rows.length;m++)d.push(this.rows[m].arr[h]);return d}},{key:"clearRows",value:function(){delete this.rows,this.rows=[]}},{key:"addColumn",value:function(h){this.columns.push(h||null)}},{key:"getColumnCount",value:function(){return this.columns.length}},{key:"getRowCount",value:function(){return this.rows.length}},{key:"removeTokens",value:function(h,d){for(var p=[],m=0;m<h.length;m++)p.push(h.charAt(m).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var g=new RegExp(p.join("|"),"g");if(d===void 0)for(var b=0;b<this.columns.length;b++)for(var y=0;y<this.rows.length;y++){var v=(v=this.rows[y].arr[b]).replace(g,"");this.rows[y].arr[b]=v,this.rows[y].obj[this.columns[b]]=v}else if(typeof d=="string")for(var x=0;x<this.rows.length;x++){var S=(S=this.rows[x].obj[d]).replace(g,""),w=(this.rows[x].obj[d]=S,this.columns.indexOf(d));this.rows[x].arr[w]=S}else for(var E=0;E<this.rows.length;E++){var j=(j=this.rows[E].arr[d]).replace(g,"");this.rows[E].arr[d]=j,this.rows[E].obj[this.columns[d]]=j}}},{key:"trim",value:function(h){var d=new RegExp(" ","g");if(h===void 0)for(var p=0;p<this.columns.length;p++)for(var m=0;m<this.rows.length;m++){var g=(g=this.rows[m].arr[p]).replace(d,"");this.rows[m].arr[p]=g,this.rows[m].obj[this.columns[p]]=g}else if(typeof h=="string")for(var b=0;b<this.rows.length;b++){var y=(y=this.rows[b].obj[h]).replace(d,""),v=(this.rows[b].obj[h]=y,this.columns.indexOf(h));this.rows[b].arr[v]=y}else for(var x=0;x<this.rows.length;x++){var S=(S=this.rows[x].arr[h]).replace(d,"");this.rows[x].arr[h]=S,this.rows[x].obj[this.columns[h]]=S}}},{key:"removeColumn",value:function(m){typeof m=="string"?p=this.columns.indexOf(d=m):d=this.columns[p=m];var d,p,m=this.columns.splice(p+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(m);for(var g=0;g<this.rows.length;g++){var b=this.rows[g].arr,y=b.splice(p+1,b.length);b.pop(),this.rows[g].arr=b.concat(y),delete this.rows[g].obj[d]}}},{key:"set",value:function(h,d,p){this.rows[h].set(d,p)}},{key:"setNum",value:function(h,d,p){this.rows[h].setNum(d,p)}},{key:"setString",value:function(h,d,p){this.rows[h].setString(d,p)}},{key:"get",value:function(h,d){return this.rows[h].get(d)}},{key:"getNum",value:function(h,d){return this.rows[h].getNum(d)}},{key:"getString",value:function(h,d){return this.rows[h].getString(d)}},{key:"getObject",value:function(h){for(var d,p={},m=0;m<this.rows.length;m++)if(d=this.rows[m].obj,typeof h=="string"){if(!(0<=this.columns.indexOf(h)))throw new Error('This table has no column named "'.concat(h,'"'));p[d[h]]=d}else p[m]=this.rows[m].obj;return p}},{key:"getArray",value:function(){for(var h=[],d=0;d<this.rows.length;d++)h.push(this.rows[d].arr);return h}}])&&l(u.prototype,f),c}(),r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.join":165,"core-js/modules/es.array.splice":170,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201}],308:[function(r,s,i){r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function a(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.TableRow=function(){function l(f,h){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");var d=[];f&&(d=f.split(h=h||",")),this.arr=d,this.obj=Object.fromEntries(d.entries()),this.table=null}var c,u;return c=l,(u=[{key:"set",value:function(f,h){if(typeof f=="string"){var d=this.table.columns.indexOf(f);if(!(0<=d))throw new Error('This table has no column named "'.concat(f,'"'));this.obj[f]=h,this.arr[d]=h}else{if(!(f<this.table.columns.length))throw new Error("Column #".concat(f," is out of the range of this table"));this.arr[f]=h,d=this.table.columns[f],this.obj[d]=h}}},{key:"setNum",value:function(f,h){h=parseFloat(h),this.set(f,h)}},{key:"setString",value:function(f,h){h=h.toString(),this.set(f,h)}},{key:"get",value:function(f){return(typeof f=="string"?this.obj:this.arr)[f]}},{key:"getNum",value:function(f){var h=parseFloat(typeof f=="string"?this.obj[f]:this.arr[f]);if(h.toString()==="NaN")throw"Error: ".concat(this.obj[f]," is NaN (Not a Number)");return h}},{key:"getString",value:function(f){return(typeof f=="string"?this.obj:this.arr)[f].toString()}}])&&a(c.prototype,u),l}(),r=r.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.from-entries":182,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.split":203,"core-js/modules/web.dom-collections.iterator":243}],309:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u,f){for(var h=0;h<f.length;h++){var d=f[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}function c(u){for(var f=[],h=0;h<u.length;h++)f.push(new a.default.XML(u[h]));return f}a.default.XML=function(){function u(d){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");d?this.DOM=d:(d=document.implementation.createDocument(null,"doc"),this.DOM=d.createElement("root"))}var f,h;return f=u,(h=[{key:"getParent",value:function(){return new a.default.XML(this.DOM.parentElement)}},{key:"getName",value:function(){return this.DOM.tagName}},{key:"setName",value:function(d){var p=this.DOM.innerHTML,m=this.DOM.attributes,g=document.implementation.createDocument(null,"default").createElement(d);g.innerHTML=p;for(var b=0;b<m.length;b++)g.setAttribute(m[b].nodeName,m.nodeValue);this.DOM=g}},{key:"hasChildren",value:function(){return 0<this.DOM.children.length}},{key:"listChildren",value:function(){for(var d=[],p=0;p<this.DOM.childNodes.length;p++)d.push(this.DOM.childNodes[p].nodeName);return d}},{key:"getChildren",value:function(d){return c(d?this.DOM.getElementsByTagName(d):this.DOM.children)}},{key:"getChild",value:function(d){if(typeof d!="string")return new a.default.XML(this.DOM.children[d]);var p=!0,m=!1,g=void 0;try{for(var b,y=this.DOM.children[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var v=b.value;if(v.tagName===d)return new a.default.XML(v)}}catch(x){m=!0,g=x}finally{try{p||y.return==null||y.return()}finally{if(m)throw g}}}},{key:"addChild",value:function(d){d instanceof a.default.XML&&this.DOM.appendChild(d.DOM)}},{key:"removeChild",value:function(d){var p=-1;if(typeof d=="string"){for(var m=0;m<this.DOM.children.length;m++)if(this.DOM.children[m].tagName===d){p=m;break}}else p=d;p!==-1&&this.DOM.removeChild(this.DOM.children[p])}},{key:"getAttributeCount",value:function(){return this.DOM.attributes.length}},{key:"listAttributes",value:function(){var d=[],p=!0,m=!1,g=void 0;try{for(var b,y=this.DOM.attributes[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var v=b.value;d.push(v.nodeName)}}catch(x){m=!0,g=x}finally{try{p||y.return==null||y.return()}finally{if(m)throw g}}return d}},{key:"hasAttribute",value:function(d){var p={},m=!0,g=!1,b=void 0;try{for(var y,v=this.DOM.attributes[Symbol.iterator]();!(m=(y=v.next()).done);m=!0){var x=y.value;p[x.nodeName]=x.nodeValue}}catch(S){g=!0,b=S}finally{try{m||v.return==null||v.return()}finally{if(g)throw b}}return!!p[d]}},{key:"getNum",value:function(d,p){var m={},g=!0,b=!1,y=void 0;try{for(var v,x=this.DOM.attributes[Symbol.iterator]();!(g=(v=x.next()).done);g=!0){var S=v.value;m[S.nodeName]=S.nodeValue}}catch(w){b=!0,y=w}finally{try{g||x.return==null||x.return()}finally{if(b)throw y}}return Number(m[d])||p||0}},{key:"getString",value:function(d,p){var m={},g=!0,b=!1,y=void 0;try{for(var v,x=this.DOM.attributes[Symbol.iterator]();!(g=(v=x.next()).done);g=!0){var S=v.value;m[S.nodeName]=S.nodeValue}}catch(w){b=!0,y=w}finally{try{g||x.return==null||x.return()}finally{if(b)throw y}}return m[d]?String(m[d]):p||null}},{key:"setAttribute",value:function(d,p){this.DOM.setAttribute(d,p)}},{key:"getContent",value:function(d){var p=this.DOM.textContent;return(p=p.replace(/\s\s+/g,","))||d||null}},{key:"setContent",value:function(d){this.DOM.children.length||(this.DOM.textContent=d)}},{key:"serialize",value:function(){return new XMLSerializer().serializeToString(this.DOM)}}])&&l(f.prototype,h),u}(),r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],310:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.string.includes"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c){return function(u){if(Array.isArray(u)){for(var f=0,h=new Array(u.length);f<u.length;f++)h[f]=u[f];return h}}(c)||function(u){if(Symbol.iterator in Object(u)||Object.prototype.toString.call(u)==="[object Arguments]")return Array.from(u)}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.default.prototype.abs=Math.abs,a.default.prototype.ceil=Math.ceil,a.default.prototype.constrain=function(c,u,f){return a.default._validateParameters("constrain",arguments),Math.max(Math.min(c,f),u)},a.default.prototype.dist=function(){for(var c=arguments.length,u=new Array(c),f=0;f<c;f++)u[f]=arguments[f];return a.default._validateParameters("dist",u),u.length===4?Math.hypot(u[2]-u[0],u[3]-u[1]):u.length===6?Math.hypot(u[3]-u[0],u[4]-u[1],u[5]-u[2]):void 0},a.default.prototype.exp=Math.exp,a.default.prototype.floor=Math.floor,a.default.prototype.lerp=function(c,u,f){return a.default._validateParameters("lerp",arguments),f*(u-c)+c},a.default.prototype.log=Math.log,a.default.prototype.mag=function(c,u){return a.default._validateParameters("mag",arguments),Math.hypot(c,u)},a.default.prototype.map=function(c,u,f,h,d,p){return a.default._validateParameters("map",arguments),c=(c-u)/(f-u)*(d-h)+h,p?h<d?this.constrain(c,h,d):this.constrain(c,d,h):c},a.default.prototype.max=function(){for(var c=function(d){return Math.max.apply(Math,l(d))},u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return Array.isArray(f[0])?c(f[0]):c(f)},a.default.prototype.min=function(){for(var c=function(d){return Math.min.apply(Math,l(d))},u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return Array.isArray(f[0])?c(f[0]):c(f)},a.default.prototype.norm=function(c,u,f){return a.default._validateParameters("norm",arguments),this.map(c,u,f,0,1)},a.default.prototype.pow=Math.pow,a.default.prototype.round=function(c,u){return u?(u=Math.pow(10,u),Math.round(c*u)/u):Math.round(c)},a.default.prototype.sq=function(c){return c*c},a.default.prototype.sqrt=Math.sqrt,a.default.prototype.fract=function(h){a.default._validateParameters("fract",arguments);var u,f=0,h=Number(h);return isNaN(h)||Math.abs(h)===1/0?h:(h<0&&(h=-h,f=1),String(h).includes(".")&&!String(h).includes("e")?(u=String(h),u=+("0"+u.slice(u.indexOf("."))),Math.abs(f-u)):h<1?Math.abs(f-h):0)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],311:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u,f,h){return(l=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?Reflect.construct:function(d,p,m){var g=[null];return g.push.apply(g,p),p=new(Function.bind.apply(d,g)),m&&c(p,m.prototype),p}).apply(null,arguments)}function c(u,f){return(c=Object.setPrototypeOf||function(h,d){return h.__proto__=d,h})(u,f)}a.default.prototype.createVector=function(u,f,h){return this instanceof a.default?l(a.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments))):new a.default.Vector(u,f,h)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193}],312:[function(h,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,h=(h=h("../core/main"))&&h.__esModule?h:{default:h};function a(d){return .5*(1-Math.cos(d*Math.PI))}var l,c=4095,u=4,f=.5,h=(h.default.prototype.noise=function(d){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(l==null){l=new Array(4096);for(var g=0;g<4096;g++)l[g]=Math.random()}d<0&&(d=-d),p<0&&(p=-p),m<0&&(m=-m);for(var b,y,v=Math.floor(d),x=Math.floor(p),S=Math.floor(m),w=d-v,E=p-x,j=m-S,P=0,M=.5,O=0;O<u;O++){var k=v+(x<<4)+(S<<8),F=a(w),A=a(E),N=l[k&c];N+=F*(l[k+1&c]-N),b=l[k+16&c],N+=A*((b+=F*(l[k+16+1&c]-b))-N),b=l[(k+=256)&c],b+=F*(l[k+1&c]-b),y=l[k+16&c],b+=A*((y+=F*(l[k+16+1&c]-y))-b),P+=(N+=a(j)*(b-N))*M,M*=f,v<<=1,x<<=1,S<<=1,1<=(w*=2)&&(v++,w--),1<=(E*=2)&&(x++,E--),1<=(j*=2)&&(S++,j--)}return P},h.default.prototype.noiseDetail=function(d,p){0<d&&(u=d),0<p&&(f=p)},h.default.prototype.noiseSeed=function(d){g=4294967296;var p,m,g,b={setSeed:function(v){m=p=(v??Math.random()*g)>>>0},getSeed:function(){return p},rand:function(){return(m=(1664525*m+1013904223)%g)/g}};b.setSeed(d),l=new Array(4096);for(var y=0;y<4096;y++)l[y]=b.rand()},h.default);i.default=h},{"../core/main":280}],313:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}function l(p){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.some"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.number.is-finite"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.some"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.number.is-finite"),r("core-js/modules/es.string.sub"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(d=r("../core/main"))&&d.__esModule?d:{default:d},u=function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var m=f();if(m&&m.has(p))return m.get(p);var g,b={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=y?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,m&&m.set(p,b),b}(r("../core/constants"));function f(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,f=function(){return p},p)}function h(p,m){for(var g=0;g<m.length;g++){var b=m[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}c.default.Vector=function(){function p(){var S=this,y=p;if(!(S instanceof y))throw new TypeError("Cannot call a class as a function");var v,x,S=typeof(arguments.length<=0?void 0:arguments[0])=="function"?(this.isPInst=!0,this._fromRadians=arguments.length<=0?void 0:arguments[0],this._toRadians=arguments.length<=1?void 0:arguments[1],v=(arguments.length<=2?void 0:arguments[2])||0,x=(arguments.length<=3?void 0:arguments[3])||0,(arguments.length<=4?void 0:arguments[4])||0):(v=(arguments.length<=0?void 0:arguments[0])||0,x=(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0);this.x=v,this.y=x,this.z=S}var m,g,b;return m=p,b=[{key:"fromAngle",value:function(y){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;return new c.default.Vector(v*Math.cos(y),v*Math.sin(y),0)}},{key:"fromAngles",value:function(j,w){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,S=Math.cos(w),w=Math.sin(w),E=Math.cos(j),j=Math.sin(j);return new c.default.Vector(x*j*w,-x*E,x*j*S)}},{key:"random2D",value:function(){return this.fromAngle(Math.random()*u.TWO_PI)}},{key:"random3D",value:function(){var y=Math.random()*u.TWO_PI,v=2*Math.random()-1,S=Math.sqrt(1-v*v),x=S*Math.cos(y),S=S*Math.sin(y);return new c.default.Vector(x,S,v)}},{key:"copy",value:function(y){return y.copy(y)}},{key:"add",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return E?E.set(S):(E=S.copy(),v.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),E.add(w),E}},{key:"rem",value:function(y,v){if(y instanceof c.default.Vector&&v instanceof c.default.Vector)return(y=y.copy()).rem(v),y}},{key:"sub",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return E?E.set(S):(E=S.copy(),v.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),E.sub(w),E}},{key:"mult",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return E?E.set(S):(E=S.copy(),v.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),E.mult(w),E}},{key:"rotate",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return v.length===2?E=S.copy():(E instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),E.set(S)),E.rotate(w),E}},{key:"div",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return E?E.set(S):(E=S.copy(),v.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),E.div(w),E}},{key:"dot",value:function(y,v){return y.dot(v)}},{key:"cross",value:function(y,v){return y.cross(v)}},{key:"dist",value:function(y,v){return y.dist(v)}},{key:"lerp",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2],j=v[3];return j?j.set(S):(j=S.copy(),v.length===4&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),j.lerp(w,E),j}},{key:"slerp",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2],j=v[3];return j?j.set(S):(j=S.copy(),v.length===4&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")),j.slerp(w,E),j}},{key:"mag",value:function(y){return y.mag()}},{key:"magSq",value:function(y){return y.magSq()}},{key:"normalize",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1];return v.length<2?w=S.copy():(w instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),w.set(S)),w.normalize()}},{key:"limit",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return v.length<3?E=S.copy():(E instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),E.set(S)),E.limit(w)}},{key:"setMag",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return v.length<3?E=S.copy():(E instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),E.set(S)),E.setMag(w)}},{key:"heading",value:function(y){return y.heading()}},{key:"angleBetween",value:function(y,v){return y.angleBetween(v)}},{key:"reflect",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];return v.length<3?E=S.copy():(E instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),E.set(S)),E.reflect(w)}},{key:"array",value:function(y){return y.array()}},{key:"equals",value:function(y,v){var x;return y instanceof c.default.Vector?x=y:Array.isArray(y)?x=new c.default.Vector().set(y):c.default._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),x.equals(v)}}],(g=[{key:"toString",value:function(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")}},{key:"set",value:function(y,v,x){return y instanceof c.default.Vector?(this.x=y.x||0,this.y=y.y||0,this.z=y.z||0):Array.isArray(y)?(this.x=y[0]||0,this.y=y[1]||0,this.z=y[2]||0):(this.x=y||0,this.y=v||0,this.z=x||0),this}},{key:"copy",value:function(){return this.isPInst?new c.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z):new c.default.Vector(this.x,this.y,this.z)}},{key:"add",value:function(y,v,x){return y instanceof c.default.Vector?(this.x+=y.x||0,this.y+=y.y||0,this.z+=y.z||0):Array.isArray(y)?(this.x+=y[0]||0,this.y+=y[1]||0,this.z+=y[2]||0):(this.x+=y||0,this.y+=v||0,this.z+=x||0),this}},{key:"calculateRemainder2D",value:function(y,v){return y!==0&&(this.x=this.x%y),v!==0&&(this.y=this.y%v),this}},{key:"calculateRemainder3D",value:function(y,v,x){return y!==0&&(this.x=this.x%y),v!==0&&(this.y=this.y%v),x!==0&&(this.z=this.z%x),this}},{key:"rem",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S,w,E,j=v[0],P=v[1],M=v[2];if(j instanceof c.default.Vector){if([j.x,j.y,j.z].every(Number.isFinite))return S=parseFloat(j.x),w=parseFloat(j.y),E=parseFloat(j.z),this.calculateRemainder3D(S,w,E)}else if(Array.isArray(j)){if(j.every(Number.isFinite))return j.length===2?this.calculateRemainder2D(j[0],j[1]):j.length===3?this.calculateRemainder3D(j[0],j[1],j[2]):void 0}else if(v.length===1){if(Number.isFinite(j)&&j!==0)return this.x=this.x%j,this.y=this.y%j,this.z=this.z%j,this}else if(v.length===2){if(v.every(Number.isFinite))return this.calculateRemainder2D(j,P)}else if(v.length===3&&v.every(Number.isFinite))return this.calculateRemainder3D(j,P,M)}},{key:"sub",value:function(y,v,x){return y instanceof c.default.Vector?(this.x-=y.x||0,this.y-=y.y||0,this.z-=y.z||0):Array.isArray(y)?(this.x-=y[0]||0,this.y-=y[1]||0,this.z-=y[2]||0):(this.x-=y||0,this.y-=v||0,this.z-=x||0),this}},{key:"mult",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S,w=v[0],E=v[1],j=v[2];return w instanceof c.default.Vector?Number.isFinite(w.x)&&Number.isFinite(w.y)&&Number.isFinite(w.z)&&typeof w.x=="number"&&typeof w.y=="number"&&typeof w.z=="number"?(this.x*=w.x,this.y*=w.y,this.z*=w.z):console.warn("p5.Vector.prototype.mult:","x contains components that are either undefined or not finite numbers"):Array.isArray(w)?w.every(function(P){return Number.isFinite(P)})&&w.every(function(P){return typeof P=="number"})?w.length===1?(this.x*=w[0],this.y*=w[0],this.z*=w[0]):w.length===2?(this.x*=w[0],this.y*=w[1]):w.length===3&&(this.x*=w[0],this.y*=w[1],this.z*=w[2]):console.warn("p5.Vector.prototype.mult:","x contains elements that are either undefined or not finite numbers"):(S=v).every(function(P){return Number.isFinite(P)})&&S.every(function(P){return typeof P=="number"})?(v.length===1&&(this.x*=w,this.y*=w,this.z*=w),v.length===2&&(this.x*=w,this.y*=E),v.length===3&&(this.x*=w,this.y*=E,this.z*=j)):console.warn("p5.Vector.prototype.mult:","x, y, or z arguments are either undefined or not a finite number"),this}},{key:"div",value:function(){for(var y=arguments.length,v=new Array(y),x=0;x<y;x++)v[x]=arguments[x];var S=v[0],w=v[1],E=v[2];if(S instanceof c.default.Vector)if(Number.isFinite(S.x)&&Number.isFinite(S.y)&&Number.isFinite(S.z)&&typeof S.x=="number"&&typeof S.y=="number"&&typeof S.z=="number"){var j=S.z===0&&this.z===0;if(S.x===0||S.y===0||!j&&S.z===0)return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this.x/=S.x,this.y/=S.y,j||(this.z/=S.z)}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if(Array.isArray(S))if(S.every(Number.isFinite)&&S.every(function(P){return typeof P=="number"})){if(S.some(function(P){return P===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;S.length===1?(this.x/=S[0],this.y/=S[0],this.z/=S[0]):S.length===2?(this.x/=S[0],this.y/=S[1]):S.length===3&&(this.x/=S[0],this.y/=S[1],this.z/=S[2])}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if(v.every(Number.isFinite)&&v.every(function(P){return typeof P=="number"})){if(v.some(function(P){return P===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;v.length===1&&(this.x/=S,this.y/=S,this.z/=S),v.length===2&&(this.x/=S,this.y/=w),v.length===3&&(this.x/=S,this.y/=w,this.z/=E)}else console.warn("p5.Vector.prototype.div:","x, y, or z arguments are either undefined or not a finite number");return this}},{key:"mag",value:function(){return Math.sqrt(this.magSq())}},{key:"magSq",value:function(){var y=this.x,v=this.y,x=this.z;return y*y+v*v+x*x}},{key:"dot",value:function(y,v,x){return y instanceof c.default.Vector?this.dot(y.x,y.y,y.z):this.x*(y||0)+this.y*(v||0)+this.z*(x||0)}},{key:"cross",value:function(S){var v=this.y*S.z-this.z*S.y,x=this.z*S.x-this.x*S.z,S=this.x*S.y-this.y*S.x;return this.isPInst?new c.default.Vector(this._fromRadians,this._toRadians,v,x,S):new c.default.Vector(v,x,S)}},{key:"dist",value:function(y){return y.copy().sub(this).mag()}},{key:"normalize",value:function(){var y=this.mag();return y!==0&&this.mult(1/y),this}},{key:"limit",value:function(y){var v=this.magSq();return y*y<v&&this.div(Math.sqrt(v)).mult(y),this}},{key:"setMag",value:function(y){return this.normalize().mult(y)}},{key:"heading",value:function(){var y=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(y):y}},{key:"setHeading",value:function(y){this.isPInst&&(y=this._toRadians(y));var v=this.mag();return this.x=v*Math.cos(y),this.y=v*Math.sin(y),this}},{key:"rotate",value:function(v){var v=this.heading()+v,x=(this.isPInst&&(v=this._toRadians(v)),this.mag());return this.x=Math.cos(v)*x,this.y=Math.sin(v)*x,this}},{key:"angleBetween",value:function(y){var v;return this.magSq()*y.magSq()==0?NaN:(v=this.cross(y),y=Math.atan2(v.mag(),this.dot(y))*Math.sign(v.z||1),this.isPInst?this._fromRadians(y):y)}},{key:"lerp",value:function(y,v,x,S){return y instanceof c.default.Vector?this.lerp(y.x,y.y,y.z,v):(this.x+=(y-this.x)*S||0,this.y+=(v-this.y)*S||0,this.z+=(x-this.z)*S||0,this)}},{key:"slerp",value:function(y,v){if(v!==0){if(v===1)return this.set(y);var x=this.mag(),S=y.mag();if(x*S==0)this.mult(1-v).add(y.x*v,y.y*v,y.z*v);else{var w=this.cross(y),E=w.mag(),j=Math.atan2(E,this.dot(y));if(0<E)w.x/=E,w.y/=E,w.z/=E;else{if(j<.5*Math.PI)return this.mult(1-v).add(y.x*v,y.y*v,y.z*v),this;this.z===0&&y.z===0?w.set(0,0,1):this.x!==0?w.set(this.y,-this.x,0).normalize():w.set(1,0,0)}E=w.cross(this),y=1-v+v*S/x,w=y*Math.cos(v*j),S=y*Math.sin(v*j),this.x=this.x*w+E.x*S,this.y=this.y*w+E.y*S,this.z=this.z*w+E.z*S}}return this}},{key:"reflect",value:function(y){return y.normalize(),this.sub(y.mult(2*this.dot(y)))}},{key:"array",value:function(){return[this.x||0,this.y||0,this.z||0]}},{key:"equals",value:function(E,v,x){var S,w,E=E instanceof c.default.Vector?(S=E.x||0,w=E.y||0,E.z||0):Array.isArray(E)?(S=E[0]||0,w=E[1]||0,E[2]||0):(S=E||0,w=v||0,x||0);return this.x===S&&this.y===w&&this.z===E}}])&&h(m.prototype,g),b&&h(m,b),p}();var d=c.default.Vector;i.default=d},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.every":154,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.some":169,"core-js/modules/es.math.sign":177,"core-js/modules/es.number.constructor":178,"core-js/modules/es.number.is-finite":179,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],314:[function(f,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(f=f("../core/main"))&&f.__esModule?f:{default:f},l="_lcg_random_state",c=4294967296,u=0,f=(a.default.prototype._lcg=function(h){return this[h]=(1664525*this[h]+1013904223)%c,this[h]/c},a.default.prototype._lcgSetSeed=function(h,d){this[h]=(d??Math.random()*c)>>>0},a.default.prototype.randomSeed=function(h){this._lcgSetSeed(l,h),this._gaussian_previous=!1},a.default.prototype.random=function(h,d){var p,m;return a.default._validateParameters("random",arguments),p=this[l]!=null?this._lcg(l):Math.random(),h===void 0?p:d===void 0?Array.isArray(h)?h[Math.floor(p*h.length)]:p*h:(d<h&&(m=h,h=d,d=m),p*(d-h)+h)},a.default.prototype.randomGaussian=function(h){var d,p,m,g,b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(this._gaussian_previous)d=u,this._gaussian_previous=!1;else{for(;1<=(g=(p=this.random(2)-1)*p+(m=this.random(2)-1)*m););d=p*(g=Math.sqrt(-2*Math.log(g)/g)),u=m*g,this._gaussian_previous=!0}return d*b+(h||0)},a.default);i.default=f},{"../core/main":280}],315:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.prototype._angleMode=u.RADIANS,c.default.prototype.acos=function(d){return this._fromRadians(Math.acos(d))},c.default.prototype.asin=function(d){return this._fromRadians(Math.asin(d))},c.default.prototype.atan=function(d){return this._fromRadians(Math.atan(d))},c.default.prototype.atan2=function(d,p){return this._fromRadians(Math.atan2(d,p))},c.default.prototype.cos=function(d){return Math.cos(this._toRadians(d))},c.default.prototype.sin=function(d){return Math.sin(this._toRadians(d))},c.default.prototype.tan=function(d){return Math.tan(this._toRadians(d))},c.default.prototype.degrees=function(d){return d*u.RAD_TO_DEG},c.default.prototype.radians=function(d){return d*u.DEG_TO_RAD},c.default.prototype.angleMode=function(d){if(c.default._validateParameters("angleMode",arguments),d===void 0)return this._angleMode;d!==u.DEGREES&&d!==u.RADIANS||d!==this._angleMode&&(d===u.RADIANS?(this._setProperty("pRotationX",this.pRotationX*u.DEG_TO_RAD),this._setProperty("pRotationY",this.pRotationY*u.DEG_TO_RAD),this._setProperty("pRotationZ",this.pRotationZ*u.DEG_TO_RAD)):(this._setProperty("pRotationX",this.pRotationX*u.RAD_TO_DEG),this._setProperty("pRotationY",this.pRotationY*u.RAD_TO_DEG),this._setProperty("pRotationZ",this.pRotationZ*u.RAD_TO_DEG)),this._angleMode=d)},c.default.prototype._toRadians=function(d){return this._angleMode===u.DEGREES?d*u.DEG_TO_RAD:d},c.default.prototype._toDegrees=function(d){return this._angleMode===u.RADIANS?d*u.RAD_TO_DEG:d},c.default.prototype._fromRadians=function(d){return this._angleMode===u.DEGREES?d*u.RAD_TO_DEG:d},c.default.prototype._fromDegrees=function(d){return this._angleMode===u.RADIANS?d*u.DEG_TO_RAD:d};var h=c.default;i.default=h},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],316:[function(r,s,i){r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};a.default.prototype.textAlign=function(l,c){var u;return a.default._validateParameters("textAlign",arguments),(u=this._renderer).textAlign.apply(u,arguments)},a.default.prototype.textLeading=function(l){var c;return a.default._validateParameters("textLeading",arguments),(c=this._renderer).textLeading.apply(c,arguments)},a.default.prototype.textSize=function(l){var c;return a.default._validateParameters("textSize",arguments),(c=this._renderer).textSize.apply(c,arguments)},a.default.prototype.textStyle=function(l){var c;return a.default._validateParameters("textStyle",arguments),(c=this._renderer).textStyle.apply(c,arguments)},a.default.prototype.textWidth=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];if(c[0]+="",a.default._validateParameters("textWidth",c),c[0].length===0)return 0;for(var f=c[0].replace(/\t/g,"  ").split(/\r?\n|\r|\n/g),h=[],d=0;d<f.length;d++)h.push(this._renderer.textWidth(f[d]));return Math.max.apply(Math,h)},a.default.prototype.textAscent=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return a.default._validateParameters("textAscent",c),this._renderer.textAscent()},a.default.prototype.textDescent=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return a.default._validateParameters("textDescent",c),this._renderer.textDescent()},a.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},a.default.prototype.textWrap=function(l){if(l!=="WORD"&&l!=="CHAR")throw"Error: textWrap accepts only WORD or CHAR";return this._renderer.textWrap(l)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203}],317:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function l(m){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.split"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=d(r("../core/constants")),f=d(r("opentype.js"));function h(){var m;return typeof WeakMap!="function"?null:(m=new WeakMap,h=function(){return m},m)}function d(m){if(m&&m.__esModule)return m;if(m===null||l(m)!=="object"&&typeof m!="function")return{default:m};var g=h();if(g&&g.has(m))return g.get(m);var b,y,v={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in m)Object.prototype.hasOwnProperty.call(m,b)&&((y=x?Object.getOwnPropertyDescriptor(m,b):null)&&(y.get||y.set)?Object.defineProperty(v,b,y):v[b]=m[b]);return v.default=m,g&&g.set(m,v),v}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.loadFont=function(m,g,b){c.default._validateParameters("loadFont",arguments);var y=new c.default.Font(this),v=this;return f.load(m,function(w,E){if(w)return c.default._friendlyFileLoadError(4,m),b!==void 0?b(w):void console.error(w,m);y.font=E,g!==void 0&&g(y),v._decrementPreload();var w=m.split("\\").pop().split("/").pop(),E=w.lastIndexOf("."),j=E<1?null:w.slice(E+1);["ttf","otf","woff","woff2"].includes(j)&&(j=w.slice(0,E!==-1?E:0),(w=document.createElement("style")).appendChild(document.createTextNode(`
@font-face {
font-family: `.concat(j,`;
src: url(`).concat(m,`);
}
`))),document.head.appendChild(w))}),y},c.default.prototype.text=function(m,g,b,y,v){var x;return c.default._validateParameters("text",arguments),this._renderer._doFill||this._renderer._doStroke?(x=this._renderer).text.apply(x,arguments):this},c.default.prototype.textFont=function(m,g){if(c.default._validateParameters("textFont",arguments),arguments.length){if(m)return this._renderer._setProperty("_textFont",m),g&&(this._renderer._setProperty("_textSize",g),this._renderer._leadingSet||this._renderer._setProperty("_textLeading",g*u._DEFAULT_LEADMULT)),this._renderer._applyTextProperties();throw new Error("null font passed to textFont")}return this._renderer._textFont};var p=c.default;i.default=p},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,"opentype.js":254}],318:[function(r,s,i){function a(P){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M})(P)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(l=r("../core/main"))&&l.__esModule?l:{default:l},c=function(P){if(P&&P.__esModule)return P;if(P===null||f(P)!=="object"&&typeof P!="function")return{default:P};var M=u();if(M&&M.has(P))return M.get(P);var O,k={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(O in P){var A;Object.prototype.hasOwnProperty.call(P,O)&&((A=F?Object.getOwnPropertyDescriptor(P,O):null)&&(A.get||A.set)?Object.defineProperty(k,O,A):k[O]=P[O])}return k.default=P,M&&M.set(P,k),k}(r("../core/constants"));function u(){var P;return typeof WeakMap!="function"?null:(P=new WeakMap,u=function(){return P},P)}function f(P){return(f=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(M){return a(M)}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":a(M)})(P)}function h(P,M){for(var O=0;O<M.length;O++){var k=M[O];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(P,k.key,k)}}function d(P,M){var O=P.length;return P[M<0?M%O+O:M%O]}function p(P,M,O,k){var F,A,N;return k?(p.tmpPoint1===void 0&&(p.tmpPoint1=[],p.tmpPoint2=[]),A=p.tmpPoint1,N=p.tmpPoint2,A.x=M.x-P.x,A.y=M.y-P.y,N.x=O.x-M.x,N.y=O.y-M.y,F=A.x*N.x+A.y*N.y,A=Math.sqrt(A.x*A.x+A.y*A.y),N=Math.sqrt(N.x*N.x+N.y*N.y),Math.acos(F/(A*N))<k):(M[0]-P[0])*(O[1]-P[1])-(O[0]-P[0])*(M[1]-P[1])==0}function m(U,K,z,te,ne,A,N,$,G){var X=1-G,V=Math.pow(X,3),q=Math.pow(X,2),I=G*G,J=I*G,W=V*U+3*q*G*z+3*X*G*G*ne+J*N,V=V*K+3*q*G*te+3*X*G*G*A+J*$,q=U+2*G*(z-U)+I*(ne-2*z+U),J=K+2*G*(te-K)+I*(A-2*te+K),ae=z+2*G*(ne-z)+I*(N-2*ne+z),I=te+2*G*(A-te)+I*($-2*A+te),U=X*U+G*z,z=X*K+G*te,K=X*ne+G*N,te=X*A+G*$,ne=90-180*Math.atan2(q-ae,J-I)/Math.PI;return(ae<q||J<I)&&(ne+=180),{x:W,y:V,m:{x:q,y:J},n:{x:ae,y:I},start:{x:U,y:z},end:{x:K,y:te},alpha:ne}}function g(P,M,O,k,F,A,N,$,G){return G==null?E(P,M,O,k,F,A,N,$):m(P,M,O,k,F,A,N,$,function(X,W,V,q,J,ae,I,U,z){if(!(z<0||E(X,W,V,q,J,ae,I,U)<z)){var K,te=.5,ne=1-te;for(K=E(X,W,V,q,J,ae,I,U,ne);.01<Math.abs(K-z);)K=E(X,W,V,q,J,ae,I,U,ne+=(K<z?1:-1)*(te/=2));return ne}}(P,M,O,k,F,A,N,$,G))}function b(P,M,O){for(var k,F,A,N,$,G=0,X=0,W=(P=function(V,q){function J(Se,je,Oe){var We,Fe;if(!Se)return["C",je.x,je.y,je.x,je.y,je.x,je.y];switch(Se[0]in{T:1,Q:1}||(je.qx=je.qy=null),Se[0]){case"M":je.X=Se[1],je.Y=Se[2];break;case"A":Se=["C"].concat(v.apply(0,[je.x,je.y].concat(Se.slice(1))));break;case"S":Fe=Oe==="C"||Oe==="S"?(We=2*je.x-je.bx,2*je.y-je.by):(We=je.x,je.y),Se=["C",We,Fe].concat(Se.slice(1));break;case"T":Oe==="Q"||Oe==="T"?(je.qx=2*je.x-je.qx,je.qy=2*je.y-je.qy):(je.qx=je.x,je.qy=je.y),Se=["C"].concat(w(je.x,je.y,je.qx,je.qy,Se[1],Se[2]));break;case"Q":je.qx=Se[1],je.qy=Se[2],Se=["C"].concat(w(je.x,je.y,Se[1],Se[2],Se[3],Se[4]));break;case"L":Se=["C"].concat(S(je.x,je.y,Se[1],Se[2]));break;case"H":Se=["C"].concat(S(je.x,je.y,Se[1],je.y));break;case"V":Se=["C"].concat(S(je.x,je.y,je.x,Se[1]));break;case"Z":Se=["C"].concat(S(je.x,je.y,je.X,je.Y))}return Se}function ae(Se,je){if(7<Se[je].length){Se[je].shift();for(var Oe=Se[je];Oe.length;)le[je]="A",K&&(me[je]="A"),Se.splice(je++,0,["C"].concat(Oe.splice(0,6)));Se.splice(je,1),U=Math.max(z.length,K&&K.length||0)}}function I(Se,je,Oe,We,Fe){Se&&je&&Se[Fe][0]==="M"&&je[Fe][0]!=="M"&&(je.splice(Fe,0,["M",We.x,We.y]),Oe.bx=0,Oe.by=0,Oe.x=Se[Fe][1],Oe.y=Se[Fe][2],U=Math.max(z.length,K&&K.length||0))}var U,z=y(V),K=q&&y(q),te={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},ne={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},le=[],me=[],ce="",ge="";U=Math.max(z.length,K&&K.length||0);for(var pe=0;pe<U;pe++){(ce=z[pe]?z[pe][0]:ce)!=="C"&&(le[pe]=ce,pe&&(ge=le[pe-1])),z[pe]=J(z[pe],te,ge),le[pe]!=="A"&&ce==="C"&&(le[pe]="C"),ae(z,pe),K&&((ce=K[pe]?K[pe][0]:ce)!=="C"&&(me[pe]=ce,pe&&(ge=me[pe-1])),K[pe]=J(K[pe],ne,ge),me[pe]!=="A"&&ce==="C"&&(me[pe]="C"),ae(K,pe)),I(z,K,te,ne,pe),I(K,z,ne,te,pe);var oe=z[pe],de=K&&K[pe],xe=oe.length,Te=K&&de.length;te.x=oe[xe-2],te.y=oe[xe-1],te.bx=parseFloat(oe[xe-4])||te.x,te.by=parseFloat(oe[xe-3])||te.y,ne.bx=K&&(parseFloat(de[Te-4])||ne.x),ne.by=K&&(parseFloat(de[Te-3])||ne.y),ne.x=K&&de[Te-2],ne.y=K&&de[Te-1]}return K?[z,K]:z}(P)).length;X<W;X++){if((A=P[X])[0]==="M")k=+A[1],F=+A[2];else{if(M<G+(N=g(k,F,A[1],A[2],A[3],A[4],A[5],A[6]))&&!O)return{x:($=g(k,F,A[1],A[2],A[3],A[4],A[5],A[6],M-G)).x,y:$.y,alpha:$.alpha};G+=N,k=+A[5],F=+A[6]}A.shift()}return $=($=O?G:m(k,F,A[0],A[1],A[2],A[3],A[4],A[5],1)).alpha?{x:$.x,y:$.y,alpha:$.alpha}:$}function y(P){var M=[],O=0,k=0,F=0,A=0,N=0;if(P){P[0][0]==="M"&&(F=O=+P[0][1],A=k=+P[0][2],N++,M[0]=["M",O,k]);for(var $,G,X=P.length===3&&P[0][0]==="M"&&P[1][0].toUpperCase()==="R"&&P[2][0].toUpperCase()==="Z",W=N,V=P.length;W<V;W++){if(M.push($=[]),(G=P[W])[0]!==G[0].toUpperCase())switch($[0]=G[0].toUpperCase(),$[0]){case"A":$[1]=G[1],$[2]=G[2],$[3]=G[3],$[4]=G[4],$[5]=G[5],$[6]=+(G[6]+O),$[7]=+(G[7]+k);break;case"V":$[1]=+G[1]+k;break;case"H":$[1]=+G[1]+O;break;case"R":for(var q,J=2,ae=(q=[O,k].concat(G.slice(1))).length;J<ae;J++)q[J]=+q[J]+O,q[++J]=+q[J]+k;M.pop(),M=M.concat(x(q,X));break;case"M":F=+G[1]+O,A=+G[2]+k;break;default:for(var I=1,U=G.length;I<U;I++)$[I]=+G[I]+(I%2?O:k)}else if(G[0]==="R")q=[O,k].concat(G.slice(1)),M.pop(),M=M.concat(x(q,X)),$=["R"].concat(G.slice(-2));else for(var z=0,K=G.length;z<K;z++)$[z]=G[z];switch($[0]){case"Z":O=F,k=A;break;case"H":O=$[1];break;case"V":k=$[1];break;case"M":F=$[$.length-2],A=$[$.length-1];break;default:O=$[$.length-2],k=$[$.length-1]}}}return M}function v(P,M,O,k,K,le,te,$,G,X){function W(Te,Se,je){return{x:Te*Math.cos(je)-Se*Math.sin(je),y:Te*Math.sin(je)+Se*Math.cos(je)}}var V,U=Math.PI,z=120*U/180,q=U/180*(+K||0),J=[],ae=(X?(pe=X[0],V=X[1],ce=X[2],ge=X[3]):(P=(ne=W(P,M,-q)).x,M=ne.y,1<(ae=(I=(P-($=(ne=W($,G,-q)).x))/2)*I/(O*O)+(ne=(M-(G=ne.y))/2)*ne/(k*k))&&(O*=ae=Math.sqrt(ae),k*=ae),ae=O*O,me=k*k,ce=(le=(le===te?-1:1)*Math.sqrt(Math.abs((ae*me-ae*ne*ne-me*I*I)/(ae*ne*ne+me*I*I))))*O*ne/k+(P+$)/2,ge=le*-k*I/O+(M+G)/2,pe=Math.asin(((M-ge)/k).toFixed(9)),V=Math.asin(((G-ge)/k).toFixed(9)),(pe=P<ce?U-pe:pe)<0&&(pe=2*U+pe),(V=$<ce?U-V:V)<0&&(V=2*U+V),te&&V<pe&&(pe-=2*U),!te&&pe<V&&(V-=2*U)),V-pe),I=(Math.abs(ae)>z&&(me=V,ne=$,le=G,V=pe+z*(te&&pe<V?1:-1),J=v($=ce+O*Math.cos(V),G=ge+k*Math.sin(V),O,k,K,0,te,ne,le,[V,me,ce,ge])),ae=V-pe,Math.cos(pe)),U=Math.sin(pe),z=Math.cos(V),K=Math.sin(V),te=Math.tan(ae/4),ne=4/3*O*te,le=4/3*k*te,me=[P,M],ce=[P+ne*U,M-le*I],ge=[$+ne*K,G-le*z],pe=[$,G];if(ce[0]=2*me[0]-ce[0],ce[1]=2*me[1]-ce[1],X)return[ce,ge,pe].concat(J);for(var oe=[],de=0,xe=(J=[ce,ge,pe].concat(J).join().split(",")).length;de<xe;de++)oe[de]=de%2?W(J[de-1],J[de],q).y:W(J[de],J[de+1],q).x;return oe}function x(P,M){for(var O=[],k=0,F=P.length;k<F-2*!M;k+=2){var A=[{x:+P[k-2],y:+P[k-1]},{x:+P[k],y:+P[k+1]},{x:+P[k+2],y:+P[k+3]},{x:+P[k+4],y:+P[k+5]}];M?k?F-4===k?A[3]={x:+P[0],y:+P[1]}:F-2===k&&(A[2]={x:+P[0],y:+P[1]},A[3]={x:+P[2],y:+P[3]}):A[0]={x:+P[F-2],y:+P[F-1]}:F-4===k?A[3]=A[2]:k||(A[0]={x:+P[k],y:+P[k+1]}),O.push(["C",(-A[0].x+6*A[1].x+A[2].x)/6,(-A[0].y+6*A[1].y+A[2].y)/6,(A[1].x+6*A[2].x-A[3].x)/6,(A[1].y+6*A[2].y-A[3].y)/6,A[2].x,A[2].y])}return O}function S(P,M,O,k){return[P,M,O,k,O,k]}function w(P,M,O,k,F,A){return[1/3*P+2/3*O,1/3*M+2/3*k,1/3*F+2/3*O,1/3*A+2/3*k,F,A]}function E(P,M,O,k,F,A,N,$,G){for(var X=(G=1<(G=G??1)?1:G<0?0:G)/2,W=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],V=0,q=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],J=0;J<12;J++){var I=X*W[J]+X,ae=j(I,P,O,F,N),I=j(I,M,k,A,$);V+=q[J]*Math.sqrt(ae*ae+I*I)}return X*V}function j(P,M,O,k,F){return P*(P*(-3*M+9*O-9*k+3*F)+6*M-12*O+6*k)-3*M+3*O}l.default.Font=function(){function P(k){if(!(this instanceof P))throw new TypeError("Cannot call a class as a function");this.parent=k,this.cache={},this.font=void 0}var M,O;return M=P,(O=[{key:"textBounds",value:function(k){var F=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,X=3<arguments.length?arguments[3]:void 0,N=4<arguments.length?arguments[4]:void 0,$=N&&N.renderer&&N.renderer._pInst||this.parent,G=$._renderer.drawingContext,X=(G.textAlign||c.LEFT,G.textBaseline||c.BASELINE,X||$._renderer._textSize);if(!ne){for(var W=[],V=[],q=[],J=(q[0]=[],[]),ae=this._scale(X),I=$._renderer.textLeading(),U=0,z=(this.font.forEachGlyph(k,F,A,X,N,function(ce,ge,pe,oe){var de=ce.getMetrics();ce.index===0?q[U+=1]=[]:(q[U].push(ge+de.xMin*ae),q[U].push(ge+de.xMax*ae),J.push(pe+U*I+-de.yMin*ae),J.push(pe+U*I+-de.yMax*ae))}),0<q[U].length&&(W[U]=Math.min.apply(null,q[U]),V[U]=Math.max.apply(null,q[U])),0),K=0;K<=U;K++){W[K]=Math.min.apply(null,q[K]),V[K]=Math.max.apply(null,q[K]);var te=V[K]-W[K];z<te&&(z=te)}var G=Math.min.apply(null,W),ne={x:G,y:A=Math.min.apply(null,J),h:Math.max.apply(null,J)-A,w:z,advance:G-F},X=this._handleAlignment($._renderer,k,ne.x,ne.y,ne.w+ne.advance);ne.x=X.x,ne.y=X.y}return ne}},{key:"textToPoints",value:function(k,F,A,N,$){var G=F,X=[],W=k.split(/\r?\n|\r|\n/g);N=N||this.parent._renderer._textSize;for(var V,q,J,ae=0;ae<W.length;ae++){var I=0;F=G;for(var U=(U=W[ae]).replace("	","  "),z=this._getGlyphs(U),K=0;K<z.length;K++){if(q=U,!((J=z)[V=K].name&&J[V].name==="space"||q.length===J.length&&q[V]===" "))for(var te=function(ce){for(var ge,pe=[],oe=0;oe<ce.length;oe++)ce[oe].type==="M"&&(ge&&pe.push(ge),ge=[]),ge.push(function(de){var xe=[de.type];return de.type==="M"||de.type==="L"?xe.push(de.x,de.y):de.type==="C"?xe.push(de.x1,de.y1,de.x2,de.y2,de.x,de.y):de.type==="Q"&&xe.push(de.x1,de.y1,de.x,de.y),xe}(ce[oe]));return pe.push(ge),pe}(z[K].getPath(F,A,N).commands),ne=0;ne<te.length;ne++)for(var le=function(ce,ge){for(var ge=function(Se,je){if(f(Se)!=="object")Se=je;else for(var Oe in je)Se[Oe]===void 0&&(Se[Oe]=je[Oe]);return Se}(ge,{sampleFactor:.1,simplifyThreshold:0}),pe=b(ce,0,1),oe=pe/(pe*ge.sampleFactor),de=[],xe=0;xe<pe;xe+=oe)de.push(b(ce,xe));return ge.simplifyThreshold&&function(Te){for(var Se=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,je=0,Oe=Te.length-1;3<Te.length&&0<=Oe;--Oe)p(d(Te,Oe-1),d(Te,Oe),d(Te,Oe+1),Se)&&(Te.splice(Oe%Te.length,1),je++)}(de,ge.simplifyThreshold),de}(te[ne],$),me=0;me<le.length;me++)le[me].x+=I,X.push(le[me]);I+=z[K].advanceWidth*this._scale(N)}A+=this.parent._renderer._textLeading}return X}},{key:"_getGlyphs",value:function(k){return this.font.stringToGlyphs(k)}},{key:"_getPath",value:function(k,G,A,N){var $=(N&&N.renderer&&N.renderer._pInst||this.parent)._renderer,G=this._handleAlignment($,k,G,A);return this.font.getPath(k,G.x,G.y,$._textSize,N)}},{key:"_getPathData",value:function(k,F,A,N){var $=3;return typeof k=="string"&&2<arguments.length?k=this._getPath(k,F,A,N):f(F)==="object"&&(N=F),N&&typeof N.decimals=="number"&&($=N.decimals),k.toPathData($)}},{key:"_getSVG",value:function(k,F,A,N){var $=3;return typeof k=="string"&&2<arguments.length?k=this._getPath(k,F,A,N):f(F)==="object"&&(N=F),N&&(typeof N.decimals=="number"&&($=N.decimals),typeof N.strokeWidth=="number"&&(k.strokeWidth=N.strokeWidth),N.fill!==void 0&&(k.fill=N.fill),N.stroke!==void 0&&(k.stroke=N.stroke)),k.toSVG($)}},{key:"_renderPath",value:function(X,V,q,N){var $=N&&N.renderer||this.parent._renderer,G=$.drawingContext,X=(f(X)==="object"&&X.commands?X:this._getPath(X,V,q,N)).commands,W=(G.beginPath(),!0),V=!1,q=void 0;try{for(var J,ae=X[Symbol.iterator]();!(W=(J=ae.next()).done);W=!0){var I=J.value;I.type==="M"?G.moveTo(I.x,I.y):I.type==="L"?G.lineTo(I.x,I.y):I.type==="C"?G.bezierCurveTo(I.x1,I.y1,I.x2,I.y2,I.x,I.y):I.type==="Q"?G.quadraticCurveTo(I.x1,I.y1,I.x,I.y):I.type==="Z"&&G.closePath()}}catch(U){V=!0,q=U}finally{try{W||ae.return==null||ae.return()}finally{if(V)throw q}}return $._doStroke&&$._strokeSet&&!$._clipping&&G.stroke(),$._doFill&&!$._clipping&&($._fillSet||$._setFill(c._DEFAULT_TEXT_FILL),G.fill()),this}},{key:"_textWidth",value:function(k,F){return this.font.getAdvanceWidth(k,F)}},{key:"_textAscent",value:function(k){return this.font.ascender*this._scale(k)}},{key:"_textDescent",value:function(k){return-this.font.descender*this._scale(k)}},{key:"_scale",value:function(k){return 1/this.font.unitsPerEm*(k||this.parent._renderer._textSize)}},{key:"_handleAlignment",value:function(k,F,A,N,$){var G=k._textSize;switch($===void 0&&($=this._textWidth(F,G)),k._textAlign){case c.CENTER:A-=$/2;break;case c.RIGHT:A-=$}switch(k._textBaseline){case c.TOP:N+=this._textAscent(G);break;case c.CENTER:N+=this._textAscent(G)/2;break;case c.BOTTOM:N-=this._textDescent(G)}return{x:A,y:N}}}])&&h(M.prototype,O),P}(),r=l.default,i.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],319:[function(r,s,i){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.array-buffer.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.array-buffer.constructor"),r("core-js/modules/es.object.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.append=function(a,l){return a.push(l),a},r.default.prototype.arrayCopy=function(a,l,c,u,f){var h,d;a=f!==void 0?(d=Math.min(f,a.length),h=u,a.slice(l,d+l)):(d=c!==void 0?(d=c,Math.min(d,a.length)):a.length,c=l,a.slice(h=0,d)),Array.prototype.splice.apply(c,[h,d].concat(a))},r.default.prototype.concat=function(a,l){return a.concat(l)},r.default.prototype.reverse=function(a){return a.reverse()},r.default.prototype.shorten=function(a){return a.pop(),a},r.default.prototype.shuffle=function(a,l){for(var c,u,f=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(a),h=(a=l||f?a:a.slice()).length;1<h;)c=this.random(0,1)*h|0,u=a[--h],a[h]=a[c],a[c]=u;return a},r.default.prototype.sort=function(a,u){var c=u?a.slice(0,Math.min(u,a.length)):a,u=u?a.slice(Math.min(u,a.length)):[];return(c=typeof c[0]=="string"?c.sort():c.sort(function(f,h){return f-h})).concat(u)},r.default.prototype.splice=function(a,l,c){return Array.prototype.splice.apply(a,[c,0].concat(l)),a},r.default.prototype.subset=function(a,l,c){return c!==void 0?a.slice(l,l+c):a.slice(l,a.length)},r=r.default,i.default=r},{"../core/main":280,"core-js/modules/es.array-buffer.constructor":151,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.to-string":187}],320:[function(r,s,i){r("core-js/modules/es.array.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.repeat"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.repeat"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};a.default.prototype.float=function(l){return l instanceof Array?l.map(parseFloat):parseFloat(l)},a.default.prototype.int=function(l){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:10;return l===1/0||l==="Infinity"?1/0:l===-1/0||l==="-Infinity"?-1/0:typeof l=="string"?parseInt(l,c):typeof l=="number"?0|l:typeof l=="boolean"?l?1:0:l instanceof Array?l.map(function(u){return a.default.prototype.int(u,c)}):void 0},a.default.prototype.str=function(l){return l instanceof Array?l.map(a.default.prototype.str):String(l)},a.default.prototype.boolean=function(l){return typeof l=="number"?l!==0:typeof l=="string"?l.toLowerCase()==="true":typeof l=="boolean"?l:l instanceof Array?l.map(a.default.prototype.boolean):void 0},a.default.prototype.byte=function(l){return l=a.default.prototype.int(l,10),typeof l=="number"?(l+128)%256-128:l instanceof Array?l.map(a.default.prototype.byte):void 0},a.default.prototype.char=function(l){return typeof l!="number"||isNaN(l)?l instanceof Array?l.map(a.default.prototype.char):typeof l=="string"?a.default.prototype.char(parseInt(l,10)):void 0:String.fromCharCode(l)},a.default.prototype.unchar=function(l){return typeof l=="string"&&l.length===1?l.charCodeAt(0):l instanceof Array?l.map(a.default.prototype.unchar):void 0},a.default.prototype.hex=function(l,c){if(c=c??8,l instanceof Array)return l.map(function(f){return a.default.prototype.hex(f,c)});if(l===1/0||l===-1/0)return(l===1/0?"F":"0").repeat(c);if(typeof l=="number"){l<0&&(l=4294967295+l+1);for(var u=Number(l).toString(16).toUpperCase();u.length<c;)u="0".concat(u);return u=u.length>=c?u.substring(u.length-c,u.length):u}},a.default.prototype.unhex=function(l){return l instanceof Array?l.map(a.default.prototype.unhex):parseInt("0x".concat(l),16)},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.map":167,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.repeat":200}],321:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.pad-start"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.pad-start"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(d=r("../core/main"))&&d.__esModule?d:{default:d};function l(p,m){return function(g){if(Array.isArray(g))return g}(p)||function(g,b){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]"){var y=[],v=!0,x=!1,S=void 0;try{for(var w,E=g[Symbol.iterator]();!(v=(w=E.next()).done)&&(y.push(w.value),!b||y.length!==b);v=!0);}catch(j){x=!0,S=j}finally{try{v||E.return==null||E.return()}finally{if(x)throw S}}return y}}(p,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(p,m,g){var y=l(p.toString().split("."),2),b=y[0],y=y[1];return g===void 0?(b=b.padStart(m,"0"),y?b+"."+y:b):(b=(p=l(p.toFixed(g).toString().split("."),2))[0],y=p[1],b=b.padStart(m,"0"),y===void 0?b:b+"."+y)}function u(y,m){var g=(y=y.toString()).indexOf("."),b=g!==-1?y.substring(g):"",y=(y=g!==-1?y.substring(0,g):y).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(m===0)b="";else if(m!==void 0)if(m>b.length)for(var v=m-(b+=g===-1?".":"").length+1,x=0;x<v;x++)b+="0";else b=b.substring(0,m+1);return y+b}function f(p){return 0<parseFloat(p)?"+".concat(p.toString()):p.toString()}function h(p){return 0<=parseFloat(p)?" ".concat(p.toString()):p.toString()}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),a.default.prototype.join=function(p,m){return a.default._validateParameters("join",arguments),p.join(m)},a.default.prototype.match=function(p,m){return a.default._validateParameters("match",arguments),p.match(m)},a.default.prototype.matchAll=function(p,m){a.default._validateParameters("matchAll",arguments);for(var g=new RegExp(m,"g"),b=g.exec(p),y=[];b!==null;)y.push(b),b=g.exec(p);return y},a.default.prototype.nf=function(p,m,g){return a.default._validateParameters("nf",arguments),p instanceof Array?p.map(function(b){return c(b,m,g)}):Object.prototype.toString.call(p)==="[object Arguments]"?p.length===3?this.nf(p[0],p[1],p[2]):p.length===2?this.nf(p[0],p[1]):this.nf(p[0]):c(p,m,g)},a.default.prototype.nfc=function(p,m){return a.default._validateParameters("nfc",arguments),p instanceof Array?p.map(function(g){return u(g,m)}):u(p,m)},a.default.prototype.nfp=function(){for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];a.default._validateParameters("nfp",m);var b=a.default.prototype.nf.apply(this,m);return b instanceof Array?b.map(f):f(b)},a.default.prototype.nfs=function(){for(var p=arguments.length,m=new Array(p),g=0;g<p;g++)m[g]=arguments[g];a.default._validateParameters("nfs",m);var b=a.default.prototype.nf.apply(this,m);return b instanceof Array?b.map(h):h(b)},a.default.prototype.split=function(p,m){return a.default._validateParameters("split",arguments),p.split(m)},a.default.prototype.splitTokens=function(p,m){var g,b;return a.default._validateParameters("splitTokens",arguments),b=m!==void 0?(b=/\]/g.exec(m=m),(g=/\[/g.exec(m))&&b?(m=m.slice(0,b.index)+m.slice(b.index+1),g=/\[/g.exec(m),m=m.slice(0,g.index)+m.slice(g.index+1),new RegExp("[\\[".concat(m,"\\]]"),"g")):b?(m=m.slice(0,b.index)+m.slice(b.index+1),new RegExp("[".concat(m,"\\]]"),"g")):g?(m=m.slice(0,g.index)+m.slice(g.index+1),new RegExp("[".concat(m,"\\[]"),"g")):new RegExp("[".concat(m,"]"),"g")):/\s/g,p.split(b).filter(function(y){return y})},a.default.prototype.trim=function(p){return a.default._validateParameters("trim",arguments),p instanceof Array?p.map(this.trim):p.trim()};var d=a.default;i.default=d},{"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.pad-start":199,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],322:[function(r,s,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.day=function(){return new Date().getDate()},r.default.prototype.hour=function(){return new Date().getHours()},r.default.prototype.minute=function(){return new Date().getMinutes()},r.default.prototype.millis=function(){return this._millisStart===-1?0:window.performance.now()-this._millisStart},r.default.prototype.month=function(){return new Date().getMonth()+1},r.default.prototype.second=function(){return new Date().getSeconds()},r.default.prototype.year=function(){return new Date().getFullYear()},r=r.default,i.default=r},{"../core/main":280}],323:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}function l(p){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(d=r("../core/main"))&&d.__esModule?d:{default:d},u=(r("./p5.Geometry"),function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var m=f();if(m&&m.has(p))return m.get(p);var g,b={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=y?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,m&&m.set(p,b),b}(r("../core/constants")));function f(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,f=function(){return p},p)}c.default.prototype.beginGeometry=function(){return this._renderer.beginGeometry()},c.default.prototype.endGeometry=function(){return this._renderer.endGeometry()},c.default.prototype.buildGeometry=function(p){return this._renderer.buildGeometry(p)},c.default.prototype.freeGeometry=function(p){this._renderer._freeBuffers(p.gid)},c.default.prototype.plane=function(){var p,m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:m,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=(this._assert3d("plane"),c.default._validateParameters("plane",arguments),"plane|".concat(b,"|").concat(y));return this._renderer.geometryInHash(v)||((p=new c.default.Geometry(b,y,function(){for(var x,S,w=0;w<=this.detailY;w++)for(var E=w/this.detailY,j=0;j<=this.detailX;j++)x=j/this.detailX,S=new c.default.Vector(x-.5,E-.5,0),this.vertices.push(S),this.uvs.push(x,E)})).computeFaces().computeNormals(),b<=1&&y<=1?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),this._renderer.createBuffers(v,p)),this._renderer.drawBuffersScaled(v,m,g,1),this},c.default.prototype.box=function(p,m,g,b,y){this._assert3d("box"),c.default._validateParameters("box",arguments),p===void 0&&(p=50),m===void 0&&(m=p),g===void 0&&(g=m);var v,x=this._renderer.attributes&&this._renderer.attributes.perPixelLighting,x=(y===void 0&&(y=x?1:4),"box|".concat(b=b===void 0?x?1:4:b,"|").concat(y));return this._renderer.geometryInHash(x)||((v=new c.default.Geometry(b,y,function(){var S=this;this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]],[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]].forEach(function(w,E){for(var E=4*E,j=0;j<4;j++){var P=w[j],P=new c.default.Vector((2*(1&P)-1)/2,((2&P)-1)/2,((4&P)/2-1)/2);S.vertices.push(P),S.uvs.push(1&j,(2&j)/2)}S.faces.push([E,1+E,2+E]),S.faces.push([2+E,1+E,3+E])})})).computeNormals(),b<=4&&y<=4?v._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),this._renderer.createBuffers(x,v)),this._renderer.drawBuffersScaled(x,p,m,g),this},c.default.prototype.sphere=function(){var p=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:24,g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:16;return this._assert3d("sphere"),c.default._validateParameters("sphere",arguments),this.ellipsoid(p,p,p,m,g),this};function h(p,m,g,b,y,v,x){p=p<=0?1:p,m=m<0?0:m,g=g<=0?p:g,b=b<3?3:b;for(var S,w,E=(v=v===void 0||v)?-2:0,j=(y=y<1?1:y)+((x=x===void 0?m!==0:x)?2:0),P=Math.atan2(p-m,g),M=Math.sin(P),O=Math.cos(P),k=E;k<=j;++k){var F=k/y,A=g*F,N=void 0,N=k<0?(F=A=0,p):y<k?(A=g,F=1,m):p+(m-p)*F;for(k!==-2&&k!==y+2||(N=0),A-=g/2,S=0;S<b;++S){var $=S/(b-1),X=2*Math.PI*$,G=Math.sin(X),X=Math.cos(X),W=(this.vertices.push(new c.default.Vector(G*N,A,X*N)),void 0),W=k<0?new c.default.Vector(0,-1,0):y<k&&m?new c.default.Vector(0,1,0):new c.default.Vector(G*O,M,X*O);this.vertexNormals.push(W),this.uvs.push($,F)}}var V=0;if(v){for(w=0;w<b;++w)this.faces.push([V+w,V+b+(w+1)%b,V+b+w]);V+=2*b}for(k=0;k<y;++k){for(S=0;S<b;++S){var q=(S+1)%b;this.faces.push([V+S,V+q,V+b+q]),this.faces.push([V+S,V+b+q,V+b+S])}V+=b}if(x)for(V+=b,S=0;S<b;++S)this.faces.push([V+S,V+(S+1)%b,V+b])}c.default.prototype.cylinder=function(){var p,m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:m,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:24,y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=!(4<arguments.length&&arguments[4]!==void 0)||arguments[4],x=!(5<arguments.length&&arguments[5]!==void 0)||arguments[5],S=(this._assert3d("cylinder"),c.default._validateParameters("cylinder",arguments),"cylinder|".concat(b,"|").concat(y,"|").concat(v,"|").concat(x));return this._renderer.geometryInHash(S)||(p=new c.default.Geometry(b,y),h.call(p,1,1,1,b,y,v,x),b<=24&&y<=16?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(S,p)),this._renderer.drawBuffersScaled(S,m,g,m),this},c.default.prototype.cone=function(){var p,m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:m,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:24,y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=!(4<arguments.length&&arguments[4]!==void 0)||arguments[4],x=(this._assert3d("cone"),c.default._validateParameters("cone",arguments),"cone|".concat(b,"|").concat(y,"|").concat(v));return this._renderer.geometryInHash(x)||(p=new c.default.Geometry(b,y),h.call(p,1,0,1,b,y,v,!1),b<=24&&y<=16?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(x,p)),this._renderer.drawBuffersScaled(x,m,g,m),this},c.default.prototype.ellipsoid=function(){var p,m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:m,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:m,y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:24,v=4<arguments.length&&arguments[4]!==void 0?arguments[4]:16,x=(this._assert3d("ellipsoid"),c.default._validateParameters("ellipsoid",arguments),"ellipsoid|".concat(y,"|").concat(v));return this._renderer.geometryInHash(x)||((p=new c.default.Geometry(y,v,function(){for(var S=0;S<=this.detailY;S++)for(var w=S/this.detailY,E=Math.PI*w-Math.PI/2,j=Math.cos(E),P=Math.sin(E),M=0;M<=this.detailX;M++){var O=M/this.detailX,F=2*Math.PI*O,k=Math.cos(F),F=Math.sin(F),F=new c.default.Vector(j*F,P,j*k);this.vertices.push(F),this.vertexNormals.push(F),this.uvs.push(O,w)}})).computeFaces(),y<=24&&v<=24?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),this._renderer.createBuffers(x,p)),this._renderer.drawBuffersScaled(x,m,g,b),this},c.default.prototype.torus=function(p,x,g,b){if(this._assert3d("torus"),c.default._validateParameters("torus",arguments),p===void 0)p=50;else if(!p)return;if(x===void 0)x=10;else if(!x)return;g===void 0&&(g=24),b===void 0&&(b=16);var y,v=(x/p).toPrecision(4),x="torus|".concat(v,"|").concat(g,"|").concat(b);return this._renderer.geometryInHash(x)||((y=new c.default.Geometry(g,b,function(){for(var S=0;S<=this.detailY;S++)for(var w=S/this.detailY,E=2*Math.PI*w,j=Math.cos(E),P=Math.sin(E),M=1+v*j,O=0;O<=this.detailX;O++){var k=O/this.detailX,F=2*Math.PI*k,N=Math.cos(F),F=Math.sin(F),A=new c.default.Vector(M*N,M*F,v*P),N=new c.default.Vector(j*N,j*F,P);this.vertices.push(A),this.vertexNormals.push(N),this.uvs.push(k,w)}})).computeFaces(),g<=24&&b<=16?y._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(x,y)),this._renderer.drawBuffersScaled(x,p,p,p),this},c.default.RendererGL.prototype.point=function(p,m){var g=[];return g.push(new c.default.Vector(p,m,2<arguments.length&&arguments[2]!==void 0?arguments[2]:0)),this._drawPoints(g,this.immediateMode.buffers.point),this},c.default.RendererGL.prototype.triangle=function(x){var m=x[0],g=x[1],b=x[2],y=x[3],v=x[4],x=x[5],S=(this.geometryInHash("tri")||((S=new c.default.Geometry(1,1,function(){var j=[];j.push(new c.default.Vector(0,0,0)),j.push(new c.default.Vector(1,0,0)),j.push(new c.default.Vector(0,1,0)),this.edges=[[0,1],[1,2],[2,0]],this.vertices=j,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]}))._edgesToVertices(),S.computeNormals(),this.createBuffers("tri",S)),this.uMVMatrix.copy());try{var w=Math.sign(m*y-b*g+b*x-v*y+v*g-m*x),E=new c.default.Matrix([b-m,y-g,0,0,v-m,x-g,0,0,0,0,w,0,m,g,0,1]).mult(this.uMVMatrix);this.uMVMatrix=E,this.drawBuffers("tri")}finally{this.uMVMatrix=S}return this},c.default.RendererGL.prototype.ellipse=function(p){this.arc(p[0],p[1],p[2],p[3],0,u.TWO_PI,u.OPEN,p[4])},c.default.RendererGL.prototype.arc=function(){var p,m=arguments.length<=0?void 0:arguments[0],g=arguments.length<=1?void 0:arguments[1],b=arguments.length<=2?void 0:arguments[2],y=arguments.length<=3?void 0:arguments[3],v=arguments.length<=4?void 0:arguments[4],x=arguments.length<=5?void 0:arguments[5],S=arguments.length<=6?void 0:arguments[6],w=(arguments.length<=7?void 0:arguments[7])||25,E=(Math.abs(x-v)>=u.TWO_PI?"".concat(j="ellipse","|"):"".concat(j="arc","|").concat(v,"|").concat(x,"|").concat(S,"|")).concat(w,"|"),j=(this.geometryInHash(E)||((p=new c.default.Geometry(w,1,function(){if(v.toFixed(10)!==x.toFixed(10)){S!==u.PIE&&S!==void 0||(this.vertices.push(new c.default.Vector(.5,.5,0)),this.uvs.push([.5,.5]));for(var P=0;P<=w;P++){var O=(x-v)*(P/w)+v,M=.5+Math.cos(O)/2,O=.5+Math.sin(O)/2;this.vertices.push(new c.default.Vector(M,O,0)),this.uvs.push([M,O]),P<w-1&&(this.faces.push([0,P+1,P+2]),this.edges.push([P+1,P+2]))}switch(S){case u.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,1]),this.edges.push([this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,this.vertices.length-1]);break;case u.CHORD:this.edges.push([0,1]),this.edges.push([0,this.vertices.length-1]);break;case u.OPEN:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([this.vertices.length-2,this.vertices.length-1])}}})).computeNormals(),w<=50?p._edgesToVertices(p):this._doStroke&&console.log("Cannot apply a stroke to an ".concat(j," with more than 50 detail")),this.createBuffers(E,p)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([m,g,0]),this.uMVMatrix.scale(b,y,1),this.drawBuffers(E)}finally{this.uMVMatrix=j}return this},c.default.RendererGL.prototype.rect=function(p){var m=p[0],g=p[1],b=p[2],y=p[3];if(p[4]===void 0){var S=this._pInst._glAttributes.perPixelLighting,v=p[4]||(S?1:24),x=p[5]||(S?1:16),S="rect|".concat(v,"|").concat(x),w=(this.geometryInHash(S)||((w=new c.default.Geometry(v,x,function(){for(var W=0;W<=this.detailY;W++)for(var V=W/this.detailY,q=0;q<=this.detailX;q++){var J=q/this.detailX,ae=new c.default.Vector(J,V,0);this.vertices.push(ae),this.uvs.push(J,V)}0<v&&0<x&&(this.edges=[[0,v],[v,(v+1)*(x+1)-1],[(v+1)*(x+1)-1,(v+1)*x],[(v+1)*x,0]])})).computeFaces().computeNormals()._edgesToVertices(),this.createBuffers(S,w)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([m,g,0]),this.uMVMatrix.scale(b,y,1),this.drawBuffers(S)}finally{this.uMVMatrix=w}}else{var S=p[4],w=p[5]===void 0?S:p[5],E=p[6]===void 0?w:p[6],p=p[7]===void 0?E:p[7],F=b,j=y,O=((F+=m)<m&&(O=m,m=F,F=O),(j+=g)<g&&(O=g,g=j,j=O),Math.min((F-m)/2,(j-g)/2)),P=(O<S&&(S=O),O<w&&(w=O),O<E&&(E=O),O<p&&(p=O),m),M=g,O=F,m=j,k=(this.beginShape(),w!==0?(this.vertex(O-w,M),this.quadraticVertex(O,M,O,M+w)):this.vertex(O,M),E!==0?(this.vertex(O,m-E),this.quadraticVertex(O,m,O-E,m)):this.vertex(O,m),p!==0?(this.vertex(P+p,m),this.quadraticVertex(P,m,P,m-p)):this.vertex(P,m),S!==0?(this.vertex(P,M+S),this.quadraticVertex(P,M,P+S,M)):this.vertex(P,M),!(this.immediateMode.geometry.uvs.length=0)),g=!1,F=void 0;try{for(var A,N=this.immediateMode.geometry.vertices[Symbol.iterator]();!(k=(A=N.next()).done);k=!0){var $=A.value,G=($.x-P)/b,X=($.y-M)/y;this.immediateMode.geometry.uvs.push(G,X)}}catch(I){g=!0,F=I}finally{try{k||N.return==null||N.return()}finally{if(g)throw F}}this.endShape(u.CLOSE)}return this},c.default.RendererGL.prototype.quad=function(p,m,g,b,y,v,x,S,w,E,j,P){var M=12<arguments.length&&arguments[12]!==void 0?arguments[12]:2,O=13<arguments.length&&arguments[13]!==void 0?arguments[13]:2,k="quad|".concat(p,"|").concat(m,"|").concat(g,"|").concat(b,"|").concat(y,"|").concat(v,"|").concat(x,"|").concat(S,"|").concat(w,"|").concat(E,"|").concat(j,"|").concat(P,"|").concat(M,"|").concat(O);if(!this.geometryInHash(k)){var F=new c.default.Geometry(M,O,function(){for(var q=1/(this.detailX-1),J=1/(this.detailY-1),ae=0;ae<this.detailY;ae++)for(var I=0;I<this.detailX;I++){var U=I*q,z=ae*J;this.vertices.push(new c.default.Vector((1-U)*((1-z)*p+z*E)+U*((1-z)*b+z*x),(1-U)*((1-z)*m+z*j)+U*((1-z)*y+z*S),(1-U)*((1-z)*g+z*P)+U*((1-z)*v+z*w))),this.uvs.push([U,z])}});F.faces=[];for(var A=0;A<O-1;A++)for(var N=0;N<M-1;N++){var $=N+A*M,G=N+1+(A+1)*M,X=N+(A+1)*M;F.faces.push([$,N+1+A*M,G]),F.faces.push([$,G,X])}F.computeNormals();for(var W=[F.edges.length=0,2,3,1],V=0;V<W.length;V++)F.edges.push([W[V],W[(V+1)%W.length]]);F._edgesToVertices(),this.createBuffers(k,F)}return this.drawBuffers(k),this},c.default.RendererGL.prototype.bezier=function(p,m,g,b,y,v,x,S,w,E,j,P){arguments.length===8&&(j=S,E=x,S=v,x=y,y=b,b=g,g=v=w=P=0);var M=this._pInst._bezierDetail||20;this.beginShape();for(var O=0;O<=M;O++){var k=Math.pow(1-O/M,3),F=O/M*3*Math.pow(1-O/M,2),A=3*Math.pow(O/M,2)*(1-O/M),N=Math.pow(O/M,3);this.vertex(p*k+b*F+x*A+E*N,m*k+y*F+S*A+j*N,g*k+v*F+w*A+P*N)}return this.endShape(),this},c.default.RendererGL.prototype.curve=function(p,m,g,b,y,v,x,S,w,E,j,P){arguments.length===8&&(E=x,j=S,x=y,S=b,y=b=g,g=v=w=P=0);var M=this._pInst._curveDetail;this.beginShape();for(var O=0;O<=M;O++){var k=.5*Math.pow(O/M,3),F=.5*Math.pow(O/M,2),A=O/M*.5;this.vertex(k*(3*b-p-3*x+E)+F*(2*p-5*b+4*x-E)+A*(-p+x)+2*b*.5,k*(3*y-m-3*S+j)+F*(2*m-5*y+4*S-j)+A*(-m+S)+2*y*.5,k*(3*v-g-3*w+P)+F*(2*g-5*v+4*w-P)+A*(-g+w)+2*v*.5)}return this.endShape(),this},c.default.RendererGL.prototype.line=function(){return arguments.length===6?(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),this.vertex(arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]),this.endShape()):arguments.length===4&&(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],0),this.vertex(arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],0),this.endShape()),this},c.default.RendererGL.prototype.bezierVertex=function(){if(this.immediateMode._bezierVertex.length===0)throw Error("vertex() must be used once before calling bezierVertex()");var p,m,g,b,y,v,x=[],S=[],w=arguments.length;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var E=1/this._lutBezierDetail,j=0,P=1,M=0;j<1;){if(v=parseFloat(j.toFixed(6)),this._lookUpTableBezier[M]=this._bezierCoefficients(v),P.toFixed(6)===E.toFixed(6)){v=parseFloat(P.toFixed(6))+parseFloat(j.toFixed(6)),++M,this._lookUpTableBezier[M]=this._bezierCoefficients(v);break}j+=E,P-=E,++M}}for(var O=this._lookUpTableBezier.length,k=[],F=0;F<4;F++)k.push([]);k[0]=this.immediateMode.geometry.vertexColors.slice(-4),k[3]=this.curFillColor.slice();var A=[];for(F=0;F<4;F++)A.push([]);if(A[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),A[3]=this.curStrokeColor.slice(),w===6){this.isBezier=!0;var x=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2],arguments.length<=4?void 0:arguments[4]],S=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3],arguments.length<=5?void 0:arguments[5]],N=Math.hypot(x[0]-x[1],S[0]-S[1]),G=Math.hypot(x[1]-x[2],S[1]-S[2]),$=Math.hypot(x[2]-x[3],S[2]-S[3]),G=N+G+$;for(N/=G,$/=G,y=0;y<4;y++)k[1].push(k[0][y]*(1-N)+k[3][y]*N),k[2].push(k[0][y]*$+k[3][y]*(1-$)),A[1].push(A[0][y]*(1-N)+A[3][y]*N),A[2].push(A[0][y]*$+A[3][y]*(1-$));for(b=0;b<O;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],F=p=m=0;F<4;F++){for(y=0;y<4;y++)this.curFillColor[y]+=this._lookUpTableBezier[b][F]*k[F][y],this.curStrokeColor[y]+=this._lookUpTableBezier[b][F]*A[F][y];p+=x[F]*this._lookUpTableBezier[b][F],m+=S[F]*this._lookUpTableBezier[b][F]}this.vertex(p,m)}this.curFillColor=k[3],this.curStrokeColor=A[3],this.immediateMode._bezierVertex[0]=arguments.length<=4?void 0:arguments[4],this.immediateMode._bezierVertex[1]=arguments.length<=5?void 0:arguments[5]}else if(w===9){this.isBezier=!0,x=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3],arguments.length<=6?void 0:arguments[6]],S=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4],arguments.length<=7?void 0:arguments[7]];var X=[this.immediateMode._bezierVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5],arguments.length<=8?void 0:arguments[8]],W=Math.hypot(x[0]-x[1],S[0]-S[1],X[0]-X[1]),G=Math.hypot(x[1]-x[2],S[1]-S[2],X[1]-X[2]),V=Math.hypot(x[2]-x[3],S[2]-S[3],X[2]-X[3]),w=W+G+V;for(W/=w,V/=w,y=0;y<4;y++)k[1].push(k[0][y]*(1-W)+k[3][y]*W),k[2].push(k[0][y]*V+k[3][y]*(1-V)),A[1].push(A[0][y]*(1-W)+A[3][y]*W),A[2].push(A[0][y]*V+A[3][y]*(1-V));for(b=0;b<O;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],F=p=m=g=0;F<4;F++){for(y=0;y<4;y++)this.curFillColor[y]+=this._lookUpTableBezier[b][F]*k[F][y],this.curStrokeColor[y]+=this._lookUpTableBezier[b][F]*A[F][y];p+=x[F]*this._lookUpTableBezier[b][F],m+=S[F]*this._lookUpTableBezier[b][F],g+=X[F]*this._lookUpTableBezier[b][F]}this.vertex(p,m,g)}this.curFillColor=k[3],this.curStrokeColor=A[3],this.immediateMode._bezierVertex[0]=arguments.length<=6?void 0:arguments[6],this.immediateMode._bezierVertex[1]=arguments.length<=7?void 0:arguments[7],this.immediateMode._bezierVertex[2]=arguments.length<=8?void 0:arguments[8]}},c.default.RendererGL.prototype.quadraticVertex=function(){if(this.immediateMode._quadraticVertex.length===0)throw Error("vertex() must be used once before calling quadraticVertex()");var p,m,g,b,y,v,x=[],S=[],w=arguments.length;if(this._lookUpTableQuadratic.length===0||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[],this._lutQuadraticDetail=this._pInst._curveDetail;for(var E=1/this._lutQuadraticDetail,j=0,P=1,M=0;j<1;){if(v=parseFloat(j.toFixed(6)),this._lookUpTableQuadratic[M]=this._quadraticCoefficients(v),P.toFixed(6)===E.toFixed(6)){v=parseFloat(P.toFixed(6))+parseFloat(j.toFixed(6)),++M,this._lookUpTableQuadratic[M]=this._quadraticCoefficients(v);break}j+=E,P-=E,++M}}for(var O=this._lookUpTableQuadratic.length,k=[],F=0;F<3;F++)k.push([]);k[0]=this.immediateMode.geometry.vertexColors.slice(-4),k[2]=this.curFillColor.slice();var A=[];for(F=0;F<3;F++)A.push([]);if(A[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),A[2]=this.curStrokeColor.slice(),w===4){this.isQuadratic=!0;var x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2]],S=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3]],N=Math.hypot(x[0]-x[1],S[0]-S[1]);for(N/=N+Math.hypot(x[1]-x[2],S[1]-S[2]),y=0;y<4;y++)k[1].push(k[0][y]*(1-N)+k[2][y]*N),A[1].push(A[0][y]*(1-N)+A[2][y]*N);for(b=0;b<O;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],F=p=m=0;F<3;F++){for(y=0;y<4;y++)this.curFillColor[y]+=this._lookUpTableQuadratic[b][F]*k[F][y],this.curStrokeColor[y]+=this._lookUpTableQuadratic[b][F]*A[F][y];p+=x[F]*this._lookUpTableQuadratic[b][F],m+=S[F]*this._lookUpTableQuadratic[b][F]}this.vertex(p,m)}this.curFillColor=k[2],this.curStrokeColor=A[2],this.immediateMode._quadraticVertex[0]=arguments.length<=2?void 0:arguments[2],this.immediateMode._quadraticVertex[1]=arguments.length<=3?void 0:arguments[3]}else if(w===6){this.isQuadratic=!0,x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3]],S=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4]];var $=[this.immediateMode._quadraticVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5]],G=Math.hypot(x[0]-x[1],S[0]-S[1],$[0]-$[1]);for(G/=G+Math.hypot(x[1]-x[2],S[1]-S[2],$[1]-$[2]),y=0;y<4;y++)k[1].push(k[0][y]*(1-G)+k[2][y]*G),A[1].push(A[0][y]*(1-G)+A[2][y]*G);for(b=0;b<O;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],F=p=m=g=0;F<3;F++){for(y=0;y<4;y++)this.curFillColor[y]+=this._lookUpTableQuadratic[b][F]*k[F][y],this.curStrokeColor[y]+=this._lookUpTableQuadratic[b][F]*A[F][y];p+=x[F]*this._lookUpTableQuadratic[b][F],m+=S[F]*this._lookUpTableQuadratic[b][F],g+=$[F]*this._lookUpTableQuadratic[b][F]}this.vertex(p,m,g)}this.curFillColor=k[2],this.curStrokeColor=A[2],this.immediateMode._quadraticVertex[0]=arguments.length<=3?void 0:arguments[3],this.immediateMode._quadraticVertex[1]=arguments.length<=4?void 0:arguments[4],this.immediateMode._quadraticVertex[2]=arguments.length<=5?void 0:arguments[5]}},c.default.RendererGL.prototype.curveVertex=function(){var p,m,g,b,y,v,x=[],S=[],w=arguments.length;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var E=1/this._lutBezierDetail,j=0,P=1,M=0;j<1;){if(v=parseFloat(j.toFixed(6)),this._lookUpTableBezier[M]=this._bezierCoefficients(v),P.toFixed(6)===E.toFixed(6)){v=parseFloat(P.toFixed(6))+parseFloat(j.toFixed(6)),++M,this._lookUpTableBezier[M]=this._bezierCoefficients(v);break}j+=E,P-=E,++M}}var O=this._lookUpTableBezier.length;if(w===2){if(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.length===8){for(this.isCurve=!0,x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]),S=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]),y=0;y<O;y++)m=x[0]*this._lookUpTableBezier[y][0]+x[1]*this._lookUpTableBezier[y][1]+x[2]*this._lookUpTableBezier[y][2]+x[3]*this._lookUpTableBezier[y][3],g=S[0]*this._lookUpTableBezier[y][0]+S[1]*this._lookUpTableBezier[y][1]+S[2]*this._lookUpTableBezier[y][2]+S[3]*this._lookUpTableBezier[y][3],this.vertex(m,g);for(y=0;y<w;y++)this.immediateMode._curveVertex.shift()}}else if(w===3&&(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.push(arguments.length<=2?void 0:arguments[2]),this.immediateMode._curveVertex.length===12)){for(this.isCurve=!0,x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]),S=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]),p=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]),y=0;y<O;y++)m=x[0]*this._lookUpTableBezier[y][0]+x[1]*this._lookUpTableBezier[y][1]+x[2]*this._lookUpTableBezier[y][2]+x[3]*this._lookUpTableBezier[y][3],g=S[0]*this._lookUpTableBezier[y][0]+S[1]*this._lookUpTableBezier[y][1]+S[2]*this._lookUpTableBezier[y][2]+S[3]*this._lookUpTableBezier[y][3],b=p[0]*this._lookUpTableBezier[y][0]+p[1]*this._lookUpTableBezier[y][1]+p[2]*this._lookUpTableBezier[y][2]+p[3]*this._lookUpTableBezier[y][3],this.vertex(m,g,b);for(y=0;y<w;y++)this.immediateMode._curveVertex.shift()}},c.default.RendererGL.prototype.image=function(p,P,g,M,y,v,x,S,w){this._isErasing&&this.blendMode(this._cachedBlendMode),this._pInst.push(),this._pInst.noLights(),this._pInst.noStroke(),this._pInst.texture(p),this._pInst.textureMode(u.NORMAL);var E=0,j=(P<=p.width&&(E=P/p.width),1),P=(P+M<=p.width&&(j=(P+M)/p.width),0),M=(g<=p.height&&(P=g/p.height),1);g+y<=p.height&&(M=(g+y)/p.height),this.beginShape(),this.vertex(v,x,0,E,P),this.vertex(v+S,x,0,j,P),this.vertex(v+S,x+w,0,j,M),this.vertex(v,x+w,0,E,M),this.endShape(u.CLOSE),this._pInst.pop(),this._isErasing&&this.blendMode(u.REMOVE)};var d=c.default;i.default=d},{"../core/constants":269,"../core/main":280,"./p5.Geometry":332,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.math.sign":177,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],324:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function l(m){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.assign"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(m){if(m&&m.__esModule)return m;if(m===null||l(m)!=="object"&&typeof m!="function")return{default:m};var g=f();if(g&&g.has(m))return g.get(m);var b,y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in m){var x;Object.prototype.hasOwnProperty.call(m,b)&&((x=v?Object.getOwnPropertyDescriptor(m,b):null)&&(x.get||x.set)?Object.defineProperty(y,b,x):y[b]=m[b])}return y.default=m,g&&g.set(m,y),y}(r("../core/constants"));function f(){var m;return typeof WeakMap!="function"?null:(m=new WeakMap,f=function(){return m},m)}function h(m){return function(g){if(Array.isArray(g)){for(var b=0,y=new Array(g.length);b<g.length;b++)y[b]=g[b];return y}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(m,g){for(var b=0;b<g.length;b++){var y=g[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(m,y.key,y)}}var p=function(){function m(y){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");(this.renderer=y)._pInst.push(),this.identityMatrix=new c.default.Matrix,y.uMVMatrix=new c.default.Matrix,this.geometry=new c.default.Geometry,this.geometry.gid="_p5_GeometryBuilder_".concat(m.nextGeometryId),m.nextGeometryId++,this.hasTransform=!1}var g,b;return g=m,(b=[{key:"transformVertices",value:function(y){var v=this;return this.hasTransform?y.map(function(x){return v.renderer.uMVMatrix.multiplyPoint(x)}):y}},{key:"transformNormals",value:function(y){var v=this;return this.hasTransform?y.map(function(x){return v.renderer.uNMatrix.multiplyVec3(x)}):y}},{key:"addGeometry",value:function(y){for(var v,x=this,S=(this.hasTransform=!this.renderer.uMVMatrix.mat4.every(function(E,j){return E===x.identityMatrix.mat4[j]}),this.hasTransform&&this.renderer.uNMatrix.inverseTranspose(this.renderer.uMVMatrix),this.geometry.vertices.length),w=((v=this.geometry.vertices).push.apply(v,h(this.transformVertices(y.vertices))),(v=this.geometry.vertexNormals).push.apply(v,h(this.transformNormals(y.vertexNormals))),(v=this.geometry.uvs).push.apply(v,h(y.uvs)),this.renderer._doFill&&(v=this.geometry.faces).push.apply(v,h(y.faces.map(function(E){return E.map(function(j){return j+S})}))),this.renderer._doStroke&&(v=this.geometry.edges).push.apply(v,h(y.edges.map(function(E){return E.map(function(j){return j+S})}))),h(y.vertexColors));w.length<4*y.vertices.length;)w.push.apply(w,h(this.renderer.curFillColor));(v=this.geometry.vertexColors).push.apply(v,h(w))}},{key:"addImmediate",value:function(){var y=this.renderer.immediateMode.geometry,v=this.renderer.immediateMode.shapeMode,x=[];if(this.renderer._doFill)if(v===u.TRIANGLE_STRIP||v===u.QUAD_STRIP)for(var S=2;S<y.vertices.length;S++)S%2==0?x.push([S,S-1,S-2]):x.push([S,S-2,S-1]);else if(v===u.TRIANGLE_FAN)for(var w=2;w<y.vertices.length;w++)x.push([0,w-1,w]);else for(var E=0;E<y.vertices.length;E+=3)x.push([E,E+1,E+2]);this.addGeometry(Object.assign({},y,{faces:x}))}},{key:"addRetained",value:function(y){this.addGeometry(y.model)}},{key:"finish",value:function(){return this.renderer._pInst.pop(),this.geometry}}])&&d(g.prototype,b),m}();p.nextGeometryId=0,i.default=p},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.every":154,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],325:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var l=(h=r("../core/main"))&&h.__esModule?h:{default:h},c=function(d){if(d&&d.__esModule)return d;if(d===null||f(d)!=="object"&&typeof d!="function")return{default:d};var p=u();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function u(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,u=function(){return d},d)}function f(d){return(f=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}l.default.prototype.orbitControl=function(d,p,m,w){var b=this,y=(this._assert3d("orbitControl"),l.default._validateParameters("orbitControl",arguments),this._renderer._curCamera);d===void 0&&(d=1),p===void 0&&(p=d),m===void 0&&(m=1),f(w)!=="object"&&(w={}),this.contextMenuDisabled!==!0&&(this.canvas.oncontextmenu=function(){return!1},this._setProperty("contextMenuDisabled",!0)),this.wheelDefaultDisabled!==!0&&(this.canvas.onwheel=function(){return!1},this._setProperty("wheelDefaultDisabled",!0));var j=w.disableTouchActions;this.touchActionsDisabled===!0||j!==void 0&&!j||(this.canvas.style["touch-action"]="none",this._setProperty("touchActionsDisabled",!0));var v,x,S,j=w.freeRotation,w=j!==void 0&&j,E=[],j=(this.touches.forEach(function(N){b._renderer.prevTouches.forEach(function($){N.id===$.id&&($={x:N.x,y:N.y,px:$.x,py:$.y},E.push($))})}),this._renderer.prevTouches=this.touches,0),P=0,M=0,O=0,k=0,F=this.height<this.width?this.height:this.width,A=!1;return 0<E.length?(A=0<E[0].x&&E[0].x<this.width&&0<E[0].y&&E[0].y<this.height,E.length===1?(P=-d*((v=E[0]).x-v.px)/F,M=p*(v.y-v.py)/F):(v=E[0],x=E[1],j=-(Math.hypot(v.x-x.x,v.y-x.y)-Math.hypot(v.px-x.px,v.py-x.py))*m*4e-4,O=.5*(v.x+x.x)-.5*(v.px+x.px),k=.5*(v.y+x.y)-.5*(v.py+x.py)),0<this.touches.length?A&&(this._renderer.executeRotateAndMove=!0,this._renderer.executeZoom=!0):(this._renderer.executeRotateAndMove=!1,this._renderer.executeZoom=!1)):(A=0<this.mouseX&&this.mouseX<this.width&&0<this.mouseY&&this.mouseY<this.height,this._mouseWheelDeltaY!==0?(j=Math.sign(this._mouseWheelDeltaY)*m,j*=.01,this._mouseWheelDeltaY=0,A&&(this._renderer.executeZoom=!0)):this._renderer.executeZoom=!1,this.mouseIsPressed?(this.mouseButton===this.LEFT?(P=-d*this.movedX/F,M=p*this.movedY/F):this.mouseButton===this.RIGHT&&(O=this.movedX,k=this.movedY*y.yScale),A&&(this._renderer.executeRotateAndMove=!0)):this._renderer.executeRotateAndMove=!1),j!==0&&this._renderer.executeZoom&&(this._renderer.zoomVelocity+=j),.001<Math.abs(this._renderer.zoomVelocity)?(w?y._orbitFree(0,0,this._renderer.zoomVelocity):y._orbit(0,0,this._renderer.zoomVelocity),y.projMatrix.mat4[15]!==0&&(y.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity),y.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity),this._renderer.uPMatrix.mat4[0]=y.projMatrix.mat4[0],this._renderer.uPMatrix.mat4[5]=y.projMatrix.mat4[5]),this._renderer.zoomVelocity*=.85):this._renderer.zoomVelocity=0,P===0&&M===0||!this._renderer.executeRotateAndMove||this._renderer.rotateVelocity.add(.6*P,.6*M),1e-6<this._renderer.rotateVelocity.magSq()?(w?y._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0):y._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0),this._renderer.rotateVelocity.mult(.85)):this._renderer.rotateVelocity.set(0,0),O===0&&k===0||!this._renderer.executeRotateAndMove||(v=2*O/this.width,x=2*-k/this.height,this._renderer.moveVelocity.add(.15*v,.15*x)),1e-6<this._renderer.moveVelocity.magSq()?(m=y._getLocalAxes(),d=y.eyeX-y.centerX,p=y.eyeY-y.centerY,F=y.eyeZ-y.centerZ,A=Math.sqrt(d*d+p*p+F*F),j=new l.default.Vector(y.centerX,y.centerY,y.centerZ),j=y.cameraMatrix.multiplyPoint(j),(j=this._renderer.uPMatrix.multiplyAndNormalizePoint(j)).x-=this._renderer.moveVelocity.x,j.y-=this._renderer.moveVelocity.y,M=(P=this._renderer.uPMatrix.mat4)[15]===0?(S=(P[8]+j.x)/P[0]*A,(P[9]+j.y)/P[5]*A):(S=(j.x-P[12])/P[0],(j.y-P[13])/P[5]),y.setPosition(y.eyeX+S*m.x[0]+M*m.y[0],y.eyeY+S*m.x[1]+M*m.y[1],y.eyeZ+S*m.x[2]+M*m.y[2]),this._renderer.moveVelocity.mult(.85)):this._renderer.moveVelocity.set(0,0),this},l.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var d=arguments.length,p=new Array(d),m=0;m<d;m++)p[m]=arguments[m];l.default._validateParameters("debugMode",p);for(var g=this._registeredMethods.post.length-1;0<=g;g--)this._registeredMethods.post[g].toString()!==this._grid().toString()&&this._registeredMethods.post[g].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(g,1);p[0]===c.GRID?this.registerMethod("post",this._grid(p[1],p[2],p[3],p[4],p[5])):p[0]===c.AXES?this.registerMethod("post",this._axesIcon(p[1],p[2],p[3],p[4])):(this.registerMethod("post",this._grid(p[0],p[1],p[2],p[3],p[4])),this.registerMethod("post",this._axesIcon(p[5],p[6],p[7],p[8])))},l.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var d=this._registeredMethods.post.length-1;0<=d;d--)this._registeredMethods.post[d].toString()!==this._grid().toString()&&this._registeredMethods.post[d].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(d,1)},l.default.prototype._grid=function(d,p,m,g,b){d===void 0&&(d=this.width/2),p===void 0&&(p=Math.round(d/30)<4?4:Math.round(d/30)),m===void 0&&(m=0),g===void 0&&(g=0),b===void 0&&(b=0);var y=d/p,v=d/2;return function(){this.push(),this.stroke(255*this._renderer.curStrokeColor[0],255*this._renderer.curStrokeColor[1],255*this._renderer.curStrokeColor[2]),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix);for(var x=0;x<=p;x++)this.beginShape(this.LINES),this.vertex(-v+m,g,x*y-v+b),this.vertex(v+m,g,x*y-v+b),this.endShape();for(var S=0;S<=p;S++)this.beginShape(this.LINES),this.vertex(S*y-v+m,g,-v+b),this.vertex(S*y-v+m,g,v+b),this.endShape();this.pop()}},l.default.prototype._axesIcon=function(d,p,m,g){return d===void 0&&(d=40<this.width/20?this.width/20:40),p===void 0&&(p=-this.width/4),m===void 0&&(m=p),g===void 0&&(g=p),function(){this.push(),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(p,m,g),this.vertex(p+d,m,g),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(p,m,g),this.vertex(p,m+d,g),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(p,m,g),this.vertex(p,m,g+d),this.endShape(),this.pop()}};var h=l.default;i.default=h},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.splice":170,"core-js/modules/es.math.hypot":175,"core-js/modules/es.math.sign":177,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],326:[function(r,s,i){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.filter"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};a.default.prototype.ambientLight=function(l,c,u,f){this._assert3d("ambientLight"),a.default._validateParameters("ambientLight",arguments);var h=this.color.apply(this,arguments);return this._renderer.ambientLightColors.push(h._array[0],h._array[1],h._array[2]),this._renderer._enableLighting=!0,this},a.default.prototype.specularColor=function(l,c,u){this._assert3d("specularColor"),a.default._validateParameters("specularColor",arguments);var f=this.color.apply(this,arguments);return this._renderer.specularColors=[f._array[0],f._array[1],f._array[2]],this},a.default.prototype.directionalLight=function(l,b,g,f,h,d){this._assert3d("directionalLight"),a.default._validateParameters("directionalLight",arguments),l=l instanceof a.default.Color?l:this.color(l,b,g);var p,m,b=arguments[arguments.length-1],g=typeof b=="number"?(p=arguments[arguments.length-3],m=arguments[arguments.length-2],arguments[arguments.length-1]):(p=b.x,m=b.y,b.z),b=Math.sqrt(p*p+m*m+g*g);return this._renderer.directionalLightDirections.push(p/b,m/b,g/b),this._renderer.directionalLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},a.default.prototype.pointLight=function(l,g,b,f,h,d){this._assert3d("pointLight"),a.default._validateParameters("pointLight",arguments),l=l instanceof a.default.Color?l:this.color(l,g,b);var p,m,g=arguments[arguments.length-1],b=typeof g=="number"?(p=arguments[arguments.length-3],m=arguments[arguments.length-2],arguments[arguments.length-1]):(p=g.x,m=g.y,g.z);return this._renderer.pointLightPositions.push(p,m,b),this._renderer.pointLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},a.default.prototype.imageLight=function(l){this._renderer.activeImageLight=l,this._renderer._enableLighting=!0},a.default.prototype.panorama=function(l){this.filter(this._renderer._getSphereMapping(l))},a.default.prototype.lights=function(){this._assert3d("lights");var l=this.color("rgb(128,128,128)");return this.ambientLight(l),this.directionalLight(l,0,0,-1),this},a.default.prototype.lightFalloff=function(l,c,u){return this._assert3d("lightFalloff"),a.default._validateParameters("lightFalloff",arguments),l<0&&(l=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),c<0&&(c=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),u<0&&(u=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),l===0&&c===0&&u===0&&(l=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this._renderer.constantAttenuation=l,this._renderer.linearAttenuation=c,this._renderer.quadraticAttenuation=u,this},a.default.prototype.spotLight=function(l,c,u,f,h,d,p,m,g,b,y){this._assert3d("spotLight"),a.default._validateParameters("spotLight",arguments);var v,x,S,w=arguments.length;switch(w){case 11:case 10:v=this.color(l,c,u),x=new a.default.Vector(f,h,d),S=new a.default.Vector(p,m,g);break;case 9:l instanceof a.default.Color?(v=l,x=new a.default.Vector(c,u,f),S=new a.default.Vector(h,d,p),b=m,y=g):f instanceof a.default.Vector?(v=this.color(l,c,u),x=f,S=new a.default.Vector(h,d,p),b=m,y=g):p instanceof a.default.Vector?(v=this.color(l,c,u),x=new a.default.Vector(f,h,d),S=p,b=m,y=g):(v=this.color(l,c,u),x=new a.default.Vector(f,h,d),S=new a.default.Vector(p,m,g));break;case 8:b=(S=l instanceof a.default.Color?(v=l,x=new a.default.Vector(c,u,f),new a.default.Vector(h,d,p)):f instanceof a.default.Vector?(v=this.color(l,c,u),x=f,new a.default.Vector(h,d,p)):(v=this.color(l,c,u),x=new a.default.Vector(f,h,d),p),m);break;case 7:l instanceof a.default.Color&&c instanceof a.default.Vector?(v=l,x=c,S=new a.default.Vector(u,f,h),b=d,y=p):l instanceof a.default.Color&&h instanceof a.default.Vector?(v=l,x=new a.default.Vector(c,u,f),S=h,b=d,y=p):f instanceof a.default.Vector&&h instanceof a.default.Vector?(v=this.color(l,c,u),x=f,S=h,b=d,y=p):S=l instanceof a.default.Color?(v=l,x=new a.default.Vector(c,u,f),new a.default.Vector(h,d,p)):f instanceof a.default.Vector?(v=this.color(l,c,u),x=f,new a.default.Vector(h,d,p)):(v=this.color(l,c,u),x=new a.default.Vector(f,h,d),p);break;case 6:f instanceof a.default.Vector&&h instanceof a.default.Vector?(v=this.color(l,c,u),x=f,S=h,b=d):l instanceof a.default.Color&&h instanceof a.default.Vector?(v=l,x=new a.default.Vector(c,u,f),S=h,b=d):l instanceof a.default.Color&&c instanceof a.default.Vector&&(v=l,x=c,S=new a.default.Vector(u,f,h),b=d);break;case 5:l instanceof a.default.Color&&c instanceof a.default.Vector&&u instanceof a.default.Vector?(v=l,x=c,S=u,b=f,y=h):f instanceof a.default.Vector&&h instanceof a.default.Vector?(v=this.color(l,c,u),x=f,S=h):l instanceof a.default.Color&&h instanceof a.default.Vector?(v=l,x=new a.default.Vector(c,u,f),S=h):l instanceof a.default.Color&&c instanceof a.default.Vector&&(v=l,x=c,S=new a.default.Vector(u,f,h));break;case 4:v=l,x=c,S=u,b=f;break;case 3:v=l,x=c,S=u;break;default:return console.warn("Sorry, input for spotlight() is not in prescribed format. Too ".concat(w<3?"few":"many"," arguments were provided")),this}return this._renderer.spotLightDiffuseColors.push(v._array[0],v._array[1],v._array[2]),Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors),this._renderer.spotLightPositions.push(x.x,x.y,x.z),S.normalize(),this._renderer.spotLightDirections.push(S.x,S.y,S.z),b===void 0&&(b=Math.PI/3),y!==void 0&&y<1?(y=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):y===void 0&&(y=100),b=this._renderer._pInst._toRadians(b),this._renderer.spotLightAngle.push(Math.cos(b)),this._renderer.spotLightConc.push(y),this._renderer._enableLighting=!0,this},a.default.prototype.noLights=function(){this._assert3d("noLights");for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return a.default._validateParameters("noLights",c),this._renderer.activeImageLight=null,this._renderer._enableLighting=!1,this._renderer.ambientLightColors.length=0,this._renderer.specularColors=[1,1,1],this._renderer.directionalLightDirections.length=0,this._renderer.directionalLightDiffuseColors.length=0,this._renderer.directionalLightSpecularColors.length=0,this._renderer.pointLightPositions.length=0,this._renderer.pointLightDiffuseColors.length=0,this._renderer.pointLightSpecularColors.length=0,this._renderer.spotLightPositions.length=0,this._renderer.spotLightDirections.length=0,this._renderer.spotLightDiffuseColors.length=0,this._renderer.spotLightSpecularColors.length=0,this._renderer.spotLightAngle.length=0,this._renderer.spotLightConc.length=0,this._renderer.constantAttenuation=1,this._renderer.linearAttenuation=0,this._renderer.quadraticAttenuation=0,this._renderer._useShininess=1,this._renderer._useMetalness=0,this},r=a.default,i.default=r},{"../core/main":280,"core-js/modules/es.array.filter":156}],327:[function(r,s,i){function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r("regenerator-runtime/runtime");var l=(d=r("../core/main"))&&d.__esModule?d:{default:d};function c(p){return function(m){if(Array.isArray(m)){for(var g=0,b=new Array(m.length);g<m.length;g++)b[g]=m[g];return b}}(p)||function(m){if(Symbol.iterator in Object(m)||Object.prototype.toString.call(m)==="[object Arguments]")return Array.from(m)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(p,m,g,b,y,v,x){try{var S=p[v](x),w=S.value}catch(E){return void g(E)}S.done?m(w):Promise.resolve(w).then(b,y)}function f(p){return function(){var m=this,g=arguments;return new Promise(function(b,y){var v=p.apply(m,g);function x(w){u(v,b,y,x,S,"next",w)}function S(w){u(v,b,y,x,S,"throw",w)}x(void 0)})}}function h(p){return(h=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(m){return a(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":a(m)})(p)}r("./p5.Geometry"),l.default.prototype.loadModel=function(p,m){l.default._validateParameters("loadModel",arguments);var g,b,y=!1,v=!1,x=!1,S=p.slice(-4),w=(m&&h(m)==="object"?(y=m.normalize||!1,g=m.successCallback,b=m.failureCallback,S=m.fileType||S,v=m.flipU||!1,x=m.flipV||!1):typeof m=="boolean"?(y=m,g=arguments[2],b=arguments[3],arguments[4]!==void 0&&(S=arguments[4])):(g=typeof m=="function"?m:void 0,b=arguments[2],arguments[3]!==void 0&&(S=arguments[3])),new l.default.Geometry),E=(w.gid="".concat(p,"|").concat(y),this);function j(){return(j=f(regeneratorRuntime.mark(function M(O){var k,F,A,N;return regeneratorRuntime.wrap(function($){for(;;)switch($.prev=$.next){case 0:for(k=[],F=0;F<O.length;F++)(A=O[F].match(/^mtllib (.+)/))&&function(){var G="",X=A[1],W=p.split("/");G=1<W.length?(W.pop(),W.join("/")+"/"+X):X,k.push(function(){return P.apply(this,arguments)}(G).then(function(V){return V?(q=E,J=G,new Promise(function(ae,I){var U=null,z={};q.loadStrings(J,function(K){for(var te=0;te<K.length;++te){var ne,le=K[te].trim().split(/\s+/);le[0]==="newmtl"?(ne=le[1],z[U=ne]={}):le[0]==="Kd"?z[U].diffuseColor=[parseFloat(le[1]),parseFloat(le[2]),parseFloat(le[3])]:le[0]==="Ka"?z[U].ambientColor=[parseFloat(le[1]),parseFloat(le[2]),parseFloat(le[3])]:le[0]==="Ks"?z[U].specularColor=[parseFloat(le[1]),parseFloat(le[2]),parseFloat(le[3])]:le[0]==="map_Kd"&&(z[U].texturePath=le[1])}ae(z)},I)})):(console.warn("MTL file not found or error in parsing; proceeding without materials: ".concat(G)),{});var q,J}).catch(function(V){return console.warn("Error loading MTL file: ".concat(G),V),{}}))}();return $.prev=2,$.next=5,Promise.all(k);case 5:return N=$.sent,N=Object.assign.apply(Object,[{}].concat(c(N))),$.abrupt("return",N);case 10:return $.prev=10,$.t0=$.catch(2),$.abrupt("return",{});case 13:case"end":return $.stop()}},M,null,[[2,10]])}))).apply(this,arguments)}function P(){return(P=f(regeneratorRuntime.mark(function M(O){var k;return regeneratorRuntime.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,F.next=3,fetch(O,{method:"HEAD"});case 3:return k=F.sent,F.abrupt("return",k.ok);case 7:return F.prev=7,F.t0=F.catch(0),F.abrupt("return",!1);case 10:case"end":return F.stop()}},M,null,[[0,7]])}))).apply(this,arguments)}return S.match(/\.stl$/i)?this.httpDo(p,"GET","arrayBuffer",function(M){(function(O,k){if(function(F){for(var A=new DataView(F),N=[115,111,108,105,100],$=0;$<5;$++)if(function(G,X,W){for(var V=0,q=G.length;V<q;V++)if(G[V]!==X.getUint8(W+V,!1))return;return 1}(N,A,$))return;return 1}(k))(function(F,A){for(var N,$,G,X,W,V,q,J=new DataView(A),ae=J.getUint32(80,!0),I=!1,U=0;U<70;U++)J.getUint32(U,!1)===1129270351&&J.getUint8(U+4)===82&&J.getUint8(U+5)===61&&(I=!0,X=[],W=J.getUint8(U+6)/255,V=J.getUint8(U+7)/255,q=J.getUint8(U+8)/255);for(var z=0;z<ae;z++){for(var K,te=84+50*z,ne=J.getFloat32(te,!0),le=J.getFloat32(4+te,!0),me=J.getFloat32(8+te,!0),ce=(I&&(K=J.getUint16(48+te,!0),G=32768&K?(N=W,$=V,q):(N=(31&K)/31,$=(K>>5&31)/31,(K>>10&31)/31)),new l.default.Vector(ne,le,me)),ge=1;ge<=3;ge++){var pe=te+12*ge,pe=new l.default.Vector(J.getFloat32(pe,!0),J.getFloat32(4+pe,!0),J.getFloat32(8+pe,!0));F.vertices.push(pe),F.vertexNormals.push(ce),I&&X.push(N,$,G)}F.faces.push([3*z,3*z+1,3*z+2]),F.uvs.push([0,0],[0,0],[0,0])}})(O,k);else{if(k=new DataView(k),!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)");k=new TextDecoder("utf-8").decode(k).split(`
`),function(F,A){for(var N,$,G="",X=[],W=0;W<A.length;++W){for(var V=A[W].trim(),q=V.split(" "),J=0;J<q.length;++J)q[J]===""&&q.splice(J,1);if(q.length!==0)switch(G){case"":if(q[0]!=="solid")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "solid"'));G="solid";break;case"solid":if(q[0]!=="facet"||q[1]!=="normal")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "facet normal"'));N=new l.default.Vector(parseFloat(q[2]),parseFloat(q[3]),parseFloat(q[4])),F.vertexNormals.push(N,N,N),G="facet normal";break;case"facet normal":if(q[0]!=="outer"||q[1]!=="loop")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "outer loop"'));G="vertex";break;case"vertex":if(q[0]==="vertex")$=new l.default.Vector(parseFloat(q[1]),parseFloat(q[2]),parseFloat(q[3])),F.vertices.push($),F.uvs.push([0,0]),X.push(F.vertices.indexOf($));else{if(q[0]!=="endloop")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "vertex" or "endloop"'));F.faces.push(X),X=[],G="endloop"}break;case"endloop":if(q[0]!=="endfacet")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "endfacet"'));G="endfacet";break;case"endfacet":if(q[0]!=="endsolid"){if(q[0]!=="facet"||q[1]!=="normal")return console.error(V),console.error('Invalid state "'.concat(q[0],'", should be "endsolid" or "facet normal"'));N=new l.default.Vector(parseFloat(q[2]),parseFloat(q[3]),parseFloat(q[4])),F.vertexNormals.push(N,N,N),G="facet normal"}break;default:console.error('Invalid state "'.concat(G,'"'))}}}(O,k)}})(w,M),y&&w.normalize(),v&&w.flipU(),x&&w.flipV(),E._decrementPreload(),typeof g=="function"&&g(w)},b):S.match(/\.obj$/i)?this.loadStrings(p,function(){var M=f(regeneratorRuntime.mark(function O(k){var F;return regeneratorRuntime.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.prev=0,A.next=3,function(){return j.apply(this,arguments)}(k);case 3:F=A.sent,function(N,$){for(var G=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},X={v:[],vt:[],vn:[]},W={},V=null,q=new Set,J=!1,ae=!1,I=0;I<$.length;++I){var U=$[I].trim().split(/\b\s+/);if(0<U.length){if(U[0]==="usemtl")V=U[1];else if(U[0]==="v"||U[0]==="vn"){var z=new l.default.Vector(parseFloat(U[1]),parseFloat(U[2]),parseFloat(U[3]));X[U[0]].push(z)}else if(U[0]==="vt")z=[parseFloat(U[1]),1-parseFloat(U[2])],X[U[0]].push(z);else if(U[0]==="f")for(var K=3;K<U.length;++K){for(var te=[],ne=[1,K-1,K],le=0;le<ne.length;++le){for(var me,ce=U[ne[le]],ge=ce.split("/"),pe=0;pe<ge.length;pe++)ge[pe]=parseInt(ge[pe])-1;W[ce]||(W[ce]={}),W[ce][V]===void 0?(me=N.vertices.length,N.vertices.push(X.v[ge[0]].copy()),N.uvs.push(X.vt[ge[1]]?X.vt[ge[1]].slice():[0,0]),N.vertexNormals.push(X.vn[ge[2]]?X.vn[ge[2]].copy():new l.default.Vector),W[ce][V]=me,te.push(me),V&&G[V]&&G[V].diffuseColor&&q.add(X.v[ge[0]])):te.push(W[ce][V])}if(te[0]!==te[1]&&te[0]!==te[2]&&te[1]!==te[2])if(N.faces.push(te),V&&G[V]&&G[V].diffuseColor){J=J=!0;for(var oe=G[V].diffuseColor,de=0;de<te.length;de++)N.vertexColors.push(oe[0]),N.vertexColors.push(oe[1]),N.vertexColors.push(oe[2])}else ae=!0}}}if(N.vertexNormals.length===0&&N.computeNormals(),J===ae)throw new Error("Model coloring is inconsistent. Either all vertices should have colors or none should.")}(w,k,F),A.next=11;break;case 7:return A.prev=7,A.t0=A.catch(0),b?b(A.t0):l.default._friendlyError("Error during parsing: "+A.t0.message),A.abrupt("return");case 11:return A.prev=11,y&&w.normalize(),v&&w.flipU(),x&&w.flipV(),E._decrementPreload(),typeof g=="function"&&g(w),A.finish(11);case 18:case"end":return A.stop()}},O,null,[[0,7,11,18]])}));return function(O){return M.apply(this,arguments)}}(),b):(l.default._friendlyFileLoadError(3,p),b?b():l.default._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.")),w},l.default.prototype.model=function(p){this._assert3d("model"),l.default._validateParameters("model",arguments),0<p.vertices.length&&(this._renderer.geometryInHash(p.gid)||(p.edges.length===0&&p._makeTriangleEdges(),p._edgesToVertices(),this._renderer.createBuffers(p.gid,p)),this._renderer.drawBuffers(p.gid))};var d=l.default;i.default=d},{"../core/main":280,"./p5.Geometry":332,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.from":161,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243,"regenerator-runtime/runtime":257}],328:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Texture"),c.default.prototype.loadShader=function(d,p,m,g){c.default._validateParameters("loadShader",arguments),g=g||console.error;function b(){v._decrementPreload(),m&&m(y)}var y=new c.default.Shader,v=this,x=!1,S=!1;return this.loadStrings(d,function(w){y._vertSrc=w.join(`
`),S=!0,x&&b()},g),this.loadStrings(p,function(w){y._fragSrc=w.join(`
`),x=!0,S&&b()},g),y},c.default.prototype.createShader=function(d,p){return c.default._validateParameters("createShader",arguments),new c.default.Shader(this._renderer,d,p)},c.default.prototype.createFilterShader=function(d){c.default._validateParameters("createFilterShader",arguments);var p=d.includes("#version 300 es")?`#version 300 es
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    in vec3 aPosition;
    in vec2 aTexCoord;
    out vec2 vTexCoord;

    void main() {
      // transferring texcoords for the frag shader
      vTexCoord = aTexCoord;

      // copy position with a fourth coordinate for projection (1.0 is normal)
      vec4 positionVec4 = vec4(aPosition, 1.0);

      // project to 3D space
      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
    }
  `:`
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    attribute vec3 aPosition;
    // texcoords only come from p5 to vertex shader
    // so pass texcoords on to the fragment shader in a varying variable
    attribute vec2 aTexCoord;
    varying vec2 vTexCoord;

    void main() {
      // transferring texcoords for the frag shader
      vTexCoord = aTexCoord;

      // copy position with a fourth coordinate for projection (1.0 is normal)
      vec4 positionVec4 = vec4(aPosition, 1.0);

      // project to 3D space
      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
    }
  `,p=new c.default.Shader(this._renderer,p,d);return this._renderer.GL?p.ensureCompiledOnContext(this):p.ensureCompiledOnContext(this._renderer.getFilterGraphicsLayer()),p},c.default.prototype.shader=function(d){return this._assert3d("shader"),c.default._validateParameters("shader",arguments),d.ensureCompiledOnContext(this),d.isStrokeShader()?this._renderer.userStrokeShader=d:(this._renderer.userFillShader=d,this._renderer._useNormalMaterial=!1),this},c.default.prototype.resetShader=function(){return this._renderer.userFillShader=this._renderer.userStrokeShader=null,this},c.default.prototype.texture=function(d){return this._assert3d("texture"),c.default._validateParameters("texture",arguments),d.gifProperties&&d._animateGif(this),this._renderer.drawMode=u.TEXTURE,this._renderer._useNormalMaterial=!1,this._renderer._tex=d,this._renderer._setProperty("_doFill",!0),this},c.default.prototype.textureMode=function(d){d!==u.IMAGE&&d!==u.NORMAL?console.warn("You tried to set ".concat(d," textureMode only supports IMAGE & NORMAL ")):this._renderer.textureMode=d},c.default.prototype.textureWrap=function(d){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:d,m=(this._renderer.textureWrapX=d,this._renderer.textureWrapY=p,!0),g=!1,b=void 0;try{for(var y,v=this._renderer.textures.values()[Symbol.iterator]();!(m=(y=v.next()).done);m=!0)y.value.setWrapMode(d,p)}catch(x){g=!0,b=x}finally{try{m||v.return==null||v.return()}finally{if(g)throw b}}},c.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var d=arguments.length,p=new Array(d),m=0;m<d;m++)p[m]=arguments[m];return c.default._validateParameters("normalMaterial",p),this._renderer.drawMode=u.FILL,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!0,this._renderer.curFillColor=[1,1,1,1],this._renderer._setProperty("_doFill",!0),this.noStroke(),this},c.default.prototype.ambientMaterial=function(d,p,m){this._assert3d("ambientMaterial"),c.default._validateParameters("ambientMaterial",arguments);var g=c.default.prototype.color.apply(this,arguments);return this._renderer._hasSetAmbient=!0,this._renderer.curAmbientColor=g._array,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._setProperty("_doFill",!0),this},c.default.prototype.emissiveMaterial=function(d,p,m,g){this._assert3d("emissiveMaterial"),c.default._validateParameters("emissiveMaterial",arguments);var b=c.default.prototype.color.apply(this,arguments);return this._renderer.curEmissiveColor=b._array,this._renderer._useEmissiveMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},c.default.prototype.specularMaterial=function(d,p,m,g){this._assert3d("specularMaterial"),c.default._validateParameters("specularMaterial",arguments);var b=c.default.prototype.color.apply(this,arguments);return this._renderer.curSpecularColor=b._array,this._renderer._useSpecularMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},c.default.prototype.shininess=function(d){return this._assert3d("shininess"),c.default._validateParameters("shininess",arguments),this._renderer._useShininess=d=d<1?1:d,this},c.default.prototype.metalness=function(d){return this._assert3d("metalness"),d=1-Math.exp(-d/100),this._renderer._useMetalness=d,this},c.default.RendererGL.prototype._applyColorBlend=function(d,b){var m=this.GL,g=this.drawMode===u.TEXTURE,b=b||this.userFillShader||this.userStrokeShader||this.userPointShader||g||this.curBlendMode!==u.BLEND||d[d.length-1]<1||this._isErasing;return b!==this._isBlending&&(b||this.curBlendMode!==u.BLEND&&this.curBlendMode!==u.ADD?m.enable(m.BLEND):m.disable(m.BLEND),m.depthMask(!0),this._isBlending=b),this._applyBlendMode(),d},c.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode!==this.curBlendMode){var d=this.GL;switch(this.curBlendMode){case u.BLEND:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case u.ADD:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE);break;case u.REMOVE:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ZERO,d.ONE_MINUS_SRC_ALPHA);break;case u.MULTIPLY:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.DST_COLOR,d.ONE_MINUS_SRC_ALPHA);break;case u.SCREEN:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_COLOR);break;case u.EXCLUSION:d.blendEquationSeparate(d.FUNC_ADD,d.FUNC_ADD),d.blendFuncSeparate(d.ONE_MINUS_DST_COLOR,d.ONE_MINUS_SRC_COLOR,d.ONE,d.ONE);break;case u.REPLACE:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ZERO);break;case u.SUBTRACT:d.blendEquationSeparate(d.FUNC_REVERSE_SUBTRACT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case u.DARKEST:this.blendExt?(d.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case u.LIGHTEST:this.blendExt?(d.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.")}this._isErasing||(this._cachedBlendMode=this.curBlendMode)}};var h=c.default;i.default=h},{"../core/constants":269,"../core/main":280,"./p5.Texture":339,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],329:[function(r,s,i){r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.string.sub"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}a.default.prototype.camera=function(){var c;this._assert3d("camera");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("camera",f),(c=this._renderer._curCamera).camera.apply(c,f),this},a.default.prototype.perspective=function(){var c;this._assert3d("perspective");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("perspective",f),(c=this._renderer._curCamera).perspective.apply(c,f),this},a.default.prototype.linePerspective=function(c){if(a.default._validateParameters("linePerspective",arguments),!(this._renderer instanceof a.default.RendererGL))throw new Error("linePerspective() must be called in WebGL mode.");if(c===void 0)return this._renderer._curCamera.useLinePerspective;this._renderer._curCamera.useLinePerspective=c},a.default.prototype.ortho=function(){var c;this._assert3d("ortho");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("ortho",f),(c=this._renderer._curCamera).ortho.apply(c,f),this},a.default.prototype.frustum=function(){var c;this._assert3d("frustum");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return a.default._validateParameters("frustum",f),(c=this._renderer._curCamera).frustum.apply(c,f),this},a.default.prototype.createCamera=function(){this._assert3d("createCamera");var c=new a.default.Camera(this._renderer);return c._computeCameraDefaultSettings(),c._setDefaultCamera(),this._renderer._curCamera=c},a.default.Camera=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._renderer=h,this.cameraType="default",this.useLinePerspective=!0,this.cameraMatrix=new a.default.Matrix,this.projMatrix=new a.default.Matrix,this.yScale=1}var u,f;return u=c,(f=[{key:"perspective",value:function(g,d,p,m){this.cameraType=0<arguments.length?"custom":"default",g===void 0?(g=this.defaultCameraFOV,this.cameraFOV=g):this.cameraFOV=this._renderer._pInst._toRadians(g),d===void 0&&(d=this.defaultAspectRatio),p===void 0&&(p=this.defaultCameraNear),m===void 0&&(m=this.defaultCameraFar),p<=1e-4&&(p=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),m<p&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=d,this.cameraNear=p,this.cameraFar=m,this.projMatrix=a.default.Matrix.identity();var g=1/Math.tan(this.cameraFOV/2),b=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(g/d,0,0,0,0,-g*this.yScale,0,0,0,0,(m+p)*b,-1,0,0,2*m*p*b,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix)}},{key:"ortho",value:function(j,E,p,m,g,b){j===void 0&&(j=-this._renderer.width/2),E===void 0&&(E=+this._renderer.width/2),p===void 0&&(p=-this._renderer.height/2),m===void 0&&(m=+this._renderer.height/2),g===void 0&&(g=0),b===void 0&&(b=Math.max(this._renderer.width,this._renderer.height)+800),this.cameraNear=g;var P=E-j,y=m-p,v=(this.cameraFar=b)-g,x=2/P,S=2/y*this.yScale,w=-2/v,E=-(E+j)/P,j=-(m+p)/y,P=-(b+g)/v;this.projMatrix=a.default.Matrix.identity(),this.projMatrix.set(x,0,0,0,0,-S,0,0,0,0,w,0,E,j,P,1),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix),this.cameraType="custom"}},{key:"frustum",value:function(j,E,p,m,g,b){j===void 0&&(j=.05*-this._renderer.width),E===void 0&&(E=.05*+this._renderer.width),p===void 0&&(p=.05*+this._renderer.height),m===void 0&&(m=.05*-this._renderer.height),g===void 0&&(g=this.defaultCameraNear),b===void 0&&(b=this.defaultCameraFar),this.cameraNear=g;var P=E-j,y=m-p,v=(this.cameraFar=b)-g,x=2*g/P,S=2*g/y*this.yScale,w=-2*b*g/v,E=(E+j)/P,j=(m+p)/y,P=-(b+g)/v;this.projMatrix=a.default.Matrix.identity(),this.projMatrix.set(x,0,0,0,0,-S,0,0,E,j,P,-1,0,0,w,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix),this.cameraType="custom"}},{key:"_rotateView",value:function(x,d,p,m){var g=this.centerX,b=this.centerY,y=this.centerZ,v=(g-=this.eyeX,b-=this.eyeY,y-=this.eyeZ,a.default.Matrix.identity(this._renderer._pInst)),x=(v.rotate(this._renderer._pInst._toRadians(x),d,p,m),[g*v.mat4[0]+b*v.mat4[4]+y*v.mat4[8],g*v.mat4[1]+b*v.mat4[5]+y*v.mat4[9],g*v.mat4[2]+b*v.mat4[6]+y*v.mat4[10]]);x[0]+=this.eyeX,x[1]+=this.eyeY,x[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,x[0],x[1],x[2],this.upX,this.upY,this.upZ)}},{key:"pan",value:function(h){var d=this._getLocalAxes();this._rotateView(h,d.y[0],d.y[1],d.y[2])}},{key:"tilt",value:function(h){var d=this._getLocalAxes();this._rotateView(h,d.x[0],d.x[1],d.x[2])}},{key:"lookAt",value:function(h,d,p){this.camera(this.eyeX,this.eyeY,this.eyeZ,h,d,p,this.upX,this.upY,this.upZ)}},{key:"camera",value:function(h,d,p,m,g,b,y,v,x){return h===void 0&&(h=this.defaultEyeX,d=this.defaultEyeY,p=this.defaultEyeZ,m=h,g=d,v=1,x=y=b=0),this.eyeX=h,this.eyeY=d,this.eyeZ=p,m!==void 0&&(this.centerX=m,this.centerY=g,this.centerZ=b),y!==void 0&&(this.upX=y,this.upY=v,this.upZ=x),m=this._getLocalAxes(),this.cameraMatrix.set(m.x[0],m.y[0],m.z[0],0,m.x[1],m.y[1],m.z[1],0,m.x[2],m.y[2],m.z[2],0,0,0,0,1),g=-h,this.cameraMatrix.translate([g,-d,-p]),this._isActive()&&this._renderer.uMVMatrix.set(this.cameraMatrix),this}},{key:"move",value:function(m,g,p){var b=this._getLocalAxes(),m=[b.x[0]*m,b.x[1]*m,b.x[2]*m],g=[b.y[0]*g,b.y[1]*g,b.y[2]*g],b=[b.z[0]*p,b.z[1]*p,b.z[2]*p];this.camera(this.eyeX+m[0]+g[0]+b[0],this.eyeY+m[1]+g[1]+b[1],this.eyeZ+m[2]+g[2]+b[2],this.centerX+m[0]+g[0]+b[0],this.centerY+m[1]+g[1]+b[1],this.centerZ+m[2]+g[2]+b[2],this.upX,this.upY,this.upZ)}},{key:"setPosition",value:function(h,d,p){var m=h-this.eyeX,g=d-this.eyeY,b=p-this.eyeZ;this.camera(h,d,p,this.centerX+m,this.centerY+g,this.centerZ+b,this.upX,this.upY,this.upZ)}},{key:"set",value:function(h){for(var d=0,p=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType","yScale"];d<p.length;d++){var m=p[d];this[m]=h[m]}this.cameraMatrix=h.cameraMatrix.copy(),this.projMatrix=h.projMatrix.copy(),this._isActive()&&(this._renderer.uMVMatrix.mat4=this.cameraMatrix.mat4.slice(),this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())}},{key:"slerp",value:function(h,d,p){var m,g,b,y,v,x,S,w,E,j,P,M,O,k,F,A,N,$;p===0?this.set(h):p===1?this.set(d):(this.projMatrix.mat4[15]!==0&&(this.projMatrix.mat4[0]=h.projMatrix.mat4[0]*Math.pow(d.projMatrix.mat4[0]/h.projMatrix.mat4[0],p),this.projMatrix.mat4[5]=h.projMatrix.mat4[5]*Math.pow(d.projMatrix.mat4[5]/h.projMatrix.mat4[5],p),this._isActive()&&(this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())),y=new a.default.Vector(h.eyeX,h.eyeY,h.eyeZ),v=new a.default.Vector(d.eyeX,d.eyeY,d.eyeZ),A=new a.default.Vector(h.centerX,h.centerY,h.centerZ),$=new a.default.Vector(d.centerX,d.centerY,d.centerZ),b=a.default.Vector.dist(y,A),m=a.default.Vector.dist(v,$),m=b*Math.pow(m/b,p),b=a.default.Vector.sub(y,v),g=1,1e-6<(N=(k=y.copy().sub(v).sub(A).add($)).magSq())&&(g=a.default.Vector.dot(b,k)/N,g=Math.max(0,Math.min(g,1))),b=a.default.Vector.lerp(a.default.Vector.lerp(y,A,g),a.default.Vector.lerp(v,$,g),p),k=h.cameraMatrix.createSubMatrix3x3(),N=d.cameraMatrix.createSubMatrix3x3(),y=k.row(2),A=N.row(2),v=k.row(1),$=N.row(1),h=new a.default.Vector,d=new a.default.Vector,x=new a.default.Vector,S=new a.default.Vector,1-(w=.5*((k=(N=N.mult3x3(k.copy().transpose3x3())).diagonal())[0]+k[1]+k[2]-1))<1e-7?(h.set(a.default.Vector.lerp(y,A,p)).normalize(),x.set(h).mult(g*m).add(b),S.set(h).mult((g-1)*m).add(b),d.set(a.default.Vector.lerp(v,$,p)).normalize()):(A=1/(1-w),$=Math.max(k[0],k[1],k[2]),M=N.mat3[1]+N.mat3[3],O=N.mat3[2]+N.mat3[6],F=N.mat3[5]+N.mat3[7],$=$===k[0]?(j=.5*M*(A/=E=Math.sqrt((k[0]-w)*A)),P=.5*O*A,.5*(N.mat3[7]-N.mat3[5])/E):$===k[1]?(P=.5*F*(A/=j=Math.sqrt((k[1]-w)*A)),E=.5*M*A,.5*(N.mat3[2]-N.mat3[6])/j):(E=.5*O*(A/=P=Math.sqrt((k[2]-w)*A)),j=.5*F*A,.5*(N.mat3[3]-N.mat3[1])/P),M=p*Math.atan2($,w),O=Math.cos(M),k=Math.sin(M),($=new a.default.Matrix("mat3",[O+(F=1-O)*E*E,F*(A=E*j)+k*P,F*(N=P*E)-k*j,F*A-k*P,O+F*j*j,F*(p=j*P)+k*E,F*N+k*j,F*p-k*E,O+F*P*P])).multiplyVec3(y,h),x.set(h).mult(g*m).add(b),S.set(h).mult((g-1)*m).add(b),$.multiplyVec3(v,d)),this.camera(x.x,x.y,x.z,S.x,S.y,S.z,d.x,d.y,d.z))}},{key:"_computeCameraDefaultSettings",value:function(){this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=800,this.defaultCameraFOV=2*Math.atan(this._renderer.height/2/this.defaultEyeZ),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ}},{key:"_setDefaultCamera",value:function(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"}},{key:"_resize",value:function(){this.cameraType==="default"&&(this._computeCameraDefaultSettings(),this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.perspective())}},{key:"copy",value:function(){var h=new a.default.Camera(this._renderer);return h.cameraFOV=this.cameraFOV,h.aspectRatio=this.aspectRatio,h.eyeX=this.eyeX,h.eyeY=this.eyeY,h.eyeZ=this.eyeZ,h.centerX=this.centerX,h.centerY=this.centerY,h.centerZ=this.centerZ,h.upX=this.upX,h.upY=this.upY,h.upZ=this.upZ,h.cameraNear=this.cameraNear,h.cameraFar=this.cameraFar,h.cameraType=this.cameraType,h.cameraMatrix=this.cameraMatrix.copy(),h.projMatrix=this.projMatrix.copy(),h.yScale=this.yScale,h}},{key:"_getLocalAxes",value:function(){var h=this.eyeX-this.centerX,d=this.eyeY-this.centerY,p=this.eyeZ-this.centerZ,y=Math.sqrt(h*h+d*d+p*p),y=(y!==0&&(h/=y,d/=y,p/=y),this.upX),m=(v=this.upY)*p-(x=this.upZ)*d,g=-y*p+x*h,b=y*d-v*h,y=d*b-p*g,v=-h*b+p*m,x=h*g-d*m,S=Math.sqrt(m*m+g*g+b*b),S=(S!==0&&(m/=S,g/=S,b/=S),Math.sqrt(y*y+v*v+x*x));return S!==0&&(y/=S,v/=S,x/=S),{x:[m,g,b],y:[y,v,x],z:[h,d,p]}}},{key:"_orbit",value:function(h,S,x){var g=this.eyeX-this.centerX,b=this.eyeY-this.centerY,y=this.eyeZ-this.centerZ,m=Math.hypot(g,b,y),g=new a.default.Vector(g,b,y).normalize(),b=new a.default.Vector(this.upX,this.upY,this.upZ).normalize(),y=a.default.Vector.cross(b,g).normalize(),v=a.default.Vector.cross(y,b),x=((m=(m*=Math.pow(10,x))<this.cameraNear?this.cameraNear:m)>this.cameraFar&&(m=this.cameraFar),Math.acos(Math.max(-1,Math.min(1,a.default.Vector.dot(g,b))))+S),S=h;(x<=0||x>=Math.PI)&&(this.upX*=-1,this.upY*=-1,this.upZ*=-1),b.mult(Math.cos(x)),v.mult(Math.cos(S)*Math.sin(x)),y.mult(Math.sin(S)*Math.sin(x)),g.set(b).add(v).add(y),this.eyeX=m*g.x+this.centerX,this.eyeY=m*g.y+this.centerY,this.eyeZ=m*g.z+this.centerZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}},{key:"_orbitFree",value:function(x,S,E){var g=this.eyeX-this.centerX,b=this.eyeY-this.centerY,y=this.eyeZ-this.centerZ,m=Math.hypot(g,b,y),g=new a.default.Vector(g,b,y).normalize(),b=new a.default.Vector(this.upX,this.upY,this.upZ),y=a.default.Vector.cross(b,g).normalize(),v=a.default.Vector.cross(g,y),j=Math.atan2(S,x),j=(v.mult(Math.sin(j)),y.mult(Math.cos(j)).add(v),Math.sqrt(x*x+S*S)),v=a.default.Vector.cross(g,y),x=((m=(m*=Math.pow(10,E))<this.cameraNear?this.cameraNear:m)>this.cameraFar&&(m=this.cameraFar),Math.cos(j)),S=Math.sin(j),E=b.dot(g),j=b.dot(y),w=E*x+j*S,E=-E*S+j*x,j=b.dot(v);b.x=w*g.x+E*y.x+j*v.x,b.y=w*g.y+E*y.y+j*v.y,b.z=w*g.z+E*y.z+j*v.z,y.mult(-S),g.mult(x).add(y).mult(m),this.camera(g.x+this.centerX,g.y+this.centerY,g.z+this.centerZ,this.centerX,this.centerY,this.centerZ,b.x,b.y,b.z)}},{key:"_isActive",value:function(){return this===this._renderer._curCamera}}])&&l(u.prototype,f),c}(),a.default.prototype.setCamera=function(c){this._renderer._curCamera=c,this._renderer.uPMatrix.set(c.projMatrix)},r=a.default.Camera,i.default=r},{"../core/main":280,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.string.sub":205}],330:[function(r,s,i){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.log2"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.log2"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function a(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.DataArray=function(){function l(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:128,h=this,d=l;if(!(h instanceof d))throw new TypeError("Cannot call a class as a function");this.length=0,this.data=new Float32Array(f),this.initialLength=f}var c,u;return c=l,(u=[{key:"dataArray",value:function(){return this.subArray(0,this.length)}},{key:"clear",value:function(){this.length=0}},{key:"rescale",value:function(){var f;this.length<this.data.length/2&&(f=1<<Math.ceil(Math.log2(this.length)),(f=new Float32Array(f)).set(this.data.subarray(0,this.length),0),this.data=f)}},{key:"reset",value:function(){this.clear(),this.data=new Float32Array(this.initialLength)}},{key:"push",value:function(){for(var f=arguments.length,h=new Array(f),d=0;d<f;d++)h[d]=arguments[d];this.ensureLength(this.length+h.length),this.data.set(h,this.length),this.length+=h.length}},{key:"slice",value:function(f,h){return this.data.slice(f,Math.min(h,this.length))}},{key:"subArray",value:function(f,h){return this.data.subarray(f,Math.min(h,this.length))}},{key:"ensureLength",value:function(f){for(;this.data.length<f;){var h=new Float32Array(2*this.data.length);h.set(this.data,0),this.data=h}}}])&&a(c.prototype,u),l}(),r=r.default.DataArray,i.default=r},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.log2":176,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236}],331:[function(M,s,i){function a(O){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k})(O)}function l(O){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(k){return a(k)}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":a(k)})(O)}M("core-js/modules/es.symbol"),M("core-js/modules/es.symbol.description"),M("core-js/modules/es.symbol.iterator"),M("core-js/modules/es.array.fill"),M("core-js/modules/es.array.includes"),M("core-js/modules/es.array.iterator"),M("core-js/modules/es.object.get-own-property-descriptor"),M("core-js/modules/es.object.get-prototype-of"),M("core-js/modules/es.object.to-string"),M("core-js/modules/es.reflect.construct"),M("core-js/modules/es.reflect.get"),M("core-js/modules/es.regexp.to-string"),M("core-js/modules/es.string.includes"),M("core-js/modules/es.string.iterator"),M("core-js/modules/es.typed-array.float32-array"),M("core-js/modules/es.typed-array.uint8-array"),M("core-js/modules/es.typed-array.uint8-clamped-array"),M("core-js/modules/es.typed-array.copy-within"),M("core-js/modules/es.typed-array.every"),M("core-js/modules/es.typed-array.fill"),M("core-js/modules/es.typed-array.filter"),M("core-js/modules/es.typed-array.find"),M("core-js/modules/es.typed-array.find-index"),M("core-js/modules/es.typed-array.for-each"),M("core-js/modules/es.typed-array.includes"),M("core-js/modules/es.typed-array.index-of"),M("core-js/modules/es.typed-array.iterator"),M("core-js/modules/es.typed-array.join"),M("core-js/modules/es.typed-array.last-index-of"),M("core-js/modules/es.typed-array.map"),M("core-js/modules/es.typed-array.reduce"),M("core-js/modules/es.typed-array.reduce-right"),M("core-js/modules/es.typed-array.reverse"),M("core-js/modules/es.typed-array.set"),M("core-js/modules/es.typed-array.slice"),M("core-js/modules/es.typed-array.some"),M("core-js/modules/es.typed-array.sort"),M("core-js/modules/es.typed-array.subarray"),M("core-js/modules/es.typed-array.to-locale-string"),M("core-js/modules/es.typed-array.to-string"),M("core-js/modules/es.weak-map"),M("core-js/modules/web.dom-collections.iterator"),M("core-js/modules/es.array.fill"),M("core-js/modules/es.array.includes"),M("core-js/modules/es.array.iterator"),M("core-js/modules/es.object.get-prototype-of"),M("core-js/modules/es.object.to-string"),M("core-js/modules/es.string.includes"),M("core-js/modules/es.typed-array.float32-array"),M("core-js/modules/es.typed-array.uint8-array"),M("core-js/modules/es.typed-array.uint8-clamped-array"),M("core-js/modules/es.typed-array.copy-within"),M("core-js/modules/es.typed-array.every"),M("core-js/modules/es.typed-array.fill"),M("core-js/modules/es.typed-array.filter"),M("core-js/modules/es.typed-array.find"),M("core-js/modules/es.typed-array.find-index"),M("core-js/modules/es.typed-array.for-each"),M("core-js/modules/es.typed-array.includes"),M("core-js/modules/es.typed-array.index-of"),M("core-js/modules/es.typed-array.iterator"),M("core-js/modules/es.typed-array.join"),M("core-js/modules/es.typed-array.last-index-of"),M("core-js/modules/es.typed-array.map"),M("core-js/modules/es.typed-array.reduce"),M("core-js/modules/es.typed-array.reduce-right"),M("core-js/modules/es.typed-array.reverse"),M("core-js/modules/es.typed-array.set"),M("core-js/modules/es.typed-array.slice"),M("core-js/modules/es.typed-array.some"),M("core-js/modules/es.typed-array.sort"),M("core-js/modules/es.typed-array.subarray"),M("core-js/modules/es.typed-array.to-locale-string"),M("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(P=M("../core/main"))&&P.__esModule?P:{default:P},u=function(O){if(O&&O.__esModule)return O;if(O===null||l(O)!=="object"&&typeof O!="function")return{default:O};var k=d();if(k&&k.has(O))return k.get(O);var F,A={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(F in O){var $;Object.prototype.hasOwnProperty.call(O,F)&&(($=N?Object.getOwnPropertyDescriptor(O,F):null)&&($.get||$.set)?Object.defineProperty(A,F,$):A[F]=O[F])}return A.default=O,k&&k.set(O,A),A}(M("../core/constants")),f=M("./p5.Texture"),h=M("./p5.RendererGL");function d(){var O;return typeof WeakMap!="function"?null:(O=new WeakMap,d=function(){return O},O)}function p(O,k){return function(F){if(Array.isArray(F))return F}(O)||function(F,A){if(Symbol.iterator in Object(F)||Object.prototype.toString.call(F)==="[object Arguments]"){var N=[],$=!0,G=!1,X=void 0;try{for(var W,V=F[Symbol.iterator]();!($=(W=V.next()).done)&&(N.push(W.value),!A||N.length!==A);$=!0);}catch(q){G=!0,X=q}finally{try{$||V.return==null||V.return()}finally{if(G)throw X}}return N}}(O,k)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(O,k,F){return k in O?Object.defineProperty(O,k,{value:F,enumerable:!0,configurable:!0,writable:!0}):O[k]=F,O}function g(O,k){if(!(O instanceof k))throw new TypeError("Cannot call a class as a function")}function b(O,k){for(var F=0;F<k.length;F++){var A=k[F];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(O,A.key,A)}}function y(O,k,F){k&&b(O.prototype,k),F&&b(O,F)}function v(O,k,F){return(v=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(G,N,$){var G=function(X,W){for(;!Object.prototype.hasOwnProperty.call(X,W)&&(X=w(X))!==null;);return X}(G,N);if(G)return(G=Object.getOwnPropertyDescriptor(G,N)).get?G.get.call($):G.value})(O,k,F||O)}function x(O,k){return(x=Object.setPrototypeOf||function(F,A){return F.__proto__=A,F})(O,k)}function S(O){return function(){var k,F=w(O),F=(k=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(k=w(this).constructor,Reflect.construct(F,arguments,k)):F.apply(this,arguments),this);if(!k||l(k)!=="object"&&typeof k!="function"){if(F!==void 0)return F;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return k}}function w(O){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(k){return k.__proto__||Object.getPrototypeOf(k)})(O)}var E=function(O){var k=A;if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(O&&O.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),O&&x(k,O);var F=S(A);function A(N){var $;return g(this,A),($=F.call(this,N.target._renderer)).fbo=N,$.yScale=-1,$}return y(A,[{key:"_computeCameraDefaultSettings",value:function(){v(w(A.prototype),"_computeCameraDefaultSettings",this).call(this),this.defaultAspectRatio=this.fbo.width/this.fbo.height,this.defaultCameraFOV=2*Math.atan(this.fbo.height/2/this.defaultEyeZ)}}]),A}(c.default.Camera),j=(c.default.FramebufferCamera=E,function(){function O(k,F){g(this,O),this.framebuffer=k,this.property=F}return y(O,[{key:"rawTexture",value:function(){return this.framebuffer[this.property]}},{key:"width",get:function(){return this.framebuffer.width*this.framebuffer.density}},{key:"height",get:function(){return this.framebuffer.height*this.framebuffer.density}}]),O}()),P=(c.default.FramebufferTexture=j,function(){function O(k){var F=this,A=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},N=(g(this,O),this.target=k,this.target._renderer.framebuffers.add(this),this._isClipApplied=!1,this.pixels=[],this.format=A.format||u.UNSIGNED_BYTE,this.channels=A.channels||(k._renderer._pInst._glAttributes.alpha?u.RGBA:u.RGB),this.useDepth=A.depth===void 0||A.depth,this.depthFormat=A.depthFormat||u.FLOAT,this.textureFiltering=A.textureFiltering||u.LINEAR,A.antialias===void 0?this.antialiasSamples=k._renderer._pInst._glAttributes.antialias?2:0:typeof A.antialias=="number"?this.antialiasSamples=A.antialias:this.antialiasSamples=A.antialias?2:0,this.antialias=0<this.antialiasSamples,this.antialias&&k.webglVersion!==u.WEBGL2&&(console.warn("Antialiasing is unsupported in a WebGL 1 context"),this.antialias=!1),this.density=A.density||k.pixelDensity(),k._renderer.GL);if(this.gl=N,A.width&&A.height?($=k._renderer._adjustDimensions(A.width,A.height),this.width=$.adjustedWidth,this.height=$.adjustedHeight,this.autoSized=!1):(A.width===void 0!=(A.height===void 0)&&console.warn("Please supply both width and height for a framebuffer to give it a size. Only one was given, so the framebuffer will match the size of its canvas."),this.width=k.width,this.height=k.height,this.autoSized=!0),this._checkIfFormatsAvailable(),A.stencil&&!this.useDepth&&console.warn("A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored."),this.useStencil=this.useDepth&&(A.stencil===void 0||A.stencil),this.framebuffer=N.createFramebuffer(),!this.framebuffer)throw new Error("Unable to create a framebuffer");if(this.antialias&&(this.aaFramebuffer=N.createFramebuffer(),!this.aaFramebuffer))throw new Error("Unable to create a framebuffer for antialiasing");this._recreateTextures();var $=this.target._renderer._curCamera;this.defaultCamera=this.createCamera(),this.filterCamera=this.createCamera(),this.target._renderer._curCamera=$,this.draw(function(){return F.target.clear()})}return y(O,[{key:"resize",value:function(k,F){this.autoSized=!1;var A=this.target._renderer._adjustDimensions(k,F);k=A.adjustedWidth,F=A.adjustedHeight,this.width=k,this.height=F,this._handleResize()}},{key:"pixelDensity",value:function(k){if(!k)return this.density;this.autoSized=!1,this.density=k,this._handleResize()}},{key:"autoSized",value:function(k){if(k===void 0)return this.autoSized;this.autoSized=k,this._handleResize()}},{key:"_checkIfFormatsAvailable",value:function(){var k=this.gl,k=(this.useDepth&&this.target.webglVersion===u.WEBGL&&!k.getExtension("WEBGL_depth_texture")&&(console.warn("Unable to create depth textures in this environment. Falling back to a framebuffer without depth."),this.useDepth=!1),this.useDepth&&this.target.webglVersion===u.WEBGL&&this.depthFormat===u.FLOAT&&(console.warn("FLOAT depth format is unavailable in WebGL 1. Defaulting to UNSIGNED_INT."),this.depthFormat=u.UNSIGNED_INT),[u.UNSIGNED_BYTE,u.FLOAT,u.HALF_FLOAT].includes(this.format)||(console.warn("Unknown Framebuffer format. Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. Defaulting to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.useDepth&&![u.UNSIGNED_INT,u.FLOAT].includes(this.depthFormat)&&(console.warn("Unknown Framebuffer depth format. Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT."),this.depthFormat=u.FLOAT),(0,f.checkWebGLCapabilities)(this.target._renderer));k.float||this.format!==u.FLOAT||(console.warn("This environment does not support FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.useDepth&&!k.float&&this.depthFormat===u.FLOAT&&(console.warn("This environment does not support FLOAT depth textures. Falling back to UNSIGNED_INT."),this.depthFormat=u.UNSIGNED_INT),k.halfFloat||this.format!==u.HALF_FLOAT||(console.warn("This environment does not support HALF_FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.channels===u.RGB&&[u.FLOAT,u.HALF_FLOAT].includes(this.format)&&(console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only RGB channels. Falling back to RGBA."),this.channels=u.RGBA)}},{key:"_recreateTextures",value:function(){var k=this.gl,F=(this._updateSize(),k.getParameter(k.TEXTURE_BINDING_2D)),A=k.getParameter(k.FRAMEBUFFER_BINDING),N=k.createTexture();if(!N)throw new Error("Unable to create color texture");k.bindTexture(k.TEXTURE_2D,N);var $=this._glColorFormat();if(k.texImage2D(k.TEXTURE_2D,0,$.internalFormat,this.width*this.density,this.height*this.density,0,$.format,$.type,null),this.colorTexture=N,k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer),k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,N,0),this.useDepth){var N=k.createTexture();if(!N)throw new Error("Unable to create depth texture");var G=this._glDepthFormat();k.bindTexture(k.TEXTURE_2D,N),k.texImage2D(k.TEXTURE_2D,0,G.internalFormat,this.width*this.density,this.height*this.density,0,G.format,G.type,null),k.framebufferTexture2D(k.FRAMEBUFFER,this.useStencil?k.DEPTH_STENCIL_ATTACHMENT:k.DEPTH_ATTACHMENT,k.TEXTURE_2D,N,0),this.depthTexture=N}this.antialias&&(this.colorRenderbuffer=k.createRenderbuffer(),k.bindRenderbuffer(k.RENDERBUFFER,this.colorRenderbuffer),k.renderbufferStorageMultisample(k.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,k.getParameter(k.MAX_SAMPLES))),$.internalFormat,this.width*this.density,this.height*this.density),this.useDepth&&(G=this._glDepthFormat(),this.depthRenderbuffer=k.createRenderbuffer(),k.bindRenderbuffer(k.RENDERBUFFER,this.depthRenderbuffer),k.renderbufferStorageMultisample(k.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,k.getParameter(k.MAX_SAMPLES))),G.internalFormat,this.width*this.density,this.height*this.density)),k.bindFramebuffer(k.FRAMEBUFFER,this.aaFramebuffer),k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.RENDERBUFFER,this.colorRenderbuffer),this.useDepth&&k.framebufferRenderbuffer(k.FRAMEBUFFER,this.useStencil?k.DEPTH_STENCIL_ATTACHMENT:k.DEPTH_ATTACHMENT,k.RENDERBUFFER,this.depthRenderbuffer)),this.useDepth&&(this.depth=new j(this,"depthTexture"),N=k.NEAREST,this.depthP5Texture=new c.default.Texture(this.target._renderer,this.depth,{minFilter:N,magFilter:N}),this.target._renderer.textures.set(this.depth,this.depthP5Texture)),this.color=new j(this,"colorTexture"),$=this.textureFiltering===u.LINEAR?k.LINEAR:k.NEAREST,this.colorP5Texture=new c.default.Texture(this.target._renderer,this.color,{minFilter:$,magFilter:$}),this.target._renderer.textures.set(this.color,this.colorP5Texture),k.bindTexture(k.TEXTURE_2D,F),k.bindFramebuffer(k.FRAMEBUFFER,A)}},{key:"_glColorFormat",value:function(){var k,F,A=this.gl,N=this.format===u.FLOAT?A.FLOAT:this.format===u.HALF_FLOAT?this.target.webglVersion===u.WEBGL2?A.HALF_FLOAT:A.getExtension("OES_texture_half_float").HALF_FLOAT_OES:A.UNSIGNED_BYTE,$=this.channels===u.RGBA?A.RGBA:A.RGB;return{internalFormat:this.target.webglVersion===u.WEBGL2?(m(F={},A.FLOAT,m({},A.RGBA,A.RGBA32F)),m(F,A.HALF_FLOAT,m({},A.RGBA,A.RGBA16F)),m(F,A.UNSIGNED_BYTE,(m(k={},A.RGBA,A.RGBA8),m(k,A.RGB,A.RGB8),k)),F[N][$]):this.format===u.HALF_FLOAT?A.RGBA:$,format:$,type:N}}},{key:"_glDepthFormat",value:function(){var A=this.gl,k=this.useStencil?this.depthFormat===u.FLOAT?A.FLOAT_32_UNSIGNED_INT_24_8_REV:this.target.webglVersion===u.WEBGL2?A.UNSIGNED_INT_24_8:A.getExtension("WEBGL_depth_texture").UNSIGNED_INT_24_8_WEBGL:this.depthFormat===u.FLOAT?A.FLOAT:A.UNSIGNED_INT,F=this.useStencil?A.DEPTH_STENCIL:A.DEPTH_COMPONENT,A=this.useStencil?this.depthFormat===u.FLOAT?A.DEPTH32F_STENCIL8:this.target.webglVersion===u.WEBGL2?A.DEPTH24_STENCIL8:A.DEPTH_STENCIL:this.target.webglVersion===u.WEBGL2?this.depthFormat===u.FLOAT?A.DEPTH_COMPONENT32F:A.DEPTH_COMPONENT24:A.DEPTH_COMPONENT;return{internalFormat:A,format:F,type:k}}},{key:"_updateSize",value:function(){this.autoSized&&(this.width=this.target.width,this.height=this.target.height,this.density=this.target.pixelDensity())}},{key:"_canvasSizeChanged",value:function(){this.autoSized&&this._handleResize()}},{key:"_handleResize",value:function(){var N=this.color,k=this.depth,F=this.colorRenderbuffer,A=this.depthRenderbuffer,N=(this._deleteTexture(N),k&&this._deleteTexture(k),this.gl);F&&N.deleteRenderbuffer(F),A&&N.deleteRenderbuffer(A),this._recreateTextures(),this.defaultCamera._resize()}},{key:"createCamera",value:function(){var k=new E(this);return k._computeCameraDefaultSettings(),k._setDefaultCamera(),this.target._renderer._curCamera=k}},{key:"_deleteTexture",value:function(k){this.gl.deleteTexture(k.rawTexture()),this.target._renderer.textures.delete(k)}},{key:"remove",value:function(){var k=this.gl;this._deleteTexture(this.color),this.depth&&this._deleteTexture(this.depth),k.deleteFramebuffer(this.framebuffer),this.aaFramebuffer&&k.deleteFramebuffer(this.aaFramebuffer),this.depthRenderbuffer&&k.deleteRenderbuffer(this.depthRenderbuffer),this.colorRenderbuffer&&k.deleteRenderbuffer(this.colorRenderbuffer),this.target._renderer.framebuffers.delete(this)}},{key:"begin",value:function(){this.prevFramebuffer=this.target._renderer.activeFramebuffer(),this.prevFramebuffer&&this.prevFramebuffer._beforeEnd(),this.target._renderer.activeFramebuffers.push(this),this._beforeBegin(),this.target.push(),this.target.setCamera(this.defaultCamera),this.target._renderer.uMVMatrix.set(this.target._renderer._curCamera.cameraMatrix),this.target._renderer._applyStencilTestIfClipping()}},{key:"_framebufferToBind",value:function(){return this.antialias?this.aaFramebuffer:this.framebuffer}},{key:"_beforeBegin",value:function(){var k=this.gl;k.bindFramebuffer(k.FRAMEBUFFER,this._framebufferToBind()),this.target._renderer.viewport(this.width*this.density,this.height*this.density)}},{key:"_beforeEnd",value:function(){if(this.antialias){var k=this.gl,F=(k.bindFramebuffer(k.READ_FRAMEBUFFER,this.aaFramebuffer),k.bindFramebuffer(k.DRAW_FRAMEBUFFER,this.framebuffer),[[k.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]]);this.useDepth&&F.push([k.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter]);for(var A=0,N=F;A<N.length;A++){var G=p(N[A],2),$=G[0],G=G[1];k.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,$,G)}}}},{key:"end",value:function(){var k=this.gl;if(this.target.pop(),this.target._renderer.activeFramebuffers.pop()!==this)throw new Error("It looks like you've called end() while another Framebuffer is active.");this._beforeEnd(),this.prevFramebuffer?this.prevFramebuffer._beforeBegin():(k.bindFramebuffer(k.FRAMEBUFFER,null),this.target._renderer.viewport(this.target._renderer._origViewport.width,this.target._renderer._origViewport.height)),this.target._renderer._applyStencilTestIfClipping()}},{key:"draw",value:function(k){this.begin(),k(),this.end()}},{key:"loadPixels",value:function(){var k=this.gl,F=this.target._renderer.activeFramebuffer(),A=(k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer),this._glColorFormat());this.pixels=(0,h.readPixelsWebGL)(this.pixels,k,this.framebuffer,0,0,this.width*this.density,this.height*this.density,A.format,A.type),F?k.bindFramebuffer(k.FRAMEBUFFER,F._framebufferToBind()):k.bindFramebuffer(k.FRAMEBUFFER,null)}},{key:"get",value:function(k,F,A,N){c.default._validateParameters("p5.Framebuffer.get",arguments);var $=this._glColorFormat();if(k===void 0&&F===void 0)F=k=0,A=this.width,N=this.height;else if(A===void 0&&N===void 0)return(k<0||F<0||k>=this.width||F>=this.height)&&(console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped."),k=this.target.constrain(k,0,this.width-1),F=this.target.constrain(F,0,this.height-1)),(0,h.readPixelWebGL)(this.gl,this.framebuffer,k*this.density,F*this.density,$.format,$.type);k=this.target.constrain(k,0,this.width-1),F=this.target.constrain(F,0,this.height-1),A=this.target.constrain(A,1,this.width-k),N=this.target.constrain(N,1,this.height-F);for(var G=(0,h.readPixelsWebGL)(void 0,this.gl,this.framebuffer,k*this.density,F*this.density,A*this.density,N*this.density,$.format,$.type),X=new Uint8ClampedArray(A*N*this.density*this.density*4),W=(X.fill(255),$.type===this.gl.RGB?3:4),V=0;V<N*this.density;V++)for(var q=0;q<A*this.density;q++)for(var J=0;J<4;J++){var ae,I=4*(V*A*this.density+q)+J;J<W&&(ae=W==4?I:(V*A*this.density+q)*W+J,X[I]=G[ae])}return k=new c.default.Image(A*this.density,N*this.density),k.imageData=k.canvas.getContext("2d").createImageData(k.width,k.height),k.imageData.data.set(X),k.pixels=k.imageData.data,k.updatePixels(),this.density!==1&&k.resize(A,N),k}},{key:"updatePixels",value:function(){var k=this.gl,F=(this.colorP5Texture.bindTexture(),this._glColorFormat()),A=F.format===k.RGBA?4:3,A=this.width*this.height*this.density*this.density*A,N=F.type===k.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(this.pixels instanceof N)||this.pixels.length!==A)throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().");k.texImage2D(k.TEXTURE_2D,0,F.internalFormat,this.width*this.density,this.height*this.density,0,F.format,F.type,this.pixels),this.colorP5Texture.unbindTexture(),N=this.target._renderer.activeFramebuffer(),this.antialias?(this.begin(),this.target.push(),this.target.imageMode(this.target.CENTER),this.target.resetMatrix(),this.target.noStroke(),this.target.clear(),this.target.image(this,0,0),this.target.pop(),this.useDepth&&(k.clearDepth(1),k.clear(k.DEPTH_BUFFER_BIT)),this.end()):(k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer),this.useDepth&&(k.clearDepth(1),k.clear(k.DEPTH_BUFFER_BIT)),N?k.bindFramebuffer(k.FRAMEBUFFER,N._framebufferToBind()):k.bindFramebuffer(k.FRAMEBUFFER,null))}}]),O}()),M=c.default.Framebuffer=P;i.default=M},{"../core/constants":269,"../core/main":280,"./p5.RendererGL":337,"./p5.Texture":339,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.typed-array.uint8-clamped-array":240,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],332:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function l(m){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.flat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.unscopables.flat"),r("core-js/modules/es.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.flat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.unscopables.flat"),r("core-js/modules/es.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(m){if(m&&m.__esModule)return m;if(m===null||l(m)!=="object"&&typeof m!="function")return{default:m};var g=f();if(g&&g.has(m))return g.get(m);var b,y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in m){var x;Object.prototype.hasOwnProperty.call(m,b)&&((x=v?Object.getOwnPropertyDescriptor(m,b):null)&&(x.get||x.set)?Object.defineProperty(y,b,x):y[b]=m[b])}return y.default=m,g&&g.set(m,y),y}(r("../core/constants"));function f(){var m;return typeof WeakMap!="function"?null:(m=new WeakMap,f=function(){return m},m)}function h(m){return function(g){if(Array.isArray(g)){for(var b=0,y=new Array(g.length);b<g.length;b++)y[b]=g[b];return y}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(m,g){for(var b=0;b<g.length;b++){var y=g[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(m,y.key,y)}}c.default.Geometry=function(){function m(y,v,x){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");this.vertices=[],this.boundingBoxCache=null,this.lineVertices=new c.default.DataArray,this.lineTangentsIn=new c.default.DataArray,this.lineTangentsOut=new c.default.DataArray,this.lineSides=new c.default.DataArray,this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.lineVertexColors=new c.default.DataArray,this.detailX=y!==void 0?y:1,this.detailY=v!==void 0?v:1,this.dirtyFlags={},this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,x instanceof Function&&x.call(this)}var g,b;return g=m,(b=[{key:"calculateBoundingBox",value:function(){if(!this.boundingBoxCache){for(var y=new c.default.Vector(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),v=new c.default.Vector(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),x=0;x<this.vertices.length;x++){var S=this.vertices[x];y.x=Math.min(y.x,S.x),y.y=Math.min(y.y,S.y),y.z=Math.min(y.z,S.z),v.x=Math.max(v.x,S.x),v.y=Math.max(v.y,S.y),v.z=Math.max(v.z,S.z)}var w=new c.default.Vector(v.x-y.x,v.y-y.y,v.z-y.z),E=new c.default.Vector((y.x+v.x)/2,(y.y+v.y)/2,(y.z+v.z)/2);this.boundingBoxCache={min:y,max:v,size:w,offset:E}}return this.boundingBoxCache}},{key:"reset",value:function(){this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear(),this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.clear(),this.vertexNormals.length=0,this.uvs.length=0,this.dirtyFlags={}}},{key:"hasFillTransparency",value:function(){if(this._hasFillTransparency===void 0){this._hasFillTransparency=!1;for(var y=0;y<this.vertexColors.length;y+=4)if(this.vertexColors[y+3]<1){this._hasFillTransparency=!0;break}}return this._hasFillTransparency}},{key:"hasStrokeTransparency",value:function(){if(this._hasStrokeTransparency===void 0){this._hasStrokeTransparency=!1;for(var y=0;y<this.lineVertexColors.length;y+=4)if(this.lineVertexColors[y+3]<1){this._hasStrokeTransparency=!0;break}}return this._hasStrokeTransparency}},{key:"clearColors",value:function(){return this.vertexColors=[],this}},{key:"flipU",value:function(){this.uvs=this.uvs.flat().map(function(y,v){return v%2==0?1-y:y})}},{key:"flipV",value:function(){this.uvs=this.uvs.flat().map(function(y,v){return v%2==0?y:1-y})}},{key:"computeFaces",value:function(){this.faces.length=0;for(var y,v,x,S=this.detailX+1,w=0;w<this.detailY;w++)for(var E=0;E<this.detailX;E++)v=(w+1)*S+E+1,this.faces.push([w*S+E,y=w*S+E+1,x=(w+1)*S+E]),this.faces.push([x,y,v]);return this}},{key:"_getFaceNormal",value:function(v){var v=this.faces[v],x=this.vertices[v[0]],w=this.vertices[v[1]],v=this.vertices[v[2]],w=c.default.Vector.sub(w,x),v=c.default.Vector.sub(v,x),x=c.default.Vector.cross(w,v),S=c.default.Vector.mag(x),w=S/(c.default.Vector.mag(w)*c.default.Vector.mag(v));return w===0||isNaN(w)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),x):(1<w&&(w=1),x.mult(Math.asin(w)/S))}},{key:"computeNormals",value:function(){var y,v=this,x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:u.FLAT,S=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).roundToPrecision,w=this.vertexNormals,E=this.vertices,j=this.faces;if(x===u.SMOOTH){for(var P={},M=[],O=Math.pow(10,S===void 0?3:S),k=function(G){return Math.round(G*O)/O},F=function(G){return"".concat(k(G.x),",").concat(k(G.y),",").concat(k(G.z))},A=0;A<E.length;A++){var N=E[A],$=F(N);P[$]===void 0&&(P[$]=M.length,M.push(N))}j.forEach(function(G){for(var X=0;X<3;++X){var W=G[X],W=E[W],W=F(W);G[X]=P[W]}}),this.edges.forEach(function(G){for(var X=0;X<2;++X){var W=G[X],W=E[W],W=F(W);G[X]=P[W]}}),this.vertices=E=M}for(y=w.length=0;y<E.length;++y)w.push(new c.default.Vector);for(j.forEach(function(G,X){for(var W=v._getFaceNormal(X),V=0;V<3;++V){var q=G[V];w[q].add(W)}}),y=0;y<E.length;++y)w[y].normalize();return this}},{key:"averageNormals",value:function(){for(var y=0;y<=this.detailY;y++){var v=this.detailX+1,x=c.default.Vector.add(this.vertexNormals[y*v],this.vertexNormals[y*v+this.detailX]),x=c.default.Vector.div(x,2);this.vertexNormals[y*v]=x,this.vertexNormals[y*v+this.detailX]=x}return this}},{key:"averagePoleNormals",value:function(){for(var y=new c.default.Vector(0,0,0),v=0;v<this.detailX;v++)y.add(this.vertexNormals[v]);for(var y=c.default.Vector.div(y,this.detailX),x=0;x<this.detailX;x++)this.vertexNormals[x]=y;y=new c.default.Vector(0,0,0);for(var S=this.vertices.length-1;S>this.vertices.length-1-this.detailX;S--)y.add(this.vertexNormals[S]);y=c.default.Vector.div(y,this.detailX);for(var w=this.vertices.length-1;w>this.vertices.length-1-this.detailX;w--)this.vertexNormals[w]=y;return this}},{key:"_makeTriangleEdges",value:function(){for(var y=this.edges.length=0;y<this.faces.length;y++)this.edges.push([this.faces[y][0],this.faces[y][1]]),this.edges.push([this.faces[y][1],this.faces[y][2]]),this.edges.push([this.faces[y][2],this.faces[y][0]]);return this}},{key:"_edgesToVertices",value:function(){this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear();for(var y,v=new Map,x=new Set,S=0;S<this.edges.length;S++){var w,E=this.edges[S-1],j=this.edges[S],P=this.vertices[j[0]],M=this.vertices[j[1]],O=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*j[0],4*(j[0]+1)):[0,0,0,0],k=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*j[1],4*(j[1]+1)):[0,0,0,0],F=M.copy().sub(P).normalize(),A=0<F.magSq();A&&this._addSegment(P,M,O,k,F),0<S&&E[1]===j[0]?x.has(j[0])||(x.add(j[0]),v.delete(j[0]),y&&A&&F.dot(y)<1-1e-8&&this._addJoin(P,y,F,O)):(A&&!x.has(j[0])&&((w=v.get(j[0]))?(this._addJoin(P,w.dir,F,O),v.delete(j[0]),x.add(j[0])):v.set(j[0],{point:P,dir:F.copy().mult(-1),color:O})),y&&!x.has(E[1])&&((w=v.get(E[1]))?(this._addJoin(this.vertices[E[1]],y,w.dir.copy().mult(-1),O),v.delete(E[1]),x.add(E[1])):v.set(E[1],{point:this.vertices[E[1]],dir:y,color:O}),y=void 0)),S!==this.edges.length-1||x.has(j[1])||((P=v.get(j[1]))?(this._addJoin(M,F,P.dir.copy().mult(-1),k),v.delete(j[1]),x.add(j[1])):v.set(j[1],{point:M,dir:F,color:k})),A&&(y=F)}var N=!0,$=!1,G=void 0;try{for(var X,W=v.values()[Symbol.iterator]();!(N=(X=W.next()).done);N=!0){var V=X.value,q=V.point,J=V.dir,ae=V.color;this._addCap(q,J,ae)}}catch(I){$=!0,G=I}finally{try{N||W.return==null||W.return()}finally{if($)throw G}}return this}},{key:"_addSegment",value:function(E,j,x,S,w){var E=E.array(),j=j.array(),P=w.array();this.lineSides.push(1,1,-1,1,-1,-1);for(var M=0,O=[this.lineTangentsIn,this.lineTangentsOut];M<O.length;M++)for(var k=O[M],F=0;F<6;F++)k.push.apply(k,h(P));return(w=this.lineVertices).push.apply(w,h(E).concat(h(j),h(E),h(j),h(j),h(E))),(w=this.lineVertexColors).push.apply(w,h(x).concat(h(S),h(x),h(S),h(S),h(x))),this}},{key:"_addCap",value:function(y,v,x){for(var S,w=y.array(),E=v.array(),j=[0,0,0],P=0;P<6;P++)(S=this.lineVertices).push.apply(S,h(w)),(S=this.lineTangentsIn).push.apply(S,h(E)),(S=this.lineTangentsOut).push.apply(S,j),(S=this.lineVertexColors).push.apply(S,h(x));return this.lineSides.push(-1,2,-2,1,2,-1),this}},{key:"_addJoin",value:function(y,v,x,S){for(var w,E=y.array(),j=v.array(),P=x.array(),M=0;M<12;M++)(w=this.lineVertices).push.apply(w,h(E)),(w=this.lineTangentsIn).push.apply(w,h(j)),(w=this.lineTangentsOut).push.apply(w,h(P)),(w=this.lineVertexColors).push.apply(w,h(S));return this.lineSides.push(-1,-3,-2,-1,0,-3),this.lineSides.push(3,1,2,3,0,1),this}},{key:"normalize",value:function(){if(0<this.vertices.length){for(var y=this.vertices[0].copy(),v=this.vertices[0].copy(),x=0;x<this.vertices.length;x++)y.x=Math.max(y.x,this.vertices[x].x),v.x=Math.min(v.x,this.vertices[x].x),y.y=Math.max(y.y,this.vertices[x].y),v.y=Math.min(v.y,this.vertices[x].y),y.z=Math.max(y.z,this.vertices[x].z),v.z=Math.min(v.z,this.vertices[x].z);for(var S=c.default.Vector.lerp(y,v,.5),w=c.default.Vector.sub(y,v),E=200/Math.max(Math.max(w.x,w.y),w.z),j=0;j<this.vertices.length;j++)this.vertices[j].sub(S),this.vertices[j].mult(E)}return this}}])&&d(g.prototype,b),m}();var p=c.default.Geometry;i.default=p},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.flat":159,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.unscopables.flat":172,"core-js/modules/es.map":174,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],333:[function(f,s,i){f("core-js/modules/es.array.iterator"),f("core-js/modules/es.object.to-string"),f("core-js/modules/es.typed-array.float32-array"),f("core-js/modules/es.typed-array.copy-within"),f("core-js/modules/es.typed-array.every"),f("core-js/modules/es.typed-array.fill"),f("core-js/modules/es.typed-array.filter"),f("core-js/modules/es.typed-array.find"),f("core-js/modules/es.typed-array.find-index"),f("core-js/modules/es.typed-array.for-each"),f("core-js/modules/es.typed-array.includes"),f("core-js/modules/es.typed-array.index-of"),f("core-js/modules/es.typed-array.iterator"),f("core-js/modules/es.typed-array.join"),f("core-js/modules/es.typed-array.last-index-of"),f("core-js/modules/es.typed-array.map"),f("core-js/modules/es.typed-array.reduce"),f("core-js/modules/es.typed-array.reduce-right"),f("core-js/modules/es.typed-array.reverse"),f("core-js/modules/es.typed-array.set"),f("core-js/modules/es.typed-array.slice"),f("core-js/modules/es.typed-array.some"),f("core-js/modules/es.typed-array.sort"),f("core-js/modules/es.typed-array.subarray"),f("core-js/modules/es.typed-array.to-locale-string"),f("core-js/modules/es.typed-array.to-string"),f("core-js/modules/es.array.iterator"),f("core-js/modules/es.object.to-string"),f("core-js/modules/es.typed-array.float32-array"),f("core-js/modules/es.typed-array.copy-within"),f("core-js/modules/es.typed-array.every"),f("core-js/modules/es.typed-array.fill"),f("core-js/modules/es.typed-array.filter"),f("core-js/modules/es.typed-array.find"),f("core-js/modules/es.typed-array.find-index"),f("core-js/modules/es.typed-array.for-each"),f("core-js/modules/es.typed-array.includes"),f("core-js/modules/es.typed-array.index-of"),f("core-js/modules/es.typed-array.iterator"),f("core-js/modules/es.typed-array.join"),f("core-js/modules/es.typed-array.last-index-of"),f("core-js/modules/es.typed-array.map"),f("core-js/modules/es.typed-array.reduce"),f("core-js/modules/es.typed-array.reduce-right"),f("core-js/modules/es.typed-array.reverse"),f("core-js/modules/es.typed-array.set"),f("core-js/modules/es.typed-array.slice"),f("core-js/modules/es.typed-array.some"),f("core-js/modules/es.typed-array.sort"),f("core-js/modules/es.typed-array.subarray"),f("core-js/modules/es.typed-array.to-locale-string"),f("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(f=f("../core/main"))&&f.__esModule?f:{default:f};function l(h,d){for(var p=0;p<d.length;p++){var m=d[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(h,m.key,m)}}var c=Array,u=function(h){return Array.isArray(h)},f=(typeof Float32Array<"u"&&(c=Float32Array,u=function(h){return Array.isArray(h)||h instanceof Float32Array}),a.default.Matrix=function(){function h(){var g=this,b=h;if(g instanceof b)return arguments.length&&((g=arguments.length-1)<0||arguments.length<=g?void 0:arguments[g])instanceof a.default&&(this.p5=(b=arguments.length-1)<0||arguments.length<=b?void 0:arguments[b]),(arguments.length<=0?void 0:arguments[0])==="mat3"?this.mat3=Array.isArray(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:new c([1,0,0,0,1,0,0,0,1]):this.mat4=Array.isArray(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:new c([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this;throw new TypeError("Cannot call a class as a function")}var d,p,m;return d=h,m=[{key:"identity",value:function(g){return new a.default.Matrix(g)}}],(p=[{key:"set",value:function(g){var b=arguments;if(g instanceof a.default.Matrix?b=g.mat4:u(g)&&(b=g),b.length!==16)a.default._friendlyError("Expected 16 values but received ".concat(b.length,"."),"p5.Matrix.set");else for(var y=0;y<16;y++)this.mat4[y]=b[y];return this}},{key:"get",value:function(){return new a.default.Matrix(this.mat4,this.p5)}},{key:"copy",value:function(){var g;return this.mat3!==void 0?((g=new a.default.Matrix("mat3",this.p5)).mat3[0]=this.mat3[0],g.mat3[1]=this.mat3[1],g.mat3[2]=this.mat3[2],g.mat3[3]=this.mat3[3],g.mat3[4]=this.mat3[4],g.mat3[5]=this.mat3[5],g.mat3[6]=this.mat3[6],g.mat3[7]=this.mat3[7],g.mat3[8]=this.mat3[8]):((g=new a.default.Matrix(this.p5)).mat4[0]=this.mat4[0],g.mat4[1]=this.mat4[1],g.mat4[2]=this.mat4[2],g.mat4[3]=this.mat4[3],g.mat4[4]=this.mat4[4],g.mat4[5]=this.mat4[5],g.mat4[6]=this.mat4[6],g.mat4[7]=this.mat4[7],g.mat4[8]=this.mat4[8],g.mat4[9]=this.mat4[9],g.mat4[10]=this.mat4[10],g.mat4[11]=this.mat4[11],g.mat4[12]=this.mat4[12],g.mat4[13]=this.mat4[13],g.mat4[14]=this.mat4[14],g.mat4[15]=this.mat4[15]),g}},{key:"transpose",value:function(g){var b,y,v,x,S,w;return g instanceof a.default.Matrix?(b=g.mat4[1],y=g.mat4[2],v=g.mat4[3],x=g.mat4[6],S=g.mat4[7],w=g.mat4[11],this.mat4[0]=g.mat4[0],this.mat4[1]=g.mat4[4],this.mat4[2]=g.mat4[8],this.mat4[3]=g.mat4[12],this.mat4[4]=b,this.mat4[5]=g.mat4[5],this.mat4[6]=g.mat4[9],this.mat4[7]=g.mat4[13],this.mat4[8]=y,this.mat4[9]=x,this.mat4[10]=g.mat4[10],this.mat4[11]=g.mat4[14],this.mat4[12]=v,this.mat4[13]=S,this.mat4[14]=w,this.mat4[15]=g.mat4[15]):u(g)&&(b=g[1],y=g[2],v=g[3],x=g[6],S=g[7],w=g[11],this.mat4[0]=g[0],this.mat4[1]=g[4],this.mat4[2]=g[8],this.mat4[3]=g[12],this.mat4[4]=b,this.mat4[5]=g[5],this.mat4[6]=g[9],this.mat4[7]=g[13],this.mat4[8]=y,this.mat4[9]=x,this.mat4[10]=g[10],this.mat4[11]=g[14],this.mat4[12]=v,this.mat4[13]=S,this.mat4[14]=w,this.mat4[15]=g[15]),this}},{key:"invert",value:function(G){G instanceof a.default.Matrix?(b=G.mat4[0],y=G.mat4[1],v=G.mat4[2],x=G.mat4[3],S=G.mat4[4],w=G.mat4[5],E=G.mat4[6],j=G.mat4[7],P=G.mat4[8],M=G.mat4[9],O=G.mat4[10],k=G.mat4[11],F=G.mat4[12],A=G.mat4[13],N=G.mat4[14],$=G.mat4[15]):u(G)&&(b=G[0],y=G[1],v=G[2],x=G[3],S=G[4],w=G[5],E=G[6],j=G[7],P=G[8],M=G[9],O=G[10],k=G[11],F=G[12],A=G[13],N=G[14],$=G[15]);var b,y,v,x,S,w,E,j,P,M,O,k,F,A,N,$,G=b*w-y*S,X=b*E-v*S,W=b*j-x*S,V=y*E-v*w,q=y*j-x*w,J=v*j-x*E,ae=P*A-M*F,I=P*N-O*F,U=P*$-k*F,z=M*N-O*A,K=M*$-k*A,te=O*$-k*N,ne=G*te-X*K+W*z+V*U-q*I+J*ae;return ne?(this.mat4[0]=(w*te-E*K+j*z)*(ne=1/ne),this.mat4[1]=(v*K-y*te-x*z)*ne,this.mat4[2]=(A*J-N*q+$*V)*ne,this.mat4[3]=(O*q-M*J-k*V)*ne,this.mat4[4]=(E*U-S*te-j*I)*ne,this.mat4[5]=(b*te-v*U+x*I)*ne,this.mat4[6]=(N*W-F*J-$*X)*ne,this.mat4[7]=(P*J-O*W+k*X)*ne,this.mat4[8]=(S*K-w*U+j*ae)*ne,this.mat4[9]=(y*U-b*K-x*ae)*ne,this.mat4[10]=(F*q-A*W+$*G)*ne,this.mat4[11]=(M*W-P*q-k*G)*ne,this.mat4[12]=(w*I-S*z-E*ae)*ne,this.mat4[13]=(b*z-y*I+v*ae)*ne,this.mat4[14]=(A*X-F*V-N*G)*ne,this.mat4[15]=(P*V-M*X+O*G)*ne,this):null}},{key:"invert3x3",value:function(){var g=this.mat3[0],b=this.mat3[1],y=this.mat3[2],v=this.mat3[3],x=this.mat3[4],S=this.mat3[5],w=this.mat3[6],E=this.mat3[7],j=this.mat3[8],P=j*x-S*E,M=-j*v+S*w,O=E*v-x*w,k=g*P+b*M+y*O;return k?(this.mat3[0]=P*(k=1/k),this.mat3[1]=(-j*b+y*E)*k,this.mat3[2]=(S*b-y*x)*k,this.mat3[3]=M*k,this.mat3[4]=(j*g-y*w)*k,this.mat3[5]=(-S*g+y*v)*k,this.mat3[6]=O*k,this.mat3[7]=(-E*g+b*w)*k,this.mat3[8]=(x*g-b*v)*k,this):null}},{key:"transpose3x3",value:function(g){var b=(g=g===void 0?this.mat3:g)[1],y=g[2],v=g[5];return this.mat3[0]=g[0],this.mat3[1]=g[3],this.mat3[2]=g[6],this.mat3[3]=b,this.mat3[4]=g[4],this.mat3[5]=g[7],this.mat3[6]=y,this.mat3[7]=v,this.mat3[8]=g[8],this}},{key:"inverseTranspose",value:function(g){if(g=g.mat4,this.mat3===void 0?a.default._friendlyError("sorry, this function only works with mat3"):(this.mat3[0]=g[0],this.mat3[1]=g[1],this.mat3[2]=g[2],this.mat3[3]=g[4],this.mat3[4]=g[5],this.mat3[5]=g[6],this.mat3[6]=g[8],this.mat3[7]=g[9],this.mat3[8]=g[10]),g=this.invert3x3(),g)g.transpose3x3(this.mat3);else for(var b=0;b<9;b++)this.mat3[b]=0;return this}},{key:"determinant",value:function(){var g=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],b=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],y=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],v=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],x=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],S=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],w=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],E=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],j=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],P=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],M=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return g*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-b*M+y*P+v*j-x*E+S*w}},{key:"mult",value:function(y){var b;if(y===this||y===this.mat4)b=this.copy().mat4;else if(y instanceof a.default.Matrix)b=y.mat4;else if(u(y))b=y;else{if(arguments.length!==16)return;b=arguments}var y=this.mat4[0],v=this.mat4[1],x=this.mat4[2],S=this.mat4[3];return this.mat4[0]=y*b[0]+v*b[4]+x*b[8]+S*b[12],this.mat4[1]=y*b[1]+v*b[5]+x*b[9]+S*b[13],this.mat4[2]=y*b[2]+v*b[6]+x*b[10]+S*b[14],this.mat4[3]=y*b[3]+v*b[7]+x*b[11]+S*b[15],y=this.mat4[4],v=this.mat4[5],x=this.mat4[6],S=this.mat4[7],this.mat4[4]=y*b[0]+v*b[4]+x*b[8]+S*b[12],this.mat4[5]=y*b[1]+v*b[5]+x*b[9]+S*b[13],this.mat4[6]=y*b[2]+v*b[6]+x*b[10]+S*b[14],this.mat4[7]=y*b[3]+v*b[7]+x*b[11]+S*b[15],y=this.mat4[8],v=this.mat4[9],x=this.mat4[10],S=this.mat4[11],this.mat4[8]=y*b[0]+v*b[4]+x*b[8]+S*b[12],this.mat4[9]=y*b[1]+v*b[5]+x*b[9]+S*b[13],this.mat4[10]=y*b[2]+v*b[6]+x*b[10]+S*b[14],this.mat4[11]=y*b[3]+v*b[7]+x*b[11]+S*b[15],y=this.mat4[12],v=this.mat4[13],x=this.mat4[14],S=this.mat4[15],this.mat4[12]=y*b[0]+v*b[4]+x*b[8]+S*b[12],this.mat4[13]=y*b[1]+v*b[5]+x*b[9]+S*b[13],this.mat4[14]=y*b[2]+v*b[6]+x*b[10]+S*b[14],this.mat4[15]=y*b[3]+v*b[7]+x*b[11]+S*b[15],this}},{key:"apply",value:function(y){var b;if(y===this||y===this.mat4)b=this.copy().mat4;else if(y instanceof a.default.Matrix)b=y.mat4;else if(u(y))b=y;else{if(arguments.length!==16)return;b=arguments}var y=this.mat4,v=y[0],x=y[4],S=y[8],w=y[12],v=(y[0]=b[0]*v+b[1]*x+b[2]*S+b[3]*w,y[4]=b[4]*v+b[5]*x+b[6]*S+b[7]*w,y[8]=b[8]*v+b[9]*x+b[10]*S+b[11]*w,y[12]=b[12]*v+b[13]*x+b[14]*S+b[15]*w,y[1]),x=y[5],S=y[9],w=y[13],v=(y[1]=b[0]*v+b[1]*x+b[2]*S+b[3]*w,y[5]=b[4]*v+b[5]*x+b[6]*S+b[7]*w,y[9]=b[8]*v+b[9]*x+b[10]*S+b[11]*w,y[13]=b[12]*v+b[13]*x+b[14]*S+b[15]*w,y[2]),x=y[6],S=y[10],w=y[14],v=(y[2]=b[0]*v+b[1]*x+b[2]*S+b[3]*w,y[6]=b[4]*v+b[5]*x+b[6]*S+b[7]*w,y[10]=b[8]*v+b[9]*x+b[10]*S+b[11]*w,y[14]=b[12]*v+b[13]*x+b[14]*S+b[15]*w,y[3]),x=y[7],S=y[11],w=y[15];return y[3]=b[0]*v+b[1]*x+b[2]*S+b[3]*w,y[7]=b[4]*v+b[5]*x+b[6]*S+b[7]*w,y[11]=b[8]*v+b[9]*x+b[10]*S+b[11]*w,y[15]=b[12]*v+b[13]*x+b[14]*S+b[15]*w,this}},{key:"scale",value:function(g,b,y){return g instanceof a.default.Vector?(b=g.y,y=g.z,g=g.x):g instanceof Array&&(b=g[1],y=g[2],g=g[0]),this.mat4[0]*=g,this.mat4[1]*=g,this.mat4[2]*=g,this.mat4[3]*=g,this.mat4[4]*=b,this.mat4[5]*=b,this.mat4[6]*=b,this.mat4[7]*=b,this.mat4[8]*=y,this.mat4[9]*=y,this.mat4[10]*=y,this.mat4[11]*=y,this}},{key:"rotate",value:function(G,K,z,v){K instanceof a.default.Vector?(z=K.y,v=K.z,K=K.x):K instanceof Array&&(z=K[1],v=K[2],K=K[0]);var x=Math.sqrt(K*K+z*z+v*v),x=(K*=1/x,z*=1/x,v*=1/x,this.mat4[0]),S=this.mat4[1],w=this.mat4[2],E=this.mat4[3],j=this.mat4[4],P=this.mat4[5],M=this.mat4[6],O=this.mat4[7],k=this.mat4[8],F=this.mat4[9],A=this.mat4[10],N=this.mat4[11],$=Math.sin(G),G=Math.cos(G),X=1-G,W=K*K*X+G,V=z*K*X+v*$,q=v*K*X-z*$,J=K*z*X-v*$,ae=z*z*X+G,I=v*z*X+K*$,U=K*v*X+z*$,z=z*v*X-K*$,K=v*v*X+G;return this.mat4[0]=x*W+j*V+k*q,this.mat4[1]=S*W+P*V+F*q,this.mat4[2]=w*W+M*V+A*q,this.mat4[3]=E*W+O*V+N*q,this.mat4[4]=x*J+j*ae+k*I,this.mat4[5]=S*J+P*ae+F*I,this.mat4[6]=w*J+M*ae+A*I,this.mat4[7]=E*J+O*ae+N*I,this.mat4[8]=x*U+j*z+k*K,this.mat4[9]=S*U+P*z+F*K,this.mat4[10]=w*U+M*z+A*K,this.mat4[11]=E*U+O*z+N*K,this}},{key:"translate",value:function(v){var b=v[0],y=v[1],v=v[2]||0;this.mat4[12]+=this.mat4[0]*b+this.mat4[4]*y+this.mat4[8]*v,this.mat4[13]+=this.mat4[1]*b+this.mat4[5]*y+this.mat4[9]*v,this.mat4[14]+=this.mat4[2]*b+this.mat4[6]*y+this.mat4[10]*v,this.mat4[15]+=this.mat4[3]*b+this.mat4[7]*y+this.mat4[11]*v}},{key:"rotateX",value:function(g){this.rotate(g,1,0,0)}},{key:"rotateY",value:function(g){this.rotate(g,0,1,0)}},{key:"rotateZ",value:function(g){this.rotate(g,0,0,1)}},{key:"perspective",value:function(x,b,y,v){var x=1/Math.tan(x/2),S=1/(y-v);return this.mat4[0]=x/b,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=x,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(v+y)*S,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*v*y*S,this.mat4[15]=0,this}},{key:"ortho",value:function(g,b,y,v,x,S){var w=1/(g-b),E=1/(y-v),j=1/(x-S);return this.mat4[0]=-2*w,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*E,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*j,this.mat4[11]=0,this.mat4[12]=(g+b)*w,this.mat4[13]=(v+y)*E,this.mat4[14]=(S+x)*j,this.mat4[15]=1,this}},{key:"multiplyVec4",value:function(g,b,y,v){var x=new Array(4),S=this.mat4;return x[0]=S[0]*g+S[4]*b+S[8]*y+S[12]*v,x[1]=S[1]*g+S[5]*b+S[9]*y+S[13]*v,x[2]=S[2]*g+S[6]*b+S[10]*y+S[14]*v,x[3]=S[3]*g+S[7]*b+S[11]*y+S[15]*v,x}},{key:"multiplyPoint",value:function(y){var v=y.x,b=y.y,y=y.z,v=this.multiplyVec4(v,b,y,1);return new a.default.Vector(v[0],v[1],v[2])}},{key:"multiplyAndNormalizePoint",value:function(y){var v=y.x,b=y.y,y=y.z,v=this.multiplyVec4(v,b,y,1);return v[0]/=v[3],v[1]/=v[3],v[2]/=v[3],new a.default.Vector(v[0],v[1],v[2])}},{key:"multiplyDirection",value:function(y){var v=y.x,b=y.y,y=y.z,v=this.multiplyVec4(v,b,y,0);return new a.default.Vector(v[0],v[1],v[2])}},{key:"mult3x3",value:function(y){var b;if(y===this||y===this.mat3)b=this.copy().mat3;else if(y instanceof a.default.Matrix)b=y.mat3;else if(u(y))b=y;else{if(arguments.length!==9)return;b=arguments}var y=this.mat3[0],v=this.mat3[1],x=this.mat3[2];return this.mat3[0]=y*b[0]+v*b[3]+x*b[6],this.mat3[1]=y*b[1]+v*b[4]+x*b[7],this.mat3[2]=y*b[2]+v*b[5]+x*b[8],y=this.mat3[3],v=this.mat3[4],x=this.mat3[5],this.mat3[3]=y*b[0]+v*b[3]+x*b[6],this.mat3[4]=y*b[1]+v*b[4]+x*b[7],this.mat3[5]=y*b[2]+v*b[5]+x*b[8],y=this.mat3[6],v=this.mat3[7],x=this.mat3[8],this.mat3[6]=y*b[0]+v*b[3]+x*b[6],this.mat3[7]=y*b[1]+v*b[4]+x*b[7],this.mat3[8]=y*b[2]+v*b[5]+x*b[8],this}},{key:"column",value:function(g){return new a.default.Vector(this.mat3[3*g],this.mat3[3*g+1],this.mat3[3*g+2])}},{key:"row",value:function(g){return new a.default.Vector(this.mat3[g],this.mat3[g+3],this.mat3[g+6])}},{key:"diagonal",value:function(){return this.mat3!==void 0?[this.mat3[0],this.mat3[4],this.mat3[8]]:[this.mat4[0],this.mat4[5],this.mat4[10],this.mat4[15]]}},{key:"multiplyVec3",value:function(g,b){return(b=b===void 0?g.copy():b).x=this.row(0).dot(g),b.y=this.row(1).dot(g),b.z=this.row(2).dot(g),b}},{key:"createSubMatrix3x3",value:function(){var g=new a.default.Matrix("mat3");return g.mat3[0]=this.mat4[0],g.mat3[1]=this.mat4[1],g.mat3[2]=this.mat4[2],g.mat3[3]=this.mat4[4],g.mat3[4]=this.mat4[5],g.mat3[5]=this.mat4[6],g.mat3[6]=this.mat4[8],g.mat3[7]=this.mat4[9],g.mat3[8]=this.mat4[10],g}}])&&l(d.prototype,p),m&&l(d,m),h}(),a.default.Matrix);i.default=f},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236}],334:[function(r,s,i){r("core-js/modules/es.array.map"),r("core-js/modules/es.array.map"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function a(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.RenderBuffer=function(){function l(f,h,d,p,m,g){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");this.size=f,this.src=h,this.dst=d,this.attr=p,this._renderer=m,this.map=g}var c,u;return c=l,(u=[{key:"_prepareBuffer",value:function(f,h){var d,p,m,y=h.attributes,g=this._renderer.GL,b=f.model||f,y=y[this.attr];y&&(d=f[this.dst],0<(p=b[this.src]).length?((m=!d)&&(f[this.dst]=d=g.createBuffer()),g.bindBuffer(g.ARRAY_BUFFER,d),!m&&b.dirtyFlags[this.src]===!1||(m=(f=this.map)?f(p):p,this._renderer._bindBuffer(d,g.ARRAY_BUFFER,m),b.dirtyFlags[this.src]=!1),h.enableAttrib(y,this.size)):(f=y.location)!==-1&&this._renderer.registerEnabled.has(f)&&(g.disableVertexAttribArray(f),this._renderer.registerEnabled.delete(f)))}}])&&a(c.prototype,u),l}(),r=r.default.RenderBuffer,i.default=r},{"../core/main":280,"core-js/modules/es.array.map":167}],335:[function(r,s,i){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}function l(m){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(g){return a(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":a(g)})(m)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.map"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.map"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(m){if(m&&m.__esModule)return m;if(m===null||l(m)!=="object"&&typeof m!="function")return{default:m};var g=f();if(g&&g.has(m))return g.get(m);var b,y={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in m){var x;Object.prototype.hasOwnProperty.call(m,b)&&((x=v?Object.getOwnPropertyDescriptor(m,b):null)&&(x.get||x.set)?Object.defineProperty(y,b,x):y[b]=m[b])}return y.default=m,g&&g.set(m,y),y}(r("../core/constants"));function f(){var m;return typeof WeakMap!="function"?null:(m=new WeakMap,f=function(){return m},m)}function h(m){return function(g){if(Array.isArray(g)){for(var b=0,y=new Array(g.length);b<g.length;b++)y[b]=g[b];return y}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r("./p5.RenderBuffer"),c.default.RendererGL.prototype.beginShape=function(m){return this.immediateMode.shapeMode=m!==void 0?m:u.TESS,this.immediateMode.geometry.reset(),this.immediateMode.contourIndices=[],this};var d={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},p=(c.default.RendererGL.prototype.beginContour=function(){if(this.immediateMode.shapeMode!==u.TESS)throw new Error("WebGL mode can only use contours with beginShape(TESS).");this.immediateMode.contourIndices.push(this.immediateMode.geometry.vertices.length)},c.default.RendererGL.prototype.vertex=function(m,g){if(this.immediateMode.shapeMode===u.QUADS&&this.immediateMode.geometry.vertices.length%6==3)for(var b in d){var y=d[b],b=this.immediateMode.geometry[b];b.push.apply(b,h(b.slice(b.length-3*y,b.length-2*y)).concat(h(b.slice(b.length-y,b.length))))}var v,x,S=v=x=0,w=(arguments.length===3?S=arguments[2]:arguments.length===4?(v=arguments[2],x=arguments[3]):arguments.length===5&&(S=arguments[2],v=arguments[3],x=arguments[4]),new c.default.Vector(m,g,S)),w=(this.immediateMode.geometry.vertices.push(w),this.immediateMode.geometry.vertexNormals.push(this._currentNormal),this.curFillColor||[.5,.5,.5,1]),w=(this.immediateMode.geometry.vertexColors.push(w[0],w[1],w[2],w[3]),this.curStrokeColor||[.5,.5,.5,1]);return this.immediateMode.geometry.vertexStrokeColors.push(w[0],w[1],w[2],w[3]),this.textureMode!==u.IMAGE||this.isProcessingVertices||(this._tex!==null?0<this._tex.width&&0<this._tex.height&&(v/=this._tex.width,x/=this._tex.height):this.userFillShader===void 0&&this.userStrokeShader===void 0&&this.userPointShader===void 0&&this._tex===null&&4<=arguments.length&&console.warn("You must first call texture() before using vertex() with image based u and v coordinates")),this.immediateMode.geometry.uvs.push(v,x),this.immediateMode._bezierVertex[0]=m,this.immediateMode._bezierVertex[1]=g,this.immediateMode._bezierVertex[2]=S,this.immediateMode._quadraticVertex[0]=m,this.immediateMode._quadraticVertex[1]=g,this.immediateMode._quadraticVertex[2]=S,this},c.default.RendererGL.prototype.normal=function(m,g,b){return m instanceof c.default.Vector?this._currentNormal=m:this._currentNormal=new c.default.Vector(m,g,b),this},c.default.RendererGL.prototype.endShape=function(m,g,b,y,v,x){var S,w=6<arguments.length&&arguments[6]!==void 0?arguments[6]:1;return this.immediateMode.shapeMode===u.POINTS?this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point):(this.immediateMode.geometry.vertices.length===3&&this.immediateMode.shapeMode===u.TESS&&(this.immediateMode.shapeMode,u.TRIANGLES),this.isProcessingVertices=!0,this._processVertices.apply(this,arguments),S=this.isProcessingVertices=!1,this.immediateMode.shapeMode!==u.LINE_STRIP&&this.immediateMode.shapeMode!==u.LINES||(this.immediateMode.shapeMode=u.TRIANGLE_FAN,S=!0),this.immediateMode.shapeMode===u.QUADS?this.immediateMode.shapeMode=u.TRIANGLES:this.immediateMode.shapeMode===u.QUAD_STRIP&&(this.immediateMode.shapeMode=u.TRIANGLE_STRIP),this._doFill&&!S&&!this.geometryBuilder&&3<=this.immediateMode.geometry.vertices.length&&this._drawImmediateFill(w),this._doStroke&&!this.geometryBuilder&&1<=this.immediateMode.geometry.lineVertices.length&&this._drawImmediateStroke(),this.geometryBuilder&&this.geometryBuilder.addImmediate(),this.isBezier=!1,this.isQuadratic=!1,this.isCurve=!1,this.immediateMode._bezierVertex.length=0,this.immediateMode._quadraticVertex.length=0,this.immediateMode._curveVertex.length=0),this},c.default.RendererGL.prototype._processVertices=function(m){var g;this.immediateMode.geometry.vertices.length!==0&&(g=this._doStroke,m=m===u.CLOSE,g&&(this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,m),this.geometryBuilder||this.immediateMode.geometry._edgesToVertices()),g=this.immediateMode.shapeMode===u.TESS,m=0<this.immediateMode.contourIndices.length,this._doFill&&(this.isBezier||this.isQuadratic||this.isCurve||g||m)&&this.immediateMode.shapeMode!==u.LINES&&this._tesselateShape())},c.default.RendererGL.prototype._calculateEdges=function(m,g,b){var y=[],v=0,x=this.immediateMode.contourIndices.slice(),S=0;switch(m){case u.TRIANGLE_STRIP:for(v=0;v<g.length-2;v++)y.push([v,v+1]),y.push([v,v+2]);y.push([v,v+1]);break;case u.TRIANGLE_FAN:for(v=1;v<g.length-1;v++)y.push([0,v]),y.push([v,v+1]);y.push([0,g.length-1]);break;case u.TRIANGLES:for(v=0;v<g.length-2;v+=3)y.push([v,v+1]),y.push([v+1,v+2]),y.push([v+2,v]);break;case u.LINES:for(v=0;v<g.length-1;v+=2)y.push([v,v+1]);break;case u.QUADS:for(v=0;v<g.length-5;v+=6)y.push([v,v+1]),y.push([v+1,v+2]),y.push([v+3,v+5]),y.push([v+4,v+5]);break;case u.QUAD_STRIP:for(v=0;v<g.length-2;v+=2)y.push([v,v+1]),y.push([v,v+2]),y.push([v+1,v+3]);y.push([v,v+1]);break;default:for(v=0;v<g.length;v++)v+1<g.length&&v+1!==x[0]?y.push([v,v+1]):((b||S)&&y.push([v,S]),0<x.length&&(S=x.shift()))}return m!==u.TESS&&b&&y.push([g.length-1,0]),y},c.default.RendererGL.prototype._tesselateShape=function(){for(var m=this,g=(this.immediateMode.shapeMode=u.TRIANGLES,[[]]),b=0;b<this.immediateMode.geometry.vertices.length;b++)0<this.immediateMode.contourIndices.length&&this.immediateMode.contourIndices[0]===b&&(this.immediateMode.contourIndices.shift(),g.push([])),g[g.length-1].push(this.immediateMode.geometry.vertices[b].x,this.immediateMode.geometry.vertices[b].y,this.immediateMode.geometry.vertices[b].z,this.immediateMode.geometry.uvs[2*b],this.immediateMode.geometry.uvs[2*b+1],this.immediateMode.geometry.vertexColors[4*b],this.immediateMode.geometry.vertexColors[4*b+1],this.immediateMode.geometry.vertexColors[4*b+2],this.immediateMode.geometry.vertexColors[4*b+3],this.immediateMode.geometry.vertexNormals[b].x,this.immediateMode.geometry.vertexNormals[b].y,this.immediateMode.geometry.vertexNormals[b].z);for(var y,v=this._triangulate(g),x=this.immediateMode.geometry.vertices,S=(this.immediateMode.geometry.vertices=[],this.immediateMode.geometry.vertexNormals=[],this.immediateMode.geometry.uvs=[],[]),w=0,E=v.length;w<E;w+=c.default.RendererGL.prototype.tessyVertexSize)S.push.apply(S,h(v.slice(w+5,w+9))),this.normal.apply(this,h(v.slice(w+9,w+12))),this.vertex.apply(this,h(v.slice(w,w+5)));this.geometryBuilder&&(y=new Map,this.immediateMode.geometry.edges=this.immediateMode.geometry.edges.map(function(j){return j.map(function(P){if(!y.has(P)){var M=x[P],O=m.immediateMode.geometry.vertices.findIndex(function(X){return M.x===X.x&&M.y===X.y&&M.z===X.z});if(O===-1){for(var k=1/0,F=0,A=0;A<m.immediateMode.geometry.vertices.length;A++){var $=m.immediateMode.geometry.vertices[A],G=M.x-$.x,N=M.y-$.y,$=M.z-$.z,G=G*G+N*N+$*$;G<k&&(k=G,F=A)}O=F}y.set(P,O)}return y.get(P)})})),this.immediateMode.geometry.vertexColors=S},c.default.RendererGL.prototype._drawImmediateFill=function(){var m,g=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1,b=this.GL,y=(this._useVertexColor=0<this.immediateMode.geometry.vertexColors.length,m=this._getImmediateFillShader(),this._setFillUniforms(m),!0),v=!1,x=void 0;try{for(var S,w=this.immediateMode.buffers.fill[Symbol.iterator]();!(y=(S=w.next()).done);y=!0)S.value._prepareBuffer(this.immediateMode.geometry,m)}catch(E){v=!0,x=E}finally{try{y||w.return==null||w.return()}finally{if(v)throw x}}if(m.disableRemainingAttributes(),this._applyColorBlend(this.curFillColor,this.immediateMode.geometry.hasFillTransparency()),g===1)b.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length);else try{b.drawArraysInstanced(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length,g)}catch{console.log("🌸 p5.js says: Instancing is only supported in WebGL2 mode")}m.unbindShader()},c.default.RendererGL.prototype._drawImmediateStroke=function(){var m=this.GL,g=(this._useLineColor=0<this.immediateMode.geometry.vertexStrokeColors.length,this._getImmediateStrokeShader()),b=(this._setStrokeUniforms(g),!0),y=!1,v=void 0;try{for(var x,S=this.immediateMode.buffers.stroke[Symbol.iterator]();!(b=(x=S.next()).done);b=!0)x.value._prepareBuffer(this.immediateMode.geometry,g)}catch(w){y=!0,v=w}finally{try{b||S.return==null||S.return()}finally{if(y)throw v}}g.disableRemainingAttributes(),this._applyColorBlend(this.curStrokeColor,this.immediateMode.geometry.hasFillTransparency()),m.drawArrays(m.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length/3),g.unbindShader()},c.default.RendererGL);i.default=p},{"../core/constants":269,"../core/main":280,"./p5.RenderBuffer":334,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.find-index":157,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.map":174,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],336:[function(r,s,i){function a(d){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(p){return a(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":a(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.some"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.uint16-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.some"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.uint16-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=(r("./p5.RendererGL"),r("./p5.RenderBuffer"),function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var m,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(m in d){var y;Object.prototype.hasOwnProperty.call(d,m)&&((y=b?Object.getOwnPropertyDescriptor(d,m):null)&&(y.get||y.set)?Object.defineProperty(g,m,y):g[m]=d[m])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants")));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.RendererGL.prototype.freeGeometry=function(d){d.gid?this._freeBuffers(d.gid):console.warn("The model you passed to freeGeometry does not have an id!")},c.default.RendererGL.prototype._initBufferDefaults=function(d){var p;return this._freeBuffers(d),1e3<Object.keys(this.retainedMode.geometry).length&&(p=Object.keys(this.retainedMode.geometry)[0],this._freeBuffers(p)),this.retainedMode.geometry[d]={}},c.default.RendererGL.prototype._freeBuffers=function(d){var p,m=this.retainedMode.geometry[d];function g(b){var y=!0,v=!1,x=void 0;try{for(var S,w=b[Symbol.iterator]();!(y=(S=w.next()).done);y=!0){var E=S.value;m[E.dst]&&(p.deleteBuffer(m[E.dst]),m[E.dst]=null)}}catch(j){v=!0,x=j}finally{try{y||w.return==null||w.return()}finally{if(v)throw x}}}m&&(delete this.retainedMode.geometry[d],p=this.GL,m.indexBuffer&&p.deleteBuffer(m.indexBuffer),g(this.retainedMode.buffers.stroke),g(this.retainedMode.buffers.fill))},c.default.RendererGL.prototype.createBuffers=function(v,p){var m,g,b,y=this.GL,v=this._initBufferDefaults(v),x=(v.model=p,v.indexBuffer);return p.faces.length?(x=x||(v.indexBuffer=y.createBuffer()),b=(g=(m=c.default.RendererGL.prototype._flatten(p.faces)).some(function(S){return 65535<S}))?Uint32Array:Uint16Array,this._bindBuffer(x,y.ELEMENT_ARRAY_BUFFER,m,b),v.indexBufferType=g?y.UNSIGNED_INT:y.UNSIGNED_SHORT,v.vertexCount=3*p.faces.length):(x&&(y.deleteBuffer(x),v.indexBuffer=null),v.vertexCount=p.vertices?p.vertices.length:0),v.lineVertexCount=p.lineVertices?p.lineVertices.length/3:0,v},c.default.RendererGL.prototype.drawBuffers=function(d){var p=this.GL,m=this.retainedMode.geometry[d];if(!this.geometryBuilder&&this._doFill&&0<this.retainedMode.geometry[d].vertexCount){this._useVertexColor=0<m.model.vertexColors.length;var g=this._getRetainedFillShader(),b=(this._setFillUniforms(g),!0),y=!1,v=void 0;try{for(var x,S=this.retainedMode.buffers.fill[Symbol.iterator]();!(b=(x=S.next()).done);b=!0)x.value._prepareBuffer(m,g)}catch(M){y=!0,v=M}finally{try{b||S.return==null||S.return()}finally{if(y)throw v}}g.disableRemainingAttributes(),m.indexBuffer&&this._bindBuffer(m.indexBuffer,p.ELEMENT_ARRAY_BUFFER),this._applyColorBlend(this.curFillColor,m.model.hasFillTransparency()),this._drawElements(p.TRIANGLES,d),g.unbindShader()}if(!this.geometryBuilder&&this._doStroke&&0<m.lineVertexCount){this._useLineColor=0<m.model.vertexStrokeColors.length;var w=this._getRetainedStrokeShader(),E=(this._setStrokeUniforms(w),!0),y=!1,v=void 0;try{for(var j,P=this.retainedMode.buffers.stroke[Symbol.iterator]();!(E=(j=P.next()).done);E=!0)j.value._prepareBuffer(m,w)}catch(k){y=!0,v=k}finally{try{E||P.return==null||P.return()}finally{if(y)throw v}}w.disableRemainingAttributes(),this._applyColorBlend(this.curStrokeColor,m.model.hasStrokeTransparency()),this._drawArrays(p.TRIANGLES,d),w.unbindShader()}return this.geometryBuilder&&this.geometryBuilder.addRetained(m),this},c.default.RendererGL.prototype.drawBuffersScaled=function(d,p,m,g){var b=this.uMVMatrix.copy();try{this.uMVMatrix.scale(p,m,g),this.drawBuffers(d)}finally{this.uMVMatrix=b}},c.default.RendererGL.prototype._drawArrays=function(d,p){return this.GL.drawArrays(d,0,this.retainedMode.geometry[p].lineVertexCount),this},c.default.RendererGL.prototype._drawElements=function(d,m){var m=this.retainedMode.geometry[m],g=this.GL;if(m.indexBuffer){if(this._pInst.webglVersion!==u.WEBGL2&&m.indexBufferType===g.UNSIGNED_INT&&!g.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");g.drawElements(g.TRIANGLES,m.vertexCount,m.indexBufferType,0)}else g.drawArrays(d||g.TRIANGLES,0,m.vertexCount)},c.default.RendererGL.prototype._drawPoints=function(d,p){var m=this.GL,g=this._getImmediatePointShader();this._setPointUniforms(g),this._bindBuffer(p,m.ARRAY_BUFFER,this._vToNArray(d),Float32Array,m.STATIC_DRAW),g.enableAttrib(g.attributes.aPosition,3),this._applyColorBlend(this.curStrokeColor),m.drawArrays(m.Points,0,d.length),g.unbindShader()};var h=c.default.RendererGL;i.default=h},{"../core/constants":269,"../core/main":280,"./p5.RenderBuffer":334,"./p5.RendererGL":337,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.some":169,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint16-array":237,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],337:[function(A,s,i){function a(V){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q})(V)}function l(V){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(q){return a(q)}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":a(q)})(V)}A("core-js/modules/es.symbol"),A("core-js/modules/es.symbol.description"),A("core-js/modules/es.symbol.iterator"),A("core-js/modules/es.array.concat"),A("core-js/modules/es.array.copy-within"),A("core-js/modules/es.array.every"),A("core-js/modules/es.array.fill"),A("core-js/modules/es.array.flat"),A("core-js/modules/es.array.flat-map"),A("core-js/modules/es.array.from"),A("core-js/modules/es.array.includes"),A("core-js/modules/es.array.iterator"),A("core-js/modules/es.array.map"),A("core-js/modules/es.array.slice"),A("core-js/modules/es.array.some"),A("core-js/modules/es.array.unscopables.flat"),A("core-js/modules/es.array.unscopables.flat-map"),A("core-js/modules/es.map"),A("core-js/modules/es.object.assign"),A("core-js/modules/es.object.get-own-property-descriptor"),A("core-js/modules/es.object.get-prototype-of"),A("core-js/modules/es.object.to-string"),A("core-js/modules/es.reflect.construct"),A("core-js/modules/es.reflect.get"),A("core-js/modules/es.regexp.to-string"),A("core-js/modules/es.set"),A("core-js/modules/es.string.includes"),A("core-js/modules/es.string.iterator"),A("core-js/modules/es.typed-array.float32-array"),A("core-js/modules/es.typed-array.float64-array"),A("core-js/modules/es.typed-array.int16-array"),A("core-js/modules/es.typed-array.uint8-array"),A("core-js/modules/es.typed-array.uint16-array"),A("core-js/modules/es.typed-array.uint32-array"),A("core-js/modules/es.typed-array.copy-within"),A("core-js/modules/es.typed-array.every"),A("core-js/modules/es.typed-array.fill"),A("core-js/modules/es.typed-array.filter"),A("core-js/modules/es.typed-array.find"),A("core-js/modules/es.typed-array.find-index"),A("core-js/modules/es.typed-array.for-each"),A("core-js/modules/es.typed-array.includes"),A("core-js/modules/es.typed-array.index-of"),A("core-js/modules/es.typed-array.iterator"),A("core-js/modules/es.typed-array.join"),A("core-js/modules/es.typed-array.last-index-of"),A("core-js/modules/es.typed-array.map"),A("core-js/modules/es.typed-array.reduce"),A("core-js/modules/es.typed-array.reduce-right"),A("core-js/modules/es.typed-array.reverse"),A("core-js/modules/es.typed-array.set"),A("core-js/modules/es.typed-array.slice"),A("core-js/modules/es.typed-array.some"),A("core-js/modules/es.typed-array.sort"),A("core-js/modules/es.typed-array.subarray"),A("core-js/modules/es.typed-array.to-locale-string"),A("core-js/modules/es.typed-array.to-string"),A("core-js/modules/es.weak-map"),A("core-js/modules/web.dom-collections.iterator"),A("core-js/modules/es.symbol"),A("core-js/modules/es.symbol.description"),A("core-js/modules/es.symbol.iterator"),A("core-js/modules/es.array.concat"),A("core-js/modules/es.array.copy-within"),A("core-js/modules/es.array.every"),A("core-js/modules/es.array.fill"),A("core-js/modules/es.array.flat"),A("core-js/modules/es.array.flat-map"),A("core-js/modules/es.array.from"),A("core-js/modules/es.array.includes"),A("core-js/modules/es.array.iterator"),A("core-js/modules/es.array.map"),A("core-js/modules/es.array.slice"),A("core-js/modules/es.array.some"),A("core-js/modules/es.array.unscopables.flat"),A("core-js/modules/es.array.unscopables.flat-map"),A("core-js/modules/es.map"),A("core-js/modules/es.object.assign"),A("core-js/modules/es.object.to-string"),A("core-js/modules/es.set"),A("core-js/modules/es.string.includes"),A("core-js/modules/es.string.iterator"),A("core-js/modules/es.typed-array.float32-array"),A("core-js/modules/es.typed-array.float64-array"),A("core-js/modules/es.typed-array.int16-array"),A("core-js/modules/es.typed-array.uint8-array"),A("core-js/modules/es.typed-array.uint16-array"),A("core-js/modules/es.typed-array.uint32-array"),A("core-js/modules/es.typed-array.copy-within"),A("core-js/modules/es.typed-array.every"),A("core-js/modules/es.typed-array.fill"),A("core-js/modules/es.typed-array.filter"),A("core-js/modules/es.typed-array.find"),A("core-js/modules/es.typed-array.find-index"),A("core-js/modules/es.typed-array.for-each"),A("core-js/modules/es.typed-array.includes"),A("core-js/modules/es.typed-array.index-of"),A("core-js/modules/es.typed-array.iterator"),A("core-js/modules/es.typed-array.join"),A("core-js/modules/es.typed-array.last-index-of"),A("core-js/modules/es.typed-array.map"),A("core-js/modules/es.typed-array.reduce"),A("core-js/modules/es.typed-array.reduce-right"),A("core-js/modules/es.typed-array.reverse"),A("core-js/modules/es.typed-array.set"),A("core-js/modules/es.typed-array.slice"),A("core-js/modules/es.typed-array.some"),A("core-js/modules/es.typed-array.sort"),A("core-js/modules/es.typed-array.subarray"),A("core-js/modules/es.typed-array.to-locale-string"),A("core-js/modules/es.typed-array.to-string"),A("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.readPixelsWebGL=X,i.readPixelWebGL=W,i.default=void 0;var c=m(A("../core/main")),u=function(V){if(V&&V.__esModule)return V;if(V===null||l(V)!=="object"&&typeof V!="function")return{default:V};var q=p();if(q&&q.has(V))return q.get(V);var J,ae={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(J in V){var U;Object.prototype.hasOwnProperty.call(V,J)&&((U=I?Object.getOwnPropertyDescriptor(V,J):null)&&(U.get||U.set)?Object.defineProperty(ae,J,U):ae[J]=V[J])}return ae.default=V,q&&q.set(V,ae),ae}(A("../core/constants")),f=m(A("./GeometryBuilder")),h=m(A("libtess")),d=(A("./p5.Shader"),A("./p5.Camera"),A("../core/p5.Renderer"),A("./p5.Matrix"),A("./p5.Framebuffer"),A("path"),A("./p5.Texture"));function p(){var V;return typeof WeakMap!="function"?null:(V=new WeakMap,p=function(){return V},V)}function m(V){return V&&V.__esModule?V:{default:V}}function g(V){return function(q){if(Array.isArray(q)){for(var J=0,ae=new Array(q.length);J<q.length;J++)ae[J]=q[J];return ae}}(V)||function(q){if(Symbol.iterator in Object(q)||Object.prototype.toString.call(q)==="[object Arguments]")return Array.from(q)}(V)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(V,q){for(var J=0;J<q.length;J++){var ae=q[J];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(V,ae.key,ae)}}function y(V,q,J){return(y=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(z,I,U){var z=function(K,te){for(;!Object.prototype.hasOwnProperty.call(K,te)&&(K=w(K))!==null;);return K}(z,I);if(z)return(z=Object.getOwnPropertyDescriptor(z,I)).get?z.get.call(U):z.value})(V,q,J||V)}function v(V,q){return(v=Object.setPrototypeOf||function(J,ae){return J.__proto__=ae,J})(V,q)}function x(V){return function(){var q,J,ae=w(V);return q=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(q=w(this).constructor,Reflect.construct(ae,arguments,q)):ae.apply(this,arguments),ae=this,!(J=q)||l(J)!=="object"&&typeof J!="function"?S(ae):J}}function S(V){if(V===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return V}function w(V){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(q){return q.__proto__||Object.getPrototypeOf(q)})(V)}function E(V,q,J){q in V?Object.defineProperty(V,q,{value:J,enumerable:!0,configurable:!0,writable:!0}):V[q]=J}function j(V,q){F+="#define STROKE_CAP_".concat(V," ").concat(q,`
`),O[u[V]]=q}function P(V,q){F+="#define STROKE_JOIN_".concat(V," ").concat(q,`
`),k[u[V]]=q}var M,O={},k={},F="",A=(j("ROUND",0),j("PROJECT",1),j("SQUARE",2),P("ROUND",0),P("MITER",1),P("BEVEL",2),`#define PI 3.141592

precision highp float;
precision highp int;

uniform mat4 uViewMatrix;

uniform bool uUseLighting;

uniform int uAmbientLightCount;
uniform vec3 uAmbientColor[5];
uniform mat3 uCameraRotation;
uniform int uDirectionalLightCount;
uniform vec3 uLightingDirection[5];
uniform vec3 uDirectionalDiffuseColors[5];
uniform vec3 uDirectionalSpecularColors[5];

uniform int uPointLightCount;
uniform vec3 uPointLightLocation[5];
uniform vec3 uPointLightDiffuseColors[5];	
uniform vec3 uPointLightSpecularColors[5];

uniform int uSpotLightCount;
uniform float uSpotLightAngle[5];
uniform float uSpotLightConc[5];
uniform vec3 uSpotLightDiffuseColors[5];
uniform vec3 uSpotLightSpecularColors[5];
uniform vec3 uSpotLightLocation[5];
uniform vec3 uSpotLightDirection[5];

uniform bool uSpecular;
uniform float uShininess;
uniform float metallic;

uniform float uConstantAttenuation;
uniform float uLinearAttenuation;
uniform float uQuadraticAttenuation;

// setting from  _setImageLightUniforms()
// boolean to initiate the calculateImageDiffuse and calculateImageSpecular
uniform bool uUseImageLight;
// texture for use in calculateImageDiffuse
uniform sampler2D environmentMapDiffused;
// texture for use in calculateImageSpecular
uniform sampler2D environmentMapSpecular;
// roughness for use in calculateImageSpecular
uniform float levelOfDetail;

const float specularFactor = 2.0;
const float diffuseFactor = 0.73;

struct LightResult {
  float specular;
  float diffuse;
};

float _phongSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float shininess) {

  vec3 R = reflect(lightDirection, surfaceNormal);
  return pow(max(0.0, dot(R, viewDirection)), shininess);
}

float _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {
  return max(0.0, dot(-lightDirection, surfaceNormal));
}

LightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {

  vec3 lightDir = normalize(lightVector);

  //compute our diffuse & specular terms
  LightResult lr;
  float specularIntensity = mix(1.0, 0.4, metallic);
  float diffuseIntensity = mix(1.0, 0.1, metallic);
  if (uSpecular)
    lr.specular = (_phongSpecular(lightDir, viewDirection, normal, uShininess)) * specularIntensity;
    lr.diffuse = _lambertDiffuse(lightDir, normal) * diffuseIntensity;
  return lr;
}

// converts the range of "value" from [min1 to max1] to [min2 to max2]
float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

vec2 mapTextureToNormal( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );
  return angles;
}


vec3 calculateImageDiffuse( vec3 vNormal, vec3 vViewPosition ){
  // make 2 seperate builds 
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position
  vec3 worldNormal = normalize(vNormal * uCameraRotation);
  vec2 newTexCoor = mapTextureToNormal( worldNormal );
  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(smoothstep(vec3(0.0), vec3(1.0), texture.xyz), vec3(0.0), metallic);
}

vec3 calculateImageSpecular( vec3 vNormal, vec3 vViewPosition ){
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);
  vec3 worldNormal = normalize(vNormal);
  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );
  vec3 R = reflect(lightDirection, worldNormal) * uCameraRotation;
  vec2 newTexCoor = mapTextureToNormal( R );
#ifdef WEBGL2
  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, levelOfDetail);
#else
  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);
#endif
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(
    pow(outColor.xyz, vec3(10)),
    pow(outColor.xyz, vec3(1.2)),
    metallic 
  );
}

void totalLight(
  vec3 modelPosition,
  vec3 normal,
  out vec3 totalDiffuse,
  out vec3 totalSpecular
) {

  totalSpecular = vec3(0.0);

  if (!uUseLighting) {
    totalDiffuse = vec3(1.0);
    return;
  }

  totalDiffuse = vec3(0.0);

  vec3 viewDirection = normalize(-modelPosition);

  for (int j = 0; j < 5; j++) {
    if (j < uDirectionalLightCount) {
      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;
      vec3 lightColor = uDirectionalDiffuseColors[j];
      vec3 specularColor = uDirectionalSpecularColors[j];
      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if (j < uPointLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
      //calculate attenuation
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);
      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];
      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];

      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if(j < uSpotLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);

      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;
      float spotDot = dot(normalize(lightVector), normalize(lightDirection));
      float spotFalloff;
      if(spotDot < uSpotLightAngle[j]) {
        spotFalloff = 0.0;
      }
      else {
        spotFalloff = pow(spotDot, uSpotLightConc[j]);
      }
      lightFalloff *= spotFalloff;

      vec3 lightColor = uSpotLightDiffuseColors[j];
      vec3 specularColor = uSpotLightSpecularColors[j];
     
      LightResult result = _light(viewDirection, normal, lightVector);
      
      totalDiffuse += result.diffuse * lightColor * lightFalloff;
      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;
    }
  }

  if( uUseImageLight ){
    totalDiffuse += calculateImageDiffuse(normal, modelPosition);
    totalSpecular += calculateImageSpecular(normal, modelPosition);
  }

  totalDiffuse *= diffuseFactor;
  totalSpecular *= specularFactor;
}
`),N={sphereMappingFrag:`#define PI 3.141592

precision highp float;
  
uniform sampler2D uSampler;
uniform mat3 uNewNormalMatrix;
uniform float uFovY;
uniform float uAspect;

varying vec2 vTexCoord;
  
void main() {
    float uFovX = uFovY * uAspect; 
    vec4 newTexColor = texture2D(uSampler, vTexCoord);
    float angleY = mix(uFovY/2.0,  -uFovY/2.0, vTexCoord.y);
    float angleX = mix(uFovX/2.0, -uFovX/2.0, vTexCoord.x);
    vec3 rotatedNormal = vec3( angleX, angleY, 1.0 );
    rotatedNormal = uNewNormalMatrix * normalize(rotatedNormal);
    vec2 suv;
    suv.y = 0.5 + 0.5 * (-rotatedNormal.y);
    suv.x = atan(rotatedNormal.z, rotatedNormal.x) / (2.0 * PI) + 0.5;
    newTexColor = texture2D(uSampler, suv.xy);
    gl_FragColor = newTexColor;
}
`,immediateVert:`IN vec3 aPosition;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uResolution;
uniform float uPointSize;

OUT vec4 vColor;
void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
  gl_PointSize = uPointSize;
}
`,vertexColorVert:`IN vec3 aPosition;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

OUT vec4 vColor;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
}
`,vertexColorFrag:`IN vec4 vColor;
void main(void) {
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,normalVert:`IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform vec4 uMaterialColor;
uniform bool uUseVertexColor;

OUT vec3 vVertexNormal;
OUT highp vec2 vVertTexCoord;
OUT vec4 vColor;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));
  vVertTexCoord = aTexCoord;
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,normalFrag:`IN vec3 vVertexNormal;
void main(void) {
  OUT_COLOR = vec4(vVertexNormal, 1.0);
}
`,basicFrag:`IN vec4 vColor;
void main(void) {
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,lightVert:A+`// include lighting.glgl

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT highp vec2 vVertTexCoord;
OUT vec3 vDiffuseColor;
OUT vec3 vSpecularColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;

  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);
  vVertTexCoord = aTexCoord;

  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);

  for (int i = 0; i < 8; i++) {
    if (i < uAmbientLightCount) {
      vDiffuseColor += uAmbientColor[i];
    }
  }
  
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,lightTextureFrag:`uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

IN highp vec2 vVertTexCoord;
IN vec3 vDiffuseColor;
IN vec3 vSpecularColor;
IN vec4 vColor;

void main(void) {
  if(uEmissive && !isTexture) {
    OUT_COLOR = vColor;
  }
  else {
    vec4 baseColor = isTexture
      // Textures come in with premultiplied alpha. To apply tint and still have
      // premultiplied alpha output, we need to multiply the RGB channels by the
      // tint RGB, and all channels by the tint alpha.
      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
      // Colors come in with unmultiplied alpha, so we need to multiply the RGB
      // channels by alpha to convert it to premultiplied alpha.
      : vec4(vColor.rgb * vColor.a, vColor.a);
    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);
  }
}
`,phongVert:`precision highp int;

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform vec3 uAmbientColor[5];

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;
uniform int uAmbientLightCount;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT vec3 vNormal;
OUT vec2 vTexCoord;
OUT vec3 vViewPosition;
OUT vec3 vAmbientColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);

  // Pass varyings to fragment shader
  vViewPosition = viewModelPosition.xyz;
  gl_Position = uProjectionMatrix * viewModelPosition;  

  vNormal = uNormalMatrix * aNormal;
  vTexCoord = aTexCoord;

  // TODO: this should be a uniform
  vAmbientColor = vec3(0.0);
  for (int i = 0; i < 5; i++) {
    if (i < uAmbientLightCount) {
      vAmbientColor += uAmbientColor[i];
    }
  }
  
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,phongFrag:A+`// include lighting.glsl
precision highp int;

uniform bool uHasSetAmbient;
uniform vec4 uSpecularMatColor;
uniform vec4 uAmbientMatColor;
uniform vec4 uEmissiveMatColor;

uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;

IN vec3 vNormal;
IN vec2 vTexCoord;
IN vec3 vViewPosition;
IN vec3 vAmbientColor;
IN vec4 vColor;

void main(void) {

  vec3 diffuse;
  vec3 specular;
  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);

  // Calculating final color as result of all lights (plus emissive term).

  vec4 baseColor = isTexture
    // Textures come in with premultiplied alpha. To apply tint and still have
    // premultiplied alpha output, we need to multiply the RGB channels by the
    // tint RGB, and all channels by the tint alpha.
    ? TEXTURE(uSampler, vTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
    // Colors come in with unmultiplied alpha, so we need to multiply the RGB
    // channels by alpha to convert it to premultiplied alpha.
    : vec4(vColor.rgb * vColor.a, vColor.a);
  OUT_COLOR = vec4(diffuse * baseColor.rgb + 
                    vAmbientColor * (
                      uHasSetAmbient ? uAmbientMatColor.rgb : baseColor.rgb
                    ) + 
                    specular * uSpecularMatColor.rgb + 
                    uEmissiveMatColor.rgb, baseColor.a);
}
`,fontVert:`IN vec3 aPosition;
IN vec2 aTexCoord;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

uniform vec4 uGlyphRect;
uniform float uGlyphOffset;

OUT vec2 vTexCoord;
OUT float w;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // scale by the size of the glyph's rectangle
  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;

  // Expand glyph bounding boxes by 1px on each side to give a bit of room
  // for antialiasing
  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;
  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;
  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;
  vec2 pixelScale = vec2(
    1. / length(newOrigin - newDX),
    1. / length(newOrigin - newDY)
  );
  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5)) * vec2(1., -1.);
  vec2 textureOffset = offset * (1. / vec2(
    uGlyphRect.z - uGlyphRect.x,
    uGlyphRect.w - uGlyphRect.y
  ));

  // move to the corner of the glyph
  positionVec4.xy += uGlyphRect.xy;

  // move to the letter's line offset
  positionVec4.x += uGlyphOffset;

  positionVec4.xy += offset;
  
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vTexCoord = aTexCoord + textureOffset;
  w = gl_Position.w;
}
`,fontFrag:`#ifndef WEBGL2
#extension GL_OES_standard_derivatives : enable
#endif

#if 0
  // simulate integer math using floats
	#define int float
	#define ivec2 vec2
	#define INT(x) float(x)

	int ifloor(float v) { return floor(v); }
	ivec2 ifloor(vec2 v) { return floor(v); }

#else
  // use native integer math
	precision highp int;
	#define INT(x) x

	int ifloor(float v) { return int(v); }
	int ifloor(int v) { return v; }
	ivec2 ifloor(vec2 v) { return ivec2(v); }

#endif

uniform sampler2D uSamplerStrokes;
uniform sampler2D uSamplerRowStrokes;
uniform sampler2D uSamplerRows;
uniform sampler2D uSamplerColStrokes;
uniform sampler2D uSamplerCols;

uniform ivec2 uStrokeImageSize;
uniform ivec2 uCellsImageSize;
uniform ivec2 uGridImageSize;

uniform ivec2 uGridOffset;
uniform ivec2 uGridSize;
uniform vec4 uMaterialColor;

IN vec2 vTexCoord;

// some helper functions
int ROUND(float v) { return ifloor(v + 0.5); }
ivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }
float saturate(float v) { return clamp(v, 0.0, 1.0); }
vec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }

int mul(float v1, int v2) {
  return ifloor(v1 * float(v2));
}

ivec2 mul(vec2 v1, ivec2 v2) {
  return ifloor(v1 * vec2(v2) + 0.5);
}

// unpack a 16-bit integer from a float vec2
int getInt16(vec2 v) {
  ivec2 iv = ROUND(v * 255.0);
  return iv.x * INT(128) + iv.y;
}

vec2 pixelScale;
vec2 coverage = vec2(0.0);
vec2 weight = vec2(0.5);
const float minDistance = 1.0/8192.0;
const float hardness = 1.05; // amount of antialias

// the maximum number of curves in a glyph
const int N = INT(250);

// retrieves an indexed pixel from a sampler
vec4 getTexel(sampler2D sampler, int pos, ivec2 size) {
  int width = size.x;
  int y = ifloor(pos / width);
  int x = pos - y * width;  // pos % width

  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));
}

void calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {

  // get the coefficients of the quadratic in t
  vec2 a = p0 - p1 * 2.0 + p2;
  vec2 b = p0 - p1;
  vec2 c = p0 - vTexCoord;

  // found out which values of 't' it crosses the axes
  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));
  vec2 t1 = ((b - surd) / a).yx;
  vec2 t2 = ((b + surd) / a).yx;

  // approximate straight lines to avoid rounding errors
  if (abs(a.y) < 0.001)
    t1.x = t2.x = c.y / (2.0 * b.y);

  if (abs(a.x) < 0.001)
    t1.y = t2.y = c.x / (2.0 * b.x);

  // plug into quadratic formula to find the corrdinates of the crossings
  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;
  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;
}

void coverageX(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  // determine on which side of the x-axis the points lie
  bool y0 = p0.y > vTexCoord.y;
  bool y1 = p1.y > vTexCoord.y;
  bool y2 = p2.y > vTexCoord.y;

  // could web be under the curve (after t1)?
  if (y1 ? !y2 : y0) {
    // add the coverage for t1
    coverage.x += saturate(C1.x + 0.5);
    // calculate the anti-aliasing for t1
    weight.x = min(weight.x, abs(C1.x));
  }

  // are we outside the curve (after t2)?
  if (y1 ? !y0 : y2) {
    // subtract the coverage for t2
    coverage.x -= saturate(C2.x + 0.5);
    // calculate the anti-aliasing for t2
    weight.x = min(weight.x, abs(C2.x));
  }
}

// this is essentially the same as coverageX, but with the axes swapped
void coverageY(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  bool x0 = p0.x > vTexCoord.x;
  bool x1 = p1.x > vTexCoord.x;
  bool x2 = p2.x > vTexCoord.x;

  if (x1 ? !x2 : x0) {
    coverage.y -= saturate(C1.y + 0.5);
    weight.y = min(weight.y, abs(C1.y));
  }

  if (x1 ? !x0 : x2) {
    coverage.y += saturate(C2.y + 0.5);
    weight.y = min(weight.y, abs(C2.y));
  }
}

void main() {

  // calculate the pixel scale based on screen-coordinates
  pixelScale = hardness / fwidth(vTexCoord);

  // which grid cell is this pixel in?
  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));

  // intersect curves in this row
  {
    // the index into the row info bitmap
    int rowIndex = gridCoord.y + uGridOffset.y;
    // fetch the info texel
    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);
    // unpack the rowInfo
    int rowStrokeIndex = getInt16(rowInfo.xy);
    int rowStrokeCount = getInt16(rowInfo.zw);

    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {
      if (iRowStroke >= rowStrokeCount)
        break;

      // each stroke is made up of 3 points: the start and control point
      // and the start of the next curve.
      // fetch the indices of this pair of strokes:
      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);

      // unpack the stroke index
      int strokePos = getInt16(strokeIndices.xy);

      // fetch the two strokes
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);

      // calculate the coverage
      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  // intersect curves in this column
  {
    int colIndex = gridCoord.x + uGridOffset.x;
    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);
    int colStrokeIndex = getInt16(colInfo.xy);
    int colStrokeCount = getInt16(colInfo.zw);
    
    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {
      if (iColStroke >= colStrokeCount)
        break;

      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);

      int strokePos = getInt16(strokeIndices.xy);
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);
      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  weight = saturate(1.0 - weight * 2.0);
  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.
  float antialias = abs(dot(coverage, weight) / distance);
  float cover = min(abs(coverage.x), abs(coverage.y));
  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
  OUT_COLOR *= saturate(max(antialias, cover));
}
`,lineVert:F+`/*
  Part of the Processing project - http://processing.org
  Copyright (c) 2012-15 The Processing Foundation
  Copyright (c) 2004-12 Ben Fry and Casey Reas
  Copyright (c) 2001-04 Massachusetts Institute of Technology
  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation, version 2.1.
  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.
  You should have received a copy of the GNU Lesser General
  Public License along with this library; if not, write to the
  Free Software Foundation, Inc., 59 Temple Place, Suite 330,
  Boston, MA  02111-1307  USA
*/

#define PROCESSING_LINE_SHADER

precision mediump int;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uStrokeWeight;

uniform bool uUseLineColor;
uniform vec4 uMaterialColor;

uniform vec4 uViewport;
uniform int uPerspective;
uniform int uStrokeJoin;

IN vec4 aPosition;
IN vec3 aTangentIn;
IN vec3 aTangentOut;
IN float aSide;
IN vec4 aVertexColor;

OUT vec4 vColor;
OUT vec2 vTangent;
OUT vec2 vCenter;
OUT vec2 vPosition;
OUT float vMaxDist;
OUT float vCap;
OUT float vJoin;

vec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {
  // Rotate and translate so a starts at the origin and goes out to the right
  bPoint -= aPoint;
  vec2 rotatedBFrom = vec2(
    bPoint.x*aDir.x + bPoint.y*aDir.y,
    bPoint.y*aDir.x - bPoint.x*aDir.y
  );
  vec2 bTo = bPoint + bDir;
  vec2 rotatedBTo = vec2(
    bTo.x*aDir.x + bTo.y*aDir.y,
    bTo.y*aDir.x - bTo.x*aDir.y
  );
  float intersectionDistance =
    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /
    (rotatedBTo.y - rotatedBFrom.y);
  return aPoint + aDir * intersectionDistance;
}

void main() {
  // Caps have one of either the in or out tangent set to 0
  vCap = (aTangentIn == vec3(0.)) != (aTangentOut == (vec3(0.)))
    ? 1. : 0.;

  // Joins have two unique, defined tangents
  vJoin = (
    aTangentIn != vec3(0.) &&
    aTangentOut != vec3(0.) &&
    aTangentIn != aTangentOut
  ) ? 1. : 0.;

  vec4 posp = uModelViewMatrix * aPosition;
  vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));
  vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));

  float facingCamera = pow(
    // The word space tangent's z value is 0 if it's facing the camera
    abs(normalize(posqIn-posp).z),

    // Using pow() here to ramp \`facingCamera\` up from 0 to 1 really quickly
    // so most lines get scaled and don't get clipped
    0.25
  );

  // using a scale <1 moves the lines towards the camera
  // in order to prevent popping effects due to half of
  // the line disappearing behind the geometry faces.
  float scale = mix(1., 0.995, facingCamera);

  // Moving vertices slightly toward the camera
  // to avoid depth-fighting with the fill triangles.
  // Discussed here:
  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  
  posp.xyz = posp.xyz * scale;
  posqIn.xyz = posqIn.xyz * scale;
  posqOut.xyz = posqOut.xyz * scale;

  vec4 p = uProjectionMatrix * posp;
  vec4 qIn = uProjectionMatrix * posqIn;
  vec4 qOut = uProjectionMatrix * posqOut;
  vCenter = p.xy;

  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])
  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw

  // prevent division by W by transforming the tangent formula (div by 0 causes
  // the line to disappear, see https://github.com/processing/processing/issues/5183)
  // t = screen_q - screen_p
  //
  // tangent is normalized and we don't care which aDirection it points to (+-)
  // t = +- normalize( screen_q - screen_p )
  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )
  //
  // extract common factor, <1,1> - <1,1> cancels out
  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )
  //
  // convert to common divisor
  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )
  //
  // remove the common scalar divisor/factor, not needed due to normalize and +-
  // (keep uViewport - can't remove because it has different components for x and y
  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)
  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )

  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);
  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);

  vec2 curPerspScale;
  if(uPerspective == 1) {
    // Perspective ---
    // convert from world to clip by multiplying with projection scaling factor
    // to get the right thickness (see https://github.com/processing/processing/issues/5182)

    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.
    // Multiplying again by its sign here negates the flip to get just the scale.
    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;
  } else {
    // No Perspective ---
    // multiply by W (to cancel out division by W later in the pipeline) and
    // convert from screen to clip (derived from clip to screen above)
    curPerspScale = p.w / (0.5 * uViewport.zw);
  }

  vec2 offset;
  if (vJoin == 1.) {
    vTangent = normalize(tangentIn + tangentOut);
    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);
    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);
    float side = sign(aSide);
    float sideEnum = abs(aSide);

    // We generate vertices for joins on either side of the centerline, but
    // the "elbow" side is the only one needing a join. By not setting the
    // offset for the other side, all its vertices will end up in the same
    // spot and not render, effectively discarding it.
    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {
      // Side enums:
      //   1: the side going into the join
      //   2: the middle of the join
      //   3: the side going out of the join
      if (sideEnum == 2.) {
        // Calculate the position + tangent on either side of the join, and
        // find where the lines intersect to find the elbow of the join
        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;
        vec2 intersection = lineIntersection(
          c + (side * normalIn * uStrokeWeight / 2.),
          tangentIn,
          c + (side * normalOut * uStrokeWeight / 2.),
          tangentOut
        );
        offset = (intersection - c);

        // When lines are thick and the angle of the join approaches 180, the
        // elbow might be really far from the center. We'll apply a limit to
        // the magnitude to avoid lines going across the whole screen when this
        // happens.
        float mag = length(offset);
        float maxMag = 3. * uStrokeWeight;
        if (mag > maxMag) {
          offset *= maxMag / mag;
        }
      } else if (sideEnum == 1.) {
        offset = side * normalIn * uStrokeWeight / 2.;
      } else if (sideEnum == 3.) {
        offset = side * normalOut * uStrokeWeight / 2.;
      }
    }
    if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);
      vMaxDist = abs(dot(avgNormal, normalIn * uStrokeWeight / 2.));
    } else {
      vMaxDist = uStrokeWeight / 2.;
    }
  } else {
    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;
    vTangent = tangent;
    vec2 normal = vec2(-tangent.y, tangent.x);

    float normalOffset = sign(aSide);
    // Caps will have side values of -2 or 2 on the edge of the cap that
    // extends out from the line
    float tangentOffset = abs(aSide) - 1.;
    offset = (normal * normalOffset + tangent * tangentOffset) *
      uStrokeWeight * 0.5;
    vMaxDist = uStrokeWeight / 2.;
  }
  vPosition = vCenter + offset;

  gl_Position.xy = p.xy + offset.xy * curPerspScale;
  gl_Position.zw = p.zw;
  
  vColor = (uUseLineColor ? aVertexColor : uMaterialColor);
}
`,lineFrag:F+`precision mediump int;

uniform vec4 uMaterialColor;
uniform int uStrokeCap;
uniform int uStrokeJoin;
uniform float uStrokeWeight;

IN vec4 vColor;
IN vec2 vTangent;
IN vec2 vCenter;
IN vec2 vPosition;
IN float vMaxDist;
IN float vCap;
IN float vJoin;

float distSquared(vec2 a, vec2 b) {
  vec2 aToB = b - a;
  return dot(aToB, aToB);
}

void main() {
  if (vCap > 0.) {
    if (
      uStrokeCap == STROKE_CAP_ROUND &&
      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25
    ) {
      discard;
    } else if (
      uStrokeCap == STROKE_CAP_SQUARE &&
      dot(vPosition - vCenter, vTangent) > 0.
    ) {
      discard;
    }
    // Use full area for PROJECT
  } else if (vJoin > 0.) {
    if (
      uStrokeJoin == STROKE_JOIN_ROUND &&
      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25
    ) {
      discard;
    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 normal = vec2(-vTangent.y, vTangent.x);
      if (abs(dot(vPosition - vCenter, normal)) > vMaxDist) {
        discard;
      }
    }
    // Use full area for MITER
  }
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,pointVert:`IN vec3 aPosition;
uniform float uPointSize;
OUT float vStrokeWeight;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
void main() {
	vec4 positionVec4 =  vec4(aPosition, 1.0);
	gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
	gl_PointSize = uPointSize;
	vStrokeWeight = uPointSize;
}
`,pointFrag:`precision mediump int;
uniform vec4 uMaterialColor;
IN float vStrokeWeight;

void main(){
  float mask = 0.0;

  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)
  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant

  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));

  // if strokeWeight is 1 or less lets just draw a square
  // this prevents weird artifacting from carving circles when our points are really small
  // if strokeWeight is larger than 1, we just use it as is

  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));

  // throw away the borders of the mask
  // otherwise we get weird alpha blending issues

  if(mask > 0.98){
    discard;
  }

  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
}
`,imageLightVert:`precision highp float;
attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

varying vec3 localPos;
varying vec3 vWorldNormal;
varying vec3 vWorldPosition;
varying vec2 vTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

void main() {
  // Multiply the position by the matrix.
  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;  
  
  // orient the normals and pass to the fragment shader
  vWorldNormal = uNormalMatrix * aNormal;
  
  // send the view position to the fragment shader
  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;
  
  localPos = vWorldPosition;
  vTexCoord = aTexCoord;
}


/*
in the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.
*/
`,imageLightDiffusedFrag:`precision highp float;
varying vec3 localPos;

// the HDR cubemap converted (can be from an equirectangular environment map.)
uniform sampler2D environmentMap;
varying vec2 vTexCoord;

const float PI = 3.14159265359;

vec2 nTOE( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( phi, theta );
  return angles;
}

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

void main()
{   	 
	// the sample direction equals the hemisphere's orientation
  float phi = vTexCoord.x * 2.0 * PI;
  float theta = vTexCoord.y * PI;
  float x = sin(theta) * cos(phi);
  float y = sin(theta) * sin(phi);
  float z = cos(theta);
  vec3 normal = vec3( x, y, z);

	// Discretely sampling the hemisphere given the integral's
  // spherical coordinates translates to the following fragment code:
	vec3 irradiance = vec3(0.0);  
	vec3 up	= vec3(0.0, 1.0, 0.0);
	vec3 right = normalize(cross(up, normal));
	up = normalize(cross(normal, right));

	//  We specify a fixed sampleDelta delta value to traverse
  // the hemisphere; decreasing or increasing the sample delta
  // will increase or decrease the accuracy respectively.
	const float sampleDelta = 0.100;
	float nrSamples = 0.0;
  float randomOffset = random(gl_FragCoord.xy) * sampleDelta;
	for(float rawPhi = 0.0; rawPhi < 2.0 * PI; rawPhi += sampleDelta)
	{
    float phi = rawPhi + randomOffset;
    for(float rawTheta = 0.0; rawTheta < ( 0.5 ) * PI; rawTheta += sampleDelta)
    {
      float theta = rawTheta + randomOffset;
      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance
      float x = sin(theta) * cos(phi);
      float y = sin(theta) * sin(phi);
      float z = cos(theta);
      vec3 tangentSample = vec3( x, y, z);
      
      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;
        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);
      nrSamples++;
    }
	}
	// divide by the total number of samples taken, giving us the average sampled irradiance.
	irradiance = PI * irradiance * (1.0 / float(nrSamples )) ;
  
 
	gl_FragColor = vec4(irradiance, 1.0);
}`,imageLightSpecularFrag:`precision highp float;\r
varying vec3 localPos;\r
varying vec2 vTexCoord;\r
\r
// our texture\r
uniform sampler2D environmentMap;\r
uniform float roughness;\r
\r
const float PI = 3.14159265359;\r
\r
float VanDerCorput(int bits);\r
vec2 HammersleyNoBitOps(int i, int N);\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\r
\r
\r
vec2 nTOE( vec3 v ){\r
  // x = r sin(phi) cos(theta)   \r
  // y = r cos(phi)  \r
  // z = r sin(phi) sin(theta)\r
  float phi = acos( v.y );\r
  // if phi is 0, then there are no x, z components\r
  float theta = 0.0;\r
  // else \r
  theta = acos(v.x / sin(phi));\r
  float sinTheta = v.z / sin(phi);\r
  if (sinTheta < 0.0) {\r
    // Turn it into -theta, but in the 0-2PI range\r
    theta = 2.0 * PI - theta;\r
  }\r
  theta = theta / (2.0 * 3.14159);\r
  phi = phi / 3.14159 ;\r
  \r
  vec2 angles = vec2( phi, theta );\r
  return angles;\r
}\r
\r
\r
void main(){\r
  const int SAMPLE_COUNT = 400; // 4096\r
  int lowRoughnessLimit = int(pow(2.0,(roughness+0.1)*20.0));\r
  float totalWeight = 0.0;\r
  vec3 prefilteredColor = vec3(0.0);\r
  float phi = vTexCoord.x * 2.0 * PI;\r
  float theta = vTexCoord.y * PI;\r
  float x = sin(theta) * cos(phi);\r
  float y = sin(theta) * sin(phi);\r
  float z = cos(theta);\r
  vec3 N = vec3(x,y,z);\r
  vec3 V = N;\r
  for (int i = 0; i < SAMPLE_COUNT; ++i)\r
  {\r
    // break at smaller sample numbers for low roughness levels\r
    if(i == lowRoughnessLimit)\r
    {\r
      break;\r
    }\r
    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\r
    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\r
    vec3 L = normalize(2.0 * dot(V, H) * H - V);\r
\r
    float NdotL = max(dot(N, L), 0.0);\r
    if (NdotL > 0.0)\r
    {\r
      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\r
      totalWeight += NdotL;\r
    }\r
  }\r
  prefilteredColor = prefilteredColor / totalWeight;\r
\r
  gl_FragColor = vec4(prefilteredColor, 1.0);\r
}\r
\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\r
  float a = roughness * roughness;\r
\r
  float phi = 2.0 * PI * Xi.x;\r
  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\r
  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\r
  // from spherical coordinates to cartesian coordinates\r
  vec3 H;\r
  H.x = cos(phi) * sinTheta;\r
  H.y = sin(phi) * sinTheta;\r
  H.z = cosTheta;\r
\r
  // from tangent-space vector to world-space sample vector\r
  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\r
  vec3 tangent = normalize(cross(up, N));\r
  vec3 bitangent = cross(N, tangent);\r
\r
  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\r
  return normalize(sampleVec);\r
}\r
\r
\r
float VanDerCorput(int n, int base)\r
{\r
#ifdef WEBGL2\r
\r
    uint bits = uint(n);\r
    bits = (bits << 16u) | (bits >> 16u);\r
    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\r
    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\r
    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\r
    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\r
    return float(bits) * 2.3283064365386963e-10; // / 0x100000000\r
\r
#else\r
\r
  float invBase = 1.0 / float(base);\r
  float denom = 1.0;\r
  float result = 0.0;\r
\r
\r
  for (int i = 0; i < 32; ++i)\r
  {\r
        if (n > 0)\r
        {\r
        denom = mod(float(n), 2.0);\r
        result += denom * invBase;\r
        invBase = invBase / 2.0;\r
        n = int(float(n) / 2.0);\r
        }\r
  }\r
\r
\r
  return result;\r
\r
#endif\r
}\r
\r
vec2 HammersleyNoBitOps(int i, int N)\r
{\r
  return vec2(float(i) / float(N), VanDerCorput(i, 2));\r
}\r
`},$=N.sphereMappingFrag;for(M in N)N[M]=`#ifdef WEBGL2

#define IN in
#define OUT out

#ifdef FRAGMENT_SHADER
out vec4 outColor;
#define OUT_COLOR outColor
#endif
#define TEXTURE texture

#else

#ifdef FRAGMENT_SHADER
#define IN varying
#else
#define IN attribute
#endif
#define OUT varying
#define TEXTURE texture2D

#ifdef FRAGMENT_SHADER
#define OUT_COLOR gl_FragColor
#endif

#endif
`+N[M];E(A={},u.GRAY,`precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 tex = texture2D(tex0, vTexCoord);
  float gray = luma(tex.rgb);
  gl_FragColor = vec4(gray, gray, gray, tex.a);
}
`),E(A,u.ERODE,`// Reduces the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the darkest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum < lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`),E(A,u.DILATE,`// Increase the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the brightest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum > lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`),E(A,u.BLUR,`precision highp float;

// Two-pass blur filter, unweighted kernel.
// See also a similar blur at Adam Ferriss' repo of shader examples:
// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag


uniform sampler2D tex0;
varying vec2 vTexCoord;
uniform vec2 direction;
uniform vec2 canvasSize;
uniform float radius;

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

// This isn't a real Gaussian weight, it's a quadratic weight. It's what the
// CPU mode's blur uses though, so we also use it here to match.
float quadWeight(float x, float e) {
  return pow(e-abs(x), 2.);
}

void main(){
  vec2 uv = vTexCoord;

  // A reasonable maximum number of samples
  const float maxSamples = 64.0;

  float numSamples = floor(7. * radius);
  if (fract(numSamples / 2.) == 0.) {
    numSamples++;
  }
  vec4 avg = vec4(0.0);
  float total = 0.0;

  // Calculate the spacing to avoid skewing if numSamples > maxSamples
  float spacing = 1.0;
  if (numSamples > maxSamples) {
    spacing = numSamples / maxSamples;
    numSamples = maxSamples;
  }

  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));
  for (float i = 0.0; i < maxSamples; i++) {
    if (i >= numSamples) break;

    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;
    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;
    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);

    avg += weight * texture2D(tex0, sampleCoord);
    total += weight;
  }

  avg /= total;
  gl_FragColor = avg;
}
`),E(A,u.POSTERIZE,`// Limit color space for a stylized cartoon / poster effect

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

vec3 quantize(vec3 color, float n) {
  // restrict values to N options/bins
  // and floor each channel to nearest value
  //
  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0
  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)

  color = color * n;
  color = floor(color);
  color = color / (n - 1.0);
  return color;
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);

  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);

  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);
}
`),E(A,u.OPAQUE,`// Set alpha channel to entirely opaque

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  gl_FragColor = vec4(color.rgb / color.a, 1.0);
}
`),E(A,u.INVERT,`// Set each pixel to inverse value
// Note that original INVERT does not change the opacity, so this follows suit

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
vec4 color = texture2D(tex0, vTexCoord);
vec3 origColor = color.rgb / color.a;
vec3 invertedColor = vec3(1.0) - origColor;
gl_FragColor = vec4(invertedColor * color.a, color.a);
}
`),E(A,u.THRESHOLD,`// Convert pixels to either white or black, 
// depending on if their luma is above or below filterParameter

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float gray = luma(color.rgb / color.a);
  // floor() used to match src/image/filters.js
  float threshold = floor(filterParameter * 255.0) / 255.0;
  float blackOrWhite = step(threshold, gray);
  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);
}
`);var G=A;function X(V,q,me,ae,I,U,z,K,te,ne){var le=q.getParameter(q.FRAMEBUFFER_BINDING),me=(q.bindFramebuffer(q.FRAMEBUFFER,me),K===q.RGBA?4:3),ce=U*z*me,ge=te===q.UNSIGNED_BYTE?Uint8Array:Float32Array;if(V instanceof ge&&V.length===ce||(V=new ge(ce)),q.readPixels(ae,ne?ne-I-z:I,U,z,K,te,V),q.bindFramebuffer(q.FRAMEBUFFER,le),ne)for(var pe=Math.floor(z/2),oe=new ge(U*me),de=0;de<pe;de++){var xe=de*U*4,Te=(z-de-1)*U*4;oe.set(V.subarray(xe,xe+4*U)),V.copyWithin(xe,Te,Te+4*U),V.set(oe,Te)}return V}function W(V,te,J,ae,I,U,z){var K=V.getParameter(V.FRAMEBUFFER_BINDING),te=(V.bindFramebuffer(V.FRAMEBUFFER,te),I===V.RGBA?4:3),te=new(U===V.UNSIGNED_BYTE?Uint8Array:Float32Array)(te);return V.readPixels(J,z?z-ae-1:ae,1,1,I,U,te),V.bindFramebuffer(V.FRAMEBUFFER,K),Array.from(te)}c.default.prototype.setAttributes=function(V,q){if(this._glAttributes===void 0)console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.");else{var J=!0;if(q!==void 0?(this._glAttributes===null&&(this._glAttributes={}),this._glAttributes[V]!==q&&(this._glAttributes[V]=q,J=!1)):V instanceof Object&&this._glAttributes!==V&&(this._glAttributes=V,J=!1),this._renderer.isP3D&&!J){if(!this._setupDone){for(var ae in this._renderer.retainedMode.geometry)if(this._renderer.retainedMode.geometry.hasOwnProperty(ae))return void c.default._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()")}this.push(),this._renderer._resetContext(),this.pop(),this._renderer._curCamera&&(this._renderer._curCamera._renderer=this._renderer)}}},c.default.RendererGL=function(V){var q=ae;if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function");q.prototype=Object.create(V&&V.prototype,{constructor:{value:q,writable:!0,configurable:!0}}),V&&v(q,V);var J=x(ae);function ae(I,U,z,K){if(this instanceof ae)return(I=J.call(this,I,U,z))._setAttributeDefaults(U),I._initContext(),I.isP3D=!0,I.geometryBuilder=void 0,I.GL=I.drawingContext,I._pInst._setProperty("drawingContext",I.drawingContext),I._isErasing=!1,I._clipDepths=[],I._isClipApplied=!1,I._stencilTestOn=!1,I._enableLighting=!1,I.ambientLightColors=[],I.mixedAmbientLight=[],I.mixedSpecularColor=[],I.specularColors=[1,1,1],I.directionalLightDirections=[],I.directionalLightDiffuseColors=[],I.directionalLightSpecularColors=[],I.pointLightPositions=[],I.pointLightDiffuseColors=[],I.pointLightSpecularColors=[],I.spotLightPositions=[],I.spotLightDirections=[],I.spotLightDiffuseColors=[],I.spotLightSpecularColors=[],I.spotLightAngle=[],I.spotLightConc=[],I.activeImageLight=null,I.diffusedTextures=new Map,I.specularTextures=new Map,I.drawMode=u.FILL,I.curFillColor=I._cachedFillStyle=[1,1,1,1],I.curAmbientColor=I._cachedFillStyle=[1,1,1,1],I.curSpecularColor=I._cachedFillStyle=[0,0,0,0],I.curEmissiveColor=I._cachedFillStyle=[0,0,0,0],I.curStrokeColor=I._cachedStrokeStyle=[0,0,0,1],I.curBlendMode=u.BLEND,I.preEraseBlend=void 0,I._cachedBlendMode=void 0,I.webglVersion===u.WEBGL2?I.blendExt=I.GL:I.blendExt=I.GL.getExtension("EXT_blend_minmax"),I._isBlending=!1,I._hasSetAmbient=!1,I._useSpecularMaterial=!1,I._useEmissiveMaterial=!1,I._useNormalMaterial=!1,I._useShininess=1,I._useMetalness=0,I._useLineColor=!1,I._useVertexColor=!1,I.registerEnabled=new Set,I._tint=[255,255,255,255],I.constantAttenuation=1,I.linearAttenuation=0,I.quadraticAttenuation=0,I.uMVMatrix=new c.default.Matrix,I.uPMatrix=new c.default.Matrix,I.uNMatrix=new c.default.Matrix("mat3"),I.curMatrix=new c.default.Matrix("mat3"),I._currentNormal=new c.default.Vector(0,0,1),I._curCamera=new c.default.Camera(S(I)),I._curCamera._computeCameraDefaultSettings(),I._curCamera._setDefaultCamera(),I.filterCamera=new c.default.Camera(S(I)),I.filterCamera._computeCameraDefaultSettings(),I.filterCamera._setDefaultCamera(),I.prevTouches=[],I.zoomVelocity=0,I.rotateVelocity=new c.default.Vector(0,0),I.moveVelocity=new c.default.Vector(0,0),I.executeZoom=!1,I.executeRotateAndMove=!1,I.specularShader=void 0,I.sphereMapping=void 0,I.diffusedShader=void 0,I._defaultLightShader=void 0,I._defaultImmediateModeShader=void 0,I._defaultNormalShader=void 0,I._defaultColorShader=void 0,I._defaultPointShader=void 0,I.userFillShader=void 0,I.userStrokeShader=void 0,I.userPointShader=void 0,I.retainedMode={geometry:{},buffers:{stroke:[new c.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",S(I)),new c.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",S(I)),new c.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",S(I)),new c.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",S(I)),new c.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",S(I))],fill:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",S(I),I._vToNArray),new c.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",S(I),I._vToNArray),new c.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",S(I)),new c.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",S(I)),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",S(I),I._flatten)],text:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",S(I),I._vToNArray),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",S(I),I._flatten)]}},I.immediateMode={geometry:new c.default.Geometry,shapeMode:u.TRIANGLE_FAN,contourIndices:[],_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",S(I),I._vToNArray),new c.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",S(I),I._vToNArray),new c.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",S(I)),new c.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",S(I)),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",S(I),I._flatten)],stroke:[new c.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",S(I)),new c.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",S(I)),new c.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",S(I)),new c.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",S(I)),new c.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",S(I))],point:I.GL.createBuffer()}},I.pointSize=5,I.curStrokeWeight=1,I.curStrokeCap=u.ROUND,I.curStrokeJoin=u.ROUND,I.textures=new Map,I.framebuffers=new Set,I.activeFramebuffers=[],I.filterShader=void 0,I.filterLayer=void 0,I.filterLayerTemp=void 0,I.defaultFilterShaders={},I.textureMode=u.IMAGE,I.textureWrapX=u.CLAMP,I.textureWrapY=u.CLAMP,I._tex=null,I._curveTightness=6,I._lookUpTableBezier=[],I._lookUpTableQuadratic=[],I._lutBezierDetail=0,I._lutQuadraticDetail=0,I.isProcessingVertices=!1,I._tessy=I._initTessy(),I.fontInfos={},I._curShader=void 0,I;throw new TypeError("Cannot call a class as a function")}return q=ae,(V=[{key:"beginGeometry",value:function(){if(this.geometryBuilder)throw new Error("It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.");this.geometryBuilder=new f.default(this)}},{key:"endGeometry",value:function(){var I;if(this.geometryBuilder)return I=this.geometryBuilder.finish(),this.geometryBuilder=void 0,I;throw new Error("Make sure you call beginGeometry() before endGeometry()!")}},{key:"buildGeometry",value:function(I){return this.beginGeometry(),I(),this.endGeometry()}},{key:"_setAttributeDefaults",value:function(I){var U={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0,version:2};I._glAttributes===null?I._glAttributes=U:I._glAttributes=Object.assign(U,I._glAttributes)}},{key:"_initContext",value:function(){if(this._pInst._glAttributes.version!==1&&(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)),this.webglVersion=this.drawingContext?u.WEBGL2:u.WEBGL,this._pInst._setProperty("webglVersion",this.webglVersion),this.drawingContext||(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)),this.drawingContext===null)throw new Error("Error creating webgl context");var I=this.drawingContext;I.enable(I.DEPTH_TEST),I.depthFunc(I.LEQUAL),I.viewport(0,0,I.drawingBufferWidth,I.drawingBufferHeight),I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}},{key:"_getParam",value:function(){var I=this.drawingContext;return I.getParameter(I.MAX_TEXTURE_SIZE)}},{key:"_adjustDimensions",value:function(I,U){this._maxTextureSize||(this._maxTextureSize=this._getParam());var K=this._maxTextureSize,K=(c.default.prototype._maxAllowedPixelDimensions,Math.floor(K/this.pixelDensity())),z=Math.min(I,K),K=Math.min(U,K);return z===I&&K===U||console.warn("Warning: The requested width/height exceeds hardware limits. "+"Adjusting dimensions to width: ".concat(z,", height: ").concat(K,".")),{adjustedWidth:z,adjustedHeight:K}}},{key:"_resetContext",value:function(I,U){var z,K=this.width,te=this.height,le=this.canvas.id,ne=this._pInst instanceof c.default.Graphics,le=(ne?((z=this._pInst).canvas.parentNode.removeChild(z.canvas),z.canvas=document.createElement("canvas"),(z._pInst._userNode||document.body).appendChild(z.canvas),c.default.Element.call(z,z.canvas,z._pInst),z.width=K,z.height=te):((z=this.canvas)&&z.parentNode.removeChild(z),(z=document.createElement("canvas")).id=le,(this._pInst._userNode||document.body).appendChild(z),this._pInst.canvas=z,this.canvas=z),new c.default.RendererGL(this._pInst.canvas,this._pInst,!ne));this._pInst._setProperty("_renderer",le),le.resize(K,te),le._applyDefaults(),ne||this._pInst._elements.push(le),typeof U=="function"&&setTimeout(function(){U.apply(window._renderer,I)},0)}},{key:"_update",value:function(){this.uMVMatrix.set(this._curCamera.cameraMatrix),this.ambientLightColors.length=0,this.specularColors=[1,1,1],this.directionalLightDirections.length=0,this.directionalLightDiffuseColors.length=0,this.directionalLightSpecularColors.length=0,this.pointLightPositions.length=0,this.pointLightDiffuseColors.length=0,this.pointLightSpecularColors.length=0,this.spotLightPositions.length=0,this.spotLightDirections.length=0,this.spotLightDiffuseColors.length=0,this.spotLightSpecularColors.length=0,this.spotLightAngle.length=0,this.spotLightConc.length=0,this._enableLighting=!1,this._tint=[255,255,255,255],this.GL.clearStencil(0),this.GL.clear(this.GL.DEPTH_BUFFER_BIT|this.GL.STENCIL_BUFFER_BIT),this.GL.disable(this.GL.STENCIL_TEST)}},{key:"background",value:function(){var K=(K=this._pInst).color.apply(K,arguments),I=K.levels[0]/255,U=K.levels[1]/255,z=K.levels[2]/255,K=K.levels[3]/255;this.clear(I,U,z,K)}},{key:"fill",value:function(I,U,z,K){var te=c.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=te._array,this.drawMode=u.FILL,this._useNormalMaterial=!1,this._tex=null}},{key:"stroke",value:function(I,U,z,K){var te=c.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=te._array}},{key:"strokeCap",value:function(I){this.curStrokeCap=I}},{key:"strokeJoin",value:function(I){this.curStrokeJoin=I}},{key:"getFilterLayer",value:function(){return this.filterLayer||(this.filterLayer=this._pInst.createFramebuffer()),this.filterLayer}},{key:"getFilterLayerTemp",value:function(){return this.filterLayerTemp||(this.filterLayerTemp=this._pInst.createFramebuffer()),this.filterLayerTemp}},{key:"matchSize",value:function(I,U){I.width===U.width&&I.height===U.height||I.resize(U.width,U.height),I.pixelDensity()!==U.pixelDensity()&&I.pixelDensity(U.pixelDensity())}},{key:"filter",value:function(){var I,U,z=this,K=this.getFilterLayer(),te=void 0,ne=void 0,le=(typeof(arguments.length<=0?void 0:arguments[0])=="string"?(ne=arguments.length<=0?void 0:arguments[0],E(I={},u.BLUR,3),E(I,u.POSTERIZE,4),E(I,u.THRESHOLD,.5),te=ne in(I=I)&&(arguments.length<=1?void 0:arguments[1])===void 0?I[ne]:arguments.length<=1?void 0:arguments[1],ne in this.defaultFilterShaders||(this.defaultFilterShaders[ne]=new c.default.Shader(K._renderer,`uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

attribute vec3 aPosition;
// texcoords only come from p5 to vertex shader
// so pass texcoords on to the fragment shader in a varying variable
attribute vec2 aTexCoord;
varying vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`,G[ne])),this.filterShader=this.defaultFilterShaders[ne]):this.filterShader=arguments.length<=0?void 0:arguments[0],this.activeFramebuffer()||this),me=(this.matchSize(K,le),K.draw(function(){return z._pInst.clear()}),[1/(le.width*le.pixelDensity()),1/(le.height*le.pixelDensity())]);ne===u.BLUR?(U=this.getFilterLayerTemp(),this.matchSize(U,le),this._pInst.push(),this._pInst.noStroke(),this._pInst.blendMode(u.BLEND),this._pInst.shader(this.filterShader),this.filterShader.setUniform("texelSize",me),this.filterShader.setUniform("canvasSize",[le.width,le.height]),this.filterShader.setUniform("radius",Math.max(1,te)),U.draw(function(){z.filterShader.setUniform("direction",[1,0]),z.filterShader.setUniform("tex0",le),z._pInst.clear(),z._pInst.shader(z.filterShader),z._pInst.noLights(),z._pInst.plane(le.width,le.height)}),K.draw(function(){z.filterShader.setUniform("direction",[0,1]),z.filterShader.setUniform("tex0",U),z._pInst.clear(),z._pInst.shader(z.filterShader),z._pInst.noLights(),z._pInst.plane(le.width,le.height)}),this._pInst.pop()):K.draw(function(){z._pInst.noStroke(),z._pInst.blendMode(u.BLEND),z._pInst.shader(z.filterShader),z.filterShader.setUniform("tex0",le),z.filterShader.setUniform("texelSize",me),z.filterShader.setUniform("canvasSize",[le.width,le.height]),z.filterShader.setUniform("filterParameter",te),z._pInst.noLights(),z._pInst.plane(le.width,le.height)}),this._pInst.push(),this._pInst.noStroke(),this.clear(),this._pInst.push(),this._pInst.imageMode(u.CORNER),this._pInst.blendMode(u.BLEND),le.filterCamera._resize(),this._pInst.setCamera(le.filterCamera),this._pInst.resetMatrix(),this._pInst.image(K,-le.width/2,-le.height/2,le.width,le.height),this._pInst.clearDepth(),this._pInst.pop(),this._pInst.pop()}},{key:"pixelDensity",value:function(I){return I?this._pInst.pixelDensity(I):this._pInst.pixelDensity()}},{key:"blendMode",value:function(I){I===u.DARKEST||I===u.LIGHTEST||I===u.ADD||I===u.BLEND||I===u.SUBTRACT||I===u.SCREEN||I===u.EXCLUSION||I===u.REPLACE||I===u.MULTIPLY||I===u.REMOVE?this.curBlendMode=I:I!==u.BURN&&I!==u.OVERLAY&&I!==u.HARD_LIGHT&&I!==u.SOFT_LIGHT&&I!==u.DODGE||console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}},{key:"erase",value:function(I,U){this._isErasing||(this.preEraseBlend=this.curBlendMode,this._isErasing=!0,this.blendMode(u.REMOVE),this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,I/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,U/255])}},{key:"noErase",value:function(){this._isErasing&&(this.curFillColor=this._cachedFillStyle.slice(),this.curStrokeColor=this._cachedStrokeStyle.slice(),this.curBlendMode=this.preEraseBlend,this.blendMode(this.preEraseBlend),this._isErasing=!1,this._applyBlendMode())}},{key:"drawTarget",value:function(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||this}},{key:"beginClip",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},I=(y(w(ae.prototype),"beginClip",this).call(this,I),this.drawTarget()._isClipApplied=!0,this.GL);I.clearStencil(0),I.clear(I.STENCIL_BUFFER_BIT),I.enable(I.STENCIL_TEST),this._stencilTestOn=!0,I.stencilFunc(I.ALWAYS,1,255),I.stencilOp(I.KEEP,I.KEEP,I.REPLACE),I.disable(I.DEPTH_TEST),this._pInst.push(),this._pInst.resetShader(),this._doFill&&this._pInst.fill(0,0),this._doStroke&&this._pInst.stroke(0,0)}},{key:"endClip",value:function(){this._pInst.pop();var I=this.GL;I.stencilOp(I.KEEP,I.KEEP,I.KEEP),I.stencilFunc(this._clipInvert?I.EQUAL:I.NOTEQUAL,0,255),I.enable(I.DEPTH_TEST),this._clipDepths.push(this._pushPopDepth),y(w(ae.prototype),"endClip",this).call(this)}},{key:"_clearClip",value:function(){this.GL.clearStencil(1),this.GL.clear(this.GL.STENCIL_BUFFER_BIT),0<this._clipDepths.length&&this._clipDepths.pop(),this.drawTarget()._isClipApplied=!1}},{key:"strokeWeight",value:function(I){this.curStrokeWeight!==I&&(this.pointSize=I,this.curStrokeWeight=I)}},{key:"_getPixel",value:function(I,U){var z=this.GL;return W(z,null,I,U,z.RGBA,z.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}},{key:"loadPixels",value:function(){var I,U,z=this._pixelsState;this._pInst._glAttributes.preserveDrawingBuffer!==!0?console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true."):(I=this._pInst._pixelDensity,U=this.GL,z._setProperty("pixels",X(z.pixels,U,null,0,0,this.width*I,this.height*I,U.RGBA,U.UNSIGNED_BYTE,this.height*I)))}},{key:"updatePixels",value:function(){var I=this._getTempFramebuffer();I.pixels=this._pixelsState.pixels,I.updatePixels(),this._pInst.push(),this._pInst.resetMatrix(),this._pInst.clear(),this._pInst.imageMode(u.CENTER),this._pInst.image(I,0,0),this._pInst.pop(),this.GL.clearDepth(1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"_getTempFramebuffer",value:function(){return this._tempFramebuffer||(this._tempFramebuffer=this._pInst.createFramebuffer({format:u.UNSIGNED_BYTE,useDepth:this._pInst._glAttributes.depth,depthFormat:u.UNSIGNED_INT,antialias:this._pInst._glAttributes.antialias})),this._tempFramebuffer}},{key:"geometryInHash",value:function(I){return this.retainedMode.geometry[I]!==void 0}},{key:"viewport",value:function(I,U){this._viewport=[0,0,I,U],this.GL.viewport(0,0,I,U)}},{key:"resize",value:function(te,K){c.default.Renderer.prototype.resize.call(this,te,K),this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this._curCamera._resize();var te=this._pixelsState,z=(te.pixels!==void 0&&te._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4)),!0),K=!1,te=void 0;try{for(var ne,le=this.framebuffers[Symbol.iterator]();!(z=(ne=le.next()).done);z=!0)ne.value._canvasSizeChanged()}catch(me){K=!0,te=me}finally{try{z||le.return==null||le.return()}finally{if(K)throw te}}}},{key:"clear",value:function(){var I=(arguments.length<=0?void 0:arguments[0])||0,U=(arguments.length<=1?void 0:arguments[1])||0,z=(arguments.length<=2?void 0:arguments[2])||0,K=(arguments.length<=3?void 0:arguments[3])||0,te=this.activeFramebuffer();te&&te.format===u.UNSIGNED_BYTE&&!te.antialias&&K===0&&(K=1e-10),this.GL.clearColor(I*K,U*K,z*K,K),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}},{key:"clearDepth",value:function(){this.GL.clearDepth(0<arguments.length&&arguments[0]!==void 0?arguments[0]:1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"applyMatrix",value:function(I,U,z,K,te,ne){arguments.length===16?c.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments):this.uMVMatrix.apply([I,U,0,0,z,K,0,0,0,0,1,0,te,ne,0,1])}},{key:"translate",value:function(I,U,z){return I instanceof c.default.Vector&&(z=I.z,U=I.y,I=I.x),this.uMVMatrix.translate([I,U,z]),this}},{key:"scale",value:function(I,U,z){return this.uMVMatrix.scale(I,U,z),this}},{key:"rotate",value:function(I,U){return U===void 0?this.rotateZ(I):(c.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments),this)}},{key:"rotateX",value:function(I){return this.rotate(I,1,0,0),this}},{key:"rotateY",value:function(I){return this.rotate(I,0,1,0),this}},{key:"rotateZ",value:function(I){return this.rotate(I,0,0,1),this}},{key:"push",value:function(){var I=c.default.Renderer.prototype.push.apply(this),U=I.properties;return U.uMVMatrix=this.uMVMatrix.copy(),U.uPMatrix=this.uPMatrix.copy(),U._curCamera=this._curCamera,this._curCamera=this._curCamera.copy(),U.ambientLightColors=this.ambientLightColors.slice(),U.specularColors=this.specularColors.slice(),U.directionalLightDirections=this.directionalLightDirections.slice(),U.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice(),U.directionalLightSpecularColors=this.directionalLightSpecularColors.slice(),U.pointLightPositions=this.pointLightPositions.slice(),U.pointLightDiffuseColors=this.pointLightDiffuseColors.slice(),U.pointLightSpecularColors=this.pointLightSpecularColors.slice(),U.spotLightPositions=this.spotLightPositions.slice(),U.spotLightDirections=this.spotLightDirections.slice(),U.spotLightDiffuseColors=this.spotLightDiffuseColors.slice(),U.spotLightSpecularColors=this.spotLightSpecularColors.slice(),U.spotLightAngle=this.spotLightAngle.slice(),U.spotLightConc=this.spotLightConc.slice(),U.userFillShader=this.userFillShader,U.userStrokeShader=this.userStrokeShader,U.userPointShader=this.userPointShader,U.pointSize=this.pointSize,U.curStrokeWeight=this.curStrokeWeight,U.curStrokeColor=this.curStrokeColor,U.curFillColor=this.curFillColor,U.curAmbientColor=this.curAmbientColor,U.curSpecularColor=this.curSpecularColor,U.curEmissiveColor=this.curEmissiveColor,U._hasSetAmbient=this._hasSetAmbient,U._useSpecularMaterial=this._useSpecularMaterial,U._useEmissiveMaterial=this._useEmissiveMaterial,U._useShininess=this._useShininess,U._useMetalness=this._useMetalness,U.constantAttenuation=this.constantAttenuation,U.linearAttenuation=this.linearAttenuation,U.quadraticAttenuation=this.quadraticAttenuation,U._enableLighting=this._enableLighting,U._useNormalMaterial=this._useNormalMaterial,U._tex=this._tex,U.drawMode=this.drawMode,U._currentNormal=this._currentNormal,U.curBlendMode=this.curBlendMode,U.activeImageLight=this.activeImageLight,I}},{key:"pop",value:function(){var I;0<this._clipDepths.length&&this._pushPopDepth===this._clipDepths[this._clipDepths.length-1]&&this._clearClip();for(var U=arguments.length,z=new Array(U),K=0;K<U;K++)z[K]=arguments[K];(I=y(w(ae.prototype),"pop",this)).call.apply(I,[this].concat(z)),this._applyStencilTestIfClipping()}},{key:"_applyStencilTestIfClipping",value:function(){var I=this.drawTarget();I._isClipApplied!==this._stencilTestOn&&(I._isClipApplied?(this.GL.enable(this.GL.STENCIL_TEST),this._stencilTestOn=!0):(this.GL.disable(this.GL.STENCIL_TEST),this._stencilTestOn=!1))}},{key:"resetMatrix",value:function(){return this.uMVMatrix.set(this._curCamera.cameraMatrix),this}},{key:"_getImmediateStrokeShader",value:function(){var I=this.userStrokeShader;return I&&I.isStrokeShader()?I:this._getLineShader()}},{key:"_getRetainedStrokeShader",value:function(){return this._getImmediateStrokeShader()}},{key:"_getSphereMapping",value:function(I){return this.sphereMapping||(this.sphereMapping=this._pInst.createFilterShader($)),this.uNMatrix.inverseTranspose(this.uMVMatrix),this.uNMatrix.invert3x3(this.uNMatrix),this.sphereMapping.setUniform("uFovY",this._curCamera.cameraFOV),this.sphereMapping.setUniform("uAspect",this._curCamera.aspectRatio),this.sphereMapping.setUniform("uNewNormalMatrix",this.uNMatrix.mat3),this.sphereMapping.setUniform("uSampler",I),this.sphereMapping}},{key:"_getImmediateFillShader",value:function(){var I=this.userFillShader;if(this._useNormalMaterial&&(!I||!I.isNormalShader()))return this._getNormalShader();if(this._enableLighting){if(!I||!I.isLightShader())return this._getLightShader()}else if(this._tex){if(!I||!I.isTextureShader())return this._getLightShader()}else if(!I)return this._getImmediateModeShader();return I}},{key:"_getRetainedFillShader",value:function(){if(this._useNormalMaterial)return this._getNormalShader();var I=this.userFillShader;if(this._enableLighting){if(!I||!I.isLightShader())return this._getLightShader()}else if(this._tex){if(!I||!I.isTextureShader())return this._getLightShader()}else if(!I)return this._getColorShader();return I}},{key:"_getImmediatePointShader",value:function(){var I=this.userPointShader;return I&&I.isPointShader()?I:this._getPointShader()}},{key:"_getRetainedLineShader",value:function(){return this._getImmediateLineShader()}},{key:"_getLightShader",value:function(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+N.phongVert,this._webGL2CompatibilityPrefix("frag","highp")+N.phongFrag):this._defaultLightShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+N.lightVert,this._webGL2CompatibilityPrefix("frag","highp")+N.lightTextureFrag)),this._defaultLightShader}},{key:"_getImmediateModeShader",value:function(){return this._defaultImmediateModeShader||(this._defaultImmediateModeShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.immediateVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.vertexColorFrag)),this._defaultImmediateModeShader}},{key:"_getNormalShader",value:function(){return this._defaultNormalShader||(this._defaultNormalShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.normalFrag)),this._defaultNormalShader}},{key:"_getColorShader",value:function(){return this._defaultColorShader||(this._defaultColorShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.basicFrag)),this._defaultColorShader}},{key:"_getPointShader",value:function(){return this._defaultPointShader||(this._defaultPointShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.pointVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.pointFrag)),this._defaultPointShader}},{key:"_getLineShader",value:function(){return this._defaultLineShader||(this._defaultLineShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.lineVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.lineFrag)),this._defaultLineShader}},{key:"_getFontShader",value:function(){return this._defaultFontShader||(this.webglVersion===u.WEBGL&&this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+N.fontVert,this._webGL2CompatibilityPrefix("frag","mediump")+N.fontFrag)),this._defaultFontShader}},{key:"_webGL2CompatibilityPrefix",value:function(I,U){var z="";return this.webglVersion===u.WEBGL2&&(z+=`#version 300 es
#define WEBGL2
`),I==="vert"?z+=`#define VERTEX_SHADER
`:I==="frag"&&(z+=`#define FRAGMENT_SHADER
`),U&&(z+="precision ".concat(U,` float;
`)),z}},{key:"_getEmptyTexture",value:function(){var I;return this._emptyTexture||((I=new c.default.Image(1,1)).set(0,0,255),this._emptyTexture=new c.default.Texture(this,I)),this._emptyTexture}},{key:"getTexture",value:function(I){I instanceof c.default.Framebuffer&&(I=I.color);var U=this.textures.get(I);return U||(U=new c.default.Texture(this,I),this.textures.set(I,U),U)}},{key:"getDiffusedTexture",value:function(I){var U,z,K=this;return this.diffusedTextures.get(I)!=null?this.diffusedTextures.get(I):(U=Math.floor(I.height/I.width*200),z=this._pInst.createFramebuffer({width:200,height:U,density:1}),this.diffusedShader||(this.diffusedShader=this._pInst.createShader(N.imageLightVert,N.imageLightDiffusedFrag)),z.draw(function(){K._pInst.shader(K.diffusedShader),K.diffusedShader.setUniform("environmentMap",I),K._pInst.noStroke(),K._pInst.rectMode(u.CENTER),K._pInst.noLights(),K._pInst.rect(0,0,200,U)}),this.diffusedTextures.set(I,z),z)}},{key:"getSpecularTexture",value:function(I){var U=this;if(this.specularTextures.get(I)!=null)return this.specularTextures.get(I);for(var z,K=[],te=this._pInst.createFramebuffer({width:512,height:512,density:1}),ne=Math.log(512)/Math.log(2),le=(this.specularShader||(this.specularShader=this._pInst.createShader(N.imageLightVert,N.imageLightSpecularFrag)),512);1<=le;le/=2)(function(me){te.resize(me,me);var ce=1-Math.log(me)/Math.log(2)/ne;te.draw(function(){U._pInst.shader(U.specularShader),U._pInst.clear(),U.specularShader.setUniform("environmentMap",I),U.specularShader.setUniform("roughness",ce),U._pInst.noStroke(),U._pInst.noLights(),U._pInst.plane(me,me)}),K.push(te.get().drawingContext.getImageData(0,0,me,me))})(le);return te.remove(),z=new d.MipmapTexture(this,K,{}),this.specularTextures.set(I,z),z}},{key:"activeFramebuffer",value:function(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||null}},{key:"createFramebuffer",value:function(I){return new c.default.Framebuffer(this,I)}},{key:"_setStrokeUniforms",value:function(I){I.bindShader(),I.setUniform("uUseLineColor",this._useLineColor),I.setUniform("uMaterialColor",this.curStrokeColor),I.setUniform("uStrokeWeight",this.curStrokeWeight),I.setUniform("uStrokeCap",O[this.curStrokeCap]),I.setUniform("uStrokeJoin",k[this.curStrokeJoin])}},{key:"_setFillUniforms",value:function(I){var U=this,z=(I.bindShader(),this.mixedSpecularColor=g(this.curSpecularColor),0<this._useMetalness&&(this.mixedSpecularColor=this.mixedSpecularColor.map(function(K,te){return U.curFillColor[te]*U._useMetalness+K*(1-U._useMetalness)})),I.setUniform("uUseVertexColor",this._useVertexColor),I.setUniform("uMaterialColor",this.curFillColor),I.setUniform("isTexture",!!this._tex),this._tex&&I.setUniform("uSampler",this._tex),I.setUniform("uTint",this._tint),I.setUniform("uHasSetAmbient",this._hasSetAmbient),I.setUniform("uAmbientMatColor",this.curAmbientColor),I.setUniform("uSpecularMatColor",this.mixedSpecularColor),I.setUniform("uEmissiveMatColor",this.curEmissiveColor),I.setUniform("uSpecular",this._useSpecularMaterial),I.setUniform("uEmissive",this._useEmissiveMaterial),I.setUniform("uShininess",this._useShininess),I.setUniform("metallic",this._useMetalness),this._setImageLightUniforms(I),I.setUniform("uUseLighting",this._enableLighting),this.pointLightDiffuseColors.length/3),z=(I.setUniform("uPointLightCount",z),I.setUniform("uPointLightLocation",this.pointLightPositions),I.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors),I.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors),this.directionalLightDiffuseColors.length/3),z=(I.setUniform("uDirectionalLightCount",z),I.setUniform("uLightingDirection",this.directionalLightDirections),I.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors),I.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors),this.ambientLightColors.length/3),z=(this.mixedAmbientLight=g(this.ambientLightColors),0<this._useMetalness&&(this.mixedAmbientLight=this.mixedAmbientLight.map(function(K){return K-=U._useMetalness,Math.max(0,K)})),I.setUniform("uAmbientLightCount",z),I.setUniform("uAmbientColor",this.mixedAmbientLight),this.spotLightDiffuseColors.length/3);I.setUniform("uSpotLightCount",z),I.setUniform("uSpotLightAngle",this.spotLightAngle),I.setUniform("uSpotLightConc",this.spotLightConc),I.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors),I.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors),I.setUniform("uSpotLightLocation",this.spotLightPositions),I.setUniform("uSpotLightDirection",this.spotLightDirections),I.setUniform("uConstantAttenuation",this.constantAttenuation),I.setUniform("uLinearAttenuation",this.linearAttenuation),I.setUniform("uQuadraticAttenuation",this.quadraticAttenuation),I.bindTextures()}},{key:"_setImageLightUniforms",value:function(I){var U,z;I.setUniform("uUseImageLight",this.activeImageLight!=null),this.activeImageLight&&(U=this.getDiffusedTexture(this.activeImageLight),I.setUniform("environmentMapDiffused",U),U=this.getSpecularTexture(this.activeImageLight),z=20/this._useShininess,I.setUniform("levelOfDetail",8*z),I.setUniform("environmentMapSpecular",U))}},{key:"_setPointUniforms",value:function(I){I.bindShader(),I.setUniform("uMaterialColor",this.curStrokeColor),I.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)}},{key:"_bindBuffer",value:function(I,U,z,K,te){U=U||this.GL.ARRAY_BUFFER,this.GL.bindBuffer(U,I),z!==void 0&&((I=z)instanceof c.default.DataArray?I=z.dataArray():I instanceof(K||Float32Array)||(I=new(K||Float32Array)(I)),this.GL.bufferData(U,I,te||this.GL.STATIC_DRAW))}},{key:"_arraysEqual",value:function(I,U){return I.length===U.length&&I.every(function(z,K){return z===U[K]})}},{key:"_isTypedArray",value:function(I){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some(function(U){return I instanceof U})}},{key:"_flatten",value:function(I){return I.flat()}},{key:"_vToNArray",value:function(I){return I.flatMap(function(U){return[U.x,U.y,U.z]})}},{key:"_bezierCoefficients",value:function(I){var U=I*I,z=1-I,K=z*z;return[K*z,3*K*I,3*z*U,U*I]}},{key:"_quadraticCoefficients",value:function(I){var U=1-I;return[U*U,2*U*I,I*I]}},{key:"_bezierToCatmull",value:function(I){return[I[1],I[1]+(I[2]-I[0])/this._curveTightness,I[2]-(I[3]-I[1])/this._curveTightness,I[2]]}},{key:"_initTessy",value:function(){var I=new h.default.GluTesselator;return I.gluTessCallback(h.default.gluEnum.GLU_TESS_VERTEX_DATA,function(U,z){var K=!0,te=!1,ne=void 0;try{for(var le,me=U[Symbol.iterator]();!(K=(le=me.next()).done);K=!0){var ce=le.value;z.push(ce)}}catch(ge){te=!0,ne=ge}finally{try{K||me.return==null||me.return()}finally{if(te)throw ne}}}),I.gluTessCallback(h.default.gluEnum.GLU_TESS_BEGIN,function(U){U!==h.default.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: ".concat(U))}),I.gluTessCallback(h.default.gluEnum.GLU_TESS_ERROR,function(U){console.log("error callback"),console.log("error number: ".concat(U))}),I.gluTessCallback(h.default.gluEnum.GLU_TESS_COMBINE,function(U,z,K){for(var te=new Array(c.default.RendererGL.prototype.tessyVertexSize).fill(0),ne=0;ne<K.length;ne++)for(var le=0;le<te.length;le++)K[ne]!==0&&z[ne]&&(te[le]+=z[ne][le]*K[ne]);return te}),I.gluTessCallback(h.default.gluEnum.GLU_TESS_EDGE_FLAG,function(U){}),I.gluTessProperty(h.default.gluEnum.GLU_TESS_WINDING_RULE,h.default.windingRule.GLU_TESS_WINDING_NONZERO),I}},{key:"_triangulate",value:function(I){var U=I[0]?I[0][2]:void 0,z=!0,K=!0,ce=!1,pe=void 0;try{for(var te,ne=I[Symbol.iterator]();!(K=(te=ne.next()).done);K=!0)for(var le=te.value,me=0;me<le.length;me+=c.default.RendererGL.prototype.tessyVertexSize)if(le[me+2]!==U){z=!1;break}}catch(Oe){ce=!0,pe=Oe}finally{try{K||ne.return==null||ne.return()}finally{if(ce)throw pe}}z?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0);var ce=[],ge=(this._tessy.gluTessBeginPolygon(ce),!0),pe=!1,oe=void 0;try{for(var de,xe=I[Symbol.iterator]();!(ge=(de=xe.next()).done);ge=!0){var Te=de.value;this._tessy.gluTessBeginContour();for(var Se=0;Se<Te.length;Se+=c.default.RendererGL.prototype.tessyVertexSize){var je=Te.slice(Se,Se+c.default.RendererGL.prototype.tessyVertexSize);this._tessy.gluTessVertex(je,je)}this._tessy.gluTessEndContour()}}catch(Oe){pe=!0,oe=Oe}finally{try{ge||xe.return==null||xe.return()}finally{if(pe)throw oe}}return this._tessy.gluTessEndPolygon(),ce}}])&&b(q.prototype,V),ae}(c.default.Renderer),c.default.prototype._assert3d=function(V){if(!this._renderer.isP3D)throw new Error("".concat(V,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))},c.default.RendererGL.prototype.tessyVertexSize=12,A=c.default.RendererGL,i.default=A},{"../core/constants":269,"../core/main":280,"../core/p5.Renderer":283,"./GeometryBuilder":324,"./p5.Camera":329,"./p5.Framebuffer":331,"./p5.Matrix":333,"./p5.Shader":338,"./p5.Texture":339,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.copy-within":153,"core-js/modules/es.array.every":154,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.flat":159,"core-js/modules/es.array.flat-map":158,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.array.unscopables.flat":172,"core-js/modules/es.array.unscopables.flat-map":171,"core-js/modules/es.map":174,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.float64-array":217,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.int16-array":221,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint16-array":237,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,libtess:252,path:255}],338:[function(r,s,i){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}a.default.Shader=function(){function c(h,d,p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._renderer=h,this._vertSrc=d,this._fragSrc=p,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[]}var u,f;return u=c,(f=[{key:"init",value:function(){if(this._glProgram===0){var h=this._renderer.GL;if(this._vertShader=h.createShader(h.VERTEX_SHADER),h.shaderSource(this._vertShader,this._vertSrc),h.compileShader(this._vertShader),!h.getShaderParameter(this._vertShader,h.COMPILE_STATUS))return a.default._friendlyError("Yikes! An error occurred compiling the vertex shader:".concat(h.getShaderInfoLog(this._vertShader))),null;if(this._fragShader=h.createShader(h.FRAGMENT_SHADER),h.shaderSource(this._fragShader,this._fragSrc),h.compileShader(this._fragShader),!h.getShaderParameter(this._fragShader,h.COMPILE_STATUS))return a.default._friendlyError("Darn! An error occurred compiling the fragment shader:".concat(h.getShaderInfoLog(this._fragShader))),null;this._glProgram=h.createProgram(),h.attachShader(this._glProgram,this._vertShader),h.attachShader(this._glProgram,this._fragShader),h.linkProgram(this._glProgram),h.getProgramParameter(this._glProgram,h.LINK_STATUS)||a.default._friendlyError("Snap! Error linking shader program: ".concat(h.getProgramInfoLog(this._glProgram))),this._loadAttributes(),this._loadUniforms()}return this}},{key:"copyToContext",value:function(h){var d=new a.default.Shader(h._renderer,this._vertSrc,this._fragSrc);return d.ensureCompiledOnContext(h),d}},{key:"ensureCompiledOnContext",value:function(h){if(this._glProgram!==0&&this._renderer!==h._renderer)throw new Error("The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?");this._glProgram===0&&(this._renderer=h._renderer,this.init())}},{key:"_loadAttributes",value:function(){if(!this._loadedAttributes){this.attributes={};for(var h=this._renderer.GL,d=h.getProgramParameter(this._glProgram,h.ACTIVE_ATTRIBUTES),p=0;p<d;++p){var m=h.getActiveAttrib(this._glProgram,p),g=m.name,b=h.getAttribLocation(this._glProgram,g),y={};y.name=g,y.location=b,y.index=p,y.type=m.type,y.size=m.size,this.attributes[g]=y}this._loadedAttributes=!0}}},{key:"_loadUniforms",value:function(){if(!this._loadedUniforms){for(var h=this._renderer.GL,d=h.getProgramParameter(this._glProgram,h.ACTIVE_UNIFORMS),p=0,m=0;m<d;++m){var g=h.getActiveUniform(this._glProgram,m),b={},y=(b.location=h.getUniformLocation(this._glProgram,g.name),b.size=g.size,g.name);1<g.size&&(y=y.substring(0,y.indexOf("[0]"))),b.name=y,b.type=g.type,b._cachedData=void 0,b.type===h.SAMPLER_2D&&(b.samplerIndex=p,p++,this.samplers.push(b)),b.isArray=1<g.size||b.type===h.FLOAT_MAT3||b.type===h.FLOAT_MAT4||b.type===h.FLOAT_VEC2||b.type===h.FLOAT_VEC3||b.type===h.FLOAT_VEC4||b.type===h.INT_VEC2||b.type===h.INT_VEC4||b.type===h.INT_VEC3,this.uniforms[y]=b}this._loadedUniforms=!0}}},{key:"compile",value:function(){}},{key:"bindShader",value:function(){this.init(),this._bound||(this.useProgram(),this._bound=!0,this._setMatrixUniforms(),this.setUniform("uViewport",this._renderer._viewport))}},{key:"unbindShader",value:function(){return this._bound&&(this.unbindTextures(),this._bound=!1),this}},{key:"bindTextures",value:function(){var h=this._renderer.GL,d=!0,p=!1,m=void 0;try{for(var g,b=this.samplers[Symbol.iterator]();!(d=(g=b.next()).done);d=!0){var y=g.value,v=y.texture;v===void 0&&(v=this._renderer._getEmptyTexture()),h.activeTexture(h.TEXTURE0+y.samplerIndex),v.bindTexture(),v.update(),h.uniform1i(y.location,y.samplerIndex)}}catch(x){p=!0,m=x}finally{try{d||b.return==null||b.return()}finally{if(p)throw m}}}},{key:"updateTextures",value:function(){var h=!0,d=!1,p=void 0;try{for(var m,g=this.samplers[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var b=m.value.texture;b&&b.update()}}catch(y){d=!0,p=y}finally{try{h||g.return==null||g.return()}finally{if(d)throw p}}}},{key:"unbindTextures",value:function(){var h=!0,d=!1,p=void 0;try{for(var m,g=this.samplers[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var b=m.value;this.setUniform(b.name,this._renderer._getEmptyTexture())}}catch(y){d=!0,p=y}finally{try{h||g.return==null||g.return()}finally{if(d)throw p}}}},{key:"_setMatrixUniforms",value:function(){var h=this._renderer._curCamera.cameraMatrix,d=this._renderer.uPMatrix,p=this._renderer.uMVMatrix,m=p.copy();m.mult(d),this.isStrokeShader()&&this.setUniform("uPerspective",this._renderer._curCamera.useLinePerspective?1:0),this.setUniform("uViewMatrix",h.mat4),this.setUniform("uProjectionMatrix",d.mat4),this.setUniform("uModelViewMatrix",p.mat4),this.setUniform("uModelViewProjectionMatrix",m.mat4),this.uniforms.uNormalMatrix&&(this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix),this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3)),this.uniforms.uCameraRotation&&(this._renderer.curMatrix.inverseTranspose(this._renderer._curCamera.cameraMatrix),this.setUniform("uCameraRotation",this._renderer.curMatrix.mat3))}},{key:"useProgram",value:function(){var h=this._renderer.GL;return this._renderer._curShader!==this&&(h.useProgram(this._glProgram),this._renderer._curShader=this),this}},{key:"setUniform",value:function(h,d){var p=this.uniforms[h];if(p){var m=this._renderer.GL;if(p.isArray){if(p._cachedData&&this._renderer._arraysEqual(p._cachedData,d))return;p._cachedData=d.slice(0)}else{if(p._cachedData&&p._cachedData===d)return;Array.isArray(d)?p._cachedData=d.slice(0):p._cachedData=d}var g=p.location;switch(this.useProgram(),p.type){case m.BOOL:d===!0?m.uniform1i(g,1):m.uniform1i(g,0);break;case m.INT:1<p.size?d.length&&m.uniform1iv(g,d):m.uniform1i(g,d);break;case m.FLOAT:1<p.size?d.length&&m.uniform1fv(g,d):m.uniform1f(g,d);break;case m.FLOAT_MAT3:m.uniformMatrix3fv(g,!1,d);break;case m.FLOAT_MAT4:m.uniformMatrix4fv(g,!1,d);break;case m.FLOAT_VEC2:1<p.size?d.length&&m.uniform2fv(g,d):m.uniform2f(g,d[0],d[1]);break;case m.FLOAT_VEC3:1<p.size?d.length&&m.uniform3fv(g,d):m.uniform3f(g,d[0],d[1],d[2]);break;case m.FLOAT_VEC4:1<p.size?d.length&&m.uniform4fv(g,d):m.uniform4f(g,d[0],d[1],d[2],d[3]);break;case m.INT_VEC2:1<p.size?d.length&&m.uniform2iv(g,d):m.uniform2i(g,d[0],d[1]);break;case m.INT_VEC3:1<p.size?d.length&&m.uniform3iv(g,d):m.uniform3i(g,d[0],d[1],d[2]);break;case m.INT_VEC4:1<p.size?d.length&&m.uniform4iv(g,d):m.uniform4i(g,d[0],d[1],d[2],d[3]);break;case m.SAMPLER_2D:m.activeTexture(m.TEXTURE0+p.samplerIndex),p.texture=d instanceof a.default.Texture?d:this._renderer.getTexture(d),m.uniform1i(g,p.samplerIndex),p.texture.src.gifProperties&&p.texture.src._animateGif(this._renderer._pInst)}return this}}},{key:"isLightShader",value:function(){return[this.attributes.aNormal,this.uniforms.uUseLighting,this.uniforms.uAmbientLightCount,this.uniforms.uDirectionalLightCount,this.uniforms.uPointLightCount,this.uniforms.uAmbientColor,this.uniforms.uDirectionalDiffuseColors,this.uniforms.uDirectionalSpecularColors,this.uniforms.uPointLightLocation,this.uniforms.uPointLightDiffuseColors,this.uniforms.uPointLightSpecularColors,this.uniforms.uLightingDirection,this.uniforms.uSpecular].some(function(h){return h!==void 0})}},{key:"isNormalShader",value:function(){return this.attributes.aNormal!==void 0}},{key:"isTextureShader",value:function(){return 0<this.samplers.length}},{key:"isColorShader",value:function(){return this.attributes.aVertexColor!==void 0||this.uniforms.uMaterialColor!==void 0}},{key:"isTexLightShader",value:function(){return this.isLightShader()&&this.isTextureShader()}},{key:"isStrokeShader",value:function(){return this.uniforms.uStrokeWeight!==void 0}},{key:"enableAttrib",value:function(h,d,p,m,g,b){var y;return h&&(h=h.location)!==-1&&(y=this._renderer.GL,this._renderer.registerEnabled.has(h)||(y.enableVertexAttribArray(h),this._renderer.registerEnabled.add(h)),this._renderer.GL.vertexAttribPointer(h,d,p||y.FLOAT,m||!1,g||0,b||0)),this}},{key:"disableRemainingAttributes",value:function(){var h=this,d=!0,p=!1,m=void 0;try{for(var g,b=this._renderer.registerEnabled.values()[Symbol.iterator]();!(d=(g=b.next()).done);d=!0)(function(){var y=g.value;Object.keys(h.attributes).some(function(v){return h.attributes[v].location===y})||(h._renderer.GL.disableVertexAttribArray(y),h._renderer.registerEnabled.delete(y))})()}catch(y){p=!0,m=y}finally{try{d||b.return==null||b.return()}finally{if(p)throw m}}}}])&&l(u.prototype,f),c}(),r=a.default.Shader,i.default=r},{"../core/main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.function.name":173,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],339:[function(r,s,i){function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(x)}function l(x){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(S){return a(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":a(S)})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(i,"__esModule",{value:!0}),i.checkWebGLCapabilities=v,i.default=i.MipmapTexture=void 0;var c=(y=r("../core/main"))&&y.__esModule?y:{default:y},u=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var S=f();if(S&&S.has(x))return S.get(x);var w,E={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in x){var P;Object.prototype.hasOwnProperty.call(x,w)&&((P=j?Object.getOwnPropertyDescriptor(x,w):null)&&(P.get||P.set)?Object.defineProperty(E,w,P):E[w]=x[w])}return E.default=x,S&&S.set(x,E),E}(r("../core/constants"));function f(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,f=function(){return x},x)}function h(x,S){return(h=Object.setPrototypeOf||function(w,E){return w.__proto__=E,w})(x,S)}function d(x){return function(){var S,w=p(x),w=(S=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(S=p(this).constructor,Reflect.construct(w,arguments,S)):w.apply(this,arguments),this);if(!S||l(S)!=="object"&&typeof S!="function"){if(w!==void 0)return w;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return S}}function p(x){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)})(x)}function m(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")}function g(x,S){for(var w=0;w<S.length;w++){var E=S[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}function b(x,S,w){S&&g(x.prototype,S),w&&g(x,w)}c.default.Texture=function(){function x(M,w,P){m(this,x),this._renderer=M;var j=this._renderer.GL,P=(P=P||{},this.src=w,this.glTex=void 0,this.glTarget=j.TEXTURE_2D,this.glFormat=P.format||j.RGBA,this.mipmaps=!1,this.glMinFilter=P.minFilter||j.LINEAR,this.glMagFilter=P.magFilter||j.LINEAR,this.glWrapS=P.wrapS||j.CLAMP_TO_EDGE,this.glWrapT=P.wrapT||j.CLAMP_TO_EDGE,this.glDataType=P.dataType||j.UNSIGNED_BYTE,v(M)),M=(this.glFormat!==j.HALF_FLOAT||P.halfFloat||(console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT."),this.glDataType=j.FLOAT),this.glFormat!==j.HALF_FLOAT||this.glMinFilter!==j.LINEAR&&this.glMagFilter!==j.LINEAR||P.halfFloatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===j.LINEAR&&(this.glMinFilter=j.NEAREST),this.glMagFilter===j.LINEAR&&(this.glMagFilter=j.NEAREST)),this.glFormat!==j.FLOAT||P.float||(console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE."),this.glDataType=j.UNSIGNED_BYTE),this.glFormat!==j.FLOAT||this.glMinFilter!==j.LINEAR&&this.glMagFilter!==j.LINEAR||P.floatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===j.LINEAR&&(this.glMinFilter=j.NEAREST),this.glMagFilter===j.LINEAR&&(this.glMagFilter=j.NEAREST)),this.isSrcMediaElement=c.default.MediaElement!==void 0&&w instanceof c.default.MediaElement,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=c.default.Element!==void 0&&w instanceof c.default.Element&&!(w instanceof c.default.Graphics)&&!(w instanceof c.default.Renderer),this.isSrcP5Image=w instanceof c.default.Image,this.isSrcP5Graphics=w instanceof c.default.Graphics,this.isSrcP5Renderer=w instanceof c.default.Renderer,this.isImageData=typeof ImageData<"u"&&w instanceof ImageData,this.isFramebufferTexture=w instanceof c.default.FramebufferTexture,this._getTextureDataFromSource());return this.width=M.width,this.height=M.height,this.init(M),this}return b(x,[{key:"_getTextureDataFromSource",value:function(){var S;return this.isFramebufferTexture?S=this.src.rawTexture():this.isSrcP5Image?S=this.src.canvas:this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcP5Renderer||this.isSrcHTMLElement?S=this.src.elt:this.isImageData&&(S=this.src),S}},{key:"init",value:function(S){var w,E=this._renderer.GL;this.isFramebufferTexture||(this.glTex=E.createTexture()),this.glWrapS=this._renderer.textureWrapX,this.glWrapT=this._renderer.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,this.glMagFilter),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,this.glMinFilter),this.isFramebufferTexture||(this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata?(w=new Uint8Array([1,1,1,1]),E.texImage2D(this.glTarget,0,E.RGBA,1,1,0,this.glFormat,this.glDataType,w)):E.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,S))}},{key:"update",value:function(){var S,w,E,j=this.src;return j.width!==0&&j.height!==0&&!this.isFramebufferTexture&&(S=this._getTextureDataFromSource(),w=!1,E=this._renderer.GL,S.width!==this.width||S.height!==this.height?(w=!0,this.width=S.width||j.width,this.height=S.height||j.height,this.isSrcP5Image?j.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&j.setModified(!0)):this.isSrcP5Image?j.isModified()&&j.setModified(!(w=!0)):this.isSrcMediaElement?j.isModified()?j.setModified(!(w=!0)):j.loadedmetadata&&this._videoPrevUpdateTime!==j.time()&&(this._videoPrevUpdateTime=j.time(),w=!0):this.isImageData?j._dirty&&(w=!(j._dirty=!1)):w=!0,w&&(this.bindTexture(),E.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,S)),w)}},{key:"bindTexture",value:function(){return this._renderer.GL.bindTexture(this.glTarget,this.getTexture()),this}},{key:"unbindTexture",value:function(){this._renderer.GL.bindTexture(this.glTarget,null)}},{key:"getTexture",value:function(){return this.isFramebufferTexture?this.src.rawTexture():this.glTex}},{key:"setInterpolation",value:function(S,w){var E=this._renderer.GL;this.glMinFilter=this.glFilter(S),this.glMagFilter=this.glFilter(w),this.bindTexture(),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,this.glMinFilter),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()}},{key:"glFilter",value:function(S){var w=this._renderer.GL;return S===u.NEAREST?w.NEAREST:w.LINEAR}},{key:"setWrapMode",value:function(S,w){function E(O){return(O&O-1)==0}var j=this._renderer.GL,M=this._getTextureDataFromSource(),M=M.naturalWidth&&M.naturalHeight?(P=M.naturalWidth,M.naturalHeight):(P=this.width,this.height),P=E(P),M=E(M);S===u.REPEAT?this._renderer.webglVersion===u.WEBGL2||P&&M?this.glWrapS=j.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=j.CLAMP_TO_EDGE):S===u.MIRROR?this._renderer.webglVersion===u.WEBGL2||P&&M?this.glWrapS=j.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=j.CLAMP_TO_EDGE):this.glWrapS=j.CLAMP_TO_EDGE,w===u.REPEAT?this._renderer.webglVersion===u.WEBGL2||P&&M?this.glWrapT=j.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=j.CLAMP_TO_EDGE):w===u.MIRROR?this._renderer.webglVersion===u.WEBGL2||P&&M?this.glWrapT=j.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=j.CLAMP_TO_EDGE):this.glWrapT=j.CLAMP_TO_EDGE,this.bindTexture(),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_S,this.glWrapS),j.texParameteri(j.TEXTURE_2D,j.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()}}]),x}();var y=function(x){var S=E;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(x&&x.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),x&&h(S,x);var w=d(E);function E(j,P,M){return m(this,E),P=(j=w.call(this,j,P,M))._renderer.GL,j.glMinFilter===P.LINEAR&&(j.glMinFilter=P.LINEAR_MIPMAP_LINEAR),j}return b(E,[{key:"glFilter",value:function(j){return this._renderer.GL.LINEAR_MIPMAP_LINEAR}},{key:"_getTextureDataFromSource",value:function(){return this.src}},{key:"init",value:function(j){var P=this._renderer.GL;this.glTex=P.createTexture(),this.bindTexture();for(var M=0;M<j.length;M++)P.texImage2D(this.glTarget,M,this.glFormat,this.glFormat,this.glDataType,j[M]);this.glMinFilter=P.LINEAR_MIPMAP_LINEAR,P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,this.glMagFilter),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,this.glMinFilter),this.unbindTexture()}},{key:"update",value:function(){}}]),E}(c.default.Texture);function v(j){var S=j.GL,j=j.webglVersion,w=j===u.WEBGL2?S.getExtension("EXT_color_buffer_float")&&S.getExtension("EXT_float_blend"):S.getExtension("OES_texture_float"),E=w&&S.getExtension("OES_texture_float_linear"),j=j===u.WEBGL2?S.getExtension("EXT_color_buffer_float"):S.getExtension("OES_texture_half_float");return{float:w,floatLinear:E,halfFloat:j,halfFloatLinear:j&&S.getExtension("OES_texture_half_float_linear")}}i.MipmapTexture=y,r=c.default.Texture,i.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],340:[function(r,s,i){function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(x)}function l(x){return(l=typeof Symbol=="function"&&a(Symbol.iterator)==="symbol"?function(S){return a(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":a(S)})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.sub"),r("core-js/modules/web.dom-collections.iterator");var c,u=(c=r("../core/main"))&&c.__esModule?c:{default:c},f=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var S=h();if(S&&S.has(x))return S.get(x);var w,E={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in x){var P;Object.prototype.hasOwnProperty.call(x,w)&&((P=j?Object.getOwnPropertyDescriptor(x,w):null)&&(P.get||P.set)?Object.defineProperty(E,w,P):E[w]=x[w])}return E.default=x,S&&S.set(x,E),E}(r("../core/constants"));function h(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,h=function(){return x},x)}function d(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")}function p(x,S){for(var w=0;w<S.length;w++){var E=S[w];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(x,E.key,E)}}function m(x,S,w){S&&p(x.prototype,S),w&&p(x,w)}r("./p5.Shader"),r("./p5.RendererGL.Retained"),u.default.RendererGL.prototype._applyTextProperties=function(){},u.default.RendererGL.prototype.textWidth=function(x){return this._isOpenType()?this._textFont._textWidth(x,this._textSize):0};var g=function(){function x(S,w){d(this,x),this.width=S,this.height=w,this.infos=[]}return m(x,[{key:"findImage",value:function(S){var w,E,j=this.width*this.height;if(j<S)throw new Error("font is too complex to render in 3D");for(var P=this.infos.length-1;0<=P;--P){var M=this.infos[P];if(M.index+S<j){E=(w=M).imageData;break}}if(!w){try{E=new ImageData(this.width,this.height)}catch{var O=document.getElementsByTagName("canvas")[0],k=!O,F=(O||((O=document.createElement("canvas")).style.display="none",document.body.appendChild(O)),O.getContext("2d"));F&&(E=F.createImageData(this.width,this.height)),k&&document.body.removeChild(O)}this.infos.push(w={index:0,imageData:E})}return F=w.index,w.index+=S,E._dirty=!0,{imageData:E,index:F}}}]),x}();function b(M,S,w,E,j){var P=M.imageData.data,M=4*M.index++;P[M++]=S,P[M++]=w,P[M++]=E,P[+M]=j}var y=Math.sqrt(3),v=function(){function x(S){d(this,x),this.font=S,this.strokeImageInfos=new g(64,64),this.colDimImageInfos=new g(64,64),this.rowDimImageInfos=new g(64,64),this.colCellImageInfos=new g(64,64),this.rowCellImageInfos=new g(64,64),this.glyphInfos={}}return m(x,[{key:"getGlyphInfo",value:function(S){var w=this.glyphInfos[S.index];if(!w){var E=S.getBoundingBox(),j=E.x1,P=E.y1,M=E.x2-j,O=E.y2-P,k=S.path.commands;if(M==0||O==0||!k.length)return this.glyphInfos[S.index]={};for(var F=[],A=[],N=[],$=8;0<=$;--$)N.push([]);for($=8;0<=$;--$)A.push([]);var G,X,W,V,q=function(){function tt(rt,it,nt,Ce){d(this,tt),this.p0=rt,this.c0=it,this.c1=nt,this.p1=Ce}return m(tt,[{key:"toQuadratic",value:function(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:(3*(this.c0.x+this.c1.x)-(this.p0.x+this.p1.x))/4,cy:(3*(this.c0.y+this.c1.y)-(this.p0.y+this.p1.y))/4}}},{key:"quadError",value:function(){return u.default.Vector.sub(u.default.Vector.sub(this.p1,this.p0),u.default.Vector.mult(u.default.Vector.sub(this.c1,this.c0),3)).mag()/2}},{key:"split",value:function(Ge){var it=u.default.Vector.lerp(this.p0,this.c0,Ge),Ce=u.default.Vector.lerp(this.c0,this.c1,Ge),nt=u.default.Vector.lerp(it,Ce,Ge),Ce=(this.c1=u.default.Vector.lerp(this.c1,this.p1,Ge),this.c0=u.default.Vector.lerp(Ce,this.c1,Ge),u.default.Vector.lerp(nt,this.c0,Ge)),Ge=new tt(this.p0,it,nt,Ce);return this.p0=Ce,Ge}},{key:"splitInflections",value:function(){var rt=u.default.Vector.sub(this.c0,this.p0),it=u.default.Vector.sub(u.default.Vector.sub(this.c1,this.c0),rt),nt=u.default.Vector.sub(u.default.Vector.sub(u.default.Vector.sub(this.p1,this.c1),rt),u.default.Vector.mult(it,2)),Ce=[],Ge=it.x*nt.y-it.y*nt.x;return Ge!==0&&0<=(rt=(nt=rt.x*nt.y-rt.y*nt.x)*nt-4*Ge*(rt.x*it.y-rt.y*it.x))&&(Ge<0&&(Ge=-Ge,nt=-nt),rt=(-nt+(it=Math.sqrt(rt)))/(2*Ge),0<(nt=(-nt-it)/(2*Ge))&&nt<1&&(Ce.push(this.split(nt)),rt=1-(1-rt)/(1-nt)),0<rt&&rt<1&&Ce.push(this.split(rt))),Ce.push(this),Ce}}]),tt}(),J=!0,ae=!1,I=void 0;try{for(var U,z=k[Symbol.iterator]();!(J=(U=z.next()).done);J=!0){var K=U.value,te=(K.x-j)/M,ne=(K.y-P)/O;if(!Fe(G,X,te,ne)){switch(K.type){case"M":W=te,V=ne;break;case"L":We(G,X,te,ne);break;case"Q":var le=(K.x1-j)/M,me=(K.y1-P)/O;je([G,te,le],[X,ne,me],{x:G,y:X,cx:le,cy:me});break;case"Z":Fe(G,X,W,V)?F.push({x:G,y:X}):(We(G,X,W,V),F.push({x:W,y:V}));break;case"C":for(var ce=function(ie,ke,$e,nt,Ce,Ge,Me,re){var ie=new q(new u.default.Vector(ie,ke),new u.default.Vector($e,nt),new u.default.Vector(Ce,Ge),new u.default.Vector(Me,re)).splitInflections(),ee=[],ue=30/y,we=!0,ke=!1,$e=void 0;try{for(var Ke,Qe=ie[Symbol.iterator]();!(we=(Ke=Qe.next()).done);we=!0){for(var et=Ke.value,at=[],Ot=void 0;!(.125<=(Ot=ue/et.quadError()));){var Ct=Math.pow(Ot,.3333333333333333),dt=et.split(Ct),Pt=et.split(1-Ct/(1-Ct));ee.push(dt),at.push(et),et=Pt}Ot<1&&ee.push(et.split(.5)),ee.push(et),Array.prototype.push.apply(ee,at.reverse())}}catch(Et){ke=!0,$e=Et}finally{try{we||Qe.return==null||Qe.return()}finally{if(ke)throw $e}}return ee}(G,X,(K.x1-j)/M,(K.y1-P)/O,(K.x2-j)/M,(K.y2-P)/O,te,ne),ge=0;ge<ce.length;ge++){var pe=ce[ge].toQuadratic();je([pe.x,pe.x1,pe.cx],[pe.y,pe.y1,pe.cy],pe)}break;default:throw new Error("unknown command type: ".concat(K.type))}G=te,X=ne}}}catch(tt){ae=!0,I=tt}finally{try{J||z.return==null||z.return()}finally{if(ae)throw I}}for(var oe=F.length,de=this.strokeImageInfos.findImage(oe),xe=de.index,Te=0;Te<oe;++Te){var Se=F[Te];b(de,Oe(Se.x),Oe(Se.y),Oe(Se.cx),Oe(Se.cy))}(w=this.glyphInfos[S.index]={glyph:S,uGlyphRect:[E.x1,-E.y1,E.x2,-E.y2],strokeImageInfo:de,strokes:F,colInfo:ut(N,this.colDimImageInfos,this.colCellImageInfos),rowInfo:ut(A,this.rowDimImageInfos,this.rowCellImageInfos)}).uGridOffset=[w.colInfo.dimOffset,w.rowInfo.dimOffset]}return w;function je(tt,rt,it){var nt=F.length;function Ce(ee,ue,we){for(var ke=ee.length;0<ke--;){var $e=ee[ke];$e<ue&&(ue=$e),we<$e&&(we=$e)}return{min:ue,max:we}}F.push(it);for(var it=Ce(tt,1,0),tt=Math.max(Math.floor(9*it.min-.5),0),Ge=Math.min(Math.ceil(9*it.max+.5),9),Me=tt;Me<Ge;++Me)N[Me].push(nt);for(var it=Ce(rt,1,0),tt=Math.max(Math.floor(9*it.min-.5),0),re=Math.min(Math.ceil(9*it.max+.5),9),ie=tt;ie<re;++ie)A[ie].push(nt)}function Oe(tt){return(tt=(it=255)*tt)<(rt=0)?rt:it<tt?it:tt;var rt,it}function We(tt,rt,it,nt){je([tt,it],[rt,nt],{x:tt,y:rt,cx:(tt+it)/2,cy:(rt+nt)/2})}function Fe(tt,rt,it,nt){return Math.abs(it-tt)<1e-5&&Math.abs(nt-rt)<1e-5}function ut(tt,rt,it){for(var nt=tt.length,Ce=rt.findImage(nt),rt=Ce.index,Ge=0,Me=0;Me<nt;++Me)Ge+=tt[Me].length;for(var re=it.findImage(Ge),ie=0;ie<nt;++ie){var ee=tt[ie],ue=ee.length,we=re.index;b(Ce,we>>7,127&we,ue>>7,127&ue);for(var ke=0;ke<ue;++ke){var $e=ee[ke]+xe;b(re,$e>>7,127&$e,0,0)}}return{cellImageInfo:re,dimOffset:rt,dimImageInfo:Ce}}}}]),x}();u.default.RendererGL.prototype._renderText=function(x,S,w,E,j){if(this._textFont&&typeof this._textFont!="string"){if(!(j<=E)&&this._doFill){if(this._isOpenType()){x.push();var j=this._doStroke,P=this.drawMode,M=(this._doStroke=!1,this.drawMode=f.TEXTURE,this._textFont.font),O=(O=this._textFont._fontInfo)||(this._textFont._fontInfo=new v(M)),w=this._textFont._handleAlignment(this,S,w,E),E=this._textSize/M.unitsPerEm,k=(this.translate(w.x,w.y,0),this.scale(E,E,1),this.GL),w=!this._defaultFontShader,F=this._getFontShader(),A=(F.init(),F.bindShader(),w&&(F.setUniform("uGridImageSize",[64,64]),F.setUniform("uCellsImageSize",[64,64]),F.setUniform("uStrokeImageSize",[64,64]),F.setUniform("uGridSize",[9,9])),this._applyColorBlend(this.curFillColor),this.retainedMode.geometry.glyph),N=(A||((E=this._textGeom=new u.default.Geometry(1,1,function(){for(var ge=0;ge<=1;ge++)for(var pe=0;pe<=1;pe++)this.vertices.push(new u.default.Vector(pe,ge,0)),this.uvs.push(pe,ge)})).computeFaces().computeNormals(),A=this.createBuffers("glyph",E)),!0),w=!1,E=void 0;try{for(var $,G=this.retainedMode.buffers.text[Symbol.iterator]();!(N=($=G.next()).done);N=!0)$.value._prepareBuffer(A,F)}catch(ge){w=!0,E=ge}finally{try{N||G.return==null||G.return()}finally{if(w)throw E}}this._bindBuffer(A.indexBuffer,k.ELEMENT_ARRAY_BUFFER),F.setUniform("uMaterialColor",this.curFillColor),k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);try{var X=0,W=null,V=M.stringToGlyphs(S),q=!0,J=!1,ae=void 0;try{for(var I,U=V[Symbol.iterator]();!(q=(I=U.next()).done);q=!0){var z,K,te=I.value,ne=(W&&(X+=M.getKerningValue(W,te)),O.getGlyphInfo(te));ne.uGlyphRect&&(z=ne.rowInfo,K=ne.colInfo,F.setUniform("uSamplerStrokes",ne.strokeImageInfo.imageData),F.setUniform("uSamplerRowStrokes",z.cellImageInfo.imageData),F.setUniform("uSamplerRows",z.dimImageInfo.imageData),F.setUniform("uSamplerColStrokes",K.cellImageInfo.imageData),F.setUniform("uSamplerCols",K.dimImageInfo.imageData),F.setUniform("uGridOffset",ne.uGridOffset),F.setUniform("uGlyphRect",ne.uGlyphRect),F.setUniform("uGlyphOffset",X),F.bindTextures(),k.drawElements(k.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)),X+=te.advanceWidth,W=te}}catch(ge){J=!0,ae=ge}finally{try{q||U.return==null||U.return()}finally{if(J)throw ae}}}finally{F.unbindShader(),this._doStroke=j,this.drawMode=P,k.pixelStorei(k.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),x.pop()}}else console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts are supported");return x}}else console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.")}},{"../core/constants":269,"../core/main":280,"./p5.RendererGL.Retained":336,"./p5.Shader":338,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}]},{},[264])(264)})})(F5);var ese=F5.exports;const tse=Xl(ese),rse=`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D img;
uniform sampler2D depth;
uniform vec3 fog;
void main() {
  gl_FragColor = mix(
    // Original color
    texture2D(img, vTexCoord),
    // Fog color
    vec4(fog/255., 1.),
    // Mix between them based on the depth.
    // The pow() makes the light falloff a bit steeper.
    pow(texture2D(depth, vTexCoord).r, 6.)
  );
}`,nse=`precision highp float;
attribute vec3 aPosition;
attribute vec2 aTexCoord;
varying vec2 vTexCoord;
void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  positionVec4.xy = positionVec4.xy * 2.0 - 1.0;
  gl_Position = positionVec4;
  vTexCoord = aTexCoord;
}`;class ose{constructor(o,n){D(this,"editor");D(this,"p5");D(this,"width");D(this,"height");D(this,"underlays",new Map);this.editor=o;for(const r of n){const s=new r(this.editor);this.underlays.set(s.name,s)}this.width=window.innerWidth,this.height=window.innerHeight,this.createDebugUI(),this.p5=new tse(r=>{let s,i;r.preload=()=>{i=r.createShader(nse,rse)},r.setup=()=>{r.createCanvas(this.width,this.height,r.WEBGL),s=r.createFramebuffer({width:r.width,height:r.height})},r.draw=()=>{r.colorMode(r.HSL);const l=this.editor.user.getIsDarkMode()?r.color(220,10,10):r.color("white"),c=this.editor.getCurrentPageShapes();s.begin(),r.clear(),r.lights(),r.scale(1,-1,1);const u=this.editor.getCamera();r.scale(u.z),r.translate(u.x-r.width/2/u.z,u.y-r.height/2/u.z);for(const f of this.underlays.values())f.enabled&&f.render(r,c);s.end(),r.shader(i),i.setUniform("fog",[r.red(l),r.green(l),r.blue(l)]),i.setUniform("img",s.color),i.setUniform("depth",s.depth),r.rect(0,0,r.width,r.height)}})}createDebugUI(){const o=document.createElement("div");o.className="controls",document.body.appendChild(o);for(const n of this.underlays.keys()){const r=document.createElement("button");r.textContent=`${n} 🙈`,r.addEventListener("click",()=>{const s=this.underlays.get(n);s&&(s.enabled=!s.enabled,r.textContent=`${n} ${s.enabled?"🙈":"🙉"}`)}),o.appendChild(r)}}}class sse extends Rw{constructor(){super(...arguments);D(this,"name","Geo")}render(n,r){for(const s of r){n.push(),n.translate(s.x,s.y),n.rotateZ(s.rotation);const i=n.color(190,50,50),a=n.color(190,50,30),l=1e4,c=this.editor.getShapeGeometry(s),u=s.type!=="arrow"&&c.isClosed,f=c.vertices;n.stroke(a),n.fill(i);const h=u?f.length:f.length-1;for(let d=0;d<h;d++){const p=(d+1)%f.length;n.beginShape(),n.vertex(f[d].x,f[d].y,0),n.vertex(f[p].x,f[p].y,0),n.vertex(f[p].x,f[p].y,-l),n.vertex(f[d].x,f[d].y,-l),n.endShape(n.CLOSE)}n.pop()}}}class ise extends Rw{constructor(n){super(n);D(this,"name","History");D(this,"histories");this.histories=new ase(120),n.sideEffects.registerAfterChangeHandler("shape",(r,s)=>{if(!this.enabled)return;const i=this.editor.getShapeGeometry(s).vertices;this.histories.push(s.id,{x:s.x,y:s.y,rotation:s.rotation,vertices:i})})}render(n,r){for(const s of r){const i=this.histories.toArray(s.id);if(!i)continue;const a=n.color(190,50,50),l=n.color(190,50,30);for(let c=i.length-1;c>=0;c--){const u=i[c],h=-50*(i.length-1-c);n.push(),n.translate(u.x,u.y,h),n.rotateZ(u.rotation),n.stroke(l),n.fill(a),n.beginShape();for(const d of u.vertices)n.vertex(d.x,d.y,0);n.endShape(n.CLOSE),n.pop()}}}}class ase{constructor(o){D(this,"buffers");D(this,"capacity");this.capacity=o,this.buffers=new Map}push(o,n){let r=this.buffers.get(o);r||(r=new lse(this.capacity),this.buffers.set(o,r)),r.push(n)}get(o){return this.buffers.get(o)}toArray(o){const n=this.buffers.get(o);return n?n.toArray():void 0}}class lse{constructor(o){D(this,"buffer");D(this,"head",0);D(this,"tail",0);D(this,"length",0);D(this,"capacity");this.capacity=o,this.buffer=new Array(o)}push(o){this.buffer[this.tail]=o,this.tail=(this.tail+1)%this.capacity,this.length<this.capacity?this.length++:this.head=(this.head+1)%this.capacity}toArray(){const o=[];for(let n=0;n<this.length;n++)o.push(this.buffer[(this.head+n)%this.capacity]);return o}}class cse extends Rw{constructor(){super(...arguments);D(this,"name","Edges")}render(n,r){var i,a;let s=null;for(const l of r){if(!s){s=l;continue}const c=(i=this.editor.getShapePageBounds(l))==null?void 0:i.center,u=(a=this.editor.getShapePageBounds(s))==null?void 0:a.center;if(!c||!u)continue;n.push(),n.translate(c.x,c.y);const f=20,h=1e3,d=20,p=n.color(250,50,50);n.stroke(p),n.strokeWeight(d),n.noFill(),n.beginShape();for(let m=0;m<=f;m++){const g=m/f,b=n.lerp(0,u.x-c.x,g),y=n.lerp(0,u.y-c.y,g),v=h*Math.sin(Math.PI*g),x=n.lerpColor(p,n.color("red"),g);n.stroke(x),n.vertex(b,y,-v)}n.endShape(),n.pop(),s=l}}}const use=[sse,ise,cse],SC=document.getElementById("root");SC&&Kv.createRoot(SC).render(C.jsx("div",{className:"tldraw__editor",children:C.jsx(Xoe,{persistenceKey:"tldraw-3d",onMount:t=>{new ose(t,use)}})}));
