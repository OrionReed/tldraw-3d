var YO=Object.defineProperty;var KO=(t,n,o)=>n in t?YO(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var R=(t,n,o)=>(KO(t,typeof n!="symbol"?n+"":n,o),o);var uS,dS,hS,pS,fS,mS,gS,yS,vS,bS,xS,wS,SS,jS,_S,kS,ES,CS,PS,MS;function XO(t,n){for(var o=0;o<n.length;o++){const r=n[o];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ml(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var NS={exports:{}},gp={},US={exports:{}},Vt={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Xu=Symbol.for("react.element"),QO=Symbol.for("react.portal"),ZO=Symbol.for("react.fragment"),JO=Symbol.for("react.strict_mode"),e4=Symbol.for("react.profiler"),t4=Symbol.for("react.provider"),r4=Symbol.for("react.context"),n4=Symbol.for("react.forward_ref"),o4=Symbol.for("react.suspense"),s4=Symbol.for("react.memo"),i4=Symbol.for("react.lazy"),BS=Symbol.iterator;function a4(t){return t===null||typeof t!="object"?null:(t=BS&&t[BS]||t["@@iterator"],typeof t=="function"?t:null)}var zS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GS=Object.assign,VS={};function uc(t,n,o){this.props=t,this.context=n,this.refs=VS,this.updater=o||zS}uc.prototype.isReactComponent={},uc.prototype.setState=function(t,n){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")},uc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function HS(){}HS.prototype=uc.prototype;function qy(t,n,o){this.props=t,this.context=n,this.refs=VS,this.updater=o||zS}var Yy=qy.prototype=new HS;Yy.constructor=qy,GS(Yy,uc.prototype),Yy.isPureReactComponent=!0;var WS=Array.isArray,$S=Object.prototype.hasOwnProperty,Ky={current:null},qS={key:!0,ref:!0,__self:!0,__source:!0};function YS(t,n,o){var r,s={},a=null,i=null;if(n!=null)for(r in n.ref!==void 0&&(i=n.ref),n.key!==void 0&&(a=""+n.key),n)$S.call(n,r)&&!qS.hasOwnProperty(r)&&(s[r]=n[r]);var l=arguments.length-2;if(l===1)s.children=o;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Xu,type:t,key:a,ref:i,props:s,_owner:Ky.current}}function l4(t,n){return{$$typeof:Xu,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function Xy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xu}function c4(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(o){return n[o]})}var KS=/\/+/g;function Qy(t,n){return typeof t=="object"&&t!==null&&t.key!=null?c4(""+t.key):n.toString(36)}function yp(t,n,o,r,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Xu:case QO:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+Qy(i,0):r,WS(s)?(o="",t!=null&&(o=t.replace(KS,"$&/")+"/"),yp(s,n,o,"",function(u){return u})):s!=null&&(Xy(s)&&(s=l4(s,o+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(KS,"$&/")+"/")+t)),n.push(s)),1;if(i=0,r=r===""?".":r+":",WS(t))for(var l=0;l<t.length;l++){a=t[l];var c=r+Qy(a,l);i+=yp(a,n,o,c,s)}else if(c=a4(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=r+Qy(a,l++),i+=yp(a,n,o,c,s);else if(a==="object")throw n=String(t),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return i}function vp(t,n,o){if(t==null)return t;var r=[],s=0;return yp(t,r,"","",function(a){return n.call(o,a,s++)}),r}function u4(t){if(t._status===-1){var n=t._result;n=n(),n.then(function(o){(t._status===0||t._status===-1)&&(t._status=1,t._result=o)},function(o){(t._status===0||t._status===-1)&&(t._status=2,t._result=o)}),t._status===-1&&(t._status=0,t._result=n)}if(t._status===1)return t._result.default;throw t._result}var lo={current:null},bp={transition:null},d4={ReactCurrentDispatcher:lo,ReactCurrentBatchConfig:bp,ReactCurrentOwner:Ky};Vt.Children={map:vp,forEach:function(t,n,o){vp(t,function(){n.apply(this,arguments)},o)},count:function(t){var n=0;return vp(t,function(){n++}),n},toArray:function(t){return vp(t,function(n){return n})||[]},only:function(t){if(!Xy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},Vt.Component=uc,Vt.Fragment=ZO,Vt.Profiler=e4,Vt.PureComponent=qy,Vt.StrictMode=JO,Vt.Suspense=o4,Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d4,Vt.cloneElement=function(t,n,o){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=GS({},t.props),s=t.key,a=t.ref,i=t._owner;if(n!=null){if(n.ref!==void 0&&(a=n.ref,i=Ky.current),n.key!==void 0&&(s=""+n.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in n)$S.call(n,c)&&!qS.hasOwnProperty(c)&&(r[c]=n[c]===void 0&&l!==void 0?l[c]:n[c])}var c=arguments.length-2;if(c===1)r.children=o;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Xu,type:t.type,key:s,ref:a,props:r,_owner:i}},Vt.createContext=function(t){return t={$$typeof:r4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t4,_context:t},t.Consumer=t},Vt.createElement=YS,Vt.createFactory=function(t){var n=YS.bind(null,t);return n.type=t,n},Vt.createRef=function(){return{current:null}},Vt.forwardRef=function(t){return{$$typeof:n4,render:t}},Vt.isValidElement=Xy,Vt.lazy=function(t){return{$$typeof:i4,_payload:{_status:-1,_result:t},_init:u4}},Vt.memo=function(t,n){return{$$typeof:s4,type:t,compare:n===void 0?null:n}},Vt.startTransition=function(t){var n=bp.transition;bp.transition={};try{t()}finally{bp.transition=n}},Vt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Vt.useCallback=function(t,n){return lo.current.useCallback(t,n)},Vt.useContext=function(t){return lo.current.useContext(t)},Vt.useDebugValue=function(){},Vt.useDeferredValue=function(t){return lo.current.useDeferredValue(t)},Vt.useEffect=function(t,n){return lo.current.useEffect(t,n)},Vt.useId=function(){return lo.current.useId()},Vt.useImperativeHandle=function(t,n,o){return lo.current.useImperativeHandle(t,n,o)},Vt.useInsertionEffect=function(t,n){return lo.current.useInsertionEffect(t,n)},Vt.useLayoutEffect=function(t,n){return lo.current.useLayoutEffect(t,n)},Vt.useMemo=function(t,n){return lo.current.useMemo(t,n)},Vt.useReducer=function(t,n,o){return lo.current.useReducer(t,n,o)},Vt.useRef=function(t){return lo.current.useRef(t)},Vt.useState=function(t){return lo.current.useState(t)},Vt.useSyncExternalStore=function(t,n,o){return lo.current.useSyncExternalStore(t,n,o)},Vt.useTransition=function(){return lo.current.useTransition()},Vt.version="18.2.0",US.exports=Vt;var z=US.exports;const Bt=ml(z),h4=XO({__proto__:null,default:Bt},[z]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var p4=z,f4=Symbol.for("react.element"),m4=Symbol.for("react.fragment"),g4=Object.prototype.hasOwnProperty,y4=p4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v4={key:!0,ref:!0,__self:!0,__source:!0};function XS(t,n,o){var r,s={},a=null,i=null;o!==void 0&&(a=""+o),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(i=n.ref);for(r in n)g4.call(n,r)&&!v4.hasOwnProperty(r)&&(s[r]=n[r]);if(t&&t.defaultProps)for(r in n=t.defaultProps,n)s[r]===void 0&&(s[r]=n[r]);return{$$typeof:f4,type:t,key:a,ref:i,props:s,_owner:y4.current}}gp.Fragment=m4,gp.jsx=XS,gp.jsxs=XS,NS.exports=gp;var E=NS.exports,Zy={},QS={exports:{}},Bo={},ZS={exports:{}},JS={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function n($,H){var Q=$.length;$.push(H);e:for(;0<Q;){var J=Q-1>>>1,ae=$[J];if(0<s(ae,H))$[J]=H,$[Q]=ae,Q=J;else break e}}function o($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var H=$[0],Q=$.pop();if(Q!==H){$[0]=Q;e:for(var J=0,ae=$.length,T=ae>>>1;J<T;){var B=2*(J+1)-1,W=$[B],K=B+1,te=$[K];if(0>s(W,Q))K<ae&&0>s(te,W)?($[J]=te,$[K]=Q,J=K):($[J]=W,$[B]=Q,J=B);else if(K<ae&&0>s(te,Q))$[J]=te,$[K]=Q,J=K;else break e}}return H}function s($,H){var Q=$.sortIndex-H.sortIndex;return Q!==0?Q:$.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],f=1,h=null,d=3,p=!1,y=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x($){for(var H=o(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=$)r(u),H.sortIndex=H.expirationTime,n(c,H);else break;H=o(u)}}function w($){if(g=!1,x($),!y)if(o(c)!==null)y=!0,G(S);else{var H=o(u);H!==null&&Y(w,H.startTime-$)}}function S($,H){y=!1,g&&(g=!1,m(C),C=-1),p=!0;var Q=d;try{for(x(H),h=o(c);h!==null&&(!(h.expirationTime>H)||$&&!I());){var J=h.callback;if(typeof J=="function"){h.callback=null,d=h.priorityLevel;var ae=J(h.expirationTime<=H);H=t.unstable_now(),typeof ae=="function"?h.callback=ae:h===o(c)&&r(c),x(H)}else r(c);h=o(c)}if(h!==null)var T=!0;else{var B=o(u);B!==null&&Y(w,B.startTime-H),T=!1}return T}finally{h=null,d=Q,p=!1}}var k=!1,_=null,C=-1,P=5,A=-1;function I(){return!(t.unstable_now()-A<P)}function N(){if(_!==null){var $=t.unstable_now();A=$;var H=!0;try{H=_(!0,$)}finally{H?O():(k=!1,_=null)}}else k=!1}var O;if(typeof v=="function")O=function(){v(N)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,U=F.port2;F.port1.onmessage=N,O=function(){U.postMessage(null)}}else O=function(){b(N,0)};function G($){_=$,k||(k=!0,O())}function Y($,H){C=b(function(){$(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){y||p||(y=!0,G(S))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function($){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var Q=d;d=H;try{return $()}finally{d=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,H){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Q=d;d=$;try{return H()}finally{d=Q}},t.unstable_scheduleCallback=function($,H,Q){var J=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?J+Q:J):Q=J,$){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=Q+ae,$={id:f++,callback:H,priorityLevel:$,startTime:Q,expirationTime:ae,sortIndex:-1},Q>J?($.sortIndex=Q,n(u,$),o(c)===null&&$===o(u)&&(g?(m(C),C=-1):g=!0,Y(w,Q-J))):($.sortIndex=ae,n(c,$),y||p||(y=!0,G(S))),$},t.unstable_shouldYield=I,t.unstable_wrapCallback=function($){var H=d;return function(){var Q=d;d=H;try{return $.apply(this,arguments)}finally{d=Q}}}})(JS),ZS.exports=JS;var b4=ZS.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var e2=z,zo=b4;function Je(t){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+t,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t2=new Set,Qu={};function gl(t,n){dc(t,n),dc(t+"Capture",n)}function dc(t,n){for(Qu[t]=n,t=0;t<n.length;t++)t2.add(n[t])}var _i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jy=Object.prototype.hasOwnProperty,x4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r2={},n2={};function w4(t){return Jy.call(n2,t)?!0:Jy.call(r2,t)?!1:x4.test(t)?n2[t]=!0:(r2[t]=!0,!1)}function S4(t,n,o,r){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return r?!1:o!==null?!o.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function j4(t,n,o,r){if(n===null||typeof n>"u"||S4(t,n,o,r))return!0;if(r)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function co(t,n,o,r,s,a,i){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=o,this.propertyName=t,this.type=n,this.sanitizeURL=a,this.removeEmptyString=i}var Pn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Pn[t]=new co(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var n=t[0];Pn[n]=new co(n,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){Pn[t]=new co(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Pn[t]=new co(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Pn[t]=new co(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){Pn[t]=new co(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){Pn[t]=new co(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){Pn[t]=new co(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){Pn[t]=new co(t,5,!1,t.toLowerCase(),null,!1,!1)});var e0=/[\-:]([a-z])/g;function t0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var n=t.replace(e0,t0);Pn[n]=new co(n,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var n=t.replace(e0,t0);Pn[n]=new co(n,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var n=t.replace(e0,t0);Pn[n]=new co(n,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){Pn[t]=new co(t,1,!1,t.toLowerCase(),null,!1,!1)}),Pn.xlinkHref=new co("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){Pn[t]=new co(t,1,!1,t.toLowerCase(),null,!0,!0)});function r0(t,n,o,r){var s=Pn.hasOwnProperty(n)?Pn[n]:null;(s!==null?s.type!==0:r||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(j4(n,o,s,r)&&(o=null),r||s===null?w4(n)&&(o===null?t.removeAttribute(n):t.setAttribute(n,""+o)):s.mustUseProperty?t[s.propertyName]=o===null?s.type===3?!1:"":o:(n=s.attributeName,r=s.attributeNamespace,o===null?t.removeAttribute(n):(s=s.type,o=s===3||s===4&&o===!0?"":""+o,r?t.setAttributeNS(r,n,o):t.setAttribute(n,o))))}var ki=e2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xp=Symbol.for("react.element"),hc=Symbol.for("react.portal"),pc=Symbol.for("react.fragment"),n0=Symbol.for("react.strict_mode"),o0=Symbol.for("react.profiler"),o2=Symbol.for("react.provider"),s2=Symbol.for("react.context"),s0=Symbol.for("react.forward_ref"),i0=Symbol.for("react.suspense"),a0=Symbol.for("react.suspense_list"),l0=Symbol.for("react.memo"),pa=Symbol.for("react.lazy"),i2=Symbol.for("react.offscreen"),a2=Symbol.iterator;function Zu(t){return t===null||typeof t!="object"?null:(t=a2&&t[a2]||t["@@iterator"],typeof t=="function"?t:null)}var Ur=Object.assign,c0;function Ju(t){if(c0===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);c0=n&&n[1]||""}return`
`+c0+t}var u0=!1;function d0(t,n){if(!t||u0)return"";u0=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(u){var r=u}Reflect.construct(t,[],n)}else{try{n.call()}catch(u){r=u}t.call(n.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=r.stack.split(`
`),i=s.length-1,l=a.length-1;1<=i&&0<=l&&s[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==a[l]){var c=`
`+s[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=l);break}}}finally{u0=!1,Error.prepareStackTrace=o}return(t=t?t.displayName||t.name:"")?Ju(t):""}function _4(t){switch(t.tag){case 5:return Ju(t.type);case 16:return Ju("Lazy");case 13:return Ju("Suspense");case 19:return Ju("SuspenseList");case 0:case 2:case 15:return t=d0(t.type,!1),t;case 11:return t=d0(t.type.render,!1),t;case 1:return t=d0(t.type,!0),t;default:return""}}function h0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pc:return"Fragment";case hc:return"Portal";case o0:return"Profiler";case n0:return"StrictMode";case i0:return"Suspense";case a0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case s2:return(t.displayName||"Context")+".Consumer";case o2:return(t._context.displayName||"Context")+".Provider";case s0:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case l0:return n=t.displayName||null,n!==null?n:h0(t.type)||"Memo";case pa:n=t._payload,t=t._init;try{return h0(t(n))}catch{}}return null}function k4(t){var n=t.type;switch(t.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=n.render,t=t.displayName||t.name||"",n.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return h0(n);case 8:return n===n0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function fa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function l2(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function E4(t){var n=l2(t)?"checked":"value",o=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),r=""+t[n];if(!t.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var s=o.get,a=o.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(t,n,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function wp(t){t._valueTracker||(t._valueTracker=E4(t))}function c2(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var o=n.getValue(),r="";return t&&(r=l2(t)?t.checked?"true":"false":t.value),t=r,t!==o?(n.setValue(t),!0):!1}function Sp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function p0(t,n){var o=n.checked;return Ur({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??t._wrapperState.initialChecked})}function u2(t,n){var o=n.defaultValue==null?"":n.defaultValue,r=n.checked!=null?n.checked:n.defaultChecked;o=fa(n.value!=null?n.value:o),t._wrapperState={initialChecked:r,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function d2(t,n){n=n.checked,n!=null&&r0(t,"checked",n,!1)}function f0(t,n){d2(t,n);var o=fa(n.value),r=n.type;if(o!=null)r==="number"?(o===0&&t.value===""||t.value!=o)&&(t.value=""+o):t.value!==""+o&&(t.value=""+o);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}n.hasOwnProperty("value")?m0(t,n.type,o):n.hasOwnProperty("defaultValue")&&m0(t,n.type,fa(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(t.defaultChecked=!!n.defaultChecked)}function h2(t,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var r=n.type;if(!(r!=="submit"&&r!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+t._wrapperState.initialValue,o||n===t.value||(t.value=n),t.defaultValue=n}o=t.name,o!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,o!==""&&(t.name=o)}function m0(t,n,o){(n!=="number"||Sp(t.ownerDocument)!==t)&&(o==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+o&&(t.defaultValue=""+o))}var ed=Array.isArray;function fc(t,n,o,r){if(t=t.options,n){n={};for(var s=0;s<o.length;s++)n["$"+o[s]]=!0;for(o=0;o<t.length;o++)s=n.hasOwnProperty("$"+t[o].value),t[o].selected!==s&&(t[o].selected=s),s&&r&&(t[o].defaultSelected=!0)}else{for(o=""+fa(o),n=null,s=0;s<t.length;s++){if(t[s].value===o){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}n!==null||t[s].disabled||(n=t[s])}n!==null&&(n.selected=!0)}}function g0(t,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Je(91));return Ur({},n,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function p2(t,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(Je(92));if(ed(o)){if(1<o.length)throw Error(Je(93));o=o[0]}n=o}n==null&&(n=""),o=n}t._wrapperState={initialValue:fa(o)}}function f2(t,n){var o=fa(n.value),r=fa(n.defaultValue);o!=null&&(o=""+o,o!==t.value&&(t.value=o),n.defaultValue==null&&t.defaultValue!==o&&(t.defaultValue=o)),r!=null&&(t.defaultValue=""+r)}function m2(t){var n=t.textContent;n===t._wrapperState.initialValue&&n!==""&&n!==null&&(t.value=n)}function g2(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function y0(t,n){return t==null||t==="http://www.w3.org/1999/xhtml"?g2(n):t==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var jp,y2=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,r,s){MSApp.execUnsafeLocalFunction(function(){return t(n,o,r,s)})}:t}(function(t,n){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=n;else{for(jp=jp||document.createElement("div"),jp.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=jp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;n.firstChild;)t.appendChild(n.firstChild)}});function td(t,n){if(n){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=n;return}}t.textContent=n}var rd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C4=["Webkit","ms","Moz","O"];Object.keys(rd).forEach(function(t){C4.forEach(function(n){n=n+t.charAt(0).toUpperCase()+t.substring(1),rd[n]=rd[t]})});function v2(t,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||rd.hasOwnProperty(t)&&rd[t]?(""+n).trim():n+"px"}function b2(t,n){t=t.style;for(var o in n)if(n.hasOwnProperty(o)){var r=o.indexOf("--")===0,s=v2(o,n[o],r);o==="float"&&(o="cssFloat"),r?t.setProperty(o,s):t[o]=s}}var P4=Ur({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function v0(t,n){if(n){if(P4[t]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Je(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Je(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Je(62))}}function b0(t,n){if(t.indexOf("-")===-1)return typeof n.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x0=null;function w0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var S0=null,mc=null,gc=null;function x2(t){if(t=_d(t)){if(typeof S0!="function")throw Error(Je(280));var n=t.stateNode;n&&(n=$p(n),S0(t.stateNode,t.type,n))}}function w2(t){mc?gc?gc.push(t):gc=[t]:mc=t}function S2(){if(mc){var t=mc,n=gc;if(gc=mc=null,x2(t),n)for(t=0;t<n.length;t++)x2(n[t])}}function j2(t,n){return t(n)}function _2(){}var j0=!1;function k2(t,n,o){if(j0)return t(n,o);j0=!0;try{return j2(t,n,o)}finally{j0=!1,(mc!==null||gc!==null)&&(_2(),S2())}}function nd(t,n){var o=t.stateNode;if(o===null)return null;var r=$p(o);if(r===null)return null;o=r[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(Je(231,n,typeof o));return o}var _0=!1;if(_i)try{var od={};Object.defineProperty(od,"passive",{get:function(){_0=!0}}),window.addEventListener("test",od,od),window.removeEventListener("test",od,od)}catch{_0=!1}function M4(t,n,o,r,s,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{n.apply(o,u)}catch(f){this.onError(f)}}var sd=!1,_p=null,kp=!1,k0=null,T4={onError:function(t){sd=!0,_p=t}};function I4(t,n,o,r,s,a,i,l,c){sd=!1,_p=null,M4.apply(T4,arguments)}function A4(t,n,o,r,s,a,i,l,c){if(I4.apply(this,arguments),sd){if(sd){var u=_p;sd=!1,_p=null}else throw Error(Je(198));kp||(kp=!0,k0=u)}}function yl(t){var n=t,o=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,n.flags&4098&&(o=n.return),t=n.return;while(t)}return n.tag===3?o:null}function E2(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function C2(t){if(yl(t)!==t)throw Error(Je(188))}function O4(t){var n=t.alternate;if(!n){if(n=yl(t),n===null)throw Error(Je(188));return n!==t?null:t}for(var o=t,r=n;;){var s=o.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){o=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===o)return C2(s),t;if(a===r)return C2(s),n;a=a.sibling}throw Error(Je(188))}if(o.return!==r.return)o=s,r=a;else{for(var i=!1,l=s.child;l;){if(l===o){i=!0,o=s,r=a;break}if(l===r){i=!0,r=s,o=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===o){i=!0,o=a,r=s;break}if(l===r){i=!0,r=a,o=s;break}l=l.sibling}if(!i)throw Error(Je(189))}}if(o.alternate!==r)throw Error(Je(190))}if(o.tag!==3)throw Error(Je(188));return o.stateNode.current===o?t:n}function P2(t){return t=O4(t),t!==null?M2(t):null}function M2(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var n=M2(t);if(n!==null)return n;t=t.sibling}return null}var T2=zo.unstable_scheduleCallback,I2=zo.unstable_cancelCallback,L4=zo.unstable_shouldYield,R4=zo.unstable_requestPaint,Jr=zo.unstable_now,D4=zo.unstable_getCurrentPriorityLevel,E0=zo.unstable_ImmediatePriority,A2=zo.unstable_UserBlockingPriority,Ep=zo.unstable_NormalPriority,F4=zo.unstable_LowPriority,O2=zo.unstable_IdlePriority,Cp=null,Ks=null;function N4(t){if(Ks&&typeof Ks.onCommitFiberRoot=="function")try{Ks.onCommitFiberRoot(Cp,t,void 0,(t.current.flags&128)===128)}catch{}}var Cs=Math.clz32?Math.clz32:z4,U4=Math.log,B4=Math.LN2;function z4(t){return t>>>=0,t===0?32:31-(U4(t)/B4|0)|0}var Pp=64,Mp=4194304;function id(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Tp(t,n){var o=t.pendingLanes;if(o===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes,i=o&268435455;if(i!==0){var l=i&~s;l!==0?r=id(l):(a&=i,a!==0&&(r=id(a)))}else i=o&~s,i!==0?r=id(i):a!==0&&(r=id(a));if(r===0)return 0;if(n!==0&&n!==r&&!(n&s)&&(s=r&-r,a=n&-n,s>=a||s===16&&(a&4194240)!==0))return n;if(r&4&&(r|=o&16),n=t.entangledLanes,n!==0)for(t=t.entanglements,n&=r;0<n;)o=31-Cs(n),s=1<<o,r|=t[o],n&=~s;return r}function G4(t,n){switch(t){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function V4(t,n){for(var o=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Cs(a),l=1<<i,c=s[i];c===-1?(!(l&o)||l&r)&&(s[i]=G4(l,n)):c<=n&&(t.expiredLanes|=l),a&=~l}}function C0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function L2(){var t=Pp;return Pp<<=1,!(Pp&4194240)&&(Pp=64),t}function P0(t){for(var n=[],o=0;31>o;o++)n.push(t);return n}function ad(t,n,o){t.pendingLanes|=n,n!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,n=31-Cs(n),t[n]=o}function H4(t,n){var o=t.pendingLanes&~n;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=n,t.mutableReadLanes&=n,t.entangledLanes&=n,n=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<o;){var s=31-Cs(o),a=1<<s;n[s]=0,r[s]=-1,t[s]=-1,o&=~a}}function M0(t,n){var o=t.entangledLanes|=n;for(t=t.entanglements;o;){var r=31-Cs(o),s=1<<r;s&n|t[r]&n&&(t[r]|=n),o&=~s}}var ar=0;function R2(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var D2,T0,F2,N2,U2,I0=!1,Ip=[],ma=null,ga=null,ya=null,ld=new Map,cd=new Map,va=[],W4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function B2(t,n){switch(t){case"focusin":case"focusout":ma=null;break;case"dragenter":case"dragleave":ga=null;break;case"mouseover":case"mouseout":ya=null;break;case"pointerover":case"pointerout":ld.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":cd.delete(n.pointerId)}}function ud(t,n,o,r,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:n,domEventName:o,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},n!==null&&(n=_d(n),n!==null&&T0(n)),t):(t.eventSystemFlags|=r,n=t.targetContainers,s!==null&&n.indexOf(s)===-1&&n.push(s),t)}function $4(t,n,o,r,s){switch(n){case"focusin":return ma=ud(ma,t,n,o,r,s),!0;case"dragenter":return ga=ud(ga,t,n,o,r,s),!0;case"mouseover":return ya=ud(ya,t,n,o,r,s),!0;case"pointerover":var a=s.pointerId;return ld.set(a,ud(ld.get(a)||null,t,n,o,r,s)),!0;case"gotpointercapture":return a=s.pointerId,cd.set(a,ud(cd.get(a)||null,t,n,o,r,s)),!0}return!1}function z2(t){var n=vl(t.target);if(n!==null){var o=yl(n);if(o!==null){if(n=o.tag,n===13){if(n=E2(o),n!==null){t.blockedOn=n,U2(t.priority,function(){F2(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ap(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var o=O0(t.domEventName,t.eventSystemFlags,n[0],t.nativeEvent);if(o===null){o=t.nativeEvent;var r=new o.constructor(o.type,o);x0=r,o.target.dispatchEvent(r),x0=null}else return n=_d(o),n!==null&&T0(n),t.blockedOn=o,!1;n.shift()}return!0}function G2(t,n,o){Ap(t)&&o.delete(n)}function q4(){I0=!1,ma!==null&&Ap(ma)&&(ma=null),ga!==null&&Ap(ga)&&(ga=null),ya!==null&&Ap(ya)&&(ya=null),ld.forEach(G2),cd.forEach(G2)}function dd(t,n){t.blockedOn===n&&(t.blockedOn=null,I0||(I0=!0,zo.unstable_scheduleCallback(zo.unstable_NormalPriority,q4)))}function hd(t){function n(s){return dd(s,t)}if(0<Ip.length){dd(Ip[0],t);for(var o=1;o<Ip.length;o++){var r=Ip[o];r.blockedOn===t&&(r.blockedOn=null)}}for(ma!==null&&dd(ma,t),ga!==null&&dd(ga,t),ya!==null&&dd(ya,t),ld.forEach(n),cd.forEach(n),o=0;o<va.length;o++)r=va[o],r.blockedOn===t&&(r.blockedOn=null);for(;0<va.length&&(o=va[0],o.blockedOn===null);)z2(o),o.blockedOn===null&&va.shift()}var yc=ki.ReactCurrentBatchConfig,Op=!0;function Y4(t,n,o,r){var s=ar,a=yc.transition;yc.transition=null;try{ar=1,A0(t,n,o,r)}finally{ar=s,yc.transition=a}}function K4(t,n,o,r){var s=ar,a=yc.transition;yc.transition=null;try{ar=4,A0(t,n,o,r)}finally{ar=s,yc.transition=a}}function A0(t,n,o,r){if(Op){var s=O0(t,n,o,r);if(s===null)X0(t,n,r,Lp,o),B2(t,r);else if($4(s,t,n,o,r))r.stopPropagation();else if(B2(t,r),n&4&&-1<W4.indexOf(t)){for(;s!==null;){var a=_d(s);if(a!==null&&D2(a),a=O0(t,n,o,r),a===null&&X0(t,n,r,Lp,o),a===s)break;s=a}s!==null&&r.stopPropagation()}else X0(t,n,r,null,o)}}var Lp=null;function O0(t,n,o,r){if(Lp=null,t=w0(r),t=vl(t),t!==null)if(n=yl(t),n===null)t=null;else if(o=n.tag,o===13){if(t=E2(n),t!==null)return t;t=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null);return Lp=t,null}function V2(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(D4()){case E0:return 1;case A2:return 4;case Ep:case F4:return 16;case O2:return 536870912;default:return 16}default:return 16}}var ba=null,L0=null,Rp=null;function H2(){if(Rp)return Rp;var t,n=L0,o=n.length,r,s="value"in ba?ba.value:ba.textContent,a=s.length;for(t=0;t<o&&n[t]===s[t];t++);var i=o-t;for(r=1;r<=i&&n[o-r]===s[a-r];r++);return Rp=s.slice(t,1<r?1-r:void 0)}function Dp(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function Fp(){return!0}function W2(){return!1}function Go(t){function n(o,r,s,a,i){this._reactName=o,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(o=t[l],this[l]=o?o(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Fp:W2,this.isPropagationStopped=W2,this}return Ur(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Fp)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Fp)},persist:function(){},isPersistent:Fp}),n}var vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},R0=Go(vc),pd=Ur({},vc,{view:0,detail:0}),X4=Go(pd),D0,F0,fd,Np=Ur({},pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:U0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fd&&(fd&&t.type==="mousemove"?(D0=t.screenX-fd.screenX,F0=t.screenY-fd.screenY):F0=D0=0,fd=t),D0)},movementY:function(t){return"movementY"in t?t.movementY:F0}}),$2=Go(Np),Q4=Ur({},Np,{dataTransfer:0}),Z4=Go(Q4),J4=Ur({},pd,{relatedTarget:0}),N0=Go(J4),eL=Ur({},vc,{animationName:0,elapsedTime:0,pseudoElement:0}),tL=Go(eL),rL=Ur({},vc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nL=Go(rL),oL=Ur({},vc,{data:0}),q2=Go(oL),sL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lL(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=aL[t])?!!n[t]:!1}function U0(){return lL}var cL=Ur({},pd,{key:function(t){if(t.key){var n=sL[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=Dp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iL[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:U0,charCode:function(t){return t.type==="keypress"?Dp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uL=Go(cL),dL=Ur({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Y2=Go(dL),hL=Ur({},pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:U0}),pL=Go(hL),fL=Ur({},vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),mL=Go(fL),gL=Ur({},Np,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yL=Go(gL),vL=[9,13,27,32],B0=_i&&"CompositionEvent"in window,md=null;_i&&"documentMode"in document&&(md=document.documentMode);var bL=_i&&"TextEvent"in window&&!md,K2=_i&&(!B0||md&&8<md&&11>=md),X2=String.fromCharCode(32),Q2=!1;function Z2(t,n){switch(t){case"keyup":return vL.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function J2(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bc=!1;function xL(t,n){switch(t){case"compositionend":return J2(n);case"keypress":return n.which!==32?null:(Q2=!0,X2);case"textInput":return t=n.data,t===X2&&Q2?null:t;default:return null}}function wL(t,n){if(bc)return t==="compositionend"||!B0&&Z2(t,n)?(t=H2(),Rp=L0=ba=null,bc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return K2&&n.locale!=="ko"?null:n.data;default:return null}}var SL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ej(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!SL[t.type]:n==="textarea"}function tj(t,n,o,r){w2(r),n=Vp(n,"onChange"),0<n.length&&(o=new R0("onChange","change",null,o,r),t.push({event:o,listeners:n}))}var gd=null,yd=null;function jL(t){bj(t,0)}function Up(t){var n=_c(t);if(c2(n))return t}function _L(t,n){if(t==="change")return n}var rj=!1;if(_i){var z0;if(_i){var G0="oninput"in document;if(!G0){var nj=document.createElement("div");nj.setAttribute("oninput","return;"),G0=typeof nj.oninput=="function"}z0=G0}else z0=!1;rj=z0&&(!document.documentMode||9<document.documentMode)}function oj(){gd&&(gd.detachEvent("onpropertychange",sj),yd=gd=null)}function sj(t){if(t.propertyName==="value"&&Up(yd)){var n=[];tj(n,yd,t,w0(t)),k2(jL,n)}}function kL(t,n,o){t==="focusin"?(oj(),gd=n,yd=o,gd.attachEvent("onpropertychange",sj)):t==="focusout"&&oj()}function EL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Up(yd)}function CL(t,n){if(t==="click")return Up(n)}function PL(t,n){if(t==="input"||t==="change")return Up(n)}function ML(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Ps=typeof Object.is=="function"?Object.is:ML;function vd(t,n){if(Ps(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var o=Object.keys(t),r=Object.keys(n);if(o.length!==r.length)return!1;for(r=0;r<o.length;r++){var s=o[r];if(!Jy.call(n,s)||!Ps(t[s],n[s]))return!1}return!0}function ij(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function aj(t,n){var o=ij(t);t=0;for(var r;o;){if(o.nodeType===3){if(r=t+o.textContent.length,t<=n&&r>=n)return{node:o,offset:n-t};t=r}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ij(o)}}function lj(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?lj(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function cj(){for(var t=window,n=Sp();n instanceof t.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)t=n.contentWindow;else break;n=Sp(t.document)}return n}function V0(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function TL(t){var n=cj(),o=t.focusedElem,r=t.selectionRange;if(n!==o&&o&&o.ownerDocument&&lj(o.ownerDocument.documentElement,o)){if(r!==null&&V0(o)){if(n=r.start,t=r.end,t===void 0&&(t=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(t,o.value.length);else if(t=(n=o.ownerDocument||document)&&n.defaultView||window,t.getSelection){t=t.getSelection();var s=o.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!t.extend&&a>r&&(s=r,r=a,a=s),s=aj(o,a);var i=aj(o,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(n=n.createRange(),n.setStart(s.node,s.offset),t.removeAllRanges(),a>r?(t.addRange(n),t.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),t.addRange(n)))}}for(n=[],t=o;t=t.parentNode;)t.nodeType===1&&n.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)t=n[o],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var IL=_i&&"documentMode"in document&&11>=document.documentMode,xc=null,H0=null,bd=null,W0=!1;function uj(t,n,o){var r=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;W0||xc==null||xc!==Sp(r)||(r=xc,"selectionStart"in r&&V0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bd&&vd(bd,r)||(bd=r,r=Vp(H0,"onSelect"),0<r.length&&(n=new R0("onSelect","select",null,n,o),t.push({event:n,listeners:r}),n.target=xc)))}function Bp(t,n){var o={};return o[t.toLowerCase()]=n.toLowerCase(),o["Webkit"+t]="webkit"+n,o["Moz"+t]="moz"+n,o}var wc={animationend:Bp("Animation","AnimationEnd"),animationiteration:Bp("Animation","AnimationIteration"),animationstart:Bp("Animation","AnimationStart"),transitionend:Bp("Transition","TransitionEnd")},$0={},dj={};_i&&(dj=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function zp(t){if($0[t])return $0[t];if(!wc[t])return t;var n=wc[t],o;for(o in n)if(n.hasOwnProperty(o)&&o in dj)return $0[t]=n[o];return t}var hj=zp("animationend"),pj=zp("animationiteration"),fj=zp("animationstart"),mj=zp("transitionend"),gj=new Map,yj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xa(t,n){gj.set(t,n),gl(n,[t])}for(var q0=0;q0<yj.length;q0++){var Y0=yj[q0],AL=Y0.toLowerCase(),OL=Y0[0].toUpperCase()+Y0.slice(1);xa(AL,"on"+OL)}xa(hj,"onAnimationEnd"),xa(pj,"onAnimationIteration"),xa(fj,"onAnimationStart"),xa("dblclick","onDoubleClick"),xa("focusin","onFocus"),xa("focusout","onBlur"),xa(mj,"onTransitionEnd"),dc("onMouseEnter",["mouseout","mouseover"]),dc("onMouseLeave",["mouseout","mouseover"]),dc("onPointerEnter",["pointerout","pointerover"]),dc("onPointerLeave",["pointerout","pointerover"]),gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gl("onBeforeInput",["compositionend","keypress","textInput","paste"]),gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LL=new Set("cancel close invalid load scroll toggle".split(" ").concat(xd));function vj(t,n,o){var r=t.type||"unknown-event";t.currentTarget=o,A4(r,n,void 0,t),t.currentTarget=null}function bj(t,n){n=(n&4)!==0;for(var o=0;o<t.length;o++){var r=t[o],s=r.event;r=r.listeners;e:{var a=void 0;if(n)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;vj(s,l,u),a=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;vj(s,l,u),a=c}}}if(kp)throw t=k0,kp=!1,k0=null,t}function Mr(t,n){var o=n[rv];o===void 0&&(o=n[rv]=new Set);var r=t+"__bubble";o.has(r)||(xj(n,t,2,!1),o.add(r))}function K0(t,n,o){var r=0;n&&(r|=4),xj(o,t,r,n)}var Gp="_reactListening"+Math.random().toString(36).slice(2);function wd(t){if(!t[Gp]){t[Gp]=!0,t2.forEach(function(o){o!=="selectionchange"&&(LL.has(o)||K0(o,!1,t),K0(o,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Gp]||(n[Gp]=!0,K0("selectionchange",!1,n))}}function xj(t,n,o,r){switch(V2(n)){case 1:var s=Y4;break;case 4:s=K4;break;default:s=A0}o=s.bind(null,n,o,t),s=void 0,!_0||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(n,o,{capture:!0,passive:s}):t.addEventListener(n,o,!0):s!==void 0?t.addEventListener(n,o,{passive:s}):t.addEventListener(n,o,!1)}function X0(t,n,o,r,s){var a=r;if(!(n&1)&&!(n&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=vl(l),i===null)return;if(c=i.tag,c===5||c===6){r=a=i;continue e}l=l.parentNode}}r=r.return}k2(function(){var u=a,f=w0(o),h=[];e:{var d=gj.get(t);if(d!==void 0){var p=R0,y=t;switch(t){case"keypress":if(Dp(o)===0)break e;case"keydown":case"keyup":p=uL;break;case"focusin":y="focus",p=N0;break;case"focusout":y="blur",p=N0;break;case"beforeblur":case"afterblur":p=N0;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Z4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=pL;break;case hj:case pj:case fj:p=tL;break;case mj:p=mL;break;case"scroll":p=X4;break;case"wheel":p=yL;break;case"copy":case"cut":case"paste":p=nL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Y2}var g=(n&4)!==0,b=!g&&t==="scroll",m=g?d!==null?d+"Capture":null:d;g=[];for(var v=u,x;v!==null;){x=v;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,m!==null&&(w=nd(v,m),w!=null&&g.push(Sd(v,w,x)))),b)break;v=v.return}0<g.length&&(d=new p(d,y,null,o,f),h.push({event:d,listeners:g}))}}if(!(n&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&o!==x0&&(y=o.relatedTarget||o.fromElement)&&(vl(y)||y[Ei]))break e;if((p||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,p?(y=o.relatedTarget||o.toElement,p=u,y=y?vl(y):null,y!==null&&(b=yl(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(g=$2,w="onMouseLeave",m="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=Y2,w="onPointerLeave",m="onPointerEnter",v="pointer"),b=p==null?d:_c(p),x=y==null?d:_c(y),d=new g(w,v+"leave",p,o,f),d.target=b,d.relatedTarget=x,w=null,vl(f)===u&&(g=new g(m,v+"enter",y,o,f),g.target=x,g.relatedTarget=b,w=g),b=w,p&&y)t:{for(g=p,m=y,v=0,x=g;x;x=Sc(x))v++;for(x=0,w=m;w;w=Sc(w))x++;for(;0<v-x;)g=Sc(g),v--;for(;0<x-v;)m=Sc(m),x--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=Sc(g),m=Sc(m)}g=null}else g=null;p!==null&&wj(h,d,p,g,!1),y!==null&&b!==null&&wj(h,b,y,g,!0)}}e:{if(d=u?_c(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var S=_L;else if(ej(d))if(rj)S=PL;else{S=EL;var k=kL}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=CL);if(S&&(S=S(t,u))){tj(h,S,o,f);break e}k&&k(t,d,u),t==="focusout"&&(k=d._wrapperState)&&k.controlled&&d.type==="number"&&m0(d,"number",d.value)}switch(k=u?_c(u):window,t){case"focusin":(ej(k)||k.contentEditable==="true")&&(xc=k,H0=u,bd=null);break;case"focusout":bd=H0=xc=null;break;case"mousedown":W0=!0;break;case"contextmenu":case"mouseup":case"dragend":W0=!1,uj(h,o,f);break;case"selectionchange":if(IL)break;case"keydown":case"keyup":uj(h,o,f)}var _;if(B0)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else bc?Z2(t,o)&&(C="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(C="onCompositionStart");C&&(K2&&o.locale!=="ko"&&(bc||C!=="onCompositionStart"?C==="onCompositionEnd"&&bc&&(_=H2()):(ba=f,L0="value"in ba?ba.value:ba.textContent,bc=!0)),k=Vp(u,C),0<k.length&&(C=new q2(C,t,null,o,f),h.push({event:C,listeners:k}),_?C.data=_:(_=J2(o),_!==null&&(C.data=_)))),(_=bL?xL(t,o):wL(t,o))&&(u=Vp(u,"onBeforeInput"),0<u.length&&(f=new q2("onBeforeInput","beforeinput",null,o,f),h.push({event:f,listeners:u}),f.data=_))}bj(h,n)})}function Sd(t,n,o){return{instance:t,listener:n,currentTarget:o}}function Vp(t,n){for(var o=n+"Capture",r=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=nd(t,o),a!=null&&r.unshift(Sd(t,a,s)),a=nd(t,n),a!=null&&r.push(Sd(t,a,s))),t=t.return}return r}function Sc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wj(t,n,o,r,s){for(var a=n._reactName,i=[];o!==null&&o!==r;){var l=o,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=nd(o,a),c!=null&&i.unshift(Sd(o,c,l))):s||(c=nd(o,a),c!=null&&i.push(Sd(o,c,l)))),o=o.return}i.length!==0&&t.push({event:n,listeners:i})}var RL=/\r\n?/g,DL=/\u0000|\uFFFD/g;function Sj(t){return(typeof t=="string"?t:""+t).replace(RL,`
`).replace(DL,"")}function Hp(t,n,o){if(n=Sj(n),Sj(t)!==n&&o)throw Error(Je(425))}function Wp(){}var Q0=null,Z0=null;function J0(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var ev=typeof setTimeout=="function"?setTimeout:void 0,FL=typeof clearTimeout=="function"?clearTimeout:void 0,jj=typeof Promise=="function"?Promise:void 0,NL=typeof queueMicrotask=="function"?queueMicrotask:typeof jj<"u"?function(t){return jj.resolve(null).then(t).catch(UL)}:ev;function UL(t){setTimeout(function(){throw t})}function tv(t,n){var o=n,r=0;do{var s=o.nextSibling;if(t.removeChild(o),s&&s.nodeType===8)if(o=s.data,o==="/$"){if(r===0){t.removeChild(s),hd(n);return}r--}else o!=="$"&&o!=="$?"&&o!=="$!"||r++;o=s}while(o);hd(n)}function wa(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return t}function _j(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return t;n--}else o==="/$"&&n++}t=t.previousSibling}return null}var jc=Math.random().toString(36).slice(2),Xs="__reactFiber$"+jc,jd="__reactProps$"+jc,Ei="__reactContainer$"+jc,rv="__reactEvents$"+jc,BL="__reactListeners$"+jc,zL="__reactHandles$"+jc;function vl(t){var n=t[Xs];if(n)return n;for(var o=t.parentNode;o;){if(n=o[Ei]||o[Xs]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(t=_j(t);t!==null;){if(o=t[Xs])return o;t=_j(t)}return n}t=o,o=t.parentNode}return null}function _d(t){return t=t[Xs]||t[Ei],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _c(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function $p(t){return t[jd]||null}var nv=[],kc=-1;function Sa(t){return{current:t}}function Tr(t){0>kc||(t.current=nv[kc],nv[kc]=null,kc--)}function xr(t,n){kc++,nv[kc]=t.current,t.current=n}var ja={},zn=Sa(ja),jo=Sa(!1),bl=ja;function Ec(t,n){var o=t.type.contextTypes;if(!o)return ja;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===n)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in o)s[a]=n[a];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=s),s}function _o(t){return t=t.childContextTypes,t!=null}function qp(){Tr(jo),Tr(zn)}function kj(t,n,o){if(zn.current!==ja)throw Error(Je(168));xr(zn,n),xr(jo,o)}function Ej(t,n,o){var r=t.stateNode;if(n=n.childContextTypes,typeof r.getChildContext!="function")return o;r=r.getChildContext();for(var s in r)if(!(s in n))throw Error(Je(108,k4(t)||"Unknown",s));return Ur({},o,r)}function Yp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ja,bl=zn.current,xr(zn,t),xr(jo,jo.current),!0}function Cj(t,n,o){var r=t.stateNode;if(!r)throw Error(Je(169));o?(t=Ej(t,n,bl),r.__reactInternalMemoizedMergedChildContext=t,Tr(jo),Tr(zn),xr(zn,t)):Tr(jo),xr(jo,o)}var Ci=null,Kp=!1,ov=!1;function Pj(t){Ci===null?Ci=[t]:Ci.push(t)}function GL(t){Kp=!0,Pj(t)}function _a(){if(!ov&&Ci!==null){ov=!0;var t=0,n=ar;try{var o=Ci;for(ar=1;t<o.length;t++){var r=o[t];do r=r(!0);while(r!==null)}Ci=null,Kp=!1}catch(s){throw Ci!==null&&(Ci=Ci.slice(t+1)),T2(E0,_a),s}finally{ar=n,ov=!1}}return null}var Cc=[],Pc=0,Xp=null,Qp=0,ls=[],cs=0,xl=null,Pi=1,Mi="";function wl(t,n){Cc[Pc++]=Qp,Cc[Pc++]=Xp,Xp=t,Qp=n}function Mj(t,n,o){ls[cs++]=Pi,ls[cs++]=Mi,ls[cs++]=xl,xl=t;var r=Pi;t=Mi;var s=32-Cs(r)-1;r&=~(1<<s),o+=1;var a=32-Cs(n)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Pi=1<<32-Cs(n)+s|o<<s|r,Mi=a+t}else Pi=1<<a|o<<s|r,Mi=t}function sv(t){t.return!==null&&(wl(t,1),Mj(t,1,0))}function iv(t){for(;t===Xp;)Xp=Cc[--Pc],Cc[Pc]=null,Qp=Cc[--Pc],Cc[Pc]=null;for(;t===xl;)xl=ls[--cs],ls[cs]=null,Mi=ls[--cs],ls[cs]=null,Pi=ls[--cs],ls[cs]=null}var Vo=null,Ho=null,Rr=!1,Ms=null;function Tj(t,n){var o=ps(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=t,n=t.deletions,n===null?(t.deletions=[o],t.flags|=16):n.push(o)}function Ij(t,n){switch(t.tag){case 5:var o=t.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(t.stateNode=n,Vo=t,Ho=wa(n.firstChild),!0):!1;case 6:return n=t.pendingProps===""||n.nodeType!==3?null:n,n!==null?(t.stateNode=n,Vo=t,Ho=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=xl!==null?{id:Pi,overflow:Mi}:null,t.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=ps(18,null,null,0),o.stateNode=n,o.return=t,t.child=o,Vo=t,Ho=null,!0):!1;default:return!1}}function av(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lv(t){if(Rr){var n=Ho;if(n){var o=n;if(!Ij(t,n)){if(av(t))throw Error(Je(418));n=wa(o.nextSibling);var r=Vo;n&&Ij(t,n)?Tj(r,o):(t.flags=t.flags&-4097|2,Rr=!1,Vo=t)}}else{if(av(t))throw Error(Je(418));t.flags=t.flags&-4097|2,Rr=!1,Vo=t}}}function Aj(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Vo=t}function Zp(t){if(t!==Vo)return!1;if(!Rr)return Aj(t),Rr=!0,!1;var n;if((n=t.tag!==3)&&!(n=t.tag!==5)&&(n=t.type,n=n!=="head"&&n!=="body"&&!J0(t.type,t.memoizedProps)),n&&(n=Ho)){if(av(t))throw Oj(),Error(Je(418));for(;n;)Tj(t,n),n=wa(n.nextSibling)}if(Aj(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"){if(n===0){Ho=wa(t.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}t=t.nextSibling}Ho=null}}else Ho=Vo?wa(t.stateNode.nextSibling):null;return!0}function Oj(){for(var t=Ho;t;)t=wa(t.nextSibling)}function Mc(){Ho=Vo=null,Rr=!1}function cv(t){Ms===null?Ms=[t]:Ms.push(t)}var VL=ki.ReactCurrentBatchConfig;function Ts(t,n){if(t&&t.defaultProps){n=Ur({},n),t=t.defaultProps;for(var o in t)n[o]===void 0&&(n[o]=t[o]);return n}return n}var Jp=Sa(null),ef=null,Tc=null,uv=null;function dv(){uv=Tc=ef=null}function hv(t){var n=Jp.current;Tr(Jp),t._currentValue=n}function pv(t,n,o){for(;t!==null;){var r=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,r!==null&&(r.childLanes|=n)):r!==null&&(r.childLanes&n)!==n&&(r.childLanes|=n),t===o)break;t=t.return}}function Ic(t,n){ef=t,uv=Tc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&n&&(ko=!0),t.firstContext=null)}function us(t){var n=t._currentValue;if(uv!==t)if(t={context:t,memoizedValue:n,next:null},Tc===null){if(ef===null)throw Error(Je(308));Tc=t,ef.dependencies={lanes:0,firstContext:t}}else Tc=Tc.next=t;return n}var Sl=null;function fv(t){Sl===null?Sl=[t]:Sl.push(t)}function Lj(t,n,o,r){var s=n.interleaved;return s===null?(o.next=o,fv(n)):(o.next=s.next,s.next=o),n.interleaved=o,Ti(t,r)}function Ti(t,n){t.lanes|=n;var o=t.alternate;for(o!==null&&(o.lanes|=n),o=t,t=t.return;t!==null;)t.childLanes|=n,o=t.alternate,o!==null&&(o.childLanes|=n),o=t,t=t.return;return o.tag===3?o.stateNode:null}var ka=!1;function mv(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rj(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ii(t,n){return{eventTime:t,lane:n,tag:0,payload:null,callback:null,next:null}}function Ea(t,n,o){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Kt&2){var s=r.pending;return s===null?n.next=n:(n.next=s.next,s.next=n),r.pending=n,Ti(t,o)}return s=r.interleaved,s===null?(n.next=n,fv(r)):(n.next=s.next,s.next=n),r.interleaved=n,Ti(t,o)}function tf(t,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var r=n.lanes;r&=t.pendingLanes,o|=r,n.lanes=o,M0(t,o)}}function Dj(t,n){var o=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,o===r)){var s=null,a=null;if(o=o.firstBaseUpdate,o!==null){do{var i={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};a===null?s=a=i:a=a.next=i,o=o.next}while(o!==null);a===null?s=a=n:a=a.next=n}else s=a=n;o={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=n:t.next=n,o.lastBaseUpdate=n}function rf(t,n,o,r){var s=t.updateQueue;ka=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==i&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=c))}if(a!==null){var h=s.baseState;i=0,f=u=c=null,l=a;do{var d=l.lane,p=l.eventTime;if((r&d)===d){f!==null&&(f=f.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,g=l;switch(d=n,p=o,g.tag){case 1:if(y=g.payload,typeof y=="function"){h=y.call(p,h,d);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,d=typeof y=="function"?y.call(p,h,d):y,d==null)break e;h=Ur({},h,d);break e;case 2:ka=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=p,c=h):f=f.next=p,i|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(f===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,n=s.shared.interleaved,n!==null){s=n;do i|=s.lane,s=s.next;while(s!==n)}else a===null&&(s.shared.lanes=0);kl|=i,t.lanes=i,t.memoizedState=h}}function Fj(t,n,o){if(t=n.effects,n.effects=null,t!==null)for(n=0;n<t.length;n++){var r=t[n],s=r.callback;if(s!==null){if(r.callback=null,r=o,typeof s!="function")throw Error(Je(191,s));s.call(r)}}}var Nj=new e2.Component().refs;function gv(t,n,o,r){n=t.memoizedState,o=o(r,n),o=o==null?n:Ur({},n,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var nf={isMounted:function(t){return(t=t._reactInternals)?yl(t)===t:!1},enqueueSetState:function(t,n,o){t=t._reactInternals;var r=ho(),s=Ta(t),a=Ii(r,s);a.payload=n,o!=null&&(a.callback=o),n=Ea(t,a,s),n!==null&&(Os(n,t,s,r),tf(n,t,s))},enqueueReplaceState:function(t,n,o){t=t._reactInternals;var r=ho(),s=Ta(t),a=Ii(r,s);a.tag=1,a.payload=n,o!=null&&(a.callback=o),n=Ea(t,a,s),n!==null&&(Os(n,t,s,r),tf(n,t,s))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var o=ho(),r=Ta(t),s=Ii(o,r);s.tag=2,n!=null&&(s.callback=n),n=Ea(t,s,r),n!==null&&(Os(n,t,r,o),tf(n,t,r))}};function Uj(t,n,o,r,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,a,i):n.prototype&&n.prototype.isPureReactComponent?!vd(o,r)||!vd(s,a):!0}function Bj(t,n,o){var r=!1,s=ja,a=n.contextType;return typeof a=="object"&&a!==null?a=us(a):(s=_o(n)?bl:zn.current,r=n.contextTypes,a=(r=r!=null)?Ec(t,s):ja),n=new n(o,a),t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=nf,t.stateNode=n,n._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),n}function zj(t,n,o,r){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,r),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,r),n.state!==t&&nf.enqueueReplaceState(n,n.state,null)}function yv(t,n,o,r){var s=t.stateNode;s.props=o,s.state=t.memoizedState,s.refs=Nj,mv(t);var a=n.contextType;typeof a=="object"&&a!==null?s.context=us(a):(a=_o(n)?bl:zn.current,s.context=Ec(t,a)),s.state=t.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(gv(t,n,a,o),s.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(n=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),n!==s.state&&nf.enqueueReplaceState(s,s.state,null),rf(t,o,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function kd(t,n,o){if(t=o.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Je(309));var r=o.stateNode}if(!r)throw Error(Je(147,t));var s=r,a=""+t;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===a?n.ref:(n=function(i){var l=s.refs;l===Nj&&(l=s.refs={}),i===null?delete l[a]:l[a]=i},n._stringRef=a,n)}if(typeof t!="string")throw Error(Je(284));if(!o._owner)throw Error(Je(290,t))}return t}function of(t,n){throw t=Object.prototype.toString.call(n),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t))}function Gj(t){var n=t._init;return n(t._payload)}function Vj(t){function n(m,v){if(t){var x=m.deletions;x===null?(m.deletions=[v],m.flags|=16):x.push(v)}}function o(m,v){if(!t)return null;for(;v!==null;)n(m,v),v=v.sibling;return null}function r(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function s(m,v){return m=Aa(m,v),m.index=0,m.sibling=null,m}function a(m,v,x){return m.index=x,t?(x=m.alternate,x!==null?(x=x.index,x<v?(m.flags|=2,v):x):(m.flags|=2,v)):(m.flags|=1048576,v)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,v,x,w){return v===null||v.tag!==6?(v=Jv(x,m.mode,w),v.return=m,v):(v=s(v,x),v.return=m,v)}function c(m,v,x,w){var S=x.type;return S===pc?f(m,v,x.props.children,w,x.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pa&&Gj(S)===v.type)?(w=s(v,x.props),w.ref=kd(m,v,x),w.return=m,w):(w=_f(x.type,x.key,x.props,null,m.mode,w),w.ref=kd(m,v,x),w.return=m,w)}function u(m,v,x,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=eb(x,m.mode,w),v.return=m,v):(v=s(v,x.children||[]),v.return=m,v)}function f(m,v,x,w,S){return v===null||v.tag!==7?(v=Ml(x,m.mode,w,S),v.return=m,v):(v=s(v,x),v.return=m,v)}function h(m,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Jv(""+v,m.mode,x),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case xp:return x=_f(v.type,v.key,v.props,null,m.mode,x),x.ref=kd(m,null,v),x.return=m,x;case hc:return v=eb(v,m.mode,x),v.return=m,v;case pa:var w=v._init;return h(m,w(v._payload),x)}if(ed(v)||Zu(v))return v=Ml(v,m.mode,x,null),v.return=m,v;of(m,v)}return null}function d(m,v,x,w){var S=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:l(m,v,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case xp:return x.key===S?c(m,v,x,w):null;case hc:return x.key===S?u(m,v,x,w):null;case pa:return S=x._init,d(m,v,S(x._payload),w)}if(ed(x)||Zu(x))return S!==null?null:f(m,v,x,w,null);of(m,x)}return null}function p(m,v,x,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(x)||null,l(v,m,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xp:return m=m.get(w.key===null?x:w.key)||null,c(v,m,w,S);case hc:return m=m.get(w.key===null?x:w.key)||null,u(v,m,w,S);case pa:var k=w._init;return p(m,v,x,k(w._payload),S)}if(ed(w)||Zu(w))return m=m.get(x)||null,f(v,m,w,S,null);of(v,w)}return null}function y(m,v,x,w){for(var S=null,k=null,_=v,C=v=0,P=null;_!==null&&C<x.length;C++){_.index>C?(P=_,_=null):P=_.sibling;var A=d(m,_,x[C],w);if(A===null){_===null&&(_=P);break}t&&_&&A.alternate===null&&n(m,_),v=a(A,v,C),k===null?S=A:k.sibling=A,k=A,_=P}if(C===x.length)return o(m,_),Rr&&wl(m,C),S;if(_===null){for(;C<x.length;C++)_=h(m,x[C],w),_!==null&&(v=a(_,v,C),k===null?S=_:k.sibling=_,k=_);return Rr&&wl(m,C),S}for(_=r(m,_);C<x.length;C++)P=p(_,m,C,x[C],w),P!==null&&(t&&P.alternate!==null&&_.delete(P.key===null?C:P.key),v=a(P,v,C),k===null?S=P:k.sibling=P,k=P);return t&&_.forEach(function(I){return n(m,I)}),Rr&&wl(m,C),S}function g(m,v,x,w){var S=Zu(x);if(typeof S!="function")throw Error(Je(150));if(x=S.call(x),x==null)throw Error(Je(151));for(var k=S=null,_=v,C=v=0,P=null,A=x.next();_!==null&&!A.done;C++,A=x.next()){_.index>C?(P=_,_=null):P=_.sibling;var I=d(m,_,A.value,w);if(I===null){_===null&&(_=P);break}t&&_&&I.alternate===null&&n(m,_),v=a(I,v,C),k===null?S=I:k.sibling=I,k=I,_=P}if(A.done)return o(m,_),Rr&&wl(m,C),S;if(_===null){for(;!A.done;C++,A=x.next())A=h(m,A.value,w),A!==null&&(v=a(A,v,C),k===null?S=A:k.sibling=A,k=A);return Rr&&wl(m,C),S}for(_=r(m,_);!A.done;C++,A=x.next())A=p(_,m,C,A.value,w),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?C:A.key),v=a(A,v,C),k===null?S=A:k.sibling=A,k=A);return t&&_.forEach(function(N){return n(m,N)}),Rr&&wl(m,C),S}function b(m,v,x,w){if(typeof x=="object"&&x!==null&&x.type===pc&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case xp:e:{for(var S=x.key,k=v;k!==null;){if(k.key===S){if(S=x.type,S===pc){if(k.tag===7){o(m,k.sibling),v=s(k,x.props.children),v.return=m,m=v;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===pa&&Gj(S)===k.type){o(m,k.sibling),v=s(k,x.props),v.ref=kd(m,k,x),v.return=m,m=v;break e}o(m,k);break}else n(m,k);k=k.sibling}x.type===pc?(v=Ml(x.props.children,m.mode,w,x.key),v.return=m,m=v):(w=_f(x.type,x.key,x.props,null,m.mode,w),w.ref=kd(m,v,x),w.return=m,m=w)}return i(m);case hc:e:{for(k=x.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){o(m,v.sibling),v=s(v,x.children||[]),v.return=m,m=v;break e}else{o(m,v);break}else n(m,v);v=v.sibling}v=eb(x,m.mode,w),v.return=m,m=v}return i(m);case pa:return k=x._init,b(m,v,k(x._payload),w)}if(ed(x))return y(m,v,x,w);if(Zu(x))return g(m,v,x,w);of(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(o(m,v.sibling),v=s(v,x),v.return=m,m=v):(o(m,v),v=Jv(x,m.mode,w),v.return=m,m=v),i(m)):o(m,v)}return b}var Ac=Vj(!0),Hj=Vj(!1),Ed={},Qs=Sa(Ed),Cd=Sa(Ed),Pd=Sa(Ed);function jl(t){if(t===Ed)throw Error(Je(174));return t}function vv(t,n){switch(xr(Pd,n),xr(Cd,t),xr(Qs,Ed),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:y0(null,"");break;default:t=t===8?n.parentNode:n,n=t.namespaceURI||null,t=t.tagName,n=y0(n,t)}Tr(Qs),xr(Qs,n)}function Oc(){Tr(Qs),Tr(Cd),Tr(Pd)}function Wj(t){jl(Pd.current);var n=jl(Qs.current),o=y0(n,t.type);n!==o&&(xr(Cd,t),xr(Qs,o))}function bv(t){Cd.current===t&&(Tr(Qs),Tr(Cd))}var Br=Sa(0);function sf(t){for(var n=t;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var xv=[];function wv(){for(var t=0;t<xv.length;t++)xv[t]._workInProgressVersionPrimary=null;xv.length=0}var af=ki.ReactCurrentDispatcher,Sv=ki.ReactCurrentBatchConfig,_l=0,zr=null,yn=null,wn=null,lf=!1,Md=!1,Td=0,HL=0;function Gn(){throw Error(Je(321))}function jv(t,n){if(n===null)return!1;for(var o=0;o<n.length&&o<t.length;o++)if(!Ps(t[o],n[o]))return!1;return!0}function _v(t,n,o,r,s,a){if(_l=a,zr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,af.current=t===null||t.memoizedState===null?YL:KL,t=o(r,s),Md){a=0;do{if(Md=!1,Td=0,25<=a)throw Error(Je(301));a+=1,wn=yn=null,n.updateQueue=null,af.current=XL,t=o(r,s)}while(Md)}if(af.current=df,n=yn!==null&&yn.next!==null,_l=0,wn=yn=zr=null,lf=!1,n)throw Error(Je(300));return t}function kv(){var t=Td!==0;return Td=0,t}function Zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?zr.memoizedState=wn=t:wn=wn.next=t,wn}function ds(){if(yn===null){var t=zr.alternate;t=t!==null?t.memoizedState:null}else t=yn.next;var n=wn===null?zr.memoizedState:wn.next;if(n!==null)wn=n,yn=t;else{if(t===null)throw Error(Je(310));yn=t,t={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},wn===null?zr.memoizedState=wn=t:wn=wn.next=t}return wn}function Id(t,n){return typeof n=="function"?n(t):n}function Ev(t){var n=ds(),o=n.queue;if(o===null)throw Error(Je(311));o.lastRenderedReducer=t;var r=yn,s=r.baseQueue,a=o.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}r.baseQueue=s=a,o.pending=null}if(s!==null){a=s.next,r=r.baseState;var l=i=null,c=null,u=a;do{var f=u.lane;if((_l&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,i=r):c=c.next=h,zr.lanes|=f,kl|=f}u=u.next}while(u!==null&&u!==a);c===null?i=r:c.next=l,Ps(r,n.memoizedState)||(ko=!0),n.memoizedState=r,n.baseState=i,n.baseQueue=c,o.lastRenderedState=r}if(t=o.interleaved,t!==null){s=t;do a=s.lane,zr.lanes|=a,kl|=a,s=s.next;while(s!==t)}else s===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function Cv(t){var n=ds(),o=n.queue;if(o===null)throw Error(Je(311));o.lastRenderedReducer=t;var r=o.dispatch,s=o.pending,a=n.memoizedState;if(s!==null){o.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Ps(a,n.memoizedState)||(ko=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),o.lastRenderedState=a}return[a,r]}function $j(){}function qj(t,n){var o=zr,r=ds(),s=n(),a=!Ps(r.memoizedState,s);if(a&&(r.memoizedState=s,ko=!0),r=r.queue,Pv(Xj.bind(null,o,r,t),[t]),r.getSnapshot!==n||a||wn!==null&&wn.memoizedState.tag&1){if(o.flags|=2048,Ad(9,Kj.bind(null,o,r,s,n),void 0,null),Sn===null)throw Error(Je(349));_l&30||Yj(o,n,s)}return s}function Yj(t,n,o){t.flags|=16384,t={getSnapshot:n,value:o},n=zr.updateQueue,n===null?(n={lastEffect:null,stores:null},zr.updateQueue=n,n.stores=[t]):(o=n.stores,o===null?n.stores=[t]:o.push(t))}function Kj(t,n,o,r){n.value=o,n.getSnapshot=r,Qj(n)&&Zj(t)}function Xj(t,n,o){return o(function(){Qj(n)&&Zj(t)})}function Qj(t){var n=t.getSnapshot;t=t.value;try{var o=n();return!Ps(t,o)}catch{return!0}}function Zj(t){var n=Ti(t,1);n!==null&&Os(n,t,1,-1)}function Jj(t){var n=Zs();return typeof t=="function"&&(t=t()),n.memoizedState=n.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Id,lastRenderedState:t},n.queue=t,t=t.dispatch=qL.bind(null,zr,t),[n.memoizedState,t]}function Ad(t,n,o,r){return t={tag:t,create:n,destroy:o,deps:r,next:null},n=zr.updateQueue,n===null?(n={lastEffect:null,stores:null},zr.updateQueue=n,n.lastEffect=t.next=t):(o=n.lastEffect,o===null?n.lastEffect=t.next=t:(r=o.next,o.next=t,t.next=r,n.lastEffect=t)),t}function e_(){return ds().memoizedState}function cf(t,n,o,r){var s=Zs();zr.flags|=t,s.memoizedState=Ad(1|n,o,void 0,r===void 0?null:r)}function uf(t,n,o,r){var s=ds();r=r===void 0?null:r;var a=void 0;if(yn!==null){var i=yn.memoizedState;if(a=i.destroy,r!==null&&jv(r,i.deps)){s.memoizedState=Ad(n,o,a,r);return}}zr.flags|=t,s.memoizedState=Ad(1|n,o,a,r)}function t_(t,n){return cf(8390656,8,t,n)}function Pv(t,n){return uf(2048,8,t,n)}function r_(t,n){return uf(4,2,t,n)}function n_(t,n){return uf(4,4,t,n)}function o_(t,n){if(typeof n=="function")return t=t(),n(t),function(){n(null)};if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function s_(t,n,o){return o=o!=null?o.concat([t]):null,uf(4,4,o_.bind(null,n,t),o)}function Mv(){}function i_(t,n){var o=ds();n=n===void 0?null:n;var r=o.memoizedState;return r!==null&&n!==null&&jv(n,r[1])?r[0]:(o.memoizedState=[t,n],t)}function a_(t,n){var o=ds();n=n===void 0?null:n;var r=o.memoizedState;return r!==null&&n!==null&&jv(n,r[1])?r[0]:(t=t(),o.memoizedState=[t,n],t)}function l_(t,n,o){return _l&21?(Ps(o,n)||(o=L2(),zr.lanes|=o,kl|=o,t.baseState=!0),n):(t.baseState&&(t.baseState=!1,ko=!0),t.memoizedState=o)}function WL(t,n){var o=ar;ar=o!==0&&4>o?o:4,t(!0);var r=Sv.transition;Sv.transition={};try{t(!1),n()}finally{ar=o,Sv.transition=r}}function c_(){return ds().memoizedState}function $L(t,n,o){var r=Ta(t);if(o={lane:r,action:o,hasEagerState:!1,eagerState:null,next:null},u_(t))d_(n,o);else if(o=Lj(t,n,o,r),o!==null){var s=ho();Os(o,t,r,s),h_(o,n,r)}}function qL(t,n,o){var r=Ta(t),s={lane:r,action:o,hasEagerState:!1,eagerState:null,next:null};if(u_(t))d_(n,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var i=n.lastRenderedState,l=a(i,o);if(s.hasEagerState=!0,s.eagerState=l,Ps(l,i)){var c=n.interleaved;c===null?(s.next=s,fv(n)):(s.next=c.next,c.next=s),n.interleaved=s;return}}catch{}finally{}o=Lj(t,n,s,r),o!==null&&(s=ho(),Os(o,t,r,s),h_(o,n,r))}}function u_(t){var n=t.alternate;return t===zr||n!==null&&n===zr}function d_(t,n){Md=lf=!0;var o=t.pending;o===null?n.next=n:(n.next=o.next,o.next=n),t.pending=n}function h_(t,n,o){if(o&4194240){var r=n.lanes;r&=t.pendingLanes,o|=r,n.lanes=o,M0(t,o)}}var df={readContext:us,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},YL={readContext:us,useCallback:function(t,n){return Zs().memoizedState=[t,n===void 0?null:n],t},useContext:us,useEffect:t_,useImperativeHandle:function(t,n,o){return o=o!=null?o.concat([t]):null,cf(4194308,4,o_.bind(null,n,t),o)},useLayoutEffect:function(t,n){return cf(4194308,4,t,n)},useInsertionEffect:function(t,n){return cf(4,2,t,n)},useMemo:function(t,n){var o=Zs();return n=n===void 0?null:n,t=t(),o.memoizedState=[t,n],t},useReducer:function(t,n,o){var r=Zs();return n=o!==void 0?o(n):n,r.memoizedState=r.baseState=n,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:n},r.queue=t,t=t.dispatch=$L.bind(null,zr,t),[r.memoizedState,t]},useRef:function(t){var n=Zs();return t={current:t},n.memoizedState=t},useState:Jj,useDebugValue:Mv,useDeferredValue:function(t){return Zs().memoizedState=t},useTransition:function(){var t=Jj(!1),n=t[0];return t=WL.bind(null,t[1]),Zs().memoizedState=t,[n,t]},useMutableSource:function(){},useSyncExternalStore:function(t,n,o){var r=zr,s=Zs();if(Rr){if(o===void 0)throw Error(Je(407));o=o()}else{if(o=n(),Sn===null)throw Error(Je(349));_l&30||Yj(r,n,o)}s.memoizedState=o;var a={value:o,getSnapshot:n};return s.queue=a,t_(Xj.bind(null,r,a,t),[t]),r.flags|=2048,Ad(9,Kj.bind(null,r,a,o,n),void 0,null),o},useId:function(){var t=Zs(),n=Sn.identifierPrefix;if(Rr){var o=Mi,r=Pi;o=(r&~(1<<32-Cs(r)-1)).toString(32)+o,n=":"+n+"R"+o,o=Td++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=HL++,n=":"+n+"r"+o.toString(32)+":";return t.memoizedState=n},unstable_isNewReconciler:!1},KL={readContext:us,useCallback:i_,useContext:us,useEffect:Pv,useImperativeHandle:s_,useInsertionEffect:r_,useLayoutEffect:n_,useMemo:a_,useReducer:Ev,useRef:e_,useState:function(){return Ev(Id)},useDebugValue:Mv,useDeferredValue:function(t){var n=ds();return l_(n,yn.memoizedState,t)},useTransition:function(){var t=Ev(Id)[0],n=ds().memoizedState;return[t,n]},useMutableSource:$j,useSyncExternalStore:qj,useId:c_,unstable_isNewReconciler:!1},XL={readContext:us,useCallback:i_,useContext:us,useEffect:Pv,useImperativeHandle:s_,useInsertionEffect:r_,useLayoutEffect:n_,useMemo:a_,useReducer:Cv,useRef:e_,useState:function(){return Cv(Id)},useDebugValue:Mv,useDeferredValue:function(t){var n=ds();return yn===null?n.memoizedState=t:l_(n,yn.memoizedState,t)},useTransition:function(){var t=Cv(Id)[0],n=ds().memoizedState;return[t,n]},useMutableSource:$j,useSyncExternalStore:qj,useId:c_,unstable_isNewReconciler:!1};function Lc(t,n){try{var o="",r=n;do o+=_4(r),r=r.return;while(r);var s=o}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:n,stack:s,digest:null}}function Tv(t,n,o){return{value:t,source:null,stack:o??null,digest:n??null}}function Iv(t,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var QL=typeof WeakMap=="function"?WeakMap:Map;function p_(t,n,o){o=Ii(-1,o),o.tag=3,o.payload={element:null};var r=n.value;return o.callback=function(){vf||(vf=!0,Wv=r),Iv(t,n)},o}function f_(t,n,o){o=Ii(-1,o),o.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=n.value;o.payload=function(){return r(s)},o.callback=function(){Iv(t,n)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(o.callback=function(){Iv(t,n),typeof r!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var i=n.stack;this.componentDidCatch(n.value,{componentStack:i!==null?i:""})}),o}function m_(t,n,o){var r=t.pingCache;if(r===null){r=t.pingCache=new QL;var s=new Set;r.set(n,s)}else s=r.get(n),s===void 0&&(s=new Set,r.set(n,s));s.has(o)||(s.add(o),t=dR.bind(null,t,n,o),n.then(t,t))}function g_(t){do{var n;if((n=t.tag===13)&&(n=t.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return t;t=t.return}while(t!==null);return null}function y_(t,n,o,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===n?t.flags|=65536:(t.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=Ii(-1,1),n.tag=2,Ea(o,n,1))),o.lanes|=1),t)}var ZL=ki.ReactCurrentOwner,ko=!1;function uo(t,n,o,r){n.child=t===null?Hj(n,null,o,r):Ac(n,t.child,o,r)}function v_(t,n,o,r,s){o=o.render;var a=n.ref;return Ic(n,s),r=_v(t,n,o,r,a,s),o=kv(),t!==null&&!ko?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~s,Ai(t,n,s)):(Rr&&o&&sv(n),n.flags|=1,uo(t,n,r,s),n.child)}function b_(t,n,o,r,s){if(t===null){var a=o.type;return typeof a=="function"&&!Zv(a)&&a.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=a,x_(t,n,a,r,s)):(t=_f(o.type,null,r,n,n.mode,s),t.ref=n.ref,t.return=n,n.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(o=o.compare,o=o!==null?o:vd,o(i,r)&&t.ref===n.ref)return Ai(t,n,s)}return n.flags|=1,t=Aa(a,r),t.ref=n.ref,t.return=n,n.child=t}function x_(t,n,o,r,s){if(t!==null){var a=t.memoizedProps;if(vd(a,r)&&t.ref===n.ref)if(ko=!1,n.pendingProps=r=a,(t.lanes&s)!==0)t.flags&131072&&(ko=!0);else return n.lanes=t.lanes,Ai(t,n,s)}return Av(t,n,o,r,s)}function w_(t,n,o){var r=n.pendingProps,s=r.children,a=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Dc,Wo),Wo|=o;else{if(!(o&1073741824))return t=a!==null?a.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:t,cachePool:null,transitions:null},n.updateQueue=null,xr(Dc,Wo),Wo|=t,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:o,xr(Dc,Wo),Wo|=r}else a!==null?(r=a.baseLanes|o,n.memoizedState=null):r=o,xr(Dc,Wo),Wo|=r;return uo(t,n,s,o),n.child}function S_(t,n){var o=n.ref;(t===null&&o!==null||t!==null&&t.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function Av(t,n,o,r,s){var a=_o(o)?bl:zn.current;return a=Ec(n,a),Ic(n,s),o=_v(t,n,o,r,a,s),r=kv(),t!==null&&!ko?(n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~s,Ai(t,n,s)):(Rr&&r&&sv(n),n.flags|=1,uo(t,n,o,s),n.child)}function j_(t,n,o,r,s){if(_o(o)){var a=!0;Yp(n)}else a=!1;if(Ic(n,s),n.stateNode===null)pf(t,n),Bj(n,o,r),yv(n,o,r,s),r=!0;else if(t===null){var i=n.stateNode,l=n.memoizedProps;i.props=l;var c=i.context,u=o.contextType;typeof u=="object"&&u!==null?u=us(u):(u=_o(o)?bl:zn.current,u=Ec(n,u));var f=o.getDerivedStateFromProps,h=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==u)&&zj(n,i,r,u),ka=!1;var d=n.memoizedState;i.state=d,rf(n,r,i,s),c=n.memoizedState,l!==r||d!==c||jo.current||ka?(typeof f=="function"&&(gv(n,o,f,r),c=n.memoizedState),(l=ka||Uj(n,o,l,r,d,c,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(n.flags|=4194308)):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=r,n.memoizedState=c),i.props=r,i.state=c,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),r=!1)}else{i=n.stateNode,Rj(t,n),l=n.memoizedProps,u=n.type===n.elementType?l:Ts(n.type,l),i.props=u,h=n.pendingProps,d=i.context,c=o.contextType,typeof c=="object"&&c!==null?c=us(c):(c=_o(o)?bl:zn.current,c=Ec(n,c));var p=o.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||d!==c)&&zj(n,i,r,c),ka=!1,d=n.memoizedState,i.state=d,rf(n,r,i,s);var y=n.memoizedState;l!==h||d!==y||jo.current||ka?(typeof p=="function"&&(gv(n,o,p,r),y=n.memoizedState),(u=ka||Uj(n,o,u,r,d,y,c)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,c)),typeof i.componentDidUpdate=="function"&&(n.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(n.flags|=1024),n.memoizedProps=r,n.memoizedState=y),i.props=r,i.state=y,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&d===t.memoizedState||(n.flags|=1024),r=!1)}return Ov(t,n,o,r,a,s)}function Ov(t,n,o,r,s,a){S_(t,n);var i=(n.flags&128)!==0;if(!r&&!i)return s&&Cj(n,o,!1),Ai(t,n,a);r=n.stateNode,ZL.current=n;var l=i&&typeof o.getDerivedStateFromError!="function"?null:r.render();return n.flags|=1,t!==null&&i?(n.child=Ac(n,t.child,null,a),n.child=Ac(n,null,l,a)):uo(t,n,l,a),n.memoizedState=r.state,s&&Cj(n,o,!0),n.child}function __(t){var n=t.stateNode;n.pendingContext?kj(t,n.pendingContext,n.pendingContext!==n.context):n.context&&kj(t,n.context,!1),vv(t,n.containerInfo)}function k_(t,n,o,r,s){return Mc(),cv(s),n.flags|=256,uo(t,n,o,r),n.child}var Lv={dehydrated:null,treeContext:null,retryLane:0};function Rv(t){return{baseLanes:t,cachePool:null,transitions:null}}function E_(t,n,o){var r=n.pendingProps,s=Br.current,a=!1,i=(n.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,n.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),xr(Br,s&1),t===null)return lv(n),t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(n.mode&1?t.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(i=r.children,t=r.fallback,a?(r=n.mode,a=n.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=kf(i,r,0,null),t=Ml(t,r,o,null),a.return=n,t.return=n,a.sibling=t,n.child=a,n.child.memoizedState=Rv(o),n.memoizedState=Lv,t):Dv(n,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return JL(t,n,i,r,l,s,o);if(a){a=r.fallback,i=n.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&n.child!==s?(r=n.child,r.childLanes=0,r.pendingProps=c,n.deletions=null):(r=Aa(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=Aa(l,a):(a=Ml(a,i,o,null),a.flags|=2),a.return=n,r.return=n,r.sibling=a,n.child=r,r=a,a=n.child,i=t.child.memoizedState,i=i===null?Rv(o):{baseLanes:i.baseLanes|o,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~o,n.memoizedState=Lv,r}return a=t.child,t=a.sibling,r=Aa(a,{mode:"visible",children:r.children}),!(n.mode&1)&&(r.lanes=o),r.return=n,r.sibling=null,t!==null&&(o=n.deletions,o===null?(n.deletions=[t],n.flags|=16):o.push(t)),n.child=r,n.memoizedState=null,r}function Dv(t,n){return n=kf({mode:"visible",children:n},t.mode,0,null),n.return=t,t.child=n}function hf(t,n,o,r){return r!==null&&cv(r),Ac(n,t.child,null,o),t=Dv(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function JL(t,n,o,r,s,a,i){if(o)return n.flags&256?(n.flags&=-257,r=Tv(Error(Je(422))),hf(t,n,i,r)):n.memoizedState!==null?(n.child=t.child,n.flags|=128,null):(a=r.fallback,s=n.mode,r=kf({mode:"visible",children:r.children},s,0,null),a=Ml(a,s,i,null),a.flags|=2,r.return=n,a.return=n,r.sibling=a,n.child=r,n.mode&1&&Ac(n,t.child,null,i),n.child.memoizedState=Rv(i),n.memoizedState=Lv,a);if(!(n.mode&1))return hf(t,n,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(Je(419)),r=Tv(a,r,void 0),hf(t,n,i,r)}if(l=(i&t.childLanes)!==0,ko||l){if(r=Sn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Ti(t,s),Os(r,t,s,-1))}return Qv(),r=Tv(Error(Je(421))),hf(t,n,i,r)}return s.data==="$?"?(n.flags|=128,n.child=t.child,n=hR.bind(null,t),s._reactRetry=n,null):(t=a.treeContext,Ho=wa(s.nextSibling),Vo=n,Rr=!0,Ms=null,t!==null&&(ls[cs++]=Pi,ls[cs++]=Mi,ls[cs++]=xl,Pi=t.id,Mi=t.overflow,xl=n),n=Dv(n,r.children),n.flags|=4096,n)}function C_(t,n,o){t.lanes|=n;var r=t.alternate;r!==null&&(r.lanes|=n),pv(t.return,n,o)}function Fv(t,n,o,r,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:r,tail:o,tailMode:s}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=o,a.tailMode=s)}function P_(t,n,o){var r=n.pendingProps,s=r.revealOrder,a=r.tail;if(uo(t,n,r.children,o),r=Br.current,r&2)r=r&1|2,n.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C_(t,o,n);else if(t.tag===19)C_(t,o,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xr(Br,r),!(n.mode&1))n.memoizedState=null;else switch(s){case"forwards":for(o=n.child,s=null;o!==null;)t=o.alternate,t!==null&&sf(t)===null&&(s=o),o=o.sibling;o=s,o===null?(s=n.child,n.child=null):(s=o.sibling,o.sibling=null),Fv(n,!1,s,o,a);break;case"backwards":for(o=null,s=n.child,n.child=null;s!==null;){if(t=s.alternate,t!==null&&sf(t)===null){n.child=s;break}t=s.sibling,s.sibling=o,o=s,s=t}Fv(n,!0,o,null,a);break;case"together":Fv(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function pf(t,n){!(n.mode&1)&&t!==null&&(t.alternate=null,n.alternate=null,n.flags|=2)}function Ai(t,n,o){if(t!==null&&(n.dependencies=t.dependencies),kl|=n.lanes,!(o&n.childLanes))return null;if(t!==null&&n.child!==t.child)throw Error(Je(153));if(n.child!==null){for(t=n.child,o=Aa(t,t.pendingProps),n.child=o,o.return=n;t.sibling!==null;)t=t.sibling,o=o.sibling=Aa(t,t.pendingProps),o.return=n;o.sibling=null}return n.child}function eR(t,n,o){switch(n.tag){case 3:__(n),Mc();break;case 5:Wj(n);break;case 1:_o(n.type)&&Yp(n);break;case 4:vv(n,n.stateNode.containerInfo);break;case 10:var r=n.type._context,s=n.memoizedProps.value;xr(Jp,r._currentValue),r._currentValue=s;break;case 13:if(r=n.memoizedState,r!==null)return r.dehydrated!==null?(xr(Br,Br.current&1),n.flags|=128,null):o&n.child.childLanes?E_(t,n,o):(xr(Br,Br.current&1),t=Ai(t,n,o),t!==null?t.sibling:null);xr(Br,Br.current&1);break;case 19:if(r=(o&n.childLanes)!==0,t.flags&128){if(r)return P_(t,n,o);n.flags|=128}if(s=n.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),xr(Br,Br.current),r)break;return null;case 22:case 23:return n.lanes=0,w_(t,n,o)}return Ai(t,n,o)}var M_,Nv,T_,I_;M_=function(t,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)t.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Nv=function(){},T_=function(t,n,o,r){var s=t.memoizedProps;if(s!==r){t=n.stateNode,jl(Qs.current);var a=null;switch(o){case"input":s=p0(t,s),r=p0(t,r),a=[];break;case"select":s=Ur({},s,{value:void 0}),r=Ur({},r,{value:void 0}),a=[];break;case"textarea":s=g0(t,s),r=g0(t,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Wp)}v0(o,r);var i;o=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(o||(o={}),o[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Qu.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=s==null?void 0:s[u],r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(o||(o={}),o[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(o||(o={}),o[i]=c[i])}else o||(a||(a=[]),a.push(u,o)),o=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Qu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Mr("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}o&&(a=a||[]).push("style",o);var u=a;(n.updateQueue=u)&&(n.flags|=4)}},I_=function(t,n,o,r){o!==r&&(n.flags|=4)};function Od(t,n){if(!Rr)switch(t.tailMode){case"hidden":n=t.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var r=null;o!==null;)o.alternate!==null&&(r=o),o=o.sibling;r===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Vn(t){var n=t.alternate!==null&&t.alternate.child===t.child,o=0,r=0;if(n)for(var s=t.child;s!==null;)o|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)o|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=o,n}function tR(t,n,o){var r=n.pendingProps;switch(iv(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(n),null;case 1:return _o(n.type)&&qp(),Vn(n),null;case 3:return r=n.stateNode,Oc(),Tr(jo),Tr(zn),wv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Zp(n)?n.flags|=4:t===null||t.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Ms!==null&&(Yv(Ms),Ms=null))),Nv(t,n),Vn(n),null;case 5:bv(n);var s=jl(Pd.current);if(o=n.type,t!==null&&n.stateNode!=null)T_(t,n,o,r,s),t.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!r){if(n.stateNode===null)throw Error(Je(166));return Vn(n),null}if(t=jl(Qs.current),Zp(n)){r=n.stateNode,o=n.type;var a=n.memoizedProps;switch(r[Xs]=n,r[jd]=a,t=(n.mode&1)!==0,o){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(s=0;s<xd.length;s++)Mr(xd[s],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":u2(r,a),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Mr("invalid",r);break;case"textarea":p2(r,a),Mr("invalid",r)}v0(o,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Hp(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Hp(r.textContent,l,t),s=["children",""+l]):Qu.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Mr("scroll",r)}switch(o){case"input":wp(r),h2(r,a,!0);break;case"textarea":wp(r),m2(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Wp)}r=s,n.updateQueue=r,r!==null&&(n.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=g2(o)),t==="http://www.w3.org/1999/xhtml"?o==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(o,{is:r.is}):(t=i.createElement(o),o==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,o),t[Xs]=n,t[jd]=r,M_(t,n,!1,!1),n.stateNode=t;e:{switch(i=b0(o,r),o){case"dialog":Mr("cancel",t),Mr("close",t),s=r;break;case"iframe":case"object":case"embed":Mr("load",t),s=r;break;case"video":case"audio":for(s=0;s<xd.length;s++)Mr(xd[s],t);s=r;break;case"source":Mr("error",t),s=r;break;case"img":case"image":case"link":Mr("error",t),Mr("load",t),s=r;break;case"details":Mr("toggle",t),s=r;break;case"input":u2(t,r),s=p0(t,r),Mr("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ur({},r,{value:void 0}),Mr("invalid",t);break;case"textarea":p2(t,r),s=g0(t,r),Mr("invalid",t);break;default:s=r}v0(o,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?b2(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&y2(t,c)):a==="children"?typeof c=="string"?(o!=="textarea"||c!=="")&&td(t,c):typeof c=="number"&&td(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Qu.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Mr("scroll",t):c!=null&&r0(t,a,c,i))}switch(o){case"input":wp(t),h2(t,r,!1);break;case"textarea":wp(t),m2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+fa(r.value));break;case"select":t.multiple=!!r.multiple,a=r.value,a!=null?fc(t,!!r.multiple,a,!1):r.defaultValue!=null&&fc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Wp)}switch(o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Vn(n),null;case 6:if(t&&n.stateNode!=null)I_(t,n,t.memoizedProps,r);else{if(typeof r!="string"&&n.stateNode===null)throw Error(Je(166));if(o=jl(Pd.current),jl(Qs.current),Zp(n)){if(r=n.stateNode,o=n.memoizedProps,r[Xs]=n,(a=r.nodeValue!==o)&&(t=Vo,t!==null))switch(t.tag){case 3:Hp(r.nodeValue,o,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hp(r.nodeValue,o,(t.mode&1)!==0)}a&&(n.flags|=4)}else r=(o.nodeType===9?o:o.ownerDocument).createTextNode(r),r[Xs]=n,n.stateNode=r}return Vn(n),null;case 13:if(Tr(Br),r=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Rr&&Ho!==null&&n.mode&1&&!(n.flags&128))Oj(),Mc(),n.flags|=98560,a=!1;else if(a=Zp(n),r!==null&&r.dehydrated!==null){if(t===null){if(!a)throw Error(Je(318));if(a=n.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Je(317));a[Xs]=n}else Mc(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Vn(n),a=!1}else Ms!==null&&(Yv(Ms),Ms=null),a=!0;if(!a)return n.flags&65536?n:null}return n.flags&128?(n.lanes=o,n):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(n.child.flags|=8192,n.mode&1&&(t===null||Br.current&1?vn===0&&(vn=3):Qv())),n.updateQueue!==null&&(n.flags|=4),Vn(n),null);case 4:return Oc(),Nv(t,n),t===null&&wd(n.stateNode.containerInfo),Vn(n),null;case 10:return hv(n.type._context),Vn(n),null;case 17:return _o(n.type)&&qp(),Vn(n),null;case 19:if(Tr(Br),a=n.memoizedState,a===null)return Vn(n),null;if(r=(n.flags&128)!==0,i=a.rendering,i===null)if(r)Od(a,!1);else{if(vn!==0||t!==null&&t.flags&128)for(t=n.child;t!==null;){if(i=sf(t),i!==null){for(n.flags|=128,Od(a,!1),r=i.updateQueue,r!==null&&(n.updateQueue=r,n.flags|=4),n.subtreeFlags=0,r=o,o=n.child;o!==null;)a=o,t=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),o=o.sibling;return xr(Br,Br.current&1|2),n.child}t=t.sibling}a.tail!==null&&Jr()>Fc&&(n.flags|=128,r=!0,Od(a,!1),n.lanes=4194304)}else{if(!r)if(t=sf(i),t!==null){if(n.flags|=128,r=!0,o=t.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),Od(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Rr)return Vn(n),null}else 2*Jr()-a.renderingStartTime>Fc&&o!==1073741824&&(n.flags|=128,r=!0,Od(a,!1),n.lanes=4194304);a.isBackwards?(i.sibling=n.child,n.child=i):(o=a.last,o!==null?o.sibling=i:n.child=i,a.last=i)}return a.tail!==null?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.renderingStartTime=Jr(),n.sibling=null,o=Br.current,xr(Br,r?o&1|2:o&1),n):(Vn(n),null);case 22:case 23:return Xv(),r=n.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(n.flags|=8192),r&&n.mode&1?Wo&1073741824&&(Vn(n),n.subtreeFlags&6&&(n.flags|=8192)):Vn(n),null;case 24:return null;case 25:return null}throw Error(Je(156,n.tag))}function rR(t,n){switch(iv(n),n.tag){case 1:return _o(n.type)&&qp(),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Oc(),Tr(jo),Tr(zn),wv(),t=n.flags,t&65536&&!(t&128)?(n.flags=t&-65537|128,n):null;case 5:return bv(n),null;case 13:if(Tr(Br),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(Je(340));Mc()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Tr(Br),null;case 4:return Oc(),null;case 10:return hv(n.type._context),null;case 22:case 23:return Xv(),null;case 24:return null;default:return null}}var ff=!1,Hn=!1,nR=typeof WeakSet=="function"?WeakSet:Set,ft=null;function Rc(t,n){var o=t.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(r){Yr(t,n,r)}else o.current=null}function A_(t,n,o){try{o()}catch(r){Yr(t,n,r)}}var O_=!1;function oR(t,n){if(Q0=Op,t=cj(),V0(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var r=o.getSelection&&o.getSelection();if(r&&r.rangeCount!==0){o=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{o.nodeType,a.nodeType}catch{o=null;break e}var i=0,l=-1,c=-1,u=0,f=0,h=t,d=null;t:for(;;){for(var p;h!==o||s!==0&&h.nodeType!==3||(l=i+s),h!==a||r!==0&&h.nodeType!==3||(c=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===o&&++u===s&&(l=i),d===a&&++f===r&&(c=i),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}o=l===-1||c===-1?null:{start:l,end:c}}else o=null}o=o||{start:0,end:0}}else o=null;for(Z0={focusedElem:t,selectionRange:o},Op=!1,ft=n;ft!==null;)if(n=ft,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,ft=t;else for(;ft!==null;){n=ft;try{var y=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,b=y.memoizedState,m=n.stateNode,v=m.getSnapshotBeforeUpdate(n.elementType===n.type?g:Ts(n.type,g),b);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=n.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(w){Yr(n,n.return,w)}if(t=n.sibling,t!==null){t.return=n.return,ft=t;break}ft=n.return}return y=O_,O_=!1,y}function Ld(t,n,o){var r=n.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&A_(n,o,a)}s=s.next}while(s!==r)}}function mf(t,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&t)===t){var r=o.create;o.destroy=r()}o=o.next}while(o!==n)}}function Uv(t){var n=t.ref;if(n!==null){var o=t.stateNode;switch(t.tag){case 5:t=o;break;default:t=o}typeof n=="function"?n(t):n.current=t}}function L_(t){var n=t.alternate;n!==null&&(t.alternate=null,L_(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&(delete n[Xs],delete n[jd],delete n[rv],delete n[BL],delete n[zL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function R_(t){return t.tag===5||t.tag===3||t.tag===4}function D_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||R_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bv(t,n,o){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(t,n):o.insertBefore(t,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(t,o)):(n=o,n.appendChild(t)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Wp));else if(r!==4&&(t=t.child,t!==null))for(Bv(t,n,o),t=t.sibling;t!==null;)Bv(t,n,o),t=t.sibling}function zv(t,n,o){var r=t.tag;if(r===5||r===6)t=t.stateNode,n?o.insertBefore(t,n):o.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(zv(t,n,o),t=t.sibling;t!==null;)zv(t,n,o),t=t.sibling}var Mn=null,Is=!1;function Ca(t,n,o){for(o=o.child;o!==null;)F_(t,n,o),o=o.sibling}function F_(t,n,o){if(Ks&&typeof Ks.onCommitFiberUnmount=="function")try{Ks.onCommitFiberUnmount(Cp,o)}catch{}switch(o.tag){case 5:Hn||Rc(o,n);case 6:var r=Mn,s=Is;Mn=null,Ca(t,n,o),Mn=r,Is=s,Mn!==null&&(Is?(t=Mn,o=o.stateNode,t.nodeType===8?t.parentNode.removeChild(o):t.removeChild(o)):Mn.removeChild(o.stateNode));break;case 18:Mn!==null&&(Is?(t=Mn,o=o.stateNode,t.nodeType===8?tv(t.parentNode,o):t.nodeType===1&&tv(t,o),hd(t)):tv(Mn,o.stateNode));break;case 4:r=Mn,s=Is,Mn=o.stateNode.containerInfo,Is=!0,Ca(t,n,o),Mn=r,Is=s;break;case 0:case 11:case 14:case 15:if(!Hn&&(r=o.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&A_(o,n,i),s=s.next}while(s!==r)}Ca(t,n,o);break;case 1:if(!Hn&&(Rc(o,n),r=o.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=o.memoizedProps,r.state=o.memoizedState,r.componentWillUnmount()}catch(l){Yr(o,n,l)}Ca(t,n,o);break;case 21:Ca(t,n,o);break;case 22:o.mode&1?(Hn=(r=Hn)||o.memoizedState!==null,Ca(t,n,o),Hn=r):Ca(t,n,o);break;default:Ca(t,n,o)}}function N_(t){var n=t.updateQueue;if(n!==null){t.updateQueue=null;var o=t.stateNode;o===null&&(o=t.stateNode=new nR),n.forEach(function(r){var s=pR.bind(null,t,r);o.has(r)||(o.add(r),r.then(s,s))})}}function As(t,n){var o=n.deletions;if(o!==null)for(var r=0;r<o.length;r++){var s=o[r];try{var a=t,i=n,l=i;e:for(;l!==null;){switch(l.tag){case 5:Mn=l.stateNode,Is=!1;break e;case 3:Mn=l.stateNode.containerInfo,Is=!0;break e;case 4:Mn=l.stateNode.containerInfo,Is=!0;break e}l=l.return}if(Mn===null)throw Error(Je(160));F_(a,i,s),Mn=null,Is=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Yr(s,n,u)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)U_(n,t),n=n.sibling}function U_(t,n){var o=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(As(n,t),Js(t),r&4){try{Ld(3,t,t.return),mf(3,t)}catch(g){Yr(t,t.return,g)}try{Ld(5,t,t.return)}catch(g){Yr(t,t.return,g)}}break;case 1:As(n,t),Js(t),r&512&&o!==null&&Rc(o,o.return);break;case 5:if(As(n,t),Js(t),r&512&&o!==null&&Rc(o,o.return),t.flags&32){var s=t.stateNode;try{td(s,"")}catch(g){Yr(t,t.return,g)}}if(r&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=o!==null?o.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&d2(s,a),b0(l,i);var u=b0(l,a);for(i=0;i<c.length;i+=2){var f=c[i],h=c[i+1];f==="style"?b2(s,h):f==="dangerouslySetInnerHTML"?y2(s,h):f==="children"?td(s,h):r0(s,f,h,u)}switch(l){case"input":f0(s,a);break;case"textarea":f2(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?fc(s,!!a.multiple,p,!1):d!==!!a.multiple&&(a.defaultValue!=null?fc(s,!!a.multiple,a.defaultValue,!0):fc(s,!!a.multiple,a.multiple?[]:"",!1))}s[jd]=a}catch(g){Yr(t,t.return,g)}}break;case 6:if(As(n,t),Js(t),r&4){if(t.stateNode===null)throw Error(Je(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(g){Yr(t,t.return,g)}}break;case 3:if(As(n,t),Js(t),r&4&&o!==null&&o.memoizedState.isDehydrated)try{hd(n.containerInfo)}catch(g){Yr(t,t.return,g)}break;case 4:As(n,t),Js(t);break;case 13:As(n,t),Js(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Hv=Jr())),r&4&&N_(t);break;case 22:if(f=o!==null&&o.memoizedState!==null,t.mode&1?(Hn=(u=Hn)||f,As(n,t),Hn=u):As(n,t),Js(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(ft=t,f=t.child;f!==null;){for(h=ft=f;ft!==null;){switch(d=ft,p=d.child,d.tag){case 0:case 11:case 14:case 15:Ld(4,d,d.return);break;case 1:Rc(d,d.return);var y=d.stateNode;if(typeof y.componentWillUnmount=="function"){r=d,o=d.return;try{n=r,y.props=n.memoizedProps,y.state=n.memoizedState,y.componentWillUnmount()}catch(g){Yr(r,o,g)}}break;case 5:Rc(d,d.return);break;case 22:if(d.memoizedState!==null){G_(h);continue}}p!==null?(p.return=d,ft=p):G_(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=v2("display",i))}catch(g){Yr(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Yr(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:As(n,t),Js(t),r&4&&N_(t);break;case 21:break;default:As(n,t),Js(t)}}function Js(t){var n=t.flags;if(n&2){try{e:{for(var o=t.return;o!==null;){if(R_(o)){var r=o;break e}o=o.return}throw Error(Je(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(td(s,""),r.flags&=-33);var a=D_(t);zv(t,a,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=D_(t);Bv(t,l,i);break;default:throw Error(Je(161))}}catch(c){Yr(t,t.return,c)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function sR(t,n,o){ft=t,B_(t)}function B_(t,n,o){for(var r=(t.mode&1)!==0;ft!==null;){var s=ft,a=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||ff;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Hn;l=ff;var u=Hn;if(ff=i,(Hn=c)&&!u)for(ft=s;ft!==null;)i=ft,c=i.child,i.tag===22&&i.memoizedState!==null?V_(s):c!==null?(c.return=i,ft=c):V_(s);for(;a!==null;)ft=a,B_(a),a=a.sibling;ft=s,ff=l,Hn=u}z_(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ft=a):z_(t)}}function z_(t){for(;ft!==null;){var n=ft;if(n.flags&8772){var o=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Hn||mf(5,n);break;case 1:var r=n.stateNode;if(n.flags&4&&!Hn)if(o===null)r.componentDidMount();else{var s=n.elementType===n.type?o.memoizedProps:Ts(n.type,o.memoizedProps);r.componentDidUpdate(s,o.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=n.updateQueue;a!==null&&Fj(n,a,r);break;case 3:var i=n.updateQueue;if(i!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}Fj(n,i,o)}break;case 5:var l=n.stateNode;if(o===null&&n.flags&4){o=l;var c=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&o.focus();break;case"img":c.src&&(o.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var u=n.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&hd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}Hn||n.flags&512&&Uv(n)}catch(d){Yr(n,n.return,d)}}if(n===t){ft=null;break}if(o=n.sibling,o!==null){o.return=n.return,ft=o;break}ft=n.return}}function G_(t){for(;ft!==null;){var n=ft;if(n===t){ft=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ft=o;break}ft=n.return}}function V_(t){for(;ft!==null;){var n=ft;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{mf(4,n)}catch(c){Yr(n,o,c)}break;case 1:var r=n.stateNode;if(typeof r.componentDidMount=="function"){var s=n.return;try{r.componentDidMount()}catch(c){Yr(n,s,c)}}var a=n.return;try{Uv(n)}catch(c){Yr(n,a,c)}break;case 5:var i=n.return;try{Uv(n)}catch(c){Yr(n,i,c)}}}catch(c){Yr(n,n.return,c)}if(n===t){ft=null;break}var l=n.sibling;if(l!==null){l.return=n.return,ft=l;break}ft=n.return}}var iR=Math.ceil,gf=ki.ReactCurrentDispatcher,Gv=ki.ReactCurrentOwner,hs=ki.ReactCurrentBatchConfig,Kt=0,Sn=null,un=null,Tn=0,Wo=0,Dc=Sa(0),vn=0,Rd=null,kl=0,yf=0,Vv=0,Dd=null,Eo=null,Hv=0,Fc=1/0,Oi=null,vf=!1,Wv=null,Pa=null,bf=!1,Ma=null,xf=0,Fd=0,$v=null,wf=-1,Sf=0;function ho(){return Kt&6?Jr():wf!==-1?wf:wf=Jr()}function Ta(t){return t.mode&1?Kt&2&&Tn!==0?Tn&-Tn:VL.transition!==null?(Sf===0&&(Sf=L2()),Sf):(t=ar,t!==0||(t=window.event,t=t===void 0?16:V2(t.type)),t):1}function Os(t,n,o,r){if(50<Fd)throw Fd=0,$v=null,Error(Je(185));ad(t,o,r),(!(Kt&2)||t!==Sn)&&(t===Sn&&(!(Kt&2)&&(yf|=o),vn===4&&Ia(t,Tn)),Co(t,r),o===1&&Kt===0&&!(n.mode&1)&&(Fc=Jr()+500,Kp&&_a()))}function Co(t,n){var o=t.callbackNode;V4(t,n);var r=Tp(t,t===Sn?Tn:0);if(r===0)o!==null&&I2(o),t.callbackNode=null,t.callbackPriority=0;else if(n=r&-r,t.callbackPriority!==n){if(o!=null&&I2(o),n===1)t.tag===0?GL(W_.bind(null,t)):Pj(W_.bind(null,t)),NL(function(){!(Kt&6)&&_a()}),o=null;else{switch(R2(r)){case 1:o=E0;break;case 4:o=A2;break;case 16:o=Ep;break;case 536870912:o=O2;break;default:o=Ep}o=J_(o,H_.bind(null,t))}t.callbackPriority=n,t.callbackNode=o}}function H_(t,n){if(wf=-1,Sf=0,Kt&6)throw Error(Je(327));var o=t.callbackNode;if(Nc()&&t.callbackNode!==o)return null;var r=Tp(t,t===Sn?Tn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||n)n=jf(t,r);else{n=r;var s=Kt;Kt|=2;var a=q_();(Sn!==t||Tn!==n)&&(Oi=null,Fc=Jr()+500,Cl(t,n));do try{cR();break}catch(l){$_(t,l)}while(1);dv(),gf.current=a,Kt=s,un!==null?n=0:(Sn=null,Tn=0,n=vn)}if(n!==0){if(n===2&&(s=C0(t),s!==0&&(r=s,n=qv(t,s))),n===1)throw o=Rd,Cl(t,0),Ia(t,r),Co(t,Jr()),o;if(n===6)Ia(t,r);else{if(s=t.current.alternate,!(r&30)&&!aR(s)&&(n=jf(t,r),n===2&&(a=C0(t),a!==0&&(r=a,n=qv(t,a))),n===1))throw o=Rd,Cl(t,0),Ia(t,r),Co(t,Jr()),o;switch(t.finishedWork=s,t.finishedLanes=r,n){case 0:case 1:throw Error(Je(345));case 2:Pl(t,Eo,Oi);break;case 3:if(Ia(t,r),(r&130023424)===r&&(n=Hv+500-Jr(),10<n)){if(Tp(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ho(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ev(Pl.bind(null,t,Eo,Oi),n);break}Pl(t,Eo,Oi);break;case 4:if(Ia(t,r),(r&4194240)===r)break;for(n=t.eventTimes,s=-1;0<r;){var i=31-Cs(r);a=1<<i,i=n[i],i>s&&(s=i),r&=~a}if(r=s,r=Jr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iR(r/1960))-r,10<r){t.timeoutHandle=ev(Pl.bind(null,t,Eo,Oi),r);break}Pl(t,Eo,Oi);break;case 5:Pl(t,Eo,Oi);break;default:throw Error(Je(329))}}}return Co(t,Jr()),t.callbackNode===o?H_.bind(null,t):null}function qv(t,n){var o=Dd;return t.current.memoizedState.isDehydrated&&(Cl(t,n).flags|=256),t=jf(t,n),t!==2&&(n=Eo,Eo=o,n!==null&&Yv(n)),t}function Yv(t){Eo===null?Eo=t:Eo.push.apply(Eo,t)}function aR(t){for(var n=t;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var r=0;r<o.length;r++){var s=o[r],a=s.getSnapshot;s=s.value;try{if(!Ps(a(),s))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ia(t,n){for(n&=~Vv,n&=~yf,t.suspendedLanes|=n,t.pingedLanes&=~n,t=t.expirationTimes;0<n;){var o=31-Cs(n),r=1<<o;t[o]=-1,n&=~r}}function W_(t){if(Kt&6)throw Error(Je(327));Nc();var n=Tp(t,0);if(!(n&1))return Co(t,Jr()),null;var o=jf(t,n);if(t.tag!==0&&o===2){var r=C0(t);r!==0&&(n=r,o=qv(t,r))}if(o===1)throw o=Rd,Cl(t,0),Ia(t,n),Co(t,Jr()),o;if(o===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=n,Pl(t,Eo,Oi),Co(t,Jr()),null}function Kv(t,n){var o=Kt;Kt|=1;try{return t(n)}finally{Kt=o,Kt===0&&(Fc=Jr()+500,Kp&&_a())}}function El(t){Ma!==null&&Ma.tag===0&&!(Kt&6)&&Nc();var n=Kt;Kt|=1;var o=hs.transition,r=ar;try{if(hs.transition=null,ar=1,t)return t()}finally{ar=r,hs.transition=o,Kt=n,!(Kt&6)&&_a()}}function Xv(){Wo=Dc.current,Tr(Dc)}function Cl(t,n){t.finishedWork=null,t.finishedLanes=0;var o=t.timeoutHandle;if(o!==-1&&(t.timeoutHandle=-1,FL(o)),un!==null)for(o=un.return;o!==null;){var r=o;switch(iv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qp();break;case 3:Oc(),Tr(jo),Tr(zn),wv();break;case 5:bv(r);break;case 4:Oc();break;case 13:Tr(Br);break;case 19:Tr(Br);break;case 10:hv(r.type._context);break;case 22:case 23:Xv()}o=o.return}if(Sn=t,un=t=Aa(t.current,null),Tn=Wo=n,vn=0,Rd=null,Vv=yf=kl=0,Eo=Dd=null,Sl!==null){for(n=0;n<Sl.length;n++)if(o=Sl[n],r=o.interleaved,r!==null){o.interleaved=null;var s=r.next,a=o.pending;if(a!==null){var i=a.next;a.next=s,r.next=i}o.pending=r}Sl=null}return t}function $_(t,n){do{var o=un;try{if(dv(),af.current=df,lf){for(var r=zr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}lf=!1}if(_l=0,wn=yn=zr=null,Md=!1,Td=0,Gv.current=null,o===null||o.return===null){vn=1,Rd=n,un=null;break}e:{var a=t,i=o.return,l=o,c=n;if(n=Tn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=g_(i);if(p!==null){p.flags&=-257,y_(p,i,l,a,n),p.mode&1&&m_(a,u,n),n=p,c=u;var y=n.updateQueue;if(y===null){var g=new Set;g.add(c),n.updateQueue=g}else y.add(c);break e}else{if(!(n&1)){m_(a,u,n),Qv();break e}c=Error(Je(426))}}else if(Rr&&l.mode&1){var b=g_(i);if(b!==null){!(b.flags&65536)&&(b.flags|=256),y_(b,i,l,a,n),cv(Lc(c,l));break e}}a=c=Lc(c,l),vn!==4&&(vn=2),Dd===null?Dd=[a]:Dd.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,n&=-n,a.lanes|=n;var m=p_(a,c,n);Dj(a,m);break e;case 1:l=c;var v=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Pa===null||!Pa.has(x)))){a.flags|=65536,n&=-n,a.lanes|=n;var w=f_(a,l,n);Dj(a,w);break e}}a=a.return}while(a!==null)}K_(o)}catch(S){n=S,un===o&&o!==null&&(un=o=o.return);continue}break}while(1)}function q_(){var t=gf.current;return gf.current=df,t===null?df:t}function Qv(){(vn===0||vn===3||vn===2)&&(vn=4),Sn===null||!(kl&268435455)&&!(yf&268435455)||Ia(Sn,Tn)}function jf(t,n){var o=Kt;Kt|=2;var r=q_();(Sn!==t||Tn!==n)&&(Oi=null,Cl(t,n));do try{lR();break}catch(s){$_(t,s)}while(1);if(dv(),Kt=o,gf.current=r,un!==null)throw Error(Je(261));return Sn=null,Tn=0,vn}function lR(){for(;un!==null;)Y_(un)}function cR(){for(;un!==null&&!L4();)Y_(un)}function Y_(t){var n=Z_(t.alternate,t,Wo);t.memoizedProps=t.pendingProps,n===null?K_(t):un=n,Gv.current=null}function K_(t){var n=t;do{var o=n.alternate;if(t=n.return,n.flags&32768){if(o=rR(o,n),o!==null){o.flags&=32767,un=o;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vn=6,un=null;return}}else if(o=tR(o,n,Wo),o!==null){un=o;return}if(n=n.sibling,n!==null){un=n;return}un=n=t}while(n!==null);vn===0&&(vn=5)}function Pl(t,n,o){var r=ar,s=hs.transition;try{hs.transition=null,ar=1,uR(t,n,o,r)}finally{hs.transition=s,ar=r}return null}function uR(t,n,o,r){do Nc();while(Ma!==null);if(Kt&6)throw Error(Je(327));o=t.finishedWork;var s=t.finishedLanes;if(o===null)return null;if(t.finishedWork=null,t.finishedLanes=0,o===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var a=o.lanes|o.childLanes;if(H4(t,a),t===Sn&&(un=Sn=null,Tn=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||bf||(bf=!0,J_(Ep,function(){return Nc(),null})),a=(o.flags&15990)!==0,o.subtreeFlags&15990||a){a=hs.transition,hs.transition=null;var i=ar;ar=1;var l=Kt;Kt|=4,Gv.current=null,oR(t,o),U_(o,t),TL(Z0),Op=!!Q0,Z0=Q0=null,t.current=o,sR(o),R4(),Kt=l,ar=i,hs.transition=a}else t.current=o;if(bf&&(bf=!1,Ma=t,xf=s),a=t.pendingLanes,a===0&&(Pa=null),N4(o.stateNode),Co(t,Jr()),n!==null)for(r=t.onRecoverableError,o=0;o<n.length;o++)s=n[o],r(s.value,{componentStack:s.stack,digest:s.digest});if(vf)throw vf=!1,t=Wv,Wv=null,t;return xf&1&&t.tag!==0&&Nc(),a=t.pendingLanes,a&1?t===$v?Fd++:(Fd=0,$v=t):Fd=0,_a(),null}function Nc(){if(Ma!==null){var t=R2(xf),n=hs.transition,o=ar;try{if(hs.transition=null,ar=16>t?16:t,Ma===null)var r=!1;else{if(t=Ma,Ma=null,xf=0,Kt&6)throw Error(Je(331));var s=Kt;for(Kt|=4,ft=t.current;ft!==null;){var a=ft,i=a.child;if(ft.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ft=u;ft!==null;){var f=ft;switch(f.tag){case 0:case 11:case 15:Ld(8,f,a)}var h=f.child;if(h!==null)h.return=f,ft=h;else for(;ft!==null;){f=ft;var d=f.sibling,p=f.return;if(L_(f),f===u){ft=null;break}if(d!==null){d.return=p,ft=d;break}ft=p}}}var y=a.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}ft=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ft=i;else e:for(;ft!==null;){if(a=ft,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ld(9,a,a.return)}var m=a.sibling;if(m!==null){m.return=a.return,ft=m;break e}ft=a.return}}var v=t.current;for(ft=v;ft!==null;){i=ft;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,ft=x;else e:for(i=v;ft!==null;){if(l=ft,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mf(9,l)}}catch(S){Yr(l,l.return,S)}if(l===i){ft=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ft=w;break e}ft=l.return}}if(Kt=s,_a(),Ks&&typeof Ks.onPostCommitFiberRoot=="function")try{Ks.onPostCommitFiberRoot(Cp,t)}catch{}r=!0}return r}finally{ar=o,hs.transition=n}}return!1}function X_(t,n,o){n=Lc(o,n),n=p_(t,n,1),t=Ea(t,n,1),n=ho(),t!==null&&(ad(t,1,n),Co(t,n))}function Yr(t,n,o){if(t.tag===3)X_(t,t,o);else for(;n!==null;){if(n.tag===3){X_(n,t,o);break}else if(n.tag===1){var r=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pa===null||!Pa.has(r))){t=Lc(o,t),t=f_(n,t,1),n=Ea(n,t,1),t=ho(),n!==null&&(ad(n,1,t),Co(n,t));break}}n=n.return}}function dR(t,n,o){var r=t.pingCache;r!==null&&r.delete(n),n=ho(),t.pingedLanes|=t.suspendedLanes&o,Sn===t&&(Tn&o)===o&&(vn===4||vn===3&&(Tn&130023424)===Tn&&500>Jr()-Hv?Cl(t,0):Vv|=o),Co(t,n)}function Q_(t,n){n===0&&(t.mode&1?(n=Mp,Mp<<=1,!(Mp&130023424)&&(Mp=4194304)):n=1);var o=ho();t=Ti(t,n),t!==null&&(ad(t,n,o),Co(t,o))}function hR(t){var n=t.memoizedState,o=0;n!==null&&(o=n.retryLane),Q_(t,o)}function pR(t,n){var o=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(o=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Je(314))}r!==null&&r.delete(n),Q_(t,o)}var Z_;Z_=function(t,n,o){if(t!==null)if(t.memoizedProps!==n.pendingProps||jo.current)ko=!0;else{if(!(t.lanes&o)&&!(n.flags&128))return ko=!1,eR(t,n,o);ko=!!(t.flags&131072)}else ko=!1,Rr&&n.flags&1048576&&Mj(n,Qp,n.index);switch(n.lanes=0,n.tag){case 2:var r=n.type;pf(t,n),t=n.pendingProps;var s=Ec(n,zn.current);Ic(n,o),s=_v(null,n,r,t,s,o);var a=kv();return n.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,_o(r)?(a=!0,Yp(n)):a=!1,n.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,mv(n),s.updater=nf,n.stateNode=s,s._reactInternals=n,yv(n,r,t,o),n=Ov(null,n,r,!0,a,o)):(n.tag=0,Rr&&a&&sv(n),uo(null,n,s,o),n=n.child),n;case 16:r=n.elementType;e:{switch(pf(t,n),t=n.pendingProps,s=r._init,r=s(r._payload),n.type=r,s=n.tag=mR(r),t=Ts(r,t),s){case 0:n=Av(null,n,r,t,o);break e;case 1:n=j_(null,n,r,t,o);break e;case 11:n=v_(null,n,r,t,o);break e;case 14:n=b_(null,n,r,Ts(r.type,t),o);break e}throw Error(Je(306,r,""))}return n;case 0:return r=n.type,s=n.pendingProps,s=n.elementType===r?s:Ts(r,s),Av(t,n,r,s,o);case 1:return r=n.type,s=n.pendingProps,s=n.elementType===r?s:Ts(r,s),j_(t,n,r,s,o);case 3:e:{if(__(n),t===null)throw Error(Je(387));r=n.pendingProps,a=n.memoizedState,s=a.element,Rj(t,n),rf(n,r,null,o);var i=n.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=a,n.memoizedState=a,n.flags&256){s=Lc(Error(Je(423)),n),n=k_(t,n,r,o,s);break e}else if(r!==s){s=Lc(Error(Je(424)),n),n=k_(t,n,r,o,s);break e}else for(Ho=wa(n.stateNode.containerInfo.firstChild),Vo=n,Rr=!0,Ms=null,o=Hj(n,null,r,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mc(),r===s){n=Ai(t,n,o);break e}uo(t,n,r,o)}n=n.child}return n;case 5:return Wj(n),t===null&&lv(n),r=n.type,s=n.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,J0(r,s)?i=null:a!==null&&J0(r,a)&&(n.flags|=32),S_(t,n),uo(t,n,i,o),n.child;case 6:return t===null&&lv(n),null;case 13:return E_(t,n,o);case 4:return vv(n,n.stateNode.containerInfo),r=n.pendingProps,t===null?n.child=Ac(n,null,r,o):uo(t,n,r,o),n.child;case 11:return r=n.type,s=n.pendingProps,s=n.elementType===r?s:Ts(r,s),v_(t,n,r,s,o);case 7:return uo(t,n,n.pendingProps,o),n.child;case 8:return uo(t,n,n.pendingProps.children,o),n.child;case 12:return uo(t,n,n.pendingProps.children,o),n.child;case 10:e:{if(r=n.type._context,s=n.pendingProps,a=n.memoizedProps,i=s.value,xr(Jp,r._currentValue),r._currentValue=i,a!==null)if(Ps(a.value,i)){if(a.children===s.children&&!jo.current){n=Ai(t,n,o);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Ii(-1,o&-o),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}a.lanes|=o,c=a.alternate,c!==null&&(c.lanes|=o),pv(a.return,o,n),l.lanes|=o;break}c=c.next}}else if(a.tag===10)i=a.type===n.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Je(341));i.lanes|=o,l=i.alternate,l!==null&&(l.lanes|=o),pv(i,o,n),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===n){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}uo(t,n,s.children,o),n=n.child}return n;case 9:return s=n.type,r=n.pendingProps.children,Ic(n,o),s=us(s),r=r(s),n.flags|=1,uo(t,n,r,o),n.child;case 14:return r=n.type,s=Ts(r,n.pendingProps),s=Ts(r.type,s),b_(t,n,r,s,o);case 15:return x_(t,n,n.type,n.pendingProps,o);case 17:return r=n.type,s=n.pendingProps,s=n.elementType===r?s:Ts(r,s),pf(t,n),n.tag=1,_o(r)?(t=!0,Yp(n)):t=!1,Ic(n,o),Bj(n,r,s),yv(n,r,s,o),Ov(null,n,r,!0,t,o);case 19:return P_(t,n,o);case 22:return w_(t,n,o)}throw Error(Je(156,n.tag))};function J_(t,n){return T2(t,n)}function fR(t,n,o,r){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(t,n,o,r){return new fR(t,n,o,r)}function Zv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mR(t){if(typeof t=="function")return Zv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===s0)return 11;if(t===l0)return 14}return 2}function Aa(t,n){var o=t.alternate;return o===null?(o=ps(t.tag,n,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=n,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&14680064,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,n=t.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o}function _f(t,n,o,r,s,a){var i=2;if(r=t,typeof t=="function")Zv(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case pc:return Ml(o.children,s,a,n);case n0:i=8,s|=8;break;case o0:return t=ps(12,o,n,s|2),t.elementType=o0,t.lanes=a,t;case i0:return t=ps(13,o,n,s),t.elementType=i0,t.lanes=a,t;case a0:return t=ps(19,o,n,s),t.elementType=a0,t.lanes=a,t;case i2:return kf(o,s,a,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case o2:i=10;break e;case s2:i=9;break e;case s0:i=11;break e;case l0:i=14;break e;case pa:i=16,r=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return n=ps(i,o,n,s),n.elementType=t,n.type=r,n.lanes=a,n}function Ml(t,n,o,r){return t=ps(7,t,r,n),t.lanes=o,t}function kf(t,n,o,r){return t=ps(22,t,r,n),t.elementType=i2,t.lanes=o,t.stateNode={isHidden:!1},t}function Jv(t,n,o){return t=ps(6,t,null,n),t.lanes=o,t}function eb(t,n,o){return n=ps(4,t.children!==null?t.children:[],t.key,n),n.lanes=o,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function gR(t,n,o,r,s){this.tag=n,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=P0(0),this.expirationTimes=P0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P0(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function tb(t,n,o,r,s,a,i,l,c){return t=new gR(t,n,o,l,c),n===1?(n=1,a===!0&&(n|=8)):n=0,a=ps(3,null,null,n),t.current=a,a.stateNode=t,a.memoizedState={element:r,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},mv(a),t}function yR(t,n,o){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hc,key:r==null?null:""+r,children:t,containerInfo:n,implementation:o}}function ek(t){if(!t)return ja;t=t._reactInternals;e:{if(yl(t)!==t||t.tag!==1)throw Error(Je(170));var n=t;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(_o(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Je(171))}if(t.tag===1){var o=t.type;if(_o(o))return Ej(t,o,n)}return n}function tk(t,n,o,r,s,a,i,l,c){return t=tb(o,r,!0,t,s,a,i,l,c),t.context=ek(null),o=t.current,r=ho(),s=Ta(o),a=Ii(r,s),a.callback=n??null,Ea(o,a,s),t.current.lanes=s,ad(t,s,r),Co(t,r),t}function Ef(t,n,o,r){var s=n.current,a=ho(),i=Ta(s);return o=ek(o),n.context===null?n.context=o:n.pendingContext=o,n=Ii(a,i),n.payload={element:t},r=r===void 0?null:r,r!==null&&(n.callback=r),t=Ea(s,n,i),t!==null&&(Os(t,s,i,a),tf(t,s,i)),i}function Cf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function rk(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<n?o:n}}function rb(t,n){rk(t,n),(t=t.alternate)&&rk(t,n)}function vR(){return null}var nk=typeof reportError=="function"?reportError:function(t){console.error(t)};function nb(t){this._internalRoot=t}Pf.prototype.render=nb.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(Je(409));Ef(t,n,null,null)},Pf.prototype.unmount=nb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;El(function(){Ef(null,t,null,null)}),n[Ei]=null}};function Pf(t){this._internalRoot=t}Pf.prototype.unstable_scheduleHydration=function(t){if(t){var n=N2();t={blockedOn:null,target:t,priority:n};for(var o=0;o<va.length&&n!==0&&n<va[o].priority;o++);va.splice(o,0,t),o===0&&z2(t)}};function ob(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Mf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ok(){}function bR(t,n,o,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var u=Cf(i);a.call(u)}}var i=tk(n,r,t,0,null,!1,!1,"",ok);return t._reactRootContainer=i,t[Ei]=i.current,wd(t.nodeType===8?t.parentNode:t),El(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Cf(c);l.call(u)}}var c=tb(t,0,!1,null,null,!1,!1,"",ok);return t._reactRootContainer=c,t[Ei]=c.current,wd(t.nodeType===8?t.parentNode:t),El(function(){Ef(n,c,o,r)}),c}function Tf(t,n,o,r,s){var a=o._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var l=s;s=function(){var c=Cf(i);l.call(c)}}Ef(n,i,t,s)}else i=bR(o,n,t,s,r);return Cf(i)}D2=function(t){switch(t.tag){case 3:var n=t.stateNode;if(n.current.memoizedState.isDehydrated){var o=id(n.pendingLanes);o!==0&&(M0(n,o|1),Co(n,Jr()),!(Kt&6)&&(Fc=Jr()+500,_a()))}break;case 13:El(function(){var r=Ti(t,1);if(r!==null){var s=ho();Os(r,t,1,s)}}),rb(t,1)}},T0=function(t){if(t.tag===13){var n=Ti(t,134217728);if(n!==null){var o=ho();Os(n,t,134217728,o)}rb(t,134217728)}},F2=function(t){if(t.tag===13){var n=Ta(t),o=Ti(t,n);if(o!==null){var r=ho();Os(o,t,n,r)}rb(t,n)}},N2=function(){return ar},U2=function(t,n){var o=ar;try{return ar=t,n()}finally{ar=o}},S0=function(t,n,o){switch(n){case"input":if(f0(t,o),n=o.name,o.type==="radio"&&n!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var r=o[n];if(r!==t&&r.form===t.form){var s=$p(r);if(!s)throw Error(Je(90));c2(r),f0(r,s)}}}break;case"textarea":f2(t,o);break;case"select":n=o.value,n!=null&&fc(t,!!o.multiple,n,!1)}},j2=Kv,_2=El;var xR={usingClientEntryPoint:!1,Events:[_d,_c,$p,w2,S2,Kv]},Nd={findFiberByHostInstance:vl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},wR={bundleType:Nd.bundleType,version:Nd.version,rendererPackageName:Nd.rendererPackageName,rendererConfig:Nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=P2(t),t===null?null:t.stateNode},findFiberByHostInstance:Nd.findFiberByHostInstance||vR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var If=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!If.isDisabled&&If.supportsFiber)try{Cp=If.inject(wR),Ks=If}catch{}}Bo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR,Bo.createPortal=function(t,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ob(n))throw Error(Je(200));return yR(t,n,null,o)},Bo.createRoot=function(t,n){if(!ob(t))throw Error(Je(299));var o=!1,r="",s=nk;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),n=tb(t,1,!1,null,null,o,!1,r,s),t[Ei]=n.current,wd(t.nodeType===8?t.parentNode:t),new nb(n)},Bo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=P2(n),t=t===null?null:t.stateNode,t},Bo.flushSync=function(t){return El(t)},Bo.hydrate=function(t,n,o){if(!Mf(n))throw Error(Je(200));return Tf(null,t,n,!0,o)},Bo.hydrateRoot=function(t,n,o){if(!ob(t))throw Error(Je(405));var r=o!=null&&o.hydratedSources||null,s=!1,a="",i=nk;if(o!=null&&(o.unstable_strictMode===!0&&(s=!0),o.identifierPrefix!==void 0&&(a=o.identifierPrefix),o.onRecoverableError!==void 0&&(i=o.onRecoverableError)),n=tk(n,null,t,1,o??null,s,!1,a,i),t[Ei]=n.current,wd(t),r)for(t=0;t<r.length;t++)o=r[t],s=o._getVersion,s=s(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,s]:n.mutableSourceEagerHydrationData.push(o,s);return new Pf(n)},Bo.render=function(t,n,o){if(!Mf(n))throw Error(Je(200));return Tf(null,t,n,!1,o)},Bo.unmountComponentAtNode=function(t){if(!Mf(t))throw Error(Je(40));return t._reactRootContainer?(El(function(){Tf(null,null,t,!1,function(){t._reactRootContainer=null,t[Ei]=null})}),!0):!1},Bo.unstable_batchedUpdates=Kv,Bo.unstable_renderSubtreeIntoContainer=function(t,n,o,r){if(!Mf(o))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return Tf(t,n,o,!1,r)},Bo.version="18.2.0-next-9e3b772b8-20220608";function sk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sk)}catch(t){console.error(t)}}sk(),QS.exports=Bo;var Tl=QS.exports;const SR=ml(Tl);var ik,ak=Tl;ik=Zy.createRoot=ak.createRoot,Zy.hydrateRoot=ak.hydrateRoot;async function jR(t,n){const{url:o,style:r="normal",weight:s="500",display:a,featureSettings:i,stretch:l,unicodeRange:c,variant:u,format:f}=n,h={style:r,weight:s,display:a,featureSettings:i,stretch:l,unicodeRange:c,variant:u},d=new FontFace(t,`url(${o})`,h);return await d.load(),document.fonts.add(d),d.$$_url=o,d.$$_fontface=`
@font-face {
	font-family: ${d.family};
	font-stretch: ${d.stretch};
	font-weight: ${d.weight};
	font-style: ${d.style};
	src: url("${o}") format("${f}")
}`,d}function lk(t){return t&&typeof t=="object"&&"parents"in t}function ck(t){for(let n=0,o=t.parents.length;n<o;n++)if(t.parents[n].__unsafe__getWithoutCapture(!0),t.parents[n].lastChangedEpoch!==t.parentEpochs[n])return!0;return!1}const Af=(t,n)=>{if(t.children.remove(n)&&t.children.isEmpty&&lk(t))for(let o=0,r=t.parents.length;o<r;o++)Af(t.parents[o],t)},sb=(t,n)=>{if(t.children.add(n)&&lk(t))for(let o=0,r=t.parents.length;o<r;o++)sb(t.parents[o],t)};function uk(t,n){return t===n||Object.is(t,n)||!!(t&&n&&typeof t.equals=="function"&&t.equals(n))}function Oa(t,n){const o=Symbol.for(`com.tldraw.state/${t}`),r=globalThis;return r[o]??(r[o]=n()),r[o]}const Li=Oa("empty_array",()=>Object.freeze([])),dk=8;class Of{constructor(){R(this,"arraySize",0);R(this,"array",Array(dk));R(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(n){if(this.array)return this.array.indexOf(n)!==-1?!1:this.arraySize<dk?(this.array[this.arraySize]=n,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(n),!0);if(this.set)return this.set.has(n)?!1:(this.set.add(n),!0);throw new Error("no set or array")}remove(n){if(this.array){const o=this.array.indexOf(n);return o===-1?!1:(this.array[o]=void 0,this.arraySize--,o!==this.arraySize&&(this.array[o]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(n)?(this.set.delete(n),!0):!1;throw new Error("no set or array")}visit(n){if(this.array){for(let o=0;o<this.arraySize;o++){const r=this.array[o];typeof r<"u"&&n(r)}return}if(this.set){this.set.forEach(n);return}throw new Error("no set or array")}has(n){return this.array?this.array.indexOf(n)!==-1:this.set.has(n)}clear(){this.set?this.set.clear():(this.arraySize=0,this.array=[])}size(){return this.set?this.set.size:this.arraySize}}const $o=Symbol.for("com.tldraw.state/RESET_VALUE");class hk{constructor(n){R(this,"index",0);R(this,"buffer");this.capacity=n,this.buffer=new Array(n)}pushEntry(n,o,r){if(r!==void 0){if(r===$o){this.clear();return}this.buffer[this.index]=[n,o,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(n){const{index:o,capacity:r,buffer:s}=this;for(let a=0;a<r;a++){const i=(o-1+r-a)%r,l=s[i];if(!l)return $o;const[c,u]=l;if(a===0&&n>=u)return[];if(c<=n&&n<u){const f=a+1,h=new Array(f);for(let d=0;d<f;d++)h[d]=s[(i+d)%r][2];return h}}return $o}}class _R{constructor(n,o){R(this,"offset",0);R(this,"maybeRemoved");this.below=n,this.child=o}}const en=Oa("capture",()=>({stack:null}));function pk(t){en.stack=new _R(en.stack,t),t.parentSet.clear()}function fk(){const t=en.stack;if(en.stack=t.below,t.offset<t.child.parents.length){for(let n=t.offset;n<t.child.parents.length;n++){const o=t.child.parents[n];t.child.parentSet.has(o)||Af(o,t.child)}t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset}if(t.maybeRemoved)for(let n=0;n<t.maybeRemoved.length;n++){const o=t.maybeRemoved[n];t.child.parentSet.has(o)||Af(o,t.child)}}function Lf(t){if(en.stack){if(en.stack.child.parentSet.has(t))return;if(en.stack.child.parentSet.add(t),en.stack.child.isActivelyListening&&sb(t,en.stack.child),en.stack.offset<en.stack.child.parents.length){const n=en.stack.child.parents[en.stack.offset];n!==t&&(en.stack.maybeRemoved?en.stack.maybeRemoved.push(n):en.stack.maybeRemoved=[n])}en.stack.child.parents[en.stack.offset]=t,en.stack.child.parentEpochs[en.stack.offset]=t.lastChangedEpoch,en.stack.offset++}}const Il=-1;class kR{constructor(n,o,r){R(this,"_isActivelyListening",!1);R(this,"lastTraversedEpoch",Il);R(this,"lastReactedEpoch",Il);R(this,"_scheduleCount",0);R(this,"parentSet",new Of);R(this,"parentEpochs",[]);R(this,"parents",[]);R(this,"_scheduleEffect");R(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=n,this.runEffect=o,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==po()){if(this.parents.length&&!ck(this)){this.lastReactedEpoch=po();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let n=0,o=this.parents.length;n<o;n++)sb(this.parents[n],this)}detach(){this._isActivelyListening=!1;for(let n=0,o=this.parents.length;n<o;n++)Af(this.parents[n],this)}execute(){try{pk(this);const n=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=po(),n}finally{fk()}}}const Uc=Oa("EffectScheduler",()=>kR);function Bc(t,n,o){const r=new Uc(t,n,o);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function ER(t,n,o){const r=new Uc(t,n,o);return{scheduler:r,start:s=>{const a=(s==null?void 0:s.force)??!1;r.attach(),a?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class CR{constructor(n){R(this,"initialAtomValues",new Map);this.parent=n}get isRoot(){return this.parent===null}commit(){if(this.isRoot){const n=this.initialAtomValues;this.initialAtomValues=new Map,mk(n.keys())}else this.initialAtomValues.forEach((n,o)=>{this.parent.initialAtomValues.has(o)||this.parent.initialAtomValues.set(o,n)})}abort(){Wn.globalEpoch++,this.initialAtomValues.forEach((n,o)=>{var r;o.set(n),(r=o.historyBuffer)==null||r.clear()}),this.commit()}}const Wn=Oa("transactions",()=>({globalEpoch:Il+1,globalIsReacting:!1,currentTransaction:null}));function po(){return Wn.globalEpoch}function mk(t){if(Wn.globalIsReacting)throw new Error("cannot change atoms during reaction cycle");try{Wn.globalIsReacting=!0;const n=new Set,o=r=>{r.lastTraversedEpoch!==Wn.globalEpoch&&(r.lastTraversedEpoch=Wn.globalEpoch,r instanceof Uc?n.add(r):r.children.visit(o))};for(const r of t)r.children.visit(o);for(const r of n)r.maybeScheduleEffect()}finally{Wn.globalIsReacting=!1}}function PR(t,n){Wn.currentTransaction?Wn.currentTransaction.initialAtomValues.has(t)||Wn.currentTransaction.initialAtomValues.set(t,n):mk([t])}function MR(){Wn.globalEpoch++}function TR(t){const n=new CR(Wn.currentTransaction);Wn.currentTransaction=n;try{let o=!1;const r=t(()=>o=!0);return o?n.abort():n.commit(),r}catch(o){throw n.abort(),o}finally{Wn.currentTransaction=Wn.currentTransaction.parent}}function Ls(t){return Wn.currentTransaction?t():TR(t)}class IR{constructor(n,o,r){R(this,"isEqual");R(this,"computeDiff");R(this,"lastChangedEpoch",po());R(this,"children",new Of);R(this,"historyBuffer");this.name=n,this.current=o,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new hk(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(n){return this.current}get(){return Lf(this),this.current}set(n,o){var s,a;if(((s=this.isEqual)==null?void 0:s.call(this,this.current,n))??uk(this.current,n))return this.current;MR(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,po(),o??((a=this.computeDiff)==null?void 0:a.call(this,this.current,n,this.lastChangedEpoch,po()))??$o),this.lastChangedEpoch=po();const r=this.current;return this.current=n,PR(this,r),n}update(n){return this.set(n(this.current))}getDiffSince(n){var o;return Lf(this),n>=this.lastChangedEpoch?Li:((o=this.historyBuffer)==null?void 0:o.getChangesSince(n))??$o}}const AR=Oa("Atom",()=>IR);function fo(t,n,o){return new AR(t,n,o)}let gk=!1;function OR(){gk||(gk=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const Ud=Symbol.for("com.tldraw.state/UNINITIALIZED"),Al=t=>t===Ud,ib=Oa("WithDiff",()=>class{constructor(t,n){this.value=t,this.diff=n}});function Bd(t,n){return new ib(t,n)}class LR{constructor(n,o,r){R(this,"lastChangedEpoch",Il);R(this,"lastTraversedEpoch",Il);R(this,"lastCheckedEpoch",Il);R(this,"parentSet",new Of);R(this,"parents",[]);R(this,"parentEpochs",[]);R(this,"children",new Of);R(this,"historyBuffer");R(this,"state",Ud);R(this,"error",null);R(this,"computeDiff");R(this,"isEqual");this.name=n,this.derive=o,r!=null&&r.historyLength&&(this.historyBuffer=new hk(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??uk}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(n){var o;if(this.lastChangedEpoch!==Il&&(this.lastCheckedEpoch===po()||!ck(this)))if(this.lastCheckedEpoch=po(),this.error){if(n)return this.state;throw this.error.thrownValue}else return this.state;try{pk(this);const r=this.derive(this.state,this.lastCheckedEpoch),s=r instanceof ib?r.value:r,a=this.state===Ud;if(a||!this.isEqual(s,this.state)){if(this.historyBuffer&&!a){const i=r instanceof ib?r.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,po(),i??((o=this.computeDiff)==null?void 0:o.call(this,this.state,s,this.lastCheckedEpoch,po()))??$o)}this.lastChangedEpoch=po(),this.state=s}return this.error=null,this.lastCheckedEpoch=po(),this.state}catch(r){if(this.state!==Ud&&(this.state=Ud,this.lastChangedEpoch=po()),this.lastCheckedEpoch=po(),this.historyBuffer&&this.historyBuffer.clear(),this.error={thrownValue:r},!n)throw r;return this.state}finally{fk()}}get(){try{return this.__unsafe__getWithoutCapture()}finally{Lf(this)}}getDiffSince(n){var o;return this.__unsafe__getWithoutCapture(!0),Lf(this),n>=this.lastChangedEpoch?Li:((o=this.historyBuffer)==null?void 0:o.getChangesSince(n))??$o}}const ab=Oa("Computed",()=>LR);function RR(t={},n,o,r){const s=r.value,a=Symbol.for("__@tldraw/state__computed__"+o);return r.value=function(){let i=this[a];return i||(i=new ab(o,s.bind(this),t),Object.defineProperty(this,a,{enumerable:!1,configurable:!1,writable:!1,value:i})),i.get()},r.value[FR]=!0,r}function yk(t={},n,o,r){return r.get?(OR(),DR(t,n,o,r)):RR(t,n,o,r)}function DR(t={},n,o,r){const s=r.get,a=Symbol.for("__@tldraw/state__computed__"+o);return r.get=function(){let i=this[a];return i||(i=new ab(o,s.bind(this),t),Object.defineProperty(this,a,{enumerable:!1,configurable:!1,writable:!1,value:i})),i.get()},r}const FR="@@__isComputedMethod__@@";function Ye(){if(arguments.length===1){const t=arguments[0];return(n,o,r)=>yk(t,n,o,r)}else return typeof arguments[0]=="string"?new ab(arguments[0],arguments[1],arguments[2]):yk(void 0,arguments[0],arguments[1],arguments[2])}const vk=1,NR=Oa("apiVersion",()=>vk);if(NR!==vk)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");function Rf(t,n){const o=Bt.useRef(n);o.current=n;const[r,s,a]=Bt.useMemo(()=>{let i=null;const l=u=>(i=u,()=>{i=null}),c=new Uc(`useStateTracking(${t})`,()=>{var u;return(u=o.current)==null?void 0:u.call(o)},{scheduleEffect(){i==null||i()}});return[c,l,()=>c.scheduleCount]},[t]);return Bt.useSyncExternalStore(s,a,a),Bt.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const bk={apply(t,n,o){return Rf(t.displayName??t.name??"tracked(???)",()=>t.apply(n,o))}},UR=Symbol.for("react.memo"),BR=Symbol.for("react.forward_ref");function qo(t){let n=null;const o=t.$$typeof;return o===UR&&(t=t.type,n=t.compare),o===BR?z.memo(z.forwardRef(new Proxy(t.render,bk))):z.memo(new Proxy(t,bk),n)}function zR(){const t=arguments[0],n=arguments[1],o=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return z.useMemo(()=>Ye(`useComputed(${t})`,n,o),r)}function La(t,n,o=Li){z.useEffect(()=>{const r=new Uc(t,n);return r.attach(),r.execute(),()=>{r.detach()}},o)}function We(){const t=arguments,n=t.length===3?t[2]:[t[0]],o=t.length===3?t[0]:`useValue(${t[0].name})`,r=z.useRef(!0);r.current=!0;const s=z.useMemo(()=>t.length===1?t[0]:Ye(o,()=>{if(r.current)return t[1]();try{return t[1]()}catch{return{}}}),n);try{const{subscribe:a,getSnapshot:i}=z.useMemo(()=>({subscribe:l=>Bc(`useValue(${o})`,()=>{s.get(),l()}),getSnapshot:()=>s.get()}),[s]);return z.useSyncExternalStore(a,i,i)}finally{r.current=!1}}class Df{constructor(n){R(this,"nextValue");R(this,"diff");this.previousValue=n}get(){var r,s,a,i;const n=((s=(r=this.diff)==null?void 0:r.removed)==null?void 0:s.size)??0,o=((i=(a=this.diff)==null?void 0:a.added)==null?void 0:i.size)??0;if(!(n===0&&o===0))return{value:this.nextValue,diff:this.diff}}_add(n,o){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(n),this.diff??(this.diff={}),o?(r=this.diff.removed)==null||r.delete(n):((s=this.diff).added??(s.added=new Set),this.diff.added.add(n))}add(n){var r,s,a;const o=this.previousValue.has(n);if(o)return(s=(r=this.diff)==null?void 0:r.removed)!=null&&s.has(n)?this._add(n,o):void 0;(a=this.nextValue)!=null&&a.has(n)||this._add(n,o)}_remove(n,o){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(n),this.diff??(this.diff={}),o?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(n)):(s=this.diff.added)==null||s.delete(n)}remove(n){var r,s,a,i;const o=this.previousValue.has(n);if(!o)return(s=(r=this.diff)==null?void 0:r.added)!=null&&s.has(n)?this._remove(n,o):void 0;(i=(a=this.diff)==null?void 0:a.removed)!=null&&i.has(n)||this._remove(n,o)}}function Ff(t,n){const o=[];e:for(const r of t){for(const s of o)if(n?n(r,s):r===s)continue e;o.push(r)}return o}function Lt(t){return t.filter(n=>n!=null)}function Yo(t){return t[t.length-1]}function GR(t,n){let o,r=1/0;for(const s of t){const a=n(s);a<r&&(o=s,r=a)}return o}function VR(t,n){if(t===n)return!0;if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(!Object.is(t[o],n[o]))return!1;return!0}function HR(t,n){let o,r;return function(...s){return o||(o=!0,setTimeout(()=>o=!1,n),r=t(...s)),r}}function xk(t){const n=(...o)=>{try{return t(...o)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,n),r}};return n}const zc={ok(t){return{ok:!0,value:t}},err(t){return{ok:!1,error:t}}};function Ri(t,n){const o=n&&t&&typeof t=="object"&&n in t?t[n]:t;throw new Error(`Unknown switch case ${o}`)}const bn=xk((t,n)=>{if(!t)throw new Error(n||"Assertion Error")}),Ol=xk((t,n)=>{if(t==null)throw new Error(n??"value must be defined");return t});function wk(t,n){let o;const r=(...s)=>(o||(o={},o.promise=new Promise((a,i)=>{o.resolve=a,o.reject=i})),clearTimeout(o.timeout),o.latestArgs=s,o.timeout=setTimeout(()=>{const a=o;o=void 0;try{a.resolve(t(...a.latestArgs))}catch(i){a.reject(i)}},n),o.promise);return r.cancel=()=>{o&&clearTimeout(o.timeout)},r}const Sk=new WeakMap;function lb(t,n){if(typeof t!="object"||t===null)return;let o=Sk.get(t);o||(o={tags:{},extras:{}},Sk.set(t,o)),n.tags&&(o.tags={...o.tags,...n.tags}),n.extras&&(o.extras={...o.extras,...n.extras})}class Gc{static async dataUrlToArrayBuffer(n){return fetch(n).then(function(o){return o.arrayBuffer()})}static async blobToDataUrl(n){return await new Promise((o,r)=>{if(n){const s=new FileReader;s.onload=()=>o(s.result),s.onerror=a=>r(a),s.onabort=a=>r(a),s.readAsDataURL(n)}})}static async blobToText(n){return await new Promise((o,r)=>{if(n){const s=new FileReader;s.onload=()=>o(s.result),s.onerror=a=>r(a),s.onabort=a=>r(a),s.readAsText(n)}})}}function cb(t){let n=0;for(let o=0;o<t.length;o++)n=(n<<5)-n+t.charCodeAt(o),n|=0;return n+""}function WR(t){const n=new DataView(t);let o=0;for(let r=0;r<n.byteLength;r++)o=(o<<5)-o+n.getUint8(r),o|=0;return o+""}let ub=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(ub=new Int32Array(ub));const $R=(t,n)=>{let o=n===0?0:~~n^-1;for(let r=0;r<t.length;r++)o=ub[(o^t[r])&255]^o>>>8;return o^-1},jk=4,_k=4;class xi{static isPng(n,o){return n.getUint8(o+0)===137&&n.getUint8(o+1)===80&&n.getUint8(o+2)===78&&n.getUint8(o+3)===71&&n.getUint8(o+4)===13&&n.getUint8(o+5)===10&&n.getUint8(o+6)===26&&n.getUint8(o+7)===10}static getChunkType(n,o){return[String.fromCharCode(n.getUint8(o)),String.fromCharCode(n.getUint8(o+1)),String.fromCharCode(n.getUint8(o+2)),String.fromCharCode(n.getUint8(o+3))].join("")}static readChunks(n,o=0){const r={};if(!xi.isPng(n,o))throw new Error("Not a PNG");for(o+=8;o<=n.buffer.byteLength;){const s=o,a=n.getInt32(o);o+=4;const i=xi.getChunkType(n,o);if(i==="IDAT"&&r[i]){o+=a+jk+_k;continue}if(i==="IEND")break;r[i]={start:s,dataOffset:o+4,size:a},o+=a+jk+_k}return r}static parsePhys(n,o){return{ppux:n.getUint32(o),ppuy:n.getUint32(o+4),unit:n.getUint8(o+4)}}static findChunk(n,o){return xi.readChunks(n)[o]}static setPhysChunk(n,o=1,r){let s=46,a=0;const i=xi.findChunk(n,"pHYs");i&&(s=i.start,a=i.size);const l=xi.findChunk(n,"IDAT");l&&(s=l.start,a=0);const c=new ArrayBuffer(21),u=new DataView(c);u.setUint32(0,9),u.setUint8(4,"p".charCodeAt(0)),u.setUint8(5,"H".charCodeAt(0)),u.setUint8(6,"Y".charCodeAt(0)),u.setUint8(7,"s".charCodeAt(0));const f=2835.5;u.setInt32(8,f*o),u.setInt32(12,f*o),u.setInt8(16,1);const h=new Uint8Array(c.slice(4,17));u.setInt32(17,$R(h));const d=n.buffer.slice(0,s),p=n.buffer.slice(s+a);return new Blob([d,c,p],r)}}class ia{static loadVideo(n){return new Promise((o,r)=>{const s=document.createElement("video");s.onloadeddata=()=>o(s),s.onerror=a=>{console.error(a),r(new Error("Could not load video"))},s.crossOrigin="anonymous",s.src=n})}static loadImage(n){return new Promise((o,r)=>{const s=new Image;s.onload=()=>o(s),s.onerror=a=>{console.error(a),r(new Error("Could not load image"))},s.crossOrigin="anonymous",s.src=n})}static async getVideoSize(n){return ia.usingObjectURL(n,async o=>{const r=await ia.loadVideo(o);return{w:r.videoWidth,h:r.videoHeight}})}static async getImageSize(n){const o=await ia.usingObjectURL(n,ia.loadImage);try{if(n.type==="image/png"){const r=new DataView(await n.arrayBuffer());if(xi.isPng(r,0)){const s=xi.findChunk(r,"pHYs");if(s){const a=xi.parsePhys(r,s.dataOffset);if(a.unit===0&&a.ppux===a.ppuy){const i=Math.max(a.ppux/2834.5,1);return{w:Math.round(o.naturalWidth/i),h:Math.round(o.naturalHeight/i)}}}}}}catch(r){return console.error(r),{w:o.naturalWidth,h:o.naturalHeight}}return{w:o.naturalWidth,h:o.naturalHeight}}static async usingObjectURL(n,o){const r=URL.createObjectURL(n);try{return await o(r)}finally{URL.revokeObjectURL(r)}}}function Ra(t=""){let n=0,o=0,r=0,s=0;function a(){const i=n^n<<11;return n=o,o=r,r=s,s^=(s>>>19^i^i>>>8)>>>0,s/4294967296*2}for(let i=0;i<t.length+64;i++)n^=t.charCodeAt(i)|0,a();return a}function Nf(t,n,o,r=!1){const[s,a]=n,[i,l]=o,c=i+(t-s)/(a-s)*(l-i);return r?i<l?Math.max(Math.min(c,l),i):Math.max(Math.min(c,i),l):c}function ei(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function Rs(t,n){if(ei(t,n))return t[n]}function kk(t){return Object.keys(t)}function dn(t){return Object.values(t)}function Po(t){return Object.entries(t)}function db(t){return Object.fromEntries(t)}function hb(t,n){const o={};let r=!1;for(const[s,a]of Po(t))n(s,a)?o[s]=a:r=!0;return r?o:t}function Uf(t,n){const o={};for(const[r,s]of Po(t)){const a=n(r,s);o[r]=a}return o}function Ek(t,n){if(t===n)return!0;const o=new Set(Object.keys(t)),r=new Set(Object.keys(n));if(o.size!==r.size)return!1;for(const s of o)if(!r.has(s)||!Object.is(t[s],n[s]))return!1;return!0}const Ko="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Ck="a0",Pk="A00000000000000000000000000";function Mk(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-"a".charCodeAt(0)+2;if(t>="A"&&t<="Z")return"Z".charCodeAt(0)-t.charCodeAt(0)+2;throw new Error("Invalid index key head: "+t)}function Tk(t){if(t.length!==Mk(t.charAt(0)))throw new Error("invalid integer part of index key: "+t)}function Ik(t){if(t===void 0)throw Error("n is undefined")}function Ak(t){Tk(t);const[n,...o]=t.split("");let r=!0;for(let s=o.length-1;r&&s>=0;s--){const a=Ko.indexOf(o[s])+1;a===Ko.length?o[s]="0":(o[s]=Ko.charAt(a),r=!1)}if(r){if(n==="Z")return"a0";if(n==="z")return;const s=String.fromCharCode(n.charCodeAt(0)+1);return s>"a"?o.push("0"):o.pop(),s+o.join("")}else return n+o.join("")}function qR(t){Tk(t);const[n,...o]=t.split("");let r=!0;for(let s=o.length-1;r&&s>=0;s--){const a=Ko.indexOf(o[s])-1;a===-1?o[s]=Ko.slice(-1):(o[s]=Ko.charAt(a),r=!1)}if(r){if(n==="a")return"Z"+Ko.slice(-1);if(n==="A")return;const s=String.fromCharCode(n.charCodeAt(0)-1);return s<"Z"?o.push(Ko.slice(-1)):o.pop(),s+o.join("")}else return n+o.join("")}function Vc(t,n){if(n!==void 0&&t>=n)throw new Error(t+" >= "+n);if(t.slice(-1)==="0"||n&&n.slice(-1)==="0")throw new Error("trailing zero");if(n){let s=0;for(;(t.charAt(s)||"0")===n.charAt(s);)s++;if(s>0)return n.slice(0,s)+Vc(t.slice(s),n.slice(s))}const o=t?Ko.indexOf(t.charAt(0)):0,r=n!==void 0?Ko.indexOf(n.charAt(0)):Ko.length;if(r-o>1){const s=Math.round(.5*(o+r));return Ko.charAt(s)}else return n&&n.length>1?n.slice(0,1):Ko.charAt(o)+Vc(t.slice(1),void 0)}function zd(t){const n=Mk(t.charAt(0));if(n>t.length)throw new Error("invalid index: "+t);return t.slice(0,n)}function pb(t){if(t===Pk)throw new Error("invalid index: "+t);const n=zd(t);if(t.slice(n.length).slice(-1)==="0")throw new Error("invalid index: "+t)}function Hc(t,n){if(t!==void 0&&pb(t),n!==void 0&&pb(n),t!==void 0&&n!==void 0&&t>=n)throw new Error(t+" >= "+n);if(t===void 0&&n===void 0)return Ck;if(t===void 0){if(n===void 0)throw Error("b is undefined");const l=zd(n),c=n.slice(l.length);if(l===Pk)return l+Vc("",c);if(l<n)return l;const u=qR(l);return Ik(u),u}if(n===void 0){const l=zd(t),c=t.slice(l.length),u=Ak(l);return u===void 0?l+Vc(c,void 0):u}const o=zd(t),r=t.slice(o.length),s=zd(n),a=n.slice(s.length);if(o===s)return o+Vc(r,a);const i=Ak(o);return Ik(i),i<n?i:o+Vc(r,void 0)}function Da(t,n,o){if(o===0)return[];if(o===1)return[Hc(t,n)];if(n===void 0){let a=Hc(t,n);const i=[a];for(let l=0;l<o-1;l++)a=Hc(a,n),i.push(a);return i}if(t===void 0){let a=Hc(t,n);const i=[a];for(let l=0;l<o-1;l++)a=Hc(t,a),i.push(a);return i.reverse(),i}const r=Math.floor(o/2),s=Hc(t,n);return[...Da(t,s,r),s,...Da(s,n,o-r-1)]}const YR=Ck;function KR(t){pb(t)}function Wc(t,n,o){return Da(t,n,o)}function fb(t,n){return Da(t,void 0,n)}function Gd(t,n){return Da(t,n,1)[0]}function Di(t){return Da(t,void 0,1)[0]}function XR(t){return Da(void 0,t,1)[0]}function Vd(t,n="a1"){return[n,...Da(n,void 0,t)]}function $n(t,n){return t.index<n.index?-1:t.index>n.index?1:0}function QR(t,n){return t.id>n.id?1:-1}function mb(t){try{return localStorage.getItem(t)}catch{return null}}function gb(t,n){try{localStorage.setItem(t,n)}catch{}}function ZR(){try{localStorage.clear()}catch{}}function Ok(t){try{return sessionStorage.getItem(t)}catch{return null}}function yb(t,n){try{sessionStorage.setItem(t,n)}catch{}}function Lk(t){try{sessionStorage.removeItem(t)}catch{}}function JR(){try{sessionStorage.clear()}catch{}}const eD=()=>typeof process<"u"&&!1,$c=[],tD=60,Bf=Math.ceil(1e3/tD);let Hd,vb=0,bb=0;const rD=()=>{const t=$c.splice(0,$c.length);for(const n of t)n()};function Rk(){if(Hd)return;const t=Date.now(),n=t-bb;if(vb+n<Bf){Hd=requestAnimationFrame(()=>{Hd=void 0,Rk()});return}Hd=requestAnimationFrame(()=>{Hd=void 0,bb=t,vb=Math.min(vb+n-Bf,Bf*10),rD()})}let Dk=!1;function Fk(t){return eD()?(t(),()=>{}):($c.includes(t)||($c.push(t),Dk||(Dk=!0,bb=Date.now()-Bf-1),Rk()),()=>{const n=$c.indexOf(t);n>-1&&$c.splice(n,1)})}function nD(t){return t!==null}function oD(){return typeof globalThis<"u"&&globalThis.structuredClone?[globalThis.structuredClone,!0]:typeof global<"u"&&global.structuredClone?[global.structuredClone,!0]:typeof window<"u"&&window.structuredClone?[window.structuredClone,!0]:[t=>t&&JSON.parse(JSON.stringify(t)),!1]}const Nk=oD(),wr=Nk[0];Nk[1];const sD=Object.getPrototypeOf(wr({}));let zf=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");class TS{constructor(n,o){R(this,"createDefaultProperties");R(this,"validator");R(this,"scope");R(this,"isInstance",n=>(n==null?void 0:n.typeName)===this.typeName);this.typeName=n,this.createDefaultProperties=o.createDefaultProperties,this.validator=o.validator??{validate:r=>r},this.scope=o.scope??"document"}create(n){const o={...this.createDefaultProperties(),id:this.createId()};for(const[r,s]of Object.entries(n))s!==void 0&&(o[r]=s);return o.typeName=this.typeName,o}clone(n){return{...wr(n),id:this.createId()}}createId(n){return this.typeName+":"+(n??zf())}createCustomId(n){return this.typeName+":"+n}parseId(n){if(!this.isId(n))throw new Error(`ID "${n}" is not a valid ID for type "${this.typeName}"`);return n.slice(this.typeName.length+1)}isId(n){if(!n)return!1;for(let o=0;o<this.typeName.length;o++)if(n[o]!==this.typeName[o])return!1;return n[this.typeName.length]===":"}withDefaultProperties(n){return new TS(this.typeName,{createDefaultProperties:n,validator:this.validator,scope:this.scope})}validate(n,o){return o&&this.validator.validateUsingKnownGoodVersion?this.validator.validateUsingKnownGoodVersion(o,n):this.validator.validate(n)}}function Fi(t,n){return new TS(t,{createDefaultProperties:()=>({}),validator:n.validator,scope:n.scope})}class Uk{constructor(){R(this,"items",new WeakMap)}get(n,o){return this.items.has(n)||this.items.set(n,o(n)),this.items.get(n)}}var Gf={exports:{}};Gf.exports,function(t,n){var o=200,r="__lodash_hash_undefined__",s=1,a=2,i=9007199254740991,l="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",y="[object GeneratorFunction]",g="[object Map]",b="[object Number]",m="[object Null]",v="[object Object]",x="[object Promise]",w="[object Proxy]",S="[object RegExp]",k="[object Set]",_="[object String]",C="[object Symbol]",P="[object Undefined]",A="[object WeakMap]",I="[object ArrayBuffer]",N="[object DataView]",O="[object Float32Array]",F="[object Float64Array]",U="[object Int8Array]",G="[object Int16Array]",Y="[object Int32Array]",$="[object Uint8Array]",H="[object Uint8ClampedArray]",Q="[object Uint16Array]",J="[object Uint32Array]",ae=/[\\^$.*+?()[\]{}|]/g,T=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,W={};W[O]=W[F]=W[U]=W[G]=W[Y]=W[$]=W[H]=W[Q]=W[J]=!0,W[l]=W[c]=W[I]=W[f]=W[N]=W[h]=W[d]=W[p]=W[g]=W[b]=W[v]=W[S]=W[k]=W[_]=W[A]=!1;var K=typeof cn=="object"&&cn&&cn.Object===Object&&cn,te=typeof self=="object"&&self&&self.Object===Object&&self,ne=K||te||Function("return this")(),ce=n&&!n.nodeType&&n,fe=ce&&!0&&t&&!t.nodeType&&t,ue=fe&&fe.exports===ce,ge=ue&&K.process,me=function(){try{return ge&&ge.binding&&ge.binding("util")}catch{}}(),oe=me&&me.isTypedArray;function de(ye,Te){for(var qe=-1,ht=ye==null?0:ye.length,cr=0,Rt=[];++qe<ht;){var Er=ye[qe];Te(Er,qe,ye)&&(Rt[cr++]=Er)}return Rt}function xe(ye,Te){for(var qe=-1,ht=Te.length,cr=ye.length;++qe<ht;)ye[cr+qe]=Te[qe];return ye}function Ie(ye,Te){for(var qe=-1,ht=ye==null?0:ye.length;++qe<ht;)if(Te(ye[qe],qe,ye))return!0;return!1}function we(ye,Te){for(var qe=-1,ht=Array(ye);++qe<ye;)ht[qe]=Te(qe);return ht}function _e(ye){return function(Te){return ye(Te)}}function Ae(ye,Te){return ye.has(Te)}function $e(ye,Te){return ye==null?void 0:ye[Te]}function Fe(ye){var Te=-1,qe=Array(ye.size);return ye.forEach(function(ht,cr){qe[++Te]=[cr,ht]}),qe}function ut(ye,Te){return function(qe){return ye(Te(qe))}}function tt(ye){var Te=-1,qe=Array(ye.size);return ye.forEach(function(ht){qe[++Te]=ht}),qe}var rt=Array.prototype,it=Function.prototype,nt=Object.prototype,Ee=ne["__core-js_shared__"],Ve=it.toString,Me=nt.hasOwnProperty,re=function(){var ye=/[^.]+$/.exec(Ee&&Ee.keys&&Ee.keys.IE_PROTO||"");return ye?"Symbol(src)_1."+ye:""}(),ie=nt.toString,ee=RegExp("^"+Ve.call(Me).replace(ae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),le=ue?ne.Buffer:void 0,Se=ne.Symbol,Pe=ne.Uint8Array,Ue=nt.propertyIsEnumerable,Xe=rt.splice,Ze=Se?Se.toStringTag:void 0,et=Object.getOwnPropertySymbols,at=le?le.isBuffer:void 0,At=ut(Object.keys,Object),Et=En(ne,"DataView"),dt=En(ne,"Map"),Ct=En(ne,"Promise"),kt=En(ne,"Set"),rr=En(ne,"WeakMap"),Wr=En(Object,"create"),$r=qs(Et),Zt=qs(dt),fr=qs(Ct),Wt=qs(kt),fn=qs(rr),Qr=Se?Se.prototype:void 0,Jt=Qr?Qr.valueOf:void 0;function kr(ye){var Te=-1,qe=ye==null?0:ye.length;for(this.clear();++Te<qe;){var ht=ye[Te];this.set(ht[0],ht[1])}}function al(){this.__data__=Wr?Wr(null):{},this.size=0}function ll(ye){var Te=this.has(ye)&&delete this.__data__[ye];return this.size-=Te?1:0,Te}function cl(ye){var Te=this.__data__;if(Wr){var qe=Te[ye];return qe===r?void 0:qe}return Me.call(Te,ye)?Te[ye]:void 0}function sc(ye){var Te=this.__data__;return Wr?Te[ye]!==void 0:Me.call(Te,ye)}function ul(ye,Te){var qe=this.__data__;return this.size+=this.has(ye)?0:1,qe[ye]=Wr&&Te===void 0?r:Te,this}kr.prototype.clear=al,kr.prototype.delete=ll,kr.prototype.get=cl,kr.prototype.has=sc,kr.prototype.set=ul;function ro(ye){var Te=-1,qe=ye==null?0:ye.length;for(this.clear();++Te<qe;){var ht=ye[Te];this.set(ht[0],ht[1])}}function be(){this.__data__=[],this.size=0}function Qe(ye){var Te=this.__data__,qe=wi(Te,ye);if(qe<0)return!1;var ht=Te.length-1;return qe==ht?Te.pop():Xe.call(Te,qe,1),--this.size,!0}function ct(ye){var Te=this.__data__,qe=wi(Te,ye);return qe<0?void 0:Te[qe][1]}function Ke(ye){return wi(this.__data__,ye)>-1}function Ut(ye,Te){var qe=this.__data__,ht=wi(qe,ye);return ht<0?(++this.size,qe.push([ye,Te])):qe[ht][1]=Te,this}ro.prototype.clear=be,ro.prototype.delete=Qe,ro.prototype.get=ct,ro.prototype.has=Ke,ro.prototype.set=Ut;function Ge(ye){var Te=-1,qe=ye==null?0:ye.length;for(this.clear();++Te<qe;){var ht=ye[Te];this.set(ht[0],ht[1])}}function $t(){this.size=0,this.__data__={hash:new kr,map:new(dt||ro),string:new kr}}function st(ye){var Te=Si(this,ye).delete(ye);return this.size-=Te?1:0,Te}function zt(ye){return Si(this,ye).get(ye)}function lt(ye){return Si(this,ye).has(ye)}function Fr(ye,Te){var qe=Si(this,ye),ht=qe.size;return qe.set(ye,Te),this.size+=qe.size==ht?0:1,this}Ge.prototype.clear=$t,Ge.prototype.delete=st,Ge.prototype.get=zt,Ge.prototype.has=lt,Ge.prototype.set=Fr;function Or(ye){var Te=-1,qe=ye==null?0:ye.length;for(this.__data__=new Ge;++Te<qe;)this.add(ye[Te])}function Lr(ye){return this.__data__.set(ye,r),this}function nn(ye){return this.__data__.has(ye)}Or.prototype.add=Or.prototype.push=Lr,Or.prototype.has=nn;function mn(ye){var Te=this.__data__=new ro(ye);this.size=Te.size}function no(){this.__data__=new ro,this.size=0}function is(ye){var Te=this.__data__,qe=Te.delete(ye);return this.size=Te.size,qe}function on(ye){return this.__data__.get(ye)}function op(ye){return this.__data__.has(ye)}function No(ye,Te){var qe=this.__data__;if(qe instanceof ro){var ht=qe.__data__;if(!dt||ht.length<o-1)return ht.push([ye,Te]),this.size=++qe.size,this;qe=this.__data__=new Ge(ht)}return qe.set(ye,Te),this.size=qe.size,this}mn.prototype.clear=no,mn.prototype.delete=is,mn.prototype.get=on,mn.prototype.has=op,mn.prototype.set=No;function aa(ye,Te){var qe=hl(ye),ht=!qe&&Gy(ye),cr=!qe&&!ht&&$u(ye),Rt=!qe&&!ht&&!cr&&ca(ye),Er=qe||ht||cr||Rt,Zr=Er?we(ye.length,String):[],sn=Zr.length;for(var mr in ye)(Te||Me.call(ye,mr))&&!(Er&&(mr=="length"||cr&&(mr=="offset"||mr=="parent")||Rt&&(mr=="buffer"||mr=="byteLength"||mr=="byteOffset")||pp(mr,sn)))&&Zr.push(mr);return Zr}function wi(ye,Te){for(var qe=ye.length;qe--;)if(Wu(ye[qe][0],Te))return qe;return-1}function sp(ye,Te,qe){var ht=Te(ye);return hl(ye)?ht:xe(ht,qe(ye))}function la(ye){return ye==null?ye===void 0?P:m:Ze&&Ze in Object(ye)?dp(ye):zy(ye)}function Vu(ye){return so(ye)&&la(ye)==l}function ic(ye,Te,qe,ht,cr){return ye===Te?!0:ye==null||Te==null||!so(ye)&&!so(Te)?ye!==ye&&Te!==Te:ip(ye,Te,qe,ht,ic,cr)}function ip(ye,Te,qe,ht,cr,Rt){var Er=hl(ye),Zr=hl(Te),sn=Er?c:oo(ye),mr=Zr?c:oo(Te);sn=sn==l?v:sn,mr=mr==l?v:mr;var Fn=sn==v,So=mr==v,gn=sn==mr;if(gn&&$u(ye)){if(!$u(Te))return!1;Er=!0,Fn=!1}if(gn&&!Fn)return Rt||(Rt=new mn),Er||ca(ye)?ac(ye,Te,qe,ht,cr,Rt):cp(ye,Te,sn,qe,ht,cr,Rt);if(!(qe&s)){var io=Fn&&Me.call(ye,"__wrapped__"),ao=So&&Me.call(Te,"__wrapped__");if(io||ao){var _s=io?ye.value():ye,as=ao?Te.value():Te;return Rt||(Rt=new mn),cr(_s,as,qe,ht,Rt)}}return gn?(Rt||(Rt=new mn),up(ye,Te,qe,ht,cr,Rt)):!1}function ap(ye){if(!Uo(ye)||Hu(ye))return!1;var Te=mp(ye)?ee:T;return Te.test(qs(ye))}function lp(ye){return so(ye)&&qu(ye.length)&&!!W[la(ye)]}function Uy(ye){if(!fp(ye))return At(ye);var Te=[];for(var qe in Object(ye))Me.call(ye,qe)&&qe!="constructor"&&Te.push(qe);return Te}function ac(ye,Te,qe,ht,cr,Rt){var Er=qe&s,Zr=ye.length,sn=Te.length;if(Zr!=sn&&!(Er&&sn>Zr))return!1;var mr=Rt.get(ye);if(mr&&Rt.get(Te))return mr==Te;var Fn=-1,So=!0,gn=qe&a?new Or:void 0;for(Rt.set(ye,Te),Rt.set(Te,ye);++Fn<Zr;){var io=ye[Fn],ao=Te[Fn];if(ht)var _s=Er?ht(ao,io,Fn,Te,ye,Rt):ht(io,ao,Fn,ye,Te,Rt);if(_s!==void 0){if(_s)continue;So=!1;break}if(gn){if(!Ie(Te,function(as,Ys){if(!Ae(gn,Ys)&&(io===as||cr(io,as,qe,ht,Rt)))return gn.push(Ys)})){So=!1;break}}else if(!(io===ao||cr(io,ao,qe,ht,Rt))){So=!1;break}}return Rt.delete(ye),Rt.delete(Te),So}function cp(ye,Te,qe,ht,cr,Rt,Er){switch(qe){case N:if(ye.byteLength!=Te.byteLength||ye.byteOffset!=Te.byteOffset)return!1;ye=ye.buffer,Te=Te.buffer;case I:return!(ye.byteLength!=Te.byteLength||!Rt(new Pe(ye),new Pe(Te)));case f:case h:case b:return Wu(+ye,+Te);case d:return ye.name==Te.name&&ye.message==Te.message;case S:case _:return ye==Te+"";case g:var Zr=Fe;case k:var sn=ht&s;if(Zr||(Zr=tt),ye.size!=Te.size&&!sn)return!1;var mr=Er.get(ye);if(mr)return mr==Te;ht|=a,Er.set(ye,Te);var Fn=ac(Zr(ye),Zr(Te),ht,cr,Rt,Er);return Er.delete(ye),Fn;case C:if(Jt)return Jt.call(ye)==Jt.call(Te)}return!1}function up(ye,Te,qe,ht,cr,Rt){var Er=qe&s,Zr=dl(ye),sn=Zr.length,mr=dl(Te),Fn=mr.length;if(sn!=Fn&&!Er)return!1;for(var So=sn;So--;){var gn=Zr[So];if(!(Er?gn in Te:Me.call(Te,gn)))return!1}var io=Rt.get(ye);if(io&&Rt.get(Te))return io==Te;var ao=!0;Rt.set(ye,Te),Rt.set(Te,ye);for(var _s=Er;++So<sn;){gn=Zr[So];var as=ye[gn],Ys=Te[gn];if(ht)var Yu=Er?ht(Ys,as,gn,Te,ye,Rt):ht(as,Ys,gn,ye,Te,Rt);if(!(Yu===void 0?as===Ys||cr(as,Ys,qe,ht,Rt):Yu)){ao=!1;break}_s||(_s=gn=="constructor")}if(ao&&!_s){var ua=ye.constructor,ji=Te.constructor;ua!=ji&&"constructor"in ye&&"constructor"in Te&&!(typeof ua=="function"&&ua instanceof ua&&typeof ji=="function"&&ji instanceof ji)&&(ao=!1)}return Rt.delete(ye),Rt.delete(Te),ao}function dl(ye){return sp(ye,pl,hp)}function Si(ye,Te){var qe=ye.__data__;return By(Te)?qe[typeof Te=="string"?"string":"hash"]:qe.map}function En(ye,Te){var qe=$e(ye,Te);return ap(qe)?qe:void 0}function dp(ye){var Te=Me.call(ye,Ze),qe=ye[Ze];try{ye[Ze]=void 0;var ht=!0}catch{}var cr=ie.call(ye);return ht&&(Te?ye[Ze]=qe:delete ye[Ze]),cr}var hp=et?function(ye){return ye==null?[]:(ye=Object(ye),de(et(ye),function(Te){return Ue.call(ye,Te)}))}:js,oo=la;(Et&&oo(new Et(new ArrayBuffer(1)))!=N||dt&&oo(new dt)!=g||Ct&&oo(Ct.resolve())!=x||kt&&oo(new kt)!=k||rr&&oo(new rr)!=A)&&(oo=function(ye){var Te=la(ye),qe=Te==v?ye.constructor:void 0,ht=qe?qs(qe):"";if(ht)switch(ht){case $r:return N;case Zt:return g;case fr:return x;case Wt:return k;case fn:return A}return Te});function pp(ye,Te){return Te=Te??i,!!Te&&(typeof ye=="number"||B.test(ye))&&ye>-1&&ye%1==0&&ye<Te}function By(ye){var Te=typeof ye;return Te=="string"||Te=="number"||Te=="symbol"||Te=="boolean"?ye!=="__proto__":ye===null}function Hu(ye){return!!re&&re in ye}function fp(ye){var Te=ye&&ye.constructor,qe=typeof Te=="function"&&Te.prototype||nt;return ye===qe}function zy(ye){return ie.call(ye)}function qs(ye){if(ye!=null){try{return Ve.call(ye)}catch{}try{return ye+""}catch{}}return""}function Wu(ye,Te){return ye===Te||ye!==ye&&Te!==Te}var Gy=Vu(function(){return arguments}())?Vu:function(ye){return so(ye)&&Me.call(ye,"callee")&&!Ue.call(ye,"callee")},hl=Array.isArray;function Vy(ye){return ye!=null&&qu(ye.length)&&!mp(ye)}var $u=at||fl;function Hy(ye,Te){return ic(ye,Te)}function mp(ye){if(!Uo(ye))return!1;var Te=la(ye);return Te==p||Te==y||Te==u||Te==w}function qu(ye){return typeof ye=="number"&&ye>-1&&ye%1==0&&ye<=i}function Uo(ye){var Te=typeof ye;return ye!=null&&(Te=="object"||Te=="function")}function so(ye){return ye!=null&&typeof ye=="object"}var ca=oe?_e(oe):lp;function pl(ye){return Vy(ye)?aa(ye):Uy(ye)}function js(){return[]}function fl(){return!1}t.exports=Hy}(Gf,Gf.exports);var iD=Gf.exports;const aD=ml(iD);function lD(t){if(t.length===0)return new Set;const n=t[0],o=t.slice(1),r=new Set;for(const s of n)o.every(a=>a.has(s))&&r.add(s);return r}function cD(t,n){const o={};for(const r of n)t.has(r)||(o.added??(o.added=new Set),o.added.add(r));for(const r of t)n.has(r)||(o.removed??(o.removed=new Set),o.removed.add(r));return o.added||o.removed?o:void 0}function Bk(t,n){for(const[o,r]of Object.entries(t)){const s=r,a=n[o];if("eq"in s&&a!==s.eq||"neq"in s&&a===s.neq||"gt"in s&&(typeof a!="number"||a<=s.gt))return!1}return!0}function zk(t,n,o){const r=Object.fromEntries(Object.keys(o).map(s=>[s,new Set]));for(const[s,a]of Object.entries(o))if("eq"in a){const i=t.index(n,s).get().get(a.eq);if(i)for(const l of i)r[s].add(l)}else if("neq"in a){const i=t.index(n,s);for(const[l,c]of i.get())if(l!==a.neq)for(const u of c)r[s].add(u)}else if("gt"in a){const i=t.index(n,s);for(const[l,c]of i.get())if(l>a.gt)for(const u of c)r[s].add(u)}return lD(Object.values(r))}class uD{constructor(n,o){R(this,"indexCache",new Map);R(this,"historyCache",new Map);this.atoms=n,this.history=o}filterHistory(n){if(this.historyCache.has(n))return this.historyCache.get(n);const o=Ye("filterHistory:"+n,(r,s)=>{if(Al(r))return this.history.get();const a=this.history.getDiffSince(s);if(a===$o)return this.history.get();const i={added:{},removed:{},updated:{}};let l=0,c=0,u=0;for(const f of a){for(const h of dn(f.added))if(h.typeName===n)if(i.removed[h.id]){const d=i.removed[h.id];delete i.removed[h.id],c--,d!==h&&(i.updated[h.id]=[d,h],u++)}else i.added[h.id]=h,l++;for(const[h,d]of dn(f.updated))d.typeName===n&&(i.added[d.id]?i.added[d.id]=d:i.updated[d.id]?i.updated[d.id]=[i.updated[d.id][0],d]:(i.updated[d.id]=[h,d],u++));for(const h of dn(f.removed))h.typeName===n&&(i.added[h.id]?(delete i.added[h.id],l--):i.updated[h.id]?(i.removed[h.id]=i.updated[h.id][0],delete i.updated[h.id],u--,c++):(i.removed[h.id]=h,c++))}return l||c||u?Bd(this.history.get(),i):r},{historyLength:100});return this.historyCache.set(n,o),o}index(n,o){const r=n+":"+o;if(this.indexCache.has(r))return this.indexCache.get(r);const s=this.__uncached_createIndex(n,o);return this.indexCache.set(r,s),s}__uncached_createIndex(n,o){const r=this.filterHistory(n),s=()=>{r.get();const a=new Map;for(const i of dn(this.atoms.get())){const l=i.get();if(l.typeName===n){const c=l[o];a.has(c)||a.set(c,new Set),a.get(c).add(l.id)}}return a};return Ye("index:"+n+":"+o,(a,i)=>{if(Al(a))return s();const l=r.getDiffSince(i);if(l===$o)return s();const c=new Map,u=(p,y)=>{let g=c.get(p);g||(g=new Df(a.get(p)??new Set)),g.add(y),c.set(p,g)},f=(p,y)=>{let g=c.get(p);g||(g=new Df(a.get(p)??new Set)),g.remove(y),c.set(p,g)};for(const p of l){for(const y of dn(p.added))if(y.typeName===n){const g=y[o];u(g,y.id)}for(const[y,g]of dn(p.updated))if(g.typeName===n){const b=y[o],m=g[o];b!==m&&(f(b,g.id),u(m,g.id))}for(const y of dn(p.removed))if(y.typeName===n){const g=y[o];f(g,y.id)}}let h,d;for(const[p,y]of c){const g=y.get();g&&(h||(h=new Map(a)),d||(d=new Map),g.value.size===0?h.delete(p):h.set(p,g.value),d.set(p,g.diff))}return h&&d?Bd(h,d):a},{historyLength:100})}record(n,o=()=>({}),r="record:"+n+(o?":"+o.toString():"")){const s=this.ids(n,o,r);return Ye(r,()=>{var a;for(const i of s.get())return(a=this.atoms.get()[i])==null?void 0:a.get()})}records(n,o=()=>({}),r="records:"+n+(o?":"+o.toString():"")){const s=this.ids(n,o,"ids:"+r);return Ye(r,()=>[...s.get()].map(a=>{const i=this.atoms.get()[a];if(!i)throw new Error("no atom found for record id: "+a);return i.get()}))}ids(n,o=()=>({}),r="ids:"+n+(o?":"+o.toString():"")){const s=this.filterHistory(n),a=()=>{s.get();const c=o();return Object.keys(c).length===0?new Set(dn(this.atoms.get()).flatMap(u=>{const f=u.get();return f.typeName===n?f.id:[]})):zk(this,n,c)},i=c=>{const u=a(),f=cD(c,u);return f?Bd(u,f):c},l=Ye("ids_query:"+r,o,{isEqual:aD});return Ye("query:"+r,(c,u)=>{const f=l.get();if(Al(c))return a();if(u<l.lastChangedEpoch)return i(c);const h=s.getDiffSince(u);if(h===$o)return i(c);const d=new Df(c);for(const y of h){for(const g of dn(y.added))g.typeName===n&&Bk(f,g)&&d.add(g.id);for(const[g,b]of dn(y.updated))b.typeName===n&&(Bk(f,b)?d.add(b.id):d.remove(b.id));for(const g of dn(y.removed))g.typeName===n&&d.remove(g.id)}const p=d.get();return p?Bd(p.value,p.diff):c},{historyLength:50})}exec(n,o){const r=zk(this,n,o);if(r.size===0)return Li;const s=this.atoms.get();return[...r].map(a=>s[a].get())}}class Gk{constructor(n){R(this,"id",zf());R(this,"atoms",fo("store_atoms",{}));R(this,"history",fo("history",0,{historyLength:1e3}));R(this,"query",new uD(this.atoms,this.history));R(this,"listeners",new Set);R(this,"historyAccumulator",new hD);R(this,"historyReactor");R(this,"schema");R(this,"props");R(this,"scopedTypes");R(this,"onBeforeCreate");R(this,"onAfterCreate");R(this,"onBeforeChange");R(this,"onAfterChange");R(this,"onBeforeDelete");R(this,"onAfterDelete");R(this,"_runCallbacks",!0);R(this,"put",(n,o)=>{Ls(()=>{const r={},s={},a=this.atoms.__unsafe__getWithoutCapture();let i=null,l,c=!1;const u=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,f=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,h=this.isMergingRemoteChanges?"remote":"user";for(let d=0,p=n.length;d<p;d++){l=n[d];const y=(i??a)[l.id];if(y){const g=y.__unsafe__getWithoutCapture();if(f&&(l=f(g,l,h)),this.schema.validateRecord(this,l,o??"updateRecord",g)===g)continue;y.set(l),c=!0,r[l.id]=[g,y.__unsafe__getWithoutCapture()]}else u&&(l=u(l,h)),c=!0,l=this.schema.validateRecord(this,l,o??"createRecord",null),s[l.id]=l,i||(i={...a}),i[l.id]=fo("atom:"+l.id,l)}if(i&&this.atoms.set(i),!!c&&(this.updateHistory({added:s,updated:r,removed:{}}),this._runCallbacks)){const{onAfterCreate:d,onAfterChange:p}=this;d&&Object.values(s).forEach(y=>{d(y,h)}),p&&Object.values(r).forEach(([y,g])=>{p(y,g,h)})}})});R(this,"remove",n=>{Ls(()=>{const o=[],r=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(const a of n){const i=this.atoms.__unsafe__getWithoutCapture()[a];i&&this.onBeforeDelete(i.get(),r)===!1&&o.push(a)}let s;if(this.atoms.update(a=>{let i;for(const l of n)o.includes(l)||l in a&&(i||(i={...a}),s||(s={}),delete i[l],s[l]=a[l].get());return i??a}),!!s&&(this.updateHistory({added:{},updated:{},removed:s}),this.onAfterDelete&&this._runCallbacks)){let a;for(let i=0,l=n.length;i<l;i++)a=s[n[i]],a&&this.onAfterDelete(a,r)}})});R(this,"get",n=>{var o;return(o=this.atoms.get()[n])==null?void 0:o.get()});R(this,"unsafeGetWithoutCapture",n=>{var o;return(o=this.atoms.get()[n])==null?void 0:o.__unsafe__getWithoutCapture()});R(this,"serialize",(n="document")=>{const o={};for(const[r,s]of Po(this.atoms.get())){const a=s.get();(n==="all"||this.scopedTypes[n].has(a.typeName))&&(o[r]=a)}return o});R(this,"allRecords",()=>dn(this.atoms.get()).map(n=>n.get()));R(this,"clear",()=>{this.remove(kk(this.atoms.get()))});R(this,"update",(n,o)=>{const r=this.atoms.get()[n];if(!r){console.error(`Record ${n} not found. This is probably an error`);return}this.put([o(r.__unsafe__getWithoutCapture())])});R(this,"has",n=>!!this.atoms.get()[n]);R(this,"listen",(n,o)=>{this._flushHistory();const r={onHistory:n,filters:{source:(o==null?void 0:o.source)??"all",scope:(o==null?void 0:o.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});R(this,"isMergingRemoteChanges",!1);R(this,"mergeRemoteChanges",n=>{if(this.isMergingRemoteChanges)return n();try{this.isMergingRemoteChanges=!0,Ls(n)}finally{this.isMergingRemoteChanges=!1}});R(this,"createComputedCache",(n,o,r)=>{const s=new Uk;return{get:a=>{const i=this.atoms.get()[a];if(i)return s.get(i,()=>{const l=r?Ye(i.name+":equals",()=>i.get(),{isEqual:r}):i;return Ye(n+":"+a,()=>o(l.get()))}).get()}}});R(this,"createSelectedComputedCache",(n,o,r)=>{const s=new Uk;return{get:a=>{const i=this.atoms.get()[a];if(!i)return;const l=Ye(n+":"+a+":selector",()=>o(i.get()));return s.get(i,()=>Ye(n+":"+a,()=>r(l.get()))).get()}}});R(this,"getRecordType",n=>{const o=this.schema.types[n.typeName];if(!o)throw new Error(`Record type ${n.typeName} not found`);return o});R(this,"_integrityChecker");R(this,"_isPossiblyCorrupted",!1);const{initialData:o,schema:r}=n;this.schema=r,this.props=n.props,o&&this.atoms.set(db(Po(o).map(([s,a])=>[s,fo("atom:"+s,this.schema.validateRecord(this,a,"initialize",null))]))),this.historyReactor=ER("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:s=>Fk(s)}),this.scopedTypes={document:new Set(dn(this.schema.types).filter(s=>s.scope==="document").map(s=>s.typeName)),session:new Set(dn(this.schema.types).filter(s=>s.scope==="session").map(s=>s.typeName)),presence:new Set(dn(this.schema.types).filter(s=>s.scope==="presence").map(s=>s.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const n=this.historyAccumulator.flush();for(const{changes:o,source:r}of n){let s=null,a=null,i=null;for(const{onHistory:l,filters:c}of this.listeners)if(!(c.source!=="all"&&c.source!==r))if(c.scope!=="all")if(c.scope==="document"){if(a??(a=this.filterChangesByScope(o,"document")),!a)continue;l({changes:a,source:r})}else if(c.scope==="session"){if(s??(s=this.filterChangesByScope(o,"session")),!s)continue;l({changes:s,source:r})}else{if(i??(i=this.filterChangesByScope(o,"presence")),!i)continue;l({changes:i,source:r})}else l({changes:o,source:r})}}}filterChangesByScope(n,o){const r={added:hb(n.added,(s,a)=>this.scopedTypes[o].has(a.typeName)),updated:hb(n.updated,(s,a)=>this.scopedTypes[o].has(a[1].typeName)),removed:hb(n.removed,(s,a)=>this.scopedTypes[o].has(a.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(n){this.historyAccumulator.add({changes:n,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,n)}validate(n){this.allRecords().forEach(o=>this.schema.validateRecord(this,o,n,null))}getSnapshot(n="document"){return{store:this.serialize(n),schema:this.schema.serialize()}}migrateSnapshot(n){const o=this.schema.migrateStoreSnapshot(n);if(o.type==="error")throw new Error(`Failed to migrate snapshot: ${o.reason}`);return{store:o.value,schema:this.schema.serialize()}}loadSnapshot(n){const o=this.schema.migrateStoreSnapshot(n);if(o.type==="error")throw new Error(`Failed to migrate snapshot: ${o.reason}`);const r=this._runCallbacks;try{this._runCallbacks=!1,Ls(()=>{this.clear(),this.put(Object.values(o.value)),this.ensureStoreIsUsable()})}finally{this._runCallbacks=r}}extractingChanges(n){const o=[],r=this.historyAccumulator.intercepting(s=>o.push(s.changes));try{return Ls(n),Vf(o)}finally{r()}}applyDiff(n,o=!0){const r=this._runCallbacks;try{this._runCallbacks=o,Ls(()=>{const s=dn(n.added).concat(dn(n.updated).map(([i,l])=>l)),a=kk(n.removed);s.length&&this.put(s),a.length&&this.remove(a)})}finally{this._runCallbacks=r}}ensureStoreIsUsable(){var n;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(n=this._integrityChecker)==null||n.call(this)}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}}function Vf(t){const n={added:{},removed:{},updated:{}};for(const o of t){for(const[r,s]of Po(o.added))if(n.removed[r]){const a=n.removed[r];delete n.removed[r],a!==s&&(n.updated[r]=[a,s])}else n.added[r]=s;for(const[r,[s,a]]of Po(o.updated)){if(n.added[r]){n.added[r]=a,delete n.updated[r],delete n.removed[r];continue}if(n.updated[r]){n.updated[r]=[n.updated[r][0],a],delete n.removed[r];continue}n.updated[r]=o.updated[r],delete n.removed[r]}for(const[r,s]of Po(o.removed))n.added[r]?delete n.added[r]:n.updated[r]?(n.removed[r]=n.updated[r][0],delete n.updated[r]):n.removed[r]=s}return n}function dD(t){if(t.length===0)return[];const n=[];let o=[t[0]],r;for(let s=1,a=t.length;s<a;s++)r=t[s],o[0].source!==r.source&&(n.push(o),o=[]),o.push(r);return n.push(o),n.map(s=>({source:s[0].source,changes:Vf(s.map(a=>a.changes))}))}class hD{constructor(){R(this,"_history",[]);R(this,"_interceptors",new Set)}intercepting(n){return this._interceptors.add(n),()=>{this._interceptors.delete(n)}}add(n){this._history.push(n);for(const o of this._interceptors)o(n)}flush(){const n=dD(this._history);return this._history=[],n}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function pD(t){const n=[];for(let o=t.length-1;o>=0;o--){const r=t[o];if("id"in r)n.unshift(r);else{const s=r.dependsOn,a=n[0];a&&(n[0]={...a,dependsOn:s.concat(a.dependsOn??[])})}}return n}function Wd({sequence:t,sequenceId:n,retroactive:o=!0}){const r={sequenceId:n,retroactive:o,sequence:pD(t)};return Hk(r),r}function Xo(t,n){return Object.fromEntries(Po(n).map(([o,r])=>[o,`${t}/${r}`]))}function fs(t){const n=t.sequenceId;return Wd({sequenceId:n,retroactive:t.retroactive??!0,sequence:t.sequence.map(o=>"id"in o?{...o,scope:"record",filter:r=>{var s,a;return r.typeName===t.recordType&&(((s=o.filter)==null?void 0:s.call(o,r))??!0)&&(((a=t.filter)==null?void 0:a.call(t,r))??!0)}}:o)})}function fD(t){const n=new Map(t.map(a=>[a.id,a])),o=new Set,r=[];function s(a){bn(!o.has(a.id),`Circular dependency in migrations: ${a.id}`),o.add(a.id);const{version:i,sequenceId:l}=Hf(a.id),c=n.get(`${l}/${i-1}`);if(c&&s(c),a.dependsOn)for(const u of a.dependsOn){const f=n.get(u);f&&s(f)}n.delete(a.id),r.push(a)}for(const a of n.values())s(a);return r}function Hf(t){const[n,o]=t.split("/");return{sequenceId:n,version:parseInt(o)}}function Vk(t,n){n&&bn(t.startsWith(n+"/"),`Every migration in sequence '${n}' must have an id starting with '${n}/'. Got invalid id: '${t}'`),bn(t.match(/^(.*?)\/(0|[1-9]\d*)$/),`Invalid migration id: '${t}'`)}function Hk(t){if(bn(!t.sequenceId.includes("/"),`sequenceId cannot contain a '/', got ${t.sequenceId}`),bn(t.sequenceId.length,"sequenceId must be a non-empty string"),t.sequence.length===0)return;Vk(t.sequence[0].id,t.sequenceId);let n=Hf(t.sequence[0].id).version;bn(n===1,`Expected the first migrationId to be '${t.sequenceId}/1' but got '${t.sequence[0].id}'`);for(let o=1;o<t.sequence.length;o++){const r=t.sequence[o].id;Vk(r,t.sequenceId);const s=Hf(r).version;bn(s===n+1,`Migration id numbers must increase in increments of 1, expected ${t.sequenceId}/${n+1} but got '${t.sequence[o].id}'`),n=s}}var Fa=(t=>(t.IncompatibleSubtype="incompatible-subtype",t.UnknownType="unknown-type",t.TargetVersionTooNew="target-version-too-new",t.TargetVersionTooOld="target-version-too-old",t.MigrationError="migration-error",t.UnrecognizedSubtype="unrecognized-subtype",t))(Fa||{});function mD(t){if(t.schemaVersion>2||t.schemaVersion<1)return zc.err("Bad schema version");if(t.schemaVersion===2)return zc.ok(t);const n={schemaVersion:2,sequences:{}};for(const[o,r]of Object.entries(t.recordVersions))if(n.sequences[`com.tldraw.${o}`]=r.version,"subTypeKey"in r)for(const[s,a]of Object.entries(r.subTypeVersions))n.sequences[`com.tldraw.${o}.${s}`]=a;return zc.ok(n)}class IS{constructor(n,o){R(this,"migrations",{});R(this,"sortedMigrations");var s;this.types=n,this.options=o;for(const a of o.migrations??[])bn(!this.migrations[a.sequenceId],`Duplicate migration sequenceId ${a.sequenceId}`),Hk(a),this.migrations[a.sequenceId]=a;const r=Object.values(this.migrations).flatMap(a=>a.sequence);this.sortedMigrations=fD(r);for(const a of this.sortedMigrations)if((s=a.dependsOn)!=null&&s.length)for(const i of a.dependsOn){const l=r.find(c=>c.id===i);bn(l,`Migration '${a.id}' depends on missing migration '${i}'`)}}static create(n,o){return new IS(n,o??{})}validateRecord(n,o,r,s){try{const a=Rs(this.types,o.typeName);if(!a)throw new Error(`Missing definition for record type ${o.typeName}`);return a.validate(o,s??void 0)}catch(a){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:n,record:o,phase:r,recordBefore:s,error:a});throw a}}getMigrationsSince(n){const o=mD(n);if(!o.ok)return o;const r=o.value,s=new Set(Object.keys(r.sequences).filter(i=>this.migrations[i]));for(const i in this.migrations)r.sequences[i]===void 0&&this.migrations[i].retroactive&&s.add(i);if(s.size===0)return zc.ok([]);const a=new Set;for(const i of s){const l=r.sequences[i];if(typeof l!="number"&&this.migrations[i].retroactive||l===0){for(const f of this.migrations[i].sequence)a.add(f.id);continue}const c=`${i}/${l}`,u=this.migrations[i].sequence.findIndex(f=>f.id===c);if(u===-1)return zc.err("Incompatible schema?");for(const f of this.migrations[i].sequence.slice(u+1))a.add(f.id)}return zc.ok(this.sortedMigrations.filter(({id:i})=>a.has(i)))}migratePersistedRecord(n,o,r="up"){const s=this.getMigrationsSince(o);if(!s.ok)return console.error("Error migrating record",s.error),{type:"error",reason:Fa.MigrationError};let a=s.value;if(a.length===0)return{type:"success",value:n};if(a.some(i=>i.scope==="store"))return{type:"error",reason:r==="down"?Fa.TargetVersionTooOld:Fa.TargetVersionTooNew};if(r==="down"){if(!a.every(i=>i.down))return{type:"error",reason:Fa.TargetVersionTooOld};a=a.slice().reverse()}n=wr(n);try{for(const i of a){if(i.scope==="store")throw new Error;if(!(!i.filter||i.filter(n)))continue;const l=i[r](n);l&&(n=wr(l))}}catch(i){return console.error("Error migrating record",i),{type:"error",reason:Fa.MigrationError}}return{type:"success",value:n}}migrateStoreSnapshot(n){let{store:o}=n;const r=this.getMigrationsSince(n.schema);if(!r.ok)return console.error("Error migrating store",r.error),{type:"error",reason:Fa.MigrationError};const s=r.value;if(s.length===0)return{type:"success",value:o};o=wr(o);try{for(const a of s)if(a.scope==="record")for(const[i,l]of Object.entries(o)){if(!(!a.filter||a.filter(l)))continue;const c=a.up(l);c&&(o[i]=wr(c))}else if(a.scope==="store"){const i=a.up(o);i&&(o=wr(i))}else Ri(a)}catch(a){return console.error("Error migrating store",a),{type:"error",reason:Fa.MigrationError}}return{type:"success",value:o}}createIntegrityChecker(n){var o,r;return((r=(o=this.options).createIntegrityChecker)==null?void 0:r.call(o,n))??void 0}serialize(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:n,sequence:o})=>[n,o.length?Hf(o.at(-1).id).version:0]))}}serializeEarliestVersion(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:n})=>[n,0]))}}}function gD(t){if(!t.length)return null;let n="";for(const o of t)typeof o=="number"?n+=`.${o}`:o.startsWith("(")?n.endsWith(")")?n=`${n.slice(0,-1)}, ${o.slice(1)}`:n+=o:n+=`.${o}`;return n=n.replace(/id = [^,]+, /,"").replace(/id = [^)]+/,""),n.startsWith(".")?n.slice(1):n}class qt extends Error{constructor(o,r=[]){const s=gD(r),a=o.split(`
`).map((i,l)=>l===0?i:`  ${i}`).join(`
`);super(r?`At ${s}: ${a}`:a);R(this,"name","ValidationError");this.rawMessage=o,this.path=r}}function Mo(t,n){try{return n()}catch(o){throw o instanceof qt?new qt(o.rawMessage,[t,...o.path]):new qt(o.toString(),[t])}}function Na(t){if(t===null)return"null";if(Array.isArray(t))return"an array";const n=typeof t;switch(n){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${n}`;case"object":return`an ${n}`;case"undefined":return"undefined";default:Ri(n)}}class xo{constructor(n,o){this.validationFn=n,this.validateUsingKnownGoodVersionFn=o}validate(n){return this.validationFn(n)}validateUsingKnownGoodVersion(n,o){return Object.is(n,o)?n:this.validateUsingKnownGoodVersionFn?this.validateUsingKnownGoodVersionFn(n,o):this.validate(o)}isValid(n){try{return this.validate(n),!0}catch{return!1}}nullable(){return SD(this)}optional(){return qk(this)}refine(n){return new xo(o=>n(this.validate(o)),(o,r)=>{const s=this.validateUsingKnownGoodVersion(o,r);return Object.is(o,s)?o:n(s)})}check(n,o){return typeof n=="string"?this.refine(r=>(Mo(`(check ${n})`,()=>o(r)),r)):this.refine(r=>(n(r),r))}}class yD extends xo{constructor(n){super(o=>{const r=$k.validate(o);for(let s=0;s<r.length;s++)Mo(s,()=>n.validate(r[s]));return r},(o,r)=>{if(!n.validateUsingKnownGoodVersion)return this.validate(r);const s=$k.validate(r);let a=o.length!==s.length;for(let i=0;i<s.length;i++){const l=s[i];if(i>=o.length){a=!0,Mo(i,()=>n.validate(l));continue}if(Object.is(o[i],l))continue;const c=Mo(i,()=>n.validateUsingKnownGoodVersion(o[i],l));Object.is(c,o[i])||(a=!0)}return a?r:o}),this.itemValidator=n}nonEmpty(){return this.check(n=>{if(n.length===0)throw new qt("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(n=>{if(n.length<=1)throw new qt("Expected an array with length greater than 1")})}}class Fy extends xo{constructor(n,o=!1){super(r=>{if(typeof r!="object"||r===null)throw new qt(`Expected object, got ${Na(r)}`);for(const[s,a]of Object.entries(n))Mo(s,()=>{a.validate(Rs(r,s))});if(!o){for(const s of Object.keys(r))if(!ei(n,s))throw new qt("Unexpected property",[s])}return r},(r,s)=>{if(typeof s!="object"||s===null)throw new qt(`Expected object, got ${Na(s)}`);let a=!1;for(const[i,l]of Object.entries(n)){const c=Rs(r,i),u=Rs(s,i);if(Object.is(c,u))continue;const f=Mo(i,()=>{const h=l;return h.validateUsingKnownGoodVersion?h.validateUsingKnownGoodVersion(c,u):h.validate(u)});Object.is(f,c)||(a=!0)}if(!o){for(const i of Object.keys(s))if(!ei(n,i))throw new qt("Unexpected property",[i])}for(const i of Object.keys(r))if(!ei(s,i)){a=!0;break}return a?s:r}),this.config=n,this.shouldAllowUnknownProperties=o}allowUnknownProperties(){return new Fy(this.config,!0)}extend(n){return new Fy({...this.config,...n})}}class Ny extends xo{constructor(n,o,r,s){super(a=>{this.expectObject(a);const{matchingSchema:i,variant:l}=this.getMatchingSchemaAndVariant(a);return i===void 0?this.unknownValueValidation(a,l):Mo(`(${n} = ${l})`,()=>i.validate(a))},(a,i)=>{this.expectObject(i),this.expectObject(a);const{matchingSchema:l,variant:c}=this.getMatchingSchemaAndVariant(i);return l===void 0?this.unknownValueValidation(i,c):Rs(a,n)!==Rs(i,n)?Mo(`(${n} = ${c})`,()=>l.validate(i)):Mo(`(${n} = ${c})`,()=>l.validateUsingKnownGoodVersion?l.validateUsingKnownGoodVersion(a,i):l.validate(i))}),this.key=n,this.config=o,this.unknownValueValidation=r,this.useNumberKeys=s}expectObject(n){if(typeof n!="object"||n===null)throw new qt(`Expected an object, got ${Na(n)}`,[])}getMatchingSchemaAndVariant(n){const o=Rs(n,this.key);if(!this.useNumberKeys&&typeof o!="string")throw new qt(`Expected a string for key "${this.key}", got ${Na(o)}`);if(this.useNumberKeys&&!Number.isFinite(Number(o)))throw new qt(`Expected a number for key "${this.key}", got "${o}"`);return{matchingSchema:ei(this.config,o)?this.config[o]:void 0,variant:o}}validateUnknownVariants(n){return new Ny(this.key,this.config,n,this.useNumberKeys)}}class vD extends xo{constructor(n,o){super(r=>{if(typeof r!="object"||r===null)throw new qt(`Expected object, got ${Na(r)}`);for(const[s,a]of Object.entries(r))Mo(s,()=>{n.validate(s),o.validate(a)});return r},(r,s)=>{if(typeof s!="object"||s===null)throw new qt(`Expected object, got ${Na(s)}`);let a=!1;for(const[i,l]of Object.entries(s)){if(!ei(r,i)){a=!0,Mo(i,()=>{n.validate(i),o.validate(l)});continue}const c=Rs(r,i),u=l;if(Object.is(c,u))continue;const f=Mo(i,()=>o.validateUsingKnownGoodVersion?o.validateUsingKnownGoodVersion(c,u):o.validate(u));Object.is(f,c)||(a=!0)}for(const i of Object.keys(r))if(!ei(s,i)){a=!0;break}return a?s:r}),this.keyValidator=n,this.valueValidator=o}}function xb(t){return new xo(n=>{if(typeof n!==t)throw new qt(`Expected ${t}, got ${Na(n)}`);return n})}const bD=new xo(t=>t),Dt=xb("string"),Mt=xb("number").check(t=>{if(Number.isNaN(t))throw new qt("Expected a number, got NaN");if(!Number.isFinite(t))throw new qt(`Expected a finite number, got ${t}`)}),Wf=Mt.check(t=>{if(t<0)throw new qt(`Expected a positive number, got ${t}`)}),To=Mt.check(t=>{if(t<=0)throw new qt(`Expected a non-zero positive number, got ${t}`)}),Wk=Mt.check(t=>{if(!Number.isInteger(t))throw new qt(`Expected an integer, got ${t}`)}),$f=Wk.check(t=>{if(t<0)throw new qt(`Expected a positive integer, got ${t}`)}),xD=Wk.check(t=>{if(t<=0)throw new qt(`Expected a non-zero positive integer, got ${t}`)}),Ht=xb("boolean");function qn(t){return new xo(n=>{if(n!==t)throw new qt(`Expected ${t}, got ${JSON.stringify(n)}`);return t})}const $k=new xo(t=>{if(!Array.isArray(t))throw new qt(`Expected an array, got ${Na(t)}`);return t});function In(t){return new yD(t)}function Gt(t){return new Fy(t)}function wb(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null||Object.getPrototypeOf(t)===sD)}function Sb(t){return t===null||typeof t=="number"||typeof t=="string"||typeof t=="boolean"?!0:Array.isArray(t)?t.every(Sb):wb(t)?Object.values(t).every(Sb):!1}const mo=new xo(t=>{if(Sb(t))return t;throw new qt(`Expected json serializable value, got ${typeof t}`)},(t,n)=>{if(Array.isArray(t)&&Array.isArray(n)){let o=t.length!==n.length;for(let r=0;r<n.length;r++){if(r>=t.length){o=!0,mo.validate(n[r]);continue}const s=t[r],a=n[r];if(Object.is(s,a))continue;const i=mo.validateUsingKnownGoodVersion(s,a);Object.is(i,s)||(o=!0)}return o?n:t}else if(wb(t)&&wb(n)){let o=!1;for(const r of Object.keys(n)){if(!ei(t,r)){o=!0,mo.validate(n[r]);continue}const s=t[r],a=n[r];if(Object.is(s,a))continue;const i=mo.validateUsingKnownGoodVersion(s,a);Object.is(i,s)||(o=!0)}for(const r of Object.keys(t))if(!ei(n,r)){o=!0;break}return o?n:t}else return mo.validate(n)});function qf(t,n){return new vD(t,n)}function jb(t,n){return new Ny(t,n,(o,r)=>{throw new qt(`Expected one of ${Object.keys(n).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!1)}function wD(t,n){return new Ny(t,n,(o,r)=>{throw new qt(`Expected one of ${Object.keys(n).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!0)}function Ni(t,n){return new xo(o=>Mo(t,()=>n.validate(o)),(o,r)=>Mo(t,()=>n.validateUsingKnownGoodVersion?n.validateUsingKnownGoodVersion(o,r):n.validate(r)))}function Yf(t){return new xo(n=>{if(!t.has(n)){const o=Array.from(t,r=>JSON.stringify(r)).join(" or ");throw new qt(`Expected ${o}, got ${n}`)}return n})}function qk(t){return new xo(n=>{if(n!==void 0)return t.validate(n)},(n,o)=>{if(!(n===void 0&&o===void 0)&&o!==void 0)return t.validateUsingKnownGoodVersion&&n!==void 0?t.validateUsingKnownGoodVersion(n,o):t.validate(o)})}function SD(t){return new xo(n=>n===null?null:t.validate(n),(n,o)=>o===null?null:t.validateUsingKnownGoodVersion&&n!==null?t.validateUsingKnownGoodVersion(n,o):t.validate(o))}function Yk(...t){return Yf(new Set(t))}function Kk(t){try{return new URL(t)}catch{if(t.startsWith("/")||t.startsWith("./"))try{return new URL(t,"http://example.com")}catch{throw new qt(`Expected a valid url, got ${JSON.stringify(t)}`)}throw new qt(`Expected a valid url, got ${JSON.stringify(t)}`)}}const jD=new Set(["http:","https:","mailto:"]),Qo=Dt.check(t=>{if(t==="")return;const n=Kk(t);if(!jD.has(n.protocol.toLowerCase()))throw new qt(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),_D=new Set(["http:","https:","data:"]),qc=Dt.check(t=>{if(t==="")return;const n=Kk(t);if(!_D.has(n.protocol.toLowerCase()))throw new qt(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),_b=Dt.refine(t=>{try{return KR(t),t}catch{throw new qt(`Expected an index key, got ${JSON.stringify(t)}`)}});function ms(t){return Dt.refine(n=>{if(!n.startsWith(`${t}:`))throw new Error(`${t} ID must start with "${t}:"`);return n})}const Kf=ms("asset");function kb(t,n){return Gt({id:Kf,typeName:qn("asset"),type:qn(t),props:n,meta:mo})}const kD=Ni("camera",Gt({typeName:qn("camera"),id:ms("camera"),x:Mt,y:Mt,z:Mt,meta:mo})),ED=Xo("com.tldraw.camera",{AddMeta:1}),CD=fs({sequenceId:"com.tldraw.camera",recordType:"camera",sequence:[{id:ED.AddMeta,up:t=>{t.meta={}}}]}),go=Fi("camera",{validator:kD,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),$d=Gt({x:Mt,y:Mt,z:Mt.optional()}),qd=Gt({x:Mt,y:Mt,w:Mt,h:Mt}),PD=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),Xk=Yf(PD),MD=Gt({type:Xk,rotation:Mt}),Qk=Mt.check(t=>{if(t<0||t>1)throw new qt("Opacity must be between 0 and 1")}),TD=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),ID=Yf(TD),AD=new Set(["starting","paused","active","stopping"]),Zk=Gt({id:Dt,points:In($d),size:Wf,color:ID,opacity:Mt,state:Yf(AD),delay:Mt,shrink:Mt,taper:Ht}),Yd=ms("page"),OD=Ni("page",Gt({typeName:qn("page"),id:Yd,name:Dt,index:_b,meta:mo})),LD=Xo("com.tldraw.page",{AddMeta:1}),RD=fs({sequenceId:"com.tldraw.page",recordType:"page",sequence:[{id:LD.AddMeta,up:t=>{t.meta={}}}]}),Ui=Fi("page",{validator:OD,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function Io(t){return Ui.isId(t)}ms("instance");function DD(t){const n={};for(const[r,s]of t)n[r]=qk(s);const o=Ni("instance",Gt({typeName:qn("instance"),id:ms("instance"),currentPageId:Yd,followingUserId:Dt.nullable(),brush:qd.nullable(),opacityForNextShape:Qk,stylesForNextShape:Gt(n),cursor:MD,scribbles:In(Zk),isFocusMode:Ht,isDebugMode:Ht,isToolLocked:Ht,exportBackground:Ht,screenBounds:qd,insets:In(Ht),zoomBrush:qd.nullable(),isPenMode:Ht,isGridMode:Ht,chatMessage:Dt,isChatting:Ht,highlightedUserIds:In(Dt),canMoveCamera:Ht,isFocused:Ht,devicePixelRatio:Mt,isCoarsePointer:Ht,isHoveringCanvas:Ht.nullable(),openMenus:In(Dt),isChangingStyle:Ht,isReadonly:Ht,meta:mo,duplicateProps:Gt({shapeIds:In(ms("shape")),offset:Gt({x:Mt,y:Mt})}).nullable()}));return Fi("instance",{validator:o,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},insets:[!1,!1,!1,!1],zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{},duplicateProps:null}))}const Dr=Xo("com.tldraw.instance",{AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22,AddInset:23,AddDuplicateProps:24}),FD=fs({sequenceId:"com.tldraw.instance",recordType:"instance",sequence:[{id:Dr.AddTransparentExportBgs,up:t=>({...t,exportBackground:!0})},{id:Dr.RemoveDialog,up:({dialog:t,...n})=>n},{id:Dr.AddToolLockMode,up:t=>({...t,isToolLocked:!1})},{id:Dr.RemoveExtraPropsForNextShape,up:({propsForNextShape:t,...n})=>({...n,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([o])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(o)))})},{id:Dr.AddLabelColor,up:({propsForNextShape:t,...n})=>({...n,propsForNextShape:{...t,labelColor:"black"}})},{id:Dr.AddFollowingUserId,up:t=>({...t,followingUserId:null})},{id:Dr.RemoveAlignJustify,up:t=>{let n=t.propsForNextShape.align;return n==="justify"&&(n="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:n}}}},{id:Dr.AddZoom,up:t=>({...t,zoomBrush:null})},{id:Dr.AddVerticalAlign,up:t=>({...t,propsForNextShape:{...t.propsForNextShape,verticalAlign:"middle"}})},{id:Dr.AddScribbleDelay,up:t=>t.scribble!==null?{...t,scribble:{...t.scribble,delay:0}}:{...t}},{id:Dr.RemoveUserId,up:({userId:t,...n})=>n},{id:Dr.AddIsPenModeAndIsGridMode,up:t=>({...t,isPenMode:!1,isGridMode:!1})},{id:Dr.HoistOpacity,up:({propsForNextShape:{opacity:t,...n},...o})=>({...o,opacityForNextShape:Number(t??"1"),propsForNextShape:n})},{id:Dr.AddChat,up:t=>({...t,chatMessage:"",isChatting:!1})},{id:Dr.AddHighlightedUserIds,up:t=>({...t,highlightedUserIds:[]})},{id:Dr.ReplacePropsForNextShapeWithStylesForNextShape,up:({propsForNextShape:t,...n})=>({...n,stylesForNextShape:{}})},{id:Dr.AddMeta,up:t=>({...t,meta:{}})},{id:Dr.RemoveCursorColor,up:t=>{const{color:n,...o}=t.cursor;return{...t,cursor:o}}},{id:Dr.AddLonelyProperties,up:t=>({...t,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1})},{id:Dr.ReadOnlyReadonly,up:({isReadOnly:t,...n})=>({...n,isReadonly:t})},{id:Dr.AddHoveringCanvas,up:t=>({...t,isHoveringCanvas:null})},{id:Dr.AddScribbles,up:({scribble:t,...n})=>({...n,scribbles:[]})},{id:Dr.AddInset,up:t=>({...t,insets:[!1,!1,!1,!1]}),down:({insets:t,...n})=>({...n})},{id:Dr.AddDuplicateProps,up:t=>({...t,duplicateProps:null}),down:({duplicateProps:t,...n})=>({...n})}]}),Ao="instance:instance",ND=Dt.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return t}),Ds=ms("shape");function UD(t,n,o){return Gt({id:Ds,typeName:qn("shape"),x:Mt,y:Mt,rotation:Mt,index:_b,parentId:ND,type:qn(t),isLocked:Ht,opacity:Qk,props:n?Gt(n):mo,meta:o?Gt(o):mo})}const BD=Ni("instance_page_state",Gt({typeName:qn("instance_page_state"),id:ms("instance_page_state"),pageId:Yd,selectedShapeIds:In(Ds),hintingShapeIds:In(Ds),erasingShapeIds:In(Ds),hoveredShapeId:Ds.nullable(),editingShapeId:Ds.nullable(),croppingShapeId:Ds.nullable(),focusedGroupId:Ds.nullable(),meta:mo})),Kd=Xo("com.tldraw.instance_page_state",{AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5}),zD=fs({sequenceId:"com.tldraw.instance_page_state",recordType:"instance_page_state",sequence:[{id:Kd.AddCroppingId,up(t){t.croppingShapeId=null}},{id:Kd.RemoveInstanceIdAndCameraId,up(t){delete t.instanceId,delete t.cameraId}},{id:Kd.AddMeta,up:t=>{t.meta={}}},{id:Kd.RenameProperties,up:t=>{},down:t=>{}},{id:Kd.RenamePropertiesAgain,up:t=>{t.selectedShapeIds=t.selectedIds,delete t.selectedIds,t.hintingShapeIds=t.hintingIds,delete t.hintingIds,t.erasingShapeIds=t.erasingIds,delete t.erasingIds,t.hoveredShapeId=t.hoveredId,delete t.hoveredId,t.editingShapeId=t.editingId,delete t.editingId,t.croppingShapeId=t.croppingShapeId??t.croppingId??null,delete t.croppingId,t.focusedGroupId=t.focusLayerId,delete t.focusLayerId},down:t=>{t.selectedIds=t.selectedShapeIds,delete t.selectedShapeIds,t.hintingIds=t.hintingShapeIds,delete t.hintingShapeIds,t.erasingIds=t.erasingShapeIds,delete t.erasingShapeIds,t.hoveredId=t.hoveredShapeId,delete t.hoveredShapeId,t.editingId=t.editingShapeId,delete t.editingShapeId,t.croppingId=t.croppingShapeId,delete t.croppingShapeId,t.focusLayerId=t.focusedGroupId,delete t.focusedGroupId}}]}),Yn=Fi("instance_page_state",{validator:BD,scope:"session"}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),GD=Ni("pointer",Gt({typeName:qn("pointer"),id:ms("pointer"),x:Mt,y:Mt,lastActivityTimestamp:Mt,meta:mo})),VD=Xo("com.tldraw.pointer",{AddMeta:1}),HD=fs({sequenceId:"com.tldraw.pointer",recordType:"pointer",sequence:[{id:VD.AddMeta,up:t=>{t.meta={}}}]}),Eb=Fi("pointer",{validator:GD,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),Xf=Eb.createId("pointer"),WD=Ni("instance_presence",Gt({typeName:qn("instance_presence"),id:ms("instance_presence"),userId:Dt,userName:Dt,lastActivityTimestamp:Mt,followingUserId:Dt.nullable(),cursor:Gt({x:Mt,y:Mt,type:Xk,rotation:Mt}),color:Dt,camera:Gt({x:Mt,y:Mt,z:Mt}),screenBounds:qd,selectedShapeIds:In(ms("shape")),currentPageId:ms("page"),brush:qd.nullable(),scribbles:In(Zk),chatMessage:Dt,meta:mo})),Xd=Xo("com.tldraw.instance_presence",{AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5}),$D=fs({sequenceId:"com.tldraw.instance_presence",recordType:"instance_presence",sequence:[{id:Xd.AddScribbleDelay,up:t=>{t.scribble!==null&&(t.scribble.delay=0)}},{id:Xd.RemoveInstanceId,up:t=>{delete t.instanceId}},{id:Xd.AddChatMessage,up:t=>{t.chatMessage=""}},{id:Xd.AddMeta,up:t=>{t.meta={}}},{id:Xd.RenameSelectedShapeIds,up:t=>{}}]}),qD=Fi("instance_presence",{validator:WD,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),YD=Ni("document",Gt({typeName:qn("document"),id:qn("document:document"),gridSize:Mt,name:Dt,meta:mo})),Jk=Xo("com.tldraw.document",{AddName:1,AddMeta:2}),KD=fs({sequenceId:"com.tldraw.document",recordType:"document",sequence:[{id:Jk.AddName,up:t=>{t.name=""},down:t=>{delete t.name}},{id:Jk.AddMeta,up:t=>{t.meta={}}}]}),Cb=Fi("document",{validator:YD,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),Pb=Cb.createId("document");function XD(t,n){return t.index<n.index?-1:t.index>n.index?1:0}function eE(t){t.typeName==="asset"&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}const QD=({error:t,phase:n,record:o,recordBefore:r})=>{throw lb(t,{tags:{origin:"store.validateRecord",storePhase:n,isExistingValidationIssue:n==="initialize"},extras:{recordBefore:r?eE(wr(r)):void 0,recordAfter:eE(wr(o))}}),t};function ZD(){return[Ui.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function JD(t){const n=t.query.ids("page"),o=()=>{if(!t.has(Pb))return t.put([Cb.create({id:Pb,name:t.props.defaultName})]),o();if(!t.has(Xf))return t.put([Eb.create({id:Xf})]),o();const r=n.get();if(r.size===0)return t.put(ZD()),o();const s=()=>[...r].map(c=>t.get(c)).sort(XD)[0].id,a=t.get(Ao);if(a){if(!r.has(a.currentPageId))return t.put([{...a,currentPageId:s()}]),o()}else return t.put([t.schema.types.instance.create({id:Ao,currentPageId:s(),exportBackground:!0})]),o();const i=new Set,l=new Set;for(const c of r){const u=Yn.createId(c);t.has(u)||i.add(u);const f=go.createId(c);t.has(f)||l.add(f)}i.size>0&&t.put([...i].map(c=>Yn.create({id:c,pageId:Yn.parseId(c)}))),l.size>0&&t.put([...l].map(c=>go.create({id:c})))};return o}const e6=kb("bookmark",Gt({title:Dt,description:Dt,image:Dt,src:qc.nullable()})),t6=Xo("com.tldraw.asset.bookmark",{MakeUrlsValid:1}),r6=fs({sequenceId:"com.tldraw.asset.bookmark",recordType:"asset",filter:t=>t.type==="bookmark",sequence:[{id:t6.MakeUrlsValid,up:t=>{qc.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),n6=kb("image",Gt({w:Mt,h:Mt,name:Dt,isAnimated:Ht,mimeType:Dt.nullable(),src:qc.nullable()})),Mb=Xo("com.tldraw.asset.image",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3}),o6=fs({sequenceId:"com.tldraw.asset.image",recordType:"asset",filter:t=>t.type==="image",sequence:[{id:Mb.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:Mb.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:Mb.MakeUrlsValid,up:t=>{qc.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),s6=kb("video",Gt({w:Mt,h:Mt,name:Dt,isAnimated:Ht,mimeType:Dt.nullable(),src:qc.nullable()})),Tb=Xo("com.tldraw.asset.video",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3}),i6=fs({sequenceId:"com.tldraw.asset.video",recordType:"asset",filter:t=>t.type==="video",sequence:[{id:Tb.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:Tb.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:Tb.MakeUrlsValid,up:t=>{qc.isValid(t.props.src)||(t.props.src="")},down:t=>{}}]}),a6=Ni("asset",jb("type",{image:n6,video:s6,bookmark:e6})),l6=Xo("com.tldraw.asset",{AddMeta:1}),c6=fs({sequenceId:"com.tldraw.asset",recordType:"asset",sequence:[{id:l6.AddMeta,up:t=>{t.meta={}}}]}),Ll=Fi("asset",{validator:a6,scope:"document"}).withDefaultProperties(()=>({meta:{}}));class to{constructor(n,o,r){this.id=n,this.defaultValue=o,this.type=r}static define(n,o){const{defaultValue:r,type:s=bD}=o;return new to(n,r,s)}static defineEnum(n,o){const{defaultValue:r,values:s}=o;return new u6(n,r,s)}validate(n){return this.type.validate(n)}validateUsingKnownGoodVersion(n,o){return this.type.validateUsingKnownGoodVersion?this.type.validateUsingKnownGoodVersion(n,o):this.validate(o)}}class u6 extends to{constructor(n,o,r){super(n,o,Yk(...r)),this.values=r}}const Qf=Xo("com.tldraw.shape",{AddIsLocked:1,HoistOpacity:2,AddMeta:3,AddWhite:4}),d6=fs({sequenceId:"com.tldraw.shape",recordType:"shape",sequence:[{id:Qf.AddIsLocked,up:t=>{t.isLocked=!1},down:t=>{delete t.isLocked}},{id:Qf.HoistOpacity,up:t=>{t.opacity=Number(t.props.opacity??"1"),delete t.props.opacity},down:t=>{const n=t.opacity;delete t.opacity,t.props.opacity=n<.175?"0.1":n<.375?"0.25":n<.625?"0.5":n<.875?"0.75":"1"}},{id:Qf.AddMeta,up:t=>{t.meta={}}},{id:Qf.AddWhite,up:t=>{},down:t=>{t.props.color==="white"&&(t.props.color="black")}}]});function Yc(t){return t?t.typeName==="shape":!1}function Zo(t){return t?t.startsWith("shape:"):!1}function ur(t){return`shape:${t??zf()}`}function tE(t){const n=new Map;for(const[o,r]of Object.entries(t))if(r instanceof to){if(n.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);n.set(r,o)}return n}const Kr="retired";function ti(t,n){return Uf(n,(o,r)=>`com.tldraw.shape.${t}/${r}`)}function h6(t){const n=[];for(const[o,{migrations:r}]of Object.entries(t)){const s=`com.tldraw.shape.${o}`;r?"sequenceId"in r?(bn(s===r.sequenceId,`sequenceId mismatch for ${o} shape migrations. Expected '${s}', got '${r.sequenceId}'`),n.push(r)):"sequence"in r?n.push(Wd({sequenceId:s,retroactive:!1,sequence:r.sequence.map(a=>"id"in a?{id:a.id,scope:"record",filter:i=>i.typeName==="shape"&&i.type===o,dependsOn:a.dependsOn,up:i=>{const l=a.up(i.props);l&&(i.props=l)},down:typeof a.down=="function"?i=>{const l=a.down(i.props);l&&(i.props=l)}:void 0}:a)})):n.push(Wd({sequenceId:s,retroactive:!1,sequence:Object.keys(r.migrators).map(a=>Number(a)).sort((a,i)=>a-i).map(a=>({id:`${s}/${a}`,scope:"record",filter:i=>i.typeName==="shape"&&i.type===o,up:i=>{const l=r.migrators[a].up(i);if(l)return l},down:i=>{const l=r.migrators[a].down(i);if(l)return l}}))})):n.push(Wd({sequenceId:s,retroactive:!1,sequence:[]}))}return n}function p6(t){return Fi("shape",{scope:"document",validator:Ni("shape",jb("type",Uf(t,(n,{props:o,meta:r})=>UD(n,o,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}const rE=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red","white"],Zf={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",note:{fill:"#FCE19C",text:"#000000"},semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4465e9",note:{fill:"#8AA3FF",text:"#000000"},semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",note:{fill:"#6FC896",text:"#000000"},semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#9fa8b2",note:{fill:"#C0CAD3",text:"#000000"},semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4ba1f1",note:{fill:"#9BC4FD",text:"#000000"},semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#4cb05e",note:{fill:"#98D08A",text:"#000000"},semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#f87777",note:{fill:"#F7A5A1",text:"#000000"},semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e085f4",note:{fill:"#DFB0F9",text:"#000000"},semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#e16919",note:{fill:"#FAA475",text:"#000000"},semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",note:{fill:"#FC8282",text:"#000000"},semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",note:{fill:"#DB91FD",text:"#000000"},semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#f1ac4b",note:{fill:"#FED49A",text:"#000000"},semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},white:{solid:"#FFFFFF",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#FFFFFF",text:"#000000"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}},darkMode:{id:"dark",text:"hsl(210, 17%, 98%)",background:"hsl(240, 5%, 6.5%)",solid:"#010403",black:{solid:"#f2f2f2",note:{fill:"#2c2c2c",text:"#f2f2f2"},semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4f72fc",note:{fill:"#2A3F98",text:"#f2f2f2"},semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#099268",note:{fill:"#014429",text:"#f2f2f2"},semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#9398b0",note:{fill:"#56595F",text:"#f2f2f2"},semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#4dabf7",note:{fill:"#1F5495",text:"#f2f2f2"},semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#40c057",note:{fill:"#21581D",text:"#f2f2f2"},semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#ff8787",note:{fill:"#923632",text:"#f2f2f2"},semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#e599f7",note:{fill:"#762F8E",text:"#f2f2f2"},semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#f76707",note:{fill:"#843906",text:"#f2f2f2"},semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#e03131",note:{fill:"#89231A",text:"#f2f2f2"},semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#ae3ec9",note:{fill:"#681683",text:"#f2f2f2"},semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#ffc034",note:{fill:"#98571B",text:"#f2f2f2"},semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},white:{solid:"#f3f3f3",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#eaeaea",text:"#1d1d1d"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}}};function Bi(t){return t.isDarkMode?Zf.darkMode:Zf.lightMode}const Jo=to.defineEnum("tldraw:color",{defaultValue:"black",values:rE}),nE=to.defineEnum("tldraw:labelColor",{defaultValue:"black",values:rE}),Rl=to.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),Kc=to.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),ri=to.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),oE={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},ni=to.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),sE=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],Jf=to.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:sE}),em=to.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:sE}),iE=jb("type",{binding:Gt({type:qn("binding"),boundShapeId:Ds,normalizedAnchor:$d,isExact:Ht,isPrecise:Ht}),point:Gt({type:qn("point"),x:Mt,y:Mt})}),aE={labelColor:nE,color:Jo,fill:Kc,dash:Rl,size:ni,arrowheadStart:Jf,arrowheadEnd:em,font:ri,start:iE,end:iE,bend:Mt,text:Dt,labelPosition:Mt},Ib=ti("arrow",{AddLabelColor:1,AddIsPrecise:2,AddLabelPosition:3}),lE={sequence:[{id:Ib.AddLabelColor,up:t=>{t.labelColor="black"},down:Kr},{id:Ib.AddIsPrecise,up:({start:t,end:n})=>{t.type==="binding"&&(t.isPrecise=!(t.normalizedAnchor.x===.5&&t.normalizedAnchor.y===.5)),n.type==="binding"&&(n.isPrecise=!(n.normalizedAnchor.x===.5&&n.normalizedAnchor.y===.5))},down:({start:t,end:n})=>{t.type==="binding"&&(t.isPrecise||(t.normalizedAnchor={x:.5,y:.5}),delete t.isPrecise),n.type==="binding"&&(n.isPrecise||(n.normalizedAnchor={x:.5,y:.5}),delete n.isPrecise)}},{id:Ib.AddLabelPosition,up:t=>{t.labelPosition=.5},down:t=>{delete t.labelPosition}}]},cE={w:To,h:To,assetId:Kf.nullable(),url:Qo},uE=ti("bookmark",{NullAssetId:1,MakeUrlsValid:2}),dE={sequence:[{id:uE.NullAssetId,up:t=>{t.assetId===void 0&&(t.assetId=null)},down:Kr},{id:uE.MakeUrlsValid,up:t=>{Qo.isValid(t.url)||(t.url="")},down:t=>{}}]},hE=Gt({type:Yk("free","straight"),points:In($d)}),pE={color:Jo,fill:Kc,dash:Rl,size:ni,segments:In(hE),isComplete:Ht,isClosed:Ht,isPen:Ht},f6=ti("draw",{AddInPen:1}),fE={sequence:[{id:f6.AddInPen,up:t=>{const{points:n}=t.segments[0];if(n.length===0){t.isPen=!1;return}let o=!(n[0].z===0||n[0].z===.5);n[1]&&(o=o&&!(n[1].z===0||n[1].z===.5)),t.isPen=o},down:Kr}]},mE=/(^\/r\/[^/]+\/?$)/,dr=t=>{try{return new URL(t)}catch{return}},Qd=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(mE))return t},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(mE))return t}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/embed\/?$/)){const o=n.searchParams.get("url");if(o)return o}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.includes("/maps/")){const n=t.match(/@(.*),(.*),(.*)z/);let o;if(n){const[,r,s,a]=n;o=`https://${new URL(t).host.replace("www.","")}/maps/embed/v1/view?key=${{}.NEXT_PUBLIC_GC_API_KEY}&center=${r},${s}&zoom=${a}`}else o="";return o}},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&n.searchParams.has("center")&&n.searchParams.get("zoom")){const o=n.searchParams.get("zoom"),[r,s]=n.searchParams.get("center").split(",");return`https://www.google.com/maps/@${r},${s},${o}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const n=dr(t),o=n&&n.pathname.match(/\/v\/([^/]+)\/?/);if(o)return`https://www.val.town/embed/${o[1]}`},fromEmbedUrl:t=>{const n=dr(t),o=n&&n.pathname.match(/\/embed\/([^/]+)\/?/);if(o)return`https://www.val.town/v/${o[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const n=dr(t),o=n&&n.pathname.match(/\/s\/([^/]+)\/?/);if(o)return`https://codesandbox.io/embed/${o[1]}`},fromEmbedUrl:t=>{const n=dr(t),o=n&&n.pathname.match(/\/embed\/([^/]+)\/?/);if(o)return`https://codesandbox.io/s/${o[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:t=>{const n=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,o=t.match(n);if(o){const[r,s,a]=o;return`https://codepen.io/${s}/embed/${a}`}},fromEmbedUrl:t=>{const n=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,o=t.match(n);if(o){const[r,s,a]=o;return`https://codepen.io/${s}/pen/${a}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:t=>{const n=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,o=t.match(n);if(o){const[r,s]=o;return`https://scratch.mit.edu/projects/embed/${s}`}},fromEmbedUrl:t=>{const n=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,o=t.match(n);if(o){const[r,s]=o;return`https://scratch.mit.edu/projects/${s}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{const n=dr(t);if(!n)return;const o=n.hostname.replace(/^www./,"");if(o==="youtu.be")return`https://www.youtube.com/embed/${n.pathname.split("/").filter(Boolean)[0]}`;if((o==="youtube.com"||o==="m.youtube.com")&&n.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${n.searchParams.get("v")}`},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.hostname.replace(/^www./,"")==="youtube.com"){const o=n.pathname.match(/^\/embed\/([^/]+)\/?/);if(o)return`https://www.youtube.com/watch?v=${o[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:t=>{const n=dr(t),o=n==null?void 0:n.searchParams.get("cid");if(n!=null&&n.pathname.match(/\/calendar\/u\/0/)&&o){n.pathname="/calendar/embed";const r=Array.from(n.searchParams.keys());for(const s of r)n.searchParams.delete(s);return n.searchParams.set("src",o),n.href}},fromEmbedUrl:t=>{const n=dr(t),o=n==null?void 0:n.searchParams.get("src");if(n!=null&&n.pathname.match(/\/calendar\/embed/)&&o){n.pathname="/calendar/u/0";const r=Array.from(n.searchParams.keys());for(const s of r)n.searchParams.delete(s);return n.searchParams.set("cid",o),n.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,toEmbedUrl:t=>{const n=dr(t);if(n!=null&&n.pathname.match(/^\/presentation/)&&(n!=null&&n.pathname.match(/\/pub\/?$/))){n.pathname=n.pathname.replace(/\/pub$/,"/embed");const o=Array.from(n.searchParams.keys());for(const r of o)n.searchParams.delete(r);return n.href}},fromEmbedUrl:t=>{const n=dr(t);if(n!=null&&n.pathname.match(/^\/presentation/)&&(n!=null&&n.pathname.match(/\/embed\/?$/))){n.pathname=n.pathname.replace(/\/embed$/,"/pub");const o=Array.from(n.searchParams.keys());for(const r of o)n.searchParams.delete(r);return n.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/\/@([^/]+)\/([^/]+)/)&&n.searchParams.has("embed"))return n.searchParams.delete("embed"),n.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/map\//))return n.origin+"/embed"+n.pathname},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/embed\/map\//))return n.pathname=n.pathname.replace(/^\/embed/,""),n.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/(artist|album)\//))return n.origin+"/embed"+n.pathname},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/embed\/(artist|album)\//))return n.origin+n.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.hostname==="vimeo.com"&&n.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+n.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.hostname==="player.vimeo.com"){const o=n.pathname.match(/^\/video\/([^/]+)\/?$/);if(o)return"https://vimeo.com/"+o[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const n=dr(t);if(n&&n.hash.match(/#room=/))return t},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${n.origin}/embed${n.pathname}?cell=*`;if(n&&n.pathname.match(/^\/d\/([^/]+)\/?$/)){const o=n.pathname.replace(/^\/d/,"");return`${n.origin}/embed${o}?cell=*`}},fromEmbedUrl:t=>{const n=dr(t);if(n&&n.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${n.origin}${n.pathname.replace("/embed","")}#cell-*`;if(n&&n.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${n.origin}${n.pathname.replace("/embed","/d")}#cell-*`}}],m6={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},gE={w:To,h:To,url:Dt},tm=ti("embed",{GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4}),yE={sequence:[{id:tm.GenOriginalUrlInEmbed,up:t=>{try{const n=t.url,o=new URL(n).host.replace("www.","");let r;for(const s of Qd)if(s.hostnames.includes(o))try{r=s.fromEmbedUrl(n)}catch(a){console.warn(a)}t.tmpOldUrl=t.url,t.url=r??""}catch{t.url="",t.tmpOldUrl=t.url}},down:Kr},{id:tm.RemoveDoesResize,up:t=>{delete t.doesResize},down:Kr},{id:tm.RemoveTmpOldUrl,up:t=>{delete t.tmpOldUrl},down:Kr},{id:tm.RemovePermissionOverrides,up:t=>{delete t.overridePermissions},down:Kr}]},vE={w:To,h:To,name:Dt},bE={sequence:[]},Zd=to.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),rm=to.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),oi=to.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),xE={geo:oi,labelColor:nE,color:Jo,fill:Kc,dash:Rl,size:ni,font:ri,align:Zd,verticalAlign:rm,url:Qo,w:To,h:To,growY:Wf,text:Dt},Ua=ti("geo",{AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8}),wE={sequence:[{id:Ua.AddUrlProp,up:t=>{t.url=""},down:Kr},{id:Ua.AddLabelColor,up:t=>{t.labelColor="black"},down:Kr},{id:Ua.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:Kr},{id:Ua.AddCheckBox,up:t=>{},down:Kr},{id:Ua.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:Kr},{id:Ua.MigrateLegacyAlign,up:t=>{let n;switch(t.align){case"start":n="start-legacy";break;case"end":n="end-legacy";break;default:n="middle-legacy";break}t.align=n},down:Kr},{id:Ua.AddCloud,up:t=>{},down:Kr},{id:Ua.MakeUrlsValid,up:t=>{Qo.isValid(t.url)||(t.url="")},down:t=>{}}]},SE={},jE={sequence:[]},_E={color:Jo,size:ni,segments:In(hE),isComplete:Ht,isPen:Ht},kE={sequence:[]},g6=Gt({topLeft:$d,bottomRight:$d}),EE={w:To,h:To,playing:Ht,url:Qo,assetId:Kf.nullable(),crop:g6.nullable()},Ab=ti("image",{AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3}),CE={sequence:[{id:Ab.AddUrlProp,up:t=>{t.url=""},down:Kr},{id:Ab.AddCropProp,up:t=>{t.crop=null},down:t=>{delete t.crop}},{id:Ab.MakeUrlsValid,up:t=>{Qo.isValid(t.url)||(t.url="")},down:t=>{}}]},nm=to.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),y6=Gt({id:Dt,index:_b,x:Mt,y:Mt}),PE={color:Jo,dash:Rl,size:ni,spline:nm,points:qf(Dt,y6)},om=ti("line",{AddSnapHandles:1,RemoveExtraHandleProps:2,HandlesToPoints:3,PointIndexIds:4}),ME={sequence:[{id:om.AddSnapHandles,up:t=>{for(const n of Object.values(t.handles))n.canSnap=!0},down:Kr},{id:om.RemoveExtraHandleProps,up:t=>{t.handles=db(Object.values(t.handles).map(n=>[n.index,{x:n.x,y:n.y}]))},down:t=>{const n=Object.entries(t.handles).map(([o,r])=>({index:o,...r})).sort($n);t.handles=Object.fromEntries(n.map((o,r)=>{const s=r===0?"start":r===n.length-1?"end":`handle:${o.index}`;return[s,{id:s,type:"vertex",canBind:!1,canSnap:!0,index:o.index,x:o.x,y:o.y}]}))}},{id:om.HandlesToPoints,up:t=>{const n=Object.entries(t.handles).map(([o,{x:r,y:s}])=>({x:r,y:s,index:o})).sort($n);t.points=n.map(({x:o,y:r})=>({x:o,y:r})),delete t.handles},down:t=>{const n=Vd(t.points.length);t.handles=Object.fromEntries(t.points.map((o,r)=>[n[r],{x:o.x,y:o.y}])),delete t.points}},{id:om.PointIndexIds,up:t=>{const n=Vd(t.points.length);t.points=Object.fromEntries(t.points.map((o,r)=>{const s=n[r];return[s,{id:s,index:s,x:o.x,y:o.y}]}))},down:t=>{const n=Object.values(t.points).sort($n);t.points=n.map(({x:o,y:r})=>({x:o,y:r}))}}]},TE={color:Jo,size:ni,font:ri,fontSizeAdjustment:Wf,align:Zd,verticalAlign:rm,growY:Wf,url:Qo,text:Dt},Xc=ti("note",{AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5,AddFontSizeAdjustment:6}),IE={sequence:[{id:Xc.AddUrlProp,up:t=>{t.url=""},down:Kr},{id:Xc.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:Kr},{id:Xc.MigrateLegacyAlign,up:t=>{switch(t.align){case"start":t.align="start-legacy";return;case"end":t.align="end-legacy";return;default:t.align="middle-legacy";return}},down:Kr},{id:Xc.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:Kr},{id:Xc.MakeUrlsValid,up:t=>{Qo.isValid(t.url)||(t.url="")},down:t=>{}},{id:Xc.AddFontSizeAdjustment,up:t=>{t.fontSizeAdjustment=0},down:t=>{delete t.fontSizeAdjustment}}]},AE={color:Jo,size:ni,font:ri,align:Zd,w:To,text:Dt,scale:To,autoSize:Ht},v6=ti("text",{RemoveJustify:1}),OE={sequence:[{id:v6.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:Kr}]},LE={w:To,h:To,time:Mt,playing:Ht,url:Qo,assetId:Kf.nullable()},RE=ti("video",{AddUrlProp:1,MakeUrlsValid:2}),DE={sequence:[{id:RE.AddUrlProp,up:t=>{t.url=""},down:Kr},{id:RE.MakeUrlsValid,up:t=>{Qo.isValid(t.url)||(t.url="")},down:t=>{}}]},sm=Xo("com.tldraw.store",{RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4}),b6=Wd({sequenceId:"com.tldraw.store",retroactive:!1,sequence:[{id:sm.RemoveCodeAndIconShapeTypes,scope:"store",up:t=>{for(const[n,o]of Po(t))o.typeName==="shape"&&(o.type==="icon"||o.type==="code")&&delete t[n]}},{id:sm.AddInstancePresenceType,scope:"store",up(t){}},{id:sm.RemoveTLUserAndPresenceAndAddPointer,scope:"store",up:t=>{for(const[n,o]of Po(t))o.typeName.match(/^(user|user_presence)$/)&&delete t[n]}},{id:sm.RemoveUserDocument,scope:"store",up:t=>{for(const[n,o]of Po(t))o.typeName.match("user_document")&&delete t[n]}}]}),x6={arrow:{migrations:lE,props:aE},bookmark:{migrations:dE,props:cE},draw:{migrations:fE,props:pE},embed:{migrations:yE,props:gE},frame:{migrations:bE,props:vE},geo:{migrations:wE,props:xE},group:{migrations:jE,props:SE},highlight:{migrations:kE,props:_E},image:{migrations:CE,props:EE},line:{migrations:ME,props:PE},note:{migrations:IE,props:TE},text:{migrations:OE,props:AE},video:{migrations:DE,props:LE}};function w6({shapes:t=x6,migrations:n}={}){const o=new Map;for(const a of dn(t))for(const i of tE(a.props??{}).keys()){if(o.has(i.id)&&o.get(i.id)!==i)throw new Error(`Multiple StyleProp instances with the same id: ${i.id}`);o.set(i.id,i)}const r=p6(t),s=DD(o);return IS.create({asset:Ll,camera:go,document:Cb,instance:s,instance_page_state:Yn,page:Ui,instance_presence:qD,pointer:Eb,shape:r},{migrations:[b6,c6,CD,KD,FD,zD,RD,$D,HD,d6,r6,o6,i6,...h6(t),...n??[]],onValidationFailure:QD,createIntegrityChecker:JD})}const Jd=[{locale:"ca",label:"Catal\xE0"},{locale:"cs",label:"\u010Ce\u0161tina"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xF1ol"},{locale:"fr",label:"Fran\xE7ais"},{locale:"gl",label:"Galego"},{locale:"hr",label:"Hrvatski"},{locale:"it",label:"Italiano"},{locale:"hu",label:"Magyar"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xEAs - Brasil"},{locale:"pt-pt",label:"Portugu\xEAs - Europeu"},{locale:"ro",label:"Rom\xE2n\u0103"},{locale:"ru",label:"Russian"},{locale:"sl",label:"Sloven\u0161\u010Dina"},{locale:"fi",label:"Suomi"},{locale:"sv",label:"Svenska"},{locale:"vi",label:"Ti\u1EBFng Vi\u1EC7t"},{locale:"tr",label:"T\xFCrk\xE7e"},{locale:"uk",label:"Ukrainian"},{locale:"he",label:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{locale:"ar",label:"\u0639\u0631\u0628\u064A"},{locale:"fa",label:"\u0641\u0627\u0631\u0633\u06CC"},{locale:"ku",label:"\u06A9\u0648\u0631\u062F\u06CC"},{locale:"ne",label:"\u0928\u0947\u092A\u093E\u0932\u0940"},{locale:"hi-in",label:"\u0939\u093F\u0928\u094D\u0926\u0940"},{locale:"te",label:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{locale:"th",label:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22"},{locale:"my",label:"\u1019\u103C\u1014\u103A\u1019\u102C\u1005\u102C"},{locale:"ko-kr",label:"\uD55C\uAD6D\uC5B4"},{locale:"ja",label:"\u65E5\u672C\u8A9E"},{locale:"zh-cn",label:"\u7B80\u4F53\u4E2D\u6587"},{locale:"zh-tw",label:"\u7E41\u9AD4\u4E2D\u6587 (\u53F0\u7063)"}];function S6(){const t=typeof window<"u"?window.navigator.languages??["en"]:["en"];return j6(t)}function j6(t){for(const n of t){const o=_6(n);if(o)return o}return"en"}const FE={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function _6(t){const n=Jd.find(s=>s.locale===t.toLowerCase());if(n)return n.locale;const[o,r]=t.split(/[-_]/).map(s=>s.toLowerCase());if(r){const s=Jd.find(a=>a.locale===o);if(s)return s.locale}return o in FE?FE[o]:null}var NE={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var n={}.hasOwnProperty;function o(){for(var a="",i=0;i<arguments.length;i++){var l=arguments[i];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return o.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var i="";for(var l in a)n.call(a,l)&&a[l]&&(i=s(i,l));return i}function s(a,i){return i?a?a+" "+i:a+i:a}t.exports?(o.default=o,t.exports=o):window.classNames=o})()})(NE);var k6=NE.exports;const Pt=ml(k6),E6={error:null};class UE extends z.Component{constructor(){super(...arguments);R(this,"state",E6)}static getDerivedStateFromError(o){return{error:o}}componentDidCatch(o){var r,s;(s=(r=this.props).onError)==null||s.call(r,o)}render(){const{error:o}=this.state;if(o!==null){const{fallback:r}=this.props;return E.jsx(r,{error:o})}return this.props.children}}function eh({children:t,fallback:n,...o}){return n===null?E.jsx(E.Fragment,{children:t}):E.jsx(UE,{fallback:n,...o,children:t})}const im=Bt.createContext({});function Be(){return Bt.useContext(im)}function C6(){return E.jsx("div",{className:"tl-background"})}function Qc(t,n,o,r,s,a){z.useLayoutEffect(()=>{const i=t.current;if(!i||n===void 0)return;let l=`translate(${n}px, ${o}px)`;r!==void 0&&(l+=` scale(${r})`),s!==void 0&&(l+=` rotate(${s}rad)`),a&&(l+=` translate(${a.x}px, ${a.y}px)`),i.style.transform=l})}const Kn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2};class q{constructor(n=0,o=0,r=1){this.x=n,this.y=o,this.z=r}get pressure(){return this.z}set(n=this.x,o=this.y,r=this.z){return this.x=n,this.y=o,this.z=r,this}setTo({x:n=0,y:o=0,z:r=1}){return this.x=n,this.y=o,this.z=r,this}rot(n){if(n===0)return this;const{x:o,y:r}=this,s=Math.sin(n),a=Math.cos(n);return this.x=o*a-r*s,this.y=o*s+r*a,this}rotWith(n,o){if(o===0)return this;const r=this.x-n.x,s=this.y-n.y,a=Math.sin(o),i=Math.cos(o);return this.x=n.x+(r*i-s*a),this.y=n.y+(r*a+s*i),this}clone(){const{x:n,y:o,z:r}=this;return new q(n,o,r)}sub(n){return this.x-=n.x,this.y-=n.y,this}subXY(n,o){return this.x-=n,this.y-=o,this}subScalar(n){return this.x-=n,this.y-=n,this}add(n){return this.x+=n.x,this.y+=n.y,this}addXY(n,o){return this.x+=n,this.y+=o,this}addScalar(n){return this.x+=n,this.y+=n,this}clamp(n,o){return this.x=Math.max(this.x,n),this.y=Math.max(this.y,n),o!==void 0&&(this.x=Math.min(this.x,o),this.y=Math.min(this.y,o)),this}div(n){return this.x/=n,this.y/=n,this}divV(n){return this.x/=n.x,this.y/=n.y,this}mul(n){return this.x*=n,this.y*=n,this}mulV(n){return this.x*=n.x,this.y*=n.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(n,o){const r=q.Tan(n,this);return this.add(r.mul(o))}neg(){return this.x*=-1,this.y*=-1,this}cross(n){return this.x=this.y*n.z-this.z*n.y,this.y=this.z*n.x-this.x*n.z,this}dpr(n){return q.Dpr(this,n)}cpr(n){return q.Cpr(this,n)}len2(){return q.Len2(this)}len(){return q.Len(this)}pry(n){return q.Pry(this,n)}per(){const{x:n,y:o}=this;return this.x=o,this.y=-n,this}uni(){return q.Uni(this)}tan(n){return q.Tan(this,n)}dist(n){return q.Dist(this,n)}distanceToLineSegment(n,o){return q.DistanceToLineSegment(n,o,this)}slope(n){return q.Slope(this,n)}snapToGrid(n){return this.x=Math.round(this.x/n)*n,this.y=Math.round(this.y/n)*n,this}angle(n){return q.Angle(this,n)}toAngle(){return q.ToAngle(this)}lrp(n,o){return this.x=this.x+(n.x-this.x)*o,this.y=this.y+(n.y-this.y)*o,this}equals(n){return q.Equals(this,n)}equalsXY(n,o){return q.EqualsXY(this,n,o)}norm(){const n=this.len();return this.x=n===0?0:this.x/n,this.y=n===0?0:this.y/n,this}toFixed(){return q.ToFixed(this)}toString(){return q.ToString(q.ToFixed(this))}toJson(){return q.ToJson(this)}toArray(){return q.ToArray(this)}static Add(n,o){return new q(n.x+o.x,n.y+o.y)}static AddXY(n,o,r){return new q(n.x+o,n.y+r)}static Sub(n,o){return new q(n.x-o.x,n.y-o.y)}static SubXY(n,o,r){return new q(n.x-o,n.y-r)}static AddScalar(n,o){return new q(n.x+o,n.y+o)}static SubScalar(n,o){return new q(n.x-o,n.y-o)}static Div(n,o){return new q(n.x/o,n.y/o)}static Mul(n,o){return new q(n.x*o,n.y*o)}static DivV(n,o){return new q(n.x/o.x,n.y/o.y)}static MulV(n,o){return new q(n.x*o.x,n.y*o.y)}static Neg(n){return new q(-n.x,-n.y)}static Per(n){return new q(n.y,-n.x)}static Abs(n){return new q(Math.abs(n.x),Math.abs(n.y))}static Dist(n,o){return((n.y-o.y)**2+(n.x-o.x)**2)**.5}static DistMin(n,o,r){return(n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y)<r**2}static Dist2(n,o){return(n.x-o.x)*(n.x-o.x)+(n.y-o.y)*(n.y-o.y)}static Dpr(n,o){return n.x*o.x+n.y*o.y}static Cross(n,o){return new q(n.y*o.z-n.z*o.y,n.z*o.x-n.x*o.z)}static Cpr(n,o){return n.x*o.y-o.x*n.y}static Len2(n){return n.x*n.x+n.y*n.y}static Len(n){return(n.x*n.x+n.y*n.y)**.5}static Pry(n,o){return q.Dpr(n,o)/q.Len(o)}static Uni(n){return q.Div(n,q.Len(n))}static Tan(n,o){return q.Uni(q.Sub(n,o))}static Min(n,o){return new q(Math.min(n.x,o.x),Math.min(n.y,o.y))}static Max(n,o){return new q(Math.max(n.x,o.x),Math.max(n.y,o.y))}static From({x:n,y:o,z:r=1}){return new q(n,o,r)}static FromArray(n){return new q(n[0],n[1])}static Rot(n,o=0){const r=Math.sin(o),s=Math.cos(o);return new q(n.x*s-n.y*r,n.x*r+n.y*s)}static RotWith(n,o,r){const s=n.x-o.x,a=n.y-o.y,i=Math.sin(r),l=Math.cos(r);return new q(o.x+(s*l-a*i),o.y+(s*i+a*l))}static NearestPointOnLineThroughPoint(n,o,r){return q.Mul(o,q.Sub(r,n).pry(o)).add(n)}static NearestPointOnLineSegment(n,o,r,s=!0){if(q.Equals(n,r)||q.Equals(o,r))return q.From(r);const a=q.Tan(o,n),i=q.Add(n,q.Mul(a,q.Sub(r,n).pry(a)));if(s){if(i.x<Math.min(n.x,o.x))return q.Cast(n.x<o.x?n:o);if(i.x>Math.max(n.x,o.x))return q.Cast(n.x>o.x?n:o);if(i.y<Math.min(n.y,o.y))return q.Cast(n.y<o.y?n:o);if(i.y>Math.max(n.y,o.y))return q.Cast(n.y>o.y?n:o)}return i}static DistanceToLineThroughPoint(n,o,r){return q.Dist(r,q.NearestPointOnLineThroughPoint(n,o,r))}static DistanceToLineSegment(n,o,r,s=!0){return q.Dist(r,q.NearestPointOnLineSegment(n,o,r,s))}static Snap(n,o=1){return new q(Math.round(n.x/o)*o,Math.round(n.y/o)*o)}static Cast(n){return n instanceof q?n:q.From(n)}static Slope(n,o){return n.x===o.y?NaN:(n.y-o.y)/(n.x-o.x)}static IsNaN(n){return isNaN(n.x)||isNaN(n.y)}static Angle(n,o){return Math.atan2(o.y-n.y,o.x-n.x)}static Lrp(n,o,r){return q.Sub(o,n).mul(r).add(n)}static Med(n,o){return new q((n.x+o.x)/2,(n.y+o.y)/2)}static Equals(n,o){return Math.abs(n.x-o.x)<1e-4&&Math.abs(n.y-o.y)<1e-4}static EqualsXY(n,o,r){return n.x===o&&n.y===r}static Clockwise(n,o,r){return(r.x-n.x)*(o.y-n.y)-(o.x-n.x)*(r.y-n.y)<0}static Rescale(n,o){const r=q.Len(n);return new q(o*n.x/r,o*n.y/r)}static ScaleWithOrigin(n,o,r){return q.Sub(n,r).mul(o).add(r)}static ToFixed(n,o=2){return new q(+n.x.toFixed(o),+n.y.toFixed(o),+n.z.toFixed(o))}static Nudge(n,o,r){return q.Add(n,q.Tan(o,n).mul(r))}static ToString(n){return`${n.x}, ${n.y}`}static ToAngle(n){let o=Math.atan2(n.y,n.x);return o<0&&(o+=Math.PI*2),o}static FromAngle(n,o=1){return new q(Math.cos(n)*o,Math.sin(n)*o)}static ToArray(n){return[n.x,n.y,n.z]}static ToJson(n){const{x:o,y:r,z:s}=n;return{x:o,y:r,z:s}}static Average(n){const o=n.length,r=new q(0,0);if(o===0)return r;for(let s=0;s<o;s++)r.add(n[s]);return r.div(o)}static Clamp(n,o,r){return r===void 0?new q(Math.min(Math.max(n.x,o)),Math.min(Math.max(n.y,o))):new q(Math.min(Math.max(n.x,o),r),Math.min(Math.max(n.y,o),r))}static PointsBetween(n,o,r=6){const s=[];for(let a=0;a<r;a++){const i=Kn.easeInQuad(a/(r-1)),l=q.Lrp(n,o,i);l.z=Math.min(1,.5+Math.abs(.5-P6(i))*.65),s.push(l)}return s}static SnapToGrid(n,o=8){return new q(Math.round(n.x/o)*o,Math.round(n.y/o)*o)}}const P6=t=>t<.5?2*t*t:-1+(4-2*t)*t;function An(t){return`${ke(t.x)},${ke(t.y)} `}function Oo(t,n){return`${ke((t.x+n.x)/2)},${ke((t.y+n.y)/2)} `}const Yt=Math.PI,hr=Yt/2,nr=Yt*2,M6=Math.sin;function Ba(t,n,o){return Math.max(n,typeof o<"u"?Math.min(t,o):t)}function am(t,n=1e10){return t?Math.round(t*n)/n:0}function th(t,n,o=1e-6){return Math.abs(t-n)<=o}function lm(t,n){const o=Math.pow(t-n,2)/Math.pow(t+n,2);return Yt*(t+n)*(1+3*o/(10+Math.sqrt(4-3*o)))}function za(t){return t=t%nr,t<0?t=t+nr:t===0&&(t=0),t}function rh(t,n){return t=za(t),n=za(n),t>n&&(n+=nr),n-t}function BE(t,n){return nr-rh(t,n)}function cm(t,n){const o=(n-t)%nr;return 2*o%nr-o}function Ob(t){return(nr+t)%nr}function um(t,n){const o=nr/n;let r=Math.floor((Ob(t)+o/2)/o)*o%nr;return r<Yt&&(r+=nr),r>Yt&&(r-=nr),r}function zE(t,n){return t===n||th(t%(Math.PI/2)-n%(Math.PI/2),0)}function T6(t){return t*Yt/180}function I6(t){return t*180/Yt}function Dl(t,n,o){return new q(t.x,t.y).add(q.FromAngle(o,n))}function Lb(t,n,o){const r=t/2,s=n/2,a=[];let i=1/0,l=-1/0,c=1/0,u=-1/0;for(let y=0;y<o;y++){const g=nr/o,b=-hr+y*g,m=r+r*Math.cos(b),v=s+s*Math.sin(b);m<i&&(i=m),v<c&&(c=v),m>l&&(l=m),v>u&&(u=v),a.push(new q(m,v))}const f=l-i,h=u-c,d=t-f,p=n-h;if(d!==0||p!==0)for(let y=0;y<a.length;y++){const g=a[y];g.x=(g.x-i)/f*t,g.y=(g.y-c)/h*n}return a}function nh(t,n,o,r){return t<r&&o<n}function Fs(t,n,o,r){const s=Math.max(t,o),a=Math.min(n,r);return s<=a?[s,a]:null}function GE(t,n,o){return(n.x-t.x)*(o.y-t.y)-(o.x-t.x)*(n.y-t.y)}function es(t,n){let o=0,r,s;for(let a=0;a<n.length;a++){if(r=n[a],r.x===t.x&&r.y===t.y||(s=n[(a+1)%n.length],q.Dist(t,r)+q.Dist(t,s)===q.Dist(r,s)))return!0;r.y<=t.y?s.y>t.y&&GE(r,s,t)>0&&(o+=1):s.y<=t.y&&GE(r,s,t)<0&&(o-=1)}return o!==0}function ke(t){return Math.round(t*1e4)/1e4}function dm(t){return Math.round(t*100)/100}const VE=t=>Math.abs(t)<Number.MAX_SAFE_INTEGER;function Ga(t,n,o){return o<0?rh(t,n):BE(t,n)}function Rb(t,n,o,r){let s;if(Math.abs(t)>Yt){s=cm(n,r);const a=cm(r,o);return Math.abs(s)<Math.abs(a)?s/t:(t-a)/t}else{s=cm(n,r);const a=s/t;return Math.sign(s)!==Math.sign(t)?Math.abs(a)>.5?1:0:a}}function A6(t,n,o,r){const s=2*((n-t)%nr)%nr-(n-t)%nr;return r?(nr-Math.abs(s))*(o?1:-1):s}const hm=({brush:t,color:n,opacity:o,className:r})=>{const s=z.useRef(null);Qc(s,t.x,t.y);const a=ke(Math.max(1,t.w)),i=ke(Math.max(1,t.h));return E.jsx("svg",{className:"tl-overlays__item",ref:s,children:n?E.jsxs("g",{className:"tl-brush",opacity:o,children:[E.jsx("rect",{width:a,height:i,fill:n,opacity:.75}),E.jsx("rect",{width:a,height:i,fill:"none",stroke:n,opacity:.1})]}):E.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:a,height:i})})},zi=2e3,pm=40,si=320,Zc=[.1,.25,.5,1,2,4,8],oh=.1,Va=8,O6=.5,L6=.1,R6=.2,D6=.005,F6=.05,N6=450,U6=200,Db=36,sh=16,B6=32,Jc={};for(let t=1;t<=Math.ceil(Va);t++)Jc[t+"_dark"]=`hash_pattern_zoom_${t}_dark`,Jc[t+"_light"]=`hash_pattern_zoom_${t}_light`;const z6={duration:0,easing:Kn.easeInOutCubic},fm=.09,HE=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],G6=6e4,WE=3e3,V6=1200,$E={CAMERA_MOVE:-10},H6=64,Gi=8,W6=20,$6=8,q6=12,qE=20,YE=12,Y6=["top","right","bottom","left"],K6=500,KE=.35,X6={},XE=ts("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),jn={logPreventDefaults:ts("logPreventDefaults",{defaults:{all:!1}}),logPointerCaptures:ts("logPointerCaptures",{defaults:{all:!1}}),logElementRemoves:ts("logElementRemoves",{defaults:{all:!1}}),debugSvg:ts("debugSvg",{defaults:{all:!1}}),showFps:ts("showFps",{defaults:{all:!1}}),throwToBlob:ts("throwToBlob",{defaults:{all:!1}}),reconnectOnPing:ts("reconnectOnPing",{defaults:{all:!1}}),debugCursors:ts("debugCursors",{defaults:{all:!1}}),forceSrgb:ts("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:ts("debugGeometry",{defaults:{all:!1}}),hideShapes:ts("hideShapes",{defaults:{all:!1}}),editOnType:ts("editOnType",{defaults:{all:!1}})};if(typeof Element<"u"){const t=Element.prototype.removeChild;Bc("element removal logging",()=>{jn.logElementRemoves.get()?Element.prototype.removeChild=function(n){return console.warn("[tldraw] removing child:",n),t.call(this,n)}:Element.prototype.removeChild=t})}function ts(t,{defaults:n,shouldStoreForSession:o=!0}){return Q6({name:t,defaults:n,shouldStoreForSession:o})}function Q6(t){const n=J6(t),o=t.shouldStoreForSession?Z6(t.name):null,r=fo(`debug:${t.name}`,o??n);return typeof window<"u"&&(t.shouldStoreForSession&&Bc(`debug:${t.name}`,()=>{const s=r.get();s===n?Lk(`tldraw_debug:${t.name}`):yb(`tldraw_debug:${t.name}`,JSON.stringify(s))}),Object.defineProperty(window,`tldraw${t.name.replace(/^[a-z]/,s=>s.toUpperCase())}`,{get(){return r.get()},set(s){r.set(s)},configurable:!0})),Object.assign(r,t)}function Z6(t){try{return JSON.parse(Ok(`tldraw_debug:${t}`)??"null")}catch{return null}}function Fb(t){try{return t()}catch{return null}}function J6(t){switch(Fb(()=>({}).TLDRAW_ENV)??Fb(()=>({}).VERCEL_PUBLIC_TLDRAW_ENV)??Fb(()=>({}).NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return t.defaults.production??t.defaults.all;case"preview":case"staging":return t.defaults.staging??t.defaults.all;default:return t.defaults.development??t.defaults.all}}function mm(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return mm(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Xt(t){t.preventDefault(),jn.logPreventDefaults.get()&&console.warn("preventDefault called on event:",t)}function ih(t,n){if(t.setPointerCapture(n.pointerId),jn.logPointerCaptures.get()){const o=XE.get();o.set(t,(o.get(t)??0)+1),console.warn("setPointerCapture called on element:",t,n)}}function ah(t,n){if(t.hasPointerCapture(n.pointerId)&&(t.releasePointerCapture(n.pointerId),jn.logPointerCaptures.get())){const o=XE.get();o.get(t)===1?o.delete(t):o.has(t)?o.set(t,o.get(t)-1):console.warn("Release without capture"),console.warn("releasePointerCapture called on element:",t,n)}}const On=t=>t.stopPropagation(),Xn=(t,n,o)=>{t&&t.style.setProperty(n,o)};function Lo(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}function e8(){const t=Be();return z.useMemo(function(){let n,o;function r(p){if(!p.isKilled){if(p.button===2){t.dispatch({type:"pointer",target:"canvas",name:"right_click",...Lo(p)});return}p.button!==0&&p.button!==1&&p.button!==5||(ih(p.currentTarget,p),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...Lo(p)}),t.getOpenMenus().length>0&&(t.updateInstanceState({openMenus:[]}),document.body.click(),t.getContainer().focus()))}}function s(p){p.isKilled||p.clientX===n&&p.clientY===o||(n=p.clientX,o=p.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...Lo(p)}))}function a(p){p.isKilled||p.button!==0&&p.button!==1&&p.button!==2&&p.button!==5||(n=p.clientX,o=p.clientY,ah(p.currentTarget,p),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...Lo(p)}))}function i(p){if(p.isKilled||t.getInstanceState().isPenMode&&p.pointerType!=="pen")return;const y=p.pointerType==="mouse"||p.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:y?!0:null})}function l(p){if(p.isKilled||t.getInstanceState().isPenMode&&p.pointerType!=="pen")return;const y=p.pointerType==="mouse"||p.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:y?!1:null})}function c(p){p.isKilled=!0,document.body.click(),Xt(p)}function u(p){p.isKilled=!0,p.target.tagName!=="A"&&p.target.tagName!=="TEXTAREA"&&!(t.getEditingShape()&&p.target.className.includes("tl-text-content"))&&Xt(p)}function f(p){Xt(p)}async function h(p){var g,b;if(Xt(p),!((b=(g=p.dataTransfer)==null?void 0:g.files)!=null&&b.length))return;const y=Array.from(p.dataTransfer.files);await t.putExternalContent({type:"files",files:y,point:t.screenToPage({x:p.clientX,y:p.clientY}),ignoreParent:!1})}function d(p){On(p)}return{onPointerDown:r,onPointerMove:s,onPointerUp:a,onPointerEnter:i,onPointerLeave:l,onDragOver:f,onDrop:h,onTouchStart:c,onTouchEnd:u,onClick:d}},[t])}function t8(){const t=Be();z.useEffect(()=>{if(t.environment.isFirefox&&!t.environment.isAndroid&&!t.environment.isIos){t.updateInstanceState({isCoarsePointer:!1});return}if(window.matchMedia){const n=window.matchMedia("(pointer: coarse)"),o=()=>{t.updateInstanceState({isCoarsePointer:!!n.matches})};if(o(),n)return n.addEventListener("change",o),()=>n.removeEventListener("change",o)}},[t])}const QE=z.createContext(null);function r8({container:t,children:n}){return E.jsx(QE.Provider,{value:t,children:n})}function Qn(){return Ol(z.useContext(QE),"useContainer used outside of <Tldraw />")}function n8(){const t=Be(),n=Qn(),o=We("isFocused",()=>t.getInstanceState().isFocused,[t]);z.useEffect(()=>{if(typeof matchMedia===void 0)return;let r=null;const s=()=>{r==null||r();const a=`(resolution: ${window.devicePixelRatio}dppx)`,i=matchMedia(a),l=c=>{c.type==="change"&&s()};i.addEventListener?i.addEventListener("change",s):i.addListener&&i.addListener(l),r=()=>{i.removeEventListener?i.removeEventListener("change",s):i.removeListener&&i.removeListener(l)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return s(),()=>{r==null||r()}},[t]),z.useEffect(()=>{if(!o)return;const r=l=>{if(l.altKey&&(t.isIn("zoom")||!t.getPath().endsWith(".idle"))&&!gm()&&Xt(l),l.isKilled)return;switch(l.isKilled=!0,l.key){case"=":case"-":case"0":{if(l.metaKey||l.ctrlKey){Xt(l);return}break}case"Tab":{if(gm()||t.getIsMenuOpen())return;break}case",":return;case"Escape":{if((t.getEditingShape()||t.getSelectedShapeIds().length>0)&&l.preventDefault(),t.getOpenMenus().length>0)return;t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),n.focus());return}default:if(gm()||t.getIsMenuOpen())return}const c={type:"keyboard",name:l.repeat?"key_repeat":"key_down",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey};t.dispatch(c)},s=l=>{if(l.isKilled||(l.isKilled=!0,gm()||t.getIsMenuOpen())||l.key===",")return;const c={type:"keyboard",name:"key_up",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey};t.dispatch(c)};function a(l){var c,u;if(n.contains(l.target)){const f=l.touches[0].pageX,h=l.touches[0].radiusX||0;(f-h<10||f+h>t.getViewportScreenBounds().width-10)&&(((c=l.target)==null?void 0:c.tagName)==="BUTTON"&&((u=l.target)==null||u.click()),Xt(l))}}const i=l=>{n.contains(l.target)&&(l.ctrlKey||l.metaKey)&&Xt(l)};return n.addEventListener("touchstart",a,{passive:!1}),n.addEventListener("wheel",i,{passive:!1}),document.addEventListener("gesturestart",Xt),document.addEventListener("gesturechange",Xt),document.addEventListener("gestureend",Xt),n.addEventListener("keydown",r),n.addEventListener("keyup",s),()=>{n.removeEventListener("touchstart",a),n.removeEventListener("wheel",i),document.removeEventListener("gesturestart",Xt),document.removeEventListener("gesturechange",Xt),document.removeEventListener("gestureend",Xt),n.removeEventListener("keydown",r),n.removeEventListener("keyup",s)}},[t,n,o])}const o8=["input","select","button","textarea"];function gm(){const{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||o8.indexOf(t.tagName.toLowerCase())>-1))}const s8=["textarea","input"];function i8(t){const n=Be();z.useEffect(()=>{const o=t.current;if(!o)return;const r=s=>{var a;if(s instanceof PointerEvent&&s.pointerType==="pen"){s.isKilled=!0;const{target:i}=s;if(s8.includes((a=i.tagName)==null?void 0:a.toLocaleLowerCase())||n.isIn("select.editing_shape"))return;Xt(s)}};return o.addEventListener("touchstart",r),o.addEventListener("touchend",r),()=>{o.removeEventListener("touchstart",r),o.removeEventListener("touchend",r)}},[n,t])}function a8(t,n,o){return Math.max(n,Math.min(t,o))}const Ln={toVector(t,n){return t===void 0&&(t=n),Array.isArray(t)?t:[t,t]},add(t,n){return[t[0]+n[0],t[1]+n[1]]},sub(t,n){return[t[0]-n[0],t[1]-n[1]]},addTo(t,n){t[0]+=n[0],t[1]+=n[1]},subTo(t,n){t[0]-=n[0],t[1]-=n[1]}};function ZE(t,n,o){return n===0||Math.abs(n)===1/0?Math.pow(t,o*5):t*n*o/(n+o*t)}function JE(t,n,o,r=.15){return r===0?a8(t,n,o):t<n?-ZE(n-t,o-n,r)+n:t>o?+ZE(t-o,o-n,r)+o:t}function l8(t,[n,o],[r,s]){const[[a,i],[l,c]]=t;return[JE(n,a,i,r),JE(o,l,c,s)]}function c8(t,n){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var r=o.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function u8(t){var n=c8(t,"string");return typeof n=="symbol"?n:String(n)}function Zn(t,n,o){return n=u8(n),n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function eC(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),o.push.apply(o,r)}return o}function Gr(t){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?eC(Object(o),!0).forEach(function(r){Zn(t,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):eC(Object(o)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))})}return t}const tC={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function rC(t){return t?t[0].toUpperCase()+t.slice(1):""}const d8=["enter","leave"];function h8(t=!1,n){return t&&!d8.includes(n)}function p8(t,n="",o=!1){const r=tC[t],s=r&&r[n]||n;return"on"+rC(t)+rC(s)+(h8(o,s)?"Capture":"")}const f8=["gotpointercapture","lostpointercapture"];function m8(t){let n=t.substring(2).toLowerCase();const o=!!~n.indexOf("passive");o&&(n=n.replace("passive",""));const r=f8.includes(n)?"capturecapture":"capture",s=!!~n.indexOf(r);return s&&(n=n.replace("capture","")),{device:n,capture:s,passive:o}}function g8(t,n=""){const o=tC[t],r=o&&o[n]||n;return t+r}function nC(t){return"touches"in t}function y8(t){return nC(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function v8(t){return Array.from(t.touches).filter(n=>{var o,r;return n.target===t.currentTarget||((o=t.currentTarget)===null||o===void 0||(r=o.contains)===null||r===void 0?void 0:r.call(o,n.target))})}function Nb(t,n){try{const o=n.clientX-t.clientX,r=n.clientY-t.clientY,s=(n.clientX+t.clientX)/2,a=(n.clientY+t.clientY)/2,i=Math.hypot(o,r);return{angle:-(Math.atan2(o,r)*180)/Math.PI,distance:i,origin:[s,a]}}catch{}return null}function b8(t){return v8(t).map(n=>n.identifier)}function oC(t,n){const[o,r]=Array.from(t.touches).filter(s=>n.includes(s.identifier));return Nb(o,r)}const sC=40,iC=800;function aC(t){let{deltaX:n,deltaY:o,deltaMode:r}=t;return r===1?(n*=sC,o*=sC):r===2&&(n*=iC,o*=iC),[n,o]}function x8(t){const n={};if("buttons"in t&&(n.buttons=t.buttons),"shiftKey"in t){const{shiftKey:o,altKey:r,metaKey:s,ctrlKey:a}=t;Object.assign(n,{shiftKey:o,altKey:r,metaKey:s,ctrlKey:a})}return n}function ym(t,...n){return typeof t=="function"?t(...n):t}function w8(){}function S8(...t){return t.length===0?w8:t.length===1?t[0]:function(){let n;for(const o of t)n=o.apply(this,arguments)||n;return n}}function lC(t,n){return Object.assign({},n,t||{})}const j8=32;class cC{constructor(n,o,r){this.ctrl=n,this.args=o,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(n){this.ctrl.state[this.key]=n}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:n,shared:o,ingKey:r,args:s}=this;o[r]=n._active=n.active=n._blocked=n._force=!1,n._step=[!1,!1],n.intentional=!1,n._movement=[0,0],n._distance=[0,0],n._direction=[0,0],n._delta=[0,0],n._bounds=[[-1/0,1/0],[-1/0,1/0]],n.args=s,n.axis=void 0,n.memo=void 0,n.elapsedTime=n.timeDelta=0,n.direction=[0,0],n.distance=[0,0],n.overflow=[0,0],n._movementBound=[!1,!1],n.velocity=[0,0],n.movement=[0,0],n.delta=[0,0],n.timeStamp=0}start(n){const o=this.state,r=this.config;o._active||(this.reset(),this.computeInitial(),o._active=!0,o.target=n.target,o.currentTarget=n.currentTarget,o.lastOffset=r.from?ym(r.from,o):o.offset,o.offset=o.lastOffset,o.startTime=o.timeStamp=n.timeStamp)}computeValues(n){const o=this.state;o._values=n,o.values=this.config.transform(n)}computeInitial(){const n=this.state;n._initial=n._values,n.initial=n.values}compute(n){const{state:o,config:r,shared:s}=this;o.args=this.args;let a=0;if(n&&(o.event=n,r.preventDefault&&n.cancelable&&o.event.preventDefault(),o.type=n.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,x8(n)),s.down=s.pressed=s.buttons%2===1||s.touches>0,a=n.timeStamp-o.timeStamp,o.timeStamp=n.timeStamp,o.elapsedTime=o.timeStamp-o.startTime),o._active){const k=o._delta.map(Math.abs);Ln.addTo(o._distance,k)}this.axisIntent&&this.axisIntent(n);const[i,l]=o._movement,[c,u]=r.threshold,{_step:f,values:h}=o;if(r.hasCustomTransform?(f[0]===!1&&(f[0]=Math.abs(i)>=c&&h[0]),f[1]===!1&&(f[1]=Math.abs(l)>=u&&h[1])):(f[0]===!1&&(f[0]=Math.abs(i)>=c&&Math.sign(i)*c),f[1]===!1&&(f[1]=Math.abs(l)>=u&&Math.sign(l)*u)),o.intentional=f[0]!==!1||f[1]!==!1,!o.intentional)return;const d=[0,0];if(r.hasCustomTransform){const[k,_]=h;d[0]=f[0]!==!1?k-f[0]:0,d[1]=f[1]!==!1?_-f[1]:0}else d[0]=f[0]!==!1?i-f[0]:0,d[1]=f[1]!==!1?l-f[1]:0;this.restrictToAxis&&!o._blocked&&this.restrictToAxis(d);const p=o.offset,y=o._active&&!o._blocked||o.active;y&&(o.first=o._active&&!o.active,o.last=!o._active&&o.active,o.active=s[this.ingKey]=o._active,n&&(o.first&&("bounds"in r&&(o._bounds=ym(r.bounds,o)),this.setup&&this.setup()),o.movement=d,this.computeOffset()));const[g,b]=o.offset,[[m,v],[x,w]]=o._bounds;o.overflow=[g<m?-1:g>v?1:0,b<x?-1:b>w?1:0],o._movementBound[0]=o.overflow[0]?o._movementBound[0]===!1?o._movement[0]:o._movementBound[0]:!1,o._movementBound[1]=o.overflow[1]?o._movementBound[1]===!1?o._movement[1]:o._movementBound[1]:!1;const S=o._active?r.rubberband||[0,0]:[0,0];if(o.offset=l8(o._bounds,o.offset,S),o.delta=Ln.sub(o.offset,p),this.computeMovement(),y&&(!o.last||a>j8)){o.delta=Ln.sub(o.offset,p);const k=o.delta.map(Math.abs);Ln.addTo(o.distance,k),o.direction=o.delta.map(Math.sign),o._direction=o._delta.map(Math.sign),!o.first&&a>0&&(o.velocity=[k[0]/a,k[1]/a],o.timeDelta=a)}}emit(){const n=this.state,o=this.shared,r=this.config;if(n._active||this.clean(),(n._blocked||!n.intentional)&&!n._force&&!r.triggerAllEvents)return;const s=this.handler(Gr(Gr(Gr({},o),n),{},{[this.aliasKey]:n.values}));s!==void 0&&(n.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function _8([t,n],o){const r=Math.abs(t),s=Math.abs(n);if(r>s&&r>o)return"x";if(s>r&&s>o)return"y"}class k8 extends cC{constructor(...n){super(...n),Zn(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Ln.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Ln.sub(this.state.offset,this.state.lastOffset)}axisIntent(n){const o=this.state,r=this.config;if(!o.axis&&n){const s=typeof r.axisThreshold=="object"?r.axisThreshold[y8(n)]:r.axisThreshold;o.axis=_8(o._movement,s)}o._blocked=(r.lockDirection||!!r.axis)&&!o.axis||!!r.axis&&r.axis!==o.axis}restrictToAxis(n){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":n[1]=0;break;case"y":n[0]=0;break}}}const E8=t=>t,uC=.15,dC={enabled(t=!0){return t},eventOptions(t,n,o){return Gr(Gr({},o.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[uC,uC];case!1:return[0,0];default:return Ln.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return Ln.toVector(t)},transform(t,n,o){const r=t||o.shared.transform;return this.hasCustomTransform=!!r,r||E8},threshold(t){return Ln.toVector(t,0)}},C8=0,lh=Gr(Gr({},dC),{},{axis(t,n,{axis:o}){if(this.lockDirection=o==="lock",!this.lockDirection)return o},axisThreshold(t=C8){return t},bounds(t={}){if(typeof t=="function")return a=>lh.bounds(t(a));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:n=-1/0,right:o=1/0,top:r=-1/0,bottom:s=1/0}=t;return[[n,o],[r,s]]}}),ch=typeof window<"u"&&window.document&&window.document.createElement;function hC(){return ch&&"ontouchstart"in window}function P8(){return hC()||ch&&window.navigator.maxTouchPoints>1}function M8(){return ch&&"onpointerdown"in window}function T8(){return ch&&"exitPointerLock"in window.document}function I8(){try{return"constructor"in GestureEvent}catch{return!1}}const gs={isBrowser:ch,gesture:I8(),touch:hC(),touchscreen:P8(),pointer:M8(),pointerLock:T8()},A8=250,O8=180,L8=.5,R8=50,D8=250,F8=10,pC={mouse:0,touch:0,pen:8};Gr(Gr({},lh),{},{device(t,n,{pointer:{touch:o=!1,lock:r=!1,mouse:s=!1}={}}){return this.pointerLock=r&&gs.pointerLock,gs.touch&&o?"touch":this.pointerLock?"mouse":gs.pointer&&!s?"pointer":gs.touch?"touch":"mouse"},preventScrollAxis(t,n,{preventScroll:o}){if(this.preventScrollDelay=typeof o=="number"?o:o||o===void 0&&t?A8:void 0,!(!gs.touchscreen||o===!1))return t||(o!==void 0?"y":void 0)},pointerCapture(t,n,{pointer:{capture:o=!0,buttons:r=1,keys:s=!0}={}}){return this.pointerButtons=r,this.keys=s,!this.pointerLock&&this.device==="pointer"&&o},threshold(t,n,{filterTaps:o=!1,tapsThreshold:r=3,axis:s=void 0}){const a=Ln.toVector(t,o?r:s?1:0);return this.filterTaps=o,this.tapsThreshold=r,a},swipe({velocity:t=L8,distance:n=R8,duration:o=D8}={}){return{velocity:this.transform(Ln.toVector(t)),distance:this.transform(Ln.toVector(n)),duration:o}},delay(t=0){switch(t){case!0:return O8;case!1:return 0;default:return t}},axisThreshold(t){return t?Gr(Gr({},pC),t):pC},keyboardDisplacement(t=F8){return t}});function fC(t){const[n,o]=t.overflow,[r,s]=t._delta,[a,i]=t._direction;(n<0&&r>0&&a<0||n>0&&r<0&&a>0)&&(t._movement[0]=t._movementBound[0]),(o<0&&s>0&&i<0||o>0&&s<0&&i>0)&&(t._movement[1]=t._movementBound[1])}const N8=30,U8=100;class B8 extends cC{constructor(...n){super(...n),Zn(this,"ingKey","pinching"),Zn(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const n=this.state;n._touchIds=[],n.canceled=!1,n.cancel=this.cancel.bind(this),n.turns=0}computeOffset(){const{type:n,movement:o,lastOffset:r}=this.state;n==="wheel"?this.state.offset=Ln.add(o,r):this.state.offset=[(1+o[0])*r[0],o[1]+r[1]]}computeMovement(){const{offset:n,lastOffset:o}=this.state;this.state.movement=[n[0]/o[0],n[1]-o[1]]}axisIntent(){const n=this.state,[o,r]=n._movement;if(!n.axis){const s=Math.abs(o)*N8-Math.abs(r);s<0?n.axis="angle":s>0&&(n.axis="scale")}}restrictToAxis(n){this.config.lockDirection&&(this.state.axis==="scale"?n[1]=0:this.state.axis==="angle"&&(n[0]=0))}cancel(){const n=this.state;n.canceled||setTimeout(()=>{n.canceled=!0,n._active=!1,this.compute(),this.emit()},0)}touchStart(n){this.ctrl.setEventIds(n);const o=this.state,r=this.ctrl.touchIds;if(o._active&&o._touchIds.every(a=>r.has(a))||r.size<2)return;this.start(n),o._touchIds=Array.from(r).slice(0,2);const s=oC(n,o._touchIds);s&&this.pinchStart(n,s)}pointerStart(n){if(n.buttons!=null&&n.buttons%2!==1)return;this.ctrl.setEventIds(n),n.target.setPointerCapture(n.pointerId);const o=this.state,r=o._pointerEvents,s=this.ctrl.pointerIds;if(o._active&&Array.from(r.keys()).every(i=>s.has(i))||(r.size<2&&r.set(n.pointerId,n),o._pointerEvents.size<2))return;this.start(n);const a=Nb(...Array.from(r.values()));a&&this.pinchStart(n,a)}pinchStart(n,o){const r=this.state;r.origin=o.origin,this.computeValues([o.distance,o.angle]),this.computeInitial(),this.compute(n),this.emit()}touchMove(n){if(!this.state._active)return;const o=oC(n,this.state._touchIds);o&&this.pinchMove(n,o)}pointerMove(n){const o=this.state._pointerEvents;if(o.has(n.pointerId)&&o.set(n.pointerId,n),!this.state._active)return;const r=Nb(...Array.from(o.values()));r&&this.pinchMove(n,r)}pinchMove(n,o){const r=this.state,s=r._values[1],a=o.angle-s;let i=0;Math.abs(a)>270&&(i+=Math.sign(a)),this.computeValues([o.distance,o.angle-360*i]),r.origin=o.origin,r.turns=i,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(n),this.emit()}touchEnd(n){this.ctrl.setEventIds(n),this.state._active&&this.state._touchIds.some(o=>!this.ctrl.touchIds.has(o))&&(this.state._active=!1,this.compute(n),this.emit())}pointerEnd(n){const o=this.state;this.ctrl.setEventIds(n);try{n.target.releasePointerCapture(n.pointerId)}catch{}o._pointerEvents.has(n.pointerId)&&o._pointerEvents.delete(n.pointerId),o._active&&o._pointerEvents.size<2&&(o._active=!1,this.compute(n),this.emit())}gestureStart(n){n.cancelable&&n.preventDefault();const o=this.state;o._active||(this.start(n),this.computeValues([n.scale,n.rotation]),o.origin=[n.clientX,n.clientY],this.compute(n),this.emit())}gestureMove(n){if(n.cancelable&&n.preventDefault(),!this.state._active)return;const o=this.state;this.computeValues([n.scale,n.rotation]),o.origin=[n.clientX,n.clientY];const r=o._movement;o._movement=[n.scale-1,n.rotation],o._delta=Ln.sub(o._movement,r),this.compute(n),this.emit()}gestureEnd(n){this.state._active&&(this.state._active=!1,this.compute(n),this.emit())}wheel(n){const o=this.config.modifierKey;o&&(Array.isArray(o)?!o.find(r=>n[r]):!n[o])||(this.state._active?this.wheelChange(n):this.wheelStart(n),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(n){this.start(n),this.wheelChange(n)}wheelChange(n){"uv"in n||n.cancelable&&n.preventDefault();const o=this.state;o._delta=[-aC(n)[1]/U8*o.offset[0],0],Ln.addTo(o._movement,o._delta),fC(o),this.state.origin=[n.clientX,n.clientY],this.compute(n),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(n){const o=this.config.device;o&&(n(o,"start",this[o+"Start"].bind(this)),n(o,"change",this[o+"Move"].bind(this)),n(o,"end",this[o+"End"].bind(this)),n(o,"cancel",this[o+"End"].bind(this)),n("lostPointerCapture","",this[o+"End"].bind(this))),this.config.pinchOnWheel&&n("wheel","",this.wheel.bind(this),{passive:!1})}}const z8=Gr(Gr({},dC),{},{device(t,n,{shared:o,pointer:{touch:r=!1}={}}){if(o.target&&!gs.touch&&gs.gesture)return"gesture";if(gs.touch&&r)return"touch";if(gs.touchscreen){if(gs.pointer)return"pointer";if(gs.touch)return"touch"}},bounds(t,n,{scaleBounds:o={},angleBounds:r={}}){const s=i=>{const l=lC(ym(o,i),{min:-1/0,max:1/0});return[l.min,l.max]},a=i=>{const l=lC(ym(r,i),{min:-1/0,max:1/0});return[l.min,l.max]};return typeof o!="function"&&typeof r!="function"?[s(),a()]:i=>[s(i),a(i)]},threshold(t,n,o){return this.lockDirection=o.axis==="lock",Ln.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});Gr(Gr({},lh),{},{mouseOnly:(t=!0)=>t});class G8 extends k8{constructor(...n){super(...n),Zn(this,"ingKey","wheeling")}wheel(n){this.state._active||this.start(n),this.wheelChange(n),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(n){const o=this.state;o._delta=aC(n),Ln.addTo(o._movement,o._delta),fC(o),this.compute(n),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(n){n("wheel","",this.wheel.bind(this))}}const V8=lh;Gr(Gr({},lh),{},{mouseOnly:(t=!0)=>t});const Ub=new Map,Bb=new Map;function H8(t){Ub.set(t.key,t.engine),Bb.set(t.key,t.resolver)}const W8={key:"pinch",engine:B8,resolver:z8},$8={key:"wheel",engine:G8,resolver:V8};function q8(t,n){if(t==null)return{};var o={},r=Object.keys(t),s,a;for(a=0;a<r.length;a++)s=r[a],!(n.indexOf(s)>=0)&&(o[s]=t[s]);return o}function Y8(t,n){if(t==null)return{};var o=q8(t,n),r,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)r=a[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}const K8={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=gs.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:n=!1}={}){return{passive:t,capture:n}},transform(t){return t}},X8=["target","eventOptions","window","enabled","transform"];function vm(t={},n){const o={};for(const[r,s]of Object.entries(n))switch(typeof s){case"function":o[r]=s.call(o,t[r],r,t);break;case"object":o[r]=vm(t[r],s);break;case"boolean":s&&(o[r]=t[r]);break}return o}function Q8(t,n,o={}){const r=t,{target:s,eventOptions:a,window:i,enabled:l,transform:c}=r,u=Y8(r,X8);if(o.shared=vm({target:s,eventOptions:a,window:i,enabled:l,transform:c},K8),n){const f=Bb.get(n);o[n]=vm(Gr({shared:o.shared},u),f)}else for(const f in u){const h=Bb.get(f);h&&(o[f]=vm(Gr({shared:o.shared},u[f]),h))}return o}class mC{constructor(n,o){Zn(this,"_listeners",new Set),this._ctrl=n,this._gestureKey=o}add(n,o,r,s,a){const i=this._listeners,l=g8(o,r),c=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},u=Gr(Gr({},c),a);n.addEventListener(l,s,u);const f=()=>{n.removeEventListener(l,s,u),i.delete(f)};return i.add(f),f}clean(){this._listeners.forEach(n=>n()),this._listeners.clear()}}class Z8{constructor(){Zn(this,"_timeouts",new Map)}add(n,o,r=140,...s){this.remove(n),this._timeouts.set(n,window.setTimeout(o,r,...s))}remove(n){const o=this._timeouts.get(n);o&&window.clearTimeout(o)}clean(){this._timeouts.forEach(n=>void window.clearTimeout(n)),this._timeouts.clear()}}class J8{constructor(n){Zn(this,"gestures",new Set),Zn(this,"_targetEventStore",new mC(this)),Zn(this,"gestureEventStores",{}),Zn(this,"gestureTimeoutStores",{}),Zn(this,"handlers",{}),Zn(this,"config",{}),Zn(this,"pointerIds",new Set),Zn(this,"touchIds",new Set),Zn(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),eF(this,n)}setEventIds(n){if(nC(n))return this.touchIds=new Set(b8(n)),this.touchIds;if("pointerId"in n)return n.type==="pointerup"||n.type==="pointercancel"?this.pointerIds.delete(n.pointerId):n.type==="pointerdown"&&this.pointerIds.add(n.pointerId),this.pointerIds}applyHandlers(n,o){this.handlers=n,this.nativeHandlers=o}applyConfig(n,o){this.config=Q8(n,o,this.config)}clean(){this._targetEventStore.clean();for(const n of this.gestures)this.gestureEventStores[n].clean(),this.gestureTimeoutStores[n].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...n){const o=this.config.shared,r={};let s;if(!(o.target&&(s=o.target(),!s))){if(o.enabled){for(const i of this.gestures){const l=this.config[i],c=gC(r,l.eventOptions,!!s);if(l.enabled){const u=Ub.get(i);new u(this,n,i).bind(c)}}const a=gC(r,o.eventOptions,!!s);for(const i in this.nativeHandlers)a(i,"",l=>this.nativeHandlers[i](Gr(Gr({},this.state.shared),{},{event:l,args:n})),void 0,!0)}for(const a in r)r[a]=S8(...r[a]);if(!s)return r;for(const a in r){const{device:i,capture:l,passive:c}=m8(a);this._targetEventStore.add(s,i,"",r[a],{capture:l,passive:c})}}}}function eu(t,n){t.gestures.add(n),t.gestureEventStores[n]=new mC(t,n),t.gestureTimeoutStores[n]=new Z8}function eF(t,n){n.drag&&eu(t,"drag"),n.wheel&&eu(t,"wheel"),n.scroll&&eu(t,"scroll"),n.move&&eu(t,"move"),n.pinch&&eu(t,"pinch"),n.hover&&eu(t,"hover")}const gC=(t,n,o)=>(r,s,a,i={},l=!1)=>{var c,u;const f=(c=i.capture)!==null&&c!==void 0?c:n.capture,h=(u=i.passive)!==null&&u!==void 0?u:n.passive;let d=l?r:p8(r,s,f);o&&h&&(d+="Passive"),t[d]=t[d]||[],t[d].push(a)},tF=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function rF(t){const n={},o={},r=new Set;for(let s in t)tF.test(s)?(r.add(RegExp.lastMatch),o[s]=t[s]):n[s]=t[s];return[o,n,r]}function tu(t,n,o,r,s,a){if(!t.has(o)||!Ub.has(r))return;const i=o+"Start",l=o+"End",c=u=>{let f;return u.first&&i in n&&n[i](u),o in n&&(f=n[o](u)),u.last&&l in n&&n[l](u),f};s[r]=c,a[r]=a[r]||{}}function nF(t,n){const[o,r,s]=rF(t),a={};return tu(s,o,"onDrag","drag",a,n),tu(s,o,"onWheel","wheel",a,n),tu(s,o,"onScroll","scroll",a,n),tu(s,o,"onPinch","pinch",a,n),tu(s,o,"onMove","move",a,n),tu(s,o,"onHover","hover",a,n),{handlers:a,config:n,nativeHandlers:r}}function oF(t,n={},o,r){const s=Bt.useMemo(()=>new J8(t),[]);if(s.applyHandlers(t,r),s.applyConfig(n,o),Bt.useEffect(s.effect.bind(s)),Bt.useEffect(()=>s.clean.bind(s),[]),n.target===void 0)return s.bind.bind(s)}function sF(t){return t.forEach(H8),function(n,o){const{handlers:r,nativeHandlers:s,config:a}=nF(n,o||{});return oF(r,a,void 0,s)}}const yC=10,iF=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function vC(t){let{deltaY:n,deltaX:o}=t,r=0;if(t.ctrlKey||t.altKey||t.metaKey){const s=Math.sign(t.deltaY),a=Math.abs(t.deltaY);let i=n;a>yC&&(i=yC*s),r=i/100}else t.shiftKey&&!iF&&(o=n,n=0);return{x:-o,y:-n,z:-r}}const aF=sF([$8,W8]);let ru;const lF=t=>ru===void 0?(ru=t,!1):t-ru>120&&t-ru<160?(ru=t,!0):(ru=t,!1);function cF(t){const n=Be(),o=z.useMemo(()=>{let r="not sure";const s=({event:p})=>{var m;if(!n.getInstanceState().isFocused||(r="not sure",lF(Date.now())))return;const y=n.getEditingShapeId();if(y){const v=n.getShape(y);if(v&&n.getShapeUtil(v).canScroll(v)&&((m=n.getShapePageBounds(y))!=null&&m.containsPoint(n.inputs.currentPagePoint)))return}Xt(p),On(p);const g=vC(p);if(g.x===0&&g.y===0)return;const b={type:"wheel",name:"wheel",delta:g,point:new q(p.clientX,p.clientY),shiftKey:p.shiftKey,altKey:p.altKey,ctrlKey:p.metaKey||p.ctrlKey};n.dispatch(b)};let a=1,i=1,l=1,c=0;const u=new q,f=new q,h=p=>{const y=t.current;r="not sure";const{event:g,origin:b,da:m}=p;g instanceof WheelEvent||(g.target===y||y!=null&&y.contains(g.target))&&(f.x=b[0],f.y=b[1],u.x=b[0],u.y=b[1],a=m[0],i=n.getZoomLevel(),n.dispatch({type:"pinch",name:"pinch_start",point:{x:b[0],y:b[1],z:n.getZoomLevel()},delta:{x:0,y:0},shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey}))},d=p=>{if(p&&(r="zooming"),r==="zooming")return;const y=Math.abs(c-a),g=q.Dist(u,f);switch(r){case"not sure":{y>24?r="zooming":g>16&&(r="panning");break}case"panning":{y>64&&(r="zooming");break}}};return{onWheel:s,onPinchStart:h,onPinchEnd:p=>{const y=t.current,{event:g,origin:b,offset:m}=p;if(g instanceof WheelEvent||!(g.target===y||y!=null&&y.contains(g.target)))return;const v=m[0];r="not sure",requestAnimationFrame(()=>{n.dispatch({type:"pinch",name:"pinch_end",point:{x:b[0],y:b[1],z:v},delta:{x:b[0],y:b[1]},shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey})})},onPinch:p=>{const y=t.current,{event:g,origin:b,offset:m,da:v}=p;if(g instanceof WheelEvent||!(g.target===y||y!=null&&y.contains(g.target)))return;const x=p.type==="gesturechange"||p.type==="gestureend";c=v[0];const w=b[0]-f.x,S=b[1]-f.y;switch(f.x=b[0],f.y=b[1],d(x),r){case"zooming":{l=m[0],n.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:l},delta:{x:w,y:S},shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey});break}case"panning":{n.dispatch({type:"pinch",name:"pinch",point:{x:b[0],y:b[1],z:i},delta:{x:w,y:S},shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey});break}}}}},[n,t]);aF(o,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[n.getZoomLevel(),0],scaleBounds:()=>({from:n.getZoomLevel(),max:8,min:.05})}})}function zb(t,n,o){const r=t.getShape(n),s=t.getShapeHandles(r);return{shape:r,handle:s.find(a=>a.id===o)}}function uF(t,n){const o=Be();return z.useMemo(()=>{const r=i=>{if(i.isKilled)return;const l=mm(i.currentTarget);ih(l,i);const{shape:c,handle:u}=zb(o,t,n);u&&o.dispatch({type:"pointer",target:"handle",handle:u,shape:c,name:"pointer_down",...Lo(i)})};let s,a;return{onPointerDown:r,onPointerMove:i=>{if(i.isKilled||i.clientX===s&&i.clientY===a)return;s=i.clientX,a=i.clientY;const{shape:l,handle:c}=zb(o,t,n);c&&o.dispatch({type:"pointer",target:"handle",handle:c,shape:l,name:"pointer_move",...Lo(i)})},onPointerUp:i=>{if(i.isKilled)return;const l=mm(i.currentTarget);ah(l,i);const{shape:c,handle:u}=zb(o,t,n);u&&o.dispatch({type:"pointer",target:"handle",handle:u,shape:c,name:"pointer_up",...Lo(i)})}}},[o,t,n])}var bC="Expected a function",xC=0/0,dF="[object Symbol]",hF=/^\s+|\s+$/g,pF=/^[-+]0x[0-9a-f]+$/i,fF=/^0b[01]+$/i,mF=/^0o[0-7]+$/i,gF=parseInt,yF=typeof cn=="object"&&cn&&cn.Object===Object&&cn,vF=typeof self=="object"&&self&&self.Object===Object&&self,bF=yF||vF||Function("return this")(),xF=Object.prototype,wF=xF.toString,SF=Math.max,jF=Math.min,Gb=function(){return bF.Date.now()};function _F(t,n,o){var r,s,a,i,l,c,u=0,f=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(bC);n=wC(n)||0,bm(o)&&(f=!!o.leading,h="maxWait"in o,a=h?SF(wC(o.maxWait)||0,n):a,d="trailing"in o?!!o.trailing:d);function p(k){var _=r,C=s;return r=s=void 0,u=k,i=t.apply(C,_),i}function y(k){return u=k,l=setTimeout(m,n),f?p(k):i}function g(k){var _=k-c,C=k-u,P=n-_;return h?jF(P,a-C):P}function b(k){var _=k-c,C=k-u;return c===void 0||_>=n||_<0||h&&C>=a}function m(){var k=Gb();if(b(k))return v(k);l=setTimeout(m,g(k))}function v(k){return l=void 0,d&&r?p(k):(r=s=void 0,i)}function x(){l!==void 0&&clearTimeout(l),u=0,r=c=s=l=void 0}function w(){return l===void 0?i:v(Gb())}function S(){var k=Gb(),_=b(k);if(r=arguments,s=this,c=k,_){if(l===void 0)return y(c);if(h)return l=setTimeout(m,n),p(c)}return l===void 0&&(l=setTimeout(m,n)),i}return S.cancel=x,S.flush=w,S}function kF(t,n,o){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(bC);return bm(o)&&(r="leading"in o?!!o.leading:r,s="trailing"in o?!!o.trailing:s),_F(t,n,{leading:r,maxWait:n,trailing:s})}function bm(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}function EF(t){return!!t&&typeof t=="object"}function CF(t){return typeof t=="symbol"||EF(t)&&wF.call(t)==dF}function wC(t){if(typeof t=="number")return t;if(CF(t))return xC;if(bm(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=bm(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=t.replace(hF,"");var o=fF.test(t);return o||mF.test(t)?gF(t.slice(2),o?2:8):pF.test(t)?xC:+t}var PF=kF;const MF=ml(PF),Ar=class Ar{constructor(n=0,o=0,r=0,s=0){R(this,"x",0);R(this,"y",0);R(this,"w",0);R(this,"h",0);this.x=n,this.y=o,this.w=r,this.h=s}get point(){return new q(this.x,this.y)}set point(n){this.x=n.x,this.y=n.y}get minX(){return this.x}set minX(n){this.x=n}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(n){this.y=n}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(n){this.w=n}get height(){return this.h}set height(n){this.h=n}get aspectRatio(){return this.width/this.height}get center(){return new q(this.midX,this.midY)}set center(n){this.minX=n.x-this.width/2,this.minY=n.y-this.height/2}get corners(){return[new q(this.minX,this.minY),new q(this.maxX,this.minY),new q(this.maxX,this.maxY),new q(this.minX,this.maxY)]}get cornersAndCenter(){return[new q(this.minX,this.minY),new q(this.maxX,this.minY),new q(this.maxX,this.maxY),new q(this.minX,this.maxY),this.center]}get sides(){const{corners:n}=this;return[[n[0],n[1]],[n[1],n[2]],[n[2],n[3]],[n[3],n[0]]]}get size(){return new q(this.w,this.h)}toFixed(){return this.x=am(this.x),this.y=am(this.y),this.w=am(this.w),this.h=am(this.h),this}setTo(n){return this.x=n.x,this.y=n.y,this.w=n.w,this.h=n.h,this}set(n=0,o=0,r=0,s=0){return this.x=n,this.y=o,this.w=r,this.h=s,this}expand(n){const o=Math.min(this.minX,n.minX),r=Math.min(this.minY,n.minY),s=Math.max(this.maxX,n.maxX),a=Math.max(this.maxY,n.maxY);return this.x=o,this.y=r,this.w=s-o,this.h=a-r,this}expandBy(n){return this.x-=n,this.y-=n,this.w+=n*2,this.h+=n*2,this}scale(n){return this.x/=n,this.y/=n,this.w/=n,this.h/=n,this}clone(){const{x:n,y:o,w:r,h:s}=this;return new Ar(n,o,r,s)}translate(n){return this.x+=n.x,this.y+=n.y,this}snapToGrid(n){const o=Math.round(this.minX/n)*n,r=Math.round(this.minY/n)*n,s=Math.round(this.maxX/n)*n,a=Math.round(this.maxY/n)*n;this.minX=o,this.minY=r,this.width=Math.max(1,s-o),this.height=Math.max(1,a-r)}collides(n){return Ar.Collides(this,n)}contains(n){return Ar.Contains(this,n)}includes(n){return Ar.Includes(this,n)}containsPoint(n,o=0){return Ar.ContainsPoint(this,n,o)}getHandlePoint(n){switch(n){case"top_left":return new q(this.minX,this.minY);case"top_right":return new q(this.maxX,this.minY);case"bottom_left":return new q(this.minX,this.maxY);case"bottom_right":return new q(this.maxX,this.maxY);case"top":return new q(this.midX,this.minY);case"right":return new q(this.maxX,this.midY);case"bottom":return new q(this.midX,this.maxY);case"left":return new q(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(n,o,r){const{minX:s,minY:a,maxX:i,maxY:l}=this;let{minX:c,minY:u,maxX:f,maxY:h}=this;switch(n){case"left":case"top_left":case"bottom_left":{c+=o;break}case"right":case"top_right":case"bottom_right":{f+=o;break}}switch(n){case"top":case"top_left":case"top_right":{u+=r;break}case"bottom":case"bottom_left":case"bottom_right":{h+=r;break}}const d=(f-c)/(i-s),p=(h-u)/(l-a),y=d<0,g=p<0;if(y){const b=f;f=c,c=b}if(g){const b=h;h=u,u=b}this.minX=c,this.minY=u,this.width=Math.abs(f-c),this.height=Math.abs(h-u)}union(n){const o=Math.min(this.minX,n.x),r=Math.min(this.minY,n.y),s=Math.max(this.maxX,n.w+n.x),a=Math.max(this.maxY,n.h+n.y);return this.x=o,this.y=r,this.width=s-o,this.height=a-r,this}static From(n){return new Ar(n.x,n.y,n.w,n.h)}static FromCenter(n,o){return new Ar(n.x-o.x/2,n.y-o.y/2,o.x,o.y)}static FromPoints(n){if(n.length===0)return new Ar;let o=1/0,r=1/0,s=-1/0,a=-1/0,i;for(let l=0,c=n.length;l<c;l++)i=n[l],o=Math.min(i.x,o),r=Math.min(i.y,r),s=Math.max(i.x,s),a=Math.max(i.y,a);return new Ar(o,r,s-o,a-r)}static Expand(n,o){const r=Math.min(o.minX,n.minX),s=Math.min(o.minY,n.minY),a=Math.max(o.maxX,n.maxX),i=Math.max(o.maxY,n.maxY);return new Ar(r,s,a-r,i-s)}static ExpandBy(n,o){return new Ar(n.minX-o,n.minY-o,n.width+o*2,n.height+o*2)}static Resize(n,o,r,s,a=!1){const{minX:i,minY:l,maxX:c,maxY:u}=n;let{minX:f,minY:h,maxX:d,maxY:p}=n;switch(o){case"left":case"top_left":case"bottom_left":{f+=r;break}case"right":case"top_right":case"bottom_right":{d+=r;break}}switch(o){case"top":case"top_left":case"top_right":{h+=s;break}case"bottom":case"bottom_left":case"bottom_right":{p+=s;break}}const y=(d-f)/(c-i),g=(p-h)/(u-l),b=y<0,m=g<0;if(a){const x=(c-i)/(u-l),w=Math.abs(d-f),S=Math.abs(p-h),k=w*(g<0?1:-1)*(1/x),_=S*(y<0?1:-1)*x,C=x<w/S;switch(o){case"top_left":{C?h=p+k:f=d+_;break}case"top_right":{C?h=p+k:d=f-_;break}case"bottom_right":{C?p=h-k:d=f-_;break}case"bottom_left":{C?p=h-k:f=d+_;break}case"bottom":case"top":{const P=(f+d)/2,A=S*x;f=P-A/2,d=P+A/2;break}case"left":case"right":{const P=(h+p)/2,A=w/x;h=P-A/2,p=P+A/2;break}}}if(b){const x=d;d=f,f=x}if(m){const x=p;p=h,h=x}const v=new Ar(f,h,Math.abs(d-f),Math.abs(p-h));return{box:v,scaleX:+(v.width/n.width*(y>0?1:-1)).toFixed(5),scaleY:+(v.height/n.height*(g>0?1:-1)).toFixed(5)}}equals(n){return Ar.Equals(this,n)}static Equals(n,o){return o.x===n.x&&o.y===n.y&&o.w===n.w&&o.h===n.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(n){return new Ar(n.x,n.y,Math.max(1,n.w),Math.max(1,n.h))}};R(Ar,"Collides",(n,o)=>!(n.maxX<o.minX||n.minX>o.maxX||n.maxY<o.minY||n.minY>o.maxY)),R(Ar,"Contains",(n,o)=>n.minX<o.minX&&n.minY<o.minY&&n.maxY>o.maxY&&n.maxX>o.maxX),R(Ar,"Includes",(n,o)=>Ar.Collides(n,o)||Ar.Contains(n,o)),R(Ar,"ContainsPoint",(n,o,r=0)=>!(o.x<n.minX-r||o.y<n.minY-r||o.x>n.maxX+r||o.y>n.maxY+r)),R(Ar,"Common",n=>{let o=1/0,r=1/0,s=-1/0,a=-1/0;for(let i=0;i<n.length;i++){const l=n[i];o=Math.min(o,l.minX),r=Math.min(r,l.minY),s=Math.max(s,l.maxX),a=Math.max(a,l.maxY)}return new Ar(o,r,s-o,a-r)}),R(Ar,"Sides",(n,o=0)=>{const{corners:r}=n;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let mt=Ar;function TF(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function IF(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}function AF(t){return t==="top_left"||t==="top_right"||t==="bottom_right"||t==="bottom_left"}function OF(t){const n=Be();z.useLayoutEffect(()=>{let o=new mt;function r(){const u=t.current;if(!u)return null;const f=u.getBoundingClientRect(),h=new mt(f.left||f.x,f.top||f.y,Math.max(f.width,1),Math.max(f.height,1));o.equals(h)||(n.updateViewportScreenBounds(h),o=h)}r();const s=MF(r,200,{trailing:!0}),a=setInterval(s,1e3);window.addEventListener("resize",s);const i=new ResizeObserver(u=>{u[0].contentRect&&s()}),l=t.current;let c=null;return l&&(i.observe(l),c=LF(l),c.addEventListener("scroll",s)),()=>{clearInterval(a),window.removeEventListener("resize",s),i.disconnect(),c==null||c.removeEventListener("scroll",s)}},[n,t])}/*!
* Author: excalidraw
* MIT License: https://github.com/excalidraw/excalidraw/blob/master/LICENSE
* https://github.com/excalidraw/excalidraw/blob/48c3465b19f10ec755b3eb84e21a01a468e96e43/packages/excalidraw/utils.ts#L600
*/const LF=t=>{let n=t.parentElement;for(;n;){if(n===document.body)return document;const{overflowY:o}=window.getComputedStyle(n);if(n.scrollHeight>n.clientHeight&&(o==="auto"||o==="scroll"||o==="overlay"))return n;n=n.parentElement}return document},sr=class sr{constructor(n,o,r,s,a,i){R(this,"a",1);R(this,"b",0);R(this,"c",0);R(this,"d",1);R(this,"e",0);R(this,"f",0);this.a=n,this.b=o,this.c=r,this.d=s,this.e=a,this.f=i}equals(n){return this===n||this.a===n.a&&this.b===n.b&&this.c===n.c&&this.d===n.d&&this.e===n.e&&this.f===n.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(n){const o=n,{a:r,b:s,c:a,d:i,e:l,f:c}=this;return this.a=r*o.a+a*o.b,this.c=r*o.c+a*o.d,this.e=r*o.e+a*o.f+l,this.b=s*o.a+i*o.b,this.d=s*o.c+i*o.d,this.f=s*o.e+i*o.f+c,this}rotate(n,o,r){return n===0?this:o===void 0?this.multiply(sr.Rotate(n)):this.translate(o,r).multiply(sr.Rotate(n)).translate(-o,-r)}translate(n,o){return this.multiply(sr.Translate(n,o))}scale(n,o){return this.multiply(sr.Scale(n,o))}invert(){const{a:n,b:o,c:r,d:s,e:a,f:i}=this,l=n*s-o*r;return this.a=s/l,this.b=o/-l,this.c=r/-l,this.d=n/l,this.e=(s*a-r*i)/-l,this.f=(o*a-n*i)/l,this}applyToPoint(n){return sr.applyToPoint(this,n)}applyToPoints(n){return sr.applyToPoints(this,n)}rotation(){return sr.Rotation(this)}point(){return sr.Point(this)}decomposed(){return sr.Decompose(this)}toCssString(){return sr.toCssString(this)}setTo(n){return Object.assign(this,n),this}decompose(){return sr.Decompose(this)}clone(){return new sr(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new sr(1,0,0,1,0,0)}static Translate(n,o){return new sr(1,0,0,1,n,o)}static Rotate(n,o,r){if(n===0)return sr.Identity();const s=Math.cos(n),a=Math.sin(n),i=new sr(s,a,-a,s,0,0);return o===void 0?i:sr.Compose(sr.Translate(o,r),i,sr.Translate(-o,-r))}static Multiply(n,o){return{a:n.a*o.a+n.c*o.b,c:n.a*o.c+n.c*o.d,e:n.a*o.e+n.c*o.f+n.e,b:n.b*o.a+n.d*o.b,d:n.b*o.c+n.d*o.d,f:n.b*o.e+n.d*o.f+n.f}}static Inverse(n){const o=n.a*n.d-n.b*n.c;return{a:n.d/o,b:n.b/-o,c:n.c/-o,d:n.a/o,e:(n.d*n.e-n.c*n.f)/-o,f:(n.b*n.e-n.a*n.f)/o}}static Absolute(n){const o=n.a*n.d-n.b*n.c;return{a:n.d/o,b:n.b/-o,c:n.c/-o,d:n.a/o,e:(n.d*n.e-n.c*n.f)/o,f:(n.b*n.e-n.a*n.f)/-o}}static Compose(...n){const o=sr.Identity();for(let r=0,s=n.length;r<s;r++)o.multiply(n[r]);return o}static Point(n){return new q(n.e,n.f)}static Rotation(n){let o;if(n.a!==0||n.c!==0){const r=(n.a*n.a+n.c*n.c)**.5;o=Math.acos(n.a/r)*(n.c>0?-1:1)}else if(n.b!==0||n.d!==0){const r=(n.b*n.b+n.d*n.d)**.5;o=hr+Math.acos(n.b/r)*(n.d>0?-1:1)}else o=0;return Ob(o)}static Decompose(n){let o,r,s;if(n.a!==0||n.c!==0){const a=(n.a*n.a+n.c*n.c)**.5;o=a,r=(n.a*n.d-n.b*n.c)/a,s=Math.acos(n.a/a)*(n.c>0?-1:1)}else if(n.b!==0||n.d!==0){const a=(n.b*n.b+n.d*n.d)**.5;o=(n.a*n.d-n.b*n.c)/a,r=a,s=hr+Math.acos(n.b/a)*(n.d>0?-1:1)}else o=0,r=0,s=0;return{x:n.e,y:n.f,scaleX:o,scaleY:r,rotation:Ob(s)}}static Smooth(n,o=1e10){return n.a=Math.round(n.a*o)/o,n.b=Math.round(n.b*o)/o,n.c=Math.round(n.c*o)/o,n.d=Math.round(n.d*o)/o,n.e=Math.round(n.e*o)/o,n.f=Math.round(n.f*o)/o,n}static toCssString(n){return`matrix(${ke(n.a)}, ${ke(n.b)}, ${ke(n.c)}, ${ke(n.d)}, ${ke(n.e)}, ${ke(n.f)})`}static applyToPoint(n,o){return new q(n.a*o.x+n.c*o.y+n.e,n.b*o.x+n.d*o.y+n.f,o.z)}static applyToXY(n,o,r){return[n.a*o+n.c*r+n.e,n.b*o+n.d*r+n.f]}static applyToPoints(n,o){return o.map(r=>new q(n.a*r.x+n.c*r.y+n.e,n.b*r.x+n.d*r.y+n.f,r.z))}static applyToBounds(n,o){return new mt(n.e+o.minX,n.f+o.minY,o.width,o.height)}static From(n){return new sr(n.a,n.b,n.c,n.d,n.e,n.f)}static Cast(n){return n instanceof sr?n:sr.From(n)}};R(sr,"Scale",(n,o,r,s)=>{const a=new sr(n,0,0,o,0,0);return r===void 0?a:sr.Compose(sr.Translate(r,s),a,sr.Translate(-r,-s))});let vt=sr;function SC(t,n){return n===0?t:SC(n,t%n)}function jC(t){const n=t.toString().split(".")[1];if(!n)return 1;const o=Math.pow(10,n.length),r=parseInt(n,10);return o/SC(r,o)}class Fl{constructor(n){R(this,"isFilled",!1);R(this,"isClosed",!0);R(this,"isLabel",!1);R(this,"debugColor");R(this,"ignore");R(this,"_vertices");R(this,"_bounds");R(this,"_area");this.isFilled=n.isFilled,this.isClosed=n.isClosed,this.isLabel=n.isLabel??!1,this.debugColor=n.debugColor,this.ignore=n.ignore}hitTestPoint(n,o=0,r=!1){return this.isClosed&&(this.isFilled||r)&&es(n,this.vertices)?!0:q.Dist2(n,this.nearestPoint(n))<=o*o}distanceToPoint(n,o=!1){return n.dist(this.nearestPoint(n))*(this.isClosed&&(this.isFilled||o)&&es(n,this.vertices)?-1:1)}distanceToLineSegment(n,o){if(n.equals(o))return this.distanceToPoint(n);const{vertices:r}=this;let s,a=1/0,i,l,c;for(let u=0;u<r.length;u++)l=r[u],c=q.NearestPointOnLineSegment(n,o,l,!0),i=q.Dist2(l,c),i<a&&(a=i,s=c);if(!s)throw Error("nearest point not found");return this.isClosed&&this.isFilled&&es(s,this.vertices)?-a:a}hitTestLineSegment(n,o,r=0){return this.distanceToLineSegment(n,o)<=r}nearestPointOnLineSegment(n,o){const{vertices:r}=this;let s,a=1/0,i,l,c;for(let u=0;u<r.length;u++)l=r[u],c=q.NearestPointOnLineSegment(n,o,l,!0),i=q.Dist2(l,c),i<a&&(a=i,s=c);if(!s)throw Error("nearest point not found");return s}isPointInBounds(n,o=0){const{bounds:r}=this;return!(n.x<r.minX-o||n.y<r.minY-o||n.x>r.maxX+o||n.y>r.maxY+o)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return mt.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:n}=this;let o=0;for(let r=0,s=n.length;r<s;r++){const a=n[r],i=n[(r+1)%s];o+=a.x*i.y-i.x*a.y}return o/2}toSimpleSvgPath(){let n="";const{vertices:o}=this,r=o.length;if(r===0)return n;n+=`M${o[0].x},${o[0].y}`;for(let s=1;s<r;s++)n+=`L${o[s].x},${o[s].y}`;return this.isClosed&&(n+="Z"),n}}class Ns extends Fl{constructor(o){super({...o,isClosed:!0,isFilled:!1});R(this,"children",[]);R(this,"ignoredChildren",[]);for(const r of o.children)r.ignore?this.ignoredChildren.push(r):this.children.push(r);if(this.children.length===0)throw Error("Group2d must have at least one child")}getVertices(){return this.children.filter(o=>!o.isLabel).flatMap(o=>o.vertices)}nearestPoint(o){let r=1/0,s;const{children:a}=this;if(a.length===0)throw Error("no children");let i,l;for(const c of a)i=c.nearestPoint(o),l=q.Dist2(i,o),l<r&&(r=l,s=i);if(!s)throw Error("nearest point not found");return s}distanceToPoint(o,r=!1){return Math.min(...this.children.map((s,a)=>s.distanceToPoint(o,r||a>0)))}hitTestPoint(o,r,s){return!!this.children.filter(a=>!a.isLabel).find(a=>a.hitTestPoint(o,r,s))}hitTestLineSegment(o,r,s){return!!this.children.filter(a=>!a.isLabel).find(a=>a.hitTestLineSegment(o,r,s))}getArea(){return this.children[0].area}toSimpleSvgPath(){let o="";for(const s of this.children)o+=s.toSimpleSvgPath();const r=mt.FromPoints(this.vertices).corners;for(let s=0,a=r.length;s<a;s++){const i=r[s],l=r[(s-1+a)%a],c=i.dist(l),u=r[(s+1)%a],f=i.dist(u),h=i.clone().lrp(l,4/c),d=i,p=i.clone().lrp(u,4/f);o+=`M${h.x},${h.y} L${d.x},${d.y} L${p.x},${p.y} `}return o}}function RF(t=!0){const[n,o]=z.useState(0),r=Be();z.useEffect(()=>{if(!t)return;const s=()=>o(a=>a+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const DF=qo(function({showStroke:t=!0,showVertices:n=!0,showClosestPointOnOutline:o=!0}){const r=Be();RF(o);const s=r.getZoomLevel(),a=r.getRenderingShapes(),{inputs:{currentPagePoint:i}}=r;return E.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:a.map(l=>{const c=r.getShape(l.id);if(c.type==="group")return null;const u=r.getShapeGeometry(c),f=r.getShapePageTransform(c),h=r.getPointInShapeSpace(c,i),d=u.nearestPoint(h),p=u.distanceToPoint(h,!0),y=Math.abs(p)*s,g=p<0,{vertices:b}=u;return E.jsxs("g",{transform:f.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[t&&E.jsx(_C,{geometry:u}),n&&b.map((m,v)=>E.jsx("circle",{cx:m.x,cy:m.y,r:"2",fill:`hsl(${Nf(v,[0,b.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${v}`)),o&&y<150&&E.jsx("line",{x1:d.x,y1:d.y,x2:h.x,y2:h.y,opacity:1-y/150,stroke:g?"goldenrod":"dodgerblue",strokeWidth:"2"})]},l.id+"_outline")})})});function _C({geometry:t}){return t instanceof Ns?E.jsx(E.Fragment,{children:[...t.children,...t.ignoredChildren].map((n,o)=>E.jsx(_C,{geometry:n},o))}):E.jsx("path",{stroke:t.debugColor??"red",strokeWidth:"2",fill:"none",opacity:"1",d:t.toSimpleSvgPath()})}var FF=200,Vb="__lodash_hash_undefined__",NF=1/0,UF="[object Function]",BF="[object GeneratorFunction]",zF=/[\\^$.*+?()[\]{}|]/g,GF=/^\[object .+?Constructor\]$/,VF=typeof cn=="object"&&cn&&cn.Object===Object&&cn,HF=typeof self=="object"&&self&&self.Object===Object&&self,Hb=VF||HF||Function("return this")();function WF(t,n){var o=t?t.length:0;return!!o&&YF(t,n,0)>-1}function $F(t,n,o){for(var r=-1,s=t?t.length:0;++r<s;)if(o(n,t[r]))return!0;return!1}function qF(t,n,o,r){for(var s=t.length,a=o+(r?1:-1);r?a--:++a<s;)if(n(t[a],a,t))return a;return-1}function YF(t,n,o){if(n!==n)return qF(t,KF,o);for(var r=o-1,s=t.length;++r<s;)if(t[r]===n)return r;return-1}function KF(t){return t!==t}function XF(t,n){return t.has(n)}function QF(t,n){return t==null?void 0:t[n]}function ZF(t){var n=!1;if(t!=null&&typeof t.toString!="function")try{n=!!(t+"")}catch{}return n}function kC(t){var n=-1,o=Array(t.size);return t.forEach(function(r){o[++n]=r}),o}var JF=Array.prototype,eN=Function.prototype,EC=Object.prototype,Wb=Hb["__core-js_shared__"],CC=function(){var t=/[^.]+$/.exec(Wb&&Wb.keys&&Wb.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),PC=eN.toString,$b=EC.hasOwnProperty,tN=EC.toString,rN=RegExp("^"+PC.call($b).replace(zF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nN=JF.splice,oN=Yb(Hb,"Map"),qb=Yb(Hb,"Set"),uh=Yb(Object,"create");function Nl(t){var n=-1,o=t?t.length:0;for(this.clear();++n<o;){var r=t[n];this.set(r[0],r[1])}}function sN(){this.__data__=uh?uh(null):{}}function iN(t){return this.has(t)&&delete this.__data__[t]}function aN(t){var n=this.__data__;if(uh){var o=n[t];return o===Vb?void 0:o}return $b.call(n,t)?n[t]:void 0}function lN(t){var n=this.__data__;return uh?n[t]!==void 0:$b.call(n,t)}function cN(t,n){var o=this.__data__;return o[t]=uh&&n===void 0?Vb:n,this}Nl.prototype.clear=sN,Nl.prototype.delete=iN,Nl.prototype.get=aN,Nl.prototype.has=lN,Nl.prototype.set=cN;function nu(t){var n=-1,o=t?t.length:0;for(this.clear();++n<o;){var r=t[n];this.set(r[0],r[1])}}function uN(){this.__data__=[]}function dN(t){var n=this.__data__,o=wm(n,t);if(o<0)return!1;var r=n.length-1;return o==r?n.pop():nN.call(n,o,1),!0}function hN(t){var n=this.__data__,o=wm(n,t);return o<0?void 0:n[o][1]}function pN(t){return wm(this.__data__,t)>-1}function fN(t,n){var o=this.__data__,r=wm(o,t);return r<0?o.push([t,n]):o[r][1]=n,this}nu.prototype.clear=uN,nu.prototype.delete=dN,nu.prototype.get=hN,nu.prototype.has=pN,nu.prototype.set=fN;function ou(t){var n=-1,o=t?t.length:0;for(this.clear();++n<o;){var r=t[n];this.set(r[0],r[1])}}function mN(){this.__data__={hash:new Nl,map:new(oN||nu),string:new Nl}}function gN(t){return Sm(this,t).delete(t)}function yN(t){return Sm(this,t).get(t)}function vN(t){return Sm(this,t).has(t)}function bN(t,n){return Sm(this,t).set(t,n),this}ou.prototype.clear=mN,ou.prototype.delete=gN,ou.prototype.get=yN,ou.prototype.has=vN,ou.prototype.set=bN;function xm(t){var n=-1,o=t?t.length:0;for(this.__data__=new ou;++n<o;)this.add(t[n])}function xN(t){return this.__data__.set(t,Vb),this}function wN(t){return this.__data__.has(t)}xm.prototype.add=xm.prototype.push=xN,xm.prototype.has=wN;function wm(t,n){for(var o=t.length;o--;)if(MN(t[o][0],n))return o;return-1}function SN(t){if(!MC(t)||EN(t))return!1;var n=TN(t)||ZF(t)?rN:GF;return n.test(CN(t))}function jN(t,n,o){var r=-1,s=WF,a=t.length,i=!0,l=[],c=l;if(o)i=!1,s=$F;else if(a>=FF){var u=n?null:_N(t);if(u)return kC(u);i=!1,s=XF,c=new xm}else c=n?[]:l;e:for(;++r<a;){var f=t[r],h=n?n(f):f;if(f=o||f!==0?f:0,i&&h===h){for(var d=c.length;d--;)if(c[d]===h)continue e;n&&c.push(h),l.push(f)}else s(c,h,o)||(c!==l&&c.push(h),l.push(f))}return l}var _N=qb&&1/kC(new qb([,-0]))[1]==NF?function(t){return new qb(t)}:IN;function Sm(t,n){var o=t.__data__;return kN(n)?o[typeof n=="string"?"string":"hash"]:o.map}function Yb(t,n){var o=QF(t,n);return SN(o)?o:void 0}function kN(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function EN(t){return!!CC&&CC in t}function CN(t){if(t!=null){try{return PC.call(t)}catch{}try{return t+""}catch{}}return""}function PN(t){return t&&t.length?jN(t):[]}function MN(t,n){return t===n||t!==t&&n!==n}function TN(t){var n=MC(t)?tN.call(t):"";return n==UF||n==BF}function MC(t){var n=typeof t;return!!t&&(n=="object"||n=="function")}function IN(){}var AN=PN;const ON=ml(AN);function TC(t){return ON(t)}function LN(){const t=Be(),n=zR("userIds",()=>TC(t.getCollaborators().map(o=>o.userId)).sort(),{isEqual:(o,r)=>{var s;return o.join(",")===((s=r.join)==null?void 0:s.call(r,","))}},[t]);return We(n)}function IC(t){const n=Be();return We(`latestPresence:${t}`,()=>n.getCollaborators().find(o=>o.userId===t),[n])??null}const RN=qo(function(){const t=LN();return E.jsx(E.Fragment,{children:t.map(n=>E.jsx(DN,{collaboratorId:n},n))})}),DN=qo(function({collaboratorId:t}){const n=Be(),o=IC(t),r=NN(o);if(!(o&&o.currentPageId===n.getCurrentPageId()))return null;switch(r){case"inactive":{const{followingUserId:s,highlightedUserIds:a}=n.getInstanceState();if(!(s===o.userId||a.includes(o.userId)))return null;break}case"idle":{const{highlightedUserIds:s}=n.getInstanceState();if(o.followingUserId===n.user.getId()&&!(o.chatMessage||s.includes(o.userId)))return null;break}}return E.jsx(FN,{latestPresence:o})}),FN=qo(function({latestPresence:t}){const n=Be(),{CollaboratorBrush:o,CollaboratorScribble:r,CollaboratorCursor:s,CollaboratorHint:a,CollaboratorShapeIndicator:i}=Vr(),l=n.getZoomLevel(),c=n.getViewportPageBounds(),{userId:u,chatMessage:f,brush:h,scribbles:d,selectedShapeIds:p,userName:y,cursor:g,color:b}=t,m=!(g.x<c.minX-12/l||g.y<c.minY-16/l||g.x>c.maxX-12/l||g.y>c.maxY-16/l);return E.jsxs(E.Fragment,{children:[h&&o?E.jsx(o,{className:"tl-collaborator__brush",brush:h,color:b,opacity:.1},u+"_brush"):null,m&&s?E.jsx(s,{className:"tl-collaborator__cursor",point:g,color:b,zoom:l,name:y!=="New User"?y:null,chatMessage:f},u+"_cursor"):a?E.jsx(a,{className:"tl-collaborator__cursor-hint",point:g,color:b,zoom:l,viewport:c},u+"_cursor_hint"):null,r&&d.length?E.jsx(E.Fragment,{children:d.map(v=>E.jsx(r,{className:"tl-collaborator__scribble",scribble:v,color:b,zoom:l,opacity:v.color==="laser"?.5:.1},u+"_scribble_"+v.id))}):null,i&&p.map(v=>E.jsx(i,{className:"tl-collaborator__shape-indicator",shapeId:v,color:b,opacity:.5},u+"_"+v))]})});function AC(t){return t>G6?"inactive":t>WE?"idle":"active"}function NN(t){const n=z.useRef((t==null?void 0:t.lastActivityTimestamp)??-1),[o,r]=z.useState(()=>AC(Date.now()-n.current));return z.useEffect(()=>{const s=setInterval(()=>{r(AC(Date.now()-n.current))},V6);return()=>clearInterval(s)},[]),t&&(n.current=t.lastActivityTimestamp),o}const OC=z.memo(function({id:t,shape:n,util:o,index:r,backgroundIndex:s,opacity:a,dprMultiple:i}){const l=Be(),{ShapeErrorFallback:c}=Vr(),u=z.useRef(null),f=z.useRef(null),h=z.useRef({transform:"",clipPath:"none",width:0,height:0,x:0,y:0,isCulled:!1});La("set shape stuff",()=>{const p=l.getShape(t);if(!p)return;const y=h.current,g=l.getShapeClipPath(t)??"none";g!==y.clipPath&&(Xn(u.current,"clip-path",g),Xn(f.current,"clip-path",g),y.clipPath=g);const b=l.getShapePageTransform(t),m=vt.toCssString(b),v=l.getShapeGeometry(p).bounds;m!==y.transform&&(Xn(u.current,"transform",m),Xn(f.current,"transform",m),y.transform=m);const x=v.w%i,w=v.h%i,S=x===0?v.w:v.w+(i-x),k=w===0?v.h:v.h+(i-w);(S!==y.width||k!==y.height)&&(Xn(u.current,"width",Math.max(S,i)+"px"),Xn(u.current,"height",Math.max(k,i)+"px"),Xn(f.current,"width",Math.max(S,i)+"px"),Xn(f.current,"height",Math.max(k,i)+"px"),y.width=S,y.height=k)},[l]),La("set opacity and z-index",()=>{const p=u.current,y=f.current;Xn(p,"opacity",a),Xn(y,"opacity",a),Xn(p,"z-index",r),Xn(y,"z-index",s)},[a,r,s]),La("set display",()=>{if(!l.getShape(t))return;const p=l.getCulledShapes().has(t);p!==h.current.isCulled&&(Xn(u.current,"display",p?"none":"block"),Xn(f.current,"display",p?"none":"block"),h.current.isCulled=p)},[l]);const d=z.useCallback(p=>l.annotateError(p,{origin:"shape",willCrashApp:!1}),[l]);return n?E.jsxs(E.Fragment,{children:[o.backgroundComponent&&E.jsx("div",{ref:f,className:"tl-shape tl-shape-background","data-shape-type":n.type,draggable:!1,children:E.jsx(eh,{fallback:c,onError:d,children:E.jsx(BN,{shape:n,util:o})})}),E.jsx("div",{ref:u,className:"tl-shape","data-shape-type":n.type,draggable:!1,children:E.jsx(eh,{fallback:c,onError:d,children:E.jsx(UN,{shape:n,util:o})})})]}):null}),UN=z.memo(function({shape:t,util:n}){return Rf("InnerShape:"+t.type,()=>n.component(t))},(t,n)=>t.shape.props===n.shape.props&&t.shape.meta===n.shape.meta),BN=z.memo(function({shape:t,util:n}){return Rf("InnerShape:"+t.type,()=>{var o;return(o=n.backgroundComponent)==null?void 0:o.call(n,t)})},(t,n)=>t.shape.props===n.shape.props&&t.shape.meta===n.shape.meta);function zN({className:t}){const n=Be(),{Background:o,SvgDefs:r}=Vr(),s=z.useRef(null),a=z.useRef(null),i=z.useRef(null),l=Qn();OF(s),n8(),t8(),cF(s),i8(s);const c=z.useRef({lodDisableTextOutline:!1,allowTextOutline:!0});La("position layers",function(){const{x:g,y:b,z:m}=n.getCamera();if(c.current.allowTextOutline&&n.environment.isSafari&&(l.style.setProperty("--tl-text-outline","none"),c.current.allowTextOutline=!1),c.current.allowTextOutline&&m<KE!==c.current.lodDisableTextOutline){const w=m<KE;l.style.setProperty("--tl-text-outline",w?"none":`0 var(--b) 0 var(--color-background), 0 var(--a) 0 var(--color-background),
				var(--b) var(--b) 0 var(--color-background), var(--a) var(--b) 0 var(--color-background),
				var(--a) var(--a) 0 var(--color-background), var(--b) var(--a) 0 var(--color-background)`),c.current.lodDisableTextOutline=w}const v=m>=1?Nf(m,[1,8],[.125,.5],!0):Nf(m,[.1,1],[-2,.125],!0),x=`scale(${ke(m)}) translate(${ke(g+v)}px,${ke(b+v)}px)`;Xn(a.current,"transform",x),Xn(i.current,"transform",x)},[n,l]);const u=e8(),f=We("shapeSvgDefs",()=>{const g=new Map;for(const b of dn(n.shapeUtils)){if(!b)return;const m=b.getCanvasSvgDefs();for(const{key:v,component:x}of m)g.has(v)||g.set(v,E.jsx(x,{},v))}return[...g.values()]},[n]),h=We("debug_shapes",()=>jn.hideShapes.get(),[jn]),d=We("debug_svg",()=>jn.debugSvg.get(),[jn]),p=We("debug_geometry",()=>jn.debugGeometry.get(),[jn]),y=We("isEditingAnything",()=>n.getEditingShapeId()!==null,[n]);return E.jsxs("div",{ref:s,draggable:!1,"data-iseditinganything":y,className:Pt("tl-canvas",t),"data-testid":"canvas",...u,children:[E.jsx("svg",{className:"tl-svg-context",children:E.jsxs("defs",{children:[f,E.jsx(tU,{}),E.jsx(rU,{}),r&&E.jsx(r,{})]})}),o&&E.jsx("div",{className:"tl-background__wrapper",children:E.jsx(o,{})}),E.jsx(GN,{}),E.jsxs("div",{ref:a,className:"tl-html-layer tl-shapes",draggable:!1,children:[E.jsx(iU,{}),E.jsx(sU,{}),h?null:d?E.jsx(XN,{}):E.jsx(ZN,{})]}),E.jsxs("div",{className:"tl-overlays",children:[E.jsxs("div",{ref:i,className:"tl-html-layer",children:[p?E.jsx(DF,{}):null,E.jsx(qN,{}),E.jsx(HN,{}),E.jsx(VN,{}),E.jsx(WN,{}),E.jsx(JN,{}),E.jsx(eU,{}),E.jsx($N,{}),E.jsx(oU,{}),E.jsx(RN,{})]}),E.jsx(aU,{})]}),E.jsx(lU,{})]})}function GN(){const t=Be(),n=We("gridSize",()=>t.getDocumentSettings().gridSize,[t]),{x:o,y:r,z:s}=We("camera",()=>t.getCamera(),[t]),a=We("isGridMode",()=>t.getInstanceState().isGridMode,[t]),{Grid:i}=Vr();return i&&a?E.jsx(i,{x:o,y:r,z:s,size:n}):null}function VN(){const t=Be(),n=We("scribbles",()=>t.getInstanceState().scribbles,[t]),o=We("zoomLevel",()=>t.getZoomLevel(),[t]),{Scribble:r}=Vr();return r&&n.length?E.jsx(E.Fragment,{children:n.map(s=>E.jsx(r,{className:"tl-user-scribble",scribble:s,zoom:o},s.id))}):null}function HN(){const t=Be(),n=We("brush",()=>t.getInstanceState().brush,[t]),{Brush:o}=Vr();return o&&n?E.jsx(o,{className:"tl-user-brush",brush:n}):null}function WN(){const t=Be(),n=We("zoomBrush",()=>t.getInstanceState().zoomBrush,[t]),{ZoomBrush:o}=Vr();return o&&n?E.jsx(o,{className:"tl-user-brush tl-zoom-brush",brush:n}):null}function $N(){const t=Be(),n=We("snapLines",()=>t.snaps.getIndicators(),[t]),o=We("zoomLevel",()=>t.getZoomLevel(),[t]),{SnapIndicator:r}=Vr();return r&&n.length>0?E.jsx(E.Fragment,{children:n.map(s=>E.jsx(r,{className:"tl-user-snapline",line:s,zoom:o},s.id))}):null}function qN(){const t=Be(),n=We("handles shapeIdWithHandles",()=>{const{isReadonly:o,isChangingStyle:r}=t.getInstanceState();if(o||r)return!1;const s=t.getOnlySelectedShape();return!s||!t.getShapeHandles(s)?!1:s.id},[t]);return n?E.jsx(YN,{shapeId:n}):null}function YN({shapeId:t}){const n=Be(),{Handles:o}=Vr(),r=We("zoomLevel",()=>n.getZoomLevel(),[n]),s=We("coarse pointer",()=>n.getInstanceState().isCoarsePointer,[n]),a=We("handles transform",()=>n.getShapePageTransform(t),[n,t]),i=We("handles",()=>{const l=n.getShapeHandles(t);if(!l)return null;const c=(s?qE:YE)/r*2;return l.filter(u=>u.type!=="virtual"||!l.some(f=>f!==u&&f.type==="vertex"&&q.Dist(u,f)<c)).sort(u=>u.type==="vertex"?1:-1)},[n,r,s,t]);return!o||!i||!a?null:E.jsx(o,{children:E.jsx("g",{transform:vt.toCssString(a),children:i.map(l=>E.jsx(KN,{shapeId:t,handle:l,zoom:r,isCoarse:s},l.id))})})}function KN({shapeId:t,handle:n,zoom:o,isCoarse:r}){const s=uF(t,n.id),{Handle:a}=Vr();return a?E.jsx("g",{"aria-label":"handle",transform:`translate(${n.x}, ${n.y})`,...s,children:E.jsx(a,{shapeId:t,handle:n,zoom:o,isCoarse:r})}):null}function XN(){const t=Be(),n=We("rendering shapes",()=>t.getRenderingShapes(),[t]),o=We("dpr multiple",()=>jC(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return E.jsx(E.Fragment,{children:n.map(r=>E.jsxs(z.Fragment,{children:[E.jsx(OC,{...r,dprMultiple:o}),E.jsx(nU,{id:r.id})]},r.id+"_fragment"))})}function QN(){const t=Be(),n=z.useRef(new Set);return La("reflow for culled shapes",()=>{const o=t.getCulledShapes();if(n.current.size===o.size&&[...o].every(s=>n.current.has(s)))return;n.current=o;const r=document.getElementsByClassName("tl-canvas");r.length!==0&&r[0].offsetHeight},[t]),null}function ZN(){const t=Be(),n=We("rendering shapes",()=>t.getRenderingShapes(),[t]),o=We("dpr multiple",()=>jC(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return E.jsxs(E.Fragment,{children:[n.map(r=>E.jsx(OC,{...r,dprMultiple:o},r.id+"_shape")),t.environment.isSafari&&E.jsx(QN,{})]})}function JN(){const t=Be(),n=We("rendering shapes",()=>t.getRenderingShapes(),[t]),o=z.useRef(new Set),r=We("should display selected ids",()=>{const a=o.current,i=new Set;if(t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!t.getInstanceState().isChangingStyle){const l=t.getSelectedShapeIds();for(const c of l)i.add(c);if(t.isInAny("select.idle","select.editing_shape")){const c=t.getInstanceState();if(c.isHoveringCanvas&&!c.isCoarsePointer){const u=t.getHoveredShapeId();u&&i.add(u)}}}if(a.size!==i.size)return o.current=i,i;for(const l of i)if(!a.has(l))return o.current=i,i;return a},[t]),{ShapeIndicator:s}=Vr();return s?E.jsx(E.Fragment,{children:n.map(({id:a})=>E.jsx(s,{shapeId:a,hidden:!r.has(a)},a+"_indicator"))}):null}function eU(){const t=Be(),{ShapeIndicator:n}=Vr(),o=We("hinting shape ids",()=>Ff(t.getHintingShapeIds()),[t]);return!o.length||!n?null:E.jsx(E.Fragment,{children:o.map(r=>E.jsx(n,{className:"tl-user-indicator__hint",shapeId:r},r+"_hinting"))})}function tU(){return E.jsxs("g",{id:"cursor",children:[E.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[E.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),E.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),E.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[E.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),E.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),E.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[E.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),E.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function rU(){return E.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function nU({id:t}){const n=Be(),[o,r]=z.useState(null),s=We("is in root",()=>{var a;return((a=n.getShape(t))==null?void 0:a.parentId)===n.getCurrentPageId()},[n,t]);return z.useEffect(()=>{if(!s)return;let a=null;const i=Bc("shape to svg",async()=>{const l=Math.random();a=l;const c=n.isShapeOfType(t,"frame")?0:10;let u=n.getShapePageBounds(t);if(!u)return;u=u.clone().expandBy(c);const f=await n.getSvgString([t],{padding:c,background:n.getInstanceState().exportBackground});if(a!==l||!f)return;const h=`data:image/svg+xml;utf8,${encodeURIComponent(f.svg)}`;r({src:h,bounds:u})});return()=>{a=null,i()}},[n,t,s]),!s||!o?null:E.jsx("img",{src:o.src,width:o.bounds.width,height:o.bounds.height,style:{position:"absolute",top:0,left:0,transform:`translate(${o.bounds.x}px, ${o.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}})}function oU(){const t=Be(),n=We("selection rotation",()=>t.getSelectionRotation(),[t]),o=We("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionForeground:r}=Vr();return!o||!r?null:E.jsx(r,{bounds:o,rotation:n})}function sU(){const t=Be(),n=We("selection rotation",()=>t.getSelectionRotation(),[t]),o=We("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionBackground:r}=Vr();return!o||!r?null:E.jsx(r,{bounds:o,rotation:n})}function iU(){const{OnTheCanvas:t}=Vr();return t?E.jsx(t,{}):null}function aU(){const{InFrontOfTheCanvas:t}=Vr();return t?E.jsx(t,{}):null}function lU(){const t=Be(),n=We("camera state",()=>t.getCameraState(),[t]);return E.jsx("div",{className:Pt("tl-hit-test-blocker",{"tl-hit-test-blocker__hidden":n==="idle"})})}function cU({className:t,zoom:n,point:o,color:r,viewport:s,opacity:a=1}){const i=z.useRef(null);return Qc(i,Ba(o.x,s.minX+5/n,s.maxX-5/n),Ba(o.y,s.minY+5/n,s.maxY-5/n),1/n,q.Angle(s.center,o)),E.jsxs("svg",{ref:i,className:Pt("tl-overlays__item",t),children:[E.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),E.jsx("use",{href:"#cursor_hint",color:r,opacity:a})]})}const LC=z.memo(function({className:t,zoom:n,point:o,color:r,name:s,chatMessage:a}){const i=z.useRef(null);return Qc(i,o==null?void 0:o.x,o==null?void 0:o.y,1/n),o?E.jsxs("div",{ref:i,className:Pt("tl-overlays__item",t),children:[E.jsx("svg",{className:"tl-cursor",children:E.jsx("use",{href:"#cursor",color:r})}),a?E.jsxs(E.Fragment,{children:[s&&E.jsx("div",{className:"tl-nametag-title",style:{color:r},children:s}),E.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:r},children:a})]}):s&&E.jsx("div",{className:"tl-nametag",style:{backgroundColor:r},children:s})]}):null});function uU({x:t,y:n,z:o,size:r}){return E.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("defs",{children:HE.map(({min:s,mid:a,step:i},l)=>{const c=i*r*o,u=.5+t*o,f=.5+n*o,h=u>0?u%c:c+u%c,d=f>0?f%c:c+f%c,p=o<a?Nf(o,[s,a],[0,1]):1;return E.jsx("pattern",{id:`grid-${i}`,width:c,height:c,patternUnits:"userSpaceOnUse",children:E.jsx("circle",{className:"tl-grid-dot",cx:h,cy:d,r:1,opacity:p})},`grid-pattern-${l}`)})}),HE.map(({step:s},a)=>E.jsx("rect",{width:"100%",height:"100%",fill:`url(#grid-${s})`},`grid-rect-${a}`))]})}function dU({handle:t,isCoarse:n,className:o,zoom:r}){const s=(n?qE:YE)/r;if(t.type==="clone"){const i=3/Math.max(r,.35),l=`M0,${-i} A${i},${i} 0 0,1 0,${i}`,c=Y6.indexOf(t.id);return E.jsxs("g",{className:Pt(`tl-handle tl-handle__${t.type}`,o),children:[E.jsx("circle",{className:"tl-handle__bg",r:s}),E.jsx("path",{className:"tl-handle__fg",d:l,transform:`rotate(${-90+90*c})`})]})}const a=(t.type==="create"&&n?3:4)/Math.max(r,.35);return E.jsxs("g",{className:Pt(`tl-handle tl-handle__${t.type}`,o),children:[E.jsx("circle",{className:"tl-handle__bg",r:s}),E.jsx("circle",{className:"tl-handle__fg",r:a})]})}const hU=({children:t})=>E.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t});function Kb(t,n=!0){const o=t.length;if(o<2)return"";let r=t[0],s=t[1];if(o===2)return`M${An(r)}L${An(s)}`;let a="";for(let i=2,l=o-1;i<l;i++)r=t[i],s=t[i+1],a+=Oo(r,s);return n?`M${Oo(t[0],t[1])}Q${An(t[1])}${Oo(t[1],t[2])}T${a}${Oo(t[o-1],t[0])}${Oo(t[0],t[1])}Z`:`M${An(t[0])}Q${An(t[1])}${Oo(t[1],t[2])}${t.length>3?"T":""}${a}L${An(t[o-1])}`}function RC({scribble:t,zoom:n,color:o,opacity:r,className:s}){return t.points.length?E.jsx("svg",{className:s&&Pt("tl-overlays__item",s),children:E.jsx("path",{className:"tl-scribble",d:Kb(t.points,!1),stroke:o??`var(--color-${t.color})`,fill:"none",strokeWidth:8/n,opacity:r??t.opacity})}):null}function DC({bounds:t,rotation:n}){const o=z.useRef(null);return Qc(o,t.x,t.y,1,n),z.useLayoutEffect(()=>{const r=o.current;r&&(r.style.width=ke(Math.max(1,t.width))+"px",r.style.height=ke(Math.max(1,t.height))+"px")},[t.width,t.height]),E.jsx("div",{ref:o,className:"tl-selection__bg",draggable:!1})}function pU({bounds:t,rotation:n}){const o=Be(),r=z.useRef(null),s=We("only selected shape",()=>o.getOnlySelectedShape(),[o]),a=s?o.getShapeUtil(s).expandSelectionOutlinePx(s):0;return Qc(r,t==null?void 0:t.x,t==null?void 0:t.y,1,n,{x:-a,y:-a}),t=t.clone().expandBy(a).zeroFix(),E.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:E.jsx("rect",{className:Pt("tl-selection__fg__outline"),width:ke(t.width),height:ke(t.height)})})}const fU=()=>E.jsx("div",{className:"tl-shape-error-boundary"}),mU=({shape:t,util:n})=>Rf("Indicator: "+t.type,()=>n.indicator(t)),gU=({editor:t,id:n})=>{const o=We("shape for indicator",()=>t.store.get(n),[t,n]),{ShapeIndicatorErrorFallback:r}=Vr();return!o||o.isLocked?null:E.jsx(eh,{fallback:r,onError:s=>t.annotateError(s,{origin:"react.shapeIndicator",willCrashApp:!1}),children:E.jsx(mU,{shape:o,util:t.getShapeUtil(o)},o.id)})},FC=z.memo(function({shapeId:t,className:n,color:o,hidden:r,opacity:s}){const a=Be(),i=z.useRef(null);return La("indicator transform",()=>{const l=i.current;if(!l)return;const c=a.getShapePageTransform(t);c&&l.style.setProperty("transform",c.toCssString())},[a,t]),z.useLayoutEffect(()=>{const l=i.current;l&&l.style.setProperty("display",r?"none":"block")},[r]),E.jsx("svg",{ref:i,className:Pt("tl-overlays__item",n),children:E.jsx("g",{className:"tl-shape-indicator",stroke:o??"var(--color-selected)",opacity:s,children:E.jsx(gU,{editor:a,id:t})})})}),yU=()=>E.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function vU({points:t,zoom:n}){const o=2.5/n,r=t.reduce((d,p)=>Math.min(d,p.x),1/0),s=t.reduce((d,p)=>Math.max(d,p.x),-1/0),a=t.reduce((d,p)=>Math.min(d,p.y),1/0),i=t.reduce((d,p)=>Math.max(d,p.y),-1/0),l=t.some(d=>d.x===r&&d.y===a);let c,u,f,h;return l?(c=r,u=a,f=s,h=i):(c=r,u=i,f=s,h=a),E.jsxs("g",{className:"tl-snap-indicator",stroke:"lime",children:[E.jsx("line",{x1:c,y1:u,x2:f,y2:h}),t.map((d,p)=>E.jsx("g",{transform:`translate(${d.x},${d.y})`,children:E.jsx("path",{className:"tl-snap-point",d:`M ${-o},${-o} L ${o},${o} M ${-o},${o} L ${o},${-o}`})},p))]})}function bU({gaps:t,direction:n,zoom:o}){const r=3.5/o;let s=[-1/0,1/0],a=null;const i=n==="horizontal";for(const c of t){if(a=Fs(s[0],s[1],i?c.startEdge[0].y:c.startEdge[0].x,i?c.startEdge[1].y:c.startEdge[1].x),a)s=a;else continue;if(a=Fs(s[0],s[1],i?c.endEdge[0].y:c.endEdge[0].x,i?c.endEdge[1].y:c.endEdge[1].x),a)s=a;else continue}if(s===null)return null;const l=(s[0]+s[1])/2;return E.jsx("g",{className:"tl-snap-indicator",stroke:"cyan",children:t.map(({startEdge:c,endEdge:u},f)=>E.jsx(z.Fragment,{children:i?E.jsxs(E.Fragment,{children:[E.jsx("line",{x1:c[0].x,y1:l-2*r,x2:c[1].x,y2:l+2*r}),E.jsx("line",{x1:u[0].x,y1:l-2*r,x2:u[1].x,y2:l+2*r}),E.jsx("line",{x1:c[0].x,y1:l,x2:u[0].x,y2:l}),E.jsx("line",{x1:(c[0].x+u[0].x)/2,y1:l-r,x2:(c[0].x+u[0].x)/2,y2:l+r})]}):E.jsxs(E.Fragment,{children:[E.jsx("line",{x1:l-2*r,y1:c[0].y,x2:l+2*r,y2:c[1].y}),E.jsx("line",{x1:l-2*r,y1:u[0].y,x2:l+2*r,y2:u[1].y}),E.jsx("line",{x1:l,y1:c[0].y,x2:l,y2:u[0].y}),E.jsx("line",{x1:l-r,y1:(c[0].y+u[0].y)/2,x2:l+r,y2:(c[0].y+u[0].y)/2})]})},f))})}function xU({className:t,line:n,zoom:o}){return E.jsx("svg",{className:Pt("tl-overlays__item",t),children:n.type==="points"?E.jsx(vU,{...n,zoom:o}):n.type==="gaps"?E.jsx(bU,{...n,zoom:o}):null})}function wU(){return E.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:E.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[E.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),E.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:E.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const SU=()=>null;function NC(t,n){const o=z.useRef(t);return n(t,o.current)?o.current:(o.current=t,t)}function Xb(t){return NC(t,VR)}function Qb(t){return NC(t,Ek)}const UC=z.createContext({});function jU({overrides:t={},children:n}){const o=Qb(t);return E.jsx(UC.Provider,{value:z.useMemo(()=>({Background:C6,SvgDefs:SU,Brush:hm,ZoomBrush:hm,ScreenshotBrush:hm,CollaboratorBrush:hm,Cursor:LC,CollaboratorCursor:LC,CollaboratorHint:cU,CollaboratorShapeIndicator:FC,Grid:uU,Scribble:RC,SnapIndicator:xU,Handles:hU,Handle:dU,CollaboratorScribble:RC,ErrorFallback:zC,ShapeErrorFallback:fU,ShapeIndicatorErrorFallback:yU,Spinner:wU,SelectionBackground:DC,SelectionForeground:pU,ShapeIndicator:FC,OnTheCanvas:null,InFrontOfTheCanvas:null,Canvas:zN,...o}),[o]),children:n})}function Vr(){return z.useContext(UC)}const Zb={openWindow:(t,n)=>window.open(t,n,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var t;return await((t=window.__tldraw__hardReset)==null?void 0:t.call(window))}};function BC(){Zb.hardReset()}function _U(){Zb.refreshPage()}const kU="https://github.com/tldraw/tldraw/issues/new";function EU(){}const zC=({error:t,editor:n})=>{const o=z.useRef(null),[r,s]=z.useState(!1),[a,i]=z.useState(!1),[l,c]=z.useState(!1),{Canvas:u}=Vr(),f=t instanceof Error?t.message:String(t),h=t instanceof Error?t.stack:null,d=We("isDarkMode",()=>{try{if(n)return n.user.getIsDarkMode()}catch{}return null},[n]),[p,y]=z.useState(null);z.useLayoutEffect(()=>{var S;d!==null&&y(d);let x=(S=o.current)==null?void 0:S.parentElement,w=!1;for(;x;){if(x.classList.contains("tl-theme__dark")||x.classList.contains("tl-theme__light")){w=!0;break}x=x.parentElement}if(w){y(null);return}y(window.matchMedia("(prefers-color-scheme: dark)").matches)},[d]),z.useEffect(()=>{if(a){const x=setTimeout(()=>{i(!1)},2e3);return()=>clearTimeout(x)}},[a]);const g=()=>{const x=document.createElement("textarea");x.value=h??f,document.body.appendChild(x),x.select(),document.execCommand("copy"),x.remove(),i(!0)},b=()=>{_U()},m=async()=>{BC()},v=new URL(kU);return v.searchParams.set("title",f),v.searchParams.set("labels","bug"),v.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${h??f}
\`\`\`

My browser: ${navigator.userAgent}`),E.jsxs("div",{ref:o,className:Pt("tl-container tl-error-boundary",p===null?"":p?"tl-theme__dark":"tl-theme__light"),children:[E.jsx("div",{className:"tl-error-boundary__overlay"}),n&&E.jsx(UE,{onError:EU,fallback:()=>null,children:E.jsx(im.Provider,{value:n,children:E.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:u?E.jsx(u,{}):null})})}),E.jsx("div",{className:Pt("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!l}),children:l?E.jsxs(E.Fragment,{children:[E.jsx("h2",{children:"Are you sure?"}),E.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),E.jsxs("div",{className:"tl-error-boundary__content__actions",children:[E.jsx("button",{onClick:()=>c(!1),children:"Cancel"}),E.jsx("button",{className:"tl-error-boundary__reset",onClick:m,children:"Reset data"})]})]}):E.jsxs(E.Fragment,{children:[E.jsx("h2",{children:"Something's gone wrong."}),E.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",E.jsx("a",{href:v.toString(),children:"create a GitHub issue"})," or"," ",E.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&E.jsxs(E.Fragment,{children:["Message:",E.jsx("h4",{children:E.jsx("code",{children:f})}),"Stack trace:",E.jsxs("div",{className:"tl-error-boundary__content__error",children:[E.jsx("pre",{children:E.jsx("code",{children:h??f})}),E.jsx("button",{onClick:g,children:a?"Copied!":"Copy"})]})]}),E.jsxs("div",{className:"tl-error-boundary__content__actions",children:[E.jsx("button",{onClick:()=>s(!r),children:r?"Hide details":"Show details"}),E.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[E.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>c(!0),children:"Reset data"}),E.jsx("button",{className:"tl-error-boundary__refresh",onClick:b,children:"Refresh Page"})]})]})]})})]})};function Ir(){return zf()}const GC="TLDRAW_USER_DATA_v3",VC=Gt({id:Dt,name:Dt.nullable().optional(),locale:Dt.nullable().optional(),color:Dt.nullable().optional(),isDarkMode:Ht.nullable().optional(),animationSpeed:Mt.nullable().optional(),edgeScrollSpeed:Mt.nullable().optional(),isSnapMode:Ht.nullable().optional(),isWrapMode:Ht.nullable().optional()}),su={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4,AddExcalidrawSelectMode:5},Jb=Math.max(...Object.values(su));function CU(t){t.version<su.AddAnimationSpeed&&(t.user.animationSpeed=1),t.version<su.AddIsSnapMode&&(t.user.isSnapMode=!1),t.version<su.MakeFieldsNullable,t.version<su.AddEdgeScrollSpeed&&(t.user.edgeScrollSpeed=1),t.version<su.AddExcalidrawSelectMode&&(t.user.isWrapMode=!1),t.version=Jb}const HC=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function PU(){return HC[Math.floor(Math.random()*HC.length)]}function MU(){var t,n;return typeof window>"u"?!1:((n=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-color-scheme: dark)"))==null?void 0:n.matches)??!1}function TU(){var t,n;return typeof window>"u"?!1:((n=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:n.matches)??!1}const Ul=Object.freeze({name:"New User",locale:S6(),color:PU(),isDarkMode:!1,edgeScrollSpeed:1,animationSpeed:TU()?0:1,isSnapMode:!1,isWrapMode:!1});function WC(){return{id:Ir()}}function $C(t){if(t===null||typeof t!="object"||!("version"in t)||!("user"in t)||typeof t.version!="number")return WC();const n=wr(t);CU(n);try{return VC.validate(n.user)}catch{return WC()}}function IU(){const t=JSON.parse(mb(GC)||"null")??null;return $C(t)}const dh=fo("globalUserData",null);function AU(){gb(GC,JSON.stringify({version:Jb,user:dh.get()}))}function OU(t){VC.validate(t),dh.set(t),AU(),RU()}const LU=typeof process<"u"&&!1,iu=typeof BroadcastChannel<"u"&&!LU?new BroadcastChannel("tldraw-user-sync"):null;iu==null||iu.addEventListener("message",t=>{const n=t.data;(n==null?void 0:n.type)===YC&&(n==null?void 0:n.origin)!==qC()&&dh.set($C(n.data))});let e1=null;function qC(){return e1===null&&(e1=Ir()),e1}const YC="tldraw-user-preferences-change";function RU(){iu==null||iu.postMessage({type:YC,origin:qC(),data:{user:KC(),version:Jb}})}function KC(){let t=dh.get();return t||(t=IU(),dh.set(t)),t}function XC(t={}){return{derivePresenceState:t.derivePresenceState??(()=>Ye("presence",()=>null)),userPreferences:t.userPreferences??Ye("userPreferences",()=>KC()),setUserPreferences:t.setUserPreferences??OU}}var QC={exports:{}};(function(t){var n=Object.prototype.hasOwnProperty,o="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(o=!1));function s(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function a(c,u,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var p=new s(f,h||c,d),y=o?o+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],p]:c._events[y].push(p):(c._events[y]=p,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],u,f;if(this._eventsCount===0)return c;for(f in u=this._events)n.call(u,f)&&c.push(o?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},l.prototype.listeners=function(c){var u=o?o+c:c,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,d=f.length,p=new Array(d);h<d;h++)p[h]=f[h].fn;return p},l.prototype.listenerCount=function(c){var u=o?o+c:c,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(c,u,f,h,d,p){var y=o?o+c:c;if(!this._events[y])return!1;var g=this._events[y],b=arguments.length,m,v;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,h),!0;case 5:return g.fn.call(g.context,u,f,h,d),!0;case 6:return g.fn.call(g.context,u,f,h,d,p),!0}for(v=1,m=new Array(b-1);v<b;v++)m[v-1]=arguments[v];g.fn.apply(g.context,m)}else{var x=g.length,w;for(v=0;v<x;v++)switch(g[v].once&&this.removeListener(c,g[v].fn,void 0,!0),b){case 1:g[v].fn.call(g[v].context);break;case 2:g[v].fn.call(g[v].context,u);break;case 3:g[v].fn.call(g[v].context,u,f);break;case 4:g[v].fn.call(g[v].context,u,f,h);break;default:if(!m)for(w=1,m=new Array(b-1);w<b;w++)m[w-1]=arguments[w];g[v].fn.apply(g[v].context,m)}}return!0},l.prototype.on=function(c,u,f){return a(this,c,u,f,!1)},l.prototype.once=function(c,u,f){return a(this,c,u,f,!0)},l.prototype.removeListener=function(c,u,f,h){var d=o?o+c:c;if(!this._events[d])return this;if(!u)return i(this,d),this;var p=this._events[d];if(p.fn)p.fn===u&&(!h||p.once)&&(!f||p.context===f)&&i(this,d);else{for(var y=0,g=[],b=p.length;y<b;y++)(p[y].fn!==u||h&&!p[y].once||f&&p[y].context!==f)&&g.push(p[y]);g.length?this._events[d]=g.length===1?g[0]:g:i(this,d)}return this},l.prototype.removeAllListeners=function(c){var u;return c?(u=o?o+c:c,this._events[u]&&i(this,u)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=o,l.EventEmitter=l,t.exports=l})(QC);var DU=QC.exports;function Ha({children:t,className:n="",...o}){return E.jsx("svg",{...o,className:Pt("tl-svg-container",n),children:t})}function t1(t,n,o,r){const s=t.x-o.x,a=t.y-o.y,i=r.x-o.x,l=r.y-o.y,c=n.x-t.x,u=n.y-t.y,f=i*a-l*s,h=c*a-u*s,d=l*c-i*u;if(f===0||h===0||d===0)return null;if(d!==0){const p=f/d,y=h/d;if(0<=p&&p<=1&&0<=y&&y<=1)return q.AddXY(t,p*c,p*u)}return null}function jm(t,n,o,r){const s=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),a=2*((n.x-t.x)*(t.x-o.x)+(n.y-t.y)*(t.y-o.y)),i=o.x*o.x+o.y*o.y+t.x*t.x+t.y*t.y-2*(o.x*t.x+o.y*t.y)-r*r,l=a*a-4*s*i;if(l<0||l===0)return null;const c=Math.sqrt(l),u=(-a+c)/(2*s),f=(-a-c)/(2*s);if((u<0||u>1)&&(f<0||f>1))return null;const h=[];return 0<=u&&u<=1&&h.push(q.Lrp(t,n,u)),0<=f&&f<=1&&h.push(q.Lrp(t,n,f)),h.length===0?null:h}function FU(t,n,o){const r=[];let s;for(let a=0,i=o.length-1;a<i;a++)s=t1(t,n,o[a],o[a+1]),s&&r.push(s);return r.length===0?null:r}function r1(t,n,o){const r=[];let s;for(let a=1,i=o.length;a<i+1;a++)s=t1(t,n,o[a-1],o[a%o.length]),s&&r.push(s);return r.length===0?null:r}function NU(t,n,o,r){let s=o.x-t.x,a=o.y-t.y;const i=Math.sqrt(s*s+a*a),l=(i*i-r*r+n*n)/(2*i),c=Math.sqrt(n*n-l*l);return s/=i,a/=i,[new q(t.x+s*l-a*c,t.y+a*l+s*c),new q(t.x+s*l+a*c,t.y+a*l-s*c)]}function n1(t,n,o){const r=[];let s,a,i;for(let l=0,c=o.length;l<c;l++)s=o[l],a=o[(l+1)%o.length],i=jm(s,a,t,n),i&&r.push(...i);return r.length===0?null:r}function ZC(t,n,o){const r=[];let s,a,i;for(let l=1,c=o.length;l<c;l++)s=o[l-1],a=o[l],i=jm(s,a,t,n),i&&r.push(...i);return r.length===0?null:r}function _m(t,n,o){return(o.y-t.y)*(n.x-t.x)>(n.y-t.y)*(o.x-t.x)}function o1(t,n,o,r){return _m(t,o,r)!==_m(n,o,r)&&_m(t,n,o)!==_m(t,n,r)}function JC(t,n){const o=new Map;let r,s,a,i;for(let l=0,c=t.length;l<c;l++)if(r=t[l],es(r,n)){const u=s1(r);o.has(u)||o.set(u,r)}for(let l=0,c=n.length;l<c;l++)if(r=n[l],es(r,t)){const u=s1(r);o.has(u)||o.set(u,r)}for(let l=0,c=t.length;l<c;l++){r=t[l],s=t[(l+1)%t.length];for(let u=0,f=n.length;u<f;u++){a=n[u],i=n[(u+1)%n.length];const h=t1(r,s,a,i);if(h!==null){const d=s1(h);o.has(d)||o.set(d,h)}}}return o.size===0?null:UU([...o.values()])}function s1(t){return`${t.x},${t.y}`}function UU(t){const n=q.Average(t);return t.sort((o,r)=>q.Angle(n,o)-q.Angle(n,r))}function eP(t,n){let o,r,s,a;for(let i=0,l=t.length;i<l;i++){o=t[i],r=t[(i+1)%l];for(let c=0,u=n.length;c<u;c++)if(s=n[c],a=n[(c+1)%u],o1(o,r,s,a))return!0}return!1}function BU(t,n){let o,r,s,a;for(let i=0,l=t.length;i<l;i++){o=t[i],r=t[(i+1)%l];for(let c=1,u=n.length;c<u;c++)if(s=n[c-1],a=n[c],o1(o,r,s,a))return!0}return!1}class hh extends Fl{constructor(o){super({...o,isClosed:!1,isFilled:!1});R(this,"start");R(this,"end");R(this,"d");R(this,"u");R(this,"ul");R(this,"_length");const{start:r,end:s}=o;this.start=r,this.end=s,this.d=r.clone().sub(s),this.u=this.d.clone().uni(),this.ul=this.u.len()}get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(o){const{start:r,end:s,u:a,ul:i}=this;if(i===0)return r;const l=q.Sub(o,r).dpr(a)/i,c=r.x+a.x*l;if(c<Math.min(r.x,s.x))return r.x<s.x?r:s;if(c>Math.max(r.x,s.x))return r.x>s.x?r:s;const u=r.y+a.y*l;return u<Math.min(r.y,s.y)?r.y<s.y?r:s:u>Math.max(r.y,s.y)?r.y>s.y?r:s:new q(c,u)}hitTestLineSegment(o,r,s=0){return o1(o,r,this.start,this.end)||this.distanceToLineSegment(o,r)<=s}}class Bl extends Fl{constructor(o){super({isClosed:!1,isFilled:!1,...o});R(this,"points");R(this,"_segments");R(this,"_length");const{points:r}=o;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:o}=this;for(let r=0,s=o.length-1;r<s;r++){const a=o[r],i=o[r+1];this._segments.push(new hh({start:a,end:i}))}this.isClosed&&this._segments.push(new hh({start:o[o.length-1],end:o[0]}))}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((o,r)=>o+r.length,0)),this._length}getVertices(){return this.points}nearestPoint(o){const{segments:r}=this;let s=this.points[0],a=1/0,i,l;for(let c=0;c<r.length;c++)i=r[c].nearestPoint(o),l=q.Dist2(i,o),l<a&&(s=i,a=l);if(!s)throw Error("nearest point not found");return s}hitTestLineSegment(o,r,s=0){const{segments:a}=this;for(let i=0,l=a.length;i<l;i++)if(a[i].hitTestLineSegment(o,r,s))return!0;return!1}}class hn extends Bl{constructor(n){super({...n}),this.isClosed=!0}}class Vi extends hn{constructor(o){const{x:r=0,y:s=0,width:a,height:i}=o;super({...o,points:[new q(r,s),new q(r+a,s),new q(r+a,s+i),new q(r,s+i)]});R(this,"x");R(this,"y");R(this,"w");R(this,"h");this.x=r,this.y=s,this.w=a,this.h=i}getBounds(){return new mt(this.x,this.y,this.w,this.h)}}class Us{constructor(n){R(this,"canSnap",()=>!0);R(this,"canScroll",()=>!1);R(this,"canBind",(n,o)=>!0);R(this,"canEdit",()=>!1);R(this,"canResize",()=>!0);R(this,"canEditInReadOnly",()=>!1);R(this,"canCrop",()=>!1);R(this,"hideResizeHandles",()=>!1);R(this,"hideRotateHandle",()=>!1);R(this,"hideSelectionBoundsBg",()=>!1);R(this,"hideSelectionBoundsFg",()=>!1);R(this,"isAspectRatioLocked",()=>!1);R(this,"onBeforeCreate");R(this,"onBeforeUpdate");R(this,"onDragShapesOver");R(this,"onDragShapesOut");R(this,"onDropShapesOver");R(this,"onResizeStart");R(this,"onResize");R(this,"onResizeEnd");R(this,"onTranslateStart");R(this,"onTranslate");R(this,"onTranslateEnd");R(this,"onHandleDrag");R(this,"onRotateStart");R(this,"onRotate");R(this,"onRotateEnd");R(this,"onBindingChange");R(this,"onChildrenChange");R(this,"onDoubleClickHandle");R(this,"onDoubleClickEdge");R(this,"onDoubleClick");R(this,"onClick");R(this,"onEditEnd");this.editor=n}providesBackgroundForChildren(n){return!1}canReceiveNewChildrenOfType(n,o){return!1}canDropShapes(n,o){return!1}expandSelectionOutlinePx(n){return 0}getCanvasSvgDefs(){return[]}getBoundsSnapGeometry(n){return{}}getHandleSnapGeometry(n){return{}}}R(Us,"props"),R(Us,"migrations"),R(Us,"type");function zU(t,n,o={}){const{closed:r=!1,snap:s=1,start:a="outset",end:i="outset",lengthRatio:l=2,style:c="dashed"}=o;let u=0,f=0,h=1,d=0,p=0;switch(c){case"dashed":{h=1,u=Math.min(n*l,t/4);break}case"dotted":{h=100,u=n/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(a==="outset"?(t+=u/2,p+=u/2):a==="skip"&&(t-=u,p-=u),i==="outset"?t+=u/2:i==="skip"&&(t-=u)),f=Math.floor(t/u/(2*h)),f-=f%s,f<3&&c==="dashed"?t/n<5?(u=t,f=1,d=0):(u=t*.333,d=t*.333):(f=Math.max(f,3),u=t/f/(2*h),r?(p=u/2,d=(t-f*u)/f):d=(t-f*u)/Math.max(1,f-1)),{strokeDasharray:[u,d].join(" "),strokeDashoffset:p.toString()}}function tP({bounds:t,className:n}){const o=Be(),r=We("zoom level",()=>o.getZoomLevel(),[o]);return E.jsx("g",{className:n,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((s,a)=>{const{strokeDasharray:i,strokeDashoffset:l}=zU(s[0].dist(s[1]),1/r,{style:"dashed",lengthRatio:4});return E.jsx("line",{x1:s[0].x,y1:s[0].y,x2:s[1].x,y2:s[1].y,strokeDasharray:i,strokeDashoffset:l},a)})})}class km extends Us{constructor(){super(...arguments);R(this,"hideSelectionBoundsFg",()=>!0);R(this,"canBind",()=>!1);R(this,"onChildrenChange",o=>{const r=this.editor.getSortedChildIdsForParent(o.id);if(r.length===0){this.editor.getCurrentPageState().focusedGroupId===o.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([o.id]);return}else if(r.length===1){this.editor.getCurrentPageState().focusedGroupId===o.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(r,o.parentId),this.editor.deleteShapes([o.id]);return}})}getDefaultProps(){return{}}getGeometry(o){const r=this.editor.getSortedChildIdsForParent(o.id);return r.length===0?new Vi({width:1,height:1,isFilled:!1}):new Ns({children:r.map(s=>{const a=this.editor.getShape(s),i=this.editor.getShapeGeometry(s),l=this.editor.getShapeLocalTransform(a).applyToPoints(i.vertices);return i.isClosed?new hn({points:l,isFilled:!0}):new Bl({points:l})})})}component(o){const r=this.editor.getErasingShapeIds().includes(o.id),{hintingShapeIds:s}=this.editor.getCurrentPageState(),a=s.length>0&&s.some(c=>c!==o.id&&this.editor.isShapeOfType(this.editor.getShape(c),"group")),i=this.editor.getCurrentPageState().focusedGroupId!==o.id;if(!r&&(i||a))return null;const l=this.editor.getShapeGeometry(o).bounds;return E.jsx(Ha,{id:o.id,children:E.jsx(tP,{className:"tl-group",bounds:l})})}indicator(o){const r=this.editor.getShapeGeometry(o).bounds;return E.jsx(tP,{className:"",bounds:r})}}R(km,"type","group"),R(km,"props",SE),R(km,"migrations",jE);const rP=[km],GU=new Set(rP.map(t=>t.type));function nP(t){const n=[...rP],o=new Set;for(const r of t){if(GU.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(o.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);n.push(r),o.add(r.type)}return n}function oP(t,n){if(!n)return!1;switch(t.type){case"mixed":return n.type==="mixed";case"shared":return n.type==="shared"&&t.value===n.value;default:throw Ri(t)}}class VU{constructor(n){R(this,"map");this.map=new Map(n)}get(n){return this.map.get(n)}getAsKnownValue(n){const o=this.get(n);if(o&&o.type!=="mixed")return o.value}get size(){return this.map.size}equals(n){if(this.size!==n.size)return!1;const o=new Set;for(const[r,s]of this){if(!oP(s,n.get(r)))return!1;o.add(r)}for(const[r,s]of n)if(!o.has(r)&&!oP(s,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class i1 extends VU{set(n,o){this.map.set(n,o)}applyValue(n,o){const r=this.get(n);if(!r){this.set(n,{type:"shared",value:o});return}switch(r.type){case"mixed":return;case"shared":r.value!==o&&this.set(n,{type:"mixed"});return;default:Ri(r,"type")}}}class Em{constructor(){R(this,"items",new WeakMap)}get(n,o){return this.items.has(n)||this.items.set(n,o(n)),this.items.get(n)}access(n){return this.items.get(n)}set(n,o){this.items.set(n,o)}has(n){return this.items.has(n)}invalidate(n){this.items.delete(n)}bust(){this.items=new WeakMap}}function HU(t,n,o){return fetch(t).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],n,{type:o})})}function WU(t,n){var s;let o=t;const r=new Set(n);for(;r.has(o);)o=(s=/^.*(\d+)$/.exec(o))!=null&&s[1]?o.replace(/(\d+)(?=\D?)$/,a=>(+a+1).toString()):`${o} 1`;return o}function Cm(t,n,o){if(o.length===0)return[];const r=new Map;for(const a of Lt(o.map(i=>t.getShape(i)))){const{parentId:i}=a;r.has(i)||r.set(i,{children:Lt(t.getSortedChildIdsForParent(i).map(l=>t.getShape(l))),moving:new Set}),r.get(i).moving.add(a)}const s=[];switch(n){case"toBack":{r.forEach(({moving:a,children:i})=>$U(a,i,s));break}case"toFront":{r.forEach(({moving:a,children:i})=>qU(a,i,s));break}case"forward":{r.forEach(({moving:a,children:i})=>YU(a,i,s));break}case"backward":{r.forEach(({moving:a,children:i})=>KU(a,i,s));break}}return s}function $U(t,n,o){const r=n.length;if(t.size===r)return;let s,a;for(let i=0;i<r;i++){const l=n[i];if(t.has(l))s=l.index,t.delete(l);else{a=l.index;break}}if(t.size!==0){const i=Wc(s,a,t.size);o.push(...Array.from(t.values()).sort($n).map((l,c)=>({...l,index:i[c]})))}}function qU(t,n,o){const r=n.length;if(t.size===r)return;let s,a;for(let i=r-1;i>-1;i--){const l=n[i];if(t.has(l))a=l.index,t.delete(l);else{s=l.index;break}}if(t.size!==0){const i=Wc(s,a,t.size);o.push(...Array.from(t.values()).sort($n).map((l,c)=>({...l,index:i[c]})))}}function YU(t,n,o){var a;const r=n.length;if(t.size===r)return;let s={name:"skipping"};for(let i=0;i<r;i++){const l=t.has(n[i]);switch(s.name){case"skipping":{if(!l)continue;s={name:"selecting",selectIndex:i};break}case"selecting":{if(l)continue;const{selectIndex:c}=s;Wc(n[i].index,(a=n[i+1])==null?void 0:a.index,i-c).forEach((u,f)=>o.push({...n[c+f],index:u})),s={name:"skipping"};break}}}}function KU(t,n,o){var a;const r=n.length;if(t.size===r)return;let s={name:"skipping"};for(let i=r-1;i>-1;i--){const l=t.has(n[i]);switch(s.name){case"skipping":{if(!l)continue;s={name:"selecting",selectIndex:i};break}case"selecting":{if(l)continue;Wc((a=n[i-1])==null?void 0:a.index,n[i].index,s.selectIndex-i).forEach((c,u)=>{o.push({...n[i+u+1],index:c})}),s={name:"skipping"};break}}}}function sP({editor:t}){const n=t.getSelectedShapes(),o=t.getSelectionRotation(),r=t.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:s}}=t;if(!r)return null;const a=r.center.clone().rotWith(r.point,o);return{selectionPageCenter:a,initialCursorAngle:a.angle(s),initialSelectionRotation:o,shapeSnapshots:n.map(i=>({shape:wr(i),initialPagePoint:t.getShapePageTransform(i.id).point()}))}}function Pm({delta:t,editor:n,snapshot:o,stage:r}){const{selectionPageCenter:s,shapeSnapshots:a}=o;n.updateShapes(a.map(({shape:l,initialPagePoint:c})=>{const u=Zo(l.parentId)?n.getShapePageTransform(l.parentId):vt.Identity(),f=q.RotWith(c,s,t),h=vt.applyToPoint(vt.Inverse(u),f),d=za(l.rotation+t);return{id:l.id,type:l.type,x:h.x,y:h.y,rotation:d}}));const i=[];a.forEach(({shape:l})=>{var h,d,p;const c=n.getShape(l.id);if(!c)return;const u=n.getShapeUtil(l);if(r==="start"||r==="one-off"){const y=(h=u.onRotateStart)==null?void 0:h.call(u,l);y&&i.push(y)}const f=(d=u.onRotate)==null?void 0:d.call(u,l,c);if(f&&i.push(f),r==="end"||r==="one-off"){const y=(p=u.onRotateEnd)==null?void 0:p.call(u,l,c);y&&i.push(y)}}),i.length>0&&n.updateShapes(i)}const XU=t=>{const{store:n}=t,o=n.query.filterHistory("shape"),r=n.query.records("shape",()=>({type:{eq:"arrow"}}));function s(){const a=r.get(),i={};for(const l of a){const{start:c,end:u}=l.props;if(c.type==="binding"){const f=i[c.boundShapeId];f?f.push({arrowId:l.id,handleId:"start"}):i[c.boundShapeId]=[{arrowId:l.id,handleId:"start"}]}if(u.type==="binding"){const f=i[u.boundShapeId];f?f.push({arrowId:l.id,handleId:"end"}):i[u.boundShapeId]=[{arrowId:l.id,handleId:"end"}]}}return i}return Ye("arrowBindingsIndex",(a,i)=>{if(Al(a))return s();const l=a,c=o.getDiffSince(i);if(c===$o)return s();let u;function f(p){u||(u={...l}),u[p]?u[p]===l[p]&&(u[p]=[...u[p]]):u[p]=[]}function h(p,y,g){f(p),u[p]=u[p].filter(b=>b.arrowId!==y||b.handleId!==g),u[p].length===0&&delete u[p]}function d(p,y,g){f(p),u[p].push({arrowId:y,handleId:g})}for(const p of c){for(const y of Object.values(p.added))if(t.isShapeOfType(y,"arrow")){const{start:g,end:b}=y.props;g.type==="binding"&&d(g.boundShapeId,y.id,"start"),b.type==="binding"&&d(b.boundShapeId,y.id,"end")}for(const[y,g]of Object.values(p.updated))if(!(!t.isShapeOfType(y,"arrow")||!t.isShapeOfType(g,"arrow")))for(const b of["start","end"]){const m=y.props[b],v=g.props[b];m.type==="binding"&&v.type==="point"?h(m.boundShapeId,y.id,b):m.type==="point"&&v.type==="binding"?d(v.boundShapeId,g.id,b):m.type==="binding"&&v.type==="binding"&&m.boundShapeId!==v.boundShapeId&&(h(m.boundShapeId,y.id,b),d(v.boundShapeId,g.id,b))}for(const y of Object.values(p.removed))if(t.isShapeOfType(y,"arrow")){const{start:g,end:b}=y.props;g.type==="binding"&&h(g.boundShapeId,y.id,"start"),b.type==="binding"&&h(b.boundShapeId,y.id,"end")}}return u??l})};function QU(t,n,o){const r=t.getShapeMaskedPageBounds(n);return r===void 0?!0:!o.includes(r)}const ZU=t=>{const n=Number.isFinite(t.renderingBoundsMargin);function o(r){const s=r.getCurrentPageShapeIds(),a=r.getViewportPageBounds(),i=new Set;return s.forEach(l=>{QU(r,l,a)&&i.add(l)}),i}return Ye("getCulledShapes",r=>{if(!n)return new Set;if(Al(r))return o(t);const s=o(t);if(r.size!==s.size)return s;for(const a of r)if(!s.has(a))return s;return r})},JU=t=>{const n=t.query.ids("shape"),o=t.query.filterHistory("shape");function r(){const s={},a=n.get(),i=Array(a.size);return a.forEach(l=>i.push(t.get(l))),i.sort($n),i.forEach(l=>{s[l.parentId]||(s[l.parentId]=[]),s[l.parentId].push(l.id)}),s}return Ye("parentsToChildrenWithIndexes",(s,a)=>{if(Al(s))return r();const i=o.getDiffSince(a);if(i===$o)return r();if(i.length===0)return s;let l=null;const c=h=>{l||(l={...s}),l[h]?l[h]===s[h]&&(l[h]=[...l[h]]):l[h]=[]},u=new Set;let f;for(let h=0,d=i.length;h<d;h++){f=i[h];for(const p of Object.values(f.added))Yc(p)&&(c(p.parentId),l[p.parentId].push(p.id),u.add(l[p.parentId]));for(const[p,y]of Object.values(f.updated))if(Yc(y)&&Yc(p)){if(p.parentId!==y.parentId)c(p.parentId),c(y.parentId),l[p.parentId].splice(l[p.parentId].indexOf(y.id),1),l[y.parentId].push(y.id),u.add(l[y.parentId]);else if(p.index!==y.index){c(y.parentId);const g=l[y.parentId].indexOf(y.id);l[y.parentId][g]=y.id,u.add(l[y.parentId])}}for(const p of Object.values(f.removed))Yc(p)&&(c(p.parentId),l[p.parentId].splice(l[p.parentId].indexOf(p.id),1))}for(const h of u){const d=Lt(h.map(p=>t.get(p)));d.sort($n),h.splice(0,h.length,...d.map(p=>p.id))}return l??s})},a1=(t,n,o)=>{for(;!Io(o.parentId);){const r=t.get(o.parentId);if(!r)return!1;o=r}return o.parentId===n},eB=(t,n)=>{const o=t.query.ids("shape");let r=null;function s(){const a=n();return r=a,new Set([...o.get()].filter(i=>a1(t,a,t.get(i))))}return Ye("_shapeIdsInCurrentPage",(a,i)=>{if(Al(a))return s();const l=n();if(l!==r)return s();const c=t.history.getDiffSince(i);if(c===$o)return s();const u=new Df(a);for(const h of c){for(const d of Object.values(h.added))Yc(d)&&a1(t,l,d)&&u.add(d.id);for(const[d,p]of Object.values(h.updated))Yc(p)&&(a1(t,l,p)?u.add(p.id):u.remove(p.id));for(const d of Object.keys(h.removed))Zo(d)&&u.remove(d)}const f=u.get();return f?Bd(f.value,f.diff):a})},iP=z.createContext(null);function tB({context:t,editor:n,children:o}){return E.jsx(im.Provider,{value:n,children:E.jsx(iP.Provider,{value:t,children:o})})}function aP(){const t=z.useContext(iP);return t?{isDarkMode:t.isDarkMode}:null}async function rB(t,n,o={}){var w,S;const r=typeof n[0]=="string"?n:n.map(k=>k.id);if(r.length===0)return;if(!window.document)throw Error("No document");const{scale:s=1,background:a=!1,padding:i=B6,preserveAspectRatio:l=!1}=o,c=o.darkMode??t.user.getIsDarkMode(),u=Bi({isDarkMode:c}),f=t.getShapeAndDescendantIds(r),h=t.getUnorderedRenderingShapes(!1).filter(({id:k})=>f.has(k));let d=null;if(o.bounds)d=o.bounds;else for(const{id:k}of h){const _=t.getShapeMaskedPageBounds(k);_&&(d?d.union(_):d=_.clone())}if(!d)return;const p=r.length===1&&t.isShapeOfType(t.getShape(r[0]),"frame")?r[0]:null;p||d.expandBy(i);const y=d.width*s,g=d.height*s;try{(S=(w=document.body).focus)==null||S.call(w)}catch{}const b=[],m=new Map,v={isDarkMode:c,addExportDef:k=>{if(m.has(k.key))return;const _=(async()=>{const C=await k.getElement();C&&b.push(E.jsx(z.Fragment,{children:C},b.length))})();m.set(k.key,_)}},x=(await Promise.all(h.map(async({id:k,opacity:_,index:C,backgroundIndex:P})=>{var Y,$;if(k===p)return[];const A=t.getShape(k);if(t.isShapeOfType(A,"group"))return[];const I=t.getShapeUtil(A);let N=await((Y=I.toSvg)==null?void 0:Y.call(I,A,v)),O=await(($=I.toBackgroundSvg)==null?void 0:$.call(I,A,v));if(!N&&!O){const H=t.getShapePageBounds(A);N=E.jsx("rect",{width:H.w,height:H.h,fill:u.solid,stroke:u.grey.pattern,strokeWidth:1})}let F=t.getShapePageTransform(A).toCssString();"scale"in A.props&&A.props.scale!==1&&(F=`${F} scale(${A.props.scale}, ${A.props.scale})`),N&&(N=E.jsx("g",{transform:F,opacity:_,children:N},A.id)),O&&(O=E.jsx("g",{transform:F,opacity:_,children:O},`bg_${A.id}`));const U=t.getShapeMask(A.id);if(U){const H=`mask_${A.id.replace(":","_")}`;b.push(E.jsx("clipPath",{id:H,children:E.jsx("path",{d:`M${U.map(({x:Q,y:J})=>`${Q},${J}`).join("L")}Z`})},b.length)),N&&(N=E.jsx("g",{clipPath:`url(#${H})`,children:N},A.id)),O&&(O=E.jsx("g",{clipPath:`url(#${H})`,children:O},`bg_${A.id}`))}const G=[];return N&&G.push({zIndex:C,element:N}),O&&G.push({zIndex:P,element:O}),G}))).flat();return await Promise.all(m.values()),{jsx:E.jsx(tB,{editor:t,context:v,children:E.jsxs("svg",{preserveAspectRatio:l||void 0,direction:"ltr",width:y,height:g,viewBox:`${d.minX} ${d.minY} ${d.width} ${d.height}`,strokeLinecap:"round",strokeLinejoin:"round",style:{backgroundColor:a?p?u.solid:u.background:"transparent"},children:[E.jsx("defs",{children:b}),x.sort((k,_)=>k.zIndex-_.zIndex).map(({element:k})=>k)]})}),width:y,height:g}}const nB=40;class oB{constructor(n){R(this,"_clickId","");R(this,"_clickTimeout");R(this,"_clickScreenPoint");R(this,"_previousScreenPoint");R(this,"_getClickTimeout",(n,o=Ir())=>{this._clickId=o,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===n&&this._clickId===o){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},n==="idle"||n==="pendingDouble"?N6:U6)});R(this,"_clickState","idle");R(this,"lastPointerInfo",{});R(this,"transformPointerDownEvent",n=>{if(!this._clickState)return n;switch(this._clickScreenPoint=q.From(n.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>nB&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=n,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),n;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...n,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),n;default:return this._clickTimeout=this._getClickTimeout(this._clickState),n}});R(this,"transformPointerUpEvent",n=>{if(!this._clickState)return n;switch(this._clickScreenPoint=q.From(n.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return n}});R(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});R(this,"handleMove",()=>{this._clickState!=="idle"&&this._clickScreenPoint&&q.Dist2(this._clickScreenPoint,this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?Db:sh)&&this.cancelDoubleClickTimeout()});this.editor=n}get clickState(){return this._clickState}}class sB{constructor(n){R(this,"isSafari");R(this,"isIos");R(this,"isChromeForIos");R(this,"isFirefox");R(this,"isAndroid");this.editor=n,typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}}function zl(t){if(t){let n=lP;for(;t.length;)n=n.push(t.pop());return n}return lP}class iB{constructor(){R(this,"length",0);R(this,"head",null);R(this,"tail",this)}push(n){return new AS(n,this)}toArray(){return Li}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const lP=new iB;class AS{constructor(n,o){R(this,"length");this.head=n,this.tail=o,this.length=o.length+1}push(n){return new AS(n,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let n=this;return{next(){if(n.length){const o=n.head;return n=n.tail,{value:o,done:!1}}else return{value:void 0,done:!0}}}}}class aB{constructor(n,o){R(this,"_undos",fo("HistoryManager.undos",zl()));R(this,"_redos",fo("HistoryManager.redos",zl()));R(this,"_batchDepth",0);R(this,"onBatchComplete",()=>{});R(this,"_commands",{});R(this,"createCommand",(n,o,r)=>{if(this._commands[n])throw new Error(`Duplicate command: ${n}`);this._commands[n]=r;const s=(...a)=>{if(!this._batchDepth)return this.batch(()=>s(...a)),this.ctx;const i=o(...a);if(!i)return this.ctx;const{data:l,ephemeral:c,squashing:u,preservesRedoStack:f}=i;if(this.ignoringUpdates((h,d)=>(r.do(l),{undos:h,redos:d})),!c){const h=this._undos.get().head;u&&h&&h.type==="command"&&h.name===n&&h.preservesRedoStack===f?this._undos.update(d=>d.tail.push({...h,data:r.squash(h.data,l)})):this._undos.update(d=>d.push({type:"command",name:n,data:l,preservesRedoStack:f})),i.preservesRedoStack||this._redos.set(zl()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return s});R(this,"batch",n=>{try{this._batchDepth++,this._batchDepth===1?Ls(()=>{const o=this._undos.get().head;n(),o!==this._undos.get().head&&this.onBatchComplete()}):n()}catch(o){throw this.annotateError(o),o}finally{this._batchDepth--}return this});R(this,"ignoringUpdates",n=>{let o=this._undos.get(),r=this._redos.get();this._undos.set(zl()),this._redos.set(zl());try{({undos:o,redos:r}=Ls(()=>n(o,r)))}finally{this._undos.set(o),this._redos.set(r)}});R(this,"_undo",({pushToRedoStack:n,toMark:o=void 0})=>(this.ignoringUpdates((r,s)=>{var a;if(r.length===0)return{undos:r,redos:s};for(;((a=r.head)==null?void 0:a.type)==="STOP";){const i=r.head;if(r=r.tail,n&&(s=s.push(i)),i.id===o)return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:o}),{undos:r,redos:s}}if(r.length===0)return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:o}),{undos:r,redos:s};for(;r.head;){const i=r.head;if(r=r.tail,n&&(s=s.push(i)),i.type==="STOP"){if(i.onUndo&&(!o||i.id===o))return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:o}),{undos:r,redos:s}}else this._commands[i.name].undo(i.data)}return this.ctx.emit("change-history",n?{reason:"undo"}:{reason:"bail",markId:o}),{undos:r,redos:s}}),this));R(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));R(this,"redo",()=>(this.ignoringUpdates((n,o)=>{var r;if(o.length===0)return{undos:n,redos:o};for(;((r=o.head)==null?void 0:r.type)==="STOP";)n=n.push(o.head),o=o.tail;if(o.length===0)return this.ctx.emit("change-history",{reason:"redo"}),{undos:n,redos:o};for(;o.head;){const s=o.head;if(n=n.push(o.head),o=o.tail,s.type==="STOP"){if(s.onRedo)break}else{const a=this._commands[s.name];a.redo?a.redo(s.data):a.do(s.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:n,redos:o}}),this));R(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));R(this,"bailToMark",n=>(this._undo({pushToRedoStack:!1,toMark:n}),this));R(this,"mark",(n=Ir(),o=!0,r=!0)=>{const s=this._undos.get().head;return s&&s.type==="STOP"&&s.id===n&&s.onUndo===o&&s.onRedo===r?s.id:(this._undos.update(a=>a.push({type:"STOP",id:n,onUndo:o,onRedo:r})),this.ctx.emit("mark-history",{id:n}),n)});this.ctx=n,this.annotateError=o}getNumUndos(){return this._undos.get().length}getNumRedos(){return this._redos.get().length}clear(){this._undos.set(zl()),this._redos.set(zl())}}class lB{constructor(n){R(this,"scribbleItems",new Map);R(this,"state","paused");R(this,"addScribble",(n,o=Ir())=>{const r={id:o,scribble:{id:o,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...n,state:"starting"},timeoutMs:0,delayRemaining:n.delay??0,prev:null,next:null};return this.scribbleItems.set(o,r),r});R(this,"stop",n=>{const o=this.scribbleItems.get(n);if(!o)throw Error(`Scribble with id ${n} not found`);return o.delayRemaining=Math.min(o.delayRemaining,200),o.scribble.state="stopping",o});R(this,"addPoint",(n,o,r)=>{const s=this.scribbleItems.get(n);if(!s)throw Error(`Scribble with id ${n} not found`);const{prev:a}=s,i={x:o,y:r,z:.5};return(!a||q.Dist(a,i)>=1)&&(s.next=i),s});R(this,"tick",n=>{this.scribbleItems.size!==0&&this.editor.batch(()=>{this.scribbleItems.forEach(o=>{if(o.scribble.state==="starting"){const{next:c,prev:u}=o;c&&c!==u&&(o.prev=c,o.scribble.points.push(c)),o.scribble.points.length>8&&(o.scribble.state="active");return}o.delayRemaining>0&&(o.delayRemaining=Math.max(0,o.delayRemaining-n)),o.timeoutMs+=n,o.timeoutMs>=16&&(o.timeoutMs=0);const{delayRemaining:r,timeoutMs:s,prev:a,next:i,scribble:l}=o;switch(l.state){case"active":{i&&i!==a?(o.prev=i,l.points.push(i),r===0&&l.points.length>8&&l.points.shift()):s===0&&(l.points.length>1?l.points.shift():o.delayRemaining=l.delay);break}case"stopping":{if(o.delayRemaining===0&&s===0){if(l.points.length===1){this.scribbleItems.delete(o.id);return}l.shrink&&(l.size=Math.max(1,l.size*(1-l.shrink))),l.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:o})=>({...o,points:[...o.points]})).slice(-5)})})});this.editor=n}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear()}}class cB{constructor(n){R(this,"_beforeCreateHandlers",{});R(this,"_afterCreateHandlers",{});R(this,"_beforeChangeHandlers",{});R(this,"_afterChangeHandlers",{});R(this,"_beforeDeleteHandlers",{});R(this,"_afterDeleteHandlers",{});R(this,"_batchCompleteHandlers",[]);this.editor=n,n.store.onBeforeCreate=(r,s)=>{const a=this._beforeCreateHandlers[r.typeName];if(a){let i=r;for(const l of a)i=l(i,s);return i}return r},n.store.onAfterCreate=(r,s)=>{const a=this._afterCreateHandlers[r.typeName];if(a)for(const i of a)i(r,s)},n.store.onBeforeChange=(r,s,a)=>{const i=this._beforeChangeHandlers[s.typeName];if(i){let l=s;for(const c of i)l=c(r,l,a);return l}return s};let o=0;n.store.onAfterChange=(r,s,a)=>{if(o++,o>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{const i=this._afterChangeHandlers[s.typeName];if(i)for(const l of i)l(r,s,a)}o--},n.store.onBeforeDelete=(r,s)=>{const a=this._beforeDeleteHandlers[r.typeName];if(a){for(const i of a)if(i(r,s)===!1)return!1}},n.store.onAfterDelete=(r,s)=>{const a=this._afterDeleteHandlers[r.typeName];if(a)for(const i of a)i(r,s)},n.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach(r=>r())}}registerBeforeCreateHandler(n,o){return this._beforeCreateHandlers[n]||(this._beforeCreateHandlers[n]=[]),this._beforeCreateHandlers[n].push(o),()=>Gl(this._beforeCreateHandlers[n],o)}registerAfterCreateHandler(n,o){return this._afterCreateHandlers[n]||(this._afterCreateHandlers[n]=[]),this._afterCreateHandlers[n].push(o),()=>Gl(this._afterCreateHandlers[n],o)}registerBeforeChangeHandler(n,o){return this._beforeChangeHandlers[n]||(this._beforeChangeHandlers[n]=[]),this._beforeChangeHandlers[n].push(o),()=>Gl(this._beforeChangeHandlers[n],o)}registerAfterChangeHandler(n,o){return this._afterChangeHandlers[n]||(this._afterChangeHandlers[n]=[]),this._afterChangeHandlers[n].push(o),()=>Gl(this._afterChangeHandlers[n],o)}registerBeforeDeleteHandler(n,o){return this._beforeDeleteHandlers[n]||(this._beforeDeleteHandlers[n]=[]),this._beforeDeleteHandlers[n].push(o),()=>Gl(this._beforeDeleteHandlers[n],o)}registerAfterDeleteHandler(n,o){return this._afterDeleteHandlers[n]||(this._afterDeleteHandlers[n]=[]),this._afterDeleteHandlers[n].push(o),()=>Gl(this._afterDeleteHandlers[n],o)}registerBatchCompleteHandler(n){return this._batchCompleteHandlers.push(n),()=>Gl(this._batchCompleteHandlers,n)}}function Gl(t,n){const o=t.indexOf(n);o>=0&&t.splice(o,1)}var uB=Object.defineProperty,dB=Object.getOwnPropertyDescriptor,Mm=(t,n,o,r)=>{for(var s=r>1?void 0:r?dB(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&uB(n,o,s),s};const Tt=t=>Math.round(t*10**8)/10**8;function Hi(t,n,o,r,s){const a=t.filter(l=>(r==="forward"?l.startNode.id===n:l.endNode.id===n)&&Tt(l.length)===Tt(o)&&Fs(l.breadthIntersection[0],l.breadthIntersection[1],s[0],s[1]));if(a.length===0)return[];const i=new Set;return a.forEach(l=>{const c=r==="forward"?l.endNode.id:l.startNode.id;if(!i.has(c)){i.add(c);const u=Hi(t,c,o,r,Fs(l.breadthIntersection[0],l.breadthIntersection[1],s[0],s[1]));a.push(...u)}}),a}function hB(t){t.sort((n,o)=>o.gaps.length-n.gaps.length);for(let n=t.length-1;n>0;n--){const o=t[n];for(let r=n-1;r>=0;r--){const s=t[r];if(s.direction===o.direction&&o.gaps.every(a=>s.gaps.some(i=>Tt(a.startEdge[0].x)===Tt(i.startEdge[0].x)&&Tt(a.startEdge[0].y)===Tt(i.startEdge[0].y)&&Tt(a.startEdge[1].x)===Tt(i.startEdge[1].x)&&Tt(a.startEdge[1].y)===Tt(i.startEdge[1].y))&&s.gaps.some(i=>Tt(a.endEdge[0].x)===Tt(i.endEdge[0].x)&&Tt(a.endEdge[0].y)===Tt(i.endEdge[0].y)&&Tt(a.endEdge[1].x)===Tt(i.endEdge[1].x)&&Tt(a.endEdge[1].y)===Tt(i.endEdge[1].y)))){t.splice(n,1);break}}}}class ph{constructor(n){R(this,"editor");this.manager=n,this.editor=n.editor}getSnapPointsCache(){const{editor:n}=this;return n.store.createComputedCache("snapPoints",o=>{const r=n.getShapePageTransform(o.id);if(!r)return;const s=n.getShapeUtil(o).getBoundsSnapGeometry(o).points??n.getShapeGeometry(o).bounds.cornersAndCenter;if(!(!r||!s))return s.map((a,i)=>{const{x:l,y:c}=vt.applyToPoint(r,a);return{x:l,y:c,id:`${o.id}:${i}`}})})}getSnapPoints(n){return this.getSnapPointsCache().get(n)??[]}getSnappablePoints(){const n=this.getSnapPointsCache(),o=this.manager.getSnappableShapes(),r=[];for(const s of o){const a=n.get(s);a&&r.push(...a)}return r}getSnappableGapNodes(){return Array.from(this.manager.getSnappableShapes(),n=>({id:n,pageBounds:Ol(this.editor.getShapePageBounds(n))}))}getVisibleGaps(){const n=[],o=[];let r,s;const a=this.getSnappableGapNodes().sort((l,c)=>l.pageBounds.minX-c.pageBounds.minX);for(let l=0;l<a.length;l++){r=a[l];for(let c=l+1;c<a.length;c++)s=a[c],r.pageBounds.maxX<s.pageBounds.minX&&nh(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)&&n.push({startNode:r,endNode:s,startEdge:[new q(r.pageBounds.maxX,r.pageBounds.minY),new q(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new q(s.pageBounds.minX,s.pageBounds.minY),new q(s.pageBounds.minX,s.pageBounds.maxY)],length:s.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:Fs(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)})}const i=a.sort((l,c)=>l.pageBounds.minY-c.pageBounds.minY);for(let l=0;l<i.length;l++){r=i[l];for(let c=l+1;c<i.length;c++)s=i[c],r.pageBounds.maxY<s.pageBounds.minY&&nh(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)&&o.push({startNode:r,endNode:s,startEdge:[new q(r.pageBounds.minX,r.pageBounds.maxY),new q(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new q(s.pageBounds.minX,s.pageBounds.minY),new q(s.pageBounds.maxX,s.pageBounds.minY)],length:s.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:Fs(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)})}return{horizontal:n,vertical:o}}snapTranslateShapes({lockedAxis:n,initialSelectionPageBounds:o,initialSelectionSnapPoints:r,dragDelta:s}){var b,m;const a=this.manager.getSnapThreshold(),i=this.getSnappablePoints(),l=o.clone().translate(s),c=r.map(({x:v,y:x},w)=>({id:"selection:"+w,x:v+s.x,y:x+s.y})),u=i,f=[],h=[],d=new q(a,a);this.collectPointSnaps({minOffset:d,nearestSnapsX:f,nearestSnapsY:h,otherNodeSnapPoints:u,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h,minOffset:d});const p=new q(n==="x"?0:((b=f[0])==null?void 0:b.nudge)??0,n==="y"?0:((m=h[0])==null?void 0:m.nudge)??0);d.x=0,d.y=0,f.length=0,h.length=0,c.forEach(v=>{v.x+=p.x,v.y+=p.y}),l.translate(p),this.collectPointSnaps({minOffset:d,nearestSnapsX:f,nearestSnapsY:h,otherNodeSnapPoints:u,selectionSnapPoints:c}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h,minOffset:d});const y=this.getPointSnapLines({nearestSnapsX:f,nearestSnapsY:h}),g=this.getGapSnapLines({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:h});return this.manager.setIndicators([...g,...y]),{nudge:p}}snapResizeShapes({initialSelectionPageBounds:n,dragDelta:o,handle:r,isAspectRatioLocked:s,isResizingFromCenter:a}){var _,C;const i=this.manager.getSnapThreshold(),{box:l,scaleX:c,scaleY:u}=mt.Resize(n,r,a?o.x*2:o.x,a?o.y*2:o.y,s);let f=r;c<0&&(f=IF(f)),u<0&&(f=TF(f)),a&&(l.center=n.center);const h=f==="top"||f==="bottom",d=f==="left"||f==="right",p=cP(f,l),y=this.getSnappablePoints(),g=[],b=[],m=new q(i,i);this.collectPointSnaps({minOffset:m,nearestSnapsX:g,nearestSnapsY:b,otherNodeSnapPoints:y,selectionSnapPoints:p});const v=new q(h?0:((_=g[0])==null?void 0:_.nudge)??0,d?0:((C=b[0])==null?void 0:C.nudge)??0);if(s&&AF(f)&&v.len()!==0){const P=g.length&&b.length?Math.abs(v.x)<Math.abs(v.y)?"x":"y":g.length?"x":"y",A=n.aspectRatio;P==="x"?(b.length=0,v.y=v.x/A,(f==="bottom_left"||f==="top_right")&&(v.y=-v.y)):(g.length=0,v.x=v.y*A,(f==="bottom_left"||f==="top_right")&&(v.x=-v.x))}const x=q.Add(o,v),{box:w}=mt.Resize(n,r,a?x.x*2:x.x,a?x.y*2:x.y,s);a&&(w.center=n.center);const S=cP("any",w);g.length=0,b.length=0,m.x=0,m.y=0,this.collectPointSnaps({minOffset:m,nearestSnapsX:g,nearestSnapsY:b,otherNodeSnapPoints:y,selectionSnapPoints:S});const k=this.getPointSnapLines({nearestSnapsX:g,nearestSnapsY:b});return this.manager.setIndicators([...k]),{nudge:v}}collectPointSnaps({selectionSnapPoints:n,otherNodeSnapPoints:o,minOffset:r,nearestSnapsX:s,nearestSnapsY:a}){for(const i of n)for(const l of o){const c=q.Sub(i,l),u=Math.abs(c.x),f=Math.abs(c.y);Tt(u)<=Tt(r.x)&&(Tt(u)<Tt(r.x)&&(s.length=0),s.push({type:"points",points:{thisPoint:i,otherPoint:l},nudge:l.x-i.x}),r.x=u),Tt(f)<=Tt(r.y)&&(Tt(f)<Tt(r.y)&&(a.length=0),a.push({type:"points",points:{thisPoint:i,otherPoint:l},nudge:l.y-i.y}),r.y=f)}}collectGapSnaps({selectionPageBounds:n,minOffset:o,nearestSnapsX:r,nearestSnapsY:s}){const{horizontal:a,vertical:i}=this.getVisibleGaps();for(const l of a){if(!nh(l.breadthIntersection[0],l.breadthIntersection[1],n.minY,n.maxY))continue;const c=l.startEdge[0].x+l.length/2-n.center.x;if(l.length>n.width&&Tt(Math.abs(c))<=Tt(o.x)){Tt(Math.abs(c))<Tt(o.x)&&(r.length=0),o.x=Math.abs(c);const g={type:"gap_center",gap:l,nudge:c},b=r.find(({type:v})=>v==="gap_center"),m=b&&Fs(l.breadthIntersection[0],l.breadthIntersection[1],b.gap.breadthIntersection[0],b.gap.breadthIntersection[1]);b&&b.gap.length>l.length&&m?r[r.indexOf(b)]=g:(!b||!m)&&r.push(g)}const u=l.startNode.pageBounds.minX-l.length,f=n.maxX,h=u-f;Tt(Math.abs(h))<=Tt(o.x)&&(Tt(Math.abs(h))<Tt(o.x)&&(r.length=0),o.x=Math.abs(h),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"left",nudge:h}));const d=l.endNode.pageBounds.maxX+l.length,p=n.minX,y=d-p;Tt(Math.abs(y))<=Tt(o.x)&&(Tt(Math.abs(y))<Tt(o.x)&&(r.length=0),o.x=Math.abs(y),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"right",nudge:y}))}for(const l of i){if(!nh(l.breadthIntersection[0],l.breadthIntersection[1],n.minX,n.maxX))continue;const c=l.startEdge[0].y+l.length/2-n.center.y;if(l.length>n.height&&Tt(Math.abs(c))<=Tt(o.y)){Tt(Math.abs(c))<Tt(o.y)&&(s.length=0),o.y=Math.abs(c);const g={type:"gap_center",gap:l,nudge:c},b=s.find(({type:v})=>v==="gap_center"),m=b&&nh(b.gap.breadthIntersection[0],b.gap.breadthIntersection[1],l.breadthIntersection[0],l.breadthIntersection[1]);b&&b.gap.length>l.length&&m?s[s.indexOf(b)]=g:(!b||!m)&&s.push(g);continue}const u=l.startNode.pageBounds.minY-l.length,f=n.maxY,h=u-f;Tt(Math.abs(h))<=Tt(o.y)&&(Tt(Math.abs(h))<Tt(o.y)&&(s.length=0),o.y=Math.abs(h),s.push({type:"gap_duplicate",gap:l,protrusionDirection:"top",nudge:h}));const d=l.endNode.pageBounds.maxY+l.length,p=n.minY,y=d-p;Tt(Math.abs(y))<=Tt(o.y)&&(Tt(Math.abs(y))<Tt(o.y)&&(s.length=0),o.y=Math.abs(y),s.push({type:"gap_duplicate",gap:l,protrusionDirection:"bottom",nudge:y}))}}getPointSnapLines({nearestSnapsX:n,nearestSnapsY:o}){const r={},s={};if(n.length>0){for(const a of n)if(a.type==="points"){const i=Tt(a.points.otherPoint.x);r[i]||(r[i]=[]),r[i].push(a.points)}}if(o.length>0){for(const a of o)if(a.type==="points"){const i=Tt(a.points.otherPoint.y);s[i]||(s[i]=[]),s[i].push(a.points)}}return Object.values(r).concat(Object.values(s)).map(a=>({id:Ir(),type:"points",points:Ff(a.map(i=>q.From(i.otherPoint)).concat(a.map(i=>q.From(i.thisPoint))),(i,l)=>i.equals(l))}))}getGapSnapLines({selectionPageBounds:n,nearestSnapsX:o,nearestSnapsY:r}){const{vertical:s,horizontal:a}=this.getVisibleGaps(),i={top:n.sides[0],right:n.sides[1],bottom:[n.corners[3],n.corners[2]],left:[n.corners[0],n.corners[3]]},l=[];if(o.length>0)for(const c of o){if(c.type==="points")continue;const{gap:{breadthIntersection:u,startEdge:f,startNode:h,endNode:d,length:p,endEdge:y}}=c;switch(c.type){case"gap_center":{const g=(p-n.width)/2,b=Fs(u[0],u[1],n.minY,n.maxY);l.push({type:"gaps",direction:"horizontal",id:Ir(),gaps:[...Hi(a,h.id,g,"backward",b),{startEdge:f,endEdge:i.left},{startEdge:i.right,endEdge:y},...Hi(a,d.id,g,"forward",b)]});break}case"gap_duplicate":{const g=Fs(u[0],u[1],n.minY,n.maxY);l.push({type:"gaps",direction:"horizontal",id:Ir(),gaps:c.protrusionDirection==="left"?[{startEdge:i.right,endEdge:f.map(b=>b.clone().addXY(-h.pageBounds.width,0))},{startEdge:f,endEdge:y},...Hi(a,d.id,p,"forward",g)]:[...Hi(a,h.id,p,"backward",g),{startEdge:f,endEdge:y},{startEdge:y.map(b=>b.clone().addXY(c.gap.endNode.pageBounds.width,0)),endEdge:i.left}]});break}}}if(r.length>0)for(const c of r){if(c.type==="points")continue;const{gap:{breadthIntersection:u,startEdge:f,startNode:h,endNode:d,length:p,endEdge:y}}=c;switch(c.type){case"gap_center":{const g=(p-n.height)/2,b=Fs(u[0],u[1],n.minX,n.maxX);l.push({type:"gaps",direction:"vertical",id:Ir(),gaps:[...Hi(s,h.id,g,"backward",b),{startEdge:f,endEdge:i.top},{startEdge:i.bottom,endEdge:y},...Hi(s,c.gap.endNode.id,g,"forward",b)]});break}case"gap_duplicate":{const g=Fs(u[0],u[1],n.minX,n.maxX);l.push({type:"gaps",direction:"vertical",id:Ir(),gaps:c.protrusionDirection==="top"?[{startEdge:i.bottom,endEdge:f.map(b=>b.clone().addXY(0,-h.pageBounds.height))},{startEdge:f,endEdge:y},...Hi(s,d.id,p,"forward",g)]:[...Hi(s,h.id,p,"backward",g),{startEdge:f,endEdge:y},{startEdge:y.map(b=>b.clone().addXY(0,d.pageBounds.height)),endEdge:i.top}]})}break}}return hB(l),l}}Mm([Ye],ph.prototype,"getSnapPointsCache",1),Mm([Ye],ph.prototype,"getSnappablePoints",1),Mm([Ye],ph.prototype,"getSnappableGapNodes",1),Mm([Ye],ph.prototype,"getVisibleGaps",1);function cP(t,n){const{minX:o,maxX:r,minY:s,maxY:a}=n,i=[];switch(t){case"top":case"left":case"top_left":case"any":i.push({id:"top_left",handle:"top_left",x:o,y:s})}switch(t){case"top":case"right":case"top_right":case"any":i.push({id:"top_right",handle:"top_right",x:r,y:s})}switch(t){case"bottom":case"right":case"bottom_right":case"any":i.push({id:"bottom_right",handle:"bottom_right",x:r,y:a})}switch(t){case"bottom":case"left":case"bottom_left":case"any":i.push({id:"bottom_left",handle:"bottom_left",x:o,y:a})}return i}var pB=Object.defineProperty,fB=Object.getOwnPropertyDescriptor,mB=(t,n,o,r)=>{for(var s=r>1?void 0:r?fB(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&pB(n,o,s),s};const gB=()=>null,yB=()=>[];class uP{constructor(n){R(this,"editor");this.manager=n,this.editor=n.editor}getSnapGeometryCache(){const{editor:n}=this;return n.store.createComputedCache("handle snap geometry",o=>{const r=n.getShapeUtil(o).getHandleSnapGeometry(o);return{outline:r.outline===void 0?n.getShapeGeometry(o):r.outline,points:r.points??[],getSelfSnapOutline:r.getSelfSnapOutline??gB,getSelfSnapPoints:r.getSelfSnapPoints??yB}})}*iterateSnapPointsInPageSpace(n,o){var s,a;const r=(s=this.getSnapGeometryCache().get(n))==null?void 0:s.getSelfSnapPoints(o);if(r&&r.length){const i=Ol(this.editor.getShapePageTransform(n));for(const l of r)yield i.applyToPoint(l)}for(const i of this.manager.getSnappableShapes()){if(i===n)continue;const l=(a=this.getSnapGeometryCache().get(i))==null?void 0:a.points;if(!l||!l.length)continue;const c=Ol(this.editor.getShapePageTransform(i));for(const u of l)yield c.applyToPoint(u)}}*iterateSnapOutlines(n,o){var s,a;const r=(s=this.getSnapGeometryCache().get(n))==null?void 0:s.getSelfSnapOutline(o);r&&(yield{shapeId:n,outline:r});for(const i of this.manager.getSnappableShapes()){if(i===n)continue;const l=(a=this.getSnapGeometryCache().get(i))==null?void 0:a.outline;l&&(yield{shapeId:i,outline:l})}}getHandleSnapPosition({currentShapeId:n,handle:o,handleInPageSpace:r}){const s=this.manager.getSnapThreshold();let a=s,i=null;for(const u of this.iterateSnapPointsInPageSpace(n,o))q.DistMin(r,u,a)&&(a=q.Dist(r,u),i=u);if(i)return i;let l=s,c=null;for(const{shapeId:u,outline:f}of this.iterateSnapOutlines(n,o)){const h=Ol(this.editor.getShapePageTransform(u)),d=this.editor.getPointInShapeSpace(u,r),p=f.nearestPoint(d),y=h.applyToPoint(p);q.DistMin(r,y,l)&&(l=q.Dist(r,y),c=y)}return c||null}snapHandle({currentShapeId:n,handle:o}){const r=Ol(this.editor.getShapePageTransform(n)).applyToPoint(o),s=this.getHandleSnapPosition({currentShapeId:n,handle:o,handleInPageSpace:r});return s?(this.manager.setIndicators([{id:Ir(),type:"points",points:[s]}]),{nudge:q.Sub(s,r)}):null}}mB([Ye],uP.prototype,"getSnapGeometryCache",1);var vB=Object.defineProperty,bB=Object.getOwnPropertyDescriptor,l1=(t,n,o,r)=>{for(var s=r>1?void 0:r?bB(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&vB(n,o,s),s};class Tm{constructor(n){R(this,"shapeBounds");R(this,"handles");R(this,"_snapIndicators",fo("snapLines",void 0));this.editor=n,this.shapeBounds=new ph(this),this.handles=new uP(this)}getIndicators(){return this._snapIndicators.get()??Li}clearIndicators(){this.getIndicators().length&&this._snapIndicators.set(void 0)}setIndicators(n){this._snapIndicators.set(n)}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:n}=this,o=n.getRenderingBounds(),r=n.getSelectedShapeIds(),s=new Set,a=i=>{if(Zo(i)){const c=n.getShape(i);c&&n.isShapeOfType(c,"frame")&&s.add(i)}const l=n.getSortedChildIdsForParent(i);for(const c of l){if(r.includes(c))continue;const u=n.getShape(c);if(!u||!n.getShapeUtil(u).canSnap(u))continue;const f=n.getShapePageBounds(c);if(f&&o.includes(f)){if(n.isShapeOfType(u,"group")){a(c);continue}s.add(c)}}};return a(this.getCurrentCommonAncestor()??n.getCurrentPageId()),s}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}}l1([Ye],Tm.prototype,"getSnapThreshold",1),l1([Ye],Tm.prototype,"getSnappableShapes",1),l1([Ye],Tm.prototype,"getCurrentCommonAncestor",1);const xB=/\r?\n|\r/g;function dP(t){return t.replace(xB,`
`).split(`
`).map(n=>n||" ").join(`
`)}const wB={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},SB=/\s/;class jB{constructor(n){R(this,"baseElm");R(this,"measureText",(n,o)=>{var i;const r=(i=this.baseElm)==null?void 0:i.cloneNode();this.baseElm.insertAdjacentElement("afterend",r),r.setAttribute("dir","ltr"),r.style.setProperty("font-family",o.fontFamily),r.style.setProperty("font-style",o.fontStyle),r.style.setProperty("font-weight",o.fontWeight),r.style.setProperty("font-size",o.fontSize+"px"),r.style.setProperty("line-height",o.lineHeight*o.fontSize+"px"),r.style.setProperty("max-width",o.maxWidth===null?null:o.maxWidth+"px"),r.style.setProperty("min-width",o.minWidth===null?null:o.minWidth+"px"),r.style.setProperty("padding",o.padding),r.style.setProperty("overflow-wrap",o.disableOverflowWrapBreaking?"normal":"break-word"),r.textContent=dP(n);const s=r.scrollWidth,a=r.getBoundingClientRect();return r.remove(),{x:0,y:0,w:a.width,h:a.height,scrollWidth:s}});var s;this.editor=n;const o=this.editor.getContainer();(s=o.querySelector("#tldraw_text_measure"))==null||s.remove();const r=document.createElement("div");r.id="tldraw_text_measure",r.classList.add("tl-text"),r.classList.add("tl-text-measure"),r.tabIndex=-1,o.appendChild(r),this.baseElm=r}measureElementTextNodeSpans(n,{shouldTruncateToFirstLine:o=!1}={}){const r=[],s=n.getBoundingClientRect(),a=-s.left,i=-s.top,l=new Range,c=n.childNodes[0];let u=0,f=null,h=null,d=0,p=!1;for(const y of n.childNodes)if(y.nodeType===Node.TEXT_NODE)for(const g of y.textContent??""){l.setStart(c,u),l.setEnd(c,u+g.length);const b=l.getClientRects(),m=b[b.length-1],v=m.top+i,x=m.left+a,w=m.right+a,S=SB.test(g);if(S!==h||v!==d||!f){if(f){if(o&&v!==d){p=!0;break}r.push(f)}f={box:{x,y:v,w:m.width,h:m.height},text:g}}else f.box.w=w-f.box.x,f.text+=g;h=S,d=v,u+=g.length}return f&&r.push(f),{spans:r,didTruncate:p}}measureTextSpans(n,o){var u;if(n==="")return[];const r=(u=this.baseElm)==null?void 0:u.cloneNode();this.baseElm.insertAdjacentElement("afterend",r);const s=Math.ceil(o.width-o.padding*2);r.style.setProperty("width",`${s}px`),r.style.setProperty("height","min-content"),r.style.setProperty("dir","ltr"),r.style.setProperty("font-size",`${o.fontSize}px`),r.style.setProperty("font-family",o.fontFamily),r.style.setProperty("font-weight",o.fontWeight),r.style.setProperty("line-height",`${o.lineHeight*o.fontSize}px`),r.style.setProperty("text-align",wB[o.textAlign]);const a=o.overflow==="truncate-ellipsis"||o.overflow==="truncate-clip";a&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all"));const i=dP(n);r.textContent=i;const{spans:l,didTruncate:c}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:a});if(o.overflow==="truncate-ellipsis"&&c){r.textContent="\u2026";const f=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${s-f}px`),r.textContent=i;const h=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,d=h[h.length-1];return h.push({text:"\u2026",box:{x:Math.min(d.box.x+d.box.w,o.width-o.padding-f),y:d.box.y,w:f,h:d.box.h}}),h}return r.remove(),l}}const hP=(typeof process<"u",Fk);class _B{constructor(n){R(this,"cancelRaf");R(this,"isPaused",!0);R(this,"now",0);R(this,"start",()=>{var n;this.isPaused=!1,(n=this.cancelRaf)==null||n.call(this),this.cancelRaf=hP(this.tick),this.now=Date.now()});R(this,"tick",()=>{if(this.isPaused)return;const n=Date.now(),o=n-this.now;this.now=n,this.updatePointerVelocity(o),this.editor.emit("frame",o),this.editor.emit("tick",o),this.cancelRaf=hP(this.tick)});R(this,"dispose",()=>{var n;this.isPaused=!0,(n=this.cancelRaf)==null||n.call(this)});R(this,"prevPoint",new q);R(this,"updatePointerVelocity",n=>{const{prevPoint:o,editor:{inputs:{currentScreenPoint:r,pointerVelocity:s}}}=this;if(n===0)return;const a=q.Sub(r,o);this.prevPoint=r.clone();const i=a.len(),l=i?a.div(i):new q(0,0),c=s.clone().lrp(l.mul(i/n),.5);Math.abs(c.x)<.01&&(c.x=0),Math.abs(c.y)<.01&&(c.y=0),s.equals(c)||(this.editor.inputs.pointerVelocity=c)});this.editor=n,this.editor.disposables.add(this.dispose),this.start()}}var kB=Object.defineProperty,EB=Object.getOwnPropertyDescriptor,ii=(t,n,o,r)=>{for(var s=r>1?void 0:r?EB(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&kB(n,o,s),s};class Bs{constructor(n,o){R(this,"updateUserPreferences",n=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...n})});this.user=n,this.inferDarkMode=o}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode(),isDarkMode:this.getIsDarkMode(),isWrapMode:this.getIsWrapMode()}}getIsDarkMode(){return this.user.userPreferences.get().isDarkMode??(this.inferDarkMode?MU():!1)}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??Ul.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??Ul.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??Ul.name}getLocale(){return this.user.userPreferences.get().locale??Ul.locale}getColor(){return this.user.userPreferences.get().color??Ul.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??Ul.isSnapMode}getIsWrapMode(){return this.user.userPreferences.get().isWrapMode??Ul.isWrapMode}}ii([Ye],Bs.prototype,"getUserPreferences",1),ii([Ye],Bs.prototype,"getIsDarkMode",1),ii([Ye],Bs.prototype,"getEdgeScrollSpeed",1),ii([Ye],Bs.prototype,"getAnimationSpeed",1),ii([Ye],Bs.prototype,"getId",1),ii([Ye],Bs.prototype,"getName",1),ii([Ye],Bs.prototype,"getLocale",1),ii([Ye],Bs.prototype,"getColor",1),ii([Ye],Bs.prototype,"getIsSnapMode",1),ii([Ye],Bs.prototype,"getIsWrapMode",1);function fh(t){return Math.abs(t.props.bend)<8}function Im(t,n){if(n.type==="point")return;const o=t.getShape(n.boundShapeId),r=t.getShapePageTransform(o),s=t.getShapeGeometry(o),a=s instanceof Ns?s.children[0].vertices:s.vertices;return{shape:o,transform:r,isClosed:s.isClosed,isExact:n.isExact,didIntersect:!1,outline:a}}function pP(t,n,o,r){if(o.type==="point")return q.From(o);const s=t.getShape(o.boundShapeId);if(s){const{point:a,size:i}=t.getShapeGeometry(s).bounds,l=q.Add(a,q.MulV(o.isPrecise||r?o.normalizedAnchor:{x:.5,y:.5},i)),c=vt.applyToPoint(t.getShapePageTransform(s),l);return vt.applyToPoint(vt.Inverse(n),c)}else return new q(0,0)}function zs(t,n){const o=t.getShapePageTransform(n);let r,s;n.props.start.type==="binding"&&n.props.end.type==="binding"&&(r=n.props.start.boundShapeId,s=n.props.end.boundShapeId);const a=c1(t,r,s),i=pP(t,o,n.props.start,a==="double-bound"||a==="start-contains-end"),l=pP(t,o,n.props.end,a==="double-bound"||a==="end-contains-start");return{start:i,end:l}}const au=10,Am=10,CB=10,Wa={s:2,m:3.5,l:5,xl:10};function c1(t,n,o){if(!n||!o)return"safe";if(n===o)return"double-bound";const r=t.getShapePageBounds(n),s=t.getShapePageBounds(o);if(r&&s){if(r.contains(s))return"start-contains-end";if(s.contains(r))return"end-contains-start"}return"safe"}function mh(t,n){const{start:o,end:r,arrowheadStart:s,arrowheadEnd:a}=n.props,i=zs(t,n),l=i.start.clone(),c=i.end.clone(),u=q.Med(l,c);if(q.Equals(l,c))return{isStraight:!0,start:{handle:l,point:l,arrowhead:n.props.arrowheadStart},end:{handle:c,point:c,arrowhead:n.props.arrowheadEnd},middle:u,isValid:!1,length:0};const f=q.Sub(c,l).uni(),h=Im(t,o),d=Im(t,r),p=t.getShapePageTransform(n);fP(c,i.start,p,d),fP(l,i.end,p,h);let y=0,g=0,b=0,m=0,v=au;const x=h&&d&&h.shape===d.shape,w=h&&d?c1(t,h.shape.id,d.shape.id):"safe";w==="safe"&&h&&d&&!x&&!h.isExact&&!d.isExact&&(d.didIntersect&&!h.didIntersect?h.isClosed&&l.setTo(c.clone().add(f.clone().mul(au))):d.didIntersect||d.isClosed&&c.setTo(l.clone().sub(f.clone().mul(au))));const S=q.Sub(c,l),k=q.Len(S)?S.uni():q.From(S),_=!q.Equals(k,f);x||(w!=="start-contains-end"&&h&&s!=="none"&&!h.isExact&&(b=Wa[n.props.size]/2+("size"in h.shape.props?Wa[h.shape.props.size]/2:0),y=Am+b,v+=b),w!=="end-contains-start"&&d&&a!=="none"&&!d.isExact&&(m=Wa[n.props.size]/2+("size"in d.shape.props?Wa[d.shape.props.size]/2:0),g=Am+m,v+=m));const C=l.clone().add(k.clone().mul(y*(_?-1:1))),P=c.clone().sub(k.clone().mul(g*(_?-1:1)));q.DistMin(C,P,v)&&(y!==0&&g!==0?(y*=-1.5,g*=-1.5):y!==0?y*=-1:g!==0&&(g*=-1)),l.add(k.clone().mul(y*(_?-1:1))),c.sub(k.clone().mul(g*(_?-1:1))),_?(h&&d&&c.setTo(q.Add(l,k.clone().mul(-au))),u.setTo(q.Med(i.start,i.end))):u.setTo(q.Med(l,c));const A=q.Dist(l,c);return{isStraight:!0,start:{handle:i.start,point:l,arrowhead:n.props.arrowheadStart},end:{handle:i.end,point:c,arrowhead:n.props.arrowheadEnd},middle:u,isValid:A>0,length:A}}function fP(t,n,o,r){if(r===void 0||r.isExact)return;const s=vt.applyToPoint(o,n),a=vt.applyToPoint(o,t),i=vt.applyToPoint(vt.Inverse(r.transform),s),l=vt.applyToPoint(vt.Inverse(r.transform),a),c=r.isClosed,u=(c?r1:FU)(i,l,r.outline);let f;if(u!==null&&(f=u.sort((p,y)=>q.Dist2(p,i)-q.Dist2(y,i))[0]??(c?void 0:l)),f===void 0)return;const h=vt.applyToPoint(r.transform,f),d=vt.applyToPoint(vt.Inverse(o),h);t.setTo(d),r.didIntersect=!0}function u1(t,n,o=0){const{arrowheadEnd:r,arrowheadStart:s}=n.props,a=n.props.bend+o;if(Math.abs(a)>Math.abs(n.props.bend*CB))return mh(t,n);const i=zs(t,n),l=q.Med(i.start,i.end),c=q.Sub(i.end,i.start),u=q.Len(c)?c.uni():q.From(c),f=q.Add(l,u.per().mul(-a)),h=Im(t,n.props.start),d=Im(t,n.props.end),p=i.start.clone(),y=i.end.clone(),g=f.clone();if(q.Equals(p,y))return{isStraight:!0,start:{handle:p,point:p,arrowhead:n.props.arrowheadStart},end:{handle:y,point:y,arrowhead:n.props.arrowheadEnd},middle:g,isValid:!1,length:0};const b=n.props.bend<0,m=b?rh:BE,v=mP(p,y,g),x=q.Angle(v.center,p),w=q.Angle(v.center,y),S=m(x,w);if(v.length===0||v.size===0||!VE(v.length)||!VE(v.size))return mh(t,n);const k=p.clone(),_=y.clone(),C=g.clone(),P=t.getShapePageTransform(n);let A=0,I=0,N=au;if(h&&!h.isExact){const Q=vt.applyToPoint(P,k),J=vt.applyToPoint(P,v.center),ae=vt.applyToPoint(P,_),T=vt.Inverse(h.transform),B=vt.applyToPoint(T,Q),W=vt.applyToPoint(T,J),K=vt.applyToPoint(T,ae),{isClosed:te}=h,ne=te?n1:ZC;let ce,fe=ne(W,v.radius,h.outline);if(fe){const ue=W.angle(B),ge=W.angle(K),me=m(ue,ge);fe=fe.filter(de=>m(ue,W.angle(de))<=me);const oe=me*.25;fe.sort(te?(de,xe)=>Math.abs(m(ue,W.angle(de))-oe)<Math.abs(m(ue,W.angle(xe))-oe)?-1:1:(de,xe)=>m(ue,W.angle(de))<m(ue,W.angle(xe))?-1:1),ce=fe[0]??(te?void 0:B)}else ce=te?void 0:B;if(ce&&(k.setTo(t.getPointInShapeSpace(n,vt.applyToPoint(h.transform,ce))),h.didIntersect=!0,s!=="none")){const ue=Wa[n.props.size]/2+("size"in h.shape.props?Wa[h.shape.props.size]/2:0);A=Am+ue,N+=ue}}if(d&&!d.isExact){const Q=vt.applyToPoint(P,k),J=vt.applyToPoint(P,_),ae=vt.applyToPoint(P,v.center),T=vt.Inverse(d.transform),B=vt.applyToPoint(T,Q),W=vt.applyToPoint(T,ae),K=vt.applyToPoint(T,J),te=d.isClosed,ne=te?n1:ZC;let ce,fe=ne(W,v.radius,d.outline);if(fe){const ue=W.angle(B),ge=W.angle(K),me=m(ue,ge),oe=me*.75;fe=fe.filter(de=>m(ue,W.angle(de))<=me),fe.sort(te?(de,xe)=>Math.abs(m(ue,W.angle(de))-oe)<Math.abs(m(ue,W.angle(xe))-oe)?-1:1:(de,xe)=>m(ue,W.angle(de))<m(ue,W.angle(xe))?-1:1),fe[0]?ce=fe[0]:ce=te?void 0:K}else ce=te?void 0:K;if(ce&&(_.setTo(t.getPointInShapeSpace(n,vt.applyToPoint(d.transform,ce))),d.didIntersect=!0,r!=="none")){const ue=Wa[n.props.size]/2+("size"in d.shape.props?Wa[d.shape.props.size]/2:0);I=Am+ue,N+=ue}}let O=q.Angle(v.center,k),F=q.Angle(v.center,_),U=m(O,F),G=U*v.radius;const Y=k.clone(),$=_.clone();if(A!==0){const Q=A/G*(b?1:-1),J=q.FromAngle(O+U*Q);Y.setTo(v.center).add(J.mul(v.radius))}if(I!==0){const Q=I/G*(b?-1:1),J=q.FromAngle(F+U*Q);$.setTo(v.center).add(J.mul(v.radius))}if(q.DistMin(Y,$,N)&&(A!==0&&I!==0?(A*=-1.5,I*=-1.5):A!==0?A*=-2:I!==0&&(I*=-2)),A!==0){const Q=A/G*(b?1:-1),J=q.FromAngle(O+U*Q);k.setTo(v.center).add(J.mul(v.radius))}if(I!==0){const Q=I/G*(b?-1:1),J=q.FromAngle(F+U*Q);_.setTo(v.center).add(J.mul(v.radius))}if(h&&d&&!h.isExact&&!d.isExact){O=q.Angle(v.center,k),F=q.Angle(v.center,_),U=m(O,F),G=U*v.radius;const Q=c1(t,h.shape.id,d.shape.id);if(Q==="double-bound"&&G<30)k.setTo(p),_.setTo(y),C.setTo(g);else if(Q==="safe"&&(h&&!h.didIntersect&&k.setTo(p),d&&!d.didIntersect||m(x,O)>m(x,F))){const J=Math.min(.9,au/G)*(b?1:-1),ae=q.FromAngle(O+U*J);_.setTo(v.center).add(ae.mul(v.radius))}}PB(v.center,v.radius,k,_,C,S,b),k.equals(_)&&(k.setTo(C.clone().addXY(1,1)),_.setTo(C.clone().subXY(1,1))),p.setTo(k),y.setTo(_),g.setTo(C);const H=mP(p,y,g);return{isStraight:!1,start:{point:p,handle:i.start,arrowhead:n.props.arrowheadStart},end:{point:y,handle:i.end,arrowhead:n.props.arrowheadEnd},middle:g,handleArc:v,bodyArc:H,isValid:H.length!==0&&isFinite(H.center.x)&&isFinite(H.center.y)}}function mP(t,n,o){const r=-2*(t.x*(n.y-o.y)-t.y*(n.x-o.x)+n.x*o.y-o.x*n.y),s={x:((t.x*t.x+t.y*t.y)*(o.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-o.y)+(o.x*o.x+o.y*o.y)*(n.y-t.y))/r,y:((t.x*t.x+t.y*t.y)*(n.x-o.x)+(n.x*n.x+n.y*n.y)*(o.x-t.x)+(o.x*o.x+o.y*o.y)*(t.x-n.x))/r},a=q.Dist(s,t),i=+q.Clockwise(t,o,n),l=((t.y-n.y)**2+(t.x-n.x)**2)**.5,c=((n.y-o.y)**2+(n.x-o.x)**2)**.5,u=((o.y-t.y)**2+(o.x-t.x)**2)**.5,f=Math.acos((c*c+u*u-l*l)/(2*c*u))*2,h=+(Yt>f),d=(nr-f)*(i?1:-1),p=d*a;return{center:s,radius:a,size:d,length:p,largeArcFlag:h,sweepFlag:i}}function PB(t,n,o,r,s,a,i){const l=q.Angle(t,o),c=q.Angle(t,r);let u=rh(l,c);i||(u=nr-u);const f=.5*(i?1:-1),h=q.FromAngle(l+u*f);if(s.setTo(t).add(h.mul(n)),u>a){s.rotWith(t,Yt);const d=r.clone();r.setTo(o),o.setTo(d)}}const MB={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",long_press:"onLongPress",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick",tick:"onTick"};class bt{constructor(n,o){R(this,"id");R(this,"type");R(this,"shapeType");R(this,"initial");R(this,"children");R(this,"parent");R(this,"_path");R(this,"_current");R(this,"_isActive");R(this,"transition",(n,o={})=>{var a;const r=n.split(".");let s=this;for(let i=0;i<r.length;i++){const l=r[i],c=s.getCurrent(),u=(a=s.children)==null?void 0:a[l];if(!u)throw Error(`${s.id} - no child state exists with the id ${l}.`);if((c==null?void 0:c.id)!==u.id&&(c==null||c.exit(o,l),s._current.set(u),u.enter(o,(c==null?void 0:c.id)||"initial"),!u.getIsActive()))break;s=u}return this});R(this,"handleEvent",n=>{var s;const o=MB[n.name],r=this._current.__unsafe__getWithoutCapture();(s=this[o])==null||s.call(this,n),this._isActive.__unsafe__getWithoutCapture()&&r&&r===this._current.__unsafe__getWithoutCapture()&&r.handleEvent(n)});R(this,"enter",(n,o)=>{var r;if(this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,n,o),this.children&&this.initial&&this.getIsActive()){const s=this.children[this.initial];this._current.set(s),s.enter(n,o)}});R(this,"exit",(n,o)=>{var r,s;this._isActive.set(!1),(r=this.onExit)==null||r.call(this,n,o),this.getIsActive()||((s=this.getCurrent())==null||s.exit(n,o))});R(this,"_currentToolIdMask",fo("curent tool id mask",void 0));R(this,"onWheel");R(this,"onPointerDown");R(this,"onPointerMove");R(this,"onLongPress");R(this,"onPointerUp");R(this,"onDoubleClick");R(this,"onTripleClick");R(this,"onQuadrupleClick");R(this,"onRightClick");R(this,"onMiddleClick");R(this,"onKeyDown");R(this,"onKeyUp");R(this,"onKeyRepeat");R(this,"onCancel");R(this,"onComplete");R(this,"onInterrupt");R(this,"onTick");R(this,"onEnter");R(this,"onExit");this.editor=n;const{id:r,children:s,initial:a}=this.constructor;this.id=r,this._isActive=fo("toolIsActive"+this.id,!1),this._current=fo("toolState"+this.id,void 0),this._path=Ye("toolPath"+this.id,()=>{const i=this.getCurrent();return this.id+(i?`.${i.getPath()}`:"")}),this.parent=o??{},this.parent?s&&a?(this.type="branch",this.initial=a,this.children=Object.fromEntries(s().map(i=>[i.id,new i(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",s&&a&&(this.initial=a,this.children=Object.fromEntries(s().map(i=>[i.id,new i(this.editor,this)])),this._current.set(this.children[this.initial])))}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(n){this._currentToolIdMask.set(n)}}R(bt,"id"),R(bt,"initial"),R(bt,"children");class Om extends bt{constructor(){super(...arguments);R(this,"onKeyDown",o=>{var r;switch(o.code){case"KeyZ":{if(!(o.shiftKey||o.ctrlKey)){const s=this.getCurrent();s&&((r=s.getCurrent())==null?void 0:r.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...o,onInteractionEnd:s.id})}break}}})}}R(Om,"id","root"),R(Om,"initial",""),R(Om,"children",()=>[]);var TB=Object.defineProperty,IB=Object.getOwnPropertyDescriptor,gt=(t,n,o,r)=>{for(var s=r>1?void 0:r?IB(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&TB(n,o,s),s};class pt extends DU.EventEmitter{constructor({store:o,user:r,shapeUtils:s,tools:a,getContainer:i,initialState:l,inferDarkMode:c}){super();R(this,"store");R(this,"root");R(this,"disposables",new Set);R(this,"_tickManager");R(this,"snaps");R(this,"user");R(this,"textMeasure");R(this,"environment");R(this,"scribbles");R(this,"getContainer");R(this,"sideEffects");R(this,"shapeUtils");R(this,"styleProps");R(this,"history",new aB(this,o=>{this.annotateError(o,{origin:"history.batch",willCrashApp:!0}),this.crash(o)}));R(this,"_crashingError",null);R(this,"_updateInstanceState",this.history.createCommand("updateInstanceState",(o,r)=>{const s=this.store.get(this.getInstanceState().id),a={...s,...o};return{data:{prev:s,next:a},ephemeral:!1,squashing:!1,...r}},{do:({next:o})=>{this.store.put([o])},undo:({prev:o})=>{this.store.put([o])},squash({prev:o},{next:r}){return{prev:o,next:r}}}));R(this,"_isChangingStyleTimeout",-1);R(this,"setCursor",o=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...o}},{ephemeral:!0}),this));R(this,"_setInstancePageState",this.history.createCommand("setInstancePageState",(o,r)=>({data:{prev:this.store.get(o.id??this.getCurrentPageState().id),partial:o},...r}),{do:({prev:o,partial:r})=>{this.store.update(o.id,s=>({...s,...r}))},undo:({prev:o})=>{this.store.update(o.id,()=>o)}}));R(this,"_setSelectedShapes",this.history.createCommand("setSelectedShapes",(o,r)=>{const{selectedShapeIds:s}=this.getCurrentPageState(),a=new Set(s);return o.length===a.size&&o.every(i=>a.has(i))?null:{data:{selectedShapeIds:o,prevSelectedShapeIds:s},preservesRedoStack:!0,...r}},{do:({selectedShapeIds:o})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:o}])},undo:({prevSelectedShapeIds:o})=>{this.store.put([{...this.getCurrentPageState(),selectedShapeIds:o}])},squash({prevSelectedShapeIds:o},{selectedShapeIds:r}){return{selectedShapeIds:r,prevSelectedShapeIds:o}}}));R(this,"_setFocusedGroupId",this.history.createCommand("setFocusedGroupId",o=>{const r=this.getCurrentPageState().focusedGroupId;if(r!==o)return{data:{prev:r,next:o},preservesRedoStack:!0,squashing:!0}},{do:({next:o})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:o}))},undo:({prev:o})=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:o}))},squash({prev:o},{next:r}){return{prev:o,next:r}}}));R(this,"_viewportAnimation",null);R(this,"_willSetInitialBounds",!0);R(this,"_wasInset",!1);R(this,"_cameraState",fo("camera state","idle"));R(this,"_cameraStateTimeoutRemaining",0);R(this,"_lastUpdateRenderingBoundsTimestamp",Date.now());R(this,"_decayCameraStateTimeout",o=>{this._cameraStateTimeoutRemaining-=o,this._cameraStateTimeoutRemaining<=0&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"),this.updateRenderingBounds())});R(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=H6;const o=Date.now();this._cameraState.__unsafe__getWithoutCapture()==="idle"&&(this._lastUpdateRenderingBoundsTimestamp=o,this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout))});R(this,"_renderingBounds",fo("rendering viewport",new mt));R(this,"renderingBoundsMargin",100);R(this,"_currentPageShapeIds");R(this,"_setCurrentPageId",this.history.createCommand("setCurrentPage",(o,r)=>{if(!this.store.has(o)){console.error("Tried to set the current page id to a page that doesn't exist.");return}return this.stopFollowingUser(),{data:{toId:o,fromId:this.getCurrentPageId()},squashing:!0,preservesRedoStack:!0,...r}},{do:({toId:o})=>{if(this.store.has(o)){if(!this.getPageStates().find(r=>r.pageId===o)){const r=go.create({id:go.createId(o)});this.store.put([r,Yn.create({id:Yn.createId(o),pageId:o})])}this.store.put([{...this.getInstanceState(),currentPageId:o}]),this.updateRenderingBounds()}},undo:({fromId:o})=>{this.store.has(o)&&(this.store.put([{...this.getInstanceState(),currentPageId:o}]),this.updateRenderingBounds())},squash:({fromId:o},{toId:r})=>({toId:r,fromId:o})}));R(this,"_updatePage",this.history.createCommand("updatePage",(o,r)=>{if(this.getInstanceState().isReadonly)return null;const s=this.getPage(o.id);return s?{data:{prev:s,partial:o},...r}:null},{do:({partial:o})=>{this.store.update(o.id,r=>({...r,...o}))},undo:({prev:o,partial:r})=>{this.store.update(r.id,()=>o)},squash(o,r){return{prev:{...o.prev,...r.prev},partial:r.partial}}}));R(this,"_createPage",this.history.createCommand("createPage",o=>{if(this.getInstanceState().isReadonly||this.getPages().length>=pm)return null;const r=this.getPages(),s=WU(o.name??"Page 1",r.map(u=>u.name));let a=o.index;(!a||r.some(u=>u.index===a))&&(a=Di(r[r.length-1].index));const i=Ui.create({meta:{},...o,name:s,index:a}),l=go.create({id:go.createId(i.id)}),c=Yn.create({id:Yn.createId(i.id),pageId:i.id});return{data:{newPage:i,newTabPageState:c,newCamera:l}}},{do:({newPage:o,newTabPageState:r,newCamera:s})=>{this.store.put([o,s,r])},undo:({newPage:o,newTabPageState:r,newCamera:s})=>{this.getPages().length!==1&&this.store.remove([r.id,o.id,s.id])}}));R(this,"_deletePage",this.history.createCommand("delete_page",o=>{if(this.getInstanceState().isReadonly)return null;const r=this.getPages();if(r.length===1)return null;const s=this.getPage(o),a=this.getPageStates().filter(i=>i.pageId===o);if(!s)return null;if(o===this.getCurrentPageId()){const i=r.findIndex(c=>c.id===o),l=r[i-1]??r[i+1];this.setCurrentPage(l.id)}return{data:{id:o,deletedPage:s,deletedPageStates:a}}},{do:({deletedPage:o,deletedPageStates:r})=>{const s=this.getPages();if(s.length!==1){if(o.id===this.getCurrentPageId()){const a=s.findIndex(l=>l.id===o.id),i=s[a-1]??s[a+1];this.setCurrentPage(i.id)}this.store.remove(r.map(a=>a.id)),this.store.remove([o.id]),this.updateRenderingBounds()}},undo:({deletedPage:o,deletedPageStates:r})=>{this.store.put([o]),this.store.put(r),this.updateRenderingBounds()}}));R(this,"_createAssets",this.history.createCommand("createAssets",o=>this.getInstanceState().isReadonly||o.length<=0?null:{data:{assets:o}},{do:({assets:o})=>{this.store.put(o)},undo:({assets:o})=>{this.store.remove(o.map(r=>r.id))}}));R(this,"_updateAssets",this.history.createCommand("updateAssets",o=>this.getInstanceState().isReadonly||o.length<=0?void 0:{data:{snapshots:{},assets:o}},{do:({assets:o,snapshots:r})=>{this.store.put(o.map(s=>{const a=this.store.get(s.id);return r[s.id]=a,{...a,...s}}))},undo:({snapshots:o})=>{this.store.put(Object.values(o))}}));R(this,"_deleteAssets",this.history.createCommand("deleteAssets",o=>{if(this.getInstanceState().isReadonly||o.length<=0)return;const r=Lt(o.map(s=>this.store.get(s)));return{data:{ids:o,prev:r}}},{do:({ids:o})=>{this.store.remove(o)},undo:({prev:o})=>{this.store.put(o)}}));R(this,"_parentIdsToChildIds");R(this,"_childIdsCache",new Em);R(this,"_createShapes",this.history.createCommand("createShapes",o=>{if(this.getInstanceState().isReadonly||o.length<=0)return null;const r=this.getCurrentPageShapeIds();if(o.length+r.size>zi){Lm(this);return}return o.length===0?null:{data:{currentPageId:this.getCurrentPageId(),partials:o.map(s=>s.id?s:{...s,id:ur()})}}},{do:({partials:o})=>{var l,c;const r=this.getFocusedGroupId(),s=this.getCurrentPageShapesSorted();o=o.map(u=>{if(!u.parentId||!(this.store.has(u.parentId)||o.some(f=>f.id===u.parentId))){let f=this.getFocusedGroupId();for(let d=s.length-1;d>=0;d--){const p=s[d];if(this.getShapeUtil(p).canReceiveNewChildrenOfType(p,u.type)&&this.isPointInShape(p,{x:u.x??0,y:u.y??0},{margin:0,hitInside:!0})){f=p.id;break}}const h=u.parentId;if(f===u.id&&(f=r),f!==h&&(u={...u},u.parentId=f,Zo(f))){const d=this.getPointInShapeSpace(this.getShape(f),{x:u.x??0,y:u.y??0});u.x=d.x,u.y=d.y,u.rotation=-this.getShapePageTransform(f).rotation()+(u.rotation??0)}}return u});const a=new Map,i=[];for(const u of o){const f=this.getShapeUtil(u);let h=u.index;if(!h){const g=u.parentId??r;a.has(g)||a.set(g,this.getHighestIndexForParent(g)),h=a.get(g),a.set(g,Di(h))}const d=f.getDefaultProps();for(const[g,b]of this.styleProps[u.type])d[b]=this.getStyleForNextShape(g);let p=this.store.schema.types.shape.create({...u,index:h,opacity:u.opacity??this.getInstanceState().opacityForNextShape,parentId:u.parentId??r,props:"props"in u?{...d,...u.props}:d});if(p.index===void 0)throw Error("no index!");const y=(c=(l=this.getShapeUtil(p)).onBeforeCreate)==null?void 0:c.call(l,p);y&&(p=y),i.push(p)}i.forEach(u=>{u.meta={...this.getInitialMetaForShape(u),...u.meta}}),this.store.put(i)},undo:({partials:o})=>{this.store.remove(o.map(r=>r.id))}}));R(this,"animatingShapes",new Map);R(this,"_updateShapes",this.history.createCommand("updateShapes",(o,r)=>{if(this.getInstanceState().isReadonly)return null;const s={},a={};let i,l;for(let c=0,u=o.length;c<u;c++){const f=o[c];f&&(i=this.getShape(f.id),i&&(l=gh(i,f),l!==i&&(s[i.id]=i,a[i.id]=l)))}return{data:{snapshots:s,updates:a},...r}},{do:({updates:o})=>{this.store.put(dn(o).map(r=>{var a,i;const s=this.store.get(r.id);if(s){const l=(i=(a=this.getShapeUtil(r)).onBeforeUpdate)==null?void 0:i.call(a,s,r);if(l)return l}return r}))},undo:({snapshots:o})=>{this.store.put(Object.values(o))},squash(o,r){return{snapshots:{...r.snapshots,...o.snapshots},updates:{...o.updates,...r.updates}}}}));R(this,"_deleteShapes",this.history.createCommand("delete_shapes",o=>{if(this.getInstanceState().isReadonly||o.length===0)return null;const r=[...this.getCurrentPageState().selectedShapeIds],s=new Set(o);for(const u of o)this.visitDescendants(u,f=>{s.add(f)});const a=[...s],i=this._getArrowBindingsIndex().get(),l=Lt(a.flatMap(u=>{const f=this.getShape(u),h=i[u];return h&&h.length>0?h.map(({arrowId:d})=>this.getShape(d)).concat(f):f})),c=r.filter(u=>!s.has(u));return{data:{deletedIds:a,snapshots:l,prevSelectedShapeIds:r,postSelectedShapeIds:c}}},{do:({deletedIds:o,postSelectedShapeIds:r})=>{this.store.remove(o),this.store.update(this.getCurrentPageState().id,s=>({...s,selectedShapeIds:r}))},undo:({snapshots:o,prevSelectedShapeIds:r})=>{this.store.put(o),this.store.update(this.getCurrentPageState().id,s=>({...s,selectedShapeIds:r}))}}));R(this,"externalAssetContentHandlers",{file:null,url:null});R(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null});R(this,"inputs",{originPagePoint:new q,originScreenPoint:new q,previousPagePoint:new q,previousScreenPoint:new q,currentPagePoint:new q,currentScreenPoint:new q,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new q});R(this,"_clickManager",new oB(this));R(this,"_prevCursor","default");R(this,"_shiftKeyTimeout",-1);R(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});R(this,"_altKeyTimeout",-1);R(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});R(this,"_ctrlKeyTimeout",-1);R(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});R(this,"_restoreToolId","select");R(this,"_pinchStart",1);R(this,"_didPinch",!1);R(this,"_selectedShapeIdsAtPointerDown",[]);R(this,"_longPressTimeout",-1);R(this,"capturedPointerId",null);R(this,"dispatch",o=>(this._pendingEventsForNextTick.push(o),o.type==="pointer"&&o.name==="pointer_move"||o.type==="wheel"||o.type==="pinch"||this._flushEventsForTick(0),this));R(this,"_pendingEventsForNextTick",[]);R(this,"_flushEventForTick",o=>{if(this.getCrashingError())return this;const{inputs:r}=this,{type:s}=o;if(o.type==="misc"){(o.name==="cancel"||o.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.updateInstanceState({cursor:{type:this._prevCursor,rotation:0}}))),this.root.handleEvent(o);return}o.shiftKey?(clearInterval(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!o.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=setTimeout(this._setShiftKeyTimeout,150)),o.altKey?(clearInterval(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!o.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=setTimeout(this._setAltKeyTimeout,150)),o.ctrlKey?(clearInterval(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!o.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:a,originScreenPoint:i,currentPagePoint:l,currentScreenPoint:c}=r;switch(r.isPointing||(r.isDragging=!1),s){case"pinch":{if(!this.getInstanceState().canMoveCamera)return;switch(clearTimeout(this._longPressTimeout),this._updateInputsFromEvent(o),o.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds()),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{z:u=1},delta:{x:f,y:h}}=o,{screenBounds:d}=this.store.unsafeGetWithoutCapture(Ao),{x:p,y}=q.SubXY(o.point,d.x,d.y),{x:g,y:b,z:m}=this.getCamera(),v=Math.min(Va,Math.max(oh,u));this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this._setCamera({x:g+f/m-p/m+p/v,y:b+h/m-y/m+y/v,z:v},!0);return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedShapeIdsAtPointerDown:u}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown,{squashing:!0}),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,this.once("tick",()=>{this._didPinch||this.setSelectedShapes(u,{squashing:!0})}));return}}}case"wheel":{if(!this.getInstanceState().canMoveCamera)return;if(this._updateInputsFromEvent(o),!this.getIsMenuOpen()){if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),r.ctrlKey){const{x:d,y:p}=this.inputs.currentScreenPoint,{x:y,y:g,z:b}=this.getCamera(),m=Math.min(Va,Math.max(oh,b+(o.delta.z??0)*b));this._setCamera({x:y+(d/m-d)-(d/b-d),y:g+(p/m-p)-(p/b-p),z:m},!0);return}const{x:u,y:f,z:h}=this.getCamera();this._setCamera({x:u+o.delta.x/h,y:f+o.delta.y/h,z:h},!0),!r.isDragging&&r.isPointing&&q.Dist2(a,l)>(this.getInstanceState().isCoarsePointer?Db:sh)/this.getZoomLevel()&&(clearTimeout(this._longPressTimeout),r.isDragging=!0)}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(o);const{isPen:u}=o;switch(o.name){case"pointer_down":{if(this.clearOpenMenus(),this._longPressTimeout=setTimeout(()=>{this.dispatch({...o,name:"long_press"})},K6),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),o.button===0&&(this.capturedPointerId=o.pointerId),r.buttons.add(o.button),r.isPointing=!0,r.isDragging=!1,this.getInstanceState().isPenMode){if(!u)return}else u&&this.updateInstanceState({isPenMode:!0});if(o.button===5?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):o.button===1&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing",rotation:0}),this;i.setTo(c),a.setTo(l);break}case"pointer_move":{if(!u&&this.getInstanceState().isPenMode)return;if(this.inputs.isPanning&&this.inputs.isPointing){clearTimeout(this._longPressTimeout);const{currentScreenPoint:f,previousScreenPoint:h}=this.inputs;this.pan(q.Sub(f,h));return}!r.isDragging&&r.isPointing&&q.Dist2(a,l)>(this.getInstanceState().isCoarsePointer?Db:sh)/this.getZoomLevel()&&(clearTimeout(this._longPressTimeout),r.isDragging=!0);break}case"pointer_up":{if(r.buttons.delete(o.button),r.isPointing=!1,r.isDragging=!1,this.getIsMenuOpen()||!u&&this.getInstanceState().isPenMode)return;this.capturedPointerId===o.pointerId&&(this.capturedPointerId=null,o.button=0),r.isPanning?o.button===1?this.inputs.keys.has(" ")?(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:fm}),this.setCursor({type:"grab",rotation:0})):(r.isPanning=!1,this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:fm}),this.setCursor({type:this._prevCursor,rotation:0})):o.button===0&&(this.slideCamera({speed:Math.min(2,this.inputs.pointerVelocity.len()),direction:this.inputs.pointerVelocity,friction:fm}),this.setCursor({type:"grab",rotation:0})):o.button===5&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(o.key==="ShiftRight"&&(o.key="ShiftLeft"),o.key==="AltRight"&&(o.key="AltLeft"),o.code==="ControlRight"&&(o.code="ControlLeft"),o.name){case"key_down":{r.keys.add(o.code),!o.ctrlKey&&o.code==="Space"&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,this.setCursor({type:this.inputs.isPointing?"grabbing":"grab",rotation:0}));break}case"key_up":{r.keys.delete(o.code),o.code==="Space"&&!this.inputs.buttons.has(1)&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0}));break}}break}}if(o.type==="pointer"&&(o.button===1?o.name="middle_click":o.button===2&&(o.name="right_click"),o.isPen===this.getInstanceState().isPenMode))switch(o.name){case"pointer_down":{const u=this._clickManager.transformPointerDownEvent(o);if(o.name!==u.name){this.root.handleEvent(o),this.emit("event",o),this.root.handleEvent(u),this.emit("event",u);return}break}case"pointer_up":{clearTimeout(this._longPressTimeout);const u=this._clickManager.transformPointerUpEvent(o);if(o.name!==u.name){this.root.handleEvent(o),this.emit("event",o),this.root.handleEvent(u),this.emit("event",u);return}break}case"pointer_move":{this._clickManager.handleMove();break}}return this.root.handleEvent(o),this.emit("event",o),this});this.store=o,this.snaps=new Tm(this),this.user=new Bs(r??XC(),c??!1),this.getContainer=i??(()=>document.body),this.textMeasure=new jB(this),this._tickManager=new _B(this);class u extends Om{}R(u,"initial",l??""),this.root=new u(this),this.root.children={};const f=nP(s),h={},d={},p=new Map;for(const x of f){const w=new x(this);h[x.type]=w;const S=tE(x.props??{});d[x.type]=S;for(const k of S.keys())if(!p.has(k.id))p.set(k.id,k);else if(p.get(k.id)!==k)throw Error(`Multiple style props with id "${k.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=h,this.styleProps=d;for(const x of[...a]){if(ei(this.root.children,x.id))throw Error(`Can't override tool with id "${x.id}"`);this.root.children[x.id]=new x(this,this.root)}this.environment=new sB(this),this.scribbles=new lB(this);const y=new Set,g=x=>{var Y;const w=this.getShape(x);if(!w)return;const{start:S,end:k}=w.props,_=S.type==="binding"?this.getShape(S.boundShapeId):void 0,C=k.type==="binding"?this.getShape(k.boundShapeId):void 0,P=this.getAncestorPageId(w);if(!P)return;let A;if(_&&C)A=this.findCommonAncestor([_,C])??P;else if(_||C){const $=(Y=_||C)==null?void 0:Y.parentId;$&&$===w.parentId?A=w.parentId:A=P}else return;A&&A!==w.parentId&&this.reparentShapes([x],A);const I=this.getShape(x);if(!I)throw Error("no reparented arrow");const N=this.getShapeNearestSibling(I,_),O=this.getShapeNearestSibling(I,C);let F;if(N&&O)F=N.index>O.index?N:O;else if(N&&!O)F=N;else if(O&&!N)F=O;else return;let U;const G=this.getSortedChildIdsForParent(F.parentId).map($=>this.getShape($)).filter($=>$.index>F.index);if(G.length){const $=G.find(H=>H.type!=="arrow");if(I.index>F.index&&(!$||I.index<$.index))return;U=Gd(F.index,G[0].index)}else U=Di(F.index);U!==I.index&&this.updateShapes([{id:x,type:"arrow",index:U}])},b=(x,w)=>{const{x:S,y:k}=zs(this,x)[w];this.store.put([{...x,props:{...x.props,[w]:{type:"point",x:S,y:k}}}])},m=x=>{for(const w of["start","end"]){const S=x.props[w];if(S.type!=="binding")continue;const k=this.getShape(S.boundShapeId),_=this.getAncestorPageId(x)===this.getAncestorPageId(k);(!k||!_)&&b(x,w)}g(x.id)},v=(x,w)=>{let S=null;const k=x.selectedShapeIds.filter(P=>!w.has(P));k.length!==x.selectedShapeIds.length&&(S||(S={...x}),S.selectedShapeIds=k);const _=x.erasingShapeIds.filter(P=>!w.has(P));_.length!==x.erasingShapeIds.length&&(S||(S={...x}),S.erasingShapeIds=_),x.hoveredShapeId&&w.has(x.hoveredShapeId)&&(S||(S={...x}),S.hoveredShapeId=null),x.editingShapeId&&w.has(x.editingShapeId)&&(S||(S={...x}),S.editingShapeId=null);const C=x.hintingShapeIds.filter(P=>!w.has(P));return C.length!==x.hintingShapeIds.length&&(S||(S={...x}),S.hintingShapeIds=C),x.focusedGroupId&&w.has(x.focusedGroupId)&&(S||(S={...x}),S.focusedGroupId=null),S};if(this.sideEffects=new cB(this),this.sideEffects.registerBatchCompleteHandler(()=>{var x,w;for(const S of y){y.delete(S);const k=this.getShape(S);if(!k)continue;const _=(w=(x=this.getShapeUtil(k)).onChildrenChange)==null?void 0:w.call(x,k);_!=null&&_.length&&this.updateShapes(_,{squashing:!0})}this.emit("update")}),this.sideEffects.registerBeforeDeleteHandler("shape",x=>{x.parentId&&Zo(x.parentId)&&y.add(x.parentId);const w=this._getArrowBindingsIndex().get()[x.id];if(w!=null&&w.length)for(const{arrowId:_,handleId:C}of w){const P=this.getShape(_);P&&b(P,C)}const S=new Set([x.id]),k=Lt(this.getPageStates().map(_=>v(_,S)));k.length&&this.store.put(k)}),this.sideEffects.registerBeforeDeleteHandler("page",x=>{var _;if(this.getInstanceState().currentPageId!==x.id)return;const w=(_=this.getPages().find(C=>C.id!==x.id))==null?void 0:_.id;if(!w)return;this.store.put([{...this.getInstanceState(),currentPageId:w}]);const S=go.createId(x.id),k=Yn.createId(x.id);this.store.remove([S,k])}),this.sideEffects.registerAfterChangeHandler("shape",(x,w)=>{if(this.isShapeOfType(w,"arrow")&&m(w),x.parentId!==w.parentId){const S=k=>{const _=this._getArrowBindingsIndex().get()[k];if(_!=null&&_.length)for(const C of _)g(C.arrowId)};S(w.id),this.visitDescendants(w.id,S)}if(x.parentId!==w.parentId&&Io(w.parentId)){const S=new Set([x.id]);this.visitDescendants(x.id,k=>{S.add(k)});for(const k of this.getPageStates()){if(k.pageId===w.parentId)continue;const _=v(k,S);_&&this.store.put([_])}}x.parentId&&Zo(x.parentId)&&y.add(x.parentId),w.parentId!==x.parentId&&Zo(w.parentId)&&y.add(w.parentId)}),this.sideEffects.registerAfterChangeHandler("instance_page_state",(x,w)=>{if((x==null?void 0:x.selectedShapeIds)!==(w==null?void 0:w.selectedShapeIds)){const S=w.selectedShapeIds.filter(_=>{var P,A;let C=(P=this.getShape(_))==null?void 0:P.parentId;for(;Zo(C);){if(w.selectedShapeIds.includes(C))return!1;C=(A=this.getShape(C))==null?void 0:A.parentId}return!0});let k=null;if(S.length>0){const _=this.findCommonAncestor(Lt(S.map(C=>this.getShape(C))),C=>this.isShapeOfType(C,"group"));_&&(k=_)}else w!=null&&w.focusedGroupId&&(k=w.focusedGroupId);(S.length!==w.selectedShapeIds.length||k!==w.focusedGroupId)&&this.store.put([{...w,selectedShapeIds:S,focusedGroupId:k??null}])}}),this.sideEffects.registerAfterCreateHandler("shape",x=>{this.isShapeOfType(x,"arrow")&&m(x)}),this.sideEffects.registerAfterCreateHandler("page",x=>{const w=go.createId(x.id),S=Yn.createId(x.id);this.store.has(w)||this.store.put([go.create({id:w})]),this.store.has(S)||this.store.put([Yn.create({id:S,pageId:x.id})])}),this._currentPageShapeIds=eB(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=JU(this.store),this.disposables.add(this.store.listen(x=>{this.emit("change",x)})),this.store.ensureStoreIsUsable(),this._setInstancePageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]},{ephemeral:!0}),l&&this.root.children[l]===void 0)throw Error(`No state found for initialState "${l}".`);this.root.enter(void 0,"initial"),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.updateRenderingBounds(),this.on("tick",this._flushEventsForTick),requestAnimationFrame(()=>{this._tickManager.start()})}dispose(){this.disposables.forEach(o=>o()),this.disposables.clear()}getShapeUtil(o){const r=typeof o=="string"?o:o.type,s=Rs(this.shapeUtils,r);return bn(s,`No shape util found for type "${r}"`),s}undo(){return this._flushEventsForTick(0),this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this._flushEventsForTick(0),this.history.redo(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(o,r,s){return this.history.mark(o,r,s),this}bail(){return this.history.bail(),this}bailToMark(o){return this.history.bailToMark(o),this}batch(o){return this.history.batch(o),this}_getArrowBindingsIndex(){return XU(this)}getArrowsBoundTo(o){return this._getArrowBindingsIndex().get()[o]||Li}getArrowInfoCache(){return this.store.createComputedCache("arrow infoCache",o=>fh(o)?mh(this,o):u1(this,o))}getArrowInfo(o){const r=typeof o=="string"?o:o.id;return this.getArrowInfoCache().get(r)}annotateError(o,{origin:r,willCrashApp:s,tags:a,extras:i}){const l=this.createErrorAnnotations(r,s);return lb(o,{tags:{...l.tags,...a},extras:{...l.extras,...i}}),s&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(o,r){try{const s=this.getEditingShapeId();return{tags:{origin:o,willCrashApp:r},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:s?this.getShape(s):void 0,inputs:this.inputs}}}catch{return{tags:{origin:o,willCrashApp:r},extras:{}}}}getCrashingError(){return this._crashingError}crash(o){return this._crashingError=o,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:o}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(o){const r=o.split(".").reverse();let s=this.root;for(;r.length>0;){const a=r.pop();if(!a)return!0;const i=s.getCurrent();if((i==null?void 0:i.id)===a){if(r.length===0)return!0;s=i;continue}else return!1}return!1}isInAny(...o){return o.some(r=>this.isIn(r))}setCurrentTool(o,r={}){return this.root.transition(o,r),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const o=this.getCurrentTool();return o?o.getCurrentToolIdMask()??o.id:""}getStateDescendant(o){var a;const r=o.split(".").reverse();let s=this.root;for(;r.length>0;){const i=r.pop();if(!i)return s;const l=(a=s.children)==null?void 0:a[i];if(!l)return;s=l}return s}getDocumentSettings(){return this.store.get(Pb)}updateDocumentSettings(o){return this.store.put([{...this.getDocumentSettings(),...o}]),this}getInstanceState(){return this.store.get(Ao)}updateInstanceState(o,r){return this._updateInstanceState(o,{ephemeral:!0,squashing:!0,...r}),o.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),o.isChangingStyle===!0&&(this._isChangingStyleTimeout=setTimeout(()=>{this.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},2e3))),this}getOpenMenus(){return this.getInstanceState().openMenus}addOpenMenu(o){const r=new Set(this.getOpenMenus());return r.has(o)||(r.add(o),this.updateInstanceState({openMenus:[...r]})),this}deleteOpenMenu(o){const r=new Set(this.getOpenMenus());return r.has(o)&&(r.delete(o),this.updateInstanceState({openMenus:[...r]})),this}clearOpenMenus(){return this.getOpenMenus().length&&this.updateInstanceState({openMenus:[]}),this}getIsMenuOpen(){return this.getOpenMenus().length>0}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return Yn.createId(this.getCurrentPageId())}updateCurrentPageState(o,r){return this._setInstancePageState(o,r),this}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:o}=this.getCurrentPageState();return Lt(o.map(r=>this.store.get(r)))}setSelectedShapes(o,r){const s=o.map(a=>typeof a=="string"?a:a.id);return this._setSelectedShapes(s,r),this}select(...o){const r=typeof o[0]=="string"?o:o.map(s=>s.id);return this.setSelectedShapes(r),this}deselect(...o){const r=typeof o[0]=="string"?o:o.map(a=>a.id),s=this.getSelectedShapeIds();return s.length>0&&r.length>0&&this.setSelectedShapes(s.filter(a=>!r.includes(a))),this}selectAll(){const o=this.getSortedChildIdsForParent(this.getCurrentPageId());return o.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(o)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShapeId(){var o;return((o=this.getOnlySelectedShape())==null?void 0:o.id)??null}getOnlySelectedShape(){const o=this.getSelectedShapes();return o.length===1?o[0]:null}getSelectionPageBounds(){const o=this.getCurrentPageState().selectedShapeIds;return o.length===0?null:mt.Common(Lt(o.map(r=>this.getShapePageBounds(r))))}getSelectionRotation(){const o=this.getSelectedShapeIds();let r=!1,s=0;for(let a=0,i=o.length;a<i;a++){const l=this.getShapePageTransform(o[a]);if(l)if(r){if(l.rotation()!==s)return 0}else r=!0,s=l.rotation()}return s}getSelectionRotatedPageBounds(){const o=this.getSelectedShapeIds();if(o.length===0)return;const r=this.getSelectionRotation();if(r===0)return this.getSelectionPageBounds();if(o.length===1){const a=this.getShapeGeometry(o[0]).bounds.clone(),i=this.getShapePageTransform(o[0]);return a.point=i.applyToPoint(a.point),a}const s=mt.FromPoints(this.getSelectedShapeIds().flatMap(a=>{const i=this.getShapePageTransform(a);return i?i.applyToPoints(this.getShapeGeometry(a).bounds.corners):[]}).map(a=>a.rot(-r)));return s.point=s.point.rot(r),s}getSelectionRotatedScreenBounds(){const o=this.getSelectionRotatedPageBounds();if(!o)return;const{x:r,y:s}=this.pageToScreen(o.point),a=this.getZoomLevel();return new mt(r,s,o.width*a,o.height*a)}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const o=this.getFocusedGroupId();return o?this.getShape(o):void 0}setFocusedGroup(o){const r=typeof o=="string"?o:(o==null?void 0:o.id)??null;if(r!==null){const s=this.getShape(r);if(!s)throw Error(`Editor.setFocusedGroup: Shape with id ${r} does not exist`);if(!this.isShapeOfType(s,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${s.type}`)}return r===this.getFocusedGroupId()?this:(this._setFocusedGroupId(r),this)}popFocusedGroupId(){const o=this.getFocusedGroup();if(o){const r=this.findShapeAncestor(o,s=>this.isShapeOfType(s,"group"));this.setFocusedGroup((r==null?void 0:r.id)??null),this.select(o.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const o=this.getEditingShapeId();return o?this.getShape(o):void 0}setEditingShape(o){const r=typeof o=="string"?o:(o==null?void 0:o.id)??null;if(r!==this.getEditingShapeId()){if(r){const s=this.getShape(r);if(s&&this.getShapeUtil(s).canEdit(s))return this._setInstancePageState({editingShapeId:r}),this}this._setInstancePageState({editingShapeId:null})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const o=this.getHoveredShapeId();return o?this.getShape(o):void 0}setHoveredShape(o){const r=typeof o=="string"?o:(o==null?void 0:o.id)??null;return r===this.getHoveredShapeId()?this:(this.updateCurrentPageState({hoveredShapeId:r},{ephemeral:!0}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const o=this.getHintingShapeIds();return Lt(o.map(r=>this.getShape(r)))}setHintingShapes(o){const r=typeof o[0]=="string"?o:o.map(s=>s.id);return this.updateCurrentPageState({hintingShapeIds:Ff(r)},{ephemeral:!0}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const o=this.getErasingShapeIds();return Lt(o.map(r=>this.getShape(r)))}setErasingShapes(o){const r=typeof o[0]=="string"?o:o.map(a=>a.id);r.sort();const s=this.getErasingShapeIds();if(r.length===s.length){for(let a=0;a<r.length;a++)if(r[a]!==s[a]){this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});break}}else this._setInstancePageState({erasingShapeIds:r},{ephemeral:!0});return this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(o){const r=typeof o=="string"?o:(o==null?void 0:o.id)??null;if(r!==this.getCroppingShapeId())if(!r)this.updateCurrentPageState({croppingShapeId:null});else{const s=this.getShape(r),a=this.getShapeUtil(s);s&&a.canCrop(s)&&this.updateCurrentPageState({croppingShapeId:r})}return this}getCameraId(){return go.createId(this.getCurrentPageId())}getCamera(){return this.store.get(this.getCameraId())}getZoomLevel(){return this.getCamera().z}_setCamera(o,r=!1){const s=this.getCamera();return s.x===o.x&&s.y===o.y&&s.z===o.z?this:(this.batch(()=>{const a={...s,...o};this.store.put([a]);const{currentScreenPoint:i,currentPagePoint:l}=this.inputs,{screenBounds:c}=this.store.unsafeGetWithoutCapture(Ao);if(i.x/a.z-a.x!==l.x||i.y/a.z-a.y!==l.y){const u={type:"pointer",target:"canvas",name:"pointer_move",point:q.AddXY(i,c.x,c.y),pointerId:$E.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1};r?this._flushEventForTick(u):this.dispatch(u)}this._tickCameraState()}),this)}setCamera(o,r){const s=Number.isFinite(o.x)?o.x:0,a=Number.isFinite(o.y)?o.y:0,i=Number.isFinite(o.z)?o.z:this.getZoomLevel();if(this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),r){const{width:l,height:c}=this.getViewportScreenBounds();return this._animateToViewport(new mt(-s,-a,l/i,c/i),r)}else this._setCamera({x:s,y:a,z:i});return this}centerOnPoint(o,r){if(!this.getInstanceState().canMoveCamera)return this;const{width:s,height:a}=this.getViewportPageBounds();return this.setCamera({x:-(o.x-s/2),y:-(o.y-a/2),z:this.getCamera().z},r),this}zoomToContent(o={duration:220}){const r=this.getSelectionPageBounds()??this.getCurrentPageBounds();return r&&this.zoomToBounds(r,{targetZoom:Math.min(1,this.getZoomLevel()),...o}),this}zoomToFit(o){if(!this.getInstanceState().canMoveCamera)return this;const r=[...this.getCurrentPageShapeIds()];if(r.length<=0)return this;const s=mt.Common(Lt(r.map(a=>this.getShapePageBounds(a))));return this.zoomToBounds(s,o),this}resetZoom(o=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:a,z:i}=this.getCamera(),{x:l,y:c}=o;return this.setCamera({x:s+(l/1-l)-(l/i-l),y:a+(c/1-c)-(c/i-c),z:1},r),this}zoomIn(o=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:a,z:i}=this.getCamera();let l=Va;for(let f=1;f<Zc.length;f++){const h=Zc[f-1],d=Zc[f];if(!(d-i<=(d-h)/2)){l=d;break}}const{x:c,y:u}=o;return this.setCamera({x:s+(c/l-c)-(c/i-c),y:a+(u/l-u)-(u/i-u),z:l},r),this}zoomOut(o=this.getViewportScreenCenter(),r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:a,z:i}=this.getCamera();let l=oh;for(let f=Zc.length-1;f>0;f--){const h=Zc[f-1],d=Zc[f];if(!(d-i>=(d-h)/2)){l=h;break}}const{x:c,y:u}=o;return this.setCamera({x:s+(c/l-c)-(c/i-c),y:a+(u/l-u)-(u/i-u),z:l},r),this}zoomToSelection(o){if(!this.getInstanceState().canMoveCamera)return this;const r=this.getSelectionPageBounds();return r?(this.zoomToBounds(r,{targetZoom:Math.max(1,this.getZoomLevel()),...o}),this):this}panZoomIntoView(o,r){if(!this.getInstanceState().canMoveCamera)return this;if(o.length<=0)return this;const s=mt.Common(Lt(o.map(i=>this.getShapePageBounds(i)))),a=this.getViewportPageBounds();if(a.h<s.h||a.w<s.w)return this.zoomToBounds(s,{targetZoom:this.getCamera().z,...r}),this;{const i=this.getViewportPageBounds().clone().expandBy(-32/this.getZoomLevel());let l=0,c=0;i.maxY<s.maxY?c=i.maxY-s.maxY:i.minY>s.minY&&(c=i.minY-s.minY),i.maxX<s.maxX?l=i.maxX-s.maxX:i.minX>s.minX&&(l=i.minX-s.minX);const u=this.getCamera();this.setCamera({x:u.x+l,y:u.y+c,z:u.z},r)}return this}zoomToBounds(o,r){if(!this.getInstanceState().canMoveCamera)return this;const s=this.getViewportScreenBounds(),a=(r==null?void 0:r.inset)??Math.min(256,s.width*.28);let i=Ba(Math.min((s.width-a)/o.width,(s.height-a)/o.height),oh,Va);return(r==null?void 0:r.targetZoom)!==void 0&&(i=Math.min(r.targetZoom,i)),this.setCamera({x:-o.minX+(s.width-o.width*i)/2/i,y:-o.minY+(s.height-o.height*i)/2/i,z:i},r),this}pan(o,r){if(!this.getInstanceState().canMoveCamera)return this;const{x:s,y:a,z:i}=this.getCamera();return this.setCamera({x:s+o.x/i,y:a+o.y/i,z:i},r),this._flushEventsForTick(0),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(o){if(!this._viewportAnimation)return;const r=()=>{this.removeListener("tick",this._animateViewport),this.removeListener("stop-camera-animation",r),this._viewportAnimation=null};this.once("stop-camera-animation",r),this._viewportAnimation.elapsed+=o;const{elapsed:s,easing:a,duration:i,start:l,end:c}=this._viewportAnimation;if(s>i){this._setCamera({x:-c.x,y:-c.y,z:this.getViewportScreenBounds().width/c.width}),r();return}const u=i-s,f=a(1-u/i),h=l.minX+(c.minX-l.minX)*f,d=l.minY+(c.minY-l.minY)*f,p=l.maxX+(c.maxX-l.maxX)*f;this._setCamera({x:-h,y:-d,z:this.getViewportScreenBounds().width/(p-h)})}_animateToViewport(o,r={}){const{duration:s=0,easing:a=Kn.easeInOutCubic}=r,i=this.user.getAnimationSpeed(),l=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),s===0||i===0?this._setCamera({x:-o.x,y:-o.y,z:this.getViewportScreenBounds().width/o.width}):(this._viewportAnimation={elapsed:0,duration:s/i,easing:a,start:l.clone(),end:o.clone()},this.addListener("tick",this._animateViewport),this)}slideCamera(o={}){if(!this.getInstanceState().canMoveCamera)return this;if(this.stopCameraAnimation(),this.user.getAnimationSpeed()===0)return this;const{speed:r,friction:s,direction:a,speedThreshold:i=.01}=o;let l=Math.min(r,1);const c=()=>{this.removeListener("tick",u),this.removeListener("stop-camera-animation",c)};this.once("stop-camera-animation",c);const u=f=>{const{x:h,y:d,z:p}=this.getCamera(),y=q.Mul(a,l*f/p);l*=1-s,l<i?c():this._setCamera({x:h+y.x,y:d+y.y,z:p})};return this.addListener("tick",u),this}animateToUser(o){const r=this.getCollaborators().find(s=>s.userId===o);return r?(this.batch(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const s=r.currentPageId===this.getCurrentPageId();s||this.setCurrentPage(r.currentPageId);const a=s?{duration:500}:void 0;this.centerOnPoint(r.cursor,a);const{highlightedUserIds:i}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...i,o]}),setTimeout(()=>{const l=[...this.getInstanceState().highlightedUserIds],c=l.indexOf(o);c<0||(l.splice(c,1),this.updateInstanceState({highlightedUserIds:l}))},WE)}),this):this}animateToShape(o,r=z6){if(!this.getInstanceState().canMoveCamera)return this;const s=this.getViewportScreenBounds().clone().expandBy(-32),a=s.width/s.height,i=this.getShapePageBounds(o);if(!i)return this;const l=i.width/i.height,c=i.clone(),u=i.width/s.width;return c.width+=(s.minX+s.maxX)*u,c.height+=(s.minY+s.maxY)*u,c.x-=s.minX*u,c.y-=s.minY*u,l>a?(c.height=i.width/a,c.y-=(c.height-i.height)/2):(c.width=i.height*a,c.x-=(c.width-i.width)/2),this._animateToViewport(c,r)}updateViewportScreenBounds(o,r=!1){o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const s=[o.minY!==0,document.body.scrollWidth!==o.maxX,document.body.scrollHeight!==o.maxY,o.minX!==0],a=o.equals(this.getViewportScreenBounds()),{_willSetInitialBounds:i}=this;if(a)this._willSetInitialBounds=!1;else if(i)this._willSetInitialBounds=!1,this.updateInstanceState({screenBounds:o.toJson(),insets:s},{squashing:!0,ephemeral:!0});else if(r&&!this.getInstanceState().followingUserId){const l=this.getViewportPageCenter();this.updateInstanceState({screenBounds:o.toJson(),insets:s},{squashing:!0,ephemeral:!0}),this.centerOnPoint(l)}else this.updateInstanceState({screenBounds:o.toJson(),insets:s},{squashing:!0,ephemeral:!0});return this._tickCameraState(),this.updateRenderingBounds(),this}getViewportScreenBounds(){const{x:o,y:r,w:s,h:a}=this.getInstanceState().screenBounds;return new mt(o,r,s,a)}getViewportScreenCenter(){const o=this.getViewportScreenBounds();return new q(o.midX-o.minX,o.midY-o.minY)}getViewportPageBounds(){const{w:o,h:r}=this.getViewportScreenBounds(),{x:s,y:a,z:i}=this.getCamera();return new mt(-s,-a,o/i,r/i)}getViewportPageCenter(){return this.getViewportPageBounds().center}screenToPage(o){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Ao),{x:s,y:a,z:i=1}=this.getCamera();return{x:(o.x-r.x)/i-s,y:(o.y-r.y)/i-a,z:o.z??.5}}pageToScreen(o){const r=this.getViewportScreenBounds(),{x:s,y:a,z:i=1}=this.getCamera();return{x:(o.x+s)*i+r.x,y:(o.y+a)*i+r.y,z:o.z??.5}}pageToViewport(o){const{x:r,y:s,z:a=1}=this.getCamera();return{x:(o.x+r)*a,y:(o.y+s)*a,z:o.z??.5}}_getCollaboratorsQuery(){return this.store.query.records("instance_presence",()=>({userId:{neq:this.user.getId()}}))}getCollaborators(){const o=this._getCollaboratorsQuery().get();return o.length?[...new Set(o.map(r=>r.userId))].sort().map(r=>o.filter(s=>s.userId===r).sort((s,a)=>a.lastActivityTimestamp-s.lastActivityTimestamp)[0]):Li}getCollaboratorsOnCurrentPage(){const o=this.getCurrentPageId();return this.getCollaborators().filter(r=>r.currentPageId===o)}startFollowingUser(o){const r=this._getCollaboratorsQuery().get().filter(c=>c.userId===o),s=this.user.getId();if(s||console.warn("You should set the userId for the current instance before following a user"),r.some(c=>c.followingUserId===s))return this;Ls(()=>{this.stopFollowingUser(),this.updateInstanceState({followingUserId:o},{ephemeral:!0})});const a=()=>{this.removeListener("frame",l),this.removeListener("stop-following",a)};let i=!1;const l=()=>{const c=[...r].sort((O,F)=>O.lastActivityTimestamp-F.lastActivityTimestamp).pop();if(!c){this.stopFollowingUser();return}const u=c.currentPageId===this.getCurrentPageId(),f=u?O6:1;if(!u){this.stopFollowingUser(),this.setCurrentPage(c.currentPageId),this.startFollowingUser(o);return}const{center:h,width:d,height:p}=this.getViewportPageBounds(),y=mt.From(c.screenBounds),g=y.width/c.camera.z,b=y.height/c.camera.z,m=new q(g/2-c.camera.x,b/2-c.camera.y),v=c.followingUserId===s,x=d+(g-d)*f,w=p+(b-p)*f,S=v?p/w:Math.min(d/x,p/w),k=Ba(this.getCamera().z*S,oh,Va),_=this.getViewportScreenBounds().w/k,C=this.getViewportScreenBounds().h/k,P=m.sub(h),A=q.Add(h,q.Mul(P,f)),I=q.Sub(A,h).len(),N=Math.abs(k-this.getCamera().z);if(I<L6&&N<D6){i=!0;return}i&&I<R6&&N<F6||(i=!1,this.stopCameraAnimation(),this._setCamera({x:-(A.x-_/2),y:-(A.y-C/2),z:k}))};return this.once("stop-following",a),this.addListener("frame",l),this}stopFollowingUser(){return this.updateInstanceState({followingUserId:null},{ephemeral:!0}),this.emit("stop-following"),this}getCameraState(){return this._cameraState.get()}getUnorderedRenderingShapes(o){const r=[];let s=zi*2,a=zi;const i=this.getErasingShapeIds(),l=(u,f,h)=>{const d=this.getShape(u);if(!d)return;f*=d.opacity;let p=!1;const y=this.getShapeUtil(d);o&&(p=!h&&i.includes(u),p&&(f*=.32)),r.push({id:u,shape:d,util:y,index:s,backgroundIndex:a,opacity:f}),s+=1,a+=1;const g=this.getSortedChildIdsForParent(u);if(!g.length)return;let b=null;y.providesBackgroundForChildren(d)&&(b=a,a=s,s+=zi);for(const m of g)l(m,f,h||p);b!==null&&(a=b)},c=o?[this.getCurrentPage()]:this.getPages();for(const u of c)for(const f of this.getSortedChildIdsForParent(u.id))l(f,1,!1);return r}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(QR)}getRenderingBounds(){return this._renderingBounds.get()}updateRenderingBounds(){const o=this.getViewportPageBounds();return o.equals(this._renderingBounds.__unsafe__getWithoutCapture())?this:(this._renderingBounds.set(o.clone()),this)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort($n)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(o){return this.store.get(typeof o=="string"?o:o.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getCurrentPageShapeIdsSorted(){return Array.from(this.getCurrentPageShapeIds()).sort()}getPageShapeIds(o){const r=typeof o=="string"?o:o.id,s=this.store.query.exec("shape",{parentId:{eq:r}});return this.getShapeAndDescendantIds(s.map(a=>a.id))}setCurrentPage(o,r){const s=typeof o=="string"?o:o.id;return this._setCurrentPageId(s,r),this}updatePage(o,r){return this._updatePage(o,r),this}createPage(o){return this._createPage(o),this}deletePage(o){const r=typeof o=="string"?o:o.id;return this._deletePage(r),this}duplicatePage(o,r=Ui.createId()){if(this.getPages().length>=pm)return this;const s=typeof o=="string"?o:o.id,a=this.getPage(s);if(!a)return this;const i={...this.getCamera()},l=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(a.id));return this.batch(()=>{var f;const c=this.getPages(),u=Gd(a.index,(f=c[c.indexOf(a)+1])==null?void 0:f.index);if(this.createPage({name:a.name+" Copy",id:r,index:u}),this.setCurrentPage(r),this.setCamera(i),l)return this.putContentOntoCurrentPage(l)}),this}renamePage(o,r,s){const a=typeof o=="string"?o:o.id;return this.getInstanceState().isReadonly?this:(this.updatePage({id:a,name:r},s),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(o){return this._createAssets(o),this}updateAssets(o){return this._updateAssets(o),this}deleteAssets(o){const r=typeof o[0]=="string"?o:o.map(s=>s.id);return this._deleteAssets(r),this}getAsset(o){return this.store.get(typeof o=="string"?o:o.id)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",o=>this.getShapeUtil(o).getGeometry(o),(o,r)=>o.props===r.props)}getShapeGeometry(o){return this._getShapeGeometryCache().get(typeof o=="string"?o:o.id)}_getShapeHandlesCache(){return this.store.createComputedCache("handles",o=>{var r,s;return(s=(r=this.getShapeUtil(o)).getHandles)==null?void 0:s.call(r,o)})}getShapeHandles(o){return this._getShapeHandlesCache().get(typeof o=="string"?o:o.id)}getShapeLocalTransform(o){const r=typeof o=="string"?o:o.id,s=this.getShape(r);if(!s)throw Error("Editor.getTransform: shape not found");return vt.Identity().translate(s.x,s.y).rotate(s.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",o=>{if(Io(o.parentId))return this.getShapeLocalTransform(o);const r=this._getShapePageTransformCache().get(o.parentId)??vt.Identity();return vt.Compose(r,this.getShapeLocalTransform(o))})}getShapeParentTransform(o){const r=typeof o=="string"?o:o.id,s=this.getShape(r);return!s||Io(s.parentId)?vt.Identity():this._getShapePageTransformCache().get(s.parentId)??vt.Identity()}getShapePageTransform(o){const r=typeof o=="string"?o:o.id;return this._getShapePageTransformCache().get(r)??vt.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",o=>{const r=this._getShapePageTransformCache().get(o.id);return r?mt.FromPoints(vt.applyToPoints(r,this.getShapeGeometry(o).vertices)):new mt})}getShapePageBounds(o){return this._getShapePageBoundsCache().get(typeof o=="string"?o:o.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",o=>{const r=this._getShapeMaskCache().get(o.id);if(!r)return;if(r.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const s=this._getShapePageTransformCache().get(o.id);return s?`polygon(${vt.applyToPoints(vt.Inverse(s),r).map(a=>`${a.x}px ${a.y}px`).join(",")})`:void 0})}getShapeClipPath(o){return this._getShapeClipPathCache().get(typeof o=="string"?o:o.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",o=>{if(Io(o.parentId))return;const r=this.getShapeAncestors(o.id).filter(s=>this.isShapeOfType(s,"frame"));return r.length===0?void 0:r.map(s=>this._getShapePageTransformCache().get(s.id).applyToPoints(this.getShapeGeometry(s).vertices)).reduce((s,a)=>{if(!(a&&s))return;const i=JC(s,a);return i?i.map(q.Cast):[]})})}getShapeMask(o){return this._getShapeMaskCache().get(typeof o=="string"?o:o.id)}getShapeMaskedPageBounds(o){return typeof o!="string"&&(o=o.id),this._getShapeMaskedPageBoundsCache().get(o)}_getShapeMaskedPageBoundsCache(){return this.store.createComputedCache("shapeMaskedPageBoundsCache",o=>{const r=this._getShapePageBoundsCache().get(o.id);if(!r)return;const s=this._getShapeMaskCache().get(o.id);if(s){if(s.length===0)return;const{corners:a}=r;if(a.every((l,c)=>l&&q.Equals(l,s[c])))return r.clone();const i=JC(s,a);return i?mt.FromPoints(i):void 0}return r})}getShapeAncestors(o,r=[]){const s=typeof o=="string"?o:o.id,a=this.getShape(s);if(!a)return r;const i=a.parentId;if(Io(i))return r.reverse(),r;const l=this.store.get(i);return l?(r.push(l),this.getShapeAncestors(l,r)):r}findShapeAncestor(o,r){const s=typeof o=="string"?o:o.id,a=this.getShape(s);if(!a)return;const i=a.parentId;if(Io(i))return;const l=this.getShape(i);if(l)return r(l)?l:this.findShapeAncestor(l,r)}hasAncestor(o,r){const s=typeof o=="string"?o:o==null?void 0:o.id,a=s&&this.getShape(s);return a?a.parentId===r?!0:this.hasAncestor(this.getShapeParent(a),r):!1}findCommonAncestor(o,r){var u;if(o.length===0)return;const s=typeof o[0]=="string"?o:o.map(f=>f.id),a=Lt(s.map(f=>this.getShape(f)));if(a.length===1){const f=a[0].parentId;return Io(f)?void 0:r?(u=this.findShapeAncestor(a[0],r))==null?void 0:u.id:f}const[i,...l]=a;let c=this.getShapeParent(i);for(;c;){if(r&&!r(c)){c=this.getShapeParent(c);continue}if(l.every(f=>this.hasAncestor(f,c.id)))return c.id;c=this.getShapeParent(c)}}isShapeOrAncestorLocked(o){const r=typeof o=="string"?this.getShape(o):o;return r===void 0?!1:r.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(r))}_notVisibleShapes(){return ZU(this)}getCulledShapes(){const o=this._notVisibleShapes().get(),r=this.getSelectedShapeIds(),s=this.getEditingShapeId(),a=new Set(o);return s&&a.delete(s),r.forEach(i=>{a.delete(i)}),a}getCurrentPageBounds(){let o;return this.getCurrentPageShapeIdsSorted().forEach(r=>{const s=this.getShapeMaskedPageBounds(r);s&&(o?o=o.expand(s):o=s.clone())}),o}getSelectedShapeAtPoint(o){const r=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(s=>s.type!=="group"&&r.includes(s.id)).reverse().find(s=>this.isPointInShape(s,o,{hitInside:!0,margin:0}))}getShapeAtPoint(o,r={}){const s=this.getZoomLevel(),a=this.getViewportPageBounds(),{filter:i,margin:l=0,hitLabels:c=!1,hitInside:u=!1,hitFrameInside:f=!1}=r;let h=1/0,d=null,p=1/0,y=null;const g=(r.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(b=>{if(this.isShapeOfType(b,"group"))return!1;const m=this.getShapeMask(b);return m&&!es(o,m)?!1:i?i(b):!0});for(let b=g.length-1;b>=0;b--){const m=g[b],v=this.getShapeGeometry(m),x=v instanceof Ns,w=this.getPointInShapeSpace(m,o);if((this.isShapeOfType(m,"arrow")||this.isShapeOfType(m,"geo")&&m.props.fill==="none")&&m.props.text.trim()){for(const k of v.children)if(k.isLabel&&k.isPointInBounds(w))return m}if(this.isShapeOfType(m,"frame")){const k=v.distanceToPoint(w,u);if(Math.abs(k)<=l)return y||m;if(v.hitTestPoint(w,0,!0))return y||d||(f?m:void 0);continue}let S;if(x){let k=1/0;for(const _ of v.children){if(_.isLabel&&!c)continue;const C=_.distanceToPoint(w,u);C<k&&(k=C)}S=k}else l===0&&(v.bounds.w<1||v.bounds.h<1)||v.bounds.containsPoint(w,l)?S=v.distanceToPoint(w,u):S=1/0;if(v.isClosed){if(S<=l){if(v.isFilled||x&&v.children[0].isFilled)return y||m;if(this.getShapePageBounds(m).contains(a))continue;if(Math.abs(S)<l)Math.abs(S)<p&&(p=Math.abs(S),y=m);else if(!y){const{area:k}=v;k<h&&(h=k,d=m)}}}else if(S<Gi/s)return m}return y||d||void 0}getShapesAtPoint(o,r={}){return this.getCurrentPageShapes().filter(s=>this.isPointInShape(s,o,r))}isPointInShape(o,r,s={}){const{hitInside:a=!1,margin:i=0}=s,l=typeof o=="string"?o:o.id,c=this.getShapeMask(l);return c&&!es(r,c)?!1:this.getShapeGeometry(l).hitTestPoint(this.getPointInShapeSpace(o,r),i,a)}getPointInShapeSpace(o,r){const s=typeof o=="string"?o:o.id;return this._getShapePageTransformCache().get(s).clone().invert().applyToPoint(r)}getPointInParentSpace(o,r){const s=typeof o=="string"?o:o.id,a=this.getShape(s);if(!a)return new q(0,0);if(Io(a.parentId))return q.From(r);const i=this.getShapePageTransform(a.parentId);return i?i.clone().invert().applyToPoint(r):q.From(r)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),o=>this.store.get(o))}getCurrentPageShapesSorted(){const o=[],r=this.getSortedChildIdsForParent(this.getCurrentPageId());for(let s=0,a=r.length;s<a;s++)gP(this,r[s],o);return o}getCurrentPageRenderingShapesSorted(){const o=this.getCulledShapes();return this.getCurrentPageShapesSorted().filter(({id:r})=>!o.has(r))}isShapeOfType(o,r){const s=typeof o=="string"?this.getShape(o):o;return s?s.type===r:!1}getShape(o){const r=typeof o=="string"?o:o.id;if(Zo(r))return this.store.get(r)}getShapeParent(o){const r=typeof o=="string"?o:o==null?void 0:o.id;if(!r)return;const s=this.getShape(r);if(!(s===void 0||!Zo(s.parentId)))return this.store.get(s.parentId)}getShapeNearestSibling(o,r){return r?r.parentId===o.parentId?r:this.findShapeAncestor(r,s=>s.parentId===o.parentId):void 0}isShapeInPage(o,r=this.getCurrentPageId()){const s=typeof o=="string"?o:o.id,a=this.getShape(s);if(!a)return!1;let i=!1;if(a.parentId===r)i=!0;else{let l=this.getShape(a.parentId);e:for(;l;){if(l.parentId===r){i=!0;break e}l=this.getShape(l.parentId)}}return i}getAncestorPageId(o){const r=typeof o=="string"?o:o==null?void 0:o.id,s=r&&this.getShape(r);if(s)return Io(s.parentId)?s.parentId:this.getAncestorPageId(this.getShape(s.parentId))}reparentShapes(o,r,s){const a=typeof o[0]=="string"?o:o.map(y=>y.id);if(a.length===0)return this;const i=[],l=Io(r)?vt.Identity():this.getShapePageTransform(r),c=l.rotation();let u=[];const f=Lt(this.getSortedChildIdsForParent(r).map(y=>this.getShape(y)));if(s){const y=f.find(g=>g.index===s);if(y){const g=f[f.indexOf(y)+1];g?u=Wc(s,g.index,a.length):u=fb(s,a.length)}else{const g=f.sort($n).find(b=>b.index>s);g?u=Wc(s,g.index,a.length):u=fb(s,a.length)}}else{const y=f.length&&f[f.length-1];u=y?fb(y.index,a.length):Vd(a.length)}const h=l.clone().invert(),d=Lt(a.map(y=>this.getShape(y))),p=d.filter(y=>y.isLocked);p.length&&this.updateShapes(p.map(({id:y,type:g})=>({id:y,type:g,isLocked:!1})));for(let y=0;y<d.length;y++){const g=d[y],b=this.getShapePageTransform(g);if(!b)continue;const m=b.point();if(!m)continue;const v=h.applyToPoint(m),x=b.rotation()-c;i.push({id:g.id,type:g.type,parentId:r,x:v.x,y:v.y,rotation:x,index:u[y],isLocked:g.isLocked})}return this.updateShapes(i),this}getHighestIndexForParent(o){const r=typeof o=="string"?o:o.id,s=this._parentIdsToChildIds.get()[r];if(!s||s.length===0)return"a1";const a=this.getShape(s[s.length-1]);return Di(a.index)}getSortedChildIdsForParent(o){const r=typeof o=="string"?o:o.id,s=this._parentIdsToChildIds.get()[r];return s?this._childIdsCache.get(s,()=>s):Li}visitDescendants(o,r){const s=typeof o=="string"?o:o.id,a=this.getSortedChildIdsForParent(s);for(const i of a)r(i)!==!1&&this.visitDescendants(i,r);return this}getShapeAndDescendantIds(o){const r=new Set,s=[...o];for(;s.length>0;){const a=s.pop();if(!a)break;if(!r.has(a)){r.add(a);for(const i of this.getSortedChildIdsForParent(a))s.push(i)}}return r}getDroppingOverShape(o,r=[]){const s=this.getCurrentPageShapesSorted();for(let a=s.length-1;a>=0;a--){const i=s[a];if(this.getSelectedShapeIds().includes(i.id)||!this.getShapeUtil(i).canDropShapes(i,r)||r.find(c=>c.id===i.id||this.hasAncestor(i,c.id)))continue;const l=this.getShapeMaskedPageBounds(i.id);if(l&&l.containsPoint(o)&&this.getShapeGeometry(i).hitTestPoint(this.getPointInShapeSpace(i,o),0,!0))return i}}getOutermostSelectableShape(o,r){const s=typeof o=="string"?o:o.id,a=this.getShape(s);let i=a,l=a;const c=this.getFocusedGroup();for(;l;){if(this.isShapeOfType(l,"group")&&(c==null?void 0:c.id)!==l.id&&!this.hasAncestor(c,l.id)&&((r==null?void 0:r(l))??!0))i=l;else if((c==null?void 0:c.id)===l.id)break;l=this.getShapeParent(l)}return i}rotateShapesBy(o,r){if((typeof o[0]=="string"?o:o.map(a=>a.id)).length<=0)return this;const s=sP({editor:this});return s?(Pm({delta:r,snapshot:s,editor:this,stage:"one-off"}),this):this}getChangesToTranslateShape(o,r){var i,l,c;let s=o;const a=this.getShapeUtil(o);return s=gh(s,((i=a.onTranslateStart)==null?void 0:i.call(a,s))??void 0),s=gh(s,{id:o.id,type:o.type,x:r.x,y:r.y}),s=gh(s,((l=a.onTranslate)==null?void 0:l.call(a,o,s))??void 0),s=gh(s,((c=a.onTranslateEnd)==null?void 0:c.call(a,o,s))??void 0),s}nudgeShapes(o,r,s){const a=typeof o[0]=="string"?o:o.map(l=>l.id);if(a.length<=0)return this;const i=[];for(const l of a){const c=this.getShape(l),u=q.From(r),f=this.getShapeParentTransform(c);f&&u.rot(-f.rotation()),i.push(this.getChangesToTranslateShape(c,u.add(c)))}return this.updateShapes(i,{squashing:!0,...s}),this}duplicateShapes(o,r){const s=typeof o[0]=="string"?o:o.map(f=>f.id);if(s.length<=0)return this;const a=new Set(s),i=[],l=[...s];for(;l.length>0;){const f=l.pop();if(!f)break;i.push(f),this.getSortedChildIdsForParent(f).forEach(h=>l.push(h))}i.reverse();const c=new Map(i.map(f=>[f,ur()])),u=Lt(i.map(f=>{const h=this.getShape(f);if(!h)return null;const d=c.get(f);let p=0,y=0;if(r&&a.has(f)){const k=this.getShapeParentTransform(h),_=new q(r.x,r.y).rot(-k.rotation());p=_.x,y=_.y}const g=h.parentId??this.getCurrentPageId(),b=this.getSortedChildIdsForParent(g),m=b.indexOf(h.id),v=b[m+1],x=v?this.getShape(v):null,w=x?Gd(h.index,x.index):Di(h.index);let S=wr(h);if(this.isShapeOfType(h,"arrow")&&this.isShapeOfType(S,"arrow")){const k=this.getArrowInfo(h);let _,C;if(h.props.start.type==="binding"&&(_=c.get(h.props.start.boundShapeId),!_))if(k!=null&&k.isValid){const{x:A,y:I}=k.start.point;S.props.start={type:"point",x:A,y:I}}else{const{start:A}=zs(this,h);S.props.start={type:"point",x:A.x,y:A.y}}if(h.props.end.type==="binding"&&(C=c.get(h.props.end.boundShapeId),!C))if(k!=null&&k.isValid){const{x:A,y:I}=k.end.point;S.props.end={type:"point",x:A,y:I}}else{const{end:A}=zs(this,h);S.props.start={type:"point",x:A.x,y:A.y}}const P=fh(S)?mh(this,S):u1(this,S);if(k!=null&&k.isValid&&(P!=null&&P.isValid)&&!fh(h)){const A=q.Med(k.start.handle,k.end.handle),I=q.Dist(k.middle,A),N=q.Dist(P.middle,A);S.props.bend<0?S.props.bend+=N-I:S.props.bend-=N-I}S.props.start.type==="binding"&&_&&(S.props.start.boundShapeId=_),S.props.end.type==="binding"&&C&&(S.props.end.boundShapeId=C)}return S={...S,id:d,x:h.x+p,y:h.y+y,index:w},S}));return u.forEach(f=>{Zo(f.parentId)&&c.has(f.parentId)&&(f.parentId=c.get(f.parentId))}),this.history.batch(()=>{const f=u.length+this.getCurrentPageShapeIds().size>zi;f&&Lm(this);const h=f?u.slice(0,zi-this.getCurrentPageShapeIds().size):u,d=h.map(p=>p.id);if(this.createShapes(h),this.setSelectedShapes(d),r!==void 0){const p=this.getSelectionPageBounds(),y=this.getViewportPageBounds();p&&!y.contains(p)&&this.centerOnPoint(p.center,{duration:si})}}),this}moveShapesToPage(o,r){const s=typeof o[0]=="string"?o:o.map(c=>c.id);if(s.length===0)return this;if(this.getInstanceState().isReadonly)return this;const a=this.getCurrentPageId();if(r===a)return this;if(!this.store.has(r))return this;const i=this.getContentFromCurrentPage(s);if(!i)return this;if(this.getPageShapeIds(r).size+i.shapes.length>zi)return Lm(this,r),this;const l=this.getCamera().z;return this.history.batch(()=>{this.deleteShapes(s),this.setCurrentPage(r),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(i,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:l}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(o){const r=typeof o[0]=="string"?o:o.map(l=>l.id);if(this.getInstanceState().isReadonly||r.length===0)return this;let s=!0,a=!0;const i=[];for(const l of r){const c=this.getShape(l);c&&(i.push(c),c.isLocked?a=!1:s=!1)}return this.batch(()=>{a?(this.updateShapes(i.map(l=>({id:l.id,type:l.type,isLocked:!0}))),this.setSelectedShapes([])):s?this.updateShapes(i.map(l=>({id:l.id,type:l.type,isLocked:!1}))):this.updateShapes(i.map(l=>({id:l.id,type:l.type,isLocked:!0})))}),this}sendToBack(o){const r=typeof o[0]=="string"?o:o.map(a=>a.id),s=Cm(this,"toBack",r);return s&&this.updateShapes(s),this}sendBackward(o){const r=typeof o[0]=="string"?o:o.map(a=>a.id),s=Cm(this,"backward",r);return s&&this.updateShapes(s),this}bringForward(o){const r=typeof o[0]=="string"?o:o.map(a=>a.id),s=Cm(this,"forward",r);return s&&this.updateShapes(s),this}bringToFront(o){const r=typeof o[0]=="string"?o:o.map(a=>a.id),s=Cm(this,"toFront",r);return s&&this.updateShapes(s),this}flipShapes(o,r){const s=typeof o[0]=="string"?o:o.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;let a=Lt(s.map(l=>this.getShape(l)));if(!a.length)return this;a=Lt(a.map(l=>this.isShapeOfType(l,"group")?this.getSortedChildIdsForParent(l.id).map(c=>this.getShape(c)):l).flat());const i=mt.Common(Lt(a.map(l=>this.getShapePageBounds(l)))).center;return this.batch(()=>{for(const l of a){const c=this.getShapeGeometry(l).bounds,u=this.getShapePageTransform(l.id);u&&this.resizeShape(l.id,{x:r==="horizontal"?-1:1,y:r==="vertical"?-1:1},{initialBounds:c,initialPageTransform:u,initialShape:l,mode:"scale_shape",scaleOrigin:i,scaleAxisRotation:0})}}),this}stackShapes(o,r,s){const a=typeof o[0]=="string"?o:o.map(b=>b.id);if(this.getInstanceState().isReadonly)return this;const i=Lt(a.map(b=>this.getShape(b)).filter(b=>!(!b||this.isShapeOfType(b,"arrow")&&(b.props.start.type==="binding"||b.props.end.type==="binding")))),l=i.length;if(s===0&&l<3||l<2)return this;const c=Object.fromEntries(i.map(b=>[b.id,this.getShapePageBounds(b)]));let u,f,h,d;r==="horizontal"?(u="x",f="minX",h="maxX",d="width"):(u="y",f="minY",h="maxY",d="height");let p;if(s===0){const b=[];i.sort((v,x)=>c[v.id][f]-c[x.id][f]);for(let v=0;v<l-1;v++){const x=i[v],w=i[v+1],S=c[x.id],k=c[w.id][f]-S[h],_=b.find(C=>C.gap===k);_?_.count++:b.push({gap:k,count:1})}let m=0;b.forEach(v=>{v.count>m&&(m=v.count,p=v.gap)}),m===1&&(p=Math.max(0,b.reduce((v,x)=>v+x.gap*x.count,0)/(l-1)))}else p=s;const y=[];let g=c[i[0].id][h];return i.forEach((b,m)=>{var k,_;if(m===0)return;const v={x:0,y:0};v[u]=g+p-c[b.id][u];const x=this.getShapeParent(b),w=x?q.Rot(v,-this.getShapePageTransform(x).decompose().rotation):v,S=(_=(k=this.getShapeUtil(b)).onTranslateStart)==null?void 0:_.call(k,b);y.push(S?{...S,[u]:b[u]+w[u]}:{id:b.id,type:b.type,[u]:b[u]+w[u]}),g+=c[b.id][d]+p}),this.updateShapes(y),this}packShapes(o,r){var _,C;const s=typeof o[0]=="string"?o:o.map(P=>P.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const a=Lt(s.map(P=>this.getShape(P)).filter(P=>!(!P||this.isShapeOfType(P,"arrow")&&(P.props.start.type==="binding"||P.props.end.type==="binding")))),i={},l={};let c,u,f=0;for(let P=0;P<a.length;P++)c=a[P],u=this.getShapePageBounds(c),i[c.id]=u,l[c.id]=u.clone(),f+=u.width*u.height;const h=mt.Common(Lt(Object.values(i))),d=h.width;a.sort((P,A)=>i[A.id].height-i[P.id].height);const p=Math.max(Math.ceil(Math.sqrt(f/.95)),d),y=[new mt(h.x,h.y,p,1/0)];let g=0,b=0,m,v;for(let P=0;P<a.length;P++){c=a[P],u=l[c.id];for(let A=y.length-1;A>=0;A--)if(m=y[A],!(u.width>m.width||u.height>m.height)){u.x=m.x,u.y=m.y,b=Math.max(b,u.maxY),g=Math.max(g,u.maxX),u.width===m.width&&u.height===m.height?(v=y.pop(),A<y.length&&(y[A]=v)):u.height===m.height?(m.x+=u.width+r,m.width-=u.width+r):u.width===m.width?(m.y+=u.height+r,m.height-=u.height+r):(y.push(new mt(m.x+(u.width+r),m.y,m.width-(u.width+r),u.height)),m.y+=u.height+r,m.height-=u.height+r);break}}const x=mt.Common(Object.values(l)),w=q.Sub(h.center,x.center);let S;const k=[];for(let P=0;P<a.length;P++){c=a[P],u=i[c.id],S=l[c.id];const A=q.Sub(S.point,u.point).add(w),I=this.getShapeParentTransform(c);I&&A.rot(-I.rotation());const N={id:c.id,type:c.type,x:c.x+A.x,y:c.y+A.y},O=(C=(_=this.getShapeUtil(c)).onTranslateStart)==null?void 0:C.call(_,{...c,...N});O?k.push({...N,...O}):k.push(N)}return k.length&&this.updateShapes(k),this}alignShapes(o,r){const s=typeof o[0]=="string"?o:o.map(u=>u.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const a=Lt(s.map(u=>this.getShape(u))),i=Object.fromEntries(a.map(u=>[u.id,this.getShapePageBounds(u)])),l=mt.Common(Lt(Object.values(i))),c=[];return a.forEach(u=>{const f=i[u.id];if(!f)return;const h={x:0,y:0};switch(r){case"top":{h.y=l.minY-f.minY;break}case"center-vertical":{h.y=l.midY-f.minY-f.height/2;break}case"bottom":{h.y=l.maxY-f.minY-f.height;break}case"left":{h.x=l.minX-f.minX;break}case"center-horizontal":{h.x=l.midX-f.minX-f.width/2;break}case"right":{h.x=l.maxX-f.minX-f.width;break}}const d=this.getShapeParent(u),p=d?q.Rot(h,-this.getShapePageTransform(d).decompose().rotation):h;c.push(this.getChangesToTranslateShape(u,q.Add(u,p)))}),this.updateShapes(c),this}distributeShapes(o,r){const s=typeof o[0]=="string"?o:o.map(x=>x.id);if(this.getInstanceState().isReadonly)return this;if(s.length<3)return this;const a=s.length,i=Lt(s.map(x=>this.getShape(x))),l=Object.fromEntries(i.map(x=>[x.id,this.getShapePageBounds(x)]));let c,u,f,h,d;r==="horizontal"?(c="x",u="minX",f="maxX",h="midX",d="width"):(c="y",u="minY",f="maxY",h="midY",d="height");const p=[],y=i.sort((x,w)=>l[x.id][u]-l[w.id][u])[0],g=i.sort((x,w)=>l[w.id][f]-l[x.id][f])[0],b=l[y.id][h],m=(l[g.id][h]-b)/(a-1),v=b+m;return i.filter(x=>x!==y&&x!==g).sort((x,w)=>l[x.id][h]-l[w.id][h]).forEach((x,w)=>{const S={x:0,y:0};S[c]=v+m*w-l[x.id][d]/2-l[x.id][c];const k=this.getShapeParent(x),_=k?q.Rot(S,-this.getShapePageTransform(k).rotation()):S;p.push(this.getChangesToTranslateShape(x,q.Add(x,_)))}),this.updateShapes(p),this}stretchShapes(o,r){const s=typeof o[0]=="string"?o:o.map(u=>u.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const a=Lt(s.map(u=>this.getShape(u))),i=Object.fromEntries(s.map(u=>[u,this.getShapeGeometry(u).bounds])),l=Object.fromEntries(s.map(u=>[u,this.getShapePageBounds(u)])),c=mt.Common(Lt(Object.values(l)));switch(r){case"vertical":{this.batch(()=>{for(const u of a){if(this.getShapePageTransform(u).rotation()%nr)continue;const f=i[u.id],h=l[u.id],d=new q(0,c.minY-h.minY),p=this.getShapeParentTransform(u);p&&d.rot(-p.rotation());const{x:y,y:g}=q.Add(d,u);this.updateShapes([{id:u.id,type:u.type,x:y,y:g}],{squashing:!0});const b=new q(1,c.height/h.height);this.resizeShape(u.id,b,{initialBounds:f,scaleOrigin:new q(h.center.x,c.minY),scaleAxisRotation:0})}});break}case"horizontal":{this.batch(()=>{for(const u of a){const f=i[u.id],h=l[u.id];if(this.getShapePageTransform(u).rotation()%nr)continue;const d=new q(c.minX-h.minX,0),p=this.getShapeParentTransform(u);p&&d.rot(-p.rotation());const{x:y,y:g}=q.Add(d,u);this.updateShapes([{id:u.id,type:u.type,x:y,y:g}],{squashing:!0});const b=new q(c.width/h.width,1);this.resizeShape(u.id,b,{initialBounds:f,scaleOrigin:new q(c.minX,h.center.y),scaleAxisRotation:0})}});break}}return this}resizeShape(o,r,s={}){var p;const a=typeof o=="string"?o:o.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(r.x)||(r=new q(1,r.y)),Number.isFinite(r.y)||(r=new q(r.x,1));const i=s.initialShape??this.getShape(a);if(!i)return this;const l=s.scaleOrigin??((p=this.getShapePageBounds(a))==null?void 0:p.center);if(!l)return this;const c=s.initialPageTransform?vt.Cast(s.initialPageTransform):this.getShapePageTransform(a);if(!c)return this;const u=c.rotation();if(u==null)return this;const f=s.scaleAxisRotation??u,h=s.initialBounds??this.getShapeGeometry(a).bounds;if(!h)return this;if(!zE(u,f))return this._resizeUnalignedShape(a,r,{...s,initialBounds:h,scaleOrigin:l,scaleAxisRotation:f,initialPageTransform:c,initialShape:i});const d=this.getShapeUtil(i);if(d.isAspectRatioLocked(i)&&(Math.abs(r.x)>Math.abs(r.y)?r=new q(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new q(Math.sign(r.x)*Math.abs(r.y),r.y)),d.onResize&&d.canResize(i)){const y=this._scalePagePoint(vt.applyToPoint(c,new q(0,0)),l,r,f),g=this.getPointInParentSpace(i.id,y),b=new q(r.x,r.y),m=th((u-f)%Math.PI,0);b.x=m?r.x:r.y,b.y=m?r.y:r.x;const v=vt.applyToPoint(c,new q),{x,y:w}=this.getPointInParentSpace(i.id,v);this.updateShapes([{id:a,type:i.type,x:g.x,y:g.y,...d.onResize({...i,x,y:w},{newPoint:g,handle:s.dragHandle??"bottom_right",mode:s.mode??"scale_shape",scaleX:b.x,scaleY:b.y,initialBounds:h,initialShape:i})}],{squashing:!0})}else{const y=vt.applyToPoint(c,h.center),g=this._scalePagePoint(y,l,r,f),b=this.getPointInParentSpace(i.id,y),m=this.getPointInParentSpace(i.id,g),v=q.Sub(m,b);this.updateShapes([{id:a,type:i.type,x:i.x+v.x,y:i.y+v.y}],{squashing:!0})}return this}_scalePagePoint(o,r,s,a){const i=q.RotWith(o,r,-a).sub(r),l=q.MulV(i,s);return q.Add(l,r).rotWith(r,a)}_resizeUnalignedShape(o,r,s){const{type:a}=s.initialShape,i=new q(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?i.x=Math.sign(r.x)*Math.abs(r.y):i.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(o,i,{initialShape:s.initialShape,initialBounds:s.initialBounds}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:m}=vt.Decompose(s.initialPageTransform);m-=2*m,this.updateShapes([{id:o,type:a,rotation:m}],{squashing:!0})}const l=vt.applyToPoint(s.initialPageTransform,s.initialBounds.center),c=this._scalePagePoint(l,s.scaleOrigin,r,s.scaleAxisRotation),u=this.getShapePageBounds(o),f=this.getShapePageTransform(o),h=u.center,d=f.point();if(!h||!d)return this;const p=q.Sub(c,h),y=q.Add(d,p),{x:g,y:b}=this.getPointInParentSpace(o,y);return this.updateShapes([{id:o,type:a,x:g,y:b}],{squashing:!0}),this}getInitialMetaForShape(o){return{}}createShape(o){return this._createShapes([o]),this}createShapes(o){if(!Array.isArray(o))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");return this._createShapes(o),this}animateShape(o,r){return this.animateShapes([o],r)}animateShapes(o,r={}){const{duration:s=500,easing:a=Kn.linear}=r,i=Ir();let l=s,c;const u=[];let f,h;for(let y=0,g=o.length;y<g;y++){if(f=o[y],!f)continue;h={partial:f,values:[]};const b=this.getShape(f.id);if(b){for(const m of["x","y","rotation"])f[m]!==void 0&&b[m]!==f[m]&&h.values.push({prop:m,from:b[m],to:f[m]});u.push(h),this.animatingShapes.set(b.id,i)}}let d;const p=y=>{if(l-=y,l<0){const{animatingShapes:v}=this,x=o.filter(w=>w&&v.get(w.id)===i);x.length&&this.updateShapes(x,{squashing:!1}),this.removeListener("tick",p);return}c=a(1-l/s);const{animatingShapes:g}=this,b=[];let m;for(let v=0,x=u.length;v<x;v++)d=u[v],m=g.get(d.partial.id),m===i&&b.push({id:d.partial.id,type:d.partial.type,...d.values.reduce((w,{prop:S,from:k,to:_})=>(w[S]=k+(_-k)*c,w),{})});this._updateShapes(b,{squashing:!0})};return this.addListener("tick",p),this}groupShapes(o,r=ur()){var p;if(!Array.isArray(o))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const s=typeof o[0]=="string"?o:o.map(y=>y.id);if(s.length<=1)return this;const a=Lt(this._getUnlockedShapeIds(s).map(y=>this.getShape(y))),i=a.sort($n).map(y=>y.id),l=mt.Common(Lt(a.map(y=>this.getShapePageBounds(y)))),{x:c,y:u}=l.point,f=this.findCommonAncestor(a)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const h=a.filter(y=>y.parentId===f).sort($n),d=(p=h[h.length-1])==null?void 0:p.index;return this.batch(()=>{this.createShapes([{id:r,type:"group",parentId:f,index:d,x:c,y:u,opacity:1,props:{}}]),this.reparentShapes(i,r),this.select(r)}),this}ungroupShapes(o){const r=typeof o[0]=="string"?o:o.map(l=>l.id);if(this.getInstanceState().isReadonly)return this;if(r.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const s=new Set,a=Lt(r.map(l=>this.getShape(l))),i=[];return a.forEach(l=>{this.isShapeOfType(l,"group")?i.push(l):s.add(l.id)}),i.length===0?this:(this.batch(()=>{let l;for(let c=0,u=i.length;c<u;c++){l=i[c];const f=this.getSortedChildIdsForParent(l.id);for(let h=0,d=f.length;h<d;h++)s.add(f[h]);this.reparentShapes(f,l.parentId,l.index)}this.deleteShapes(i.map(c=>c.id)),this.select(...s)}),this)}updateShape(o,r){return this.updateShapes([o],r),this}updateShapes(o,r){const s=Array(o.length);for(let a=0,i=o.length;a<i;a++){const l=o[a];if(!l)continue;const c=this.getShape(l.id);c&&(this.isShapeOrAncestorLocked(c)&&!Object.hasOwn(l,"isLocked")||(this.animatingShapes.delete(l.id),s.push(l)))}return this._updateShapes(s,r),this}_getUnlockedShapeIds(o){return o.filter(r=>{var s;return!((s=this.getShape(r))!=null&&s.isLocked)})}deleteShapes(o){if(!Array.isArray(o))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");return this._deleteShapes(this._getUnlockedShapeIds(typeof o[0]=="string"?o:o.map(r=>r.id))),this}deleteShape(o){return this.deleteShapes([typeof o=="string"?o:o.id]),this}_extractSharedStyles(o,r){if(this.isShapeOfType(o,"group")){const s=this._parentIdsToChildIds.get()[o.id];if(!s)return;for(let a=0,i=s.length;a<i;a++)this._extractSharedStyles(this.getShape(s[a]),r)}else for(const[s,a]of this.styleProps[o.type])r.applyValue(s,Rs(o.props,a))}_getSelectionSharedStyles(){const o=this.getSelectedShapes(),r=new i1;for(const s of o)this._extractSharedStyles(s,r);return r}getStyleForNextShape(o){const r=this.getInstanceState().stylesForNextShape[o.id];return r===void 0?o.defaultValue:r}getShapeStyleIfExists(o,r){const s=this.styleProps[o.type].get(r);if(s!==void 0)return Rs(o.props,s)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._getSelectionSharedStyles();const o=this.root.getCurrent(),r=new i1;if(!o)return r;if(o.shapeType)for(const s of this.styleProps[o.shapeType].keys())r.applyValue(s,this.getStyleForNextShape(s));return r}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const o=[],r=a=>{const i=this.getShape(a);if(i)if(this.isShapeOfType(i,"group"))for(const l of this.getSortedChildIdsForParent(i.id))r(l);else o.push(i)};for(const a of this.getSelectedShapeIds())r(a);let s=null;for(const a of o)if(s===null)s=a.opacity;else if(s!==a.opacity)return{type:"mixed"};if(s!==null)return{type:"shared",value:s}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(o,r){return this.updateInstanceState({opacityForNextShape:o},r),this}setOpacityForSelectedShapes(o,r){const s=this.getSelectedShapes();if(s.length>0){const a=[],i=l=>{if(this.isShapeOfType(l,"group")){const c=this.getSortedChildIdsForParent(l);for(const u of c)i(this.getShape(u))}else a.push(l)};for(const l of s)i(l);this.updateShapes(a.map(l=>({id:l.id,type:l.type,opacity:o})),r)}return this}setStyleForNextShapes(o,r,s){const a=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...a,[o.id]:r}},s),this}setStyleForSelectedShapes(o,r,s){const a=this.getSelectedShapes();if(a.length>0){const i=[],l=c=>{if(this.isShapeOfType(c,"group")){const u=this.getSortedChildIdsForParent(c.id);for(const f of u)l(this.getShape(f))}else{const u=this.getShapeUtil(c),f=this.styleProps[c.type].get(o);if(f){const h={id:c.id,type:c.type,props:{[f]:r}};i.push({util:u,originalShape:c,updatePartial:h})}}};for(const c of a)l(c);this.updateShapes(i.map(({updatePartial:c})=>c),s)}return this}registerExternalAssetHandler(o,r){return this.externalAssetContentHandlers[o]=r,this}async getAssetForExternalContent(o){var r,s;return await((s=(r=this.externalAssetContentHandlers)[o.type])==null?void 0:s.call(r,o))}registerExternalContentHandler(o,r){return this.externalContentHandlers[o]=r,this}async putExternalContent(o){var r,s;return(s=(r=this.externalContentHandlers)[o.type])==null?void 0:s.call(r,o)}getContentFromCurrentPage(o){const r=typeof o[0]=="string"?o:o.map(c=>c.id);if(!r||r.length===0)return;const s={};let a=Ff(r.map(c=>this.getShape(c)).sort($n).flatMap(c=>{const u=[c];return this.visitDescendants(c.id,f=>{u.push(this.getShape(f))}),u}));a=a.map(c=>{if(s[c.id]=this.getShapePageTransform(c.id),c=wr(c),this.isShapeOfType(c,"arrow")){const u=c.props.start.type==="binding"?c.props.start.boundShapeId:void 0,f=c.props.end.type==="binding"?c.props.end.boundShapeId:void 0,h=this.getArrowInfo(c);if(c.props.start.type==="binding"&&!a.some(p=>p.id===u))if(h!=null&&h.isValid){const{x:p,y}=h.start.point;c.props.start={type:"point",x:p,y}}else{const{start:p}=zs(this,c);c.props.start={type:"point",x:p.x,y:p.y}}if(c.props.end.type==="binding"&&!a.some(p=>p.id===f))if(h!=null&&h.isValid){const{x:p,y}=h.end.point;c.props.end={type:"point",x:p,y}}else{const{end:p}=zs(this,c);c.props.end={type:"point",x:p.x,y:p.y}}const d=fh(c)?mh(this,c):u1(this,c);if(h!=null&&h.isValid&&(d!=null&&d.isValid)&&!fh(c)){const p=q.Med(h.start.handle,h.end.handle),y=q.Dist(h.middle,p),g=q.Dist(d.middle,p);c.props.bend<0?c.props.bend+=g-y:c.props.bend-=g-y}return c}return c});const i=[];a.forEach(c=>{if(a.find(u=>u.id===c.parentId)===void 0){const u=this.getShapePageTransform(c.id),f=u.point(),h=u.rotation();c.x=f.x,c.y=f.y,c.rotation=h,c.parentId=this.getCurrentPageId(),i.push(c.id)}});const l=new Set;return a.forEach(c=>{"assetId"in c.props&&c.props.assetId!==null&&l.add(c.props.assetId)}),{shapes:a,rootShapeIds:i,schema:this.store.schema.serialize(),assets:Lt(Array.from(l).map(c=>this.getAsset(c)))}}putContentOntoCurrentPage(o,r={}){var C;if(this.getInstanceState().isReadonly)return this;if(!o.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:s=!1,preserveIds:a=!1,preservePosition:i=!1}=r;let{point:l=void 0}=r;const c=this.getCurrentPageId(),{rootShapeIds:u}=o,f=[],h=[],d={store:{...Object.fromEntries(o.assets.map(P=>[P.id,P])),...Object.fromEntries(o.shapes.map(P=>[P.id,P]))},schema:o.schema},p=this.store.schema.migrateStoreSnapshot(d);if(p.type==="error")throw Error("Could not put content: could not migrate content");for(const P of Object.values(p.value))switch(P.typeName){case"asset":{f.push(P);break}case"shape":{h.push(P);break}}const y=new Map(h.map(P=>[P.id,ur()]));let g=this.getCurrentPageId(),b=1/0,m=[];for(const P of this.getSelectedShapes()){if(b===0)break;const A=this.isShapeOfType(P,"frame"),I=this.getShapeAncestors(P);A&&I.push(P);const N=A?I.length+1:I.length;if(N<b)b=N,m=I,g=A?P.id:P.parentId;else if(N===b){if(m.length!==I.length)throw Error(`Ancestors: ${m.length} !== ${I.length}`);if(m.length===0){g=c;break}else{g=c;for(let O=0;O<m.length&&I[O]===m[O];O++)g=I[O].id}}}let v=!1;if(!Io(g)){const P=this.getShape(g);if(P){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(P)))g=c;else if(u.length===1){const A=h.find(I=>I.id===u[0]);this.isShapeOfType(P,"frame")&&this.isShapeOfType(A,"frame")&&A.props.w===(P==null?void 0:P.props.w)&&A.props.h===(P==null?void 0:P.props.h)&&(v=!0)}}else g=c}v||(v=y.has(g)),v&&(g=this.getShape(g).parentId);let x=this.getHighestIndexForParent(g);const w=[],S=h.map(P=>{let A;if(a)A=wr(P),y.set(P.id,P.id);else{const I=y.get(P.id);A=wr({...P,id:I})}if(u.includes(P.id)&&(A.parentId=c,w.push(A)),y.has(A.parentId)?A.parentId=y.get(P.parentId):(u.push(A.id),A.index=x,x=Di(x)),this.isShapeOfType(A,"arrow")){if(A.props.start.type==="binding"){const I=y.get(A.props.start.boundShapeId);A.props.start=I?{...A.props.start,boundShapeId:I}:{type:"point",x:0,y:0}}if(A.props.end.type==="binding"){const I=y.get(A.props.end.boundShapeId);A.props.end=I?{...A.props.end,boundShapeId:I}:{type:"point",x:0,y:0}}}return A});if(S.length+this.getCurrentPageShapeIds().size>zi)return Lm(this),this;const k=[],_=[];for(const P of f)this.store.has(P.id)||((P.type==="image"||P.type==="video")&&((C=P.props.src)!=null&&C.startsWith("data:image"))&&(_.push(wr(P)),P.props.src=null),k.push(P));return Promise.allSettled(_.map(async P=>{const A=await HU(P.props.src,P.props.name,P.props.mimeType??"image/png"),I=await this.getAssetForExternalContent({type:"file",file:A});if(!I){this.deleteAssets([P.id]);return}this.updateAssets([{...I,id:P.id}])})),this.batch(()=>{k.length>0&&this.createAssets(k),this.createShapes(S),s&&this.select(...w.map(O=>O.id)),g!==c&&this.reparentShapes(w.map(O=>O.id),g);const P=S.map(O=>this.getShape(O.id)),A=mt.Common(P.map(O=>this.getShapePageBounds(O)));if(l===void 0)if(Io(g)){const O=this.getViewportPageBounds();i||O.includes(mt.From(A))?l=A.center:l=O.center}else{const O=this.getShape(g);l=vt.applyToPoint(this.getShapePageTransform(O),this.getShapeGeometry(O).bounds.center)}if(w.length===1){const O=w[0];if(this.isShapeOfType(O,"frame"))for(;this.getShapesAtPoint(l).some(F=>this.isShapeOfType(F,"frame")&&F.props.w===O.props.w&&F.props.h===O.props.h);)l.x+=A.w+16}const I=mt.Common(Lt(w.map(({id:O})=>this.getShapePageBounds(O)))).center,N=q.Sub(l,I);this.updateShapes(w.map(({id:O})=>{const F=this.getShape(O),U=this.getShapeParentTransform(O).decompose().rotation,G=q.Rot(N,-U);return{id:F.id,type:F.type,x:F.x+G.x,y:F.y+G.y}}))}),this}async getSvgElement(o,r={}){const s=await rB(this,o,r);if(!s)return;const a=document.createDocumentFragment(),i=ik(a);Tl.flushSync(()=>{i.render(s.jsx)});const l=a.firstElementChild;return bn(l instanceof SVGSVGElement,"Expected an SVG element"),i.unmount(),{svg:l,width:s.width,height:s.height}}async getSvgString(o,r={}){const s=await this.getSvgElement(o,r);return s?{svg:new XMLSerializer().serializeToString(s.svg),width:s.width,height:s.height}:void 0}async getSvg(o,r={}){const s=await this.getSvgElement(o,r);if(s)return s.svg}_updateInputsFromEvent(o){var m;const{pointerVelocity:r,previousScreenPoint:s,previousPagePoint:a,currentScreenPoint:i,currentPagePoint:l}=this.inputs,{screenBounds:c}=this.store.unsafeGetWithoutCapture(Ao),{x:u,y:f,z:h}=this.store.unsafeGetWithoutCapture(this.getCameraId()),d=o.point.x-c.x,p=o.point.y-c.y,y=o.point.z??.5;s.setTo(i),a.setTo(l),i.set(d,p);const g=d/h-u,b=p/h-f;isFinite(g)&&isFinite(b)&&l.set(g,b,y),this.inputs.isPen=o.type==="pointer"&&o.isPen,(o.name==="pointer_down"||this.inputs.isPinching)&&r.set(0,0),this.store.put([{id:Xf,typeName:"pointer",x:l.x,y:l.y,lastActivityTimestamp:o.type==="pointer"&&o.pointerId===$E.CAMERA_MOVE?((m=this.store.unsafeGetWithoutCapture(Xf))==null?void 0:m.lastActivityTimestamp)??this._tickManager.now:this._tickManager.now,meta:{}}])}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_flushEventsForTick(o){this.batch(()=>{if(this._pendingEventsForNextTick.length>0){const r=[...this._pendingEventsForNextTick];this._pendingEventsForNextTick.length=0;for(const s of r)this._flushEventForTick(s)}o>0&&this.root.handleEvent({type:"misc",name:"tick",elapsed:o}),this.scribbles.tick(o)})}}gt([Ye],pt.prototype,"getCanUndo",1),gt([Ye],pt.prototype,"getCanRedo",1),gt([Ye],pt.prototype,"_getArrowBindingsIndex",1),gt([Ye],pt.prototype,"getArrowInfoCache",1),gt([Ye],pt.prototype,"getPath",1),gt([Ye],pt.prototype,"getCurrentTool",1),gt([Ye],pt.prototype,"getCurrentToolId",1),gt([Ye],pt.prototype,"getDocumentSettings",1),gt([Ye],pt.prototype,"getInstanceState",1),gt([Ye],pt.prototype,"getOpenMenus",1),gt([Ye],pt.prototype,"getIsMenuOpen",1),gt([Ye],pt.prototype,"getPageStates",1),gt([Ye],pt.prototype,"_getPageStatesQuery",1),gt([Ye],pt.prototype,"getCurrentPageState",1),gt([Ye],pt.prototype,"_getCurrentPageStateId",1),gt([Ye],pt.prototype,"getSelectedShapeIds",1),gt([Ye],pt.prototype,"getSelectedShapes",1),gt([Ye],pt.prototype,"getOnlySelectedShapeId",1),gt([Ye],pt.prototype,"getOnlySelectedShape",1),gt([Ye],pt.prototype,"getSelectionPageBounds",1),gt([Ye],pt.prototype,"getSelectionRotation",1),gt([Ye],pt.prototype,"getSelectionRotatedPageBounds",1),gt([Ye],pt.prototype,"getSelectionRotatedScreenBounds",1),gt([Ye],pt.prototype,"getFocusedGroupId",1),gt([Ye],pt.prototype,"getFocusedGroup",1),gt([Ye],pt.prototype,"getEditingShapeId",1),gt([Ye],pt.prototype,"getEditingShape",1),gt([Ye],pt.prototype,"getHoveredShapeId",1),gt([Ye],pt.prototype,"getHoveredShape",1),gt([Ye],pt.prototype,"getHintingShapeIds",1),gt([Ye],pt.prototype,"getHintingShape",1),gt([Ye],pt.prototype,"getErasingShapeIds",1),gt([Ye],pt.prototype,"getErasingShapes",1),gt([Ye],pt.prototype,"getCameraId",1),gt([Ye],pt.prototype,"getCamera",1),gt([Ye],pt.prototype,"getZoomLevel",1),gt([Ye],pt.prototype,"getViewportScreenBounds",1),gt([Ye],pt.prototype,"getViewportScreenCenter",1),gt([Ye],pt.prototype,"getViewportPageBounds",1),gt([Ye],pt.prototype,"getViewportPageCenter",1),gt([Ye],pt.prototype,"_getCollaboratorsQuery",1),gt([Ye],pt.prototype,"getCollaborators",1),gt([Ye],pt.prototype,"getCollaboratorsOnCurrentPage",1),gt([Ye],pt.prototype,"getRenderingShapes",1),gt([Ye],pt.prototype,"_getAllPagesQuery",1),gt([Ye],pt.prototype,"getPages",1),gt([Ye],pt.prototype,"getCurrentPageId",1),gt([Ye],pt.prototype,"getCurrentPageShapeIdsSorted",1),gt([Ye],pt.prototype,"_getAllAssetsQuery",1),gt([Ye],pt.prototype,"_getShapeGeometryCache",1),gt([Ye],pt.prototype,"_getShapeHandlesCache",1),gt([Ye],pt.prototype,"_getShapePageTransformCache",1),gt([Ye],pt.prototype,"_getShapePageBoundsCache",1),gt([Ye],pt.prototype,"_getShapeClipPathCache",1),gt([Ye],pt.prototype,"_getShapeMaskCache",1),gt([Ye],pt.prototype,"_getShapeMaskedPageBoundsCache",1),gt([Ye],pt.prototype,"_notVisibleShapes",1),gt([Ye],pt.prototype,"getCulledShapes",1),gt([Ye],pt.prototype,"getCurrentPageBounds",1),gt([Ye],pt.prototype,"getCurrentPageShapes",1),gt([Ye],pt.prototype,"getCurrentPageShapesSorted",1),gt([Ye],pt.prototype,"getCurrentPageRenderingShapesSorted",1),gt([Ye],pt.prototype,"_getSelectionSharedStyles",1),gt([Ye({isEqual:(t,n)=>t.equals(n)})],pt.prototype,"getSharedStyles",1),gt([Ye],pt.prototype,"getSharedOpacity",1);function Lm(t,n=t.getCurrentPageId()){const o=t.getPage(n).name;t.emit("max-shapes",{name:o,pageId:n,count:zi})}function gh(t,n){if(!n)return t;let o=null;const r=Object.entries(n);for(let s=0,a=r.length;s<a;s++){const[i,l]=r[s];if(l!==void 0&&!(i==="id"||i==="type"||i==="typeName")&&l!==t[i]){if(o||(o={...t}),i==="props"||i==="meta"){o[i]={...t[i]};for(const[c,u]of Object.entries(l))u!==void 0&&(o[i][c]=u);continue}o[i]=l}}return o||t}function gP(t,n,o){const r=t.getShape(n);if(!r)return;o.push(r);const s=t.getSortedChildIdsForParent(n);for(let a=0,i=s.length;a<i;a++)gP(t,s[a],o)}function yh(){const t=Be(),n=aP();return We("isDarkMode",()=>(n==null?void 0:n.isDarkMode)??t.user.getIsDarkMode(),[n,t])}const yP="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",vP="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Rm='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function $a(t,n,o,r,s,a=16,i=16){const l=(-o-n)*(Yt/180),c=Math.sin(l),u=Math.cos(l),f=1*u-1*c,h=1*c+1*u;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${s};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${f}' dy='${h}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${n+o} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+`</g></svg>") ${a} ${i}, pointer`}const AB=["default","pointer","cross","move","grab","grabbing","text","zoom-in","zoom-out"],OB={none:()=>"none","ew-resize":(t,n,o)=>$a(vP,t,0,n,o),"ns-resize":(t,n,o)=>$a(vP,t,90,n,o),"nesw-resize":(t,n,o)=>$a(yP,t,0,n,o),"nwse-resize":(t,n,o)=>$a(yP,t,90,n,o),"nwse-rotate":(t,n,o)=>$a(Rm,t,0,n,o),"nesw-rotate":(t,n,o)=>$a(Rm,t,90,n,o),"senw-rotate":(t,n,o)=>$a(Rm,t,180,n,o),"swne-rotate":(t,n,o)=>$a(Rm,t,270,n,o)};function rs(t,n=0,o="black"){return OB[t](I6(n),!1,o)}function LB(){const t=Be(),n=Qn(),o=yh();La("useCursor",()=>{const{type:r,rotation:s}=t.getInstanceState().cursor;if(AB.includes(r)){n.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}n.style.setProperty("--tl-cursor",rs(r,s,o?"white":"black"))},[t,n,o])}function RB(){const t=Be(),n=Qn(),o=yh(),r=We(jn.forceSrgb);Bt.useEffect(()=>{o?(n.setAttribute("data-color-mode","dark"),n.classList.remove("tl-theme__light"),n.classList.add("tl-theme__dark")):(n.setAttribute("data-color-mode","light"),n.classList.remove("tl-theme__dark"),n.classList.add("tl-theme__light")),r?n.classList.add("tl-theme__force-sRGB"):n.classList.remove("tl-theme__force-sRGB")},[t,n,r,o])}function d1(t){const n=z.useRef();return z.useLayoutEffect(()=>{n.current=t}),z.useDebugValue(t),z.useCallback((...o)=>{const r=n.current;return bn(r,"fn does not exist"),r(...o)},[])}function DB(t){const n=Be(),o=Qn();z.useLayoutEffect(()=>{t?(n.getInstanceState().isFocused||n.updateInstanceState({isFocused:!0}),n.getContainer().focus()):n.getInstanceState().isFocused&&n.updateInstanceState({isFocused:!1})},[n,o,t])}function FB(){const[t,n]=z.useState(0);z.useEffect(()=>n(o=>o+1),[])}const lu="TLDRAW_TAB_ID_v2",ai=globalThis.window;function NB(){return ai?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(ai.navigator.platform)||ai.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const Dm=ai?ai[lu]??Ok(lu)??"TLDRAW_INSTANCE_STATE_V1_"+Ir():"<error>";ai&&(ai[lu]=Dm,NB()?yb(lu,Dm):Lk(lu)),ai==null||ai.addEventListener("beforeunload",()=>{yb(lu,Dm)});const bP={Initial:0},Fm=Math.max(...Object.values(bP));function UB(t){t.version<bP.Initial,t.version=Fm}const xP=Gt({version:Mt,currentPageId:Yd,isFocusMode:Ht,exportBackground:Ht,isDebugMode:Ht,isToolLocked:Ht,isGridMode:Ht,pageStates:In(Gt({pageId:Yd,camera:Gt({x:Mt,y:Mt,z:Mt}),selectedShapeIds:In(Ds),focusedGroupId:Ds.nullable()}))});function BB(t){if(!t||typeof t!="object")return console.warn("Invalid instance state"),null;if(!("version"in t)||typeof t.version!="number")return console.warn("No version in instance state"),null;t.version!==Fm&&(t=wr(t),UB(t));try{return xP.validate(t)}catch(n){return console.warn(n),null}}function zB(t){const n=t.query.ids("page");return Ye("sessionStateSnapshot",()=>{const o=t.get(Ao);if(!o)return null;const r=[...n.get()];return{version:Fm,currentPageId:o.currentPageId,exportBackground:o.exportBackground,isFocusMode:o.isFocusMode,isDebugMode:o.isDebugMode,isToolLocked:o.isToolLocked,isGridMode:o.isGridMode,pageStates:r.map(s=>{const a=t.get(Yn.createId(s)),i=t.get(go.createId(s));return{pageId:s,camera:{x:(i==null?void 0:i.x)??0,y:(i==null?void 0:i.y)??0,z:(i==null?void 0:i.z)??1},selectedShapeIds:(a==null?void 0:a.selectedShapeIds)??[],focusedGroupId:(a==null?void 0:a.focusedGroupId)??null}})}})}function GB(t,n){const o=BB(n);if(!o)return;const r=t.allRecords().filter(i=>i.typeName==="instance_page_state"||i.typeName==="camera"),s={added:{},updated:{},removed:{...db(r.map(i=>[i.id,i]))}};t.has(Ao)&&(s.removed[Ao]=t.get(Ao));const a={removed:{},updated:{},added:{[Ao]:t.schema.types.instance.create({id:Ao,currentPageId:o.currentPageId,isDebugMode:o.isDebugMode,isFocusMode:o.isFocusMode,isToolLocked:o.isToolLocked,isGridMode:o.isGridMode,exportBackground:o.exportBackground})}};for(const i of o.pageStates){const l=go.createId(i.pageId),c=Yn.createId(i.pageId);a.added[l]=go.create({id:go.createId(i.pageId),x:i.camera.x,y:i.camera.y,z:i.camera.z}),a.added[c]=Yn.create({id:Yn.createId(i.pageId),pageId:i.pageId,selectedShapeIds:i.selectedShapeIds,focusedGroupId:i.focusedGroupId})}Ls(()=>{t.applyDiff(Vf([s,a])),t.ensureStoreIsUsable()})}function VB(t){var s;const n=[];for(const a of Object.values(t))(s=a.typeName)!=null&&s.match(/^(instance.*|pointer|camera)$/)&&n.push(a);const o=n.filter(a=>a.typeName==="instance"&&a.id!==Ao)[0];if(!o)return null;const r={version:Fm,currentPageId:o.currentPageId,exportBackground:!!o.exportBackground,isFocusMode:!!o.isFocusMode,isDebugMode:!!o.isDebugMode,isToolLocked:!!o.isToolLocked,isGridMode:!1,pageStates:n.filter(a=>a.typeName==="instance_page_state"&&a.instanceId===o.id).map(a=>{const i=t[a.cameraId]??{x:0,y:0,z:1};return{pageId:a.pageId,camera:{x:i.x,y:i.y,z:i.z},selectedShapeIds:a.selectedShapeIds,focusedGroupId:a.focusedGroupId}})};try{return xP.validate(r),r}catch{return null}}function HB(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
\u2022 If your hard disk is full, try clearing up some space and then reload the page.`)}function WB(){window.alert(`Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const $B=(t,n)=>n.some(o=>t instanceof o);let wP,SP;function qB(){return wP||(wP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YB(){return SP||(SP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jP=new WeakMap,h1=new WeakMap,_P=new WeakMap,p1=new WeakMap,f1=new WeakMap;function KB(t){const n=new Promise((o,r)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{o(Wi(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return n.then(o=>{o instanceof IDBCursor&&jP.set(o,t)}).catch(()=>{}),f1.set(n,t),n}function XB(t){if(h1.has(t))return;const n=new Promise((o,r)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{o(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});h1.set(t,n)}let m1={get(t,n,o){if(t instanceof IDBTransaction){if(n==="done")return h1.get(t);if(n==="objectStoreNames")return t.objectStoreNames||_P.get(t);if(n==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return Wi(t[n])},set(t,n,o){return t[n]=o,!0},has(t,n){return t instanceof IDBTransaction&&(n==="done"||n==="store")?!0:n in t}};function QB(t){m1=t(m1)}function ZB(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(n,...o){const r=t.call(g1(this),n,...o);return _P.set(r,n.sort?n.sort():[n]),Wi(r)}:YB().includes(t)?function(...n){return t.apply(g1(this),n),Wi(jP.get(this))}:function(...n){return Wi(t.apply(g1(this),n))}}function JB(t){return typeof t=="function"?ZB(t):(t instanceof IDBTransaction&&XB(t),$B(t,qB())?new Proxy(t,m1):t)}function Wi(t){if(t instanceof IDBRequest)return KB(t);if(p1.has(t))return p1.get(t);const n=JB(t);return n!==t&&(p1.set(t,n),f1.set(n,t)),n}const g1=t=>f1.get(t);function ez(t,n,{blocked:o,upgrade:r,blocking:s,terminated:a}={}){const i=indexedDB.open(t,n),l=Wi(i);return r&&i.addEventListener("upgradeneeded",c=>{r(Wi(i.result),c.oldVersion,c.newVersion,Wi(i.transaction),c)}),o&&i.addEventListener("blocked",c=>o(c.oldVersion,c.newVersion,c)),l.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}function tz(t,{blocked:n}={}){const o=indexedDB.deleteDatabase(t);return n&&o.addEventListener("blocked",r=>n(r.oldVersion,r)),Wi(o).then(()=>{})}const rz=["get","getKey","getAll","getAllKeys","count"],nz=["put","add","delete","clear"],y1=new Map;function kP(t,n){if(!(t instanceof IDBDatabase&&!(n in t)&&typeof n=="string"))return;if(y1.get(n))return y1.get(n);const o=n.replace(/FromIndex$/,""),r=n!==o,s=nz.includes(o);if(!(o in(r?IDBIndex:IDBObjectStore).prototype)||!(s||rz.includes(o)))return;const a=async function(i,...l){const c=this.transaction(i,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[o](...l),s&&c.done]))[0]};return y1.set(n,a),a}QB(t=>({...t,get:(n,o,r)=>kP(n,o)||t.get(n,o,r),has:(n,o)=>!!kP(n,o)||t.has(n,o)}));const Nm="TLDRAW_DOCUMENT_v2",EP="TLDRAW_DB_NAME_INDEX_v2",lr={Records:"records",Schema:"schema",SessionState:"session_state"};async function Um(t,n){lz(t);const o=await ez(t,3,{upgrade(r){r.objectStoreNames.contains(lr.Records)||r.createObjectStore(lr.Records),r.objectStoreNames.contains(lr.Schema)||r.createObjectStore(lr.Schema),r.objectStoreNames.contains(lr.SessionState)||r.createObjectStore(lr.SessionState)}});try{return await n(o)}finally{o.close()}}async function oz({persistenceKey:t,sessionId:n,didCancel:o}){const r=Nm+t;if(v1().includes(r))return await az({persistenceKey:t,didCancel:o}),await Um(r,async s=>{var h,d;if(o!=null&&o())return;const a=s.transaction([lr.Records,lr.Schema,lr.SessionState],"readonly"),i=a.objectStore(lr.Records),l=a.objectStore(lr.Schema),c=a.objectStore(lr.SessionState);let u=n?(h=await c.get(n))==null?void 0:h.snapshot:null;u||(u=(d=(await c.getAll()).sort((p,y)=>p.updatedAt-y.updatedAt).pop())==null?void 0:d.snapshot);const f={records:await i.getAll(),schema:await l.get(lr.Schema),sessionStateSnapshot:u};if(o!=null&&o()){a.abort();return}return await a.done,f})}async function sz({persistenceKey:t,schema:n,changes:o,sessionId:r,sessionStateSnapshot:s,didCancel:a}){const i=Nm+t;await Um(i,async l=>{const c=l.transaction([lr.Records,lr.Schema,lr.SessionState],"readwrite"),u=c.objectStore(lr.Records),f=c.objectStore(lr.Schema),h=c.objectStore(lr.SessionState);for(const[d,p]of Object.entries(o.added))await u.put(p,d);for(const[d,p]of Object.values(o.updated))await u.put(p,p.id);for(const d of Object.keys(o.removed))await u.delete(d);if(f.put(n.serialize(),lr.Schema),s&&r?h.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),a==null?void 0:a())return c.abort();await c.done})}async function iz({persistenceKey:t,schema:n,snapshot:o,sessionId:r,sessionStateSnapshot:s,didCancel:a}){const i=Nm+t;await Um(i,async l=>{const c=l.transaction([lr.Records,lr.Schema,lr.SessionState],"readwrite"),u=c.objectStore(lr.Records),f=c.objectStore(lr.Schema),h=c.objectStore(lr.SessionState);await u.clear();for(const[d,p]of Object.entries(o))await u.put(p,d);if(f.put(n.serialize(),lr.Schema),s&&r?h.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together"),a==null?void 0:a())return c.abort();await c.done})}async function az({persistenceKey:t,didCancel:n}){await Um(Nm+t,async o=>{const r=o.transaction([lr.SessionState],"readwrite"),s=r.objectStore(lr.SessionState),a=(await s.getAll()).sort((l,c)=>l.updatedAt-c.updatedAt);if(a.length<10){await r.done;return}const i=a.slice(0,a.length-10);for(const{id:l}of i)await s.delete(l);if(n!=null&&n())return r.abort();await r.done})}function v1(){const t=JSON.parse(mb(EP)||"[]")??[];return Array.isArray(t)?t:[]}function lz(t){const n=new Set(v1());n.add(t),gb(EP,JSON.stringify([...n]))}const cz=350,uz=1e4,CP=Symbol("UPDATE_INSTANCE_STATE"),dz=t=>t;class hz{constructor(n){R(this,"onmessage")}postMessage(n){}close(){}}const pz=typeof BroadcastChannel>"u"?hz:BroadcastChannel;class fz{constructor(n,{persistenceKey:o,sessionId:r=Dm,onLoad:s,onLoadError:a},i=new pz(`tldraw-tab-sync-${o}`)){R(this,"disposables",new Set);R(this,"diffQueue",[]);R(this,"didDispose",!1);R(this,"shouldDoFullDBWrite",!0);R(this,"isReloading",!1);R(this,"persistenceKey");R(this,"sessionId");R(this,"serializedSchema");R(this,"isDebugging",!1);R(this,"documentTypes");R(this,"$sessionStateSnapshot");R(this,"initTime",Date.now());R(this,"isPersisting",!1);R(this,"didLastWriteError",!1);R(this,"scheduledPersistTimeout",null);this.store=n,this.channel=i,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=o,this.sessionId=r,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=zB(this.store),this.disposables.add(n.listen(({changes:l})=>{this.diffQueue.push(l),this.channel.postMessage(dz({type:"diff",storeId:this.store.id,changes:l,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(n.listen(()=>{this.diffQueue.push(CP),this.schedulePersist()},{scope:"session"})),this.connect(s,a),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(l=>l.scope==="document").map(l=>l.typeName))}debug(...n){this.isDebugging&&console.debug(...n)}async connect(n,o){this.debug("connecting");let r;try{r=await oz({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(s){o(s),WB(),typeof window<"u"&&window.location.reload();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const s=Object.fromEntries(r.records.map(l=>[l.id,l])),a=r.sessionStateSnapshot??VB(s),i=this.store.schema.migrateStoreSnapshot({store:s,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(i.type==="error"){console.error("failed to migrate store",i),o(new Error(`Failed to migrate store: ${i.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(i.value).filter(l=>this.documentTypes.has(l.typeName)),"initialize")}),a&&GB(this.store,a)}this.channel.onmessage=({data:s})=>{var l,c;this.debug("got message",s);const a=s,i=this.store.schema.getMigrationsSince(a.schema);if(i.ok){if(i.value.length>0){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}}else{if(Date.now()-this.initTime<5e3){o(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(c=(l=window==null?void 0:window.location)==null?void 0:l.reload)==null||c.call(l);return}a.type==="diff"&&(this.debug("applying diff"),Ls(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(a.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),n(this)}catch(s){if(this.debug("error loading data from store",s),this.didDispose)return;o(s);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(n=>n())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?uz:cz))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){bn(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");const n=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await iz({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const o=Vf(n.filter(r=>r!==CP));await sz({persistenceKey:this.persistenceKey,changes:o,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(o){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",o),HB(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function mz({initialData:t,defaultName:n="",...o}){const r="schema"in o&&o.schema?o.schema:w6({shapes:gz(nP("shapeUtils"in o&&o.shapeUtils?o.shapeUtils:[])),migrations:"migrations"in o?o.migrations:[]});return new Gk({schema:r,initialData:t,props:{defaultName:n}})}function gz(t){return Object.fromEntries(t.map(n=>[n.type,{props:n.props,migrations:n.migrations}]))}function PP(t){const n=mz(t);return t.snapshot&&n.loadSnapshot(t.snapshot),{store:n,opts:t}}function MP(t){const[n,o]=z.useState(()=>PP(t));if(!Ek(n.opts,t)){const r=PP(t);return o(r),r.store}return n.store}function yz({persistenceKey:t,sessionId:n,...o}){const[r,s]=z.useState(null),a=MP(o);return z.useEffect(()=>{const i=Ir();if(!t){s({id:i,storeWithStatus:{status:"not-synced",store:a}});return}s({id:i,storeWithStatus:{status:"loading"}});const l=u=>{s(f=>(f==null?void 0:f.id)===i?{id:i,storeWithStatus:u}:f)},c=new fz(a,{sessionId:n,persistenceKey:t,onLoad(){l({store:a,status:"synced-local"})},onLoadError(u){l({status:"error",error:u})}});return()=>{s(u=>(u==null?void 0:u.id)===i?null:u),c.close()}},[t,a,n]),(r==null?void 0:r.storeWithStatus)??{status:"loading"}}let TP=!1;if(typeof window<"u"){const t=window.navigator.userAgent,n=!!t.match(/iPad/i)||!!t.match(/iPhone/i),o=!!t.match(/WebKit/i);TP=n&&o&&!t.match(/CriOS/i)}function vz(){const t=Be();z.useEffect(()=>{if(!TP)return;function n(o){(o.target instanceof HTMLInputElement&&o.target.type==="text"||o.target instanceof HTMLTextAreaElement)&&t.complete()}return document.addEventListener("focusout",n),()=>document.removeEventListener("focusout",n)},[t])}function bz(){const t=Be(),n=Qn();z.useEffect(()=>{const o=a=>n.style.setProperty("--tl-zoom",a.toString()),r=wk(o,100),s=new Uc("useZoomCss",()=>{t.getCurrentPageShapeIds().size<300?o(t.getZoomLevel()):r(t.getZoomLevel())});return s.attach(),s.execute(),()=>{s.detach()}},[t,n])}const xz=[],wz=[],Sz=z.memo(function({store:t,components:n,className:o,user:r,...s}){const[a,i]=Bt.useState(null),l=z.useMemo(()=>r??XC(),[r]),c=(n==null?void 0:n.ErrorFallback)===void 0?zC:n==null?void 0:n.ErrorFallback,u={...s,shapeUtils:s.shapeUtils??xz,tools:s.tools??wz,components:n};return E.jsx("div",{ref:i,draggable:!1,className:Pt("tl-container tl-theme__light",o),onPointerDown:On,tabIndex:-1,children:E.jsx(eh,{fallback:c,onError:f=>lb(f,{tags:{origin:"react.tldraw-before-app"}}),children:a&&E.jsx(r8,{container:a,children:E.jsx(jU,{overrides:n,children:t?t instanceof Gk?E.jsx(AP,{...u,store:t,user:l}):E.jsx(IP,{...u,store:t,user:l}):E.jsx(jz,{...u,store:t,user:l})})})})})});function jz(t){const{defaultName:n,snapshot:o,initialData:r,shapeUtils:s,persistenceKey:a,sessionId:i,user:l}=t,c=yz({shapeUtils:s,initialData:r,persistenceKey:a,sessionId:i,defaultName:n,snapshot:o});return E.jsx(IP,{...t,store:c,user:l})}const IP=z.memo(function({store:t,user:n,...o}){const r=Qn();z.useLayoutEffect(()=>{n.userPreferences.get().isDarkMode&&(r.classList.remove("tl-theme__light"),r.classList.add("tl-theme__dark"))},[r,n]);const{LoadingScreen:s}=Vr();switch(t.status){case"error":throw t.error;case"loading":return s?E.jsx(s,{}):null}return E.jsx(AP,{...o,store:t.store,user:n})});function AP({onMount:t,children:n,store:o,tools:r,shapeUtils:s,user:a,initialState:i,autoFocus:l=!0,inferDarkMode:c}){const{ErrorFallback:u}=Vr(),f=Qn(),[h,d]=z.useState(null);z.useLayoutEffect(()=>{const g=new pt({store:o,shapeUtils:s,tools:r,getContainer:()=>f,user:a,initialState:i,inferDarkMode:c});return d(g),()=>{g.dispose()}},[f,s,r,o,a,i,c]);const p=z.useSyncExternalStore(z.useCallback(g=>h?(h.on("crash",g),()=>h.off("crash",g)):()=>{},[h]),()=>(h==null?void 0:h.getCrashingError())??null),{Canvas:y}=Vr();return h?E.jsx(eh,{fallback:u,onError:g=>h.annotateError(g,{origin:"react.tldraw",willCrashApp:!0}),children:p?E.jsx(kz,{crashingError:p}):E.jsx(im.Provider,{value:h,children:E.jsx(_z,{autoFocus:l,onMount:t,children:n??(y?E.jsx(y,{}):null)})})}):null}function _z({children:t,onMount:n,autoFocus:o}){return bz(),LB(),RB(),vz(),FB(),DB(o),Ez(n),E.jsx(E.Fragment,{children:t})}function kz({crashingError:t}){throw t}function OP({children:t}){return E.jsx("div",{className:"tl-loading",children:t})}function LP({children:t}){return E.jsx("div",{className:"tl-loading",children:t})}function Ez(t){const n=Be(),o=d1(r=>{const s=t==null?void 0:t(r);return r.emit("mount"),window.tldrawReady=!0,s});Bt.useLayoutEffect(()=>{if(n)return o==null?void 0:o(n)},[n,o])}function Vl({children:t,className:n="",...o}){return E.jsx("div",{...o,className:Pt("tl-html-container",n),children:t})}function RP(t,n,o={}){const{newPoint:r,handle:s,scaleX:a,scaleY:i}=n,{minWidth:l=1,maxWidth:c=1/0,minHeight:u=1,maxHeight:f=1/0}=o;let h=t.props.w*a,d=t.props.h*i;const p=new q(0,0);if(h>0){if(h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=h-l;break}case"top":case"bottom":{p.x=(h-l)/2;break}default:p.x=0}h=l}}else if(p.x=h,h=-h,h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=-h;break}default:p.x=-l}h=l}if(d>0){if(d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=d-u;break}case"right":case"left":{p.y=(d-u)/2;break}default:p.y=0}d=u}}else if(p.y=d,d=-d,d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=-d;break}default:p.y=-u}d=u}const{x:y,y:g}=p.rot(t.rotation).add(r);return{x:y,y:g,props:{w:Math.min(c,h),h:Math.min(f,d)}}}class cu extends Us{constructor(){super(...arguments);R(this,"onResize",(o,r)=>RP(o,r))}getGeometry(o){return new Vi({width:o.props.w,height:o.props.h,isFilled:!0})}getHandleSnapGeometry(o){return{points:this.getGeometry(o).bounds.cornersAndCenter}}}let Cz=(uS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(uS,"id","idle"),uS),Pz=(dS=class extends bt{constructor(){super(...arguments);R(this,"markId","");R(this,"wasFocusedOnEnter",!1);R(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()});R(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:o}=this.editor.inputs,r=this.parent.shapeType,s=ur();this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:r,x:o.x,y:o.y,props:{w:1,h:1}}]).select(s),this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:this.parent.onCreate})}});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const o=this.parent.shapeType,r=ur();this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:o,x:n.x,y:n.y}]);const s=this.editor.getShape(r),{w:a,h:i}=this.editor.getShapeUtil(s).getDefaultProps(),l=new q(a/2,i/2),c=this.editor.getShapeParentTransform(s);c&&l.rot(-c.rotation()),this.editor.updateShapes([{id:r,type:o,x:s.x-l.x,y:s.y-l.y}]),this.editor.setSelectedShapes([r]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},R(dS,"id","pointing"),dS);class Bm extends bt{constructor(){super(...arguments);R(this,"onCreate")}}R(Bm,"id","box"),R(Bm,"initial","idle"),R(Bm,"children",()=>[Cz,Pz]);function zm(t){const n=Be();return We("isEditing",()=>n.getEditingShapeId()===t,[n,t])}function Mz(){return z.useId().replace(/:/g,"_")}function li(t){const n=Be();return z.useMemo(function(){const o=i=>{if(i.isKilled)return;if(i.button===2){n.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...Lo(i)});return}if(i.button!==0)return;const l=mm(i.currentTarget);function c(){l.removeEventListener("pointerup",c),ah(l,i)}ih(l,i),l.addEventListener("pointerup",c),n.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...Lo(i)}),On(i)};let r,s;function a(i){i.isKilled||i.button===0&&(i.clientX===r&&i.clientY===s||(r=i.clientX,s=i.clientY,n.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...Lo(i)})))}return{onPointerDown:o,onPointerMove:a,onPointerUp:i=>{i.isKilled||i.button===0&&n.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...Lo(i)})}}},[n,t])}const Tz=20,Iz=8;function b1(t,n=Tz){return Math.max(Iz,Math.ceil(t/n))}class DP extends Fl{constructor(o){super({...o,isFilled:!1,isClosed:!1});R(this,"_center");R(this,"radius");R(this,"start");R(this,"end");R(this,"measure");R(this,"length");R(this,"angleStart");R(this,"angleEnd");const{center:r,radius:s,sweepFlag:a,largeArcFlag:i,start:l,end:c}=o;if(l.equals(c))throw Error("Arc must have different start and end points.");this.angleStart=q.Angle(r,l),this.angleEnd=q.Angle(r,c),this.measure=A6(this.angleStart,this.angleEnd,a,i),this.length=this.measure*s,this.start=l,this.end=c,this._center=r,this.radius=s}nearestPoint(o){const{_center:r,measure:s,radius:a,angleEnd:i,angleStart:l,start:c,end:u}=this,f=Rb(s,l,i,r.angle(o));if(f<=0)return c;if(f>=1)return u;const h=r.clone().add(o.clone().sub(r).uni().mul(a));let d,p=1/0,y;for(const g of[c,u,h])y=q.Dist2(o,g),y<p&&(d=g,p=y);if(!d)throw Error("nearest point not found");return d}hitTestLineSegment(o,r){const{_center:s,radius:a,measure:i,angleStart:l,angleEnd:c}=this,u=jm(o,r,s,a);return u===null?!1:u.some(f=>{const h=Rb(i,l,c,s.angle(f));return h>=0&&h<=1})}getVertices(){const{_center:o,measure:r,length:s,radius:a,angleStart:i}=this,l=[];for(let c=0,u=b1(Math.abs(s));c<u+1;c++){const f=c/u*r,h=i+f;l.push(Dl(o,a,h))}return l}}class x1 extends Fl{constructor(o){super({isClosed:!0,...o});R(this,"_center");R(this,"radius");R(this,"x");R(this,"y");this.config=o;const{x:r=0,y:s=0,radius:a}=o;this.x=r,this.y=s,this._center=new q(a+r,a+s),this.radius=a}getBounds(){return new mt(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:o,radius:r}=this,s=nr*r,a=[];for(let i=0,l=b1(s);i<l;i++){const c=i/l*nr;a.push(Dl(o,r,c))}return a}nearestPoint(o){const{_center:r,radius:s}=this;return r.equals(o)?q.AddXY(r,s,0):r.clone().add(o.clone().sub(r).uni().mul(s))}hitTestLineSegment(o,r,s=0){const{_center:a,radius:i}=this;return jm(o,r,a,i+s)!==null}}class Az extends Bl{constructor(o){const{start:r,cp1:s,cp2:a,end:i}=o;super({...o,points:[r,i]});R(this,"a");R(this,"b");R(this,"c");R(this,"d");this.a=r,this.b=s,this.c=a,this.d=i}getVertices(){const o=[],{a:r,b:s,c:a,d:i}=this;for(let l=0,c=10;l<=c;l++){const u=l/c;o.push(new q((1-u)*(1-u)*(1-u)*r.x+3*((1-u)*(1-u))*u*s.x+3*(1-u)*(u*u)*a.x+u*u*u*i.x,(1-u)*(1-u)*(1-u)*r.y+3*((1-u)*(1-u))*u*s.y+3*(1-u)*(u*u)*a.y+u*u*u*i.y))}return o}midPoint(){return Oz(this,.5)}nearestPoint(o){let r,s=1/0,a,i;for(const l of this.segments)i=l.nearestPoint(o),a=q.Dist2(i,o),a<s&&(r=i,s=a);if(!r)throw Error("nearest point not found");return r}}function Oz(t,n){const{a:o,b:r,c:s,d:a}=t;return new q((1-n)*(1-n)*(1-n)*o.x+3*((1-n)*(1-n))*n*r.x+3*(1-n)*(n*n)*s.x+n*n*n*a.x,(1-n)*(1-n)*(1-n)*o.y+3*((1-n)*(1-n))*n*r.y+3*(1-n)*(n*n)*s.y+n*n*n*a.y)}class Lz extends Fl{constructor(o){super({...o,isClosed:!1,isFilled:!1});R(this,"points");R(this,"_segments");R(this,"_length");const{points:r}=o;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:o}=this,r=o.length,s=r-2,a=1.25;for(let i=0;i<r-1;i++){const l=i===0?o[0]:o[i-1],c=o[i],u=o[i+1],f=i===s?u:o[i+2],h=c,d=i===0?l:new q(c.x+(u.x-l.x)/6*a,c.y+(u.y-l.y)/6*a),p=i===s?u:new q(u.x-(f.x-c.x)/6*a,u.y-(f.y-c.y)/6*a),y=u;this._segments.push(new Az({start:h,cp1:d,cp2:p,end:y}))}}return this._segments}get length(){return this._length||(this._length=this.segments.reduce((o,r)=>o+r.length,0)),this._length}getVertices(){const o=this.segments.reduce((r,s)=>r.concat(s.vertices),[]);return o.push(this.points[this.points.length-1]),o}nearestPoint(o){let r,s=1/0,a,i;for(const l of this.segments)i=l.nearestPoint(o),a=q.Dist2(i,o),a<s&&(r=i,s=a);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(o,r){return this.segments.some(s=>s.hitTestLineSegment(o,r))}}class FP extends Fl{constructor(o){super({...o,isClosed:!0});R(this,"w");R(this,"h");R(this,"_edges");this.config=o;const{width:r,height:s}=o;this.w=r,this.h=s}get edges(){if(!this._edges){const{vertices:o}=this;this._edges=[];for(let r=0,s=o.length;r<s;r++){const a=o[r],i=o[(r+1)%s];this._edges.push(new hh({start:a,end:i}))}}return this._edges}getVertices(){const o=Math.max(1,this.w),r=Math.max(1,this.h),s=o/2,a=r/2,i=Math.pow(s-a,2)/Math.pow(s+a,2),l=Yt*(s+a)*(1+3*i/(10+Math.sqrt(4-3*i))),c=b1(l),u=nr/c,f=Math.cos(u),h=Math.sin(u);let d=0,p=1,y=0,g=1;const b=Array(c);for(let m=0;m<c;m++)b[m]=new q(s+s*p,a+a*d),y=h*p+f*d,g=f*p-h*d,d=y,p=g;return b}nearestPoint(o){let r,s=1/0,a,i;for(const l of this.edges)i=l.nearestPoint(o),a=q.Dist2(i,o),a<s&&(r=i,s=a);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(o,r){return this.edges.some(s=>s.hitTestLineSegment(o,r))}getBounds(){return new mt(0,0,this.w,this.h)}}const $i=18;class Rz extends FP{constructor(n){super({...n}),this.config=n}getVertices(){const n=Math.max(1,this.w),o=Math.max(1,this.h),r=n/2,s=o/2,a=Array($i);let i,l;if(o>n)for(let c=0;c<$i-1;c++)i=-Yt+Yt*c/($i-2),l=Yt*c/($i-2),a[c]=new q(r+r*Math.cos(i),r+r*Math.sin(i)),a[c+($i-1)]=new q(r+r*Math.cos(l),o-r+r*Math.sin(l));else for(let c=0;c<$i-1;c++)i=-hr+Yt*c/($i-2),l=hr+Yt*-c/($i-2),a[c]=new q(n-s+s*Math.cos(i),o-s+s*Math.sin(i)),a[c+($i-1)]=new q(s-s*Math.cos(l),o-s+s*Math.sin(l));return a}}function NP(t,n,o,r,s){const a=$6,i=o?q6:0,l=t-i,c=t+i,u=r?0:a,f=s?n:n-a;return l<u?Math.min(1,(u-l)/a):c>f?-Math.min(1,(c-f)/a):0}function w1(t){if(!t.inputs.isDragging||t.inputs.isPanning||!t.getInstanceState().canMoveCamera)return;const{inputs:{currentScreenPoint:{x:n,y:o}}}=t,r=t.getZoomLevel(),s=t.getViewportScreenBounds(),a=s.w<1e3?.612:1,i=s.h<1e3?.612:1,{isCoarsePointer:l,insets:[c,u,f,h]}=t.getInstanceState(),d=NP(n,s.w,l,h,u),p=NP(o,s.h,l,c,f);if(d===0&&p===0)return;const y=t.user.getEdgeScrollSpeed()*W6,g=y*d*a/r,b=y*p*i/r,m=t.getCamera();t.setCamera({x:m.x+g,y:m.y+b})}async function Dz({shouldReload:t=!0}={}){JR(),await Promise.all(v1().map(n=>tz(n))),ZR(),t&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=Dz);function Fz(t,n="_blank"){Zb.openWindow(t,n)}var vh=function(t){return t&&t.Math===Math&&t},Ro=vh(typeof globalThis=="object"&&globalThis)||vh(typeof window=="object"&&window)||vh(typeof self=="object"&&self)||vh(typeof cn=="object"&&cn)||vh(typeof cn=="object"&&cn)||function(){return this}()||Function("return this")(),S1={},yo=function(t){try{return!!t()}catch{return!0}},Nz=yo,qa=!Nz(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Uz=yo,Gm=!Uz(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Bz=Gm,Vm=Function.prototype.call,qi=Bz?Vm.bind(Vm):function(){return Vm.apply(Vm,arguments)},UP={},BP={}.propertyIsEnumerable,zP=Object.getOwnPropertyDescriptor,zz=zP&&!BP.call({1:2},1);UP.f=zz?function(t){var n=zP(this,t);return!!n&&n.enumerable}:BP;var GP=function(t,n){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:n}},VP=Gm,HP=Function.prototype,j1=HP.call,Gz=VP&&HP.bind.bind(j1,j1),_n=VP?Gz:function(t){return function(){return j1.apply(t,arguments)}},WP=_n,Vz=WP({}.toString),Hz=WP("".slice),uu=function(t){return Hz(Vz(t),8,-1)},Wz=_n,$z=yo,qz=uu,_1=Object,Yz=Wz("".split),Kz=$z(function(){return!_1("z").propertyIsEnumerable(0)})?function(t){return qz(t)==="String"?Yz(t,""):_1(t)}:_1,Hm=function(t){return t==null},Xz=Hm,Qz=TypeError,du=function(t){if(Xz(t))throw new Qz("Can't call method on "+t);return t},Zz=Kz,Jz=du,Wm=function(t){return Zz(Jz(t))},k1=typeof document=="object"&&document.all,vo=typeof k1>"u"&&k1!==void 0?function(t){return typeof t=="function"||t===k1}:function(t){return typeof t=="function"},e7=vo,Hl=function(t){return typeof t=="object"?t!==null:e7(t)},E1=Ro,t7=vo,r7=function(t){return t7(t)?t:void 0},$m=function(t,n){return arguments.length<2?r7(E1[t]):E1[t]&&E1[t][n]},n7=_n,$P=n7({}.isPrototypeOf),o7=typeof navigator<"u"&&String(navigator.userAgent)||"",qP=Ro,C1=o7,YP=qP.process,KP=qP.Deno,XP=YP&&YP.versions||KP&&KP.version,QP=XP&&XP.v8,Gs,qm;QP&&(Gs=QP.split("."),qm=Gs[0]>0&&Gs[0]<4?1:+(Gs[0]+Gs[1])),!qm&&C1&&(Gs=C1.match(/Edge\/(\d+)/),(!Gs||Gs[1]>=74)&&(Gs=C1.match(/Chrome\/(\d+)/),Gs&&(qm=+Gs[1])));var s7=qm,ZP=s7,i7=yo,a7=Ro,l7=a7.String,JP=!!Object.getOwnPropertySymbols&&!i7(function(){var t=Symbol("symbol detection");return!l7(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ZP&&ZP<41}),c7=JP,eM=c7&&!Symbol.sham&&typeof Symbol.iterator=="symbol",u7=$m,d7=vo,h7=$P,p7=eM,f7=Object,tM=p7?function(t){return typeof t=="symbol"}:function(t){var n=u7("Symbol");return d7(n)&&h7(n.prototype,f7(t))},m7=String,g7=function(t){try{return m7(t)}catch{return"Object"}},y7=vo,v7=g7,b7=TypeError,P1=function(t){if(y7(t))return t;throw new b7(v7(t)+" is not a function")},x7=P1,w7=Hm,M1=function(t,n){var o=t[n];return w7(o)?void 0:x7(o)},T1=qi,I1=vo,A1=Hl,S7=TypeError,j7=function(t,n){var o,r;if(n==="string"&&I1(o=t.toString)&&!A1(r=T1(o,t))||I1(o=t.valueOf)&&!A1(r=T1(o,t))||n!=="string"&&I1(o=t.toString)&&!A1(r=T1(o,t)))return r;throw new S7("Can't convert object to primitive value")},rM={exports:{}},nM=Ro,_7=Object.defineProperty,O1=function(t,n){try{_7(nM,t,{value:n,configurable:!0,writable:!0})}catch{nM[t]=n}return n},k7=Ro,E7=O1,oM="__core-js_shared__",sM=rM.exports=k7[oM]||E7(oM,{});(sM.versions||(sM.versions=[])).push({version:"3.36.1",mode:"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"});var L1=rM.exports,iM=L1,R1=function(t,n){return iM[t]||(iM[t]=n||{})},C7=du,P7=Object,bh=function(t){return P7(C7(t))},M7=_n,T7=bh,I7=M7({}.hasOwnProperty),Ya=Object.hasOwn||function(t,n){return I7(T7(t),n)},A7=_n,O7=0,L7=Math.random(),R7=A7(1 .toString),aM=function(t){return"Symbol("+(t===void 0?"":t)+")_"+R7(++O7+L7,36)},D7=Ro,F7=R1,lM=Ya,N7=aM,U7=JP,B7=eM,hu=D7.Symbol,D1=F7("wks"),z7=B7?hu.for||hu:hu&&hu.withoutSetter||N7,Yi=function(t){return lM(D1,t)||(D1[t]=U7&&lM(hu,t)?hu[t]:z7("Symbol."+t)),D1[t]},G7=qi,cM=Hl,uM=tM,V7=M1,H7=j7,W7=Yi,$7=TypeError,q7=W7("toPrimitive"),Y7=function(t,n){if(!cM(t)||uM(t))return t;var o=V7(t,q7),r;if(o){if(n===void 0&&(n="default"),r=G7(o,t,n),!cM(r)||uM(r))return r;throw new $7("Can't convert object to primitive value")}return n===void 0&&(n="number"),H7(t,n)},K7=Y7,X7=tM,dM=function(t){var n=K7(t,"string");return X7(n)?n:n+""},Q7=Ro,hM=Hl,F1=Q7.document,Z7=hM(F1)&&hM(F1.createElement),pM=function(t){return Z7?F1.createElement(t):{}},J7=qa,e9=yo,t9=pM,fM=!J7&&!e9(function(){return Object.defineProperty(t9("div"),"a",{get:function(){return 7}}).a!==7}),r9=qa,n9=qi,o9=UP,s9=GP,i9=Wm,a9=dM,l9=Ya,c9=fM,mM=Object.getOwnPropertyDescriptor;S1.f=r9?mM:function(t,n){if(t=i9(t),n=a9(n),c9)try{return mM(t,n)}catch{}if(l9(t,n))return s9(!n9(o9.f,t,n),t[n])};var pu={},u9=qa,d9=yo,gM=u9&&d9(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),h9=Hl,p9=String,f9=TypeError,Wl=function(t){if(h9(t))return t;throw new f9(p9(t)+" is not an object")},m9=qa,g9=fM,y9=gM,Ym=Wl,yM=dM,v9=TypeError,N1=Object.defineProperty,b9=Object.getOwnPropertyDescriptor,U1="enumerable",B1="configurable",z1="writable";pu.f=m9?y9?function(t,n,o){if(Ym(t),n=yM(n),Ym(o),typeof t=="function"&&n==="prototype"&&"value"in o&&z1 in o&&!o[z1]){var r=b9(t,n);r&&r[z1]&&(t[n]=o.value,o={configurable:B1 in o?o[B1]:r[B1],enumerable:U1 in o?o[U1]:r[U1],writable:!1})}return N1(t,n,o)}:N1:function(t,n,o){if(Ym(t),n=yM(n),Ym(o),g9)try{return N1(t,n,o)}catch{}if("get"in o||"set"in o)throw new v9("Accessors not supported");return"value"in o&&(t[n]=o.value),t};var x9=qa,w9=pu,S9=GP,G1=x9?function(t,n,o){return w9.f(t,n,S9(1,o))}:function(t,n,o){return t[n]=o,t},vM={exports:{}},V1=qa,j9=Ya,bM=Function.prototype,_9=V1&&Object.getOwnPropertyDescriptor,H1=j9(bM,"name"),k9=H1&&(function(){}).name==="something",E9=H1&&(!V1||V1&&_9(bM,"name").configurable),C9={EXISTS:H1,PROPER:k9,CONFIGURABLE:E9},P9=_n,M9=vo,W1=L1,T9=P9(Function.toString);M9(W1.inspectSource)||(W1.inspectSource=function(t){return T9(t)});var xM=W1.inspectSource,I9=Ro,A9=vo,wM=I9.WeakMap,O9=A9(wM)&&/native code/.test(String(wM)),L9=R1,R9=aM,SM=L9("keys"),jM=function(t){return SM[t]||(SM[t]=R9(t))},$1={},D9=O9,_M=Ro,F9=Hl,N9=G1,q1=Ya,Y1=L1,U9=jM,B9=$1,kM="Object already initialized",K1=_M.TypeError,z9=_M.WeakMap,Km,xh,Xm,G9=function(t){return Xm(t)?xh(t):Km(t,{})},V9=function(t){return function(n){var o;if(!F9(n)||(o=xh(n)).type!==t)throw new K1("Incompatible receiver, "+t+" required");return o}};if(D9||Y1.state){var ci=Y1.state||(Y1.state=new z9);ci.get=ci.get,ci.has=ci.has,ci.set=ci.set,Km=function(t,n){if(ci.has(t))throw new K1(kM);return n.facade=t,ci.set(t,n),n},xh=function(t){return ci.get(t)||{}},Xm=function(t){return ci.has(t)}}else{var fu=U9("state");B9[fu]=!0,Km=function(t,n){if(q1(t,fu))throw new K1(kM);return n.facade=t,N9(t,fu,n),n},xh=function(t){return q1(t,fu)?t[fu]:{}},Xm=function(t){return q1(t,fu)}}var EM={set:Km,get:xh,has:Xm,enforce:G9,getterFor:V9},X1=_n,H9=yo,W9=vo,Qm=Ya,Q1=qa,$9=C9.CONFIGURABLE,q9=xM,CM=EM,Y9=CM.enforce,K9=CM.get,PM=String,Zm=Object.defineProperty,X9=X1("".slice),Q9=X1("".replace),Z9=X1([].join),J9=Q1&&!H9(function(){return Zm(function(){},"length",{value:8}).length!==8}),eG=String(String).split("String"),tG=vM.exports=function(t,n,o){X9(PM(n),0,7)==="Symbol("&&(n="["+Q9(PM(n),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),o&&o.getter&&(n="get "+n),o&&o.setter&&(n="set "+n),(!Qm(t,"name")||$9&&t.name!==n)&&(Q1?Zm(t,"name",{value:n,configurable:!0}):t.name=n),J9&&o&&Qm(o,"arity")&&t.length!==o.arity&&Zm(t,"length",{value:o.arity});try{o&&Qm(o,"constructor")&&o.constructor?Q1&&Zm(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Y9(t);return Qm(r,"source")||(r.source=Z9(eG,typeof n=="string"?n:"")),t};Function.prototype.toString=tG(function(){return W9(this)&&K9(this).source||q9(this)},"toString");var rG=vM.exports,nG=vo,oG=pu,sG=rG,iG=O1,MM=function(t,n,o,r){r||(r={});var s=r.enumerable,a=r.name!==void 0?r.name:n;if(nG(o)&&sG(o,a,r),r.global)s?t[n]=o:iG(n,o);else{try{r.unsafe?t[n]&&(s=!0):delete t[n]}catch{}s?t[n]=o:oG.f(t,n,{value:o,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},TM={},aG=Math.ceil,lG=Math.floor,cG=Math.trunc||function(t){var n=+t;return(n>0?lG:aG)(n)},uG=cG,$l=function(t){var n=+t;return n!==n||n===0?0:uG(n)},dG=$l,hG=Math.max,pG=Math.min,fG=function(t,n){var o=dG(t);return o<0?hG(o+n,0):pG(o,n)},mG=$l,gG=Math.min,IM=function(t){var n=mG(t);return n>0?gG(n,9007199254740991):0},yG=IM,wh=function(t){return yG(t.length)},vG=Wm,bG=fG,xG=wh,AM=function(t){return function(n,o,r){var s=vG(n),a=xG(s);if(a===0)return!t&&-1;var i=bG(r,a),l;if(t&&o!==o){for(;a>i;)if(l=s[i++],l!==l)return!0}else for(;a>i;i++)if((t||i in s)&&s[i]===o)return t||i||0;return!t&&-1}},wG={includes:AM(!0),indexOf:AM(!1)},SG=_n,Z1=Ya,jG=Wm,_G=wG.indexOf,kG=$1,OM=SG([].push),LM=function(t,n){var o=jG(t),r=0,s=[],a;for(a in o)!Z1(kG,a)&&Z1(o,a)&&OM(s,a);for(;n.length>r;)Z1(o,a=n[r++])&&(~_G(s,a)||OM(s,a));return s},J1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],EG=LM,CG=J1,PG=CG.concat("length","prototype");TM.f=Object.getOwnPropertyNames||function(t){return EG(t,PG)};var RM={};RM.f=Object.getOwnPropertySymbols;var MG=$m,TG=_n,IG=TM,AG=RM,OG=Wl,LG=TG([].concat),RG=MG("Reflect","ownKeys")||function(t){var n=IG.f(OG(t)),o=AG.f;return o?LG(n,o(t)):n},DM=Ya,DG=RG,FG=S1,NG=pu,UG=function(t,n,o){for(var r=DG(n),s=NG.f,a=FG.f,i=0;i<r.length;i++){var l=r[i];!DM(t,l)&&!(o&&DM(o,l))&&s(t,l,a(n,l))}},BG=yo,zG=vo,GG=/#|\.prototype\./,Sh=function(t,n){var o=HG[VG(t)];return o===$G?!0:o===WG?!1:zG(n)?BG(n):!!n},VG=Sh.normalize=function(t){return String(t).replace(GG,".").toLowerCase()},HG=Sh.data={},WG=Sh.NATIVE="N",$G=Sh.POLYFILL="P",qG=Sh,Jm=Ro,YG=S1.f,KG=G1,XG=MM,QG=O1,ZG=UG,JG=qG,mu=function(t,n){var o=t.target,r=t.global,s=t.stat,a,i,l,c,u,f;if(r?i=Jm:s?i=Jm[o]||QG(o,{}):i=Jm[o]&&Jm[o].prototype,i)for(l in n){if(u=n[l],t.dontCallGetSet?(f=YG(i,l),c=f&&f.value):c=i[l],a=JG(r?l:o+(s?".":"#")+l,t.forced),!a&&c!==void 0){if(typeof u==typeof c)continue;ZG(u,c)}(t.sham||c&&c.sham)&&KG(u,"sham",!0),XG(i,l,u,t)}},FM={},eV=LM,tV=J1,rV=Object.keys||function(t){return eV(t,tV)},nV=qa,oV=gM,sV=pu,iV=Wl,aV=Wm,lV=rV;FM.f=nV&&!oV?Object.defineProperties:function(t,n){iV(t);for(var o=aV(n),r=lV(n),s=r.length,a=0,i;s>a;)sV.f(t,i=r[a++],o[i]);return t};var cV=$m,uV=cV("document","documentElement"),dV=Wl,hV=FM,NM=J1,pV=$1,fV=uV,mV=pM,gV=jM,UM=">",BM="<",ex="prototype",tx="script",zM=gV("IE_PROTO"),rx=function(){},GM=function(t){return BM+tx+UM+t+BM+"/"+tx+UM},VM=function(t){t.write(GM("")),t.close();var n=t.parentWindow.Object;return t=null,n},yV=function(){var t=mV("iframe"),n="java"+tx+":",o;return t.style.display="none",fV.appendChild(t),t.src=String(n),o=t.contentWindow.document,o.open(),o.write(GM("document.F=Object")),o.close(),o.F},eg,tg=function(){try{eg=new ActiveXObject("htmlfile")}catch{}tg=typeof document<"u"?document.domain&&eg?VM(eg):yV():VM(eg);for(var t=NM.length;t--;)delete tg[ex][NM[t]];return tg()};pV[zM]=!0;var HM=Object.create||function(t,n){var o;return t!==null?(rx[ex]=dV(t),o=new rx,rx[ex]=null,o[zM]=t):o=tg(),n===void 0?o:hV.f(o,n)},vV=Yi,bV=HM,xV=pu.f,nx=vV("unscopables"),ox=Array.prototype;ox[nx]===void 0&&xV(ox,nx,{configurable:!0,value:bV(null)});var sx=function(t){ox[nx][t]=!0},wV=mu,SV=bh,jV=wh,_V=$l,kV=sx;wV({target:"Array",proto:!0},{at:function(t){var n=SV(this),o=jV(n),r=_V(t),s=r>=0?r:o+r;return s<0||s>=o?void 0:n[s]}}),kV("at");var EV=Ro,CV=_n,jh=function(t,n){return CV(EV[t].prototype[n])},PV=jh;PV("Array","at");var MV=uu,WM=Array.isArray||function(t){return MV(t)==="Array"},TV=TypeError,IV=9007199254740991,AV=function(t){if(t>IV)throw TV("Maximum allowed index exceeded");return t},OV=uu,LV=_n,RV=function(t){if(OV(t)==="Function")return LV(t)},$M=RV,DV=P1,FV=Gm,NV=$M($M.bind),UV=function(t,n){return DV(t),n===void 0?t:FV?NV(t,n):function(){return t.apply(n,arguments)}},BV=WM,zV=wh,GV=AV,VV=UV,qM=function(t,n,o,r,s,a,i,l){for(var c=s,u=0,f=i?VV(i,l):!1,h,d;u<r;)u in o&&(h=f?f(o[u],u,n):o[u],a>0&&BV(h)?(d=zV(h),c=qM(t,n,h,d,c,a-1)-1):(GV(c+1),t[c]=h),c++),u++;return c},YM=qM,HV=Yi,WV=HV("toStringTag"),KM={};KM[WV]="z";var $V=String(KM)==="[object z]",qV=$V,YV=vo,rg=uu,KV=Yi,XV=KV("toStringTag"),QV=Object,ZV=rg(function(){return arguments}())==="Arguments",JV=function(t,n){try{return t[n]}catch{}},XM=qV?rg:function(t){var n,o,r;return t===void 0?"Undefined":t===null?"Null":typeof(o=JV(n=QV(t),XV))=="string"?o:ZV?rg(n):(r=rg(n))==="Object"&&YV(n.callee)?"Arguments":r},eH=_n,tH=yo,QM=vo,rH=XM,nH=$m,oH=xM,ZM=function(){},JM=nH("Reflect","construct"),ix=/^\s*(?:class|function)\b/,sH=eH(ix.exec),iH=!ix.test(ZM),_h=function(t){if(!QM(t))return!1;try{return JM(ZM,[],t),!0}catch{return!1}},eT=function(t){if(!QM(t))return!1;switch(rH(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return iH||!!sH(ix,oH(t))}catch{return!0}};eT.sham=!0;var aH=!JM||tH(function(){var t;return _h(_h.call)||!_h(Object)||!_h(function(){t=!0})||t})?eT:_h,tT=WM,lH=aH,cH=Hl,uH=Yi,dH=uH("species"),rT=Array,hH=function(t){var n;return tT(t)&&(n=t.constructor,lH(n)&&(n===rT||tT(n.prototype))?n=void 0:cH(n)&&(n=n[dH],n===null&&(n=void 0))),n===void 0?rT:n},pH=hH,nT=function(t,n){return new(pH(t))(n===0?0:n)},fH=mu,mH=YM,gH=P1,yH=bh,vH=wh,bH=nT;fH({target:"Array",proto:!0},{flatMap:function(t){var n=yH(this),o=vH(n),r;return gH(t),r=bH(n,0),r.length=mH(r,n,n,o,0,1,t,arguments.length>1?arguments[1]:void 0),r}});var xH=sx;xH("flatMap");var wH=jh;wH("Array","flatMap");var SH=mu,jH=YM,_H=bh,kH=wh,EH=$l,CH=nT;SH({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,n=_H(this),o=kH(n),r=CH(n,0);return r.length=jH(r,n,n,o,0,t===void 0?1:EH(t)),r}});var PH=sx;PH("flat");var MH=jh;MH("Array","flat");var TH=XM,IH=String,kh=function(t){if(TH(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return IH(t)},AH=mu,OH=_n,LH=du,RH=$l,DH=kh,FH=yo,NH=OH("".charAt),UH=FH(function(){return"\u{20BB7}".at(-2)!=="\uD842"});AH({target:"String",proto:!0,forced:UH},{at:function(t){var n=DH(LH(this)),o=n.length,r=RH(t),s=r>=0?r:o+r;return s<0||s>=o?void 0:NH(n,s)}});var BH=jh;BH("String","at");var zH=Wl,oT=function(){var t=zH(this),n="";return t.hasIndices&&(n+="d"),t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.dotAll&&(n+="s"),t.unicode&&(n+="u"),t.unicodeSets&&(n+="v"),t.sticky&&(n+="y"),n},ax=yo,GH=Ro,lx=GH.RegExp,cx=ax(function(){var t=lx("a","y");return t.lastIndex=2,t.exec("abcd")!==null}),VH=cx||ax(function(){return!lx("a","y").sticky}),HH=cx||ax(function(){var t=lx("^r","gy");return t.lastIndex=2,t.exec("str")!==null}),WH={BROKEN_CARET:HH,MISSED_STICKY:VH,UNSUPPORTED_Y:cx},$H=yo,qH=Ro,YH=qH.RegExp,KH=$H(function(){var t=YH(".","s");return!(t.dotAll&&t.test(`
`)&&t.flags==="s")}),XH=yo,QH=Ro,ZH=QH.RegExp,JH=XH(function(){var t=ZH("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),gu=qi,ng=_n,eW=kh,tW=oT,rW=WH,nW=R1,oW=HM,sW=EM.get,iW=KH,aW=JH,lW=nW("native-string-replace",String.prototype.replace),og=RegExp.prototype.exec,ux=og,cW=ng("".charAt),uW=ng("".indexOf),dW=ng("".replace),dx=ng("".slice),hx=function(){var t=/a/,n=/b*/g;return gu(og,t,"a"),gu(og,n,"a"),t.lastIndex!==0||n.lastIndex!==0}(),sT=rW.BROKEN_CARET,px=/()??/.exec("")[1]!==void 0,hW=hx||px||sT||iW||aW;hW&&(ux=function(t){var n=this,o=sW(n),r=eW(t),s=o.raw,a,i,l,c,u,f,h;if(s)return s.lastIndex=n.lastIndex,a=gu(ux,s,r),n.lastIndex=s.lastIndex,a;var d=o.groups,p=sT&&n.sticky,y=gu(tW,n),g=n.source,b=0,m=r;if(p&&(y=dW(y,"y",""),uW(y,"g")===-1&&(y+="g"),m=dx(r,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&cW(r,n.lastIndex-1)!==`
`)&&(g="(?: "+g+")",m=" "+m,b++),i=new RegExp("^(?:"+g+")",y)),px&&(i=new RegExp("^"+g+"$(?!\\s)",y)),hx&&(l=n.lastIndex),c=gu(og,p?i:n,m),p?c?(c.input=dx(c.input,b),c[0]=dx(c[0],b),c.index=n.lastIndex,n.lastIndex+=c[0].length):n.lastIndex=0:hx&&c&&(n.lastIndex=n.global?c.index+c[0].length:l),px&&c&&c.length>1&&gu(lW,c[0],i,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&d)for(c.groups=f=oW(null),u=0;u<d.length;u++)h=d[u],f[h[0]]=c[h[1]];return c});var fx=ux,pW=mu,iT=fx;pW({target:"RegExp",proto:!0,forced:/./.exec!==iT},{exec:iT});var fW=Gm,aT=Function.prototype,lT=aT.apply,cT=aT.call,mW=typeof Reflect=="object"&&Reflect.apply||(fW?cT.bind(lT):function(){return cT.apply(lT,arguments)}),uT=qi,dT=MM,gW=fx,hT=yo,pT=Yi,yW=G1,vW=pT("species"),mx=RegExp.prototype,bW=function(t,n,o,r){var s=pT(t),a=!hT(function(){var u={};return u[s]=function(){return 7},""[t](u)!==7}),i=a&&!hT(function(){var u=!1,f=/a/;return t==="split"&&(f={},f.constructor={},f.constructor[vW]=function(){return f},f.flags="",f[s]=/./[s]),f.exec=function(){return u=!0,null},f[s](""),!u});if(!a||!i||o){var l=/./[s],c=n(s,""[t],function(u,f,h,d,p){var y=f.exec;return y===gW||y===mx.exec?a&&!p?{done:!0,value:uT(l,f,h,d)}:{done:!0,value:uT(u,h,f,d)}:{done:!1}});dT(String.prototype,t,c[0]),dT(mx,s,c[1])}r&&yW(mx[s],"sham",!0)},gx=_n,xW=$l,wW=kh,SW=du,jW=gx("".charAt),fT=gx("".charCodeAt),_W=gx("".slice),mT=function(t){return function(n,o){var r=wW(SW(n)),s=xW(o),a=r.length,i,l;return s<0||s>=a?t?"":void 0:(i=fT(r,s),i<55296||i>56319||s+1===a||(l=fT(r,s+1))<56320||l>57343?t?jW(r,s):i:t?_W(r,s,s+2):(i-55296<<10)+(l-56320)+65536)}},kW={codeAt:mT(!1),charAt:mT(!0)},EW=kW.charAt,CW=function(t,n,o){return n+(o?EW(t,n).length:1)},yx=_n,PW=bh,MW=Math.floor,vx=yx("".charAt),TW=yx("".replace),bx=yx("".slice),IW=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,AW=/\$([$&'`]|\d{1,2})/g,gT=function(t,n,o,r,s,a){var i=o+t.length,l=r.length,c=AW;return s!==void 0&&(s=PW(s),c=IW),TW(a,c,function(u,f){var h;switch(vx(f,0)){case"$":return"$";case"&":return t;case"`":return bx(n,0,o);case"'":return bx(n,i);case"<":h=s[bx(f,1,-1)];break;default:var d=+f;if(d===0)return u;if(d>l){var p=MW(d/10);return p===0?u:p<=l?r[p-1]===void 0?vx(f,1):r[p-1]+vx(f,1):u}h=r[d-1]}return h===void 0?"":h})},yT=qi,OW=Wl,LW=vo,RW=uu,DW=fx,FW=TypeError,NW=function(t,n){var o=t.exec;if(LW(o)){var r=yT(o,t,n);return r!==null&&OW(r),r}if(RW(t)==="RegExp")return yT(DW,t,n);throw new FW("RegExp#exec called on incompatible receiver")},UW=mW,vT=qi,sg=_n,BW=bW,zW=yo,GW=Wl,VW=vo,HW=Hm,WW=$l,$W=IM,yu=kh,qW=du,YW=CW,KW=M1,XW=gT,QW=NW,ZW=Yi,xx=ZW("replace"),JW=Math.max,e$=Math.min,t$=sg([].concat),wx=sg([].push),bT=sg("".indexOf),xT=sg("".slice),r$=function(t){return t===void 0?t:String(t)},n$=function(){return"a".replace(/./,"$0")==="$0"}(),wT=function(){return/./[xx]?/./[xx]("a","$0")==="":!1}(),o$=!zW(function(){var t=/./;return t.exec=function(){var n=[];return n.groups={a:"7"},n},"".replace(t,"$<a>")!=="7"});BW("replace",function(t,n,o){var r=wT?"$":"$0";return[function(s,a){var i=qW(this),l=HW(s)?void 0:KW(s,xx);return l?vT(l,s,i,a):vT(n,yu(i),s,a)},function(s,a){var i=GW(this),l=yu(s);if(typeof a=="string"&&bT(a,r)===-1&&bT(a,"$<")===-1){var c=o(n,i,l,a);if(c.done)return c.value}var u=VW(a);u||(a=yu(a));var f=i.global,h;f&&(h=i.unicode,i.lastIndex=0);for(var d=[],p;p=QW(i,l),!(p===null||(wx(d,p),!f));){var y=yu(p[0]);y===""&&(i.lastIndex=YW(l,$W(i.lastIndex),h))}for(var g="",b=0,m=0;m<d.length;m++){p=d[m];for(var v=yu(p[0]),x=JW(e$(WW(p.index),l.length),0),w=[],S,k=1;k<p.length;k++)wx(w,r$(p[k]));var _=p.groups;if(u){var C=t$([v],w,x,l);_!==void 0&&wx(C,_),S=yu(UW(a,void 0,C))}else S=XW(v,l,x,w,_,a);x>=b&&(g+=xT(l,b,x)+S,b=x+v.length)}return g+xT(l,b)}]},!o$||!n$||wT);var s$=Hl,i$=uu,a$=Yi,l$=a$("match"),c$=function(t){var n;return s$(t)&&((n=t[l$])!==void 0?!!n:i$(t)==="RegExp")},u$=qi,d$=Ya,h$=$P,p$=oT,ST=RegExp.prototype,f$=function(t){var n=t.flags;return n===void 0&&!("flags"in ST)&&!d$(t,"flags")&&h$(ST,t)?u$(p$,t):n},m$=mu,g$=qi,Sx=_n,jT=du,y$=vo,v$=Hm,b$=c$,Eh=kh,x$=M1,w$=f$,S$=gT,j$=Yi,_$=j$("replace"),k$=TypeError,jx=Sx("".indexOf);Sx("".replace);var _T=Sx("".slice),E$=Math.max;m$({target:"String",proto:!0},{replaceAll:function(t,n){var o=jT(this),r,s,a,i,l,c,u,f,h,d=0,p=0,y="";if(!v$(t)){if(r=b$(t),r&&(s=Eh(jT(w$(t))),!~jx(s,"g")))throw new k$("`.replaceAll` does not allow non-global regexes");if(a=x$(t,_$),a)return g$(a,t,o,n)}for(i=Eh(o),l=Eh(t),c=y$(n),c||(n=Eh(n)),u=l.length,f=E$(1,u),d=jx(i,l);d!==-1;)h=c?Eh(n(l,d,i)):S$(l,i,d,[],void 0,n),y+=_T(i,p,d)+h,p=d+u,d=d+f>i.length?-1:jx(i,l,d+f);return p<i.length&&(y+=_T(i,p)),y}});var C$=jh;C$("String","replaceAll");function P$(t){return t.getSelectedShapeIds().map(n=>t.getShape(n)).filter(n=>!(!n||t.isShapeOfType(n,"arrow")&&n.props.start.type==="binding"||t.isShapeOfType(n,"arrow")&&n.props.end.type==="binding"))}const kT=()=>{const t=Be();return We("threeStackableItems",()=>P$(t).length>2,[t])},ET=()=>{const t=Be();return We("allow group",()=>{const n=t.getSelectedShapes();if(n.length<2)return!1;for(const o of n)if(t.isShapeOfType(o,"arrow")){const{start:r,end:s}=o.props;if(r.type==="binding"&&!n.some(a=>a.id===r.boundShapeId)||s.type==="binding"&&!n.some(a=>a.id===s.boundShapeId))return!1}return!0},[t])},CT=()=>{const t=Be();return We("allowUngroup",()=>t.getSelectedShapeIds().some(n=>{var o;return((o=t.getShape(n))==null?void 0:o.type)==="group"}),[t])},M$=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read;function T$(t,n){const o=Be();return We("selectedShapes",()=>{const r=o.getSelectedShapes().length;return t===void 0?n===void 0?r:r<=n:n===void 0?r>=t:r>=t&&r<=n},[o,t,n])}function bo(t,n){const o=Be();return We("selectedShapes",()=>{const r=o.getSelectedShapes().filter(s=>!o.isShapeOrAncestorLocked(s)).length;return t===void 0?n===void 0?r:r<=n:n===void 0?r>=t:r>=t&&r<=n},[o])}function I$(){const t=Be();return We("showAutoSizeToggle",()=>{const n=t.getSelectedShapes();return n.length===1&&t.isShapeOfType(n[0],"text")&&n[0].props.autoSize===!1},[t])}function PT(){const t=Be();return We("hasLinkShapeSelected",()=>{const n=t.getOnlySelectedShape();return!!(n&&n.type!=="embed"&&"url"in n.props&&!n.isLocked)},[t])}function A$(){const t=Be();return We("onlyFlippableShape",()=>{const n=t.getOnlySelectedShape();return n&&(t.isShapeOfType(n,"group")||t.isShapeOfType(n,"arrow")||t.isShapeOfType(n,"line")||t.isShapeOfType(n,"draw"))},[t])}function MT(){const t=Be();return We("useCanRedo",()=>t.getCanRedo(),[t])}function TT(){const t=Be();return We("useCanUndo",()=>t.getCanUndo(),[t])}function O$({children:t}){const n=Be();return We("shouldDisplayHandles",()=>{if(n.isInAny("select.idle","select.pointing_handle","select.pointing_shape"))return!0;if(n.isInAny("select.editing_shape")){const o=n.getOnlySelectedShape();return o&&n.isShapeOfType(o,"note")}return!1},[n])?E.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}):null}const{PI:L$}=Math,vu=L$+1e-4;function IT(t,n={}){const{size:o=16,smoothing:r=.5}=n;if(t.length===0||o<=0)return{left:[],right:[]};const s=t[0],a=t[t.length-1],i=a.runningLength,l=Math.pow(o*r,2),c=[],u=[];let f=t[0].vector,h=t[0].point,d=h,p=h,y=d,g=!1,b;for(let m=0;m<t.length;m++){b=t[m];const{point:v,vector:x}=t[m],w=b.vector.dpr(f),S=(m<t.length-1?t[m+1]:t[m]).vector,k=m<t.length-1?S.dpr(b.vector):1,_=w<0&&!g,C=k!==null&&k<.2;if(_||C){if(k>-.62&&i-b.runningLength>b.radius){const A=f.clone().mul(b.radius);f.clone().cpr(S)<0?(p=q.Add(v,A),y=q.Sub(v,A)):(p=q.Sub(v,A),y=q.Add(v,A)),c.push(p),u.push(y)}else{const A=f.clone().mul(b.radius).per(),I=q.Sub(b.input,A);for(let N=1/13,O=0;O<1;O+=N)p=q.RotWith(I,b.input,vu*O),c.push(p),y=q.RotWith(I,b.input,vu+vu*-O),u.push(y)}h=p,d=y,C&&(g=!0);continue}if(g=!1,b===s||b===a){const A=q.Per(x).mul(b.radius);c.push(q.Sub(v,A)),u.push(q.Add(v,A));continue}const P=q.Lrp(S,x,k).per().mul(b.radius);p=q.Sub(v,P),(m<=1||q.Dist2(h,p)>l)&&(c.push(p),h=p),y=q.Add(v,P),(m<=1||q.Dist2(d,y)>l)&&(u.push(y),d=y),f=x}return{left:c,right:u}}function _x(t,n={}){const{size:o=16,start:r={},end:s={},last:a=!1}=n,{cap:i=!0}=r,{cap:l=!0}=s;if(t.length===0||o<=0)return[];const c=t[0],u=t[t.length-1],f=u.runningLength,h=r.taper===!1?0:r.taper===!0?Math.max(o,f):r.taper,d=s.taper===!1?0:s.taper===!0?Math.max(o,f):s.taper,{left:p,right:y}=IT(t,n),g=c.point,b=t.length>1?t[t.length-1].point:q.AddXY(c.point,1,1);if(t.length===1&&(!(h||d)||a)){const w=q.Add(g,q.Sub(g,b).uni().per().mul(-c.radius)),S=[];for(let k=1/13,_=k;_<=1;_+=k)S.push(q.RotWith(w,g,vu*2*_));return S}const m=[];if(!(h||d&&t.length===1))if(i)for(let w=1/8,S=w;S<=1;S+=w){const k=q.RotWith(y[0],g,vu*S);m.push(k)}else{const w=q.Sub(p[0],y[0]),S=q.Mul(w,.5),k=q.Mul(w,.51);m.push(q.Sub(g,S),q.Sub(g,k),q.Add(g,k),q.Add(g,S))}const v=[],x=u.vector.clone().per().neg();if(d||h&&t.length===1)v.push(b);else if(l){const w=q.Add(b,q.Mul(x,u.radius));for(let S=1/29,k=S;k<1;k+=S)v.push(q.RotWith(w,b,vu*3*k))}else v.push(q.Add(b,q.Mul(x,u.radius)),q.Add(b,q.Mul(x,u.radius*.99)),q.Sub(b,q.Mul(x,u.radius*.99)),q.Sub(b,q.Mul(x,u.radius)));return p.concat(v,y.reverse(),m)}const R$=.025,D$=.01;function ui(t,n={}){var b;const{streamline:o=.5,size:r=16,simulatePressure:s=!1}=n;if(t.length===0)return[];const a=.15+(1-o)*.85;let i=t.map(q.From),l=0;if(!s){let m=i[0];for(;m&&!(m.z>=R$);)i.shift(),m=i[0]}if(!s){let m=i[i.length-1];for(;m&&!(m.z>=D$);)i.pop(),m=i[i.length-1]}if(i.length===0)return[{point:q.From(t[0]),input:q.From(t[0]),pressure:s?.5:.15,vector:new q(1,1),distance:0,runningLength:0,radius:1}];let c=i[1];for(;c&&!(q.Dist2(c,i[0])>(r/3)**2);)i[0].z=Math.max(i[0].z,c.z),i.splice(1,1),c=i[1];const u=i.pop();for(c=i[i.length-1];c&&!(q.Dist2(c,u)>(r/3)**2);)i.pop(),c=i[i.length-1],l++;i.push(u);const f=n.last||!n.simulatePressure||i.length>1&&q.Dist2(i[i.length-1],i[i.length-2])<r**2||l>0;if(i.length===2&&n.simulatePressure){const m=i[1];i=i.slice(0,-1);for(let v=1;v<5;v++){const x=q.Lrp(i[0],m,v/4);x.z=(i[0].z+(m.z-i[0].z))*v/4,i.push(x)}}const h=[{point:i[0],input:i[0],pressure:s?.5:i[0].z,vector:new q(1,1),distance:0,runningLength:0,radius:1}];let d=0,p=h[0],y,g;f&&o>0&&i.push(i[i.length-1].clone());for(let m=1,v=i.length;m<v;m++)y=!a||n.last&&m===v-1?i[m].clone():i[m].clone().lrp(p.point,1-a),!p.point.equals(y)&&(g=q.Dist(y,p.point),d+=g,!(m<4&&d<r)&&(p={input:i[m],point:y,pressure:s?.5:i[m].z,vector:q.Sub(p.point,y).uni(),distance:g,runningLength:d,radius:1},h.push(p)));if((b=h[1])!=null&&b.vector&&(h[0].vector=h[1].vector.clone()),d<1){const m=Math.max(.5,...h.map(v=>v.pressure));h.forEach(v=>v.pressure=m)}return h}const{min:Ka}=Math,kx=.275;function ig(t,n){const{size:o=16,thinning:r=.5,simulatePressure:s=!0,easing:a=b=>b,start:i={},end:l={}}=n,{easing:c=Kn.easeOutQuad}=i,{easing:u=Kn.easeOutCubic}=l,f=t[t.length-1].runningLength;let h,d=t[0].pressure,p;if(!s&&f<o){const b=t.reduce((m,v)=>Math.max(m,v.pressure),.5);return t.forEach(m=>{m.pressure=b,m.radius=o*a(.5-r*(.5-m.pressure))}),t}else{let b;for(let m=0,v=t.length;m<v&&(p=t[m],!(p.runningLength>o*5));m++){const x=Ka(1,p.distance/o);if(s){const w=Ka(1,1-x);b=Ka(1,d+(w-d)*(x*kx))}else b=Ka(1,d+(p.pressure-d)*.5);d=d+(b-d)*.5}for(let m=0;m<t.length;m++){if(p=t[m],r){let{pressure:v}=p;const x=Ka(1,p.distance/o);if(s){const w=Ka(1,1-x);v=Ka(1,d+(w-d)*(x*kx))}else v=Ka(1,d+(v-d)*(x*kx));p.radius=o*a(.5-r*(.5-v)),d=v}else p.radius=o/2;h===void 0&&(h=p.radius)}}const y=i.taper===!1?0:i.taper===!0?Math.max(o,f):i.taper,g=l.taper===!1?0:l.taper===!0?Math.max(o,f):l.taper;if(y||g)for(let b=0;b<t.length;b++){p=t[b];const{runningLength:m}=p,v=m<y?c(m/y):1,x=f-m<g?u((f-m)/g):1;p.radius=Math.max(.01,p.radius*Math.min(v,x))}return t}function F$(t,n={}){return _x(ig(ui(t,n),n),n)}function AT({scribble:t,zoom:n,color:o,opacity:r,className:s}){if(!t.points.length)return null;const a=F$(t.points,{size:t.size/n,start:{taper:t.taper,easing:Kn.linear},last:t.state==="stopping",simulatePressure:!1,streamline:.32});let i;if(a.length<4){const l=t.size/n/2,{x:c,y:u}=t.points[t.points.length-1];i=`M ${c-l},${u} a ${l},${l} 0 1,0 ${l*2},0 a ${l},${l} 0 1,0 ${-l*2},0`}else i=Kb(a);return E.jsx("svg",{className:s&&Pt("tl-overlays__item",s),children:E.jsx("path",{className:"tl-scribble",d:i,fill:o??`var(--color-${t.color})`,opacity:r??t.opacity})})}const N$=({bounds:t,rotation:n})=>{const o=Be();return We("should display",()=>o.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[o])?E.jsx(DC,{bounds:t,rotation:n}):null};function Ki(){const t=Be();return We("isReadonlyMode",()=>t.getInstanceState().isReadonly,[t])}function U$({size:t,width:n,height:o,hideAlternateHandles:r}){const s=ke(t/3),a=s/2;return E.jsxs("svg",{className:"tl-overlays__item",children:[E.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${ke(0-a)},${ke(t)} 
						${ke(0-a)},${ke(0-a)} 
						${ke(t)},${ke(0-a)}`,strokeWidth:s,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),E.jsx("line",{className:Pt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ke(n/2-t),y1:ke(0-a),x2:ke(n/2+t),y2:ke(0-a),strokeWidth:s,"data-testid":"selection.crop.top","aria-label":"top handle"}),E.jsx("polyline",{className:Pt("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${ke(n-t)},${ke(0-a)} 
						${ke(n+a)},${ke(0-a)} 
						${ke(n+a)},${ke(t)}`,strokeWidth:s,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),E.jsx("line",{className:Pt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ke(n+a),y1:ke(o/2-t),x2:ke(n+a),y2:ke(o/2+t),strokeWidth:s,"data-testid":"selection.crop.right","aria-label":"right handle"}),E.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${ke(n+a)},${ke(o-t)} 
						${ke(n+a)},${ke(o+a)}
						${ke(n-t)},${ke(o+a)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),E.jsx("line",{className:Pt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ke(n/2-t),y1:ke(o+a),x2:ke(n/2+t),y2:ke(o+a),strokeWidth:s,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),E.jsx("polyline",{className:Pt("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${ke(0+t)},${ke(o+a)} 
						${ke(0-a)},${ke(o+a)}
						${ke(0-a)},${ke(o-t)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),E.jsx("line",{className:Pt("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ke(0-a),y1:ke(o/2-t),x2:ke(0-a),y2:ke(o/2+t),strokeWidth:s,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const B$=qo(function({bounds:t,rotation:n}){const o=Be(),r=z.useRef(null),s=Ki(),a=li("top"),i=li("right"),l=li("bottom"),c=li("left"),u=li("top_left"),f=li("top_right"),h=li("bottom_right"),d=li("bottom_left"),p=!o.getIsMenuOpen()&&o.getInstanceState().cursor.type==="default",y=o.getInstanceState().isCoarsePointer,g=o.getOnlySelectedShape(),b=g&&o.isShapeOrAncestorLocked(g),m=g?o.getShapeUtil(g).expandSelectionOutlinePx(g):0;if(Qc(r,t==null?void 0:t.x,t==null?void 0:t.y,1,o.getSelectionRotation(),{x:-m,y:-m}),!t)return null;t=t.clone().expandBy(m).zeroFix();const v=o.getZoomLevel(),x=o.getInstanceState().isChangingStyle,w=t.width,S=t.height,k=8/v,_=w<k*2,C=S<k*2,P=w<k*4,A=S<k*4,I=w<k*5,N=S<k*5,O=y?1.75:1,F=6/v*O,U=(P?F/2:F)*(O*.75),G=(A?F/2:F)*(O*.75),Y=(g?!o.getShapeUtil(g).hideSelectionBoundsFg(g):!0)&&!x;let $=Y&&o.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||Y&&o.isIn("select.resizing")&&g&&o.isShapeOfType(g,"text");g&&$&&o.environment.isFirefox&&o.isShapeOfType(g,"embed")&&($=!1);const H=o.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!x&&!s,Q=o.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!x&&!s,J=!y&&!(_||C)&&(Q||H)&&(g?!o.getShapeUtil(g).hideRotateHandle(g):!0)&&!b,ae=y&&(!P||!A)&&(Q||H)&&(g?!o.getShapeUtil(g).hideRotateHandle(g):!0)&&!b,T=Q&&(g?o.getShapeUtil(g).canResize(g)&&!o.getShapeUtil(g).hideResizeHandles(g):!0)&&!H&&!b,B=_||C,W=_&&C,K=I||N,te=T||H,ne=!J,ce=!Q||!ae,fe=!Q||!te,ue=!Q||!te||B,ge=!Q||!te||B,me=!Q||!te||W&&!H;let oe=!0,de=!0;if(H)oe=K,de=K;else if(T){oe=B||W||y;const we=y&&g&&g.type==="text";de=oe&&!we}const xe=Math.min(24/v,S-G*3),Ie=Q&&y&&g&&o.isShapeOfType(g,"text")&&xe*v>=4;return E.jsx("svg",{className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:E.jsxs("g",{ref:r,children:[$&&E.jsx("rect",{className:"tl-selection__fg__outline",width:ke(w),height:ke(S)}),E.jsx(ag,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:F,corner:"top_left_rotate",cursor:p?rs("nwse-rotate",n):void 0,isHidden:ne}),E.jsx(ag,{"data-testid":"selection.rotate.top-right",cx:w+F*3,cy:0,targetSize:F,corner:"top_right_rotate",cursor:p?rs("nesw-rotate",n):void 0,isHidden:ne}),E.jsx(ag,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:S+F*3,targetSize:F,corner:"bottom_left_rotate",cursor:p?rs("swne-rotate",n):void 0,isHidden:ne}),E.jsx(ag,{"data-testid":"selection.rotate.bottom-right",cx:w+F*3,cy:S+F*3,targetSize:F,corner:"bottom_right_rotate",cursor:p?rs("senw-rotate",n):void 0,isHidden:ne}),E.jsx(G$,{"data-testid":"selection.rotate.mobile",cx:P?-F*1.5:w/2,cy:P?S/2:-F*1.5,size:k,isHidden:ce}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":oe}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:ke(0-(A?G*2:G)),width:ke(w),height:ke(Math.max(1,G*2)),style:p?{cursor:rs("ns-resize",n)}:void 0,...a}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":de}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:ke(w-(P?0:U)),y:0,height:ke(S),width:ke(Math.max(1,U*2)),style:p?{cursor:rs("ew-resize",n)}:void 0,...i}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":oe}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:ke(S-(A?0:G)),width:ke(w),height:ke(Math.max(1,G*2)),style:p?{cursor:rs("ns-resize",n)}:void 0,...l}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":de}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:ke(0-(P?U*2:U)),y:0,height:ke(S),width:ke(Math.max(1,U*2)),style:p?{cursor:rs("ew-resize",n)}:void 0,...c}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":fe}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:ke(0-(P?U*2:U*1.5)),y:ke(0-(A?G*2:G*1.5)),width:ke(U*3),height:ke(G*3),style:p?{cursor:rs("nwse-resize",n)}:void 0,...u}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":ue}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:ke(w-(P?0:U*1.5)),y:ke(0-(A?G*2:G*1.5)),width:ke(U*3),height:ke(G*3),style:p?{cursor:rs("nesw-resize",n)}:void 0,...f}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":me}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:ke(w-(P?U:U*1.5)),y:ke(S-(A?G:G*1.5)),width:ke(U*3),height:ke(G*3),style:p?{cursor:rs("nwse-resize",n)}:void 0,...h}),E.jsx("rect",{className:Pt("tl-transparent",{"tl-hidden":ge}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:ke(0-(P?U*3:U*1.5)),y:ke(S-(A?0:G*1.5)),width:ke(U*3),height:ke(G*3),style:p?{cursor:rs("nesw-resize",n)}:void 0,...d}),T&&E.jsxs(E.Fragment,{children:[E.jsx("rect",{"data-testid":"selection.resize.top-left",className:Pt("tl-corner-handle",{"tl-hidden":fe}),"aria-label":"top_left handle",x:ke(0-k/2),y:ke(0-k/2),width:ke(k),height:ke(k)}),E.jsx("rect",{"data-testid":"selection.resize.top-right",className:Pt("tl-corner-handle",{"tl-hidden":ue}),"aria-label":"top_right handle",x:ke(w-k/2),y:ke(0-k/2),width:ke(k),height:ke(k)}),E.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:Pt("tl-corner-handle",{"tl-hidden":me}),"aria-label":"bottom_right handle",x:ke(w-k/2),y:ke(S-k/2),width:ke(k),height:ke(k)}),E.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:Pt("tl-corner-handle",{"tl-hidden":ge}),"aria-label":"bottom_left handle",x:ke(0-k/2),y:ke(S-k/2),width:ke(k),height:ke(k)})]}),Ie&&E.jsxs(E.Fragment,{children:[E.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:ke(0-k/4),y:ke(S/2-xe/2),rx:k/4,width:ke(k/2),height:ke(xe)}),E.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:k/4,x:ke(w-k/4),y:ke(S/2-xe/2),width:ke(k/2),height:ke(xe)})]}),H&&E.jsx(U$,{size:k,width:w,height:S,hideAlternateHandles:K})]})})}),ag=function({cx:t,cy:n,targetSize:o,corner:r,cursor:s,isHidden:a,"data-testid":i}){const l=li(r);return E.jsx("rect",{className:Pt("tl-transparent","tl-rotate-corner",{"tl-hidden":a}),"data-testid":i,"aria-label":`${r} target`,pointerEvents:"all",x:ke(t-o*3),y:ke(n-o*3),width:ke(Math.max(1,o*3)),height:ke(Math.max(1,o*3)),cursor:s,...l})},z$=Math.sqrt(Math.PI),G$=function({cx:t,cy:n,size:o,isHidden:r,"data-testid":s}){const a=li("mobile_rotate"),i=Be(),l=We("zoom level",()=>i.getZoomLevel(),[i]),c=Math.max(14*(1/l),20/Math.max(1,l));return E.jsxs("g",{children:[E.jsx("circle",{"data-testid":s,pointerEvents:"all",className:Pt("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":r}),cx:t,cy:n,r:c,...a}),E.jsx("circle",{className:Pt("tl-mobile-rotate__fg",{"tl-hidden":r}),cx:t,cy:n,r:o/z$})]})},Rn={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},kn={s:2,m:3.5,l:5,xl:10},bu={s:18,m:24,l:36,xl:44},Xi={s:18,m:22,l:26,xl:32},ql={s:18,m:20,l:24,xl:28},di={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},V$=20,H$=4.25,Vs=16;/*!
* canvas-size
* v1.2.6
* https://github.com/jhildenbiddle/canvas-size
* (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
* MIT license
*/function W$(t,n){var o=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(o!=null){var r,s,a,i,l=[],c=!0,u=!1;try{if(a=(o=o.call(t)).next,n===0){if(Object(o)!==o)return;c=!1}else for(;!(c=(r=a.call(o)).done)&&(l.push(r.value),l.length!==n);c=!0);}catch(f){u=!0,s=f}finally{try{if(!c&&o.return!=null&&(i=o.return(),Object(i)!==i))return}finally{if(u)throw s}}return l}}function OT(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),o.push.apply(o,r)}return o}function ns(t){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?OT(Object(o),!0).forEach(function(r){$$(t,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):OT(Object(o)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))})}return t}function $$(t,n,o){return n=tq(n),n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function q$(t,n){if(t==null)return{};var o={},r=Object.keys(t),s,a;for(a=0;a<r.length;a++)s=r[a],!(n.indexOf(s)>=0)&&(o[s]=t[s]);return o}function Y$(t,n){if(t==null)return{};var o=q$(t,n),r,s;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)r=a[s],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function LT(t,n){return X$(t)||W$(t,n)||RT(t,n)||J$()}function lg(t){return K$(t)||Q$(t)||RT(t)||Z$()}function K$(t){if(Array.isArray(t))return Ex(t)}function X$(t){if(Array.isArray(t))return t}function Q$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function RT(t,n){if(t){if(typeof t=="string")return Ex(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);if(o==="Object"&&t.constructor&&(o=t.constructor.name),o==="Map"||o==="Set")return Array.from(t);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Ex(t,n)}}function Ex(t,n){(n==null||n>t.length)&&(n=t.length);for(var o=0,r=new Array(n);o<n;o++)r[o]=t[o];return r}function Z$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eq(t,n){if(typeof t!="object"||t===null)return t;var o=t[Symbol.toPrimitive];if(o!==void 0){var r=o.call(t,n||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function tq(t){var n=eq(t,"string");return typeof n=="symbol"?n:String(n)}function Ch(t){var n=t.sizes.shift(),o=Math.max(Math.ceil(n[0]),1),r=Math.max(Math.ceil(n[1]),1),s=[o-1,r-1,1,1],a=Date.now(),i=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,l,c;i?(l=new OffscreenCanvas(1,1),c=new OffscreenCanvas(o,r)):(l=document.createElement("canvas"),l.width=1,l.height=1,c=document.createElement("canvas"),c.width=o,c.height=r);var u=l.getContext("2d"),f=c.getContext("2d");f&&(f.fillRect.apply(f,s),u.drawImage(c,o-1,r-1,1,1,0,0,1,1));var h=u&&u.getImageData(0,0,1,1).data[3]!==0,d=Date.now()-a;return[l,c].forEach(function(p){p.height=0,p.width=0}),i?(postMessage({width:o,height:r,benchmark:d,isTestPass:h}),!h&&t.sizes.length&&Ch(t)):h?t.onSuccess(o,r,d):(t.onError(o,r,d),t.sizes.length&&Ch(t)),h}var Cx={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},rq=["onError","onSuccess"],xu={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ph={};function Px(t){var n=t.width===t.height,o=t.height===1,r=t.width===1,s=[];if(!t.width||!t.height)t.sizes.forEach(function(f){var h=n||o?f:1,d=n||r?f:1;s.push([h,d])});else for(var a=t.min||xu.min,i=t.step||xu.step,l=Math.max(t.width,t.height);l>=a;){var c=n||o?l:1,u=n||r?l:1;s.push([c,u]),l-=i}return s}function cg(t){var n=window&&"HTMLCanvasElement"in window,o=window&&"OffscreenCanvas"in window,r=Date.now(),s=t.onError,a=t.onSuccess,i=Y$(t,rq),l=null;if(!n)return!1;if(t.useWorker&&o){var c=`
            var canvasTest = `.concat(Ch.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),u=new Blob([c],{type:"application/javascript"}),f=URL.createObjectURL(u);l=new Worker(f),URL.revokeObjectURL(f),l.onmessage=function(h){var d=h.data,p=d.width,y=d.height,g=d.benchmark,b=d.isTestPass;b?(Ph[r].onSuccess(p,y,g),delete Ph[r]):Ph[r].onError(p,y,g)}}if(t.usePromise)return new Promise(function(h,d){var p=ns(ns({},t),{},{onError:function(b,m,v){var x;if(t.sizes.length===0)x=!0;else{var w=t.sizes.slice(-1),S=LT(w,1),k=LT(S[0],2),_=k[0],C=k[1];x=b===_&&m===C}s(b,m,v),x&&d({width:b,height:m,benchmark:v})},onSuccess:function(b,m,v){a(b,m,v),h({width:b,height:m,benchmark:v})}});if(l){var y=p.onError,g=p.onSuccess;Ph[r]={onError:y,onSuccess:g},l.postMessage(i)}else Ch(p)});if(l)Ph[r]={onError:s,onSuccess:a},l.postMessage(i);else return Ch(t)}var Mx={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Px({width:t.max,height:t.max,min:t.min,step:t.step,sizes:lg(Cx.area)}),o=ns(ns(ns({},xu),t),{},{sizes:n});return cg(o)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Px({width:1,height:t.max,min:t.min,step:t.step,sizes:lg(Cx.height)}),o=ns(ns(ns({},xu),t),{},{sizes:n});return cg(o)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Px({width:t.max,height:1,min:t.min,step:t.step,sizes:lg(Cx.width)}),o=ns(ns(ns({},xu),t),{},{sizes:n});return cg(o)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=ns(ns({},xu),t);return n.sizes=lg(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),cg(n)}};let Tx=null;function nq(){return Tx||(Tx=oq()),Tx}async function oq(){const t=await Mx.maxWidth({usePromise:!0}),n=await Mx.maxHeight({usePromise:!0}),o=await Mx.maxArea({usePromise:!0});return{maxWidth:t.width,maxHeight:n.height,maxArea:o.width*o.height}}const DT=8192,sq=4096*4096;async function FT(t,n){if(t<=DT&&n<=DT&&t*n<=sq)return[t,n];const{maxWidth:o,maxHeight:r,maxArea:s}=await nq(),a=t/n;if(t>o&&(t=o,n=t/a),n>r&&(n=r,t=n*a),t*n>s){const i=Math.sqrt(s/(t*n));t*=i,n*=i}return[t,n]}/*!
* MIT License
* Modified code originally from <https://github.com/qzb/is-animated>
* Copyright (c) 2016 Józef Sokołowski <j.k.sokolowski@gmail.com>
*/function NT(t,n){let o=0;for(;t[n+o];)o+=t[n+o]+1;return o+1}function iq(t){return new TextDecoder("ascii").decode(t.slice(0,3))==="GIF"}function aq(t){const n=new Uint8Array(t);let o,r,s=0,a=0;if(!iq(t))return!1;for(o=n[10]&128,r=n[10]&7,s+=6,s+=7,s+=o?3*Math.pow(2,r+1):0;a<2&&s<n.length;)switch(n[s]){case 44:a+=1,o=n[s+9]&128,r=n[s+9]&7,s+=10,s+=o?3*Math.pow(2,r+1):0,s+=NT(n,s+1)+1;break;case 33:s+=2,s+=NT(n,s);break;case 59:s=n.length;break;default:s=n.length;break}return a>1}function lq(t,n){const o=t.w/n.w,r=t.h/n.h;return o<=1&&r<=1?t:o>r?{w:t.w/o,h:t.h/o}:{w:t.w/r,h:t.h/r}}async function cq(t,n,o,r={}){const s=await ia.usingObjectURL(t,ia.loadImage),{type:a=t.type,quality:i=.92}=r,[l,c]=await FT(Math.min(n*2,s.naturalWidth),Math.min(o*2,s.naturalHeight)),u=document.createElement("canvas");u.width=l,u.height=c;const f=Ol(u.getContext("2d",{willReadFrequently:!0}),"Could not get canvas context");return f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(s,0,0,l,c),new Promise((h,d)=>{u.toBlob(p=>{p?h(p):d(new Error("Could not resize image"))},a,i)})}async function uq(t){return aq(await t.arrayBuffer())}function dq(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function hq(t){const n=new URL(t).host.replace("www.","");for(const o of Qd)if(UT(o.hostnames,n)){const r=o.fromEmbedUrl(t);if(r)return{definition:o,url:r,embedUrl:t}}}const pq=t=>t.split("*").map(n=>dq(n)).join(".+"),UT=(t,n)=>!!t.find(o=>{const r=new RegExp(pq(o));return n.match(r)});function fq(t){const n=new URL(t).host.replace("www.","");for(const o of Qd)if(UT(o.hostnames,n)){const r=o.toEmbedUrl(t);if(r)return{definition:o,embedUrl:r,url:t}}}function BT(t){return fq(t)??hq(t)}function Xa(t){try{return BT(t)}catch(n){console.error(n)}}/*!
* MIT License
* Adapted (mostly copied) the work of https://github.com/fregante/text-field-edit
* Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)
*/const wu="  ",wo=class wo{static insertTextFirefox(n,o){n.setRangeText(o,n.selectionStart||0,n.selectionEnd||0,"end"),n.dispatchEvent(new InputEvent("input",{data:o,inputType:"insertText",isComposing:!1}))}static insert(n,o){const r=n.ownerDocument,s=r.activeElement;s!==n&&n.focus(),r.execCommand("insertText",!1,o)||wo.insertTextFirefox(n,o),s===r.body?n.blur():s instanceof HTMLElement&&s!==n&&s.focus()}static set(n,o){n.select(),wo.insert(n,o)}static getSelection(n){const{selectionStart:o,selectionEnd:r}=n;return n.value.slice(o||void 0,r||void 0)}static wrapSelection(n,o,r){const{selectionStart:s,selectionEnd:a}=n,i=wo.getSelection(n);wo.insert(n,o+i+(r??o)),n.selectionStart=(s||0)+o.length,n.selectionEnd=(a||0)+o.length}static replace(n,o,r){let s=0;n.value.replace(o,(...a)=>{const i=s+a[a.length-2],l=a[0].length;n.selectionStart=i,n.selectionEnd=i+l;const c=typeof r=="string"?r:r(...a);return wo.insert(n,c),n.selectionStart=i,s+=c.length-l,c})}static findLineEnd(n,o){const r=n.lastIndexOf(`
`,o-1)+1;return n.charAt(r)!=="	"?o:r+1}static indent(n){var l;const{selectionStart:o,selectionEnd:r,value:s}=n,a=s.slice(o,r),i=(l=/\n/g.exec(a))==null?void 0:l.length;if(i&&i>0){const c=s.lastIndexOf(`
`,o-1)+1,u=n.value.slice(c,r-1),f=u.replace(/^|\n/g,`$&${wu}`),h=f.length-u.length;n.setSelectionRange(c,r-1),wo.insert(n,f),n.setSelectionRange(o+1,r+h)}else wo.insert(n,wu)}static unindent(n){const{selectionStart:o,selectionEnd:r,value:s}=n,a=s.lastIndexOf(`
`,o-1)+1,i=wo.findLineEnd(s,r),l=n.value.slice(a,i),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;n.setSelectionRange(a,i),wo.insert(n,c);const f=/\t| {1,2}/.exec(s.slice(a,o)),h=f?f[0].length:0,d=o-h;n.setSelectionRange(o-h,Math.max(d,r-u))}static indentCE(n){var c;const o=window.getSelection(),r=n.innerText,s=ug(n)??0,a=ug(n)??0,i=r.slice(s,a),l=(c=/\n/g.exec(i))==null?void 0:c.length;if(l&&l>0){const u=r.lastIndexOf(`
`,s-1)+1,f=r.slice(u,a-1),h=f.replace(/^|\n/g,`$&${wu}`).length-f.length;o&&o.setBaseAndExtent(n,s+1,n,a+h)}else{const u=window.getSelection();n.innerText=r.slice(0,s)+wu+r.slice(s),u==null||u.setBaseAndExtent(n,s+1,n,s+2)}}static unindentCE(n){const o=window.getSelection(),r=n.innerText,s=ug(n)??0,a=ug(n)??0,i=r.lastIndexOf(`
`,s-1)+1,l=wo.findLineEnd(r,a),c=r.slice(i,l),u=c.replace(/(^|\n)(\t| {1,2})/g,"$1"),f=c.length-u.length;if(o){o.setBaseAndExtent(n,i,n,l);const h=/\t| {1,2}/.exec(r.slice(i,s)),d=h?h[0].length:0,p=s-d;o.setBaseAndExtent(n,s-d,n,Math.max(p,a-f))}}static normalizeText(n){return n.replace(wo.fixNewLines,`
`)}static normalizeTextForDom(n){return n.replace(wo.fixNewLines,`
`).split(`
`).map(o=>o||" ").join(`
`)}};R(wo,"fixNewLines",/\r?\n|\r/g);let Su=wo;function ug(t){if(typeof window.getSelection>"u")return;const n=window.getSelection();if(!n)return;let o=0;if(n.rangeCount!==0){const r=n.getRangeAt(0),s=r.cloneRange();s.selectNodeContents(t),s.setEnd(r.endContainer,r.endOffset),o=s.toString().length}return o}const mq=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function zT(t){return mq.test(t)}function gq(t){return t.replace(/\t/g,wu)}function yq(t){const n=t.split(`
`);for(;n[0]&&n[0].trim().length===0;)n.shift();let o=1/0;for(const r of n)if(r.trim().length>0){const s=r.length-r.trimStart().length;o=Math.min(o,s)}return n.map(r=>r.slice(o)).join(`
`)}function vq(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function bq(t){return vq(yq(gq(t)))}const Mh=(t,n)=>t.length<=n?t:t.substring(0,n-3)+"...";function xq(t,{maxImageDimension:n,maxAssetSize:o,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:s},{toasts:a,msg:i}){t.registerExternalAssetHandler("file",async({file:l})=>{const c=l.name;let u=l;const f=r.includes(u.type),h=s.includes(u.type);bn(f||h,`File type not allowed: ${u.type}`),bn(u.size<=o,`File size too big: ${(u.size/1024).toFixed()}kb > ${(o/1024).toFixed()}kb`),u.type==="video/quicktime"&&(u=new Blob([u],{type:"video/mp4"}));let d=f?await ia.getImageSize(u):await ia.getVideoSize(u);const p=u.type==="image/gif"?await uq(u):h,y=await WR(await u.arrayBuffer());if(isFinite(n)){const b=lq(d,{w:n,h:n});d!==b&&(u.type==="image/jpeg"||u.type==="image/png")&&(d=b)}(u.type==="image/jpeg"||u.type==="image/png")&&(u=await cq(u,d.w,d.h,{type:u.type,quality:.92}));const g=Ll.createId(y);return Ll.create({id:g,type:f?"image":"video",typeName:"asset",props:{name:c,src:await Gc.blobToDataUrl(u),w:d.w,h:d.h,mimeType:u.type,isAnimated:p}})}),t.registerExternalAssetHandler("url",async({url:l})=>{var u,f,h;let c;try{const d=await(await fetch(l,{method:"GET",mode:"no-cors"})).text(),p=new DOMParser().parseFromString(d,"text/html");c={image:((u=p.head.querySelector('meta[property="og:image"]'))==null?void 0:u.getAttribute("content"))??"",title:((f=p.head.querySelector('meta[property="og:title"]'))==null?void 0:f.getAttribute("content"))??Mh(l,32),description:((h=p.head.querySelector('meta[property="og:description"]'))==null?void 0:h.getAttribute("content"))??""}}catch(d){console.error(d),a.addToast({title:i("assets.url.failed"),severity:"error"}),c={image:"",title:Mh(l,32),description:""}}return{id:Ll.createId(cb(l)),typeName:"asset",type:"bookmark",props:{src:l,description:c.description,image:c.image,title:c.title},meta:{}}}),t.registerExternalContentHandler("svg-text",async({point:l,text:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=new DOMParser().parseFromString(c,"image/svg+xml").querySelector("svg");if(!f)throw new Error("No <svg/> element present");let h=parseFloat(f.getAttribute("width")||"0"),d=parseFloat(f.getAttribute("height")||"0");if(!(h&&d)){document.body.appendChild(f);const y=f.getBoundingClientRect();document.body.removeChild(f),h=y.width,d=y.height}const p=await t.getAssetForExternalContent({type:"file",file:new File([c],"asset.svg",{type:"image/svg+xml"})});if(!p)throw Error("Could not create an asset");GT(t,[p],u)}),t.registerExternalContentHandler("embed",({point:l,url:c,embed:u})=>{const f=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),{width:h,height:d}=u,p=ur(),y={id:p,type:"embed",x:f.x-(h||450)/2,y:f.y-(d||450)/2,props:{w:h,h:d,url:c}};t.createShapes([y]).select(p)}),t.registerExternalContentHandler("files",async({point:l,files:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=new q(u.x,u.y),h=[];await Promise.all(c.map(async(d,p)=>{if(d.size>o)return console.warn(`File size too big: ${(d.size/1024).toFixed()}kb > ${(o/1024).toFixed()}kb`),null;if(!d.type)throw new Error("No mime type");if(!r.concat(s).includes(d.type))return console.warn(`${d.name} not loaded - Extension not allowed.`),null;try{const y=await t.getAssetForExternalContent({type:"file",file:d});if(!y)throw Error("Could not create an asset");h[p]=y}catch(y){return a.addToast({title:i("assets.files.upload-failed"),severity:"error"}),console.error(y),null}})),GT(t,Lt(h),f)}),t.registerExternalContentHandler("text",async({point:l,text:c})=>{const u=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),f=t.getShapeUtil("text").getDefaultProps(),h=bq(c),d=t.getOnlySelectedShape();if(d&&"text"in d.props){t.updateShapes([{id:d.id,type:d.type,props:{text:h}}]);return}let p,y,g,b="middle";const m=h.split(`
`).length>1,v=zT(h);m&&(b=m?v?"end":"start":"middle");const x=t.textMeasure.measureText(h,{...Rn,fontFamily:di[f.font],fontSize:bu[f.size],maxWidth:null}),w=Math.min(m?t.getViewportPageBounds().width*.9:920,Math.max(200,t.getViewportPageBounds().width*.9));if(x.w>w){const S=t.textMeasure.measureText(h,{...Rn,fontFamily:di[f.font],fontSize:bu[f.size],maxWidth:w});p=S.w,y=S.h,g=!1,b=v?"end":"start"}else p=x.w,y=x.h,g=!0;u.y-y/2<t.getViewportPageBounds().minY+40&&(u.y=t.getViewportPageBounds().minY+40+y/2),t.createShapes([{id:ur(),type:"text",x:u.x-p/2,y:u.y-y/2,props:{text:h,align:b,autoSize:g,w:p}}])}),t.registerExternalContentHandler("url",async({point:l,url:c})=>{const u=Xa(c);if(u)return t.putExternalContent({type:"embed",url:u.url,point:l,embed:u.definition});const f=l??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageCenter()),h=Ll.createId(cb(c)),d=wq(t,c,f);let p=t.getAsset(h),y=!1;if(!p){y=!0;try{const g=await t.getAssetForExternalContent({type:"url",url:c});if(!g)throw Error("Could not create an asset");p=g}catch{a.addToast({title:i("assets.url.failed"),severity:"error"});return}}t.batch(()=>{y&&t.createAssets([p]),t.updateShapes([{id:d.id,type:d.type,props:{assetId:p.id}}])})})}async function GT(t,n,o){if(!n.length)return[];const r=q.From(o),s=[];for(const a of n)switch(a.type){case"bookmark":{s.push({id:ur(),type:"bookmark",x:r.x-150,y:r.y-160,opacity:1,props:{assetId:a.id,url:a.props.src}}),r.x+=300;break}case"image":{s.push({id:ur(),type:"image",x:r.x-a.props.w/2,y:r.y-a.props.h/2,opacity:1,props:{assetId:a.id,w:a.props.w,h:a.props.h}}),r.x+=a.props.w;break}case"video":s.push({id:ur(),type:"video",x:r.x-a.props.w/2,y:r.y-a.props.h/2,opacity:1,props:{assetId:a.id,w:a.props.w,h:a.props.h}}),r.x+=a.props.w}return t.batch(()=>{const a=n.filter(i=>!t.getAsset(i.id));a.length&&t.createAssets(a),t.createShapes(s).select(...s.map(i=>i.id)),VT(t,o)}),s.map(a=>a.id)}function VT(t,n){const o=t.getViewportPageBounds();let r=t.getSelectionPageBounds();if(r){const s=r.center.sub(n);t.updateShapes(t.getSelectedShapes().map(a=>{const i=t.getShapeParentTransform(a).decompose().rotation,l=q.Rot(s,-i);return{id:a.id,type:a.type,x:a.x-l.x,y:a.y-l.y}}))}r=t.getSelectionPageBounds(),r&&!o.contains(r)&&t.zoomToSelection()}function wq(t,n,o){const r={id:ur(),type:"bookmark",x:o.x-150,y:o.y-160,opacity:1,props:{assetId:null,url:n}};return t.batch(()=>{t.createShapes([r]).select(r.id),VT(t,o)}),t.getShape(r.id)}let Sq=(hS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")});R(this,"onKeyUp",n=>{var o;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(o=this.editor.root.getCurrent())==null||o.transition("editing_shape",{...n,target:"shape",shape:r}))}})}},R(hS,"id","idle"),hS),jq=(pS=class extends bt{constructor(){super(...arguments);R(this,"shape");R(this,"markId","");R(this,"onEnter",()=>{this.didTimeout=!1;const n=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:o=>!o.isLocked&&this.editor.getShapeUtil(o).canBind(o),margin:0,hitInside:!0,renderingOnly:!0});n?this.editor.setHintingShapes([n.id]):this.createArrowShape(),this.startPreciseTimeout()});R(this,"onExit",()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()});R(this,"onPointerMove",()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find(n=>n.id==="end"),isCreating:!0,onInteractionEnd:"arrow"})}});R(this,"onPointerUp",()=>{this.cancel()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()});R(this,"preciseTimeout",-1);R(this,"didTimeout",!1)}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var u,f;const{originPagePoint:n}=this.editor.inputs,o=ur();this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:"arrow",x:n.x,y:n.y}]);const r=this.editor.getShape(o);if(!r)throw Error("expected shape");const s=this.editor.getShapeHandles(r);if(!s)throw Error("expected handles for arrow");const a=this.editor.getShapeUtil("arrow"),i=this.shape,l=s.find(h=>h.id==="start"),c=(u=a.onHandleDrag)==null?void 0:u.call(a,r,{handle:{...l,x:0,y:0},isPrecise:!0,initial:i});if(c){const h=(f=c.props)==null?void 0:f.start;(h==null?void 0:h.type)==="binding"&&this.editor.setHintingShapes([h.boundShapeId]),this.editor.updateShapes([c],{squashing:!0})}this.shape=this.editor.getShape(o),this.editor.select(o)}updateArrowShapeEndHandle(){var s,a,i;const n=this.shape;if(!n)throw Error("expected shape");const o=this.editor.getShapeHandles(n);if(!o)throw Error("expected handles for arrow");const r={...n,props:{...n.props,end:{...n.props.end,x:0,y:0}}};{const l=this.editor.getShapeUtil("arrow"),c=this.shape,u=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint),f=o.find(d=>d.id==="end"),h=(s=l.onHandleDrag)==null?void 0:s.call(l,r,{handle:{...f,x:u.x,y:u.y},isPrecise:!1,initial:c});if(h){const d=(a=h.props)==null?void 0:a.end;(d==null?void 0:d.type)==="binding"&&this.editor.setHintingShapes([d.boundShapeId]),this.editor.updateShapes([h],{squashing:!0})}}{const l=this.editor.getShapeUtil("arrow"),c=this.shape,u=o.find(h=>h.id==="start"),f=(i=l.onHandleDrag)==null?void 0:i.call(l,r,{handle:{...u,x:0,y:0},isPrecise:this.didTimeout,initial:c});f&&this.editor.updateShapes([f],{squashing:!0})}this.shape=this.editor.getShape(n.id)}startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},R(pS,"id","pointing"),pS);class dg extends bt{constructor(){super(...arguments);R(this,"shapeType","arrow")}}R(dg,"id","arrow"),R(dg,"initial","idle"),R(dg,"children",()=>[Sq,jq]);class Ix extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"initialShape");R(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");R(this,"util",this.editor.getShapeUtil(this.shapeType));R(this,"isPen",!1);R(this,"segmentMode","free");R(this,"didJustShiftClickToExtendPreviousShapeLine",!1);R(this,"pagePointWhereCurrentSegmentChanged",{});R(this,"pagePointWhereNextSegmentChanged",null);R(this,"lastRecordedPoint",{});R(this,"mergeNextPoint",!1);R(this,"currentLineLength",0);R(this,"canDraw",!1);R(this,"markId",null);R(this,"onEnter",o=>{this.markId=null,this.info=o,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});R(this,"onPointerMove",()=>{const{inputs:o}=this.editor;if(this.isPen!==o.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&o.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(o.isPen?q.Dist(o.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=o.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateDrawingShape())});R(this,"onKeyDown",o=>{if(o.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateDrawingShape()});R(this,"onKeyUp",o=>{if(o.key==="Shift")switch(this.editor.snaps.clearIndicators(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateDrawingShape()});R(this,"onExit",()=>{this.editor.snaps.clearIndicators(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(o,r){if(!this.canClose())return!1;const s=kn[r],a=o[0].points[0],i=o[o.length-1],l=i.points[i.points.length-1];return a!==l&&this.currentLineLength>s*4&&q.DistMin(a,l,s*2)}startShape(){const{inputs:{originPagePoint:o,isPen:r}}=this.editor;this.markId="draw start "+Ir(),this.editor.mark(this.markId),this.isPen=r;const s=this.isPen?this.info.point.z*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=o.clone(),this.initialShape){const i=this.editor.getShape(this.initialShape.id);if(i&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const l=Yo(i.props.segments);if(!l)throw Error("Expected a previous segment!");const c=Yo(l.points);if(!c)throw Error("Expected a previous point!");const{x:u,y:f}=this.editor.getPointInShapeSpace(i,o).toFixed(),h=this.isPen?this.info.point.z*1.25:.5,d={type:this.segmentMode,points:[{x:c.x,y:c.y,z:+h.toFixed(2)},{x:u,y:f,z:+h.toFixed(2)}]},p=vt.applyToPoint(this.editor.getShapePageTransform(i.id),c);this.pagePointWhereCurrentSegmentChanged=p,this.pagePointWhereNextSegmentChanged=null;const y=[...i.props.segments,d];this.currentLineLength<kn[i.props.size]*4&&(this.currentLineLength=this.getLineLength(y));const g={id:i.id,type:this.shapeType,props:{segments:y}};this.canClose()&&(g.props.isClosed=this.getIsClosed(y,i.props.size)),this.editor.updateShapes([g]);return}}this.pagePointWhereCurrentSegmentChanged=o.clone();const a=ur();this.editor.createShapes([{id:a,type:this.shapeType,x:o.x,y:o.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+s.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(a)}updateDrawingShape(){const{initialShape:o}=this,{inputs:r}=this.editor;if(!o)return;const{id:s,props:{size:a}}=o,i=this.editor.getShape(s);if(!i)return;const{segments:l}=i.props,{x:c,y:u,z:f}=this.editor.getPointInShapeSpace(i,r.currentPagePoint).toFixed(),h={x:c,y:u,z:this.isPen?+(f*1.25).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:d}=this;if(d===null)throw Error("We should have a point where the segment changed");if(q.Dist2(d,r.currentPagePoint)>sh){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const p=Yo(l);if(!p)throw Error("Expected a previous segment!");const y=Yo(p.points);if(!y)throw Error("Expected a previous last point!");let g;const b=this.editor.getPointInShapeSpace(i,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(p.type==="straight"){this.currentLineLength+=q.Dist(y,b),g={type:"straight",points:[{...y},b]};const v=this.editor.getShapePageTransform(i);this.pagePointWhereCurrentSegmentChanged=vt.applyToPoint(v,y)}else g={type:"straight",points:[b,h]};const m={id:s,type:this.shapeType,props:{segments:[...l,g]}};this.canClose()&&(m.props.isClosed=this.getIsClosed(l,a)),this.editor.updateShapes([m],{squashing:!0})}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:d}=this;if(d===null)throw Error("We should have a point where the segment changed");if(q.Dist2(d,r.currentPagePoint)>sh){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const p=l.slice(),y=p[p.length-1],g=Yo(y.points);if(!g)throw Error("No previous point!");const b={type:"free",points:[...q.PointsBetween(g,h,6).map(x=>x.toFixed().toJson())]},m=[...p,b];this.currentLineLength<kn[i.props.size]*4&&(this.currentLineLength=this.getLineLength(m));const v={id:s,type:this.shapeType,props:{segments:m}};this.canClose()&&(v.props.isClosed=this.getIsClosed(m,a)),this.editor.updateShapes([v],{squashing:!0})}break}case"straight":{const d=l.slice(),p=d[d.length-1],{pagePointWhereCurrentSegmentChanged:y}=this,{ctrlKey:g,currentPagePoint:b}=this.editor.inputs;if(!y)throw Error("We should have a point where the segment changed");let m,v=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(v=!g,this.didJustShiftClickToExtendPreviousShapeLine=!1):v=!g;let x=this.editor.getPointInShapeSpace(i,b).toFixed().toJson(),w=!1,S;if((this.editor.user.getIsSnapMode()?!g:g)&&d.length>2){let _,C=8/this.editor.getZoomLevel();for(let P=0,A=l.length-2;P<A;P++){const I=l[P];if(!I)break;if(I.type==="free")continue;const N=I.points[0],O=Yo(I.points);if(!(N&&O))continue;const F=q.NearestPointOnLineSegment(N,O,x);if(q.DistMin(F,x,C)){_=F.toFixed().toJson(),C=q.Dist(F,x),S=I;break}}_&&(w=!0,x=_)}if(w&&S){const _=this.editor.getShapePageTransform(i),C=S.points[0],P=Yo(S.points);if(!P)throw Error("Expected a last point!");const A=vt.applyToPoint(_,C),I=vt.applyToPoint(_,P),N=vt.applyToPoint(_,x);this.editor.snaps.setIndicators([{id:Ir(),type:"points",points:[A,N,I]}])}else{if(this.editor.snaps.clearIndicators(),v){const _=q.Angle(y,b),C=um(_,24)-_;m=q.RotWith(b,y,C)}else m=b;x=this.editor.getPointInShapeSpace(i,m).toFixed().toJson()}this.currentLineLength+=q.Dist(p.points[0],x),d[d.length-1]={...p,type:"straight",points:[p.points[0],x]};const k={id:s,type:this.shapeType,props:{segments:d}};this.canClose()&&(k.props.isClosed=this.getIsClosed(l,a)),this.editor.updateShapes([k],{squashing:!0});break}case"free":{const d=l.slice(),p=d[d.length-1],y=[...p.points];if(y.length&&this.mergeNextPoint){const{z:b}=y[y.length-1];y[y.length-1]={x:h.x,y:h.y,z:b?Math.max(b,h.z):h.z}}else this.currentLineLength+=q.Dist(y[y.length-1],h),y.push(h);d[d.length-1]={...p,points:y},this.currentLineLength<kn[i.props.size]*4&&(this.currentLineLength=this.getLineLength(d));const g={id:s,type:this.shapeType,props:{segments:d}};if(this.canClose()&&(g.props.isClosed=this.getIsClosed(d,a)),this.editor.updateShapes([g],{squashing:!0}),y.length>500){this.editor.updateShapes([{id:s,type:this.shapeType,props:{isComplete:!0}}]);const b=ur();this.editor.createShapes([{id:b,type:this.shapeType,x:dm(r.currentPagePoint.x),y:dm(r.currentPagePoint.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(f*1.25).toFixed():.5}]}]}}]),this.initialShape=wr(this.editor.getShape(b)),this.mergeNextPoint=!1,this.lastRecordedPoint=r.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(o){let r=0;for(const s of o)for(let a=0;a<s.points.length-1;a++){const i=s.points[a],l=s.points[a+1];r+=q.Dist2(l,i)}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:o}=this;o&&(this.editor.updateShapes([{id:o.id,type:o.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}R(Ix,"id","drawing");let HT=(fS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(fS,"id","idle"),fS);class hg extends bt{constructor(){super(...arguments);R(this,"shapeType","draw");R(this,"onExit",()=>{const o=this.children.drawing;o.initialShape=void 0})}}R(hg,"id","draw"),R(hg,"initial","idle"),R(hg,"children",()=>[HT,Ix]);class Ax extends Bm{constructor(){super(...arguments);R(this,"shapeType","frame");R(this,"onCreate",o=>{if(!o)return;const r=this.editor.getShapePageBounds(o),s=[],a=this.editor.getShapeAncestors(o).map(i=>i.id);this.editor.getSortedChildIdsForParent(o.parentId).map(i=>{const l=this.editor.getShape(i);if(!l||l.id===o.id||l.isLocked)return;const c=this.editor.getShapePageBounds(l);c&&r.contains(c)&&_q(l,a,o)&&s.push(l.id)}),this.editor.reparentShapes(s,o.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")})}}R(Ax,"id","frame"),R(Ax,"initial","idle");function _q(t,n,o){return n.includes(t.id)?!1:t.parentId===o.parentId}let kq=(mS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onKeyUp",n=>{var o;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(o=this.editor.root.getCurrent())==null||o.transition("editing_shape",{...n,target:"shape",shape:r}))}});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(mS,"id","idle"),mS),Eq=(gS=class extends bt{constructor(){super(...arguments);R(this,"markId","");R(this,"onPointerUp",()=>{this.complete()});R(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:o}=this.editor.inputs,r=ur();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"geo",x:o.x,y:o.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(oi)}}]).select(r).setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs,o=ur();this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:"geo",x:n.x,y:n.y,props:{geo:this.editor.getStyleForNextShape(oi),w:1,h:1}}]);const r=this.editor.getShape(o);if(!r)return;const s=r.props.geo==="star"?new mt(0,0,200,190):r.props.geo==="cloud"?new mt(0,0,300,180):new mt(0,0,200,200),a=s.center,i=this.editor.getShapeParentTransform(r);i&&a.rot(-i.rotation()),this.editor.select(o),this.editor.updateShapes([{id:r.id,type:"geo",x:r.x-a.x,y:r.y-a.y,props:{geo:this.editor.getStyleForNextShape(oi),w:s.width,h:s.height}}]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},R(gS,"id","pointing"),gS);class pg extends bt{constructor(){super(...arguments);R(this,"shapeType","geo")}}R(pg,"id","geo"),R(pg,"initial","idle"),R(pg,"children",()=>[kq,Eq]);class fg extends bt{constructor(){super(...arguments);R(this,"shapeType","highlight");R(this,"onExit",()=>{const o=this.children.drawing;o.initialShape=void 0})}}R(fg,"id","highlight"),R(fg,"initial","idle"),R(fg,"children",()=>[HT,Ix]);let Cq=(yS=class extends bt{constructor(){super(...arguments);R(this,"shapeId","");R(this,"onEnter",n=>{this.shapeId=n.shapeId,this.editor.setCursor({type:"cross",rotation:0})});R(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(yS,"id","idle"),yS);const WT=2;let Pq=(vS=class extends bt{constructor(){super(...arguments);R(this,"shape",{});R(this,"markId");R(this,"onEnter",n=>{const{inputs:o}=this.editor,{currentPagePoint:r}=o;this.markId=void 0;const s=n.shapeId&&this.editor.getShape(n.shapeId);if(s&&o.shiftKey){this.markId=`creating:${s.id}`,this.editor.mark(this.markId),this.shape=s;const a=this.editor.getShapeHandles(this.shape);if(!a)return;const i=a.filter(d=>d.type==="vertex").sort($n),l=i[i.length-1],c=i[i.length-2],u=vt.applyToPoint(this.editor.getShapeParentTransform(this.shape),new q(this.shape.x,this.shape.y)),f=q.Sub(r,u).addXY(.1,.1),h=wr(this.shape.props.points);if(q.DistMin(l,c,WT)||q.DistMin(f,l,WT))h[l.id]={id:l.id,index:l.index,x:f.x,y:f.y};else{const d=Di(l.index);h[d]={id:d,index:d,x:f.x,y:f.y}}this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{points:h}}])}else{const a=ur();this.markId=`creating:${a}`,this.editor.mark(this.markId),this.editor.createShapes([{id:a,type:"line",x:r.x,y:r.y}]),this.editor.select(a),this.shape=this.editor.getShape(a)}});R(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const n=this.editor.getShapeHandles(this.shape);if(!n)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const o=Yo(n);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...o,x:o.x-.1,y:o.y-.1},onInteractionEnd:"line"})}});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}},R(vS,"id","pointing"),vS);class mg extends bt{constructor(){super(...arguments);R(this,"shapeType","line")}}R(mg,"id","line"),R(mg,"initial","idle"),R(mg,"children",()=>[Cq,Pq]);let Mq=(bS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(bS,"id","idle"),bS);function Sr(t,n){var s;const o=new Set;for(const a of n){const i=t.getShape(a);if(!i)continue;t.getShapeUtil(i).onDragShapesOut&&o.add(i);const l=t.getShape(i.parentId);l&&t.getShapeUtil(l).onDragShapesOut&&o.add(l)}const r=new Map;for(const a of o){const i=$T(t,a);i.length&&r.set(a,i)}for(const[a,i]of r){const l=t.getShapeUtil(a),c=Lt(i.map(u=>t.getShape(u)));(s=l.onDragShapesOut)==null||s.call(l,a,c)}}function $T(t,n){const o=t.getSortedChildIdsForParent(n.id);if(o.length===0)return[];const r=t.getShapePageBounds(n);if(!r)return[];let s,a,i;const l=[];for(const c of o){const u=t.getShapePageBounds(c);if(!u)continue;if(!r.includes(u)){l.push(c);continue}s??(s=t.getShapeGeometry(n)),a??(a=t.getShapePageTransform(n)),i??(i=a.applyToPoints(s.vertices));const f=t.getShapePageTransform(c).clone().invert().applyToPoints(i),{vertices:h,isClosed:d}=t.getShapeGeometry(c);if(!h.some(p=>es(p,f))){if(d){if(eP(f,h))continue}else if(BU(f,h))continue;l.push(c)}}return l}function gg(t,n,o=!1){t.select(n),t.setEditingShape(n),t.setCurrentTool("select.editing_shape",{target:"shape",shape:n}),o&&t.emit("select-all-text",{shapeId:n.id}),qT(t)}const Tq=16;function qT(t){const n=t.getSelectionPageBounds(),o=t.getViewportPageBounds();if(n&&!o.contains(n)){const r=n.clone().expandBy(Tq/t.getZoomLevel()).expand(o),s=o.clone().translate({x:(r.center.x-o.center.x)*2,y:(r.center.y-o.center.y)*2});t.zoomToBounds(s,{duration:si,inset:0})}}const Yl=20,Iq=0,er=200,Ox={x:er/2,y:er/2},YT=10,Aq={a1:new q(er*.5,er*-.5-Yl),a2:new q(er*1.5+Yl,er*.5),a3:new q(er*.5,er*1.5+Yl),a4:new q(er*-.5-Yl,er*.5)};function KT(t,n,o,r){return Object.fromEntries(Object.entries(Aq).map(([s,a],i)=>{const l=a.clone();return i===0&&r?l.y-=r:i===2&&o&&(l.y+=o),[s,l.rot(n).add(t)]}))}function XT(t,n,o){const r=new Set(t.getSelectedShapeIds()),s=(er+Yl+o)**2,a=new Map,i=[];for(const u of t.getCurrentPageShapes()){if(!t.isShapeOfType(u,"note")||r.has(u.id))continue;const f=t.getShapePageTransform(u.id);n===f.rotation()&&(a.set(u,t.getShapePageBounds(u).center),i.push(...Object.values(KT(f.point(),n,u.props.growY,o))))}const l=i.length;let c;for(const[u,f]of a)for(let h=0;h<l;h++)c=i[h],c&&(q.Dist2(f,c)>s||t.isPointInShape(u,c)&&(i[h]=void 0));return Lt(i)}function QT(t,n,o,r,s=!1){let a;const i=t.getCurrentPageShapesSorted(),l=er+Yl**2;for(let c=i.length-1;c>=0;c--){const u=i[c];if(u.type==="note"&&u.id!==n.id){const f=t.getShapePageBounds(u);if(f&&q.Dist2(f.center,o)<l&&t.isPointInShape(u,o)){a=u;break}}}if(t.complete(),!a||s){t.mark("creating note shape");const c=ur();t.createShape({id:c,type:"note",x:o.x,y:o.y,rotation:r,opacity:n.opacity,props:{...n.props,text:"",growY:0,fontSizeAdjustment:0,url:""}});const u=t.getShape(c),f=t.getPointInParentSpace(u,q.Sub(o,q.Rot(Ox,r)));t.updateShape({id:c,type:"note",x:f.x,y:f.y}),a=t.getShape(c)}return qT(t),a}let Oq=(xS=class extends bt{constructor(){super(...arguments);R(this,"dragged",!1);R(this,"info",{});R(this,"wasFocusedOnEnter",!1);R(this,"markId","");R(this,"shape",{});R(this,"onEnter",()=>{const{editor:n}=this;if(this.wasFocusedOnEnter=!n.getIsMenuOpen(),this.wasFocusedOnEnter){const o=ur();this.markId=`creating:${o}`,n.mark(this.markId);const r=this.editor.inputs.originPagePoint.clone(),s=ZT(this.editor,r);s&&r.sub(s),this.shape=JT(this.editor,o,r)}});R(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(!this.wasFocusedOnEnter){const o=ur(),r=this.editor.inputs.originPagePoint.clone(),s=ZT(this.editor,r);s&&r.sub(s),this.shape=JT(this.editor,o,r)}this.editor.setCurrentTool("select.translating",{...n,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}})}});R(this,"onPointerUp",()=>{this.complete()});R(this,"onInterrupt",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()})}complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}},R(xS,"id","pointing"),xS);function ZT(t,n){let o=YT/t.getZoomLevel(),r;for(const s of XT(t,0,0)){const a=q.Sub(n,s),i=a.len();i<o&&(o=i,r=a)}return r}function JT(t,n,o){t.createShape({id:n,type:"note",x:o.x,y:o.y}).select(n);const r=t.getShape(n),s=t.getShapeGeometry(r).bounds;return t.updateShapes([{id:n,type:"note",x:r.x-s.width/2,y:r.y-s.height/2}]),t.getShape(n)}class yg extends bt{constructor(){super(...arguments);R(this,"shapeType","note")}}R(yg,"id","note"),R(yg,"initial","idle"),R(yg,"children",()=>[Mq,Oq]);function Lq(t){const n=t.getShapeAtPoint(t.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:Gi/t.getZoomLevel(),renderingOnly:!0});if(!n)return t.setHoveredShape(null);let o;const r=t.getOutermostSelectableShape(n);return r===n||r.id===t.getFocusedGroupId()||t.getSelectedShapeIds().includes(r.id)?o=n:o=r,t.setHoveredShape(o.id)}const ju=HR(Lq,32);let Rq=(wS=class extends bt{constructor(){super(...arguments);R(this,"onPointerMove",n=>{switch(n.target){case"shape":case"canvas":ju(this.editor)}});R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});R(this,"onKeyDown",n=>{var o;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(o=this.editor.root.getCurrent())==null||o.transition("editing_shape",{...n,target:"shape",shape:r}))}});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(wS,"id","idle"),wS),Dq=(SS=class extends bt{constructor(){super(...arguments);R(this,"shape");R(this,"markId","");R(this,"onExit",()=>{this.editor.setHintingShapes([])});R(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:o}}=this.editor,r=ur();if(this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShapes([{id:r,type:"text",x:o.x,y:o.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(r),this.shape=this.editor.getShape(r),!this.shape)return;const{shape:s}=this;this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"text",onCreate:()=>{this.editor.setEditingShape(s.id),this.editor.setCurrentTool("select.editing_shape")}})}});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.cancel()});R(this,"onCancel",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}complete(){var s;this.editor.mark("creating text shape");const n=ur(),{x:o,y:r}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:n,type:"text",x:o,y:r,props:{text:"",autoSize:!0}}]).select(n),this.editor.setEditingShape(n),this.editor.setCurrentTool("select"),(s=this.editor.root.getCurrent())==null||s.transition("editing_shape")}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}},R(SS,"id","pointing"),SS);class vg extends bt{constructor(){super(...arguments);R(this,"shapeType","text")}}R(vg,"id","text"),R(vg,"initial","idle"),R(vg,"children",()=>[Rq,Dq]);const Fq=[vg,hg,pg,yg,mg,Ax,dg,fg];function tn(){return Bi({isDarkMode:yh()})}const pn=Bt.memo(function({theme:t,d:n,color:o,fill:r}){switch(r){case"none":return null;case"solid":return E.jsx("path",{fill:t[o].semi,d:n});case"semi":return E.jsx("path",{fill:t.solid,d:n});case"pattern":return E.jsx(Nq,{theme:t,color:o,fill:r,d:n})}}),Nq=function({d:t,color:n,theme:o}){const r=Be(),s=aP(),a=We("zoomLevel",()=>r.getZoomLevel(),[r]),i=Math.ceil(a),l=r.getZoomLevel()<=.18;return E.jsxs(E.Fragment,{children:[E.jsx("path",{fill:o[n].pattern,d:t}),E.jsx("path",{fill:s?`url(#${Jc[`1_${o.id}`]})`:l?o[n].semi:`url(#${Jc[`${i}_${o.id}`]})`,d:t})]})};function Uq(t){return t.replace(/\s/g,"\xA0")}function Lx(t,n,o){const{padding:r=0}=o;if(n.length===0)return null;const s=mt.From(n[0].box);for(const{box:u}of n)s.union(u);const a=r+(o.offsetX??0),i=(o.offsetY??0)+o.fontSize/2+(o.verticalTextAlign==="start"?r:o.verticalTextAlign==="end"?o.height-r-s.height:(Math.ceil(o.height)-s.height)/2);let l=null;const c=[];for(const{text:u,box:f}of n)l!==null&&f.y>l&&c.push(E.jsx("tspan",{alignmentBaseline:"mathematical",x:a,y:f.y+i,children:`
`},c.length)),c.push(E.jsx("tspan",{alignmentBaseline:"mathematical",x:f.x+a,y:f.y+i,children:Uq(u)},c.length)),l=f.y;return E.jsx("text",{fontSize:o.fontSize,fontFamily:o.fontFamily,fontStyle:o.fontFamily,fontWeight:o.fontWeight,dominantBaseline:"mathematical",alignmentBaseline:"mathematical",stroke:o.stroke,strokeWidth:o.strokeWidth,fill:o.fill,children:c})}function Bq(t,n,o,r){if((t==="start-legacy"||t==="end-legacy")&&o.length!==0){const s=mt.From(o[0].box);for(const{box:a}of o)s.union(a);if(t==="start-legacy")return(r-2*n-s.width)/2;if(t==="end-legacy")return-(r-2*n-s.width)/2}}function zq(t){return t==="start-legacy"||t==="middle-legacy"||t==="end-legacy"}function bg({fontSize:t,font:n,align:o,verticalAlign:r,text:s,labelColor:a,bounds:i,padding:l=16,stroke:c=!0}){const u=Be(),f=tn(),h={fontSize:t,fontFamily:oE[n],textAlign:o,verticalTextAlign:r,width:Math.ceil(i.width),height:Math.ceil(i.height),padding:l,lineHeight:Rn.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0,offsetY:0,fill:a,stroke:void 0,strokeWidth:void 0},d=u.textMeasure.measureTextSpans(s,h),p=Bq(o,l,d,i.width);p&&(h.offsetX=p),h.offsetX+=i.x,h.offsetY+=i.y;const y=Lx(u,d,h);let g=null;return c&&(h.fill=f.background,h.stroke=f.background,h.strokeWidth=2,g=Lx(u,d,h)),E.jsxs(E.Fragment,{children:[g,y]})}function _u(t){return{key:`${ri.id}:${t}`,getElement:async()=>{const n=Gq(t);if(!n)return null;const o=n.$$_url,r=n.$$_fontface;if(!o||!r)return null;const s=await(await fetch(o)).blob(),a=await Gc.blobToDataUrl(s),i=r.replace(o,a);return E.jsx("style",{children:i})}}}function Gq(t){const n=oE[t];for(const o of document.fonts)if(n.includes(o.family))return o;return null}function Rx(t){return{key:`${ri.id}:${t}`,getElement:async()=>t!=="pattern"?null:E.jsx(Vq,{})}}function Vq(){const t=tn(),n=8/12;return E.jsxs(E.Fragment,{children:[E.jsxs("mask",{id:"hash_pattern_mask",children:[E.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:"white"}),E.jsxs("g",{strokeLinecap:"round",stroke:"black",children:[E.jsx("line",{x1:n*1,y1:n*3,x2:n*3,y2:n*1}),E.jsx("line",{x1:n*5,y1:n*7,x2:n*7,y2:n*5}),E.jsx("line",{x1:n*9,y1:n*11,x2:n*11,y2:n*9})]})]}),E.jsx("pattern",{id:Jc[`1_${t.id}`],width:"8",height:"8",patternUnits:"userSpaceOnUse",children:E.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:t.solid,mask:"url(#hash_pattern_mask)"})})]})}function Dx(){return{key:`${ri.id}:pattern`,component:$q}}const Th=8,eI=(t,n,o)=>new Promise((r,s)=>{const a=Th*n*t,i=document.createElement("canvas");i.width=a,i.height=a;const l=i.getContext("2d");if(!l)return;l.fillStyle=o?"#212529":"#f8f9fa",l.fillRect(0,0,a,a),l.globalCompositeOperation="destination-out",l.lineCap="round",l.lineWidth=1.25*n*t;const c=8/12,u=f=>f*n*t;l.beginPath(),l.moveTo(u(c*1),u(c*3)),l.lineTo(u(c*3),u(c*1)),l.moveTo(u(c*5),u(c*7)),l.lineTo(u(c*7),u(c*5)),l.moveTo(u(c*9),u(c*11)),l.lineTo(u(c*11),u(c*9)),l.stroke(),i.toBlob(f=>{!f||jn.throwToBlob.get()?s():r(f)})}),tI=(t,n)=>{const o=document.createElement("canvas");o.width=t[0],o.height=t[1];const r=o.getContext("2d");return r?(n(r),o.toDataURL()):""},Hq=()=>{const t=[];for(let n=1;n<=Math.ceil(Va);n++){const o=tI([1,1],s=>{s.fillStyle=Zf.lightMode.black.semi,s.fillRect(0,0,1,1)}),r=tI([1,1],s=>{s.fillStyle=Zf.darkMode.black.semi,s.fillRect(0,0,1,1)});t.push({zoom:n,url:o,darkMode:!1}),t.push({zoom:n,url:r,darkMode:!0})}return t};function Wq(){const t=Be().getInstanceState().devicePixelRatio,[n,o]=z.useState(!1),r=z.useMemo(()=>Hq(),[]),[s,a]=z.useState(r);return z.useEffect(()=>{const i=[];for(let c=1;c<=Math.ceil(Va);c++)i.push(eI(t,c,!1).then(u=>({zoom:c,url:URL.createObjectURL(u),darkMode:!1}))),i.push(eI(t,c,!0).then(u=>({zoom:c,url:URL.createObjectURL(u),darkMode:!0})));let l=!1;return Promise.all(i).then(c=>{l||(a(c),o(!0))}),()=>{l=!0,o(!1)}},[t]),{defs:E.jsx(E.Fragment,{children:s.map(i=>{const l=i.zoom+(i.darkMode?"_dark":"_light");return E.jsx("pattern",{id:Jc[l],width:Th,height:Th,patternUnits:"userSpaceOnUse",children:E.jsx("image",{href:i.url,width:Th,height:Th})},l)})}),isReady:n}}function $q(){const t=Be(),n=z.useRef(null),{defs:o,isReady:r}=Wq();return z.useEffect(()=>{if(r&&t.environment.isSafari){const s=rI(n.current);s&&requestAnimationFrame(()=>{s.style.display="none",requestAnimationFrame(()=>{s.style.display=""})})}},[t,r]),E.jsx("g",{ref:n,"data-testid":r?"ready-pattern-fill-defs":void 0,children:o})}function rI(t){return t.classList.contains("tl-html-layer")?t:t.parentElement?rI(t.parentElement):null}function Qi(t,n,o={}){const{closed:r=!1,snap:s=1,start:a="outset",end:i="outset",lengthRatio:l=2,style:c="dashed"}=o;let u=0,f=0,h=1,d=0,p=0;switch(c){case"dashed":{h=1,u=Math.min(n*l,t/4);break}case"dotted":{h=100,u=n/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(a==="outset"?(t+=u/2,p+=u/2):a==="skip"&&(t-=u,p-=u),i==="outset"?t+=u/2:i==="skip"&&(t-=u)),f=Math.floor(t/u/(2*h)),f-=f%s,f<3&&c==="dashed"?t/n<5?(u=t,f=1,d=0):(u=t*.333,d=t*.333):(f=Math.max(f,3),u=t/f/(2*h),r?(p=u/2,d=(t-f*u)/f):d=(t-f*u)/Math.max(1,f-1)),{strokeDasharray:[u,d].join(" "),strokeDashoffset:p.toString()}}const nI=new WeakMap;function Fx(t,n){const o=nI.get(n);if(o)return o;const r=t.getArrowInfo(n);let s=0,a=0;const i=r.isStraight?new hh({start:q.From(r.start.point),end:q.From(r.end.point)}):new DP({center:q.Cast(r.handleArc.center),radius:r.handleArc.radius,start:q.Cast(r.start.point),end:q.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});if(n.props.text.trim()){const c=i.bounds,{w:u,h:f}=t.textMeasure.measureText(n.props.text,{...Rn,fontFamily:di[n.props.font],fontSize:ql[n.props.size],maxWidth:null});if(s=u,a=f,c.width>c.height){s=Math.max(Math.min(u,64),Math.min(c.width-64,u));const{w:h,h:d}=t.textMeasure.measureText(n.props.text,{...Rn,fontFamily:di[n.props.font],fontSize:ql[n.props.size],maxWidth:s});s=h,a=d}if(s>16*ql[n.props.size]){s=16*ql[n.props.size];const{w:h,h:d}=t.textMeasure.measureText(n.props.text,{...Rn,fontFamily:di[n.props.font],fontSize:ql[n.props.size],maxWidth:s});s=h,a=d}}const l=new q(s,a).addScalar(H$*2);return nI.set(n,l),l}function oI(t,n){const o=kn[n.props.size];return V$+(o-kn.s)*2+(o===kn.xl?20:0)}function qq(t,n,o){const r=Fx(t,n),s=oI(t,n),a=q.Nudge(o.start.point,o.end.point,s),i=q.Nudge(o.end.point,o.start.point,s),l=r1(a,i,mt.FromCenter(o.middle,r).corners);if(!l||l.length!==2)return{start:.5,end:.5};let[c,u]=l;q.Dist2(c,a)>q.Dist2(u,a)&&([u,c]=l);const f=a.add(q.Sub(o.middle,c)),h=i.add(q.Sub(o.middle,u)),d=q.Dist(o.start.point,f)/o.length,p=q.Dist(o.start.point,h)/o.length;return{start:d,end:p}}function Yq(t,n,o){const r=Fx(t,n),s=oI(t,n),a=Math.sign(n.props.bend),i=s/o.handleArc.radius*a,l=q.Angle(o.bodyArc.center,o.start.point)-i,c=q.Angle(o.bodyArc.center,o.end.point)+i,u=Dl(o.bodyArc.center,o.bodyArc.radius,l),f=Dl(o.bodyArc.center,o.bodyArc.radius,c),h=[],d=sI(o.bodyArc.center,o.bodyArc.radius,l,c,a,mt.FromCenter(u,r).corners);h.push(new hn({points:mt.FromCenter(u,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));const p=sI(o.bodyArc.center,o.bodyArc.radius,l,c,a,mt.FromCenter(f,r).corners);h.push(new hn({points:mt.FromCenter(f,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));for(const _ of[...d??[],...p??[],u,f])h.push(new x1({x:_.x-3,y:_.y-3,radius:3,isFilled:!1,debugColor:"magenta",ignore:!0}));const y=(d&&iI(o.start.point,d))??o.middle,g=(p&&iI(o.end.point,p))??o.middle,b=q.Angle(o.bodyArc.center,o.start.point),m=q.Angle(o.bodyArc.center,o.end.point),v=q.Angle(o.bodyArc.center,y),x=q.Angle(o.bodyArc.center,g);if(Ga(b,v,a)>Ga(b,x,a))return{start:.5,end:.5,dbg:h};const w=Ga(b,m,a),S=Ga(b,v,a)/w,k=Ga(b,x,a)/w;return{start:S,end:k,dbg:h}}function xg(t,n){let o;const r=[],s=t.getArrowInfo(n),a=n.props.start.type==="binding",i=n.props.end.type==="binding",l=s.start.arrowhead!=="none",c=s.end.arrowhead!=="none";if(s.isStraight){const f=qq(t,n,s);let h=Ba(n.props.labelPosition,l||a?f.start:0,c||i?f.end:1);h=h>=.48&&h<=.52?.5:h,o=q.Lrp(s.start.point,s.end.point,h)}else{const f=Yq(t,n,s);f.dbg&&r.push(...f.dbg);let h=Ba(n.props.labelPosition,l||a?f.start:0,c||i?f.end:1);h=h>=.48&&h<=.52?.5:h;const d=Kq(q.Angle(s.bodyArc.center,s.start.point),q.Angle(s.bodyArc.center,s.end.point),Math.sign(n.props.bend),h);o=Dl(s.bodyArc.center,s.bodyArc.radius,d)}const u=Fx(t,n);return{box:mt.FromCenter(o,u),debugGeom:r}}function sI(t,n,o,r,s,a){const i=n1(t,n,a),l=Ga(o,r,s);return i==null?void 0:i.filter(c=>{const u=Ga(o,q.Angle(t,c),s);return u>=0&&u<=l})}function iI(t,n){let o=null,r=-1/0;for(const s of n){const a=q.Dist2(t,s);a>r&&(o=s,r=a)}return o}function Kq(t,n,o,r){const s=Ga(t,n,o);return t+s*r*o*-1}function Xq(t,n,o){const r=n==="end"?t.end.point:t.start.point,s=n==="end"?t.start.point:t.end.point,a=t.isStraight?q.Dist(s,r):Math.abs(t.bodyArc.length),i=Math.max(Math.min(a/5,o*3),o);let l;if(t.isStraight)l=q.Nudge(r,s,i);else{const c=NU(r,i,t.handleArc.center,t.handleArc.radius);l=n==="end"?t.handleArc.sweepFlag?c[0]:c[1]:t.handleArc.sweepFlag?c[1]:c[0]}return q.IsNaN(l)&&(l=t.start.point),{point:r,int:l}}function Qq({point:t,int:n}){const o=q.RotWith(n,t,Yt/6),r=q.RotWith(n,t,-Yt/6);return`M ${o.x} ${o.y} L ${t.x} ${t.y} L ${r.x} ${r.y}`}function Zq({point:t,int:n}){const o=q.RotWith(n,t,Yt/6),r=q.RotWith(n,t,-Yt/6);return`M ${o.x} ${o.y} L ${t.x} ${t.y} L ${r.x} ${r.y} Z`}function Jq({point:t,int:n}){const o=q.Sub(n,t).div(2),r=q.Add(t,q.Rot(o,hr)),s=q.Sub(t,q.Rot(o,hr));return`M ${r.x} ${r.y} L ${n.x} ${n.y} L ${s.x} ${s.y} Z`}function eY({point:t,int:n}){const o=q.Lrp(t,n,.45),r=q.Dist(o,t);return`M ${o.x-r},${o.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function tY({point:t,int:n}){const o=q.Lrp(t,n,.75),r=q.RotWith(o,t,Yt/4),s=q.RotWith(o,t,-Yt/4),a=q.Lrp(r,s,.5);return a.add(q.Sub(a,t)),`M ${a.x} ${a.y} L ${r.x} ${r.y} ${t.x} ${t.y} L ${s.x} ${s.y} Z`}function rY({int:t,point:n}){const o=q.Lrp(n,t,.85),r=q.Sub(o,n).div(2),s=q.Add(n,q.Rot(r,hr)),a=q.Sub(n,q.Rot(r,hr)),i=q.Add(o,q.Rot(r,hr)),l=q.Sub(o,q.Rot(r,hr));return`M ${s.x} ${s.y} L ${i.x} ${i.y} L ${l.x} ${l.y} L ${a.x} ${a.y} Z`}function nY({int:t,point:n}){const o=q.Sub(t,n).div(2),r=q.Add(n,q.Rot(o,hr)),s=q.Sub(n,q.Rot(o,hr));return`M ${r.x} ${r.y} L ${s.x} ${s.y}`}function wg(t,n,o){const r=n==="end"?t.end.arrowhead:t.start.arrowhead;if(r==="none")return;const s=Xq(t,n,o);if(s){switch(r){case"bar":return nY(s);case"square":return rY(s);case"diamond":return tY(s);case"dot":return eY(s);case"inverted":return Jq(s);case"arrow":return Qq(s);case"triangle":return Zq(s)}return""}}function oY(t){const{start:n,end:o,handleArc:{radius:r,largeArcFlag:s,sweepFlag:a}}=t;return`M${n.handle.x},${n.handle.y} A${r} ${r} 0 ${s} ${a} ${o.handle.x},${o.handle.y}`}function aI(t){const{start:n,end:o,bodyArc:{radius:r,largeArcFlag:s,sweepFlag:a}}=t;return`M${n.point.x},${n.point.y} A${r} ${r} 0 ${s} ${a} ${o.point.x},${o.point.y}`}function lI(t,n){return`M${t.x},${t.y}L${n.x},${n.y}`}function sY(t){return lI(t.start.handle,t.end.handle)}function cI(t){return lI(t.start.point,t.end.point)}const iY=z.forwardRef(function({isEditing:t,text:n,handleFocus:o,handleChange:r,handleKeyDown:s,handleBlur:a,handleInputPointerDown:i,handleDoubleClick:l},c){return E.jsx("textarea",{ref:c,className:"tl-text tl-text-input",name:"text",tabIndex:-1,readOnly:!t,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:n,onFocus:o,onChange:r,onKeyDown:s,onBlur:a,onTouchEnd:On,onContextMenu:t?On:void 0,onPointerDown:i,onDoubleClick:l,onDragStart:Xt})});function aY(t,n,o){const r=Be(),s=z.useRef(null),a=z.useRef(),i=We("isEditing",()=>r.getEditingShapeId()===t,[r]),l=We("isEditingAnything",()=>!!r.getEditingShapeId(),[r]);z.useEffect(()=>{function d({shapeId:p}){requestAnimationFrame(()=>{if(p===t){const y=s.current;y&&(document.activeElement!==y&&y.focus(),y.select())}})}return r.on("select-all-text",d),()=>{r.off("select-all-text",d)}},[r,t]),z.useEffect(()=>{if(!i)return;const d=s.current;if(!d)return;document.activeElement!==d?(d.focus(),r.getInstanceState().isCoarsePointer&&d.select()):r.environment.isSafari&&(d.blur(),d.focus());function p(){var g,b;const y=(g=window.getSelection)==null?void 0:g.call(window);if(y&&y.type!=="None"){const m=[];for(let v=0;v<y.rangeCount;v++)m.push((b=y.getRangeAt)==null?void 0:b.call(y,v));a.current=m}}return document.addEventListener("selectionchange",p),()=>{document.removeEventListener("selectionchange",p)}},[r,i]);const c=z.useCallback(()=>{const d=a.current;requestAnimationFrame(()=>{var g;const p=s.current,y=r.getEditingShapeId();if(y){if(p&&y===t&&(p.focus(),d&&d.length)){const b=window.getSelection();b&&d.forEach(m=>b.addRange(m))}}else(g=window.getSelection())==null||g.removeAllRanges()})},[r,t]),u=z.useCallback(d=>{if(r.getEditingShapeId()===t)switch(d.key){case"Enter":{(d.ctrlKey||d.metaKey)&&r.complete();break}}},[r,t]),f=z.useCallback(d=>{if(r.getEditingShapeId()!==t)return;let p=Su.normalizeText(d.currentTarget.value);const y=p.replace(/\t/g,wu);if(y!==p){const g=d.currentTarget.selectionStart;d.currentTarget.value=y,d.currentTarget.selectionStart=g+(y.length-p.length),d.currentTarget.selectionEnd=g+(y.length-p.length),p=y}r.updateShape({id:t,type:n,props:{text:p}})},[r,t,n]),h=z.useCallback(d=>{i&&(r.dispatch({...Lo(d),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(t)}),On(d))},[r,t,i]);return{rInput:s,handleFocus:lY,handleBlur:c,handleKeyDown:u,handleChange:f,handleInputPointerDown:h,handleDoubleClick:On,isEmpty:o.trim().length===0,isEditing:i,isEditingAnything:l}}function lY(){}const Sg=Bt.memo(function({id:t,type:n,text:o,labelColor:r,font:s,fontSize:a,lineHeight:i,align:l,verticalAlign:c,wrap:u,isSelected:f,onKeyDown:h,classNamePrefix:d,style:p,textWidth:y,textHeight:g}){const{rInput:b,isEmpty:m,isEditing:v,isEditingAnything:x,...w}=aY(t,n,o),[S,k]=z.useState(o);z.useEffect(()=>{v||k(o)},[v,o]);const _=Su.normalizeTextForDom(o),C=_.length>0,P=zq(l);if(!v&&!C)return null;const A=d||"tl-text";return E.jsx("div",{className:`${A}-label tl-text-wrapper`,"data-font":s,"data-align":l,"data-hastext":!m,"data-isediting":v,"data-iseditinganything":x,"data-textwrap":!!u,"data-isselected":f,style:{justifyContent:l==="middle"||P?"center":l,alignItems:c==="middle"?"center":c,...p},children:E.jsxs("div",{className:`${A}-label__inner tl-text-content__wrapper`,style:{fontSize:a,lineHeight:a*i+"px",minHeight:i+32,minWidth:y||0,color:r,width:y,height:g},children:[E.jsx("div",{className:`${A} tl-text tl-text-content`,dir:"ltr",children:_}),(x||f)&&E.jsx(iY,{ref:b,text:o,isEditing:v,...w,handleKeyDown:h??w.handleKeyDown},S)]})})}),cY=z.memo(function({id:t,text:n,size:o,font:r,position:s,width:a,isSelected:i,labelColor:l}){const c=tn();return E.jsx(Sg,{id:t,classNamePrefix:"tl-arrow",type:"arrow",font:r,fontSize:ql[o],lineHeight:Rn.lineHeight,align:"middle",verticalAlign:"middle",text:n,labelColor:c[l].solid,textWidth:a,isSelected:i,style:{transform:`translate(${s.x}px, ${s.y}px)`}})});let uY=0;class jg extends Us{constructor(){super(...arguments);R(this,"canEdit",()=>!0);R(this,"canBind",()=>!1);R(this,"canSnap",()=>!1);R(this,"hideResizeHandles",()=>!0);R(this,"hideRotateHandle",()=>!0);R(this,"hideSelectionBoundsBg",()=>!0);R(this,"hideSelectionBoundsFg",()=>!0);R(this,"onHandleDrag",(o,{handle:r,isPrecise:s})=>{const a=r.id;if(a==="middle"){const{start:g,end:b}=zs(this.editor,o),m=q.Sub(b,g),v=q.Per(m),x=q.Med(b,g),w=q.Sub(x,v),S=q.Add(x,v),k=q.NearestPointOnLineSegment(w,S,r,!1);let _=q.Dist(k,x);return q.Clockwise(k,b,x)&&(_*=-1),{id:o.id,type:o.type,props:{bend:_}}}const i=wr(o);if(this.editor.inputs.ctrlKey)return i.props[a]={type:"point",x:r.x,y:r.y},i;const l=this.editor.getShapePageTransform(o.id).applyToPoint(r),c=this.editor.getShapeAtPoint(l,{hitInside:!0,hitFrameInside:!0,margin:0,filter:g=>!g.isLocked&&this.editor.getShapeUtil(g).canBind(g)});if(!c)return i.props[a]={type:"point",x:r.x,y:r.y},i;const u=this.editor.getShapeGeometry(c),f=mt.ZeroFix(u.bounds),h=this.editor.getShapePageTransform(i.id).applyToPoint(r),d=this.editor.getPointInShapeSpace(c,h);let p=s;if(!p){const g=i.props[a];(g.type==="point"||g.type==="binding"&&c.id!==g.boundShapeId)&&(p=this.editor.inputs.pointerVelocity.len()<.5)}if(!s){u.isClosed||(p=!0);const g=i.props[a==="start"?"end":"start"];g.type==="binding"&&c.id===g.boundShapeId&&g.isPrecise&&(p=!0)}const y={x:(d.x-f.minX)/f.width,y:(d.y-f.minY)/f.height};return p&&q.Dist(d,f.center)<Math.max(4,Math.min(Math.min(f.width,f.height)*.15,16))/this.editor.getZoomLevel()&&(y.x=.5,y.y=.5),i.props[a]={type:"binding",boundShapeId:c.id,normalizedAnchor:y,isPrecise:p,isExact:this.editor.inputs.altKey},i.props.start.type==="binding"&&i.props.end.type==="binding"&&i.props.start.boundShapeId===i.props.end.boundShapeId&&q.Equals(i.props.start.normalizedAnchor,i.props.end.normalizedAnchor)&&(i.props.end.normalizedAnchor.x+=.05),i});R(this,"onTranslateStart",o=>{const r=o.props.start.type==="binding"?o.props.start.boundShapeId:null,s=o.props.end.type==="binding"?o.props.end.boundShapeId:null,a=zs(this.editor,o),i=this.editor.getShapePageTransform(o.id),l=this.editor.getSelectedShapeIds(),c=new Set;r&&(c.add(r),this.editor.getShapeAncestors(r).forEach(f=>c.add(f.id))),s&&(c.add(s),this.editor.getShapeAncestors(s).forEach(f=>c.add(f.id)));for(const f of l)if(c.has(f))return;let u=o;dI.set(o,{pagePosition:i.applyToPoint(o),terminalBindings:Uf(a,(f,h)=>{const d=o.props[f];return d.type!=="binding"?null:{binding:d,shapePosition:h,pagePosition:i.applyToPoint(h)}})});for(const f of["start","end"]){const h=o.props[f];h.type==="binding"&&(u={...o,props:{...o.props,[f]:{...h,isPrecise:!0}}})}return u});R(this,"onTranslate",(o,r)=>{const s=dI.get(o);if(!s)return;const a=this.editor.getShapePageTransform(r.id),i=q.Sub(a.applyToPoint(r),s.pagePosition);let l=r;for(const[c,u]of Po(s.terminalBindings)){if(!u)continue;const f=q.Add(u.pagePosition,q.Mul(i,.5)),h=this.editor.getShapeAtPoint(f,{hitInside:!0,hitFrameInside:!0,margin:0,filter:d=>!d.isLocked&&this.editor.getShapeUtil(d).canBind(d)});if((h==null?void 0:h.id)===u.binding.boundShapeId){const d=mt.ZeroFix(this.editor.getShapeGeometry(h).bounds),p=this.editor.getPointInShapeSpace(h,f),y={x:(p.x-d.minX)/d.width,y:(p.y-d.minY)/d.height};l={...l,props:{...l.props,[c]:{...u.binding,isPrecise:!0,normalizedAnchor:y}}}}else l={...l,props:{...l.props,[c]:{type:"point",x:u.shapePosition.x,y:u.shapePosition.y}}}}return l});R(this,"onResize",(o,r)=>{const{scaleX:s,scaleY:a}=r,i=zs(this.editor,o),{start:l,end:c}=wr(o.props);let{bend:u}=o.props;l.type==="point"&&(l.x=i.start.x*s,l.y=i.start.y*a),c.type==="point"&&(c.x=i.end.x*s,c.y=i.end.y*a);const f=Math.abs(s),h=Math.abs(a);return s<0&&a>=0?(u!==0&&(u*=-1,u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x),c.type==="binding"&&(c.normalizedAnchor.x=1-c.normalizedAnchor.x)):s>=0&&a<0?(u!==0&&(u*=-1,u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.y=1-l.normalizedAnchor.y),c.type==="binding"&&(c.normalizedAnchor.y=1-c.normalizedAnchor.y)):s>=0&&a>=0?u!==0&&(u*=Math.max(f,h)):s<0&&a<0&&(u!==0&&(u*=Math.max(f,h)),l.type==="binding"&&(l.normalizedAnchor.x=1-l.normalizedAnchor.x,l.normalizedAnchor.y=1-l.normalizedAnchor.y),c.type==="binding"&&(c.normalizedAnchor.x=1-c.normalizedAnchor.x,c.normalizedAnchor.y=1-c.normalizedAnchor.y)),{props:{start:l,end:c,bend:u}}});R(this,"onDoubleClickHandle",(o,r)=>{switch(r.id){case"start":return{id:o.id,type:o.type,props:{...o.props,arrowheadStart:o.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:o.id,type:o.type,props:{...o.props,arrowheadEnd:o.props.arrowheadEnd==="none"?"arrow":"none"}}}});R(this,"onEditEnd",o=>{const{id:r,type:s,props:{text:a}}=o;a.trimEnd()!==o.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:a.trimEnd()}}])})}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",labelPosition:.5,font:"draw"}}getGeometry(o){const r=this.editor.getArrowInfo(o),s=[],a=r.isStraight?new hh({start:q.From(r.start.point),end:q.From(r.end.point)}):new DP({center:q.Cast(r.handleArc.center),radius:r.handleArc.radius,start:q.Cast(r.start.point),end:q.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let i;if(o.props.text.trim()){const l=xg(this.editor,o);s.push(...l.debugGeom),i=new Vi({x:l.box.x,y:l.box.y,width:l.box.w,height:l.box.h,isFilled:!0,isLabel:!0})}return new Ns({children:[...i?[a,i]:[a],...s]})}getHandles(o){const r=this.editor.getArrowInfo(o);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y,canBind:!0}].filter(Boolean)}component(o){var c;const r=this.editor.getOnlySelectedShape(),s=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","select.translating","arrow.dragging")&&!this.editor.getInstanceState().isReadonly;if(!((c=this.editor.getArrowInfo(o))!=null&&c.isValid))return null;const a=xg(this.editor,o),i=o.id===this.editor.getOnlySelectedShapeId(),l=this.editor.getEditingShapeId()===o.id||o.props.text;return E.jsxs(E.Fragment,{children:[E.jsx(Ha,{id:o.id,style:{minWidth:50,minHeight:50},children:E.jsx(uI,{shape:o,shouldDisplayHandles:s&&r===o})}),l&&E.jsx(cY,{id:o.id,text:o.props.text,font:o.props.font,size:o.props.size,position:a.box.center,width:a.box.w,isSelected:i,labelColor:o.props.labelColor})]})}indicator(o){const{start:r,end:s}=zs(this.editor,o),a=this.editor.getArrowInfo(o),i=this.editor.getShapeGeometry(o),l=i.bounds,c=o.props.text.trim()?i.children[1]:null,u=zm(o.id);if(!a||q.Equals(r,s))return null;const f=kn[o.props.size],h=a.start.arrowhead&&wg(a,"start",f),d=a.end.arrowhead&&wg(a,"end",f),p=a.isStraight?cI(a):aI(a),y=h&&a.start.arrowhead!=="arrow"||d&&a.end.arrowhead!=="arrow"||!!c,g=(o.id+"_clip").replace(":","_");return u&&c?E.jsx("rect",{x:ke(c.x),y:ke(c.y),width:c.w,height:c.h,rx:3.5,ry:3.5}):E.jsxs("g",{children:[y&&E.jsx("defs",{children:E.jsxs("mask",{id:g,children:[E.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.w+200,height:l.h+200,fill:"white"}),c&&E.jsx("rect",{x:ke(c.x),y:ke(c.y),width:c.w,height:c.h,fill:"black",rx:3.5,ry:3.5}),h&&E.jsx("path",{d:h,fill:a.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),d&&E.jsx("path",{d,fill:a.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),E.jsxs("g",{...y?{mask:`url(#${g})`}:void 0,children:[y&&E.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.width+200,height:l.height+200,opacity:0}),E.jsx("path",{d:p})]}),h&&E.jsx("path",{d:h}),d&&E.jsx("path",{d}),c&&E.jsx("rect",{x:ke(c.x),y:ke(c.y),width:c.w,height:c.h,rx:3.5,ry:3.5})]})}toSvg(o,r){r.addExportDef(Rx(o.props.fill)),o.props.text&&r.addExportDef(_u(o.props.font));const s=Bi(r);return E.jsxs(E.Fragment,{children:[E.jsx(uI,{shape:o,shouldDisplayHandles:!1}),E.jsx(bg,{fontSize:ql[o.props.size],font:o.props.font,align:"middle",verticalAlign:"middle",text:o.props.text,labelColor:s[o.props.labelColor].solid,bounds:xg(this.editor,o).box,padding:4})]})}getCanvasSvgDefs(){return[Dx(),{key:"arrow:dot",component:hY},{key:"arrow:cross",component:pY}]}}R(jg,"type","arrow"),R(jg,"props",aE),R(jg,"migrations",lE);function dY(t,n){const o=t.getArrowInfo(n);return o.isStraight?q.Dist(o.start.handle,o.end.handle):Math.abs(o.handleArc.length)}const uI=qo(function({shape:t,shouldDisplayHandles:n}){const o=Be(),r=tn(),s=o.getArrowInfo(t),a=mt.ZeroFix(o.getShapeGeometry(t).bounds),i=Bt.useMemo(()=>o.environment.isSafari?uY+=1:0,[t]);if(!(s!=null&&s.isValid))return null;const l=kn[t.props.size],c=s.start.arrowhead&&wg(s,"start",l),u=s.end.arrowhead&&wg(s,"end",l),f=s.isStraight?cI(s):aI(s);let h=null;if(n){const{strokeDasharray:v,strokeDashoffset:x}=Qi(dY(o,t),2,{end:"skip",start:"skip",lengthRatio:2.5});h=t.props.start.type==="binding"||t.props.end.type==="binding"?E.jsx("path",{className:"tl-arrow-hint",d:s.isStraight?sY(s):oY(s),strokeDasharray:v,strokeDashoffset:x,strokeWidth:2,markerStart:t.props.start.type==="binding"?t.props.start.isExact?"":t.props.start.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:t.props.end.type==="binding"?t.props.end.isExact?"":t.props.end.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:d,strokeDashoffset:p}=Qi(s.isStraight?s.length:Math.abs(s.bodyArc.length),l,{style:t.props.dash}),y=xg(o,t),g=!(s.start.arrowhead==="none"||s.start.arrowhead==="arrow"),b=!(s.end.arrowhead==="none"||s.end.arrowhead==="arrow"),m=(t.id+"_clip_"+i).replace(":","_");return E.jsxs(E.Fragment,{children:[E.jsx("defs",{children:E.jsxs("mask",{id:m,children:[E.jsx("rect",{x:ke(-100+a.minX),y:ke(-100+a.minY),width:ke(a.width+200),height:ke(a.height+200),fill:"white"}),t.props.text.trim()&&E.jsx("rect",{x:y.box.x,y:y.box.y,width:y.box.w,height:y.box.h,fill:"black",rx:4,ry:4}),c&&g&&E.jsx("path",{d:c,fill:s.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),u&&b&&E.jsx("path",{d:u,fill:s.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),E.jsxs("g",{fill:"none",stroke:r[t.props.color].solid,strokeWidth:l,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[h,E.jsxs("g",{mask:`url(#${m})`,children:[E.jsx("rect",{x:ke(a.minX-100),y:ke(a.minY-100),width:ke(a.width+200),height:ke(a.height+200),opacity:0}),E.jsx("path",{d:f,strokeDasharray:d,strokeDashoffset:p})]}),c&&g&&t.props.fill!=="none"&&E.jsx(pn,{theme:r,d:c,color:t.props.color,fill:t.props.fill}),u&&b&&t.props.fill!=="none"&&E.jsx(pn,{theme:r,d:u,color:t.props.color,fill:t.props.fill}),c&&E.jsx("path",{d:c}),u&&E.jsx("path",{d:u})]})]})}),dI=new WeakMap;function hY(){return E.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:E.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function pY(){return E.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[E.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),E.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const hI="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function ku({url:t,zoomLevel:n}){return E.jsx("a",{className:Pt("tl-hyperlink-button",{"tl-hyperlink-button__hidden":n<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:On,onPointerUp:On,title:t,draggable:!1,children:E.jsx("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${hI}") center 100% / 100% no-repeat`,WebkitMask:`url("${hI}") center 100% / 100% no-repeat`}})})}const fY=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function Nx(t){return fY.map(n=>{const{offsetX:o,offsetY:r,blur:s,spread:a,color:i}=n,l=new q(o,r),{x:c,y:u}=l.rot(-t);return`${c}px ${u}px ${s}px ${a}px ${i}`}).join(", ")}class _g extends cu{constructor(){super(...arguments);R(this,"canResize",()=>!1);R(this,"hideSelectionBoundsFg",()=>!0);R(this,"onBeforeCreate",o=>{pI(this.editor,o)});R(this,"onBeforeUpdate",(o,r)=>{if(o.props.url!==r.props.url)if(Qo.isValid(r.props.url))pI(this.editor,r);else return{...r,props:{...r.props,url:o.props.url}}})}getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(o){const r=o.props.assetId?this.editor.getAsset(o.props.assetId):null,s=this.editor.getShapePageTransform(o).rotation(),a=mY(o);return E.jsx(Vl,{children:E.jsxs("div",{className:"tl-bookmark__container",style:{boxShadow:Nx(s)},children:[E.jsxs("div",{className:"tl-bookmark__image_container",children:[r!=null&&r.props.image?E.jsx("img",{className:"tl-bookmark__image",draggable:!1,src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):E.jsx("div",{className:"tl-bookmark__placeholder"}),E.jsx(ku,{url:o.props.url,zoomLevel:this.editor.getZoomLevel()})]}),E.jsxs("div",{className:"tl-bookmark__copy_container",children:[(r==null?void 0:r.props.title)&&E.jsx("h2",{className:"tl-bookmark__heading",children:Mh((r==null?void 0:r.props.title)||"",54)}),(r==null?void 0:r.props.description)&&E.jsx("p",{className:"tl-bookmark__description",children:Mh((r==null?void 0:r.props.description)||"",128)}),E.jsx("a",{className:"tl-bookmark__link",href:o.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:On,onPointerUp:On,onClick:On,children:Mh(a,45)})]})]})})}indicator(o){return E.jsx("rect",{width:ke(o.props.w),height:ke(o.props.h),rx:"6",ry:"6"})}}R(_g,"type","bookmark"),R(_g,"props",cE),R(_g,"migrations",dE);const mY=t=>{try{const n=new URL(t.props.url),o=n.pathname.replace(/\/*$/,"");return`${n.hostname}${o}`}catch{return t.props.url}};function pI(t,n){const{url:o}=n.props,r=Ll.createId(cb(o));t.getAsset(r)?n.props.assetId!==r&&t.updateShapes([{id:n.id,type:n.type,props:{assetId:r}}]):(t.updateShapes([{id:n.id,type:n.type,props:{assetId:null}}]),gY(t,n))}const gY=wk(async(t,n)=>{const{url:o}=n.props,r=await t.getAssetForExternalContent({type:"url",url:o});r&&t.batch(()=>{t.createAssets([r]),t.updateShapes([{id:n.id,type:n.type,props:{assetId:r.id}}])})},500);function Kl(t,n=!1){const o=t.length;if(o<2)return"";let r=t[0].point,s=t[1].point;if(o===2)return`M${An(r)}L${An(s)}`;let a="";for(let i=2,l=o-1;i<l;i++)r=t[i].point,s=t[i+1].point,a+=Oo(r,s);return n?`M${Oo(t[0].point,t[1].point)}Q${An(t[1].point)}${Oo(t[1].point,t[2].point)}T${a}${Oo(t[o-1].point,t[0].point)}${Oo(t[0].point,t[1].point)}Z`:`M${An(t[0].point)}Q${An(t[1].point)}${Oo(t[1].point,t[2].point)}${t.length>3?"T":""}${a}L${An(t[o-1].point)}`}function yY(t,n={}){const{start:o={},end:r={}}=n,{cap:s=!0}=o,{cap:a=!0}=r;bn(!o.taper&&!r.taper,"cap taper not supported here"),bn(!o.easing&&!r.easing,"cap easing not supported here"),bn(s&&a,"cap must be true");const i=ui(t,n);ig(i,n);const l=vY(i);let c="";for(const u of l)c+=xY(u,n);return c}function vY(t){if(t.length<=2)return[t];const n=[];let o=[t[0]],r=q.Sub(t[1].point,t[0].point).uni(),s,a,i,l,c;for(let u=1,f=t.length;u<f-1;u++){if(i=t[u-1],l=t[u],c=t[u+1],s=q.Sub(c.point,l.point).uni(),a=q.Dpr(r,s),r=s,a<-.8){const h={...l,point:l.input};o.push(h),n.push(Ux(o)),o=[h];continue}if(o.push(l),!(a>.7)&&(q.Dist2(i.point,l.point)+q.Dist2(l.point,c.point))/((i.radius+l.radius+c.radius)/3)**2<1.5){o.push(l),n.push(Ux(o)),o=[l];continue}}return o.push(t[t.length-1]),n.push(Ux(o)),n}function Ux(t){const n=t[0];let o;for(;t.length>2&&(o=t[1],q.Dist2(n.point,o.point)<((n.radius+o.radius)/2*.5)**2);)t.splice(1,1);const r=t[t.length-1];let s;for(;t.length>2&&(s=t[t.length-2],q.Dist2(r.point,s.point)<((r.radius+s.radius)/2*.5)**2);)t.splice(t.length-2,1);return t.length>1&&(t[0]={...t[0],vector:q.Sub(t[0].point,t[1].point).uni()},t[t.length-1]={...t[t.length-1],vector:q.Sub(t[t.length-2].point,t[t.length-1].point).uni()}),t}function bY(t,n,o){return"M "+t+" "+n+" m -"+o+", 0 a "+o+","+o+" 0 1,1 "+o*2+",0 a "+o+","+o+" 0 1,1 -"+o*2+",0"}function xY(t,n={}){if(t.length===0)return"";if(t.length===1)return bY(t[0].point.x,t[0].point.y,t[0].radius);const{left:o,right:r}=IT(t,n);r.reverse();let s=`M${An(o[0])}T`;for(let a=1;a<o.length;a++)s+=Oo(o[a-1],o[a]);{const a=t[t.length-1],i=a.radius,l=a.vector.clone().per().neg(),c=q.Add(a.point,q.Mul(l,i)),u=q.Add(a.point,q.Mul(l,-i));s+=`${An(c)}A${ke(i)},${ke(i)} 0 0 1 ${An(u)}T`}for(let a=1;a<r.length;a++)s+=Oo(r[a-1],r[a]);{const a=t[0],i=a.radius,l=a.vector.clone().per(),c=q.Add(a.point,q.Mul(l,i)),u=q.Add(a.point,q.Mul(l,-i));s+=`${An(c)}A${ke(i)},${ke(i)} 0 0 1 ${An(u)}Z`}return s}function Ih(){const t=Be();return We("zoom",()=>t.getZoomLevel()<.35,[t])}const wY=t=>t*.65+M6(t*Yt/2)*.35,SY=t=>({size:1+t,thinning:.5,streamline:.62+(1+t)/8*.06,smoothing:.62,easing:Kn.easeOutSine,simulatePressure:!0}),jY=t=>({size:1+t*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:wY}),fI=t=>({size:1+t,thinning:0,streamline:.62+(1+t)/8*.06,smoothing:.62,simulatePressure:!1,easing:Kn.linear});function Bx({strokeWidth:t,showAsComplete:n}){return{size:1+t,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:Kn.easeOutSine,last:n}}function zx(t,n,o,r){return{...r?fI(n):t.dash==="draw"?t.isPen?jY(n):SY(n):fI(n),last:t.isComplete||o}}function Ah(t){const n=[];for(const o of t)if(o.type==="free"||o.points.length<2)n.push(...o.points.map(q.Cast));else{const r=Math.max(4,Math.floor(q.Dist(o.points[0],o.points[1])/16));n.push(...q.PointsBetween(o.points[0],o.points[1],r))}return n}function _Y(t,n){return{draw:"none",solid:"none",dotted:`0.1 ${n*2}`,dashed:`${n*2} ${n*2}`}[t.props.dash]}class kg extends Us{constructor(){super(...arguments);R(this,"hideResizeHandles",o=>Gx(o));R(this,"hideRotateHandle",o=>Gx(o));R(this,"hideSelectionBoundsFg",o=>Gx(o));R(this,"onResize",(o,r)=>{const{scaleX:s,scaleY:a}=r,i=[];for(const l of o.props.segments)i.push({...l,points:l.points.map(({x:c,y:u,z:f})=>({x:dm(s*c),y:dm(a*u),z:f}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(o){const r=Ah(o.props.segments),s=kn[o.props.size];if(o.props.segments.length===1){const i=mt.FromPoints(r);if(i.width<s*2&&i.height<s*2)return new x1({x:-s,y:-s,radius:s,isFilled:!0})}const a=ui(r,zx(o.props,s,!0,!0)).map(i=>i.point);return o.props.isClosed?new hn({points:a,isFilled:o.props.fill!=="none"}):new Bl({points:a})}component(o){return E.jsx(Ha,{id:o.id,children:E.jsx(gI,{shape:o,forceSolid:Ih()})})}indicator(o){var h;const r=Ih(),s=kn[o.props.size],a=Ah(o.props.segments);let i=s;!r&&!o.props.isPen&&o.props.dash==="draw"&&a.length===1&&(i+=Ra(o.id)()*(s/6));const l=o.props.isComplete||((h=Yo(o.props.segments))==null?void 0:h.type)==="straight",c=zx(o.props,i,l,!0),u=ui(a,c),f=u.length>1?Kl(u,o.props.isClosed):mI(a[0],i);return E.jsx("path",{d:f})}toSvg(o,r){return r.addExportDef(Rx(o.props.fill)),E.jsx(gI,{shape:o,forceSolid:!1})}getCanvasSvgDefs(){return[Dx()]}expandSelectionOutlinePx(o){const r=o.props.dash==="draw"?1.6:1;return kn[o.props.size]*r/2}}R(kg,"type","draw"),R(kg,"props",pE),R(kg,"migrations",fE);function mI(t,n){const o=(n+1)*.5;return`M ${t.x} ${t.y} m -${o}, 0 a ${o},${o} 0 1,0 ${o*2},0 a ${o},${o} 0 1,0 -${o*2},0`}function Gx(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function gI({shape:t,forceSolid:n}){var h;const o=tn(),r=kn[t.props.size],s=Ah(t.props.segments),a=t.props.isComplete||((h=Yo(t.props.segments))==null?void 0:h.type)==="straight";let i=r;!n&&!t.props.isPen&&t.props.dash==="draw"&&s.length===1&&(i+=Ra(t.id)()*(r/6));const l=zx(t.props,i,a,n);if(!n&&t.props.dash==="draw")return E.jsxs(E.Fragment,{children:[t.props.isClosed&&t.props.fill&&s.length>1?E.jsx(pn,{theme:o,fill:t.props.isClosed?t.props.fill:"none",color:t.props.color,d:Kl(ui(s,l),t.props.isClosed)}):null,E.jsx("path",{d:yY(s,l),strokeLinecap:"round",fill:o[t.props.color].solid})]});const c=ui(s,l),u=c.length<2,f=u?mI(s[0],0):Kl(c,t.props.isClosed);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:o,color:t.props.color,fill:u||t.props.isClosed?t.props.fill:"none",d:f}),E.jsx("path",{d:f,strokeLinecap:"round",fill:u?o[t.props.color].solid:"none",stroke:o[t.props.color].solid,strokeWidth:r,strokeDasharray:u?"none":_Y(t,r),strokeDashoffset:"0"})]})}function kY(t,n,o={}){const{newPoint:r,handle:s,scaleX:a,scaleY:i}=n,{minWidth:l=1,maxWidth:c=1/0,minHeight:u=1,maxHeight:f=1/0}=o;let h=t.props.w*a,d=t.props.h*i;const p=new q(0,0);if(h>0){if(h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=h-l;break}case"top":case"bottom":{p.x=(h-l)/2;break}default:p.x=0}h=l}}else if(p.x=h,h=-h,h<l){switch(s){case"top_left":case"left":case"bottom_left":{p.x=-h;break}default:p.x=-l}h=l}if(d>0){if(d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=d-u;break}case"right":case"left":{p.y=(d-u)/2;break}default:p.y=0}d=u}}else if(p.y=d,d=-d,d<u){switch(s){case"top_left":case"top":case"top_right":{p.y=-d;break}default:p.y=-u}d=u}const{x:y,y:g}=p.rot(t.rotation).add(r);return{x:y,y:g,props:{w:Math.min(c,h),h:Math.min(f,d)}}}const EY=t=>Object.entries(t).filter(([n,o])=>o).map(([n])=>n).join(" ");class Eg extends cu{constructor(){super(...arguments);R(this,"hideSelectionBoundsFg",o=>!this.canResize(o));R(this,"canEdit",()=>!0);R(this,"canResize",o=>{var r,s;return!!((s=(r=Xa(o.props.url))==null?void 0:r.definition)!=null&&s.doesResize)});R(this,"canEditInReadOnly",()=>!0);R(this,"isAspectRatioLocked",o=>{var r;return((r=Xa(o.props.url))==null?void 0:r.definition.isAspectRatioLocked)??!1});R(this,"onResize",(o,r)=>{const s=this.isAspectRatioLocked(o),a=Xa(o.props.url);let i=(a==null?void 0:a.definition.minWidth)??200,l=(a==null?void 0:a.definition.minHeight)??200;if(s){const c=o.props.w/o.props.h;c>1?i*=c:l/=c}return kY(o,r,{minWidth:i,minHeight:l})})}getDefaultProps(){return{w:300,h:300,url:""}}component(o){const{w:r,h:s,url:a}=o.props,i=zm(o.id),l=z.useMemo(()=>BT(a),[a]),c=We("is hovering",()=>{const{editingShapeId:d,hoveredShapeId:p}=this.editor.getCurrentPageState();if(d&&p!==d){const y=this.editor.getShape(d);if(y&&this.editor.isShapeOfType(y,"embed"))return!0}return!1},[]),u=this.editor.getShapePageTransform(o).rotation(),f=i||c;if((l==null?void 0:l.definition.type)==="github_gist"){const d=l.url.split("/").pop();if(!d)throw Error("No gist id!");return E.jsx(Vl,{className:"tl-embed-container",id:o.id,children:E.jsx(CY,{id:d,width:ke(r),height:ke(s),isInteractive:f,pageRotation:u})})}const h=EY({...m6,...(l==null?void 0:l.definition.overridePermissions)??{}});return E.jsx(Vl,{className:"tl-embed-container",id:o.id,children:l!=null&&l.definition?E.jsx("iframe",{className:"tl-embed",sandbox:h,src:l.embedUrl,width:ke(r),height:ke(s),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:f?"auto":"none",zIndex:f?"":"-1",boxShadow:Nx(u),borderRadius:(l==null?void 0:l.definition.overrideOutlineRadius)??8,background:l==null?void 0:l.definition.backgroundColor}}):null})}indicator(o){const r=z.useMemo(()=>Xa(o.props.url),[o.props.url]);return E.jsx("rect",{width:ke(o.props.w),height:ke(o.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}R(Eg,"type","embed"),R(Eg,"props",gE),R(Eg,"migrations",yE);function CY({id:t,file:n,isInteractive:o,width:r,height:s,style:a,pageRotation:i}){return E.jsx("iframe",{className:"tl-embed",draggable:!1,width:ke(r),height:ke(s),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...a,pointerEvents:o?"all":"none",zIndex:o?"":"-1",boxShadow:Nx(i)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${t}.js${n?`?file=${n}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const PY=z.forwardRef(({id:t,name:n,isEditing:o},r)=>{const s=Be(),a=z.useCallback(c=>{c.key==="Enter"&&!c.nativeEvent.isComposing&&(On(c),c.currentTarget.blur(),s.setEditingShape(null))},[s]),i=z.useCallback(c=>{const u=s.getShape(t);if(!u)return;const f=u.props.name,h=c.currentTarget.value.trim();f!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}],{squashing:!0})},[t,s]),l=z.useCallback(c=>{const u=s.getShape(t);if(!u)return;const f=u.props.name,h=c.currentTarget.value;f!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}],{squashing:!0})},[t,s]);return E.jsxs("div",{className:`tl-frame-label ${o?"tl-frame-label__editing":""}`,children:[E.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:o?void 0:"none"},value:n,autoFocus:!0,onKeyDown:a,onBlur:i,onChange:l}),yI(n,"Frame")+String.fromCharCode(8203)]})}),MY=function({id:t,name:n,width:o,height:r}){const s=Be(),a=We("shape rotation",()=>za(s.getShapePageTransform(t).rotation()),[s,t]),i=zm(t),l=z.useRef(null),c=z.useCallback(d=>{const p=Lo(d);s.getEditingShapeId()!==t&&(s.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:s.getShape(t),...p}),d.preventDefault())},[s,t]);z.useEffect(()=>{const d=l.current;d&&i&&(d.focus(),d.select(),requestAnimationFrame(()=>{document.activeElement!==d&&(d.focus(),d.select())}))},[l,i]);const u=((a+Math.PI/4)*(2/Math.PI)+4)%4,f=["top","left","bottom","right"][Math.floor(u)];let h;switch(f){case"top":h="";break;case"right":h=`translate(${ke(o)}px, 0px) rotate(90deg)`;break;case"bottom":h=`translate(${ke(o)}px, ${ke(r)}px) rotate(180deg)`;break;case"left":h=`translate(0px, ${ke(r)}px) rotate(270deg)`;break}return E.jsx("div",{className:"tl-frame-heading",style:{overflow:i?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(f==="top"||f==="bottom"?o:r)}px + var(--space-5))`,bottom:"100%",transform:`${h} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:c,children:E.jsx("div",{className:"tl-frame-heading-hit-area",children:E.jsx(PY,{ref:l,id:t,name:n,isEditing:i})})})};function yI(t,n){return t.match(/^\s*$/)?n:t}class Cg extends cu{constructor(){super(...arguments);R(this,"canBind",()=>!0);R(this,"canEdit",()=>!0);R(this,"canReceiveNewChildrenOfType",(o,r)=>!o.isLocked);R(this,"canDropShapes",(o,r)=>!o.isLocked);R(this,"onDragShapesOver",(o,r)=>{r.every(s=>s.parentId===o.id)||this.editor.reparentShapes(r,o.id)});R(this,"onDragShapesOut",(o,r)=>{const s=this.editor.getShape(o.parentId);s&&this.editor.isShapeOfType(s,"group")?this.editor.reparentShapes(r,s.id):this.editor.reparentShapes(r,this.editor.getCurrentPageId())});R(this,"onResize",(o,r)=>RP(o,r))}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(o){return new Vi({width:o.props.w,height:o.props.h,isFilled:!1})}component(o){const r=this.editor.getShapeGeometry(o).bounds,s=tn(),a=We("is creating this shape",()=>{const i=this.editor.getStateDescendant("select.resizing");if(!i||!i.getIsActive())return!1;const l=i==null?void 0:i.info;return l?l.isCreating&&this.editor.getOnlySelectedShapeId()===o.id:!1},[o.id]);return E.jsxs(E.Fragment,{children:[E.jsx(Ha,{children:E.jsx("rect",{className:Pt("tl-frame__body",{"tl-frame__creating":a}),width:r.width,height:r.height,fill:s.solid,stroke:s.text})}),a?null:E.jsx(MY,{id:o.id,name:o.props.name,width:r.width,height:r.height})]})}toSvg(o,r){const s=Bi({isDarkMode:r.isDarkMode}),a=((za(this.editor.getShapePageTransform(o.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4,i=Math.floor(a);let l;switch(i){case 0:l="";break;case 3:l=`translate(${ke(o.props.w)}, 0) rotate(90)`;break;case 2:l=`translate(${ke(o.props.w)}, ${ke(o.props.h)}) rotate(180)`;break;case 1:l=`translate(0, ${ke(o.props.h)}) rotate(270)`;break;default:throw Error("labelSide out of bounds")}const c={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:o.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},u=this.editor.textMeasure.measureTextSpans(yI(o.props.name,"Frame")+String.fromCharCode(8203),c),f=u[0],h=Yo(u),d=h.box.w+h.box.x-f.box.x,p=Lx(this.editor,u,{offsetY:-c.height-2,...c});return E.jsxs(E.Fragment,{children:[E.jsx("rect",{width:o.props.w,height:o.props.h,fill:s.solid,stroke:s.black.solid,strokeWidth:1,rx:1,ry:1}),E.jsxs("g",{transform:l,children:[E.jsx("rect",{x:-8,y:-c.height-4,width:d+16,height:c.height,fill:s.background,rx:4,ry:4}),p]})]})}indicator(o){const r=this.editor.getShapeGeometry(o).bounds;return E.jsx("rect",{width:ke(r.width),height:ke(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}R(Cg,"type","frame"),R(Cg,"props",vE),R(Cg,"migrations",bE);function Jn(t){return`${ke(t.x)},${ke(t.y)} `}function vI(t=""){let n=0,o=0,r=0,s=0;function a(){const i=n^n<<11;return n=o,o=r,r=s,s^=(s>>>19^i^i>>>8)>>>0,s/4294967296*2}for(let i=0;i<t.length+64;i++)n^=t.charCodeAt(i)|0,a();return a}function Vx(t){let n="M";const o=t.length;let r,s,a;for(let i=0,l=o;i<l;i+=3)r=t[i],s=t[i+1],a=t[i+2],n+=`${Jn(r)}L${Jn(s)}Q${Jn(a)}`;return n+=`${Jn(t[0])}`,n}function Hx(t,n,o,r,s){const a=[],i=vI(t);let l=n[0],c;const u=n.length;for(let f=0,h=u*s;f<h;f++){c=q.AddXY(n[(f+1)%u],i()*o,i()*o);const d=q.Sub(c,l),p=q.Len(d),y=q.Div(d,p).mul(Math.min(p/4,r));a.push(q.Add(l,y),q.Add(c,y.neg()),c),l=c}return a}function bI(t,n,o){let r=`M ${Jn(n[0])}L`,s=`M ${Jn(n[0])}L`;const a=o/3,i=o*2,l=vI(t);let c=n[0],u,f=n[0],h;const d=n.length;for(let p=0,y=d-1;p<y;p++){u=n[p+1],h=q.AddXY(n[p+1],l()*a,l()*a);const g=q.Sub(u,c),b=q.Len(g),m=q.Div(g,b).mul(Math.min(b/4,i)),v=q.Add(c,m),x=q.Add(u,m.neg()),w=q.Sub(h,f),S=q.Len(w),k=q.Div(w,S).mul(Math.min(S/4,i)),_=q.Add(f,k),C=q.Add(h,k.neg());p===y-1?(r+=`${Jn(v)}L ${Jn(u)}`,s+=`${Jn(_)}L ${Jn(h)}`):(r+=`${Jn(v)}L ${Jn(x)}Q ${Jn(u)}`,s+=`${Jn(_)}L ${Jn(C)}Q ${Jn(h)}`,c=u,f=h)}return[r,r+s]}function xI(t,n){const o=Math.min(t,n)/2,r=Math.max(t,n)-o*2;return Math.PI*(o*2)+2*r}function TY(t,n,o){const r=Math.min(t,n)/2,s=Math.max(t,n)-r*2,a=(Math.PI*(r*2)+2*s)/o,i=t>n?[{type:"straight",start:new q(r,0),delta:new q(1,0)},{type:"arc",center:new q(t-r,r),startAngle:-Yt/2},{type:"straight",start:new q(t-r,n),delta:new q(-1,0)},{type:"arc",center:new q(r,r),startAngle:Yt/2}]:[{type:"straight",start:new q(t,r),delta:new q(0,1)},{type:"arc",center:new q(r,n-r),startAngle:0},{type:"straight",start:new q(0,n-r),delta:new q(0,-1)},{type:"arc",center:new q(r,r),startAngle:Yt}];let l=0;const c=[];for(let u=0;u<o;u++){const f=i[0];f.type==="straight"?c.push(q.Add(f.start,q.Mul(f.delta,l))):c.push(Dl(f.center,r,f.startAngle+l/r)),l+=a;let h=f.type==="straight"?s:Yt*r;for(;l>h;)l-=h,i.push(i.shift()),h=i[0].type==="straight"?s:Yt*r}return c}const IY=(t,n,o,r,s)=>{switch(t){case"s":return n;case"m":return o;case"l":return r;case"xl":return s}};function Pg(t,n,o,r){const s=Ra(o),a=xI(t,n),i=Math.max(Math.ceil(a/IY(r,50,70,100,130)),6,Math.ceil(a/Math.min(t,n))),l=a/i*.2,c=Math.max(t-l*2,1),u=Math.max(n-l*2,1),f=(t-c)/2,h=(n-u)/2,d=xI(c,u)/i,p=TY(c,u,i).map(v=>v.addXY(f,h)),y=t<20?0:l*.3,g=n<20?0:l*.3,b=p.slice(0);for(let v=0;v<Math.floor(i/2);v++)b[v]=q.AddXY(b[v],s()*y,s()*g),b[i-v-1]=q.AddXY(b[i-v-1],s()*y,s()*g);const m=[];for(let v=0;v<b.length;v++){const x=v===b.length-1?0:v+1,w=b[v],S=b[x],k=p[v],_=p[x],C=q.Average([k,_]),P=q.Angle(k,_)-Math.PI/2,A=q.Dist(k,_),I=d-A,N=q.Dist(w,S)/A,O=(Math.max(f,h)+I)*N,F=q.Add(C,q.FromAngle(P,O));F.x<0?F.x=0:F.x>t&&(F.x=t),F.y<0?F.y=0:F.y>n&&(F.y=n);const U=wI(w,S,F),G=q.Dist(U||q.Average([w,S]),w);m.push({leftPoint:w,rightPoint:S,arcPoint:F,center:U,radius:G})}return m}function wI(t,n,o){const r=t.x*(n.y-o.y)-t.y*(n.x-o.x)+n.x*o.y-o.x*n.y,s=(t.x*t.x+t.y*t.y)*(o.y-n.y)+(n.x*n.x+n.y*n.y)*(t.y-o.y)+(o.x*o.x+o.y*o.y)*(n.y-t.y),a=(t.x*t.x+t.y*t.y)*(n.x-o.x)+(n.x*n.x+n.y*n.y)*(o.x-t.x)+(o.x*o.x+o.y*o.y)*(t.x-n.x),i=-s/(2*r),l=-a/(2*r);return!Number.isFinite(i)||!Number.isFinite(l)?null:new q(i,l)}function AY(t,n,o,r){const s=[],a=Pg(t,n,o,r);for(const{center:i,radius:l,leftPoint:c,rightPoint:u}of a)s.push(...LY(c,u,i,l,10));return s}function Wx(t,n,o,r){const s=Pg(t,n,o,r);let a=`M${ke(s[0].leftPoint.x)},${ke(s[0].leftPoint.y)}`;for(const{leftPoint:i,rightPoint:l,radius:c,center:u}of s){if(u===null){a+=` L${ke(l.x)},${ke(l.y)}`;continue}const f=SI(i,l,u)?"0":"1";a+=` A${ke(c)},${ke(c)} 0 ${f},1 ${ke(l.x)},${ke(l.y)}`}return a+=" Z",a}function OY(t,n,o,r){const s=Ra(o),a=r==="s"?.5:r==="m"?.7:r==="l"?.9:1.6,i=d=>d+s()*a*2,l=Pg(t,n,o,r),c=l.reduce((d,p)=>d+q.Dist2(p.leftPoint,p.rightPoint),0)/l.length>(a*15)**2?d=>new q(i(d.x),i(d.y)):d=>d;let u=`M${ke(l[0].leftPoint.x)},${ke(l[0].leftPoint.y)}`,f=c(l[0].leftPoint),h=`M${ke(f.x)},${ke(f.y)}`;for(const{leftPoint:d,center:p,rightPoint:y,radius:g,arcPoint:b}of l){if(p===null){u+=` L${ke(y.x)},${ke(y.y)}`;const k=c(y);h+=` L${ke(k.x)},${ke(k.y)}`,f=k;continue}const m=SI(d,y,p)?"0":"1";u+=` A${ke(g)},${ke(g)} 0 ${m},1 ${ke(y.x)},${ke(y.y)}`;const v=c(y),x=c(b),w=wI(f,v,x);if(!w){h+=` L${ke(v.x)},${ke(v.y)}`,f=v;continue}const S=Math.abs(q.Dist(w,f));h+=` A${ke(S)},${ke(S)} 0 ${m},1 ${ke(v.x)},${ke(v.y)}`,f=v}return u+h+" Z"}function LY(t,n,o,r,s){if(o===null)return[q.From(t),q.From(n)];const a=[],i=q.Angle(o,t),l=q.Angle(o,n),c=rh(i,l);for(let u=0;u<s;u++){const f=u/(s-1),h=i+c*f,d=Dl(o,r,h);a.push(d)}return a}function SI(t,n,o){return(n.x-t.x)*(o.y-t.y)-(n.y-t.y)*(o.x-t.x)>0}function RY(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function DY(t,n,o,r){const s=Ra(t),a=n/2,i=o/2,l=lm(a,i),c=[],u=nr*s(),f=nr+hr/2+Math.abs(s())*hr,h=Math.max(16,l/10);for(let d=0;d<h;d++){const p=d/(h-1),y=u+p*f,g=Math.cos(y),b=Math.sin(y);c.push(new q(a*g+n*.5+.05*s(),i*b+o/2+.05*s(),Math.min(1,.5+Math.abs(.5-(s()>0?Kn.easeInOutSine(p):Kn.easeInExpo(p)))/2)))}return ui(c,RY(r))}function FY(t,n,o,r){return Kl(DY(t,n,o,r))}function $x(t,n){switch(t.geo){case"x-box":return NY(t.w,t.h,n,t.dash);case"check-box":return UY(t.w,t.h);default:return}}function NY(t,n,o,r){const s=r==="draw"?.62:0;if(r==="dashed")return[[new q(0,0),new q(t/2,n/2)],[new q(t,n),new q(t/2,n/2)],[new q(0,n),new q(t/2,n/2)],[new q(t,0),new q(t/2,n/2)]];const a=l=>Math.max(0,Math.min(t,l)),i=l=>Math.max(0,Math.min(n,l));return[[new q(a(o*s),i(o*s)),new q(a(t-o*s),i(n-o*s))],[new q(a(o*s),i(n-o*s)),new q(a(t-o*s),i(o*s))]]}function UY(t,n){const o=Math.min(t,n)*.82,r=(t-o)/2,s=(n-o)/2,a=l=>Math.max(0,Math.min(t,l)),i=l=>Math.max(0,Math.min(n,l));return[[new q(a(r+o*.25),i(s+o*.52)),new q(a(r+o*.45),i(s+o*.82))],[new q(a(r+o*.45),i(s+o*.82)),new q(a(r+o*.82),i(s+o*.22))]]}const BY=z.memo(function({dash:t,fill:n,color:o,strokeWidth:r,w:s,h:a,id:i,size:l}){const c=tn(),u=Wx(s,a,i,l),f=Pg(s,a,i,l);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:c,d:u,fill:n,color:o}),E.jsx("g",{strokeWidth:r,stroke:c[o].solid,fill:"none",pointerEvents:"all",children:f.map(({leftPoint:h,rightPoint:d,center:p,radius:y},g)=>{const b=p?y*za(za(q.Angle(p,d))-za(q.Angle(p,h))):q.Dist(h,d),{strokeDasharray:m,strokeDashoffset:v}=Qi(b,r,{style:t,start:"outset",end:"outset"});return E.jsx("path",{d:p?`M${h.x},${h.y}A${y},${y},0,0,1,${d.x},${d.y}`:`M${h.x},${h.y}L${d.x},${d.y}`,strokeDasharray:m,strokeDashoffset:v},g)})})]})}),zY=z.memo(function({w:t,h:n,strokeWidth:o,dash:r,color:s,fill:a}){const i=tn(),l=t/2,c=n/2,u=Math.max(0,l),f=Math.max(0,c),h=lm(u,f),{strokeDasharray:d,strokeDashoffset:p}=Qi(h<64?h*2:h,o,{style:r,snap:4,closed:!0}),y=`M${l-u},${c}a${u},${f},0,1,1,${u*2},0a${u},${f},0,1,1,-${u*2},0`;return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:i,d:y,color:s,fill:a}),E.jsx("path",{d:y,strokeWidth:o,width:ke(t),height:ke(n),fill:"none",stroke:i[s].solid,strokeDasharray:d,strokeDashoffset:p,pointerEvents:"all"})]})});function GY(t,n){if(n>t){const r=t/2;return`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${n-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}const o=n/2;return`
    M${o},0
    L${t-o},0
    a${o},${o},0,1,1,0,${o*2}
    L${o},${n}
    a${o},${o},0,1,1,0,${-o*2}
    Z`}function VY(t,n){if(t>n){const r=n/2;return lm(r,r)+(t-r*2)*2}const o=t/2;return lm(o,o)+(n-o*2)*2}const HY=z.memo(function({w:t,h:n,strokeWidth:o,dash:r,color:s,fill:a}){const i=tn(),l=GY(t,n),c=VY(t,n),{strokeDasharray:u,strokeDashoffset:f}=Qi(c<64?c*2:c,o,{style:r,snap:4,start:"outset",end:"outset",closed:!0});return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:i,d:l,color:s,fill:a}),E.jsx("path",{d:l,strokeWidth:o,width:ke(t),height:ke(n),fill:"none",stroke:i[s].solid,strokeDasharray:u,strokeDashoffset:f,pointerEvents:"all"})]})}),WY=z.memo(function({dash:t,fill:n,color:o,strokeWidth:r,outline:s,lines:a}){const i=tn(),l="M"+s[0]+"L"+s.slice(1)+"Z";return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:i,d:l,fill:n,color:o}),E.jsxs("g",{strokeWidth:r,stroke:i[o].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(s.length)).map((c,u)=>{const f=s[u],h=s[(u+1)%s.length],d=q.Dist(f,h),{strokeDasharray:p,strokeDashoffset:y}=Qi(d,r,{style:t,start:"outset",end:"outset"});return E.jsx("line",{x1:f.x,y1:f.y,x2:h.x,y2:h.y,strokeDasharray:p,strokeDashoffset:y},u)}),a&&a.map(([c,u],f)=>{const h=q.Dist(c,u),{strokeDasharray:d,strokeDashoffset:p}=Qi(h,r,{style:t,start:"skip",end:"outset",snap:t==="dotted"?4:void 0});return E.jsx("path",{d:`M${c.x},${c.y}L${u.x},${u.y}`,stroke:i[o].solid,strokeWidth:r,fill:"none",strokeDasharray:d,strokeDashoffset:p},`line_fg_${f}`)})]})]})}),$Y=z.memo(function({fill:t,color:n,strokeWidth:o,w:r,h:s,id:a,size:i}){const l=tn(),c=OY(r,s,a,i);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:l,d:c,fill:t,color:n}),E.jsx("path",{d:c,stroke:l[n].solid,strokeWidth:o,fill:"none"})]})}),qY=z.memo(function({id:t,outline:n,lines:o,fill:r,color:s,strokeWidth:a}){const i=tn(),l=Hx(t,n,a/3,a*2,2);let c=Vx(l);if(o)for(const[h,d]of o)c+=`M${h.x},${h.y}L${d.x},${d.y}`;const u=Hx(t,n,0,a*2,1),f=Vx(u);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:f,fill:r,color:s,theme:i}),E.jsx("path",{d:c,stroke:i[s].solid,strokeWidth:a,fill:"none"})]})}),YY=z.memo(function({fill:t,color:n,strokeWidth:o,w:r,h:s,id:a,size:i}){const l=tn(),c=Wx(r,s,a,i);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{theme:l,d:c,fill:t,color:n}),E.jsx("path",{d:c,stroke:l[n].solid,strokeWidth:o,fill:"none"})]})}),jI=z.memo(function({w:t,h:n,strokeWidth:o,fill:r,color:s}){const a=tn(),i=t/2,l=n/2,c=Math.max(0,i),u=Math.max(0,l),f=`M${i-c},${l}a${c},${u},0,1,1,${c*2},0a${c},${u},0,1,1,-${c*2},0`;return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:f,color:s,fill:r,theme:a}),E.jsx("path",{d:f,stroke:a[s].solid,strokeWidth:o,fill:"none"})]})}),_I=z.memo(function({w:t,h:n,strokeWidth:o,fill:r,color:s}){const a=tn(),i=kI(t,n);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:i,color:s,fill:r,theme:a}),E.jsx("path",{d:i,stroke:a[s].solid,strokeWidth:o,fill:"none"})]})});function kI(t,n){let o;if(n>t){const r=t/2;o=`
    M0,${r}
    a${r},${r},0,1,1,${r*2},0
    L${t},${n-r}
    a${r},${r},0,1,1,-${r*2},0
    Z`}else{const r=n/2;o=`
    M${r},0
    L${t-r},0
    a${r},${r},0,1,1,0,${r*2}
    L${r},${n}
    a${r},${r},0,1,1,0,${-r*2}
    Z`}return o}const KY=z.memo(function({outline:t,lines:n,fill:o,color:r,strokeWidth:s}){const a=tn();let i="M"+t[0]+"L"+t.slice(1)+"Z";if(n)for(const[l,c]of n)i+=`M${l.x},${l.y}L${c.x},${c.y}`;return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:i,fill:o,color:r,theme:a}),E.jsx("path",{d:i,stroke:a[r].solid,strokeWidth:s,fill:"none"})]})});function EI({shape:t}){const n=Be(),{id:o,props:r}=t,{w:s,color:a,fill:i,dash:l,growY:c,size:u}=r,f=kn[u],h=r.h+c;switch(r.geo){case"cloud":{if(l==="solid")return E.jsx(YY,{color:a,fill:i,strokeWidth:f,w:s,h,id:o,size:u});if(l==="dashed"||l==="dotted")return E.jsx(BY,{color:a,fill:i,strokeWidth:f,w:s,h,id:o,size:u,dash:l});if(l==="draw")return E.jsx($Y,{color:a,fill:i,strokeWidth:f,w:s,h,id:o,size:u});break}case"ellipse":{if(l==="solid")return E.jsx(jI,{strokeWidth:f,w:s,h,color:a,fill:i});if(l==="dashed"||l==="dotted")return E.jsx(zY,{id:o,strokeWidth:f,w:s,h,dash:l,color:a,fill:i});if(l==="draw")return E.jsx(jI,{strokeWidth:f,w:s,h,color:a,fill:i});break}case"oval":{if(l==="solid")return E.jsx(_I,{strokeWidth:f,w:s,h,color:a,fill:i});if(l==="dashed"||l==="dotted")return E.jsx(HY,{id:o,strokeWidth:f,w:s,h,dash:l,color:a,fill:i});if(l==="draw")return E.jsx(_I,{strokeWidth:f,w:s,h,color:a,fill:i});break}default:{const d=n.getShapeGeometry(t),p=d instanceof Ns?d.children[0].vertices:d.vertices,y=$x(t.props,f);if(l==="solid")return E.jsx(KY,{fill:i,color:a,strokeWidth:f,outline:p,lines:y});if(l==="dashed"||l==="dotted")return E.jsx(WY,{dash:l,fill:i,color:a,strokeWidth:f,outline:p,lines:y});if(l==="draw")return E.jsx(qY,{id:o,fill:i,color:a,strokeWidth:f,outline:p,lines:y})}}}const ys=17*3;class Mg extends cu{constructor(){super(...arguments);R(this,"canEdit",()=>!0);R(this,"onEditEnd",o=>{const{id:r,type:s,props:{text:a}}=o;a.trimEnd()!==o.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:a.trimEnd()}}])});R(this,"onResize",(o,{handle:r,newPoint:s,scaleX:a,scaleY:i,initialShape:l})=>{let c=l.props.w*a,u=(l.props.h+l.props.growY)*i,f=0,h=0;if(o.props.text.trim()){let g=Math.max(Math.abs(c),ys),b=Math.max(Math.abs(u),ys);g<ys&&b===ys&&(g=ys),g===ys&&b<ys&&(b=ys);const m=Tg(this.editor,{...o,props:{...o.props,w:g,h:b}}),v=Math.max(Math.abs(c),m.w)*Math.sign(c),x=Math.max(Math.abs(u),m.h)*Math.sign(u);f=Math.abs(v)-Math.abs(c),h=Math.abs(x)-Math.abs(u),c=v,u=x}const d=new q(0,0);a<0&&(d.x+=c),(r==="left"||r==="top_left"||r==="bottom_left")&&(d.x+=a<0?f:-f),i<0&&(d.y+=u),(r==="top"||r==="top_left"||r==="top_right")&&(d.y+=i<0?h:-h);const{x:p,y}=d.rot(o.rotation).add(s);return{x:p,y,props:{w:Math.max(Math.abs(c),1),h:Math.max(Math.abs(u),1),growY:0}}});R(this,"onBeforeCreate",o=>{if(!o.props.text)return o.props.growY?{...o,props:{...o.props,growY:0}}:void 0;const r=o.props.h,s=Tg(this.editor,o).h;let a=null;if(s>r?a=s-r:o.props.growY&&(a=0),a!==null)return{...o,props:{...o.props,growY:a}}});R(this,"onBeforeUpdate",(o,r)=>{const s=o.props.text,a=r.props.text;if(s===a&&o.props.font===r.props.font&&o.props.size===r.props.size)return;if(s&&!a)return{...r,props:{...r.props,growY:0}};const i=o.props.w,l=o.props.h,c=Tg(this.editor,r),u=c.w,f=c.h;if(!s&&a&&a.length===1){let d=Math.max(i,u),p=Math.max(l,f);return o.props.w<ys&&o.props.h<ys&&(d=Math.max(d,ys),p=Math.max(p,ys),d=Math.max(d,p),p=Math.max(d,p)),{...r,props:{...r.props,w:d,h:p,growY:0}}}let h=null;if(f>l?h=f-l:o.props.growY&&(h=0),h!==null)return{...r,props:{...r.props,growY:h,w:Math.max(r.props.w,u)}};if(u>o.props.w)return{...r,props:{...r.props,w:u}}});R(this,"onDoubleClick",o=>{if(this.editor.inputs.altKey)switch(o.props.geo){case"rectangle":return{...o,props:{geo:"check-box"}};case"check-box":return{...o,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(o){const r=Math.max(1,o.props.w),s=Math.max(1,o.props.h+o.props.growY),a=r/2,i=s/2,l=kn[o.props.size],c=o.props.fill!=="none";let u;switch(o.props.geo){case"cloud":{u=new hn({points:AY(r,s,o.id,o.props.size),isFilled:c});break}case"triangle":{u=new hn({points:[new q(a,0),new q(r,s),new q(0,s)],isFilled:c});break}case"diamond":{u=new hn({points:[new q(a,0),new q(r,i),new q(a,s),new q(0,i)],isFilled:c});break}case"pentagon":{u=new hn({points:Lb(r,s,5),isFilled:c});break}case"hexagon":{u=new hn({points:Lb(r,s,6),isFilled:c});break}case"octagon":{u=new hn({points:Lb(r,s,8),isFilled:c});break}case"ellipse":{u=new FP({width:r,height:s,isFilled:c});break}case"oval":{u=new Rz({width:r,height:s,isFilled:c});break}case"star":{const m=nr/5/2,v=Math.floor(5/4)*2,x=5*2-v,w=0,S=Math.floor(5/2)*2,k=Math.cos(-hr+v*m)*r/2,_=Math.cos(-hr+x*m)*r/2,C=Math.sin(-hr+w*m)*s/2,P=Math.sin(-hr+S*m)*s/2,A=r-Math.abs(k-_),I=s-Math.abs(P-C),N=r/2+_-(r/2-k),O=s/2+C-(s/2-P),F=1,U=(r-N)/2,G=(s-O)/2,Y=(r+A)/2,$=(s+I)/2,H=Y*F/2,Q=$*F/2;u=new hn({points:Array.from(Array(5*2)).map((J,ae)=>{const T=-hr+ae*m;return new q(U+(ae%2?H:Y)*Math.cos(T),G+(ae%2?Q:$)*Math.sin(T))}),isFilled:c});break}case"rhombus":{const m=Math.min(r*.38,s*.38);u=new hn({points:[new q(m,0),new q(r,0),new q(r-m,s),new q(0,s)],isFilled:c});break}case"rhombus-2":{const m=Math.min(r*.38,s*.38);u=new hn({points:[new q(0,0),new q(r-m,0),new q(r,s),new q(m,s)],isFilled:c});break}case"trapezoid":{const m=Math.min(r*.38,s*.38);u=new hn({points:[new q(m,0),new q(r-m,0),new q(r,s),new q(0,s)],isFilled:c});break}case"arrow-right":{const m=Math.min(r,s)*.38,v=s*.16;u=new hn({points:[new q(0,v),new q(r-m,v),new q(r-m,0),new q(r,s/2),new q(r-m,s),new q(r-m,s-v),new q(0,s-v)],isFilled:c});break}case"arrow-left":{const m=Math.min(r,s)*.38,v=s*.16;u=new hn({points:[new q(m,0),new q(m,v),new q(r,v),new q(r,s-v),new q(m,s-v),new q(m,s),new q(0,s/2)],isFilled:c});break}case"arrow-up":{const m=r*.16,v=Math.min(r,s)*.38;u=new hn({points:[new q(r/2,0),new q(r,v),new q(r-m,v),new q(r-m,s),new q(m,s),new q(m,v),new q(0,v)],isFilled:c});break}case"arrow-down":{const m=r*.16,v=Math.min(r,s)*.38;u=new hn({points:[new q(m,0),new q(r-m,0),new q(r-m,s-v),new q(r,s-v),new q(r/2,s),new q(0,s-v),new q(m,s-v)],isFilled:c});break}case"check-box":case"x-box":case"rectangle":{u=new Vi({width:r,height:s,isFilled:c});break}}const f=Tg(this.editor,o),h=Math.min(100,r/2),d=Math.min(r,Math.max(f.w,Math.min(h,Math.max(1,r-8)))),p=Math.min(Xi[o.props.size]*Rn.lineHeight+Vs*2,s/2),y=Math.min(s,Math.max(f.h,Math.min(p,Math.max(1,r-8)))),g=$x(o.props,l),b=g?g.map(m=>new Bl({points:m})):[];return new Ns({children:[u,new Vi({x:o.props.align==="start"?0:o.props.align==="end"?r-d:(r-d)/2,y:o.props.verticalAlign==="start"?0:o.props.verticalAlign==="end"?s-y:(s-y)/2,width:d,height:y,isFilled:!0,isLabel:!0}),...b]})}getHandleSnapGeometry(o){const r=this.getGeometry(o),s=r.children[0];switch(o.props.geo){case"arrow-down":case"arrow-left":case"arrow-right":case"arrow-up":case"check-box":case"diamond":case"hexagon":case"octagon":case"pentagon":case"rectangle":case"rhombus":case"rhombus-2":case"star":case"trapezoid":case"triangle":case"x-box":return{outline:s,points:[...s.getVertices(),r.bounds.center]};case"cloud":case"ellipse":case"oval":return{outline:s,points:[r.bounds.center]};default:Ri(o.props.geo)}}component(o){const{id:r,type:s,props:a}=o,{fill:i,font:l,align:c,verticalAlign:u,size:f,text:h}=a,d=o.id===this.editor.getOnlySelectedShapeId(),p=tn(),y=this.editor.getEditingShapeId()!==null||o.props.text;return E.jsxs(E.Fragment,{children:[E.jsx(Ha,{id:r,children:E.jsx(EI,{shape:o})}),y&&E.jsx(Vl,{style:{overflow:"hidden",width:o.props.w,height:o.props.h+a.growY},children:E.jsx(Sg,{id:r,type:s,font:l,fontSize:Xi[f],lineHeight:Rn.lineHeight,fill:i,align:c,verticalAlign:u,text:h,isSelected:d,labelColor:p[a.labelColor].solid,wrap:!0})}),o.props.url&&E.jsx(ku,{url:o.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(o){const{id:r,props:s}=o,{w:a,size:i}=s,l=s.h+s.growY,c=kn[i];switch(s.geo){case"ellipse":return s.dash==="draw"?E.jsx("path",{d:FY(r,a,l,c)}):E.jsx("ellipse",{cx:a/2,cy:l/2,rx:a/2,ry:l/2});case"oval":return E.jsx("path",{d:kI(a,l)});case"cloud":return E.jsx("path",{d:Wx(a,l,r,i)});default:{const u=this.editor.getShapeGeometry(o),f=u instanceof Ns?u.children[0].vertices:u.vertices;let h;if(s.dash==="draw"){const p=Hx(r,f,0,c*2,1);h=Vx(p)}else h="M"+f[0]+"L"+f.slice(1)+"Z";const d=$x(o.props,c);if(d)for(const[p,y]of d)h+=`M${p.x},${p.y}L${y.x},${y.y}`;return E.jsx("path",{d:h})}}}toSvg(o,r){const{props:s}=o;r.addExportDef(Rx(o.props.fill));let a;if(s.text){r.addExportDef(_u(o.props.font));const i=Bi(r),l=this.editor.getShapeGeometry(o).bounds;a=E.jsx(bg,{fontSize:Xi[s.size],font:s.font,align:s.align,verticalAlign:s.verticalAlign,text:s.text,labelColor:i[s.labelColor].solid,bounds:l})}return E.jsxs(E.Fragment,{children:[E.jsx(EI,{shape:o}),a]})}getCanvasSvgDefs(){return[Dx()]}}R(Mg,"type","geo"),R(Mg,"props",xE),R(Mg,"migrations",wE);function Tg(t,n){const o=n.props.text;if(!o)return{w:0,h:0};const r=t.textMeasure.measureText("w",{...Rn,fontFamily:di[n.props.font],fontSize:Xi[n.props.size],maxWidth:100}),s={s:2,m:3.5,l:5,xl:10},a=t.textMeasure.measureText(o,{...Rn,fontFamily:di[n.props.font],fontSize:Xi[n.props.size],minWidth:r.w,maxWidth:Math.max(0,Math.ceil(r.w+s[n.props.size]),Math.ceil(n.props.w-Vs*2))});return{w:a.w+Vs*2,h:a.h+Vs*2}}function XY(){const[t,n]=z.useState(!1);return z.useEffect(()=>{const o=CSS.supports("color","color(display-p3 1 1 1)"),r=matchMedia("(color-gamut: p3)");n(o&&r.matches);const s=()=>n(o&&r.matches);return r.addEventListener("change",s),()=>r.removeEventListener("change",s)},[]),We(jn.forceSrgb)||!t?"srgb":"p3"}const CI=.35,PI=.82;class Ig extends Us{constructor(){super(...arguments);R(this,"hideResizeHandles",o=>Og(o));R(this,"hideRotateHandle",o=>Og(o));R(this,"hideSelectionBoundsFg",o=>Og(o));R(this,"onResize",(o,r)=>{const{scaleX:s,scaleY:a}=r,i=[];for(const l of o.props.segments)i.push({...l,points:l.points.map(({x:c,y:u,z:f})=>({x:s*c,y:a*u,z:f}))});return{props:{segments:i}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(o){const r=Eu(o);if(Og(o))return new x1({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:s,sw:a}=MI(o,r,!0),i=Bx({strokeWidth:a,showAsComplete:!0});return ig(s,i),new hn({points:_x(s,i),isFilled:!0})}component(o){return E.jsx(Ha,{id:o.id,style:{opacity:CI},children:E.jsx(Ag,{strokeWidth:Eu(o),shape:o})})}backgroundComponent(o){return E.jsx(Ha,{id:o.id,style:{opacity:PI},children:E.jsx(Ag,{strokeWidth:Eu(o),shape:o})})}indicator(o){var h;const r=Ih(),s=Eu(o),a=Ah(o.props.segments);let i=s;!r&&!o.props.isPen&&a.length===1&&(i+=Ra(o.id)()*(s/6));const l=o.props.isComplete||((h=Yo(o.props.segments))==null?void 0:h.type)==="straight",c=Bx({strokeWidth:s,showAsComplete:l}),u=ui(a,c);let f;return u.length<2?f=ZY(a[0],i):f=Kl(u,!1),E.jsx("path",{d:f})}toSvg(o){return E.jsx(Ag,{strokeWidth:Eu(o),shape:o,opacity:CI})}toBackgroundSvg(o){return E.jsx(Ag,{strokeWidth:Eu(o),shape:o,opacity:PI})}}R(Ig,"type","highlight"),R(Ig,"props",_E),R(Ig,"migrations",kE);function QY(t){return`M ${t.x} ${t.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function ZY(t,n){const o=n/2;return`M ${t.x} ${t.y} m -${o}, 0 a ${o},${o} 0 1,0 ${o*2},0 a ${o},${o} 0 1,0 -${o*2},0`}function MI(t,n,o){var l;const r=Ah(t.props.segments),s=t.props.isComplete||((l=Yo(t.props.segments))==null?void 0:l.type)==="straight";let a=n;!o&&!t.props.isPen&&r.length===1&&(a+=Ra(t.id)()*(n/6));const i=Bx({strokeWidth:a,showAsComplete:s});return{strokePoints:ui(r,i),sw:a}}function JY(t,n,o){const{strokePoints:r,sw:s}=MI(t,n,o);return{solidStrokePath:r.length>1?Kl(r,!1):QY(t.props.segments[0].points[0]),sw:s}}function Ag({strokeWidth:t,shape:n,opacity:o}){const r=tn(),s=Ih(),{solidStrokePath:a,sw:i}=JY(n,t,s),l=XY(),c=r[n.props.color].highlight[l];return E.jsx("path",{d:a,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:c,strokeWidth:i,opacity:o})}function Eu(t){return bu[t.props.size]*1.12}function Og(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function TI(){return E.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3,11 L3,3 11,3",strokeWidth:"2"}),E.jsx("path",{d:"M19,27 L27,27 L27,19",strokeWidth:"2"}),E.jsx("path",{d:"M27,3 L3,27",strokeWidth:"2"})]})}function II(){const[t,n]=z.useState(!1);return z.useEffect(()=>{const o=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{n(o.matches)};return r(),o.addEventListener("change",r),()=>o.removeEventListener("change",r)},[]),t}async function eK(t){const n=await(await fetch(t)).blob();return Gc.blobToDataUrl(n)}class Lg extends cu{constructor(){super(...arguments);R(this,"isAspectRatioLocked",()=>!0);R(this,"canCrop",()=>!0);R(this,"onDoubleClick",o=>{const r=o.props.assetId?this.editor.getAsset(o.props.assetId):void 0;!r||!(r.props.src&&"mimeType"in r.props&&r.props.mimeType==="image/gif")||this.editor.updateShapes([{type:"image",id:o.id,props:{playing:!o.props.playing}}])});R(this,"onDoubleClickEdge",o=>{const r=o.props;if(!r||this.editor.getCroppingShapeId()!==o.id)return;const s=wr(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},a=1/(s.bottomRight.x-s.topLeft.x)*o.props.w,i=1/(s.bottomRight.y-s.topLeft.y)*o.props.h,l=new q(s.topLeft.x*a,s.topLeft.y*i).rot(o.rotation),c={id:o.id,type:o.type,x:o.x-l.x,y:o.y-l.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:a,h:i}};this.editor.updateShapes([c])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(o){var d,p;const r=this.editor.getCroppingShapeId()===o.id,s=II(),[a,i]=z.useState(""),l=o.props.assetId?this.editor.getAsset(o.props.assetId):void 0,c=o.id===this.editor.getOnlySelectedShapeId();if(z.useEffect(()=>{if(l!=null&&l.props.src&&"mimeType"in l.props&&(l==null?void 0:l.props.mimeType)==="image/gif"){let y=!1;const g=l.props.src;if(!g)return;const b=new Image;return b.onload=()=>{if(y)return;const m=document.createElement("canvas");m.width=b.width,m.height=b.height;const v=m.getContext("2d");v&&(v.drawImage(b,0,0),i(m.toDataURL()))},b.crossOrigin="anonymous",b.src=g,()=>{y=!0}}},[s,l==null?void 0:l.props]),(l==null?void 0:l.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const u=c&&r&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),f=s&&(((d=l==null?void 0:l.props.mimeType)==null?void 0:d.includes("video"))||((p=l==null?void 0:l.props.mimeType)==null?void 0:p.includes("gif"))),h=AI(o);return l!=null&&l.props.src?E.jsxs(E.Fragment,{children:[u&&E.jsx("div",{style:h,children:E.jsx("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!o.props.playing||f?a:l.props.src})`},draggable:!1})}),E.jsxs(Vl,{id:o.id,style:{overflow:"hidden",width:o.props.w,height:o.props.h},children:[E.jsxs("div",{className:"tl-image-container",style:h,children:[E.jsx("div",{className:"tl-image",style:{backgroundImage:`url(${!o.props.playing||f?a:l.props.src})`},draggable:!1}),l.props.isAnimated&&!o.props.playing&&E.jsx("div",{className:"tl-image__tg",children:"GIF"})]}),")",o.props.url&&E.jsx(ku,{url:o.props.url,zoomLevel:this.editor.getZoomLevel()})]})]}):E.jsxs(Vl,{id:o.id,style:{overflow:"hidden",width:o.props.w,height:o.props.h,color:"var(--color-text-3)",backgroundColor:l?"transparent":"var(--color-low)",border:l?"none":"1px solid var(--color-low-border)"},children:[E.jsx("div",{className:"tl-image-container",style:h,children:l?null:E.jsx(TI,{})}),")","url"in o.props&&o.props.url&&E.jsx(ku,{url:o.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(o){return this.editor.getCroppingShapeId()===o.id?null:E.jsx("rect",{width:ke(o.props.w),height:ke(o.props.h)})}async toSvg(o){const r=o.props.assetId?this.editor.getAsset(o.props.assetId):null;if(!r)return null;let s=(r==null?void 0:r.props.src)||"";(s.startsWith("http")||s.startsWith("/")||s.startsWith("./"))&&(s=await eK(s)||"");const a=AI(o),i=o.props.crop;if(a.transform&&i){const{transform:l,width:c,height:u}=a,f=(i.bottomRight.x-i.topLeft.x)*c,h=(i.bottomRight.y-i.topLeft.y)*u,d=[new q(0,0),new q(f,0),new q(f,h),new q(0,h)],p=`cropClipPath_${o.id.replace(":","_")}`;return E.jsxs(E.Fragment,{children:[E.jsx("defs",{children:E.jsx("clipPath",{id:p,children:E.jsx("polygon",{points:d.map(y=>`${y.x},${y.y}`).join(" ")})})}),E.jsx("g",{clipPath:"url(#{cropClipId})",children:E.jsx("image",{href:s,width:c,height:u,style:{transform:l}})})]})}else return E.jsx("image",{href:s,width:o.props.w,height:o.props.h})}}R(Lg,"type","image"),R(Lg,"props",EE),R(Lg,"migrations",CE);function AI(t){const n=t.props.crop,o=n==null?void 0:n.topLeft;if(!o)return{width:t.props.w,height:t.props.h};const r=1/(n.bottomRight.x-n.topLeft.x)*t.props.w,s=1/(n.bottomRight.y-n.topLeft.y)*t.props.h,a=-o.x*r,i=-o.y*s;return{transform:`translate(${a}px, ${i}px)`,width:r,height:s}}function OI(t,n){const{start:o,end:r}=t;return n?`M${ke(o.x)},${ke(o.y)} L${ke(r.x)},${ke(r.y)} `:`${ke(r.x)},${ke(r.y)} `}function LI(t,n){const{a:o,b:r,c:s,d:a}=t;return q.Equals(o,a)?"":`${n?`M${ke(o.x)},${ke(o.y)}`:""}C${ke(r.x)},${ke(r.y)} ${ke(s.x)},${ke(s.y)} ${ke(a.x)},${ke(a.y)}`}function tK(t,n){let o=t.segments.reduce((r,s,a)=>r+LI(s,a===0),"");return n&&(o+="Z"),o}function rK(t,n){let o=t.segments.reduce((r,s,a)=>r+OI(s,a===0),"");return n&&(o+="Z"),o}function RI(t,n=!1){return t instanceof Bl?rK(t,n):tK(t,n)}function DI(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function FI(t,n,o){const r=n.vertices,s=DI(o);return ui(r,s)}function nK(t,n,o){const r=DI(o);return _x(ig(FI(t,n,o),r),r)}function oK(t,n,o){const r=nK(t,n,o);return Kb(r)}function sK(t,n,o){if(t.props.dash==="draw"){const r=FI(t,n,o);return Kl(r)}return RI(n)}const iK=new Em;class Rg extends Us{constructor(){super(...arguments);R(this,"hideResizeHandles",()=>!0);R(this,"hideRotateHandle",()=>!0);R(this,"hideSelectionBoundsFg",()=>!0);R(this,"hideSelectionBoundsBg",()=>!0);R(this,"onResize",(o,r)=>{const{scaleX:s,scaleY:a}=r;return{props:{points:Uf(o.props.points,(i,{id:l,index:c,x:u,y:f})=>({id:l,index:c,x:u*s,y:f*a}))}}});R(this,"onHandleDrag",(o,{handle:r})=>{if(r.type==="vertex")return{...o,props:{...o.props,points:{...o.props.points,[r.id]:{id:r.id,index:r.index,x:r.x,y:r.y}}}}})}getDefaultProps(){const[o,r]=Vd(2);return{dash:"draw",size:"m",color:"black",spline:"line",points:{[o]:{id:o,index:o,x:0,y:0},[r]:{id:r,index:r,x:.1,y:.1}}}}getGeometry(o){return Oh(o)}getHandles(o){return iK.get(o.props,()=>{const r=Oh(o),s=qx(o),a=s.map(i=>({...i,id:i.index,type:"vertex",canSnap:!0}));for(let i=0;i<s.length-1;i++){const l=Gd(s[i].index,s[i+1].index),c=r.segments[i].midPoint();a.push({id:l,type:"create",index:l,x:c.x,y:c.y,canSnap:!0})}return a.sort($n)})}component(o){return E.jsx(Ha,{id:o.id,children:E.jsx(NI,{shape:o})})}indicator(o){const r=kn[o.props.size],s=Oh(o),{dash:a}=o.props;let i;if(o.props.spline==="line"){const l=s.points;if(a==="solid"||a==="dotted"||a==="dashed")i="M"+l[0]+"L"+l.slice(1);else{const[c]=bI(o.id,l,r);i=c}}else i=sK(o,s,r);return E.jsx("path",{d:i})}toSvg(o){return E.jsx(NI,{shape:o})}getHandleSnapGeometry(o){const r=qx(o);return{points:r,getSelfSnapPoints:s=>{const a=this.getHandles(o).filter(i=>i.type==="vertex").findIndex(i=>i.id===s.id);return r.filter((i,l)=>Math.abs(l-a)>1).map(q.From)},getSelfSnapOutline:s=>{const a=this.getHandles(o).filter(l=>l.type==="vertex").findIndex(l=>l.id===s.id),i=Oh(o).segments.filter((l,c)=>c!==a-1&&c!==a);return i.length?new Ns({children:i}):null}}}}R(Rg,"type","line"),R(Rg,"props",PE),R(Rg,"migrations",ME);function qx(t){return Object.values(t.props.points).sort($n)}function Oh(t){const n=qx(t).map(q.From);switch(t.props.spline){case"cubic":return new Lz({points:n});case"line":return new Bl({points:n})}}function NI({shape:t}){const n=tn(),o=Oh(t),r=kn[t.props.size],{dash:s,color:a}=t.props;if(t.props.spline==="line"){if(s==="solid"){const i=o.points,l="M"+i[0]+"L"+i.slice(1);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:l,fill:"none",color:a,theme:n}),E.jsx("path",{d:l,stroke:n[a].solid,strokeWidth:r,fill:"none"})]})}if(s==="dashed"||s==="dotted"){const i=o.points,l="M"+i[0]+"L"+i.slice(1);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:l,fill:"none",color:a,theme:n}),E.jsx("g",{stroke:n[a].solid,strokeWidth:r,children:o.segments.map((c,u)=>{const{strokeDasharray:f,strokeDashoffset:h}=Qi(c.length,r,{style:s,start:u>0?"outset":"none",end:u<o.segments.length-1?"outset":"none"});return E.jsx("path",{strokeDasharray:f,strokeDashoffset:h,d:OI(c,!0),fill:"none"},u)})})]})}if(s==="draw"){const i=o.points,[l,c]=bI(t.id,i,r);return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:l,fill:"none",color:a,theme:n}),E.jsx("path",{d:c,stroke:n[a].solid,strokeWidth:r,fill:"none"})]})}}if(t.props.spline==="cubic"){const i=RI(o);if(s==="solid")return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:i,fill:"none",color:a,theme:n}),E.jsx("path",{strokeWidth:r,stroke:n[a].solid,fill:"none",d:i})]});if(s==="dashed"||s==="dotted")return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:i,fill:"none",color:a,theme:n}),E.jsx("g",{stroke:n[a].solid,strokeWidth:r,children:o.segments.map((l,c)=>{const{strokeDasharray:u,strokeDashoffset:f}=Qi(l.length,r,{style:s,start:c>0?"outset":"none",end:c<o.segments.length-1?"outset":"none"});return E.jsx("path",{strokeDasharray:u,strokeDashoffset:f,d:LI(l,!0),fill:"none"},c)})})]});if(s==="draw")return E.jsxs(E.Fragment,{children:[E.jsx(pn,{d:i,fill:"none",color:a,theme:n}),E.jsx("path",{d:oK(t,o,r),strokeWidth:1,stroke:n[a].solid,fill:n[a].solid})]})}}const UI=z.createContext(null);function aK({assetUrls:t,children:n}){return z.useEffect(()=>{for(const o of Object.values(t.icons)){const r=new Image;r.src=o,r.decode()}for(const o of Object.values(t.embedIcons)){const r=new Image;r.src=o,r.decode()}},[t]),E.jsx(UI.Provider,{value:t,children:n})}function Yx(){const t=z.useContext(UI);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const Kx={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.export-all-as-json.short":"JSON","action.export-all-as-json":"Export as JSON","action.export-all-as-png.short":"PNG","action.export-all-as-png":"Export as PNG","action.export-all-as-svg.short":"SVG","action.export-all-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rename":"Rename","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-wrap-mode.menu":"Select on wrap","action.toggle-wrap-mode":"Toggle Select on wrap","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","assets.files.upload-failed":"Upload failed","assets.url.failed":"Couldn't load URL preview","color-style.white":"White","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","document.default-name":"Untitled","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","verticalAlign-style.start":"Top","verticalAlign-style.middle":"Middle","verticalAlign-style.end":"Bottom","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.export-all-as":"Export","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},lK=new Set(["ar","fa","he","ur","ku"]),Cu={locale:"en",label:"English",messages:Kx,dir:"ltr"};async function cK(t,n){if(!(await fetch(n.translations.en)).ok)return console.warn("No main translations found."),Cu;if(t==="en")return Cu;const o=Jd.find(a=>a.locale===t);if(!o)return console.warn(`No translation found for locale ${t}`),Cu;const r=await(await fetch(n.translations[o.locale])).json();if(!r)return console.warn(`No messages found for locale ${t}`),Cu;const s=[];for(const a in Cu.messages)r[a]||s.push(a);return s.length>0,{locale:t,label:o.label,dir:lK.has(o.locale)?"rtl":"ltr",messages:{...Cu.messages,...r}}}const BI=z.createContext({}),zI=()=>z.useContext(BI),uK=qo(function({overrides:t,children:n}){const o=Be().user.getLocale(),r=Yx(),[s,a]=z.useState(()=>t&&t.en?{locale:"en",label:"English",dir:"ltr",messages:{...Kx,...t.en}}:{locale:"en",label:"English",dir:"ltr",messages:Kx});return z.useEffect(()=>{let i=!1;async function l(){const c=await cK(o,r);c&&!i&&(t&&t[o]?a({...c,messages:{...c.messages,...t[o]}}):a(c))}return l(),()=>{i=!0}},[r,o,t]),E.jsx(BI.Provider,{value:s,children:n})});function tr(){const t=zI();return z.useCallback(function(n){return t.messages[n]??n},[t])}class Dg extends Us{constructor(){super(...arguments);R(this,"canEdit",()=>!0);R(this,"hideResizeHandles",()=>!0);R(this,"hideSelectionBoundsFg",()=>!1);R(this,"onBeforeCreate",o=>GI(this.editor,o));R(this,"onBeforeUpdate",(o,r)=>{if(!(o.props.text===r.props.text&&o.props.font===r.props.font&&o.props.size===r.props.size))return GI(this.editor,r)});R(this,"onEditEnd",o=>{const{id:r,type:s,props:{text:a}}=o;a.trimEnd()!==o.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:a.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,fontSizeAdjustment:0,url:""}}getGeometry(o){const r=Fg(o),{labelHeight:s,labelWidth:a}=VI(this.editor,o);return new Ns({children:[new Vi({width:er,height:r,isFilled:!0}),new Vi({x:o.props.align==="start"?0:o.props.align==="end"?er-a:(er-a)/2,y:o.props.verticalAlign==="start"?0:o.props.verticalAlign==="end"?r-s:(r-s)/2,width:a,height:s,isFilled:!0,isLabel:!0})]})}getHandles(o){const r=this.editor.getZoomLevel(),s=Iq/r,a=Fg(o),i=this.editor.getInstanceState().isCoarsePointer;return r<.25||i?[]:r<.5?[{id:"bottom",index:"a3",type:"clone",x:er/2,y:a+s}]:[{id:"top",index:"a1",type:"clone",x:er/2,y:-s},{id:"right",index:"a2",type:"clone",x:er+s,y:a/2},{id:"bottom",index:"a3",type:"clone",x:er/2,y:a+s},{id:"left",index:"a4",type:"clone",x:-s,y:a/2}]}component(o){const{id:r,type:s,props:{color:a,font:i,size:l,align:c,text:u,verticalAlign:f,fontSizeAdjustment:h}}=o,d=pK(r),p=tn(),y=Fg(o),g=We("shape rotation",()=>{var v;return((v=this.editor.getShapePageTransform(r))==null?void 0:v.rotation())??0},[this.editor]),b=Ih(),m=o.id===this.editor.getOnlySelectedShapeId();return E.jsxs(E.Fragment,{children:[E.jsx("div",{id:r,className:"tl-note__container",style:{width:er,height:y,backgroundColor:p[a].note.fill,borderBottom:b?"3px solid rgb(15, 23, 31, .2)":"none",boxShadow:b?"none":fK(o.id,g)},children:E.jsx(Sg,{id:r,type:s,font:i,fontSize:h||Xi[l],lineHeight:Rn.lineHeight,align:c,verticalAlign:f,text:u,isNote:!0,isSelected:m,labelColor:p[a].note.text,wrap:!0,onKeyDown:d})}),"url"in o.props&&o.props.url&&E.jsx(ku,{url:o.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(o){return E.jsx("rect",{rx:"1",width:ke(er),height:ke(Fg(o))})}toSvg(o,r){r.addExportDef(_u(o.props.font)),o.props.text&&r.addExportDef(_u(o.props.font));const s=Bi({isDarkMode:r.isDarkMode}),a=this.editor.getShapeGeometry(o).bounds;return E.jsxs(E.Fragment,{children:[E.jsx("rect",{x:5,y:5,rx:1,width:er-10,height:a.h,fill:"rgba(0,0,0,.1)"}),E.jsx("rect",{rx:1,width:er,height:a.h,fill:s[o.props.color].note.fill}),E.jsx(bg,{fontSize:o.props.fontSizeAdjustment||Xi[o.props.size],font:o.props.font,align:o.props.align,verticalAlign:o.props.verticalAlign,text:o.props.text,labelColor:s[o.props.color].note.text,bounds:a,stroke:!1})]})}}R(Dg,"type","note"),R(Dg,"props",TE),R(Dg,"migrations",IE);function GI(t,n){const{labelHeight:o,fontSizeAdjustment:r}=VI(t,n),s=Math.max(0,o-er);if(s!==n.props.growY||r!==n.props.fontSizeAdjustment)return{...n,props:{...n.props,growY:s,fontSizeAdjustment:r}}}function dK(t,n){const o=n.props.text;if(!o)return{labelHeight:Xi[n.props.size]*Rn.lineHeight+Vs*2,labelWidth:100,fontSizeAdjustment:0};const r=Xi[n.props.size];let s=0,a=0,i=er,l=er;const c=1;do{s=Math.min(r,r-a);const u=t.textMeasure.measureText(o,{...Rn,fontFamily:di[n.props.font],fontSize:s,maxWidth:er-Vs*2-c,disableOverflowWrapBreaking:!0});if(i=u.h+Vs*2,l=u.w+Vs*2,s<=14){const f=t.textMeasure.measureText(o,{...Rn,fontFamily:di[n.props.font],fontSize:s,maxWidth:er-Vs*2-c});i=f.h+Vs*2,l=f.w+Vs*2;break}if(u.scrollWidth.toFixed(0)===u.w.toFixed(0))break}while(a++<50);return{labelHeight:i,labelWidth:l,fontSizeAdjustment:s}}const hK=new Em;function VI(t,n){return hK.get(n,()=>dK(t,n))}function pK(t){const n=Be(),o=zI();return z.useCallback(r=>{const s=n.getShape(t);if(!s)return;const a=r.key==="Tab",i=(r.metaKey||r.ctrlKey)&&r.key==="Enter";if(a||i){r.preventDefault();const l=n.getShapePageTransform(t),c=l.rotation(),u=!!(o.dir==="rtl"||zT(s.props.text)),f=er+Yl+(i&&!r.shiftKey?s.props.growY:0),h=new q(a?r.shiftKey!=u?-1:1:0,i?r.shiftKey?-1:1:0).mul(f).add(Ox).rot(c).add(l.point()),d=QT(n,s,h,c);d&&(n.mark("editing adjacent shape"),gg(n,d,!0))}},[t,n,o.dir])}function Fg(t){return er+t.props.growY}function fK(t,n){const o=Ra(t),r=Math.abs(o())+.5,s=Math.cos(n);return`0px ${5-r}px 5px -5px rgba(15, 23, 31, .6),
	0px ${(4+r*7)*Math.max(0,s)}px ${6+r*7}px -${4+r*6}px rgba(15, 23, 31, ${(.3+r*.1).toFixed(2)}), 
	0px 48px 10px -10px inset rgba(15, 23, 44, ${((.022+o()*.005)*((1+s)/2)).toFixed(2)})`}function mK(t,{initialBounds:n,scaleX:o,scaleY:r,newPoint:s}){const a=Math.max(.01,Math.min(Math.abs(o),Math.abs(r))),i=new q(0,0);o<0&&(i.x=-(n.width*a)),r<0&&(i.y=-(n.height*a));const{x:l,y:c}=q.Add(s,i.rot(t.rotation));return{x:l,y:c,props:{scale:a*t.props.scale}}}const gK=new Em;class Ng extends Us{constructor(){super(...arguments);R(this,"canEdit",()=>!0);R(this,"isAspectRatioLocked",()=>!0);R(this,"onResize",(o,r)=>{const{initialBounds:s,initialShape:a,scaleX:i,handle:l}=r;if(r.mode==="scale_shape"||l!=="right"&&l!=="left")return{id:o.id,type:o.type,...mK(o,r)};{const c=s.width;let u=c*i;const f=new q(0,0);u=Math.max(1,Math.abs(u)),l==="left"?(f.x=c-u,i<0&&(f.x+=u)):i<0&&(f.x-=u);const{x:h,y:d}=f.rot(o.rotation).add(a);return{id:o.id,type:o.type,x:h,y:d,props:{w:u/a.props.scale,autoSize:!1}}}});R(this,"onBeforeCreate",o=>{if(!o.props.autoSize||o.props.text.trim())return;const r=this.getMinDimensions(o);return{...o,x:o.x-r.width/2,y:o.y-r.height/2}});R(this,"onEditEnd",o=>{const{id:r,type:s,props:{text:a}}=o,i=o.props.text.trimEnd();i.length===0?this.editor.deleteShapes([o.id]):i!==o.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:a.trimEnd()}}])});R(this,"onBeforeUpdate",(o,r)=>{if(!r.props.autoSize)return;const s=o.props.size!==r.props.size||o.props.align!==r.props.align||o.props.font!==r.props.font||o.props.scale!==1&&r.props.scale===1,a=o.props.text!==r.props.text;if(!s&&!a)return;const i=this.getMinDimensions(o),l=HI(this.editor,r.props),c=i.width*o.props.scale,u=i.height*o.props.scale,f=l.width*r.props.scale,h=l.height*r.props.scale;let d;switch(r.props.align){case"middle":{d=new q((f-c)/2,a?0:(h-u)/2);break}case"end":{d=new q(f-c,a?0:(h-u)/2);break}default:{if(a)break;d=new q(0,(h-u)/2);break}}if(d){d.rot(r.rotation);const{x:p,y}=r;return{...r,x:p-d.x,y:y-d.y,props:{...r.props,w:f}}}else return{...r,props:{...r.props,w:f}}});R(this,"onDoubleClickEdge",o=>{if(!o.props.autoSize)return{id:o.id,type:o.type,props:{autoSize:!0}};if(o.props.scale!==1)return{id:o.id,type:o.type,props:{scale:1}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(o){return gK.get(o.props,r=>HI(this.editor,r))}getGeometry(o){const{scale:r}=o.props,{width:s,height:a}=this.getMinDimensions(o);return new Vi({width:s*r,height:a*r,isFilled:!0,isLabel:!0})}component(o){const{id:r,props:{font:s,size:a,text:i,color:l,scale:c,align:u}}=o,{width:f,height:h}=this.getMinDimensions(o),d=o.id===this.editor.getOnlySelectedShapeId(),p=tn(),y=yK(r);return E.jsx(Sg,{id:r,classNamePrefix:"tl-text-shape",type:"text",font:s,fontSize:bu[a],lineHeight:Rn.lineHeight,align:u,verticalAlign:"middle",text:i,labelColor:p[l].solid,isSelected:d,textWidth:f,textHeight:h,style:{transform:`scale(${c})`,transformOrigin:"top left"},wrap:!0,onKeyDown:y})}indicator(o){const r=this.editor.getShapeGeometry(o).bounds,s=Be();return o.props.autoSize&&s.getEditingShapeId()===o.id?null:E.jsx("rect",{width:ke(r.width),height:ke(r.height)})}toSvg(o,r){r.addExportDef(_u(o.props.font)),o.props.text&&r.addExportDef(_u(o.props.font));const s=this.editor.getShapeGeometry(o).bounds,a=s.width/(o.props.scale??1),i=s.height/(o.props.scale??1),l=Bi(r);return E.jsx(bg,{fontSize:bu[o.props.size],font:o.props.font,align:o.props.align,verticalAlign:"middle",text:o.props.text,labelColor:l[o.props.color].solid,bounds:new mt(0,0,a,i),padding:0})}}R(Ng,"type","text"),R(Ng,"props",AE),R(Ng,"migrations",OE);function HI(t,n){const{font:o,text:r,autoSize:s,size:a,w:i}=n,l=s?16:Math.max(16,i),c=bu[a],u=s?null:Math.floor(Math.max(l,i)),f=t.textMeasure.measureText(r,{...Rn,fontFamily:di[o],fontSize:c,maxWidth:u});return s&&(f.w+=1),{width:Math.max(l,f.w),height:Math.max(c,f.h)}}function yK(t){const n=Be();return z.useCallback(o=>{if(n.getEditingShapeId()===t)switch(o.key){case"Enter":{(o.ctrlKey||o.metaKey)&&n.complete();break}case"Tab":{Xt(o),o.shiftKey?Su.unindent(o.currentTarget):Su.indent(o.currentTarget);break}}},[n,t])}class Ug extends cu{constructor(){super(...arguments);R(this,"canEdit",()=>!0);R(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(o){const{editor:r}=this,s=r.getShapeGeometry(o).bounds.w*r.getZoomLevel()>=110,a=o.props.assetId?r.getAsset(o.props.assetId):null,{time:i,playing:l}=o.props,c=zm(o.id),u=II(),f=z.useRef(null),h=z.useCallback(m=>{const v=m.currentTarget;v&&r.updateShapes([{type:"video",id:o.id,props:{playing:!0,time:v.currentTime}}])},[o.id,r]),d=z.useCallback(m=>{const v=m.currentTarget;v&&r.updateShapes([{type:"video",id:o.id,props:{playing:!1,time:v.currentTime}}])},[o.id,r]),p=z.useCallback(m=>{const v=m.currentTarget;v&&c&&r.updateShapes([{type:"video",id:o.id,props:{time:v.currentTime}}])},[c,o.id,r]),[y,g]=z.useState(!1),b=z.useCallback(m=>{const v=m.currentTarget;v&&(i!==v.currentTime&&(v.currentTime=i),l||v.pause(),g(!0))},[l,i]);return z.useEffect(()=>{const m=f.current;m&&(y&&!c&&i!==m.currentTime&&(m.currentTime=i),c&&document.activeElement!==m&&m.focus())},[c,y,i]),z.useEffect(()=>{if(u){const m=f.current;if(!m)return;m.pause(),m.currentTime=0}},[f,u]),E.jsxs(E.Fragment,{children:[E.jsx(Vl,{id:o.id,style:{color:"var(--color-text-3)",backgroundColor:a?"transparent":"var(--color-low)",border:a?"none":"1px solid var(--color-low-border)"},children:E.jsx("div",{className:"tl-counter-scaled",children:E.jsx("div",{className:"tl-video-container",children:a!=null&&a.props.src?E.jsx("video",{ref:f,style:c?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${o.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:c&&s,onPlay:h,onPause:d,onTimeUpdate:p,onLoadedData:b,hidden:!y,children:E.jsx("source",{src:a.props.src})}):E.jsx(TI,{})})})}),"url"in o.props&&o.props.url&&E.jsx(ku,{url:o.props.url,zoomLevel:r.getZoomLevel()})]})}indicator(o){return E.jsx("rect",{width:ke(o.props.w),height:ke(o.props.h)})}toSvg(o){return E.jsx("image",{href:vK(o.id),width:o.props.w,height:o.props.h})}}R(Ug,"type","video"),R(Ug,"props",LE),R(Ug,"migrations",DE);function vK(t){const n=t.split(":")[1],o=document.querySelector(`.tl-video-shape-${n}`);if(o){const r=document.createElement("canvas");return r.width=o.videoWidth,r.height=o.videoHeight,r.getContext("2d").drawImage(o,0,0),r.toDataURL("image/png")}else throw new Error("Video with not found when attempting serialization.")}const WI=[Ng,_g,kg,Mg,Dg,Rg,Cg,jg,Ig,Eg,Lg,Ug];function bK(t){return[t.sideEffects.registerAfterChangeHandler("instance",(n,o)=>{n.isFocused!==o.isFocused&&(o.isFocused?t.getContainer().focus():(t.complete(),t.getContainer().blur()))}),t.sideEffects.registerAfterChangeHandler("instance_page_state",(n,o)=>{if(n.croppingShapeId!==o.croppingShapeId){const r=t.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!n.croppingShapeId&&o.croppingShapeId?r||t.setCurrentTool("select.crop.idle"):n.croppingShapeId&&!o.croppingShapeId&&r&&t.setCurrentTool("select.idle")}n.editingShapeId!==o.editingShapeId&&(!n.editingShapeId&&o.editingShapeId?t.isIn("select.editing_shape")||t.setCurrentTool("select.editing_shape"):n.editingShapeId&&!o.editingShapeId&&t.isIn("select.editing_shape")&&t.setCurrentTool("select.idle"))})]}class $I extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"scribbleId","id");R(this,"markId","");R(this,"excludedShapeIds",new Set);R(this,"onEnter",o=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=o;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(a=>{if(this.editor.isShapeOrAncestorLocked(a))return!0;if(this.editor.isShapeOfType(a,"group")||this.editor.isShapeOfType(a,"frame")){const i=this.editor.getPointInShapeSpace(a,r);return this.editor.getShapeGeometry(a).bounds.containsPoint(i)}return!1}).map(a=>a.id));const s=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=s.id,this.update()});R(this,"pushPointToScribble",()=>{const{x:o,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,o,r)});R(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});R(this,"onPointerMove",()=>{this.update()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()})}update(){const{editor:o,excludedShapeIds:r}=this,s=o.getErasingShapeIds(),a=o.getZoomLevel(),i=o.getCurrentPageShapes(),{inputs:{currentPagePoint:l,previousPagePoint:c}}=o;this.pushPointToScribble();const u=new Set(s),f=Gi/a;for(const h of i){if(o.isShapeOfType(h,"group"))continue;const d=o.getShapeMask(h.id);if(d&&!es(l,d))continue;const p=o.getShapeGeometry(h),y=o.getShapePageTransform(h);if(!p||!y)continue;const g=y.clone().invert(),b=g.applyToPoint(c),m=g.applyToPoint(l),{bounds:v}=p;v.minX-f>Math.max(b.x,m.x)||v.minY-f>Math.max(b.y,m.y)||v.maxX+f<Math.min(b.x,m.x)||v.maxY+f<Math.min(b.y,m.y)||p.hitTestLineSegment(b,m,f)&&u.add(o.getOutermostSelectableShape(h).id)}this.editor.setErasingShapes([...u].filter(h=>!r.has(h)))}complete(){const{editor:o}=this;o.deleteShapes(o.getCurrentPageState().erasingShapeIds),o.setErasingShapes([]),this.parent.transition("idle")}cancel(){const{editor:o}=this;o.setErasingShapes([]),o.bailToMark(this.markId),this.parent.transition("idle",this.info)}}R($I,"id","erasing");let xK=(jS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(jS,"id","idle"),jS),wK=(_S=class extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{const n=this.editor.getZoomLevel(),o=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:r}}=this.editor,s=new Set,a=s.size;for(let i=o.length,l=i-1;l>=0;l--){const c=o[l];if(!(this.editor.isShapeOrAncestorLocked(c)||this.editor.isShapeOfType(c,"group"))&&this.editor.isPointInShape(c,r,{hitInside:!1,margin:Gi/n})){const u=this.editor.getOutermostSelectableShape(c);if(this.editor.isShapeOfType(u,"frame")&&s.size>a)break;s.add(u.id)}}this.editor.setErasingShapes([...s])});R(this,"onLongPress",n=>{this.startErasing(n)});R(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startErasing(n)});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.cancel()})}startErasing(n){this.parent.transition("erasing",n)}complete(){const n=this.editor.getErasingShapeIds();n.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(n)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}},R(_S,"id","pointing"),_S);class Bg extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}R(Bg,"id","eraser"),R(Bg,"initial","idle"),R(Bg,"children",()=>[xK,wK,$I]);class qI extends bt{constructor(){super(...arguments);R(this,"initialCamera",new q);R(this,"onEnter",()=>{this.initialCamera=q.From(this.editor.getCamera()),this.update()});R(this,"onPointerMove",()=>{this.update()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.parent.transition("idle")});R(this,"onComplete",()=>{this.complete()})}update(){const{initialCamera:o,editor:r}=this,{currentScreenPoint:s,originScreenPoint:a}=r.inputs,i=q.Sub(s,a).div(r.getZoomLevel());i.len2()!==0&&r.setCamera(o.clone().add(i))}complete(){const{editor:o}=this,{pointerVelocity:r}=o.inputs,s=Math.min(r.len(),2);s>.1&&this.editor.slideCamera({speed:s,direction:r,friction:fm}),this.parent.transition("idle")}}R(qI,"id","dragging");let SK=(kS=class extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.editor.setCursor({type:"grab",rotation:0})});R(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});R(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},R(kS,"id","idle"),kS),jK=(ES=class extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});R(this,"onLongPress",()=>{this.startDragging()});R(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startDragging()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.complete()})}startDragging(){this.parent.transition("dragging")}complete(){this.parent.transition("idle")}},R(ES,"id","pointing"),ES);class zg extends bt{constructor(){super(...arguments);R(this,"onDoubleClick",o=>{if(o.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{duration:220,easing:Kn.easeOutQuint})}});R(this,"onTripleClick",o=>{if(o.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{duration:320,easing:Kn.easeOutQuint})}});R(this,"onQuadrupleClick",o=>{if(o.phase==="settle"){const r=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:s}}=this.editor;r===1?this.editor.zoomToFit({duration:400,easing:Kn.easeOutQuint}):this.editor.resetZoom(s,{duration:320,easing:Kn.easeOutQuint})}})}}R(zg,"id","hand"),R(zg,"initial","idle"),R(zg,"children",()=>[SK,jK,qI]);let _K=(CS=class extends bt{constructor(){super(...arguments);R(this,"onPointerDown",n=>{this.parent.transition("lasering",n)})}},R(CS,"id","idle"),CS);class YI extends bt{constructor(){super(...arguments);R(this,"scribbleId","id");R(this,"onEnter",()=>{const o=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=o.id,this.pushPointToScribble()});R(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});R(this,"onPointerMove",()=>{this.pushPointToScribble()});R(this,"onPointerUp",()=>{this.complete()});R(this,"pushPointToScribble",()=>{const{x:o,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,o,r)});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}R(YI,"id","lasering");class Gg extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}R(Gg,"id","laser"),R(Gg,"initial","idle"),R(Gg,"children",()=>[_K,YI]);class KI extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"initialSelectedShapeIds",[]);R(this,"excludedShapeIds",new Set);R(this,"isWrapMode",!1);R(this,"initialStartShape",null);R(this,"onEnter",o=>{const{altKey:r,currentPagePoint:s}=this.editor.inputs;if(this.isWrapMode=this.editor.user.getIsWrapMode(),r){this.parent.transition("scribble_brushing",o);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(a=>this.editor.isShapeOfType(a,"group")||this.editor.isShapeOrAncestorLocked(a)).map(a=>a.id)),this.info=o,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(s)[0],this.hitTestShapes()});R(this,"onExit",()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})});R(this,"onTick",()=>{w1(this.editor)});R(this,"onPointerMove",()=>{this.hitTestShapes()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",o=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",o)});R(this,"onKeyDown",o=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",o):this.hitTestShapes()});R(this,"onKeyUp",()=>{this.hitTestShapes()});R(this,"onInterrupt",()=>{this.editor.updateInstanceState({brush:null})})}complete(){this.hitTestShapes(),this.parent.transition("idle")}hitTestShapes(){const{editor:o,excludedShapeIds:r,isWrapMode:s}=this,{inputs:{originPagePoint:a,currentPagePoint:i,shiftKey:l,ctrlKey:c}}=o,u=new Set(l?this.initialSelectedShapeIds:[]),f=s?!c:c,h=mt.FromPoints([a,i]),{corners:d}=h;let p,y,g,b,m,v;const x=o.getCurrentPageShapes(),w=o.getCurrentPageId();e:for(let _=0,C=x.length;_<C;_++){if(g=x[_],r.has(g.id)||u.has(g.id)||(b=o.getShapePageBounds(g),!b))continue e;if(h.contains(b)){this.handleHit(g,i,w,u,d);continue e}if(f||o.isShapeOfType(g,"frame"))continue e;if(h.collides(b)){if(m=o.getShapePageTransform(g),!m)continue e;v=m.clone().invert().applyToPoints(d);const P=o.getShapeGeometry(g);t:for(let A=0;A<4;A++)if(p=v[A],y=v[(A+1)%4],P.hitTestLineSegment(p,y,0)){this.handleHit(g,i,w,u,d);break t}}}o.getInstanceState().isCoarsePointer;const S=o.getInstanceState().brush;(!S||!h.equals(S))&&o.updateInstanceState({brush:{...h.toJson()}});const k=o.getSelectedShapeIds();(k.length!==u.size||k.some(_=>!u.has(_)))&&o.setSelectedShapes(Array.from(u),{squashing:!0})}handleHit(o,r,s,a,i){if(o.parentId===s){a.add(o.id);return}const l=this.editor.getOutermostSelectableShape(o),c=this.editor.getShapeMask(l.id);c&&!eP(c,i)&&!es(r,c)||a.add(l.id)}}R(KI,"id","brushing");function Xx(t,n=!1){const o=t.getZoomLevel(),{inputs:{currentPagePoint:r}}=t;return t.getShapeAtPoint(r,{hitInside:!1,hitLabels:n,margin:Gi/o,renderingOnly:!0})??t.getSelectedShapeAtPoint(r)}function XI(t,n,o){if(!n)throw Error("Needs to translate a cropped shape!");const{crop:r}=n.props;if(!r)return;const s=t.inputs.shiftKey?Math.abs(o.x)<Math.abs(o.y)?"x":"y":null;s==="x"?o.x=0:s==="y"&&(o.y=0),o.rot(-n.rotation);const a=1/(r.bottomRight.x-r.topLeft.x)*n.props.w,i=1/(r.bottomRight.y-r.topLeft.y)*n.props.h,l=r.bottomRight.y-r.topLeft.y,c=r.bottomRight.x-r.topLeft.x,u=wr(r);return u.topLeft.x=Math.min(1-c,Math.max(0,u.topLeft.x-o.x/a)),u.topLeft.y=Math.min(1-l,Math.max(0,u.topLeft.y-o.y/i)),u.bottomRight.x=u.topLeft.x+c,u.bottomRight.y=u.topLeft.y+l,{id:n.id,type:n.type,props:{crop:u}}}let kK=(PS=class extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});const n=this.editor.getOnlySelectedShape();this.editor.on("change-history",this.cleanupCroppingState),n&&(this.editor.mark("crop"),this.editor.setCroppingShape(n.id))});R(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)});R(this,"onCancel",()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})});R(this,"onPointerDown",n=>{var o;if(!this.editor.getIsMenuOpen()){if(n.ctrlKey){this.cancel(),this.editor.root.handleEvent(n);return}switch(n.target){case"canvas":{const r=Xx(this.editor);if(r&&!this.editor.isShapeOfType(r,"group")){this.onPointerDown({...n,shape:r,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(n);break}case"shape":{if(n.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",n);return}else(o=this.editor.getShapeUtil(n.shape))!=null&&o.canCrop(n.shape)?(this.editor.setCroppingShape(n.shape.id),this.editor.setSelectedShapes([n.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",n)):(this.cancel(),this.editor.root.handleEvent(n));break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop"});break}case"top":case"right":case"bottom":case"left":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.pointing_crop_handle",{...n,onInteractionEnd:"select.crop"});break}default:this.cancel()}break}}}});R(this,"onDoubleClick",n=>{var a;if(this.editor.inputs.shiftKey||n.phase!=="up")return;const o=this.editor.getCroppingShapeId();if(!o)return;const r=this.editor.getShape(o);if(!r)return;const s=this.editor.getShapeUtil(r);s&&n.target==="selection"&&((a=s.onDoubleClickEdge)==null||a.call(s,r))});R(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});R(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});R(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}});R(this,"cleanupCroppingState",()=>{this.editor.getCroppingShapeId()||this.editor.setCurrentTool("select.idle",{})})}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(n=!1){const{editor:{inputs:{keys:o}}}=this,r=o.has("ShiftLeft"),s=new q(0,0);if(o.has("ArrowLeft")&&(s.x+=1),o.has("ArrowRight")&&(s.x-=1),o.has("ArrowUp")&&(s.y+=1),o.has("ArrowDown")&&(s.y-=1),s.equals(new q(0,0)))return;r&&s.mul(10);const a=this.editor.getShape(this.editor.getCroppingShapeId());if(!a)return;const i=XI(this.editor,a,s);i&&(n||this.editor.mark("translate crop"),this.editor.updateShapes([i]))}},R(PS,"id","idle"),PS);class QI extends bt{constructor(){super(...arguments);R(this,"onCancel",()=>{this.editor.setCurrentTool("select.crop.idle",{})});R(this,"onPointerMove",o=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",o)});R(this,"onPointerUp",o=>{this.editor.setCurrentTool("select.crop.idle",o)})}}R(QI,"id","pointing_crop");class ZI extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"markId","translating crop");R(this,"snapshot",{});R(this,"onEnter",o=>{this.info=o,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()});R(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});R(this,"onPointerMove",()=>{this.updateShapes()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onKeyDown",o=>{switch(o.key){case"Alt":case"Shift":{this.updateShapes();return}}});R(this,"onKeyUp",o=>{switch(o.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const o=this.snapshot.shape;if(!o)return;const{originPagePoint:r,currentPagePoint:s}=this.editor.inputs,a=s.clone().sub(r),i=XI(this.editor,o,a);i&&this.editor.updateShapes([i],{squashing:!0})}}R(ZI,"id","translating_crop");class Vg extends bt{}R(Vg,"id","crop"),R(Vg,"initial","idle"),R(Vg,"children",()=>[kK,ZI,QI]);const vs=8,Pu={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class JI extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o,this.updateCursor()});R(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startResizing()});R(this,"onLongPress",()=>{this.startResizing()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const o=this.editor.getSelectedShapes(),r=Pu[this.info.handle];this.editor.updateInstanceState({cursor:{type:r,rotation:o.length===1?this.editor.getSelectionRotation():0}})}startResizing(){this.editor.getInstanceState().isReadonly||this.parent.transition("resizing",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}R(JI,"id","pointing_resize_handle");class e3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"markId","");R(this,"snapshot",{});R(this,"onEnter",o=>{this.info=o,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()});R(this,"onPointerMove",()=>{this.updateShapes()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){if(!this.editor.getSelectedShapes()[0])return;const o=Pu[this.info.handle];this.editor.updateInstanceState({cursor:{type:o,rotation:this.editor.getSelectionRotation()}})}updateShapes(){const{shape:o,cursorHandleOffset:r}=this.snapshot;if(!o||!this.editor.getShapeUtil("image"))return;const s=o.props,a=this.editor.inputs.currentPagePoint.clone().sub(r),i=this.editor.inputs.originPagePoint.clone().sub(r),l=a.clone().sub(i).rot(-o.rotation),c=s.crop??this.getDefaultCrop(),u=wr(c),f=new q(o.x,o.y),h=new q(0,0),d=1/(c.bottomRight.x-c.topLeft.x)*s.w,p=1/(c.bottomRight.y-c.topLeft.y)*s.h;let y=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(p<vs)break;y=!0,u.topLeft.y=u.topLeft.y+l.y/p,p*(u.bottomRight.y-u.topLeft.y)<vs?(u.topLeft.y=u.bottomRight.y-vs/p,h.y=(u.topLeft.y-c.topLeft.y)*p):u.topLeft.y<=0?(u.topLeft.y=0,h.y=(u.topLeft.y-c.topLeft.y)*p):h.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(p<vs)break;y=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+l.y/p),p*(u.bottomRight.y-u.topLeft.y)<vs&&(u.bottomRight.y=u.topLeft.y+vs/p);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(d<vs)break;y=!0,u.topLeft.x=u.topLeft.x+l.x/d,d*(u.bottomRight.x-u.topLeft.x)<vs?(u.topLeft.x=u.bottomRight.x-vs/d,h.x=(u.topLeft.x-c.topLeft.x)*d):u.topLeft.x<=0?(u.topLeft.x=0,h.x=(u.topLeft.x-c.topLeft.x)*d):h.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(d<vs)break;y=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+l.x/d),d*(u.bottomRight.x-u.topLeft.x)<vs&&(u.bottomRight.x=u.topLeft.x+vs/d);break}}if(!y)return;f.add(h.rot(o.rotation));const g={id:o.id,type:o.type,x:f.x,y:f.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*d,h:(u.bottomRight.y-u.topLeft.y)*p}};this.editor.updateShapes([g],{squashing:!0}),this.updateCursor()}complete(){this.updateShapes(),Sr(this.editor,[this.snapshot.shape.id]),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}createSnapshot(){const o=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,s=this.editor.getOnlySelectedShape(),a=this.editor.getSelectionRotatedPageBounds(),i=q.RotWith(a.getHandlePoint(this.info.handle),a.point,o),l=q.Sub(r,i);return{shape:s,cursorHandleOffset:l}}}R(e3,"id","cropping");class t3 extends bt{constructor(){super(...arguments);R(this,"shapeId","");R(this,"initialHandle",{});R(this,"initialAdjacentHandle",null);R(this,"initialPagePoint",{});R(this,"markId","");R(this,"initialPageTransform");R(this,"initialPageRotation");R(this,"info",{});R(this,"isPrecise",!1);R(this,"isPreciseId",null);R(this,"pointingId",null);R(this,"onEnter",o=>{const{shape:r,isCreating:s,handle:a}=o;if(this.info=o,this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.shapeId=r.id,this.markId=s?`creating:${r.id}`:"dragging handle",s||this.editor.mark(this.markId),this.initialHandle=wr(a),this.editor.isShapeOfType(r,"line")&&this.initialHandle.type==="create"){this.editor.updateShape({...r,props:{points:{...r.props.points,[a.index]:{id:a.index,index:a.index,x:a.x,y:a.y}}}});const c=this.editor.getShapeHandles(r).find(u=>u.index===a.index);this.initialHandle=wr(c)}this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:s?"cross":"grabbing",rotation:0}},{ephemeral:!0});const i=this.editor.getShapeHandles(r).sort($n),l=i.findIndex(c=>c.id===o.handle.id);this.initialAdjacentHandle=null;for(let c=l+1;c<i.length;c++){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==o.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=i.length-1;c>=0;c--){const u=i[c];if(u.type==="vertex"&&u.id!=="middle"&&u.id!==o.handle.id){this.initialAdjacentHandle=u;break}}if(this.editor.isShapeOfType(r,"arrow")){const c=r.props[o.handle.id];this.isPrecise=!1,(c==null?void 0:c.type)==="binding"?(this.editor.setHintingShapes([c.boundShapeId]),this.isPrecise=c.isPrecise,this.isPrecise?this.isPreciseId=c.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([])}this.update(),this.editor.select(this.shapeId)});R(this,"exactTimeout",-1);R(this,"onPointerMove",()=>{this.update()});R(this,"onKeyDown",()=>{this.update()});R(this,"onKeyUp",()=>{this.update()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.update(),this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clearIndicators(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clearIndicators(),Sr(this.editor,[this.shapeId]);const{onInteractionEnd:o}=this.info;if(this.editor.getInstanceState().isToolLocked&&o){this.editor.setCurrentTool(o,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators();const{onInteractionEnd:o}=this.info;if(o){this.editor.setCurrentTool(o,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var _;const{editor:o,shapeId:r,initialPagePoint:s}=this,{initialHandle:a,initialPageRotation:i,initialAdjacentHandle:l}=this,c=this.editor.getHintingShapeIds(),u=this.editor.user.getIsSnapMode(),{snaps:f,inputs:{currentPagePoint:h,shiftKey:d,ctrlKey:p,altKey:y,pointerVelocity:g}}=o,b=this.info.shape,m=o.getShape(r);if(!m)return;const v=o.getShapeUtil(m);let x=h.clone().sub(s).rot(-i).add(a);if(d&&l&&a.id!=="middle"){const C=q.Angle(l,x),P=um(C,24)-C;x=q.RotWith(x,l,P)}o.snaps.clearIndicators();let w={...a,x:x.x,y:x.y};if(a.canSnap&&(u?!p:p)){if(!o.getShapePageTransform(m.id))throw Error("Expected a page transform");const C=f.handles.snapHandle({currentShapeId:r,handle:w});C&&(C.nudge.rot(-o.getShapeParentTransform(m).rotation()),x.add(C.nudge),w={...a,x:x.x,y:x.y})}const S=(_=v.onHandleDrag)==null?void 0:_.call(v,m,{handle:w,isPrecise:this.isPrecise||y,initial:b}),k={...m,...S};if(a.canBind){const C=k.props[a.id];(C==null?void 0:C.type)==="binding"?c[0]!==C.boundShapeId&&(o.setHintingShapes([C.boundShapeId]),this.pointingId=C.boundShapeId,this.isPrecise=g.len()<.5||y,this.isPreciseId=this.isPrecise?C.boundShapeId:null,this.resetExactTimeout()):c.length>0&&(o.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}S&&o.updateShapes([k],{squashing:!0})}}R(t3,"id","dragging_handle");function r3(t){return t.isLabel?[t]:t instanceof Ns?t.children.filter(n=>n.isLabel):[]}class n3 extends bt{constructor(){super(...arguments);R(this,"hitShapeForPointerUp",null);R(this,"onEnter",()=>{const o=this.editor.getEditingShape();if(!o)throw Error("Entered editing state without an editing shape");this.hitShapeForPointerUp=null,ju(this.editor),this.editor.select(o)});R(this,"onExit",()=>{var s,a;const{editingShapeId:o}=this.editor.getCurrentPageState();if(!o)return;this.editor.setEditingShape(null);const r=this.editor.getShape(o);(a=(s=this.editor.getShapeUtil(r)).onEditEnd)==null||a.call(s,r)});R(this,"onPointerMove",o=>{if(this.hitShapeForPointerUp&&this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly)return;this.editor.select(this.hitShapeForPointerUp),this.parent.transition("translating",o),this.hitShapeForPointerUp=null;return}switch(o.target){case"shape":case"canvas":{ju(this.editor);return}}});R(this,"onPointerDown",o=>{switch(this.hitShapeForPointerUp=null,o.target){case"canvas":{const r=Xx(this.editor,!0);if(r){this.onPointerDown({...o,shape:r,target:"shape"});return}break}case"shape":{const{shape:r}=o,s=this.editor.getEditingShape();if(!s)throw Error("Expected an editing shape!");const a=this.editor.getShapeUtil(r).getGeometry(r),i=r3(a),l=i.length===1?i[0]:void 0,c=this.editor.isShapeOfType(s,"text")&&s.props.text.trim()==="";if(l&&!c){const u=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(l.bounds.containsPoint(u,0)&&l.hitTestPoint(u)){if(r.id===s.id)return;this.hitShapeForPointerUp=r,this.editor.mark("editing on pointer up"),this.editor.select(r.id);return}}else{if(r.id===s.id)this.editor.isShapeOfType(r,"frame")&&this.editor.setEditingShape(null);else{this.parent.transition("pointing_shape",o);return}return}break}}this.parent.transition("idle",o),this.editor.root.handleEvent(o)});R(this,"onPointerUp",o=>{const r=this.hitShapeForPointerUp;if(!r)return;this.hitShapeForPointerUp=null;const s=this.editor.getShapeUtil(r);if(this.editor.getInstanceState().isReadonly&&!s.canEditInReadOnly(r)){this.parent.transition("pointing_shape",o);return}this.editor.select(r.id),this.editor.setEditingShape(r.id),ju(this.editor)});R(this,"onComplete",o=>{this.parent.transition("idle",o)});R(this,"onCancel",o=>{this.parent.transition("idle",o)})}}R(n3,"id","editing_shape");function o3(t){const n=t.getOnlySelectedShape();return!!(n&&!t.isShapeOrAncestorLocked(n)&&t.getShapeUtil(n).canCrop(n))}function Hg(t){const n=t.getSelectedShapeIds(),{shiftKey:o,altKey:r,currentPagePoint:s}=t.inputs,a=t.getShapeAtPoint(s,{hitInside:!1,margin:Gi/t.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:i=>!i.isLocked});if(a){const i=t.getOutermostSelectableShape(a);if(o&&!r)t.cancelDoubleClick(),n.includes(i.id)?(t.mark("deselecting shape"),t.deselect(i)):(t.mark("shift selecting shape"),t.setSelectedShapes([...n,i.id]));else{let l;i===a||i.id===t.getFocusedGroupId()||n.includes(i.id)?l=a:l=i,l&&!n.includes(l.id)&&(t.mark("selecting shape"),t.select(l.id))}}else{if(o)return;{n.length>0&&(t.mark("selecting none"),t.selectNone());const i=t.getFocusedGroupId();if(Zo(i)){const l=t.getShape(i);t.isPointInShape(l,s,{margin:0,hitInside:!0})||t.setFocusedGroup(null)}}}}const EK=["Delete","Backspace","[","]","Enter"," ","Shift","Tab"];let CK=(MS=class extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{this.parent.setCurrentToolIdMask(void 0),ju(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});R(this,"onPointerMove",()=>{ju(this.editor)});R(this,"onPointerDown",n=>{if(this.editor.getIsMenuOpen())return;const o=n.ctrlKey&&o3(this.editor);if(n.ctrlKey&&!o){if(n.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_shape",n);return}this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{const r=Xx(this.editor);if(r&&!r.isLocked){this.onPointerDown({...n,shape:r,target:"shape"});return}const s=this.editor.getSelectedShapeIds(),a=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:i}}=this.editor;if((s.length>1||a&&!this.editor.getShapeUtil(a).hideSelectionBoundsBg(a))&&s3(this.editor,i)){this.onPointerDown({...n,target:"selection"});return}this.parent.transition("pointing_canvas",n);break}case"shape":{const{shape:r}=n;if(this.isOverArrowLabelTest(r)){this.parent.transition("pointing_arrow_label",n);break}if(this.editor.isShapeOrAncestorLocked(r)){this.parent.transition("pointing_canvas",n);break}this.parent.transition("pointing_shape",n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":{o?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}case"top_left":case"top_right":case"bottom_left":case"bottom_right":{o?this.parent.transition("pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:{const r=this.editor.getHoveredShape();if(r&&!this.editor.getSelectedShapeIds().includes(r.id)&&!r.isLocked){this.onPointerDown({...n,shape:r,target:"shape"});return}this.parent.transition("pointing_selection",n)}}break}}});R(this,"onDoubleClick",n=>{var o,r,s,a,i;if(!(this.editor.inputs.shiftKey||n.phase!=="up"))switch(n.target){case"canvas":{const l=this.editor.getHoveredShape(),c=l&&!this.editor.isShapeOfType(l,"group")?l:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:Gi/this.editor.getZoomLevel(),hitInside:!1}),u=this.editor.getFocusedGroupId();if(c){if(this.editor.isShapeOfType(c,"group")){Hg(this.editor);return}else{const f=this.editor.getShape(c.parentId);if(f&&this.editor.isShapeOfType(f,"group")&&!(u&&f.id===u)){Hg(this.editor);return}}this.onDoubleClick({...n,shape:c,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(n);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const l=this.editor.getOnlySelectedShape();if(l){const c=this.editor.getShapeUtil(l);if(!this.canInteractWithShapeInReadOnly(l))return;if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const u=(o=c.onDoubleClickEdge)==null?void 0:o.call(c,l);if(u){this.editor.mark("double click edge"),this.editor.updateShapes([u]),Sr(this.editor,[l.id]);return}}if(c.canCrop(l)&&!this.editor.isShapeOrAncestorLocked(l)){this.parent.transition("crop",n);return}this.shouldStartEditingShape(l)&&this.startEditingShape(l,n,!0)}break}case"shape":{const{shape:l}=n,c=this.editor.getShapeUtil(l);if(l.type!=="video"&&l.type!=="embed"&&this.editor.getInstanceState().isReadonly)break;if(c.onDoubleClick){const u=(r=c.onDoubleClick)==null?void 0:r.call(c,l);if(u){this.editor.updateShapes([u]);return}else if(c.canCrop(l)&&!this.editor.isShapeOrAncestorLocked(l)){this.editor.mark("select and crop"),this.editor.select((s=n.shape)==null?void 0:s.id),this.parent.transition("crop",n);return}}this.shouldStartEditingShape(l)?this.startEditingShape(l,n,!0):this.handleDoubleClickOnCanvas(n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:l,handle:c}=n,u=(i=(a=this.editor.getShapeUtil(l)).onDoubleClickHandle)==null?void 0:i.call(a,l,c);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(l)&&this.startEditingShape(l,n,!0)}}});R(this,"onRightClick",n=>{switch(n.target){case"canvas":{const o=this.editor.getHoveredShape(),r=o&&!this.editor.isShapeOfType(o,"group")?o:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:Gi/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(r){this.onRightClick({...n,shape:r,target:"shape"});return}const s=this.editor.getSelectedShapeIds(),a=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:i}}=this.editor;if((s.length>1||a&&!this.editor.getShapeUtil(a).hideSelectionBoundsBg(a))&&s3(this.editor,i)){this.onRightClick({...n,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:o}=this.editor.getCurrentPageState(),{shape:r}=n,s=this.editor.getOutermostSelectableShape(r,a=>!o.includes(a.id));o.includes(s.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([s.id]));break}}});R(this,"onCancel",()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())});R(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);return}}if(jn.editOnType.get()&&!EK.includes(n.key)&&!n.altKey&&!n.ctrlKey){const o=this.editor.getOnlySelectedShape();if(o&&this.editor.isShapeOfType(o,"note")&&this.shouldStartEditingShape(o)){this.startEditingShape(o,{...n,target:"shape",shape:o},!0);return}}});R(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});R(this,"onKeyUp",n=>{switch(n.code){case"Enter":{const o=this.editor.getSelectedShapes();if(o.every(s=>this.editor.isShapeOfType(s,"group"))){this.editor.setSelectedShapes(o.flatMap(s=>this.editor.getSortedChildIdsForParent(s.id)));return}const r=this.editor.getOnlySelectedShape();if(r&&this.shouldStartEditingShape(r)){this.startEditingShape(r,{...n,target:"shape",shape:r},!0);return}o3(this.editor)&&this.parent.transition("crop",n);break}}});R(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1)}shouldStartEditingShape(n=this.editor.getOnlySelectedShape()){return!n||this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||!this.canInteractWithShapeInReadOnly(n)?!1:this.editor.getShapeUtil(n).canEdit(n)}startEditingShape(n,o,r){this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||(this.editor.mark("editing shape"),gg(this.editor,n,r),this.parent.transition("editing_shape",o))}isOverArrowLabelTest(n){if(!n)return!1;const o=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint);if(this.editor.isShapeOfType(n,"arrow")){const r=this.editor.getShapeGeometry(n).children[1];if(r&&es(o,r.vertices))return!0}return!1}handleDoubleClickOnCanvas(n){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const o=ur(),{x:r,y:s}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:o,type:"text",x:r,y:s,props:{text:"",autoSize:!0}}]);const a=this.editor.getShape(o);if(!a)return;const i=this.editor.getShapeUtil(a);this.editor.getInstanceState().isReadonly&&!i.canEditInReadOnly(a)||(this.editor.setEditingShape(o),this.editor.select(o),this.parent.transition("editing_shape",n))}nudgeSelectedShapes(n=!1){const{editor:{inputs:{keys:o}}}=this,r=o.has("ShiftLeft"),s=new q(0,0);if(o.has("ArrowLeft")&&(s.x-=1),o.has("ArrowRight")&&(s.x+=1),o.has("ArrowUp")&&(s.y-=1),o.has("ArrowDown")&&(s.y+=1),s.equals(new q(0,0)))return;n||this.editor.mark("nudge shapes");const{gridSize:a}=this.editor.getDocumentSettings(),i=this.editor.getInstanceState().isGridMode?r?a*TK:a:r?PK:MK,l=this.editor.getSelectedShapeIds();this.editor.nudgeShapes(l,s.mul(i)),Sr(this.editor,l)}canInteractWithShapeInReadOnly(n){return!!(!this.editor.getInstanceState().isReadonly||this.editor.getShapeUtil(n).canEditInReadOnly(n))}},R(MS,"id","idle"),MS);const PK=10,MK=1,TK=5;function s3(t,n){const o=t.getSelectionRotatedPageBounds();if(!o)return!1;const r=t.getSelectionRotation();return r?es(n,o.corners.map(s=>q.RotWith(s,o.point,r))):o.containsPoint(n)}class i3 extends bt{constructor(){super(...arguments);R(this,"shapeId","");R(this,"markId","");R(this,"wasAlreadySelected",!1);R(this,"didDrag",!1);R(this,"info",{});R(this,"onEnter",o=>{const{shape:r}=o;this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.info=o,this.shapeId=r.id,this.didDrag=!1,this.wasAlreadySelected=this.editor.getOnlySelectedShapeId()===r.id,this.updateCursor();const s=this.editor.getShapeGeometry(r).children[1];if(!s)throw Error(`Expected to find an arrow label geometry for shape: ${r.id}`);const{currentPagePoint:a}=this.editor.inputs,i=this.editor.getPointInShapeSpace(r,a);this._labelDragOffset=q.Sub(s.center,i),this.markId="label-drag start",this.editor.mark(this.markId),this.editor.setSelectedShapes([this.shapeId])});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});R(this,"_labelDragOffset",new q(0,0));R(this,"onPointerMove",()=>{const{isDragging:o}=this.editor.inputs;if(!o)return;const r=this.editor.getShape(this.shapeId);if(!r)return;const s=this.editor.getArrowInfo(r),a=this.editor.getShapeGeometry(r),i=a.children[0],l=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint),c=i.nearestPoint(q.Add(l,this._labelDragOffset));let u;if(s.isStraight){const f=q.Dist(s.start.point,s.end.point);u=1-q.Dist(s.end.point,c)/f}else{const{_center:f,measure:h,angleEnd:d,angleStart:p}=a.children[0];u=Rb(h,p,d,f.angle(c))}isNaN(u)&&(u=.5),this.didDrag=!0,this.editor.updateShape({id:r.id,type:r.type,props:{labelPosition:u}},{squashing:!0})});R(this,"onPointerUp",()=>{const o=this.editor.getShape(this.shapeId);o&&(this.didDrag||!this.wasAlreadySelected?this.complete():(this.editor.setEditingShape(o.id),this.editor.setCurrentTool("select.editing_shape")))});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:"grabbing",rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}R(i3,"id","pointing_arrow_label");class a3 extends bt{constructor(){super(...arguments);R(this,"onEnter",()=>{const{inputs:o}=this.editor;o.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});R(this,"onPointerMove",o=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",o)});R(this,"onPointerUp",()=>{Hg(this.editor),this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onInterrupt",()=>{this.parent.transition("idle")})}complete(){this.parent.transition("idle")}}R(a3,"id","pointing_canvas");class l3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o,this.parent.setCurrentToolIdMask(o.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];if(!r)return;const s=Pu[this.info.handle];this.editor.updateInstanceState({cursor:{type:s,rotation:this.editor.getSelectionRotation()}}),this.editor.setCroppingShape(r.id)});R(this,"onExit",()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});R(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startCropping()});R(this,"onLongPress",()=>{this.startCropping()});R(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}startCropping(){this.editor.getInstanceState().isReadonly||this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle"))}}R(l3,"id","pointing_crop_handle");class c3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o;const{shape:r}=o;if(this.editor.isShapeOfType(r,"arrow")){const s=r.props[o.handle.id];(s==null?void 0:s.type)==="binding"&&this.editor.setHintingShapes([s.boundShapeId])}this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})});R(this,"onExit",()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});R(this,"onPointerUp",()=>{const{shape:o,handle:r}=this.info;if(this.editor.isShapeOfType(o,"note")){const{editor:s}=this,a=u3(s,o,r,!1);if(a){gg(s,a,!0);return}}this.parent.transition("idle",this.info)});R(this,"onPointerMove",()=>{const{editor:o}=this;o.inputs.isDragging&&this.startDraggingHandle()});R(this,"onLongPress",()=>{this.startDraggingHandle()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}startDraggingHandle(){const{editor:o}=this;if(o.getInstanceState().isReadonly)return;const{shape:r,handle:s}=this.info;if(o.isShapeOfType(r,"note")){const a=u3(o,r,s,!0);if(a){const i=o.getPointInParentSpace(a,o.inputs.originPagePoint).sub(q.Rot(Ox,a.rotation));o.updateShape({...a,x:i.x,y:i.y}),o.setHoveredShape(a.id).select(a.id).setCurrentTool("select.translating",{...this.info,target:"shape",shape:o.getShape(a),onInteractionEnd:"note",isCreating:!0,onCreate:()=>{gg(o,a,!0)}});return}}this.parent.transition("dragging_handle",this.info)}cancel(){this.parent.transition("idle")}}R(c3,"id","pointing_handle");function u3(t,n,o,r){const s=t.getShapePageTransform(n.id),a=s.point(),i=s.rotation(),l=KT(a,i,n.props.growY,0)[o.index];if(l)return QT(t,n,l,i,r)}class d3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.info=o,this.updateCursor()});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})});R(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startRotating()});R(this,"onLongPress",()=>{this.startRotating()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.updateInstanceState({cursor:{type:Pu[this.info.handle],rotation:this.editor.getSelectionRotation()}})}startRotating(){this.editor.getInstanceState().isReadonly||this.parent.transition("rotating",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}R(d3,"id","pointing_rotate_handle");class h3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o});R(this,"onPointerUp",o=>{Hg(this.editor),this.parent.transition("idle",o)});R(this,"onPointerMove",o=>{this.editor.inputs.isDragging&&this.startTranslating(o)});R(this,"onLongPress",o=>{this.startTranslating(o)});R(this,"onDoubleClick",o=>{var a,i;const r=this.editor.getHoveredShape(),s=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(s){this.parent.transition("idle"),(i=(a=this.parent).onDoubleClick)==null||i.call(a,{...o,target:"shape",shape:this.editor.getShape(s)});return}});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}startTranslating(o){this.editor.getInstanceState().isReadonly||this.parent.transition("translating",o)}cancel(){this.parent.transition("idle")}}R(h3,"id","pointing_selection");class p3 extends bt{constructor(){super(...arguments);R(this,"hitShape",{});R(this,"hitShapeForPointerUp",{});R(this,"isDoubleClick",!1);R(this,"didSelectOnEnter",!1);R(this,"onEnter",o=>{const r=this.editor.getSelectedShapeIds(),s=this.editor.getSelectionRotatedPageBounds(),a=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:i,shiftKey:l,altKey:c}}=this.editor;this.hitShape=o.shape,this.isDoubleClick=!1;const u=this.editor.getOutermostSelectableShape(o.shape),f=this.editor.findShapeAncestor(u,h=>r.includes(h.id));if(this.editor.getShapeUtil(o.shape).onClick||u.id===a||r.includes(u.id)||f||r.length>1&&(s!=null&&s.containsPoint(i))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=u;return}this.didSelectOnEnter=!0,l&&!c?(this.editor.cancelDoubleClick(),r.includes(u.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...r,u.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([u.id]))});R(this,"onPointerUp",o=>{var f;const r=this.editor.getSelectedShapeIds(),s=this.editor.getFocusedGroupId(),a=this.editor.getZoomLevel(),{inputs:{currentPagePoint:i,shiftKey:l}}=this.editor,c=this.editor.getShapeAtPoint(i,{margin:Gi/a,hitInside:!0,renderingOnly:!0})??this.hitShape,u=c?this.editor.getOutermostSelectableShape(c):this.hitShapeForPointerUp;if(u){const h=this.editor.getShapeUtil(u);if(h.onClick){const d=(f=h.onClick)==null?void 0:f.call(h,u);if(d){this.editor.mark("shape on click"),this.editor.updateShapes([d]),this.parent.transition("idle",o);return}}if(u.id===s){r.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",o);return}}if(!this.didSelectOnEnter){const h=this.editor.getOutermostSelectableShape(c,d=>!r.includes(d.id));if(r.includes(h.id))if(l)this.editor.mark("deselecting on pointer up"),this.editor.deselect(u);else if(r.includes(u.id)){if(r.length===1){const d=this.editor.getShapeUtil(u).getGeometry(u),p=r3(d),y=p.length===1?p[0]:void 0;if(y){const g=this.editor.getPointInShapeSpace(u,i);if(y.bounds.containsPoint(g,0)&&y.hitTestPoint(g)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(u.id);const b=this.editor.getShapeUtil(u);this.editor.getInstanceState().isReadonly&&!b.canEditInReadOnly(u)||(this.editor.setEditingShape(u.id),this.editor.setCurrentTool("select.editing_shape"),this.isDoubleClick&&this.editor.emit("select-all-text",{shapeId:u.id}))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(u.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(u);else if(l){const d=this.editor.getShapeAncestors(h);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(p=>!d.find(y=>y.id===p)),h.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([h.id])}this.parent.transition("idle",o)});R(this,"onDoubleClick",()=>{this.isDoubleClick=!0});R(this,"onPointerMove",o=>{this.editor.inputs.isDragging&&this.startTranslating(o)});R(this,"onLongPress",o=>{this.startTranslating(o)});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.cancel()});R(this,"onInterrupt",()=>{this.cancel()})}startTranslating(o){this.editor.getInstanceState().isReadonly||(this.editor.getContainer().focus(),this.parent.transition("translating",o))}cancel(){this.parent.transition("idle")}}R(p3,"id","pointing_shape");class f3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"markId","");R(this,"didHoldCommand",!1);R(this,"creationCursorOffset",{x:0,y:0});R(this,"snapshot",{});R(this,"onEnter",o=>{const{isCreating:r=!1,creationCursorOffset:s={x:0,y:0}}=o;this.info=o,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.creationCursorOffset=s,this.snapshot=this._createSnapshot(),r?(this.markId=`creating:${this.editor.getOnlySelectedShape().id}`,this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0})):(this.markId="starting resizing",this.editor.mark(this.markId)),this.handleResizeStart(),this.updateShapes()});R(this,"onTick",()=>{w1(this.editor)});R(this,"onPointerMove",()=>{this.updateShapes()});R(this,"onKeyDown",()=>{this.updateShapes()});R(this,"onKeyUp",()=>{this.updateShapes()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clearIndicators()});R(this,"_createSnapshot",()=>{const o=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:s}}=this.editor,a=this.editor.getSelectionRotatedPageBounds(),i=q.RotWith(a.getHandlePoint(this.info.handle),a.point,r),l=q.Sub(s,i),c=new Map,u=[];o.forEach(h=>{const d=this.editor.getShape(h);if(d){if(d.type==="frame"&&u.push({id:h,children:Lt(this.editor.getSortedChildIdsForParent(d).map(p=>this.editor.getShape(p)))}),c.set(d.id,this._createShapeSnapshot(d)),this.editor.isShapeOfType(d,"frame")&&o.length===1)return;this.editor.visitDescendants(d.id,p=>{const y=this.editor.getShape(p);if(y&&(c.set(y.id,this._createShapeSnapshot(y)),this.editor.isShapeOfType(y,"frame")))return!1})}});const f=![...c.values()].some(h=>!zE(h.pageRotation,r)||h.isAspectRatioLocked);return{shapeSnapshots:c,selectionBounds:a,cursorHandleOffset:l,selectionRotation:r,selectedShapeIds:o,canShapesDeform:f,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:u}});R(this,"_createShapeSnapshot",o=>{const r=this.editor.getShapePageTransform(o),s=this.editor.getShapeUtil(o);return{shape:o,bounds:this.editor.getShapeGeometry(o).bounds,pageTransform:r,pageRotation:vt.Decompose(r).rotation,isAspectRatioLocked:s.isAspectRatioLocked(o)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var o,r;if(Sr(this.editor,this.snapshot.selectedShapeIds),this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(o=this.info).onCreate)==null||r.call(o,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:o}=this.snapshot,r=[];o.forEach(({shape:s})=>{var i,l;const a=(l=(i=this.editor.getShapeUtil(s)).onResizeStart)==null?void 0:l.call(i,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:o}=this.snapshot,r=[];o.forEach(({shape:s})=>{var l,c;const a=this.editor.getShape(s.id),i=(c=(l=this.editor.getShapeUtil(s)).onResizeEnd)==null?void 0:c.call(l,s,a);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:o,shiftKey:r}=this.editor.inputs,{frames:s,shapeSnapshots:a,selectionBounds:i,cursorHandleOffset:l,selectedShapeIds:c,selectionRotation:u,canShapesDeform:f}=this.snapshot,h=r||!f,{ctrlKey:d}=this.editor.inputs,p=this.editor.inputs.currentPagePoint.clone().sub(l).sub(this.creationCursorOffset),y=this.editor.inputs.originPagePoint.clone().sub(l);if(this.editor.getInstanceState().isGridMode&&!d){const{gridSize:_}=this.editor.getDocumentSettings();p.snapToGrid(_)}const g=this.info.handle,b=m3(g,Math.PI);if(this.editor.snaps.clearIndicators(),(this.editor.user.getIsSnapMode()?!d:d)&&u%hr===0){const{nudge:_}=this.editor.snaps.shapeBounds.snapResizeShapes({dragDelta:q.Sub(p,y),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:m3(g,u),isAspectRatioLocked:h,isResizingFromCenter:o});p.add(_)}const m=q.RotWith(o?i.center:i.getHandlePoint(b),i.point,u),v=q.Sub(p,m).rot(-u),x=q.Sub(y,m).rot(-u),w=q.DivV(v,x);Number.isFinite(w.x)||(w.x=1),Number.isFinite(w.y)||(w.y=1);const S=g==="top"||g==="bottom",k=g==="left"||g==="right";h?k?w.y=Math.abs(w.x):S?w.x=Math.abs(w.y):Math.abs(w.x)>Math.abs(w.y)?w.y=Math.abs(w.x)*(w.y<0?-1:1):w.x=Math.abs(w.y)*(w.x<0?-1:1):(S&&(w.x=1),k&&(w.y=1)),this.info.isCreating||this.updateCursor({dragHandle:g,isFlippedX:w.x<0,isFlippedY:w.y<0,rotation:u});for(const _ of a.keys()){const C=a.get(_);this.editor.resizeShape(_,w,{initialShape:C.shape,initialBounds:C.bounds,initialPageTransform:C.pageTransform,dragHandle:g,mode:c.length===1&&_===c[0]?"resize_bounds":"scale_shape",scaleOrigin:m,scaleAxisRotation:u})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:_,children:C}of s){if(!C.length)continue;const P=a.get(_).shape,A=this.editor.getShape(_);if(!(P&&A))continue;const I=A.x-P.x,N=A.y-P.y,O=new q(I,N).rot(-P.rotation);if(O.x!==0||O.y!==0)for(const F of C)this.editor.updateShape({id:F.id,type:F.type,x:F.x-O.x,y:F.y-O.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:_}of s)if(_.length)for(const C of _)this.editor.updateShape({id:C.id,type:C.type,x:C.x,y:C.y})}}updateCursor({dragHandle:o,isFlippedX:r,isFlippedY:s,rotation:a}){const i={...this.editor.getInstanceState().cursor};switch(o){case"top_left":case"bottom_right":{i.type="nwse-resize",r!==s&&(i.type="nesw-resize");break}case"top_right":case"bottom_left":{i.type="nesw-resize",r!==s&&(i.type="nwse-resize");break}}i.rotation=a,this.editor.setCursor(i)}}R(f3,"id","resizing");const Qx=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function m3(t,n){n=n%nr;const o=Math.round(n/(Yt/4)),r=Qx.indexOf(t);return Qx[(r+o)%Qx.length]}const g3=Math.PI/180;class y3 extends bt{constructor(){super(...arguments);R(this,"snapshot",{});R(this,"info",{});R(this,"markId","");R(this,"onEnter",o=>{this.info=o,this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const r=sP({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r;const s=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Pm({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:Pu[this.info.handle],rotation:s+this.snapshot.initialSelectionRotation}})});R(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}});R(this,"onPointerMove",()=>{this.update()});R(this,"onKeyDown",()=>{this.update()});R(this,"onKeyUp",()=>{this.update()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"update",()=>{const o=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Pm({editor:this.editor,delta:o,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:Pu[this.info.handle],rotation:o+this.snapshot.initialSelectionRotation}})});R(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});R(this,"complete",()=>{Pm({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),Sr(this.editor,this.snapshot.shapeSnapshots.map(o=>o.shape.id)),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}_getRotationFromPointerPosition({snapToNearestDegree:o}){const r=this.editor.getSelectionRotation(),s=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:a,currentPagePoint:i}}=this.editor,{initialCursorAngle:l,initialSelectionRotation:c}=this.snapshot;if(!s)return c;const u=s.center.clone().rotWith(s.point,r).angle(i)-l;let f=c+u;if(a)f=um(f,24);else if(o&&(f=Math.round(f/g3)*g3,this.editor.getInstanceState().isCoarsePointer)){const h=um(f,4),d=cm(f,h);Math.abs(d)<T6(5)&&(f=h)}return f-c}}R(y3,"id","rotating");class v3 extends bt{constructor(){super(...arguments);R(this,"hits",new Set);R(this,"size",0);R(this,"scribbleId","id");R(this,"initialSelectedShapeIds",new Set);R(this,"newlySelectedShapeIds",new Set);R(this,"onEnter",()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const o=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=o.id,this.updateScribbleSelection(!0),this.editor.updateInstanceState({brush:null})});R(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});R(this,"onPointerMove",()=>{this.updateScribbleSelection(!0)});R(this,"onPointerUp",()=>{this.complete()});R(this,"onKeyDown",()=>{this.updateScribbleSelection(!1)});R(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")});R(this,"onCancel",()=>{this.cancel()});R(this,"onComplete",()=>{this.complete()});R(this,"pushPointToScribble",()=>{const{x:o,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,o,r)})}updateScribbleSelection(o){const{editor:r}=this,s=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:a,originPagePoint:i,previousPagePoint:l,currentPagePoint:c}}=this.editor,{newlySelectedShapeIds:u,initialSelectedShapeIds:f}=this;o&&this.pushPointToScribble();const h=s;let d,p,y,g;const b=0;for(let x=0,w=h.length;x<w;x++){if(d=h[x],r.isShapeOfType(d,"group")||u.has(d.id)||r.isShapeOrAncestorLocked(d)||(p=r.getShapeGeometry(d),r.isShapeOfType(d,"frame")&&p.bounds.containsPoint(r.getPointInShapeSpace(d,i))))continue;const S=r.getShapePageTransform(d);if(!p||!S)continue;const k=S.clone().invert();y=k.applyToPoint(l),g=k.applyToPoint(c);const{bounds:_}=p;if(!(_.minX-b>Math.max(y.x,g.x)||_.minY-b>Math.max(y.y,g.y)||_.maxX+b<Math.min(y.x,g.x)||_.maxY+b<Math.min(y.y,g.y))&&p.hitTestLineSegment(y,g,b)){const C=this.editor.getOutermostSelectableShape(d),P=this.editor.getShapeMask(C.id);if(P&&r1(l,c,P)!==null&&!es(c,P))continue;u.add(C.id)}}const m=r.getSelectedShapeIds(),v=new Set(a?[...u,...f]:[...u]);(m.length!==v.size||m.some(x=>!v.has(x)))&&this.editor.setSelectedShapes(Array.from(v),{squashing:!0})}complete(){this.updateScribbleSelection(!0),this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle")}}R(v3,"id","scribble_brushing");const IK=20,AK=100;class OK{constructor(n){R(this,"prevDroppingShapeId",null);R(this,"droppingNodeTimer",null);R(this,"first",!0);R(this,"dispose",()=>{this.clear()});this.editor=n,n.disposables.add(this.dispose)}updateDroppingNode(n,o){var r;this.first&&(this.editor.setHintingShapes(n.map(s=>this.editor.findShapeAncestor(s,a=>a.type!=="group")).filter(s=>s)),this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,n))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(n,IK,o):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(n,AK,o))}setDragTimer(n,o,r){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,n,r)}),this.droppingNodeTimer=null},o)}handleDrag(n,o,r){var c,u,f,h,d;o=Lt(o.map(p=>this.editor.getShape(p.id)));const s=((c=this.editor.getDroppingOverShape(n,o))==null?void 0:c.id)??null;if(s===this.prevDroppingShapeId){this.hintParents(o);return}const{prevDroppingShapeId:a}=this,i=a&&this.editor.getShape(a),l=s&&this.editor.getShape(s);i&&((f=(u=this.editor.getShapeUtil(i)).onDragShapesOut)==null||f.call(u,i,o)),l&&((d=(h=this.editor.getShapeUtil(l)).onDragShapesOver)==null||d.call(h,l,o)),this.hintParents(o),r==null||r(),this.prevDroppingShapeId=s}hintParents(n){const o=new Map;for(const s of n){const a=this.editor.findShapeAncestor(s,i=>i.type!=="group");a&&(o.has(a.id)||o.set(a.id,[]),o.get(a.id).push(s.id))}const r=[];for(const[s,a]of o){const i=this.editor.getShape(s);i&&$T(this.editor,i).length<a.length&&r.push(i.id)}this.editor.setHintingShapes(r)}dropShapes(n){var r,s;const{prevDroppingShapeId:o}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,n),o){const a=this.editor.getShape(o);if(!a)return;(s=(r=this.editor.getShapeUtil(a)).onDropShapesOver)==null||s.call(r,a,n)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}}class b3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"selectionSnapshot",{});R(this,"snapshot",{});R(this,"markId","");R(this,"isCloning",!1);R(this,"isCreating",!1);R(this,"onCreate",()=>{});R(this,"dragAndDropManager",new OK(this.editor));R(this,"onEnter",o=>{const{isCreating:r=!1,onCreate:s=()=>{}}=o;if(this.info=o,this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.isCreating=r,this.onCreate=s,r?this.markId=`creating:${this.editor.getOnlySelectedShape().id}`:(this.markId="translating",this.editor.mark(this.markId)),this.isCloning=!1,this.info=o,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=x3(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0}),this.dragAndDropManager.clear()});R(this,"onTick",()=>{this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),w1(this.editor)});R(this,"onPointerMove",()=>{this.updateShapes()});R(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});R(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onComplete",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()});R(this,"updateParentTransforms",()=>{const{editor:o,snapshot:{shapeSnapshots:r}}=this;r.forEach(s=>{const a=o.getShape(s.shape.id);if(!a)return null;const i=Io(a.parentId)?null:vt.Inverse(o.getShapePageTransform(a.parentId));s.parentTransform=i})})}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=x3(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var o;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),Sr(this.editor,this.snapshot.movingShapes.map(r=>r.id)),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(o=this.onCreate)==null||o.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:o}=this.snapshot,r=[];o.forEach(s=>{var i,l;const a=(l=(i=this.editor.getShapeUtil(s)).onTranslateStart)==null?void 0:l.call(i,s);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:o}=this.snapshot;if(this.isCloning&&o.length>0){const s=q.Average(o.map(i=>this.editor.getShapePageTransform(i.id).point())),a=q.Sub(s,this.selectionSnapshot.averagePagePoint);q.IsNaN(a)||this.editor.updateInstanceState({duplicateProps:{shapeIds:o.map(i=>i.id),offset:{x:a.x,y:a.y}}})}const r=[];o.forEach(s=>{var l,c;const a=this.editor.getShape(s.id),i=(c=(l=this.editor.getShapeUtil(s)).onTranslateEnd)==null?void 0:c.call(l,s,a);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}handleChange(){const{movingShapes:o}=this.snapshot,r=[];o.forEach(s=>{var l,c;const a=this.editor.getShape(s.id),i=(c=(l=this.editor.getShapeUtil(s)).onTranslate)==null?void 0:c.call(l,s,a);i&&r.push(i)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:o}=this;this.dragAndDropManager.updateDroppingNode(o.movingShapes,this.updateParentTransforms),LK({editor:this.editor,snapshot:o}),this.handleChange()}}R(b3,"id","translating");function x3(t){var h;const n=[],o=[],r=t.getSelectedShapeIds(),s=Lt(r.map(d=>{const p=t.getShape(d);if(!p)return null;n.push(p);const y=t.getShapePageTransform(d),g=y.point(),b=y.rotation();o.push(g);const m=Ui.isId(p.parentId)?null:vt.Inverse(t.getShapePageTransform(p.parentId));return{shape:p,pagePoint:g,pageRotation:b,parentTransform:m}})),a=t.getOnlySelectedShape();let i=[];if(a)i=t.snaps.shapeBounds.getSnapPoints(a.id);else{const d=t.getSelectionPageBounds();d&&(i=d.cornersAndCenter.map((p,y)=>({id:"selection:"+y,x:p.x,y:p.y})))}let l,c;const{originPagePoint:u}=t.inputs,f=s.filter(d=>t.isShapeOfType(d.shape,"note")&&t.isPointInShape(d.shape,u));if(f.length!==0)if(f.length===1)c=f[0];else{const d=t.getCurrentPageShapesSorted();c=(h=f.map(p=>({snapshot:p,index:d.findIndex(y=>y.id===p.shape.id)})).sort((p,y)=>y.index-p.index)[0])==null?void 0:h.snapshot}return c&&(l=XT(t,c.pageRotation,c.shape.props.growY??0)),{averagePagePoint:q.Average(o),movingShapes:n,shapeSnapshots:s,initialPageBounds:t.getSelectionPageBounds(),initialSnapPoints:i,noteAdjacentPositions:l,noteSnapshot:c}}function LK({editor:t,snapshot:n}){const{inputs:o}=t,{noteSnapshot:r,noteAdjacentPositions:s,initialPageBounds:a,initialSnapPoints:i,shapeSnapshots:l,averagePagePoint:c}=n,u=t.getInstanceState().isGridMode,f=t.getDocumentSettings().gridSize,h=q.Sub(o.currentPagePoint,o.originPagePoint),d=t.inputs.shiftKey?Math.abs(h.x)<Math.abs(h.y)?"x":"y":null;if(d==="x"?h.x=0:d==="y"&&(h.y=0),t.snaps.clearIndicators(),(t.user.getIsSnapMode()?!o.ctrlKey:o.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){const{nudge:g}=t.snaps.shapeBounds.snapTranslateShapes({dragDelta:h,initialSelectionPageBounds:a,lockedAxis:d,initialSelectionSnapPoints:i});h.add(g)}else if(r&&s){let g=YT/t.getZoomLevel(),b=new q(0,0);const m=q.Add(q.Add(r.pagePoint,h),new q(er/2,er/2).rot(r.pageRotation));for(const v of s){const x=q.Sub(m,v),w=x.len();w<g&&(g=w,b=x)}h.sub(b)}const p=q.Add(c,h);u&&!o.ctrlKey&&p.snapToGrid(f);const y=q.Sub(p,c);t.updateShapes(Lt(l.map(({shape:g,pagePoint:b,parentTransform:m})=>{const v=q.Add(b,y),x=m?vt.applyToPoint(m,v):v;return{id:g.id,type:g.type,x:x.x,y:x.y}})),{squashing:!0})}class Wg extends bt{constructor(){super(...arguments);R(this,"reactor");R(this,"cleanUpDuplicateProps",()=>{const o=this.editor.getSelectedShapeIds(),r=this.editor.getInstanceState();if(!r.duplicateProps)return;const s=new Set(r.duplicateProps.shapeIds);o.length===s.size&&o.every(a=>s.has(a))||this.editor.updateInstanceState({duplicateProps:null})});R(this,"onEnter",()=>{this.reactor=Bc("clean duplicate props",()=>{try{this.cleanUpDuplicateProps()}catch(o){typeof process<"u",console.error(o)}})});R(this,"onExit",()=>{var o;(o=this.reactor)==null||o.call(this),this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)})}}R(Wg,"id","select"),R(Wg,"initial","idle"),R(Wg,"children",()=>[Vg,e3,CK,a3,p3,b3,KI,v3,l3,h3,JI,n3,f3,y3,d3,i3,c3,t3]);class w3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o});R(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}R(w3,"id","idle");class S3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o});R(this,"onPointerUp",()=>{this.complete()});R(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});R(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:o}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(o,{duration:220}):this.editor.zoomIn(o,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}R(S3,"id","pointing");class j3 extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"zoomBrush",new mt);R(this,"onEnter",o=>{this.info=o,this.update()});R(this,"onExit",()=>{this.editor.updateInstanceState({zoomBrush:null})});R(this,"onPointerMove",()=>{this.update()});R(this,"onPointerUp",()=>{this.complete()});R(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:o,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(mt.FromPoints([o,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:o}=this,r=8/this.editor.getZoomLevel();if(o.width<r&&o.height<r){const s=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(s,{duration:220}):this.editor.zoomIn(s,{duration:220})}else{const s=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(o,{targetZoom:s,duration:220})}this.parent.transition("idle",this.info)}}R(j3,"id","zoom_brushing");class $g extends bt{constructor(){super(...arguments);R(this,"info",{});R(this,"onEnter",o=>{this.info=o,this.parent.setCurrentToolIdMask(o.onInteractionEnd),this.updateCursor()});R(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.setCurrentToolIdMask(void 0)});R(this,"onKeyDown",()=>{this.updateCursor()});R(this,"onKeyUp",o=>{this.updateCursor(),o.code==="KeyZ"&&this.complete()});R(this,"onInterrupt",()=>{this.complete()})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}}R($g,"id","zoom"),R($g,"initial","idle"),R($g,"children",()=>[w3,j3,S3]);const RK=[Bg,zg,Gg,$g,Wg];function ot(){return ot=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},ot.apply(this,arguments)}function xt(t,n,{checkForDefaultPrevented:o=!0}={}){return function(r){if(t==null||t(r),o===!1||!r.defaultPrevented)return n==null?void 0:n(r)}}function DK(t,n){typeof t=="function"?t(n):t!=null&&(t.current=n)}function qg(...t){return n=>t.forEach(o=>DK(o,n))}function jr(...t){return z.useCallback(qg(...t),t)}function hi(t,n=[]){let o=[];function r(a,i){const l=z.createContext(i),c=o.length;o=[...o,i];function u(h){const{scope:d,children:p,...y}=h,g=(d==null?void 0:d[t][c])||l,b=z.useMemo(()=>y,Object.values(y));return z.createElement(g.Provider,{value:b},p)}function f(h,d){const p=(d==null?void 0:d[t][c])||l,y=z.useContext(p);if(y)return y;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,f]}const s=()=>{const a=o.map(i=>z.createContext(i));return function(i){const l=(i==null?void 0:i[t])||a;return z.useMemo(()=>({[`__scope${t}`]:{...i,[t]:l}}),[i,l])}};return s.scopeName=t,[r,FK(s,...n)]}function FK(...t){const n=t[0];if(t.length===1)return n;const o=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(s){const a=r.reduce((i,{useScope:l,scopeName:c})=>{const u=l(s)[`__scope${c}`];return{...i,...u}},{});return z.useMemo(()=>({[`__scope${n.scopeName}`]:a}),[a])}};return o.scopeName=n.scopeName,o}const Xl=z.forwardRef((t,n)=>{const{children:o,...r}=t,s=z.Children.toArray(o),a=s.find(UK);if(a){const i=a.props.children,l=s.map(c=>c===a?z.Children.count(i)>1?z.Children.only(null):z.isValidElement(i)?i.props.children:null:c);return z.createElement(Zx,ot({},r,{ref:n}),z.isValidElement(i)?z.cloneElement(i,void 0,l):null)}return z.createElement(Zx,ot({},r,{ref:n}),o)});Xl.displayName="Slot";const Zx=z.forwardRef((t,n)=>{const{children:o,...r}=t;return z.isValidElement(o)?z.cloneElement(o,{...BK(r,o.props),ref:n?qg(n,o.ref):o.ref}):z.Children.count(o)>1?z.Children.only(null):null});Zx.displayName="SlotClone";const NK=({children:t})=>z.createElement(z.Fragment,null,t);function UK(t){return z.isValidElement(t)&&t.type===NK}function BK(t,n){const o={...n};for(const r in n){const s=t[r],a=n[r];/^on[A-Z]/.test(r)?s&&a?o[r]=(...i)=>{a(...i),s(...i)}:s&&(o[r]=s):r==="style"?o[r]={...s,...a}:r==="className"&&(o[r]=[s,a].filter(Boolean).join(" "))}return{...t,...o}}function Yg(t){const n=t+"CollectionProvider",[o,r]=hi(n),[s,a]=o(n,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:y,children:g}=p,b=Bt.useRef(null),m=Bt.useRef(new Map).current;return Bt.createElement(s,{scope:y,itemMap:m,collectionRef:b},g)},l=t+"CollectionSlot",c=Bt.forwardRef((p,y)=>{const{scope:g,children:b}=p,m=a(l,g),v=jr(y,m.collectionRef);return Bt.createElement(Xl,{ref:v},b)}),u=t+"CollectionItemSlot",f="data-radix-collection-item",h=Bt.forwardRef((p,y)=>{const{scope:g,children:b,...m}=p,v=Bt.useRef(null),x=jr(y,v),w=a(u,g);return Bt.useEffect(()=>(w.itemMap.set(v,{ref:v,...m}),()=>void w.itemMap.delete(v))),Bt.createElement(Xl,{[f]:"",ref:x},b)});function d(p){const y=a(t+"CollectionConsumer",p);return Bt.useCallback(()=>{const g=y.collectionRef.current;if(!g)return[];const b=Array.from(g.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((m,v)=>b.indexOf(m.ref.current)-b.indexOf(v.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:c,ItemSlot:h},d,r]}const zK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],vr=zK.reduce((t,n)=>{const o=z.forwardRef((r,s)=>{const{asChild:a,...i}=r,l=a?Xl:n;return z.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),z.createElement(l,ot({},i,{ref:s}))});return o.displayName=`Primitive.${n}`,{...t,[n]:o}},{});function Jx(t,n){t&&Tl.flushSync(()=>t.dispatchEvent(n))}function eo(t){const n=z.useRef(t);return z.useEffect(()=>{n.current=t}),z.useMemo(()=>(...o)=>{var r;return(r=n.current)===null||r===void 0?void 0:r.call(n,...o)},[])}function GK(t,n=globalThis==null?void 0:globalThis.document){const o=eo(t);z.useEffect(()=>{const r=s=>{s.key==="Escape"&&o(s)};return n.addEventListener("keydown",r),()=>n.removeEventListener("keydown",r)},[o,n])}const ew="dismissableLayer.update",VK="dismissableLayer.pointerDownOutside",HK="dismissableLayer.focusOutside";let _3;const k3=z.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Kg=z.forwardRef((t,n)=>{var o;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:l,onDismiss:c,...u}=t,f=z.useContext(k3),[h,d]=z.useState(null),p=(o=h==null?void 0:h.ownerDocument)!==null&&o!==void 0?o:globalThis==null?void 0:globalThis.document,[,y]=z.useState({}),g=jr(n,C=>d(C)),b=Array.from(f.layers),[m]=[...f.layersWithOutsidePointerEventsDisabled].slice(-1),v=b.indexOf(m),x=h?b.indexOf(h):-1,w=f.layersWithOutsidePointerEventsDisabled.size>0,S=x>=v,k=$K(C=>{const P=C.target,A=[...f.branches].some(I=>I.contains(P));!S||A||(a==null||a(C),l==null||l(C),C.defaultPrevented||(c==null||c()))},p),_=qK(C=>{const P=C.target;[...f.branches].some(A=>A.contains(P))||(i==null||i(C),l==null||l(C),C.defaultPrevented||(c==null||c()))},p);return GK(C=>{x===f.layers.size-1&&(s==null||s(C),!C.defaultPrevented&&c&&(C.preventDefault(),c()))},p),z.useEffect(()=>{if(h)return r&&(f.layersWithOutsidePointerEventsDisabled.size===0&&(_3=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),f.layersWithOutsidePointerEventsDisabled.add(h)),f.layers.add(h),E3(),()=>{r&&f.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=_3)}},[h,p,r,f]),z.useEffect(()=>()=>{h&&(f.layers.delete(h),f.layersWithOutsidePointerEventsDisabled.delete(h),E3())},[h,f]),z.useEffect(()=>{const C=()=>y({});return document.addEventListener(ew,C),()=>document.removeEventListener(ew,C)},[]),z.createElement(vr.div,ot({},u,{ref:g,style:{pointerEvents:w?S?"auto":"none":void 0,...t.style},onFocusCapture:xt(t.onFocusCapture,_.onFocusCapture),onBlurCapture:xt(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:xt(t.onPointerDownCapture,k.onPointerDownCapture)}))}),WK=z.forwardRef((t,n)=>{const o=z.useContext(k3),r=z.useRef(null),s=jr(n,r);return z.useEffect(()=>{const a=r.current;if(a)return o.branches.add(a),()=>{o.branches.delete(a)}},[o.branches]),z.createElement(vr.div,ot({},t,{ref:s}))});function $K(t,n=globalThis==null?void 0:globalThis.document){const o=eo(t),r=z.useRef(!1),s=z.useRef(()=>{});return z.useEffect(()=>{const a=l=>{if(l.target&&!r.current){let u=function(){C3(VK,o,f,{discrete:!0})};var c=u;const f={originalEvent:l};l.pointerType==="touch"?(n.removeEventListener("click",s.current),s.current=u,n.addEventListener("click",s.current,{once:!0})):u()}else n.removeEventListener("click",s.current);r.current=!1},i=window.setTimeout(()=>{n.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),n.removeEventListener("pointerdown",a),n.removeEventListener("click",s.current)}},[n,o]),{onPointerDownCapture:()=>r.current=!0}}function qK(t,n=globalThis==null?void 0:globalThis.document){const o=eo(t),r=z.useRef(!1);return z.useEffect(()=>{const s=a=>{a.target&&!r.current&&C3(HK,o,{originalEvent:a},{discrete:!1})};return n.addEventListener("focusin",s),()=>n.removeEventListener("focusin",s)},[n,o]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function E3(){const t=new CustomEvent(ew);document.dispatchEvent(t)}function C3(t,n,o,{discrete:r}){const s=o.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:o});n&&s.addEventListener(t,n,{once:!0}),r?Jx(s,a):s.dispatchEvent(a)}const YK=Kg,KK=WK,Xg=z.forwardRef((t,n)=>{var o;const{container:r=globalThis==null||(o=globalThis.document)===null||o===void 0?void 0:o.body,...s}=t;return r?SR.createPortal(z.createElement(vr.div,ot({},s,{ref:n})),r):null}),Ql=globalThis!=null&&globalThis.document?z.useLayoutEffect:()=>{};function XK(t,n){return z.useReducer((o,r)=>n[o][r]??o,t)}const pi=t=>{const{present:n,children:o}=t,r=QK(n),s=typeof o=="function"?o({present:r.isPresent}):z.Children.only(o),a=jr(r.ref,s.ref);return typeof o=="function"||r.isPresent?z.cloneElement(s,{ref:a}):null};pi.displayName="Presence";function QK(t){const[n,o]=z.useState(),r=z.useRef({}),s=z.useRef(t),a=z.useRef("none"),i=t?"mounted":"unmounted",[l,c]=XK(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return z.useEffect(()=>{const u=Qg(r.current);a.current=l==="mounted"?u:"none"},[l]),Ql(()=>{const u=r.current,f=s.current;if(f!==t){const h=a.current,d=Qg(u);t?c("MOUNT"):d==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==d?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Ql(()=>{if(n){const u=h=>{const d=Qg(r.current).includes(h.animationName);h.target===n&&d&&Tl.flushSync(()=>c("ANIMATION_END"))},f=h=>{h.target===n&&(a.current=Qg(r.current))};return n.addEventListener("animationstart",f),n.addEventListener("animationcancel",u),n.addEventListener("animationend",u),()=>{n.removeEventListener("animationstart",f),n.removeEventListener("animationcancel",u),n.removeEventListener("animationend",u)}}else c("ANIMATION_END")},[n,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:z.useCallback(u=>{u&&(r.current=getComputedStyle(u)),o(u)},[])}}function Qg(t){return(t==null?void 0:t.animationName)||"none"}function Qa({prop:t,defaultProp:n,onChange:o=()=>{}}){const[r,s]=ZK({defaultProp:n,onChange:o}),a=t!==void 0,i=a?t:r,l=eo(o),c=z.useCallback(u=>{if(a){const f=typeof u=="function"?u(t):u;f!==t&&l(f)}else s(u)},[a,t,s,l]);return[i,c]}function ZK({defaultProp:t,onChange:n}){const o=z.useState(t),[r]=o,s=z.useRef(r),a=eo(n);return z.useEffect(()=>{s.current!==r&&(a(r),s.current=r)},[r,s,a]),o}const P3=z.forwardRef((t,n)=>z.createElement(vr.span,ot({},t,{ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),M3="ToastProvider",[tw,JK,eX]=Yg("Toast"),[T3,ase]=hi("Toast",[eX]),[tX,Zg]=T3(M3),I3=t=>{const{__scopeToast:n,label:o="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:i}=t,[l,c]=z.useState(null),[u,f]=z.useState(0),h=z.useRef(!1),d=z.useRef(!1);return z.createElement(tw.Provider,{scope:n},z.createElement(tX,{scope:n,label:o,duration:r,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:z.useCallback(()=>f(p=>p+1),[]),onToastRemove:z.useCallback(()=>f(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:d},i))};I3.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const n=`Invalid prop \`label\` supplied to \`${M3}\`. Expected non-empty \`string\`.`;return new Error(n)}return null}};const rX="ToastViewport",nX=["F8"],rw="toast.viewportPause",nw="toast.viewportResume",oX=z.forwardRef((t,n)=>{const{__scopeToast:o,hotkey:r=nX,label:s="Notifications ({hotkey})",...a}=t,i=Zg(rX,o),l=JK(o),c=z.useRef(null),u=z.useRef(null),f=z.useRef(null),h=z.useRef(null),d=jr(n,h,i.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=i.toastCount>0;z.useEffect(()=>{const b=m=>{var v;r.every(x=>m[x]||m.code===x)&&((v=h.current)===null||v===void 0||v.focus())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r]),z.useEffect(()=>{const b=c.current,m=h.current;if(y&&b&&m){const v=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(rw);m.dispatchEvent(k),i.isClosePausedRef.current=!0}},x=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(nw);m.dispatchEvent(k),i.isClosePausedRef.current=!1}},w=k=>{!b.contains(k.relatedTarget)&&x()},S=()=>{b.contains(document.activeElement)||x()};return b.addEventListener("focusin",v),b.addEventListener("focusout",w),b.addEventListener("pointermove",v),b.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",x),()=>{b.removeEventListener("focusin",v),b.removeEventListener("focusout",w),b.removeEventListener("pointermove",v),b.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",x)}}},[y,i.isClosePausedRef]);const g=z.useCallback(({tabbingDirection:b})=>{const m=l().map(v=>{const x=v.ref.current,w=[x,...xX(x)];return b==="forwards"?w:w.reverse()});return(b==="forwards"?m.reverse():m).flat()},[l]);return z.useEffect(()=>{const b=h.current;if(b){const m=v=>{const x=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!x){const _=document.activeElement,C=v.shiftKey;if(v.target===b&&C){var w;(w=u.current)===null||w===void 0||w.focus();return}const P=g({tabbingDirection:C?"backwards":"forwards"}),A=P.findIndex(I=>I===_);if(ow(P.slice(A+1)))v.preventDefault();else{var S,k;C?(S=u.current)===null||S===void 0||S.focus():(k=f.current)===null||k===void 0||k.focus()}}};return b.addEventListener("keydown",m),()=>b.removeEventListener("keydown",m)}},[l,g]),z.createElement(KK,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:y?void 0:"none"}},y&&z.createElement(A3,{ref:u,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"forwards"});ow(b)}}),z.createElement(tw.Slot,{scope:o},z.createElement(vr.ol,ot({tabIndex:-1},a,{ref:d}))),y&&z.createElement(A3,{ref:f,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"backwards"});ow(b)}}))}),sX="ToastFocusProxy",A3=z.forwardRef((t,n)=>{const{__scopeToast:o,onFocusFromOutsideViewport:r,...s}=t,a=Zg(sX,o);return z.createElement(P3,ot({"aria-hidden":!0,tabIndex:0},s,{ref:n,style:{position:"fixed"},onFocus:i=>{var l;const c=i.relatedTarget;!((l=a.viewport)!==null&&l!==void 0&&l.contains(c))&&r()}}))}),Jg="Toast",iX="toast.swipeStart",aX="toast.swipeMove",lX="toast.swipeCancel",cX="toast.swipeEnd",uX=z.forwardRef((t,n)=>{const{forceMount:o,open:r,defaultOpen:s,onOpenChange:a,...i}=t,[l=!0,c]=Qa({prop:r,defaultProp:s,onChange:a});return z.createElement(pi,{present:o||l},z.createElement(O3,ot({open:l},i,{ref:n,onClose:()=>c(!1),onPause:eo(t.onPause),onResume:eo(t.onResume),onSwipeStart:xt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:xt(t.onSwipeMove,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:xt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:xt(t.onSwipeEnd,u=>{const{x:f,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})))}),[dX,hX]=T3(Jg,{onClose(){}}),O3=z.forwardRef((t,n)=>{const{__scopeToast:o,type:r="foreground",duration:s,open:a,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:f,onSwipeMove:h,onSwipeCancel:d,onSwipeEnd:p,...y}=t,g=Zg(Jg,o),[b,m]=z.useState(null),v=jr(n,F=>m(F)),x=z.useRef(null),w=z.useRef(null),S=s||g.duration,k=z.useRef(0),_=z.useRef(S),C=z.useRef(0),{onToastAdd:P,onToastRemove:A}=g,I=eo(()=>{var F;b!=null&&b.contains(document.activeElement)&&((F=g.viewport)===null||F===void 0||F.focus()),i()}),N=z.useCallback(F=>{!F||F===1/0||(window.clearTimeout(C.current),k.current=new Date().getTime(),C.current=window.setTimeout(I,F))},[I]);z.useEffect(()=>{const F=g.viewport;if(F){const U=()=>{N(_.current),u==null||u()},G=()=>{const Y=new Date().getTime()-k.current;_.current=_.current-Y,window.clearTimeout(C.current),c==null||c()};return F.addEventListener(rw,G),F.addEventListener(nw,U),()=>{F.removeEventListener(rw,G),F.removeEventListener(nw,U)}}},[g.viewport,S,c,u,N]),z.useEffect(()=>{a&&!g.isClosePausedRef.current&&N(S)},[a,S,g.isClosePausedRef,N]),z.useEffect(()=>(P(),()=>A()),[P,A]);const O=z.useMemo(()=>b?F3(b):null,[b]);return g.viewport?z.createElement(z.Fragment,null,O&&z.createElement(pX,{__scopeToast:o,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},O),z.createElement(dX,{scope:o,onClose:I},Tl.createPortal(z.createElement(tw.ItemSlot,{scope:o},z.createElement(YK,{asChild:!0,onEscapeKeyDown:xt(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||I(),g.isFocusedToastEscapeKeyDownRef.current=!1})},z.createElement(vr.li,ot({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":g.swipeDirection},y,{ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:xt(t.onKeyDown,F=>{F.key==="Escape"&&(l==null||l(F.nativeEvent),F.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,I()))}),onPointerDown:xt(t.onPointerDown,F=>{F.button===0&&(x.current={x:F.clientX,y:F.clientY})}),onPointerMove:xt(t.onPointerMove,F=>{if(!x.current)return;const U=F.clientX-x.current.x,G=F.clientY-x.current.y,Y=!!w.current,$=["left","right"].includes(g.swipeDirection),H=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,Q=$?H(0,U):0,J=$?0:H(0,G),ae=F.pointerType==="touch"?10:2,T={x:Q,y:J},B={originalEvent:F,delta:T};Y?(w.current=T,ey(aX,h,B,{discrete:!1})):N3(T,g.swipeDirection,ae)?(w.current=T,ey(iX,f,B,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(U)>ae||Math.abs(G)>ae)&&(x.current=null)}),onPointerUp:xt(t.onPointerUp,F=>{const U=w.current,G=F.target;if(G.hasPointerCapture(F.pointerId)&&G.releasePointerCapture(F.pointerId),w.current=null,x.current=null,U){const Y=F.currentTarget,$={originalEvent:F,delta:U};N3(U,g.swipeDirection,g.swipeThreshold)?ey(cX,p,$,{discrete:!0}):ey(lX,d,$,{discrete:!0}),Y.addEventListener("click",H=>H.preventDefault(),{once:!0})}})})))),g.viewport))):null});O3.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const n=`Invalid prop \`type\` supplied to \`${Jg}\`. Expected \`foreground | background\`.`;return new Error(n)}return null}};const pX=t=>{const{__scopeToast:n,children:o,...r}=t,s=Zg(Jg,n),[a,i]=z.useState(!1),[l,c]=z.useState(!1);return vX(()=>i(!0)),z.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:z.createElement(Xg,{asChild:!0},z.createElement(P3,r,a&&z.createElement(z.Fragment,null,s.label," ",o)))},fX=z.forwardRef((t,n)=>{const{__scopeToast:o,...r}=t;return z.createElement(vr.div,ot({},r,{ref:n}))}),mX=z.forwardRef((t,n)=>{const{__scopeToast:o,...r}=t;return z.createElement(vr.div,ot({},r,{ref:n}))}),gX="ToastAction",L3=z.forwardRef((t,n)=>{const{altText:o,...r}=t;return o?z.createElement(D3,{altText:o,asChild:!0},z.createElement(R3,ot({},r,{ref:n}))):null});L3.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${gX}\``)}};const yX="ToastClose",R3=z.forwardRef((t,n)=>{const{__scopeToast:o,...r}=t,s=hX(yX,o);return z.createElement(D3,{asChild:!0},z.createElement(vr.button,ot({type:"button"},r,{ref:n,onClick:xt(t.onClick,s.onClose)})))}),D3=z.forwardRef((t,n)=>{const{__scopeToast:o,altText:r,...s}=t;return z.createElement(vr.div,ot({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},s,{ref:n}))});function F3(t){const n=[];return Array.from(t.childNodes).forEach(o=>{if(o.nodeType===o.TEXT_NODE&&o.textContent&&n.push(o.textContent),bX(o)){const r=o.ariaHidden||o.hidden||o.style.display==="none",s=o.dataset.radixToastAnnounceExclude==="";if(!r)if(s){const a=o.dataset.radixToastAnnounceAlt;a&&n.push(a)}else n.push(...F3(o))}}),n}function ey(t,n,o,{discrete:r}){const s=o.originalEvent.currentTarget,a=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:o});n&&s.addEventListener(t,n,{once:!0}),r?Jx(s,a):s.dispatchEvent(a)}const N3=(t,n,o=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),a=r>s;return n==="left"||n==="right"?a&&r>o:!a&&s>o};function vX(t=()=>{}){const n=eo(t);Ql(()=>{let o=0,r=0;return o=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(o),window.cancelAnimationFrame(r)}},[n])}function bX(t){return t.nodeType===t.ELEMENT_NODE}function xX(t){const n=[],o=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)n.push(o.currentNode);return n}function ow(t){const n=document.activeElement;return t.some(o=>o===n?!0:(o.focus(),document.activeElement!==n))}const wX=uX,SX=fX,jX=mX,_X=L3,U3=R3,kX=h4["useId".toString()]||(()=>{});let EX=0;function Zi(t){const[n,o]=z.useState(kX());return Ql(()=>{t||o(r=>r??String(EX++))},[t]),t||(n?`radix-${n}`:"")}const sw="focusScope.autoFocusOnMount",iw="focusScope.autoFocusOnUnmount",B3={bubbles:!1,cancelable:!0},aw=z.forwardRef((t,n)=>{const{loop:o=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...i}=t,[l,c]=z.useState(null),u=eo(s),f=eo(a),h=z.useRef(null),d=jr(n,g=>c(g)),p=z.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;z.useEffect(()=>{if(r){let v=function(k){if(p.paused||!l)return;const _=k.target;l.contains(_)?h.current=_:Za(h.current,{select:!0})},x=function(k){if(p.paused||!l)return;const _=k.relatedTarget;_!==null&&(l.contains(_)||Za(h.current,{select:!0}))},w=function(k){if(document.activeElement===document.body)for(const _ of k)_.removedNodes.length>0&&Za(l)};var g=v,b=x,m=w;document.addEventListener("focusin",v),document.addEventListener("focusout",x);const S=new MutationObserver(w);return l&&S.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",x),S.disconnect()}}},[r,l,p.paused]),z.useEffect(()=>{if(l){V3.add(p);const g=document.activeElement;if(!l.contains(g)){const b=new CustomEvent(sw,B3);l.addEventListener(sw,u),l.dispatchEvent(b),b.defaultPrevented||(CX(AX(z3(l)),{select:!0}),document.activeElement===g&&Za(l))}return()=>{l.removeEventListener(sw,u),setTimeout(()=>{const b=new CustomEvent(iw,B3);l.addEventListener(iw,f),l.dispatchEvent(b),b.defaultPrevented||Za(g??document.body,{select:!0}),l.removeEventListener(iw,f),V3.remove(p)},0)}}},[l,u,f,p]);const y=z.useCallback(g=>{if(!o&&!r||p.paused)return;const b=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,m=document.activeElement;if(b&&m){const v=g.currentTarget,[x,w]=PX(v);x&&w?!g.shiftKey&&m===w?(g.preventDefault(),o&&Za(x,{select:!0})):g.shiftKey&&m===x&&(g.preventDefault(),o&&Za(w,{select:!0})):m===v&&g.preventDefault()}},[o,r,p.paused]);return z.createElement(vr.div,ot({tabIndex:-1},i,{ref:d,onKeyDown:y}))});function CX(t,{select:n=!1}={}){const o=document.activeElement;for(const r of t)if(Za(r,{select:n}),document.activeElement!==o)return}function PX(t){const n=z3(t),o=G3(n,t),r=G3(n.reverse(),t);return[o,r]}function z3(t){const n=[],o=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)n.push(o.currentNode);return n}function G3(t,n){for(const o of t)if(!MX(o,{upTo:n}))return o}function MX(t,{upTo:n}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n!==void 0&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function TX(t){return t instanceof HTMLInputElement&&"select"in t}function Za(t,{select:n=!1}={}){if(t&&t.focus){const o=document.activeElement;t.focus({preventScroll:!0}),t!==o&&TX(t)&&n&&t.select()}}const V3=IX();function IX(){let t=[];return{add(n){const o=t[0];n!==o&&(o==null||o.pause()),t=H3(t,n),t.unshift(n)},remove(n){var o;t=H3(t,n),(o=t[0])===null||o===void 0||o.resume()}}}function H3(t,n){const o=[...t],r=o.indexOf(n);return r!==-1&&o.splice(r,1),o}function AX(t){return t.filter(n=>n.tagName!=="A")}let lw=0;function cw(){z.useEffect(()=>{var t,n;const o=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=o[0])!==null&&t!==void 0?t:W3()),document.body.insertAdjacentElement("beforeend",(n=o[1])!==null&&n!==void 0?n:W3()),lw++,()=>{lw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),lw--}},[])}function W3(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var fi=function(){return fi=Object.assign||function(t){for(var n,o=1,r=arguments.length;o<r;o++){n=arguments[o];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},fi.apply(this,arguments)};function $3(t,n){var o={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)n.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(o[r[s]]=t[r[s]]);return o}function OX(t,n,o){if(o||arguments.length===2)for(var r=0,s=n.length,a;r<s;r++)(a||!(r in n))&&(a||(a=Array.prototype.slice.call(n,0,r)),a[r]=n[r]);return t.concat(a||Array.prototype.slice.call(n))}var ty="right-scroll-bar-position",ry="width-before-scroll-bar",LX="with-scroll-bars-hidden",RX="--removed-body-scroll-bar-size";function uw(t,n){return typeof t=="function"?t(n):t&&(t.current=n),t}function DX(t,n){var o=z.useState(function(){return{value:t,callback:n,facade:{get current(){return o.value},set current(r){var s=o.value;s!==r&&(o.value=r,o.callback(r,s))}}}})[0];return o.callback=n,o.facade}var FX=typeof window<"u"?z.useLayoutEffect:z.useEffect,q3=new WeakMap;function NX(t,n){var o=DX(n||null,function(r){return t.forEach(function(s){return uw(s,r)})});return FX(function(){var r=q3.get(o);if(r){var s=new Set(r),a=new Set(t),i=o.current;s.forEach(function(l){a.has(l)||uw(l,null)}),a.forEach(function(l){s.has(l)||uw(l,i)})}q3.set(o,t)},[t]),o}function UX(t){return t}function BX(t,n){n===void 0&&(n=UX);var o=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return o.length?o[o.length-1]:t},useMedium:function(a){var i=n(a,r);return o.push(i),function(){o=o.filter(function(l){return l!==i})}},assignSyncMedium:function(a){for(r=!0;o.length;){var i=o;o=[],i.forEach(a)}o={push:function(l){return a(l)},filter:function(){return o}}},assignMedium:function(a){r=!0;var i=[];if(o.length){var l=o;o=[],l.forEach(a),i=o}var c=function(){var f=i;i=[],f.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),o={push:function(f){i.push(f),u()},filter:function(f){return i=i.filter(f),o}}}};return s}function zX(t){t===void 0&&(t={});var n=BX(null);return n.options=fi({async:!0,ssr:!1},t),n}var Y3=function(t){var n=t.sideCar,o=$3(t,["sideCar"]);if(!n)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=n.read();if(!r)throw new Error("Sidecar medium not found");return z.createElement(r,fi({},o))};Y3.isSideCarExport=!0;function GX(t,n){return t.useMedium(n),Y3}var K3=zX(),dw=function(){},ny=z.forwardRef(function(t,n){var o=z.useRef(null),r=z.useState({onScrollCapture:dw,onWheelCapture:dw,onTouchMoveCapture:dw}),s=r[0],a=r[1],i=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,f=t.enabled,h=t.shards,d=t.sideCar,p=t.noIsolation,y=t.inert,g=t.allowPinchZoom,b=t.as,m=b===void 0?"div":b,v=$3(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),x=d,w=NX([o,n]),S=fi(fi({},v),s);return z.createElement(z.Fragment,null,f&&z.createElement(x,{sideCar:K3,removeScrollBar:u,shards:h,noIsolation:p,inert:y,setCallbacks:a,allowPinchZoom:!!g,lockRef:o}),i?z.cloneElement(z.Children.only(l),fi(fi({},S),{ref:w})):z.createElement(m,fi({},S,{className:c,ref:w}),l))});ny.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},ny.classNames={fullWidth:ry,zeroRight:ty};var X3,VX=function(){if(X3)return X3;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function HX(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var n=VX();return n&&t.setAttribute("nonce",n),t}function WX(t,n){t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}function $X(t){var n=document.head||document.getElementsByTagName("head")[0];n.appendChild(t)}var qX=function(){var t=0,n=null;return{add:function(o){t==0&&(n=HX())&&(WX(n,o),$X(n)),t++},remove:function(){t--,!t&&n&&(n.parentNode&&n.parentNode.removeChild(n),n=null)}}},YX=function(){var t=qX();return function(n,o){z.useEffect(function(){return t.add(n),function(){t.remove()}},[n&&o])}},Q3=function(){var t=YX(),n=function(o){var r=o.styles,s=o.dynamic;return t(r,s),null};return n},KX={left:0,top:0,right:0,gap:0},hw=function(t){return parseInt(t||"",10)||0},XX=function(t){var n=window.getComputedStyle(document.body),o=n[t==="padding"?"paddingLeft":"marginLeft"],r=n[t==="padding"?"paddingTop":"marginTop"],s=n[t==="padding"?"paddingRight":"marginRight"];return[hw(o),hw(r),hw(s)]},QX=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return KX;var n=XX(t),o=document.documentElement.clientWidth,r=window.innerWidth;return{left:n[0],top:n[1],right:n[2],gap:Math.max(0,r-o+n[2]-n[0])}},ZX=Q3(),Mu="data-scroll-locked",JX=function(t,n,o,r){var s=t.left,a=t.top,i=t.right,l=t.gap;return o===void 0&&(o="margin"),`
  .`.concat(LX,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Mu,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([n&&"position: relative ".concat(r,";"),o==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),o==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ty,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(ry,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(ty," .").concat(ty,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ry," .").concat(ry,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Mu,`] {
    `).concat(RX,": ").concat(l,`px;
  }
`)},Z3=function(){var t=parseInt(document.body.getAttribute(Mu)||"0",10);return isFinite(t)?t:0},eQ=function(){z.useEffect(function(){return document.body.setAttribute(Mu,(Z3()+1).toString()),function(){var t=Z3()-1;t<=0?document.body.removeAttribute(Mu):document.body.setAttribute(Mu,t.toString())}},[])},tQ=function(t){var n=t.noRelative,o=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;eQ();var a=z.useMemo(function(){return QX(s)},[s]);return z.createElement(ZX,{styles:JX(a,!n,s,o?"":"!important")})},pw=!1;if(typeof window<"u")try{var oy=Object.defineProperty({},"passive",{get:function(){return pw=!0,!0}});window.addEventListener("test",oy,oy),window.removeEventListener("test",oy,oy)}catch{pw=!1}var Tu=pw?{passive:!1}:!1,rQ=function(t){return t.tagName==="TEXTAREA"},J3=function(t,n){var o=window.getComputedStyle(t);return o[n]!=="hidden"&&!(o.overflowY===o.overflowX&&!rQ(t)&&o[n]==="visible")},nQ=function(t){return J3(t,"overflowY")},oQ=function(t){return J3(t,"overflowX")},eA=function(t,n){var o=n;do{typeof ShadowRoot<"u"&&o instanceof ShadowRoot&&(o=o.host);var r=tA(t,o);if(r){var s=rA(t,o),a=s[1],i=s[2];if(a>i)return!0}o=o.parentNode}while(o&&o!==document.body);return!1},sQ=function(t){var n=t.scrollTop,o=t.scrollHeight,r=t.clientHeight;return[n,o,r]},iQ=function(t){var n=t.scrollLeft,o=t.scrollWidth,r=t.clientWidth;return[n,o,r]},tA=function(t,n){return t==="v"?nQ(n):oQ(n)},rA=function(t,n){return t==="v"?sQ(n):iQ(n)},aQ=function(t,n){return t==="h"&&n==="rtl"?-1:1},lQ=function(t,n,o,r,s){var a=aQ(t,window.getComputedStyle(n).direction),i=a*r,l=o.target,c=n.contains(l),u=!1,f=i>0,h=0,d=0;do{var p=rA(t,l),y=p[0],g=p[1],b=p[2],m=g-b-a*y;(y||m)&&tA(t,l)&&(h+=m,d+=y),l=l.parentNode}while(!c&&l!==document.body||c&&(n.contains(l)||n===l));return(f&&(s&&h===0||!s&&i>h)||!f&&(s&&d===0||!s&&-i>d))&&(u=!0),u},sy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},nA=function(t){return[t.deltaX,t.deltaY]},oA=function(t){return t&&"current"in t?t.current:t},cQ=function(t,n){return t[0]===n[0]&&t[1]===n[1]},uQ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},dQ=0,Iu=[];function hQ(t){var n=z.useRef([]),o=z.useRef([0,0]),r=z.useRef(),s=z.useState(dQ++)[0],a=z.useState(function(){return Q3()})[0],i=z.useRef(t);z.useEffect(function(){i.current=t},[t]),z.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var g=OX([t.lockRef.current],(t.shards||[]).map(oA),!0).filter(Boolean);return g.forEach(function(b){return b.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=z.useCallback(function(g,b){if("touches"in g&&g.touches.length===2)return!i.current.allowPinchZoom;var m=sy(g),v=o.current,x="deltaX"in g?g.deltaX:v[0]-m[0],w="deltaY"in g?g.deltaY:v[1]-m[1],S,k=g.target,_=Math.abs(x)>Math.abs(w)?"h":"v";if("touches"in g&&_==="h"&&k.type==="range")return!1;var C=eA(_,k);if(!C)return!0;if(C?S=_:(S=_==="v"?"h":"v",C=eA(_,k)),!C)return!1;if(!r.current&&"changedTouches"in g&&(x||w)&&(r.current=S),!S)return!0;var P=r.current||S;return lQ(P,b,g,P==="h"?x:w,!0)},[]),c=z.useCallback(function(g){var b=g;if(!(!Iu.length||Iu[Iu.length-1]!==a)){var m="deltaY"in b?nA(b):sy(b),v=n.current.filter(function(S){return S.name===b.type&&S.target===b.target&&cQ(S.delta,m)})[0];if(v&&v.should){b.cancelable&&b.preventDefault();return}if(!v){var x=(i.current.shards||[]).map(oA).filter(Boolean).filter(function(S){return S.contains(b.target)}),w=x.length>0?l(b,x[0]):!i.current.noIsolation;w&&b.cancelable&&b.preventDefault()}}},[]),u=z.useCallback(function(g,b,m,v){var x={name:g,delta:b,target:m,should:v};n.current.push(x),setTimeout(function(){n.current=n.current.filter(function(w){return w!==x})},1)},[]),f=z.useCallback(function(g){o.current=sy(g),r.current=void 0},[]),h=z.useCallback(function(g){u(g.type,nA(g),g.target,l(g,t.lockRef.current))},[]),d=z.useCallback(function(g){u(g.type,sy(g),g.target,l(g,t.lockRef.current))},[]);z.useEffect(function(){return Iu.push(a),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",c,Tu),document.addEventListener("touchmove",c,Tu),document.addEventListener("touchstart",f,Tu),function(){Iu=Iu.filter(function(g){return g!==a}),document.removeEventListener("wheel",c,Tu),document.removeEventListener("touchmove",c,Tu),document.removeEventListener("touchstart",f,Tu)}},[]);var p=t.removeScrollBar,y=t.inert;return z.createElement(z.Fragment,null,y?z.createElement(a,{styles:uQ(s)}):null,p?z.createElement(tQ,{gapMode:"margin"}):null)}const pQ=GX(K3,hQ);var sA=z.forwardRef(function(t,n){return z.createElement(ny,fi({},t,{ref:n,sideCar:pQ}))});sA.classNames=ny.classNames;const fw=sA;var fQ=function(t){if(typeof document>"u")return null;var n=Array.isArray(t)?t[0]:t;return n.ownerDocument.body},Au=new WeakMap,iy=new WeakMap,ay={},mw=0,iA=function(t){return t&&(t.host||iA(t.parentNode))},mQ=function(t,n){return n.map(function(o){if(t.contains(o))return o;var r=iA(o);return r&&t.contains(r)?r:(console.error("aria-hidden",o,"in not contained inside",t,". Doing nothing"),null)}).filter(function(o){return!!o})},gQ=function(t,n,o,r){var s=mQ(n,Array.isArray(t)?t:[t]);ay[o]||(ay[o]=new WeakMap);var a=ay[o],i=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var f=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(d){if(l.has(d))f(d);else try{var p=d.getAttribute(r),y=p!==null&&p!=="false",g=(Au.get(d)||0)+1,b=(a.get(d)||0)+1;Au.set(d,g),a.set(d,b),i.push(d),g===1&&y&&iy.set(d,!0),b===1&&d.setAttribute(o,"true"),y||d.setAttribute(r,"true")}catch(m){console.error("aria-hidden: cannot operate on ",d,m)}})};return f(n),l.clear(),mw++,function(){i.forEach(function(h){var d=Au.get(h)-1,p=a.get(h)-1;Au.set(h,d),a.set(h,p),d||(iy.has(h)||h.removeAttribute(r),iy.delete(h)),p||h.removeAttribute(o)}),mw--,mw||(Au=new WeakMap,Au=new WeakMap,iy=new WeakMap,ay={})}},gw=function(t,n,o){o===void 0&&(o="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=n||fQ(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),gQ(r,s,o,"aria-hidden")):function(){return null}};const aA="Dialog",[lA,lse]=hi(aA),[yQ,Ji]=lA(aA),vQ=t=>{const{__scopeDialog:n,children:o,open:r,defaultOpen:s,onOpenChange:a,modal:i=!0}=t,l=z.useRef(null),c=z.useRef(null),[u=!1,f]=Qa({prop:r,defaultProp:s,onChange:a});return z.createElement(yQ,{scope:n,triggerRef:l,contentRef:c,contentId:Zi(),titleId:Zi(),descriptionId:Zi(),open:u,onOpenChange:f,onOpenToggle:z.useCallback(()=>f(h=>!h),[f]),modal:i},o)},cA="DialogPortal",[bQ,uA]=lA(cA,{forceMount:void 0}),xQ=t=>{const{__scopeDialog:n,forceMount:o,children:r,container:s}=t,a=Ji(cA,n);return z.createElement(bQ,{scope:n,forceMount:o},z.Children.map(r,i=>z.createElement(pi,{present:o||a.open},z.createElement(Xg,{asChild:!0,container:s},i))))},yw="DialogOverlay",wQ=z.forwardRef((t,n)=>{const o=uA(yw,t.__scopeDialog),{forceMount:r=o.forceMount,...s}=t,a=Ji(yw,t.__scopeDialog);return a.modal?z.createElement(pi,{present:r||a.open},z.createElement(SQ,ot({},s,{ref:n}))):null}),SQ=z.forwardRef((t,n)=>{const{__scopeDialog:o,...r}=t,s=Ji(yw,o);return z.createElement(fw,{as:Xl,allowPinchZoom:!0,shards:[s.contentRef]},z.createElement(vr.div,ot({"data-state":hA(s.open)},r,{ref:n,style:{pointerEvents:"auto",...r.style}})))}),Lh="DialogContent",jQ=z.forwardRef((t,n)=>{const o=uA(Lh,t.__scopeDialog),{forceMount:r=o.forceMount,...s}=t,a=Ji(Lh,t.__scopeDialog);return z.createElement(pi,{present:r||a.open},a.modal?z.createElement(_Q,ot({},s,{ref:n})):z.createElement(kQ,ot({},s,{ref:n})))}),_Q=z.forwardRef((t,n)=>{const o=Ji(Lh,t.__scopeDialog),r=z.useRef(null),s=jr(n,o.contentRef,r);return z.useEffect(()=>{const a=r.current;if(a)return gw(a)},[]),z.createElement(dA,ot({},t,{ref:s,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xt(t.onCloseAutoFocus,a=>{var i;a.preventDefault(),(i=o.triggerRef.current)===null||i===void 0||i.focus()}),onPointerDownOutside:xt(t.onPointerDownOutside,a=>{const i=a.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&a.preventDefault()}),onFocusOutside:xt(t.onFocusOutside,a=>a.preventDefault())}))}),kQ=z.forwardRef((t,n)=>{const o=Ji(Lh,t.__scopeDialog),r=z.useRef(!1),s=z.useRef(!1);return z.createElement(dA,ot({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i;if((i=t.onCloseAutoFocus)===null||i===void 0||i.call(t,a),!a.defaultPrevented){var l;r.current||(l=o.triggerRef.current)===null||l===void 0||l.focus(),a.preventDefault()}r.current=!1,s.current=!1},onInteractOutside:a=>{var i,l;(i=t.onInteractOutside)===null||i===void 0||i.call(t,a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=a.target;!((l=o.triggerRef.current)===null||l===void 0)&&l.contains(c)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}}))}),dA=z.forwardRef((t,n)=>{const{__scopeDialog:o,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:a,...i}=t,l=Ji(Lh,o),c=z.useRef(null),u=jr(n,c);return cw(),z.createElement(z.Fragment,null,z.createElement(aw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:a},z.createElement(Kg,ot({role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":hA(l.open)},i,{ref:u,onDismiss:()=>l.onOpenChange(!1)}))),!1)}),EQ="DialogTitle",CQ=z.forwardRef((t,n)=>{const{__scopeDialog:o,...r}=t,s=Ji(EQ,o);return z.createElement(vr.h2,ot({id:s.titleId},r,{ref:n}))}),PQ="DialogClose",MQ=z.forwardRef((t,n)=>{const{__scopeDialog:o,...r}=t,s=Ji(PQ,o);return z.createElement(vr.button,ot({type:"button"},r,{ref:n,onClick:xt(t.onClick,()=>s.onOpenChange(!1))}))});function hA(t){return t?"open":"closed"}const TQ=vQ,IQ=xQ,AQ=wQ,OQ=jQ,pA=()=>{},fA=z.createContext({});function LQ({onEvent:t,children:n}){return E.jsx(fA.Provider,{value:t??pA,children:n})}function mi(){return z.useContext(fA)??pA}const mA=z.createContext({});function RQ({children:t}){const n=Be(),o=mi(),[r,s]=z.useState([]),a=z.useCallback(u=>{const f=u.id??Ir();return s(h=>[...h.filter(d=>d.id!==u.id),{...u,id:f}]),o("open-menu",{source:"dialog",id:f}),n.addOpenMenu(f),f},[n,o]),i=z.useCallback((u,f)=>(s(h=>h.map(d=>d.id===u?{...d,...f}:d)),o("open-menu",{source:"dialog",id:u}),n.addOpenMenu(u),u),[n,o]),l=z.useCallback(u=>(s(f=>f.filter(h=>{var d;return h.id===u?((d=h.onClose)==null||d.call(h),!1):!0})),o("close-menu",{source:"dialog",id:u}),n.deleteOpenMenu(u),u),[n,o]),c=z.useCallback(()=>{s(u=>(u.forEach(f=>{var h;(h=f.onClose)==null||h.call(f),o("close-menu",{source:"dialog",id:f.id}),n.deleteOpenMenu(f.id)}),[]))},[n,o]);return E.jsx(mA.Provider,{value:{dialogs:r,addDialog:a,removeDialog:l,clearDialogs:c,updateDialog:i},children:t})}function Zl(){const t=z.useContext(mA);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}const DQ=({id:t,component:n,onClose:o})=>{const{removeDialog:r}=Zl(),s=Qn(),a=z.useCallback(i=>{if(!i){if(o)try{o()}catch(l){console.warn(l)}r(t)}},[t,o,r]);return E.jsx(TQ,{onOpenChange:a,defaultOpen:!0,children:E.jsx(IQ,{container:s,children:E.jsx(AQ,{dir:"ltr",className:"tlui-dialog__overlay",onClick:i=>{i.target===i.currentTarget&&a(!1)},children:E.jsx(OQ,{dir:"ltr",className:"tlui-dialog__content",children:E.jsx(n,{onClose:()=>a(!1)})})})})})};function FQ(){const{dialogs:t}=Zl();return E.jsx(E.Fragment,{children:t.map(n=>E.jsx(DQ,{...n},n.id))})}const NQ=Bt.memo(FQ);function UQ(){const t=Be(),n=We("follow",()=>t.getInstanceState().followingUserId,[t]);return n?E.jsx(BQ,{userId:n}):null}function BQ({userId:t}){const n=IC(t);return n?E.jsx("div",{className:"tlui-following-indicator",style:{borderColor:n.color}}):null}const gA=z.createContext({});function zQ({children:t}){const[n,o]=z.useState([]),r=z.useCallback(i=>{const l=i.id??Ir();return o(c=>[...c.filter(u=>u.id!==i.id),{...i,id:l}]),l},[]),s=z.useCallback(i=>(o(l=>l.filter(c=>c.id!==i)),i),[]),a=z.useCallback(()=>{o(()=>[])},[]);return E.jsx(gA.Provider,{value:{toasts:n,addToast:r,removeToast:s,clearToasts:a},children:t})}function Hs(){const t=z.useContext(gA);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}const It=z.forwardRef(function({children:t,disabled:n,type:o,...r},s){const a=Be(),i=s==null?void 0:s.current;return n&&i===document.activeElement&&a.getContainer().focus(),E.jsx("button",{ref:s,type:"button",draggable:!1,disabled:n,...r,className:Pt("tlui-button",`tlui-button__${o}`,r.className),children:t})});function rn({children:t}){return E.jsx("span",{className:"tlui-button__label",children:t})}const Ja=z.memo(function({small:t,invertIcon:n,icon:o,color:r,className:s,...a}){const i=Yx(),l=i.icons[o]??i.icons["question-mark-circle"],c=z.useRef(null);return z.useLayoutEffect(()=>{l||console.error(`Icon not found: ${o}. Add it to the assetUrls.icons object.`),c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l,o]),E.jsx("div",{...a,ref:c,className:Pt("tlui-icon",{"tlui-icon__small":t},s),style:{color:r,mask:`url(${l}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),GQ={success:"check-circle",warning:"warning-triangle",error:"cross-circle",info:"info-circle"};function VQ({toast:t}){const{removeToast:n}=Hs(),o=tr(),r=i=>{i||n(t.id)},s=t.actions&&t.actions.length>0,a=t.icon||t.severity&&GQ[t.severity];return E.jsxs(wX,{onOpenChange:r,className:"tlui-toast__container",duration:t.keepOpen?1/0:5e3,"data-severity":t.severity,children:[a&&E.jsx("div",{className:"tlui-toast__icon",children:E.jsx(Ja,{icon:a})}),E.jsxs("div",{className:"tlui-toast__main",children:[E.jsxs("div",{className:"tlui-toast__content",children:[t.title&&E.jsx(SX,{className:"tlui-toast__title",children:t.title}),t.description&&E.jsx(jX,{className:"tlui-toast__description",children:t.description})]}),t.actions&&E.jsxs("div",{className:"tlui-toast__actions",children:[t.actions.map((i,l)=>E.jsx(_X,{altText:i.label,asChild:!0,onClick:i.onClick,children:E.jsx(It,{type:i.type,children:E.jsx(rn,{children:i.label})})},l)),E.jsx(U3,{asChild:!0,children:E.jsx(It,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:E.jsx(rn,{children:t.closeLabel??o("toast.close")})})})]})]}),!s&&E.jsx(U3,{asChild:!0,children:E.jsx(It,{type:"normal",className:"tlui-toast__close",children:E.jsx(rn,{children:t.closeLabel??o("toast.close")})})})]})}function HQ(){const{toasts:t}=Hs();return E.jsx(E.Fragment,{children:t.map(n=>E.jsx(VQ,{toast:n},n.id))})}const WQ=z.memo(HQ);function $Q(){const{toasts:t}=Hs(),[n,o]=z.useState(!1);return z.useEffect(()=>{let r=!1;return t.length?o(!0):setTimeout(()=>{r||o(!1)},1e3),()=>{r=!0}},[t.length,o]),n?E.jsx(oX,{className:"tlui-toast__viewport"}):null}function Qt({icon:t,small:n,invertIcon:o}){return E.jsx(Ja,{className:"tlui-button__icon",icon:t,small:n,invertIcon:o})}const vw=[0,390,428,468,580,640,840,1023];var Xr=(t=>(t[t.ZERO=0]="ZERO",t[t.MOBILE_XXS=1]="MOBILE_XXS",t[t.MOBILE_XS=2]="MOBILE_XS",t[t.MOBILE_SM=3]="MOBILE_SM",t[t.MOBILE=4]="MOBILE",t[t.TABLET_SM=5]="TABLET_SM",t[t.TABLET=6]="TABLET",t[t.DESKTOP=7]="DESKTOP",t))(Xr||{});const Jl="2.1.3";let bw={fonts:{draw:`https://unpkg.com/@tldraw/assets@${Jl}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`https://unpkg.com/@tldraw/assets@${Jl}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${Jl}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${Jl}/fonts/IBMPlexMono-Medium.woff2`}};function yA(t){return z.useMemo(()=>t?{fonts:{...bw.fonts,...t==null?void 0:t.fonts}}:bw,[t])}const qQ=["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check-circle","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross-circle","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","error","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"];let Rh={...bw,icons:Object.fromEntries(qQ.map(t=>[t,`https://unpkg.com/@tldraw/assets@${Jl}/icons/icon/${t}.svg`])),translations:Object.fromEntries(Jd.map(t=>[t.locale,`https://unpkg.com/@tldraw/assets@${Jl}/translations/${t.locale}.json`])),embedIcons:Object.fromEntries(Qd.map(t=>[t.type,`https://unpkg.com/@tldraw/assets@${Jl}/embed-icons/${t.type}.png`]))};function YQ(t){return t?{fonts:Object.assign({...Rh.fonts},{...t==null?void 0:t.fonts}),icons:Object.assign({...Rh.icons},{...t==null?void 0:t.icons}),embedIcons:Object.assign({...Rh.embedIcons},{...t==null?void 0:t.embedIcons}),translations:Object.assign({...Rh.translations},{...t==null?void 0:t.translations})}:Rh}function ly({className:t,children:n}){return E.jsx("div",{className:Pt("tlui-dialog__header",t),children:n})}function cy({className:t,children:n}){return E.jsx(CQ,{dir:"ltr",className:Pt("tlui-dialog__header__title",t),children:n})}function uy(){return E.jsx("div",{className:"tlui-dialog__header__close",children:E.jsx(MQ,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:E.jsx(It,{type:"icon","aria-label":"Close",onTouchEnd:t=>t.target.click(),children:E.jsx(Qt,{small:!0,icon:"cross-2"})})})})}function Dh({className:t,children:n,style:o}){return E.jsx("div",{className:Pt("tlui-dialog__body",t),style:o,children:n})}function xw({className:t,children:n}){return E.jsx("div",{className:Pt("tlui-dialog__footer",t),children:n})}const ww=z.forwardRef(function({className:t,label:n,icon:o,iconLeft:r,autoselect:s=!1,autofocus:a=!1,defaultValue:i,placeholder:l,onComplete:c,onValueChange:u,onCancel:f,onBlur:h,shouldManuallyMaintainScrollPositionWhenFocused:d=!1,children:p,value:y},g){const b=Be(),m=z.useRef(null);z.useImperativeHandle(g,()=>m.current);const v=tr(),x=z.useRef(i??""),w=z.useRef(i??""),[S,k]=z.useState(!1),_=z.useCallback(I=>{k(!0);const N=I.currentTarget;w.current=N.value,requestAnimationFrame(()=>{s&&N.select()})},[s]),C=z.useCallback(I=>{const N=I.currentTarget.value;w.current=N,u==null||u(N)},[u]),P=z.useCallback(I=>{switch(I.key){case"Enter":{I.currentTarget.blur(),On(I),c==null||c(I.currentTarget.value);break}case"Escape":{I.currentTarget.value=x.current,I.currentTarget.blur(),On(I),f==null||f(I.currentTarget.value);break}}},[c,f]),A=z.useCallback(I=>{k(!1);const N=I.currentTarget.value;h==null||h(N)},[h]);return z.useEffect(()=>{if(!b.environment.isIos)return;const I=window.visualViewport;if(S&&d&&I){const N=()=>{var O;(O=m.current)==null||O.scrollIntoView({block:"center"})};return I.addEventListener("resize",N),I.addEventListener("scroll",N),requestAnimationFrame(()=>{var O;(O=m.current)==null||O.scrollIntoView({block:"center"})}),()=>{I.removeEventListener("resize",N),I.removeEventListener("scroll",N)}}},[b,S,d]),E.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[p,n&&E.jsx("label",{children:v(n)}),r&&E.jsx(Ja,{icon:r,className:"tlui-icon-left",small:!0}),E.jsx("input",{ref:m,className:Pt("tlui-input",t),type:"text",defaultValue:i,onKeyUp:P,onChange:C,onFocus:_,onBlur:A,autoFocus:a,placeholder:l,value:y}),o&&E.jsx(Ja,{icon:o,small:!!n})]})}),vA=qo(function({onClose:t}){const n=Be(),o=tr(),r=Yx(),[s,a]=z.useState(null),[i,l]=z.useState(""),[c,u]=z.useState(null),[f,h]=z.useState(!1),d=z.useRef(-1);return E.jsxs(E.Fragment,{children:[E.jsxs(ly,{children:[E.jsx(cy,{children:s?`${o("embed-dialog.title")} \u2014 ${s.title}`:o("embed-dialog.title")}),E.jsx(uy,{})]}),s?E.jsxs(E.Fragment,{children:[E.jsxs(Dh,{className:"tlui-embed-dialog__enter",children:[E.jsx(ww,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:p=>{l(p);const y=Xa(p);u(y&&y.definition.type===s.type?y:null),h(!1),clearTimeout(d.current),d.current=setTimeout(()=>h(!y),320)}}),i===""?E.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[E.jsx("span",{children:o("embed-dialog.instruction")})," ",s.instructionLink&&E.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",E.jsx(Ja,{icon:"external-link",small:!0})]})]}):E.jsx("div",{className:"tlui-embed-dialog__warning",children:f?o("embed-dialog.invalid-url"):"\xA0"})]}),E.jsxs(xw,{className:"tlui-dialog__footer__actions",children:[E.jsx(It,{type:"normal",onClick:()=>{a(null),u(null),l("")},children:E.jsx(rn,{children:o("embed-dialog.back")})}),E.jsx("div",{className:"tlui-embed__spacer"}),E.jsx(It,{type:"normal",onClick:t,children:E.jsx(rn,{children:o("embed-dialog.cancel")})}),E.jsx(It,{type:"primary",disabled:!c,onClick:()=>{c&&(n.putExternalContent({type:"embed",url:i,point:n.getViewportPageCenter(),embed:c.definition}),t())},children:E.jsx(rn,{children:o("embed-dialog.create")})})]})]}):E.jsx(E.Fragment,{children:E.jsx(Dh,{className:"tlui-embed-dialog__list",children:Qd.map(p=>E.jsxs(It,{type:"menu",onClick:()=>a(p),children:[E.jsx(rn,{children:p.title}),E.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${r.embedIcons[p.type]})`}})]},p.type))})})]})});function bA(){const t=Be(),n=z.useRef();return z.useEffect(()=>{const o=window.document.createElement("input");o.type="file",o.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",o.multiple=!0,n.current=o;async function r(s){const a=s.target.files;!a||a.length===0||(await t.putExternalContent({type:"files",files:Array.from(a),point:t.getViewportPageBounds().center,ignoreParent:!1}),o.value="")}return o.addEventListener("change",r),()=>{n.current=void 0,o.removeEventListener("change",r)}},[t]),z.useCallback(()=>{var o;(o=n.current)==null||o.click()},[n])}const xA=z.createContext({});function KQ({overrides:t,children:n}){const o=Be(),r=mi(),{addDialog:s}=Zl(),a=bA(),i=z.useMemo(()=>{const l=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(u){o.setCurrentTool("select"),r("select-tool",{source:u,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(u){o.setCurrentTool("hand"),r("select-tool",{source:u,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",onSelect(u){o.setCurrentTool("eraser"),r("select-tool",{source:u,id:"eraser"})}},{id:"draw",label:"tool.draw",icon:"tool-pencil",kbd:"d,b,x",onSelect(u){o.setCurrentTool("draw"),r("select-tool",{source:u,id:"draw"})}},...[...oi.values].map(u=>({id:u,label:`tool.${u}`,meta:{geo:u},kbd:u==="rectangle"?"r":u==="ellipse"?"o":void 0,icon:"geo-"+u,onSelect(f){o.batch(()=>{o.updateInstanceState({stylesForNextShape:{...o.getInstanceState().stylesForNextShape,[oi.id]:u}},{ephemeral:!0}),o.setCurrentTool("geo"),r("select-tool",{source:f,id:`geo-${u}`})})}})),{id:"arrow",label:"tool.arrow",icon:"tool-arrow",kbd:"a",onSelect(u){o.setCurrentTool("arrow"),r("select-tool",{source:u,id:"arrow"})}},{id:"line",label:"tool.line",icon:"tool-line",kbd:"l",onSelect(u){o.setCurrentTool("line"),r("select-tool",{source:u,id:"line"})}},{id:"frame",label:"tool.frame",icon:"tool-frame",kbd:"f",onSelect(u){o.setCurrentTool("frame"),r("select-tool",{source:u,id:"frame"})}},{id:"text",label:"tool.text",icon:"tool-text",kbd:"t",onSelect(u){o.setCurrentTool("text"),r("select-tool",{source:u,id:"text"})}},{id:"asset",label:"tool.asset",icon:"tool-media",kbd:"$u",onSelect(u){a(),r("select-tool",{source:u,id:"media"})}},{id:"note",label:"tool.note",icon:"tool-note",kbd:"n",onSelect(u){o.setCurrentTool("note"),r("select-tool",{source:u,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(u){o.setCurrentTool("laser"),r("select-tool",{source:u,id:"laser"})}},{id:"embed",label:"tool.embed",icon:"tool-embed",onSelect(u){s({component:vA}),r("select-tool",{source:u,id:"embed"})}},{id:"highlight",label:"tool.highlight",icon:"tool-highlight",kbd:"!d",onSelect(u){o.setCurrentTool("highlight"),r("select-tool",{source:u,id:"highlight"})}}];l.push();const c=Object.fromEntries(l.map(u=>[u.id,u]));return t?t(o,c,{insertMedia:a}):c},[t,o,r,a,s]);return E.jsx(xA.Provider,{value:i,children:n})}function or(){const t=z.useContext(xA);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}const wA=Bt.createContext(0);function XQ({forceMobile:t=!1,children:n}){const o=Be(),r=We("breakpoint",()=>{const{width:s}=o.getViewportScreenBounds(),a=t?Xr.MOBILE_SM:vw.length-1;for(let i=0;i<a;i++)if(s>vw[i]&&s<=vw[i+1])return i;return a},[o]);return E.jsx(wA.Provider,{value:r,children:n})}function Do(){return z.useContext(wA)}function QQ(){const{addToast:t,removeToast:n,clearToasts:o}=Hs(),{addDialog:r,clearDialogs:s,removeDialog:a,updateDialog:i}=Zl(),l=Do()<Xr.TABLET_SM,c=tr();return z.useMemo(()=>({addToast:t,removeToast:n,clearToasts:o,addDialog:r,clearDialogs:s,removeDialog:a,updateDialog:i,msg:c,isMobile:l}),[r,t,s,o,c,a,n,i,l])}function ZQ(t,n){const o={};for(const r of t)if(r.translations)for(const[s,a]of Po(r.translations)){let i=o[s];i||(i=o[s]={}),Object.assign(i,a)}return{actions:(r,s)=>{for(const a of t)a.actions&&(s=a.actions(r,s,n));return s},tools:(r,s,a)=>{for(const i of t)i.tools&&(s=i.tools(r,s,{...n,...a}));return s},translations:o}}function SA(t){return z.useMemo(()=>t,t)}function JQ(t){const n=SA(t==null?[]:Array.isArray(t)?t:[t]);return z.useMemo(()=>{const o={};for(const r of n)if(r.translations)for(const[s,a]of Po(r.translations)){let i=o[s];i||(i=o[s]={}),Object.assign(i,a)}return o},[n])}function eZ(t){const n=QQ(),o=SA(t==null?[]:Array.isArray(t)?t:[t]);return z.useMemo(()=>ZQ(o,n),[o,n])}function tZ(t,n){const o=Lt(n.map(s=>t.getShape(s)).filter(s=>s&&t.isShapeOfType(s,"frame")));if(!o.length)return;const r=[];t.batch(()=>{o.map(s=>{const a=t.getSortedChildIdsForParent(s.id);a.length&&(t.reparentShapes(a,s.parentId,s.index),r.push(...a))}),t.setSelectedShapes(r),t.deleteShapes(n)})}const rZ=50;function nZ(t,n,o={}){const r=t.getShape(n);if(!r)return;const s=t.getSortedChildIdsForParent(r.id),a=Lt(s.map(p=>t.getShape(p)));if(!a.length)return;const i=mt.FromPoints(a.flatMap(p=>{const y=t.getShapeGeometry(p.id);return t.getShapeLocalTransform(p).applyToPoints(y.vertices)})),{padding:l=rZ}=o,c=i.w+2*l,u=i.h+2*l,f=l-i.minX,h=l-i.minY;if(f===0&&h===0&&r.props.w===c&&r.props.h===u)return;const d=new q(f,h).rot(r.rotation);t.batch(()=>{const p=s.map(y=>{const g=t.getShape(y);return{id:g.id,type:g.type,x:g.x+f,y:g.y+h}});p.push({id:r.id,type:r.type,x:r.x-d.x,y:r.y-d.y,props:{w:c,h:u}}),t.updateShapes(p)})}function jA(t){return Qo.isValid(t)?{isValid:!0,hasProtocol:!0}:Qo.isValid("https://"+t)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const oZ=qo(function({onClose:t}){const n=Be().getOnlySelectedShape();return n&&"url"in n.props&&typeof n.props.url=="string"?E.jsx(sZ,{onClose:t,selectedShape:n}):null}),sZ=qo(function({onClose:t,selectedShape:n}){const o=Be(),r=tr(),s=z.useRef(null);z.useEffect(()=>{requestAnimationFrame(()=>{var p;return(p=s.current)==null?void 0:p.focus()})},[]);const a=z.useRef(n.props.url),[i,l]=z.useState(()=>{const p=jA(n.props.url),y=p.isValid===!0?p.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:y,safe:y,valid:!0}}),c=z.useCallback(p=>{const y=p.replace(/https?:\/\/(https?:\/\/)/,(m,v)=>v),g=jA(y),b=g.isValid===!0?g.hasProtocol?y:"https://"+y:"https://";l({actual:y,safe:b,valid:g.isValid})},[]),u=z.useCallback(()=>{const p=o.getOnlySelectedShape();p&&(o.updateShapes([{id:p.id,type:p.type,props:{url:""}}]),t())},[o,t]),f=z.useCallback(()=>{const p=o.getOnlySelectedShape();p&&(p&&"url"in p.props&&p.props.url!==i.safe&&o.updateShapes([{id:p.id,type:p.type,props:{url:i.safe}}]),t())},[o,t,i]),h=z.useCallback(()=>{t()},[t]);if(!n)return t(),null;const d=a.current&&!i.valid;return E.jsxs(E.Fragment,{children:[E.jsxs(ly,{children:[E.jsx(cy,{children:r("edit-link-dialog.title")}),E.jsx(uy,{})]}),E.jsx(Dh,{children:E.jsxs("div",{className:"tlui-edit-link-dialog",children:[E.jsx(ww,{ref:s,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:i.actual,onValueChange:c,onComplete:f,onCancel:h}),E.jsx("div",{children:i.valid?r("edit-link-dialog.detail"):r("edit-link-dialog.invalid-url")})]})}),E.jsxs(xw,{className:"tlui-dialog__footer__actions",children:[E.jsx(It,{type:"normal",onClick:h,onTouchEnd:h,children:E.jsx(rn,{children:r("edit-link-dialog.cancel")})}),d?E.jsx(It,{type:"danger",onTouchEnd:u,onClick:u,children:E.jsx(rn,{children:r("edit-link-dialog.clear")})}):E.jsx(It,{type:"primary",disabled:!i.valid,onTouchEnd:f,onClick:f,children:E.jsx(rn,{children:r("edit-link-dialog.save")})})]})]})});var Sw={exports:{}};Sw.exports,function(t){var n=function(){var o=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function i(c,u){if(!a[c]){a[c]={};for(var f=0;f<c.length;f++)a[c][c.charAt(f)]=f}return a[c][u]}var l={compressToBase64:function(c){if(c==null)return"";var u=l._compress(c,6,function(f){return r.charAt(f)});switch(u.length%4){default:case 0:return u;case 1:return u+"===";case 2:return u+"==";case 3:return u+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:l._decompress(c.length,32,function(u){return i(r,c.charAt(u))})},compressToUTF16:function(c){return c==null?"":l._compress(c,15,function(u){return o(u+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:l._decompress(c.length,16384,function(u){return c.charCodeAt(u)-32})},compressToUint8Array:function(c){for(var u=l.compress(c),f=new Uint8Array(u.length*2),h=0,d=u.length;h<d;h++){var p=u.charCodeAt(h);f[h*2]=p>>>8,f[h*2+1]=p%256}return f},decompressFromUint8Array:function(c){if(c==null)return l.decompress(c);for(var u=new Array(c.length/2),f=0,h=u.length;f<h;f++)u[f]=c[f*2]*256+c[f*2+1];var d=[];return u.forEach(function(p){d.push(o(p))}),l.decompress(d.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":l._compress(c,6,function(u){return s.charAt(u)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),l._decompress(c.length,32,function(u){return i(s,c.charAt(u))}))},compress:function(c){return l._compress(c,16,function(u){return o(u)})},_compress:function(c,u,f){if(c==null)return"";var h,d,p={},y={},g="",b="",m="",v=2,x=3,w=2,S=[],k=0,_=0,C;for(C=0;C<c.length;C+=1)if(g=c.charAt(C),Object.prototype.hasOwnProperty.call(p,g)||(p[g]=x++,y[g]=!0),b=m+g,Object.prototype.hasOwnProperty.call(p,b))m=b;else{if(Object.prototype.hasOwnProperty.call(y,m)){if(m.charCodeAt(0)<256){for(h=0;h<w;h++)k=k<<1,_==u-1?(_=0,S.push(f(k)),k=0):_++;for(d=m.charCodeAt(0),h=0;h<8;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1}else{for(d=1,h=0;h<w;h++)k=k<<1|d,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=0;for(d=m.charCodeAt(0),h=0;h<16;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1}v--,v==0&&(v=Math.pow(2,w),w++),delete y[m]}else for(d=p[m],h=0;h<w;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1;v--,v==0&&(v=Math.pow(2,w),w++),p[b]=x++,m=String(g)}if(m!==""){if(Object.prototype.hasOwnProperty.call(y,m)){if(m.charCodeAt(0)<256){for(h=0;h<w;h++)k=k<<1,_==u-1?(_=0,S.push(f(k)),k=0):_++;for(d=m.charCodeAt(0),h=0;h<8;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1}else{for(d=1,h=0;h<w;h++)k=k<<1|d,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=0;for(d=m.charCodeAt(0),h=0;h<16;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1}v--,v==0&&(v=Math.pow(2,w),w++),delete y[m]}else for(d=p[m],h=0;h<w;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1;v--,v==0&&(v=Math.pow(2,w),w++)}for(d=2,h=0;h<w;h++)k=k<<1|d&1,_==u-1?(_=0,S.push(f(k)),k=0):_++,d=d>>1;for(;;)if(k=k<<1,_==u-1){S.push(f(k));break}else _++;return S.join("")},decompress:function(c){return c==null?"":c==""?null:l._decompress(c.length,32768,function(u){return c.charCodeAt(u)})},_decompress:function(c,u,f){var h=[],d=4,p=4,y=3,g="",b=[],m,v,x,w,S,k,_,C={val:f(0),position:u,index:1};for(m=0;m<3;m+=1)h[m]=m;for(x=0,S=Math.pow(2,2),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;switch(x){case 0:for(x=0,S=Math.pow(2,8),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;_=o(x);break;case 1:for(x=0,S=Math.pow(2,16),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;_=o(x);break;case 2:return""}for(h[3]=_,v=_,b.push(_);;){if(C.index>c)return"";for(x=0,S=Math.pow(2,y),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;switch(_=x){case 0:for(x=0,S=Math.pow(2,8),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;h[p++]=o(x),_=p-1,d--;break;case 1:for(x=0,S=Math.pow(2,16),k=1;k!=S;)w=C.val&C.position,C.position>>=1,C.position==0&&(C.position=u,C.val=f(C.index++)),x|=(w>0?1:0)*k,k<<=1;h[p++]=o(x),_=p-1,d--;break;case 2:return b.join("")}if(d==0&&(d=Math.pow(2,y),y++),h[_])g=h[_];else if(_===p)g=v+v.charAt(0);else return null;b.push(g),h[p++]=v+g.charAt(0),d--,v=g,d==0&&(d=Math.pow(2,y),y++)}}};return l}();t!=null?t.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})}(Sw);var _A=Sw.exports;async function iZ(t,n,o){var m,v,x;const{elements:r,files:s}=n,a={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},i=new Map,l=new Map,c=t.getCurrentPageId(),u=new Map,f=[],h=new Set;r.forEach(w=>{if(u.set(w.id,ur()),w.boundElements!==null)for(const S of w.boundElements)S.type==="text"&&h.add(S.id)});let d=YR;for(const w of r){if(h.has(w.id))continue;const S=u.get(w.id),k={id:S,typeName:"shape",parentId:c,index:d,x:w.x,y:w.y,rotation:0,isLocked:w.locked,opacity:aZ(w.opacity),meta:{}};switch(w.angle!==0&&l.set(S,w.angle),w.groupIds&&w.groupIds.length>0?i.has(w.groupIds[0])?(m=i.get(w.groupIds[0]))==null||m.push(S):i.set(w.groupIds[0],[S]):f.push(S),w.type){case"rectangle":case"ellipse":case"diamond":{let _="",C="middle";if(w.boundElements!==null){for(const A of w.boundElements)if(A.type==="text"){const I=r.find(N=>N.id===A.id);I&&(_=I.text,C=kA[I.textAlign])}}const P=w.backgroundColor==="transparent"?w.strokeColor:w.backgroundColor;a.shapes.push({...k,type:"geo",props:{geo:w.type,url:w.link??"",w:w.width,h:w.height,size:dy[w.strokeWidth]??"draw",color:Fh[P]??"black",text:_,align:C,dash:hy(w),fill:fZ(w)}});break}case"freedraw":{a.shapes.push({...k,type:"draw",props:{dash:hy(w),size:dy[w.strokeWidth],color:Fh[w.strokeColor]??"black",segments:[{type:"free",points:w.points.map(([_,C,P=.5])=>({x:_,y:C,z:P}))}]}});break}case"line":{const _=w.points[0],C=w.points[w.points.length-1],P=Vd(w.points.length);a.shapes.push({...k,type:"line",props:{dash:hy(w),size:dy[w.strokeWidth],color:Fh[w.strokeColor]??"black",spline:w.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:P[0],x:_[0],y:_[1]},end:{id:"end",type:"vertex",index:P[P.length-1],x:C[0],y:C[1]},...Object.fromEntries(w.points.slice(1,-1).map(([A,I],N)=>{const O=Ir();return[O,{id:O,type:"vertex",index:P[N+1],x:A,y:I}]}))}}});break}case"arrow":{let _="";if(w.boundElements!==null){for(const N of w.boundElements)if(N.type==="text"){const O=r.find(F=>F.id===N.id);O&&(_=O.text)}}const C=w.points[0],P=w.points[w.points.length-1],A=u.get((v=w.startBinding)==null?void 0:v.elementId),I=u.get((x=w.endBinding)==null?void 0:x.elementId);a.shapes.push({...k,type:"arrow",props:{text:_,bend:pZ(w,C,P),dash:hy(w),size:dy[w.strokeWidth]??"m",color:Fh[w.strokeColor]??"black",start:A?{type:"binding",boundShapeId:A,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:C[0],y:C[1]},end:I?{type:"binding",boundShapeId:I,normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1}:{type:"point",x:P[0],y:P[1]},arrowheadEnd:EA[w.endArrowhead]??"none",arrowheadStart:EA[w.startArrowhead]??"none"}});break}case"text":{const{size:_,scale:C}=cZ(w.fontSize);a.shapes.push({...k,type:"text",props:{size:_,scale:C,font:uZ[w.fontFamily]??"draw",color:Fh[w.strokeColor]??"black",text:w.text,align:kA[w.textAlign]}});break}case"image":{const _=s[w.fileId];if(!_)break;const C=Ll.createId();a.assets.push({id:C,typeName:"asset",type:"image",props:{w:w.width,h:w.height,name:w.id??"Untitled",isAnimated:!1,mimeType:_.mimeType,src:_.dataURL},meta:{}}),a.shapes.push({...k,type:"image",props:{w:w.width,h:w.height,assetId:C}})}}d=Di(d)}const p=o??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContentOntoCurrentPage(a,{point:p,select:!1,preserveIds:!0});for(const w of i.values())if(w.length>1){t.groupShapes(w);const S=t.getShape(w[0]);S!=null&&S.parentId&&Zo(S.parentId)&&f.push(S.parentId)}for(const[w,S]of l)t.select(w),t.rotateShapesBy([w],S);const y=Lt(f.map(w=>t.getShape(w))),g=mt.Common(y.map(w=>t.getShapePageBounds(w))),b=t.getViewportPageBounds().center;t.updateShapes(y.map(w=>{const S={x:(w.x??0)-(g.x+g.w/2),y:(w.y??0)-(g.y+g.h/2)};return{id:w.id,type:w.type,x:b.x+S.x,y:b.y+S.y}})),t.setSelectedShapes(f)}const aZ=t=>{const n=t/100;return n<.2?.1:n<.4?.25:n<.6?.5:n<.8?.75:1},dy={1:"s",2:"m",3:"l",4:"xl"},lZ={16:"s",20:"m",28:"l",36:"xl"};function cZ(t){const n=lZ[t];return n?{size:n,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}const uZ={1:"draw",2:"sans",3:"mono"},Fh={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},dZ={solid:"draw",dashed:"dashed",dotted:"dotted"},hZ={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},kA={left:"start",center:"middle",right:"end"},EA={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function pZ(t,n,o){let r=0;if(t.points.length>2){const s=new q(n[0],n[1]),a=new q(o[0],o[1]),i=new q(t.points[1][0],t.points[1][1]),l=q.Sub(a,s),c=q.Per(l),u=q.Med(a,s),f=q.Sub(u,c),h=q.Add(u,c),d=q.NearestPointOnLineSegment(f,h,i,!1);r=q.Dist(d,u),q.Clockwise(d,a,u)&&(r*=-1)}return r}const hy=t=>{let n=dZ[t.strokeStyle]??"draw";return n==="draw"&&t.roughness===0&&(n="solid"),n},fZ=t=>t.backgroundColor==="transparent"?"none":hZ[t.fillStyle]??"solid";async function CA(t,n,o,r){const s=(await Promise.all(n.map(async a=>await(await fetch(a)).blob()))).map(a=>new File([a],"tldrawFile",{type:a.type}));t.mark("paste"),await t.putExternalContent({type:"files",files:s,point:o,ignoreParent:!1,sources:r}),n.forEach(a=>URL.revokeObjectURL(a))}function mZ(t,n,o){const r=o??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0),s=t.getSelectionPageBounds();t.mark("paste"),t.putContentOntoCurrentPage(n,{point:r,select:!0});const a=t.getSelectionPageBounds();s&&a&&(s!=null&&s.collides(a))&&(t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0}),setTimeout(()=>{t.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},150))}async function jw(t,n,o,r){var s;try{if(new URL(n).pathname.match(/\.(png|jpe?g|gif|svg|webp)$/i)&&((s=(await fetch(n,{method:"HEAD"})).headers.get("content-type"))!=null&&s.match(/^image\//))){t.mark("paste"),CA(t,[n]);return}}catch(a){a.message!=="Failed to fetch"&&console.error(a)}return t.mark("paste"),await t.putExternalContent({type:"url",point:o,url:n,sources:r})}function gZ(t){const n=document.implementation.createHTMLDocument("");return n.documentElement.innerHTML=t.trim(),n.body.textContent||n.body.innerText||""}const yZ=t=>{try{const n=new URL(t);return n.protocol==="http:"||n.protocol==="https:"}catch{return!1}},vZ=t=>{const n=t.split(/[\n\s]/);for(const o of n)try{const r=new URL(o);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return TC(n)},bZ=t=>/^<svg/.test(t),xZ=["input","select","textarea"];function py(t){const{activeElement:n}=document;return t.getIsMenuOpen()||n&&(n.getAttribute("contenteditable")||xZ.indexOf(n.tagName.toLowerCase())>-1)}const wZ=t=>t.types.find(n=>n.match(/^image\//)),_w=(t,n,o,r)=>{const s=vZ(n);if(s)for(const a of s)jw(t,a,o);else yZ(n)?jw(t,n,o):bZ(n)?(t.mark("paste"),t.putExternalContent({type:"svg-text",text:n,point:o,sources:r})):(t.mark("paste"),t.putExternalContent({type:"text",text:n,point:o,sources:r}))},SZ=async(t,n,o)=>{if(t.getEditingShapeId()!==null)return;if(!n)throw Error("No clipboard data");const r=[];for(const s of Object.values(n.items))switch(s.kind){case"file":{r.push({type:"file",source:new Promise(a=>a(s.getAsFile()))});break}case"string":{s.type==="text/html"?r.push({type:"html",source:new Promise(a=>s.getAsString(a))}):s.type==="text/plain"?r.push({type:"text",source:new Promise(a=>s.getAsString(a))}):r.push({type:s.type,source:new Promise(a=>s.getAsString(a))});break}}MA(t,r,o)},PA=async(t,n,o)=>{const r=[];for(const s of n){if(wZ(s))for(const a of s.types)a.match(/^image\//)&&r.push({type:"blob",source:s.getType(a)});s.types.includes("text/html")&&r.push({type:"html",source:(async()=>{const a=await s.getType("text/html");return await Gc.blobToText(a)})()}),s.types.includes("text/uri-list")&&r.push({type:"url",source:(async()=>{const a=await s.getType("text/uri-list");return await Gc.blobToText(a)})()}),s.types.includes("text/plain")&&r.push({type:"text",source:(async()=>{const a=await s.getType("text/plain");return await Gc.blobToText(a)})()})}return await MA(t,r,o)};async function MA(t,n,o){const r=n.filter(a=>(a.type==="file"||a.type==="blob")&&a.source!==null);if(r.length){const a=(await Promise.all(r.map(i=>i.source))).filter(Boolean).map(i=>URL.createObjectURL(i));return await CA(t,a,o)}const s=await Promise.all(n.filter(a=>a.type!=="file").map(a=>new Promise(i=>{const l=a;if(l.type==="file"){i({type:"error",data:null,reason:"unexpected file"});return}l.source.then(c=>{var f;const u=(f=c.match(/<tldraw[^>]*>(.*)<\/tldraw>/))==null?void 0:f[1];if(u)try{const h=_A.decompressFromBase64(u);if(h===null){i({type:"error",data:h,reason:"found tldraw data comment but could not parse base64"});return}else{const d=JSON.parse(h);if(d.type!=="application/tldraw"&&i({type:"error",data:d,reason:`found tldraw data comment but JSON was of a different type: ${d.type}`}),typeof d.data=="string"){i({type:"error",data:d,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}i({type:"tldraw",data:d.data});return}}catch{i({type:"error",data:u,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(l.type==="html"){i({type:"text",data:c,subtype:"html"});return}if(l.type==="url"){i({type:"text",data:c,subtype:"url"});return}try{const h=JSON.parse(c);if(h.type==="excalidraw/clipboard"){i({type:"excalidraw",data:h});return}else{i({type:"text",data:c,subtype:"json"});return}}catch{i({type:"text",data:c,subtype:"text"});return}}i({type:"error",data:c,reason:"unhandled case"})})})));for(const a of s)if(a.type==="tldraw"){mZ(t,a.data,o);return}for(const a of s)if(a.type==="excalidraw"){iZ(t,a.data,o);return}for(const a of s)if(a.type==="text"&&a.subtype==="html"){const i=new DOMParser().parseFromString(a.data,"text/html").querySelector("body");if(i&&Array.from(i.children).filter(l=>l.nodeType===1).length===1&&i.firstElementChild&&i.firstElementChild.tagName==="A"&&i.firstElementChild.hasAttribute("href")&&i.firstElementChild.getAttribute("href")!==""){const l=i.firstElementChild.getAttribute("href");_w(t,l,o,s);return}if(!s.some(l=>l.type==="text"&&l.subtype!=="html")&&a.data.trim()){_w(t,gZ(a.data),o,s);return}}for(const a of s)if(a.type==="text"&&a.subtype==="url"){jw(t,a.data,o,s);return}for(const a of s)if(a.type==="text"&&a.subtype==="text"&&a.data.trim()){_w(t,a.data,o,s);return}}const fy=t=>{var r;const n=t.getContentFromCurrentPage(t.getSelectedShapeIds());if(!n){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const o=_A.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:n}));if(!(typeof navigator>"u")){const s=n.shapes.map(a=>t.isShapeOfType(a,"text")||t.isShapeOfType(a,"geo")||t.isShapeOfType(a,"arrow")?a.props.text:t.isShapeOfType(a,"bookmark")||t.isShapeOfType(a,"embed")?a.props.url:null).filter(nD);if((r=navigator.clipboard)!=null&&r.write){const a=new Blob([`<tldraw>${o}</tldraw>`],{type:"text/html"});let i=s.join(" ");i===""&&(i=" "),navigator.clipboard.write([new ClipboardItem({"text/html":a,"text/plain":new Blob([i],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${o}</tldraw>`)}};function jZ(){const t=Be(),n=mi(),o=z.useCallback(function(a){t.getSelectedShapeIds().length!==0&&(fy(t),n("copy",{source:a}))},[t,n]),r=z.useCallback(function(a){t.getSelectedShapeIds().length!==0&&(fy(t),t.deleteShapes(t.getSelectedShapeIds()),n("cut",{source:a}))},[t,n]),s=z.useCallback(async function(a,i,l){t.getEditingShapeId()!==null||py(t)||(Array.isArray(a)&&a[0]instanceof ClipboardItem?(PA(t,a,l),n("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{s(c,i,l)}))},[t,n]);return{copy:o,cut:r,paste:s}}function _Z(){const t=Be(),n=mi(),o=We("editor.isFocused",()=>t.getInstanceState().isFocused,[t]);z.useEffect(()=>{if(!o)return;const r=c=>{t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||py(t)||(Xt(c),fy(t),n("copy",{source:"kbd"}))};function s(c){t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||py(t)||(Xt(c),fy(t),t.deleteShapes(t.getSelectedShapeIds()),n("cut",{source:"kbd"}))}let a=!1;const i=c=>{c.button===1&&(a=!0,requestAnimationFrame(()=>{a=!1}))},l=c=>{if(a){On(c);return}t.getEditingShapeId()!==null||py(t)||(c.clipboardData&&!t.inputs.shiftKey?SZ(t,c.clipboardData):navigator.clipboard.read().then(u=>{Array.isArray(u)&&u[0]instanceof ClipboardItem&&PA(t,u,t.inputs.currentPagePoint)}),Xt(c),n("paste",{source:"kbd"}))};return document.addEventListener("copy",r),document.addEventListener("cut",s),document.addEventListener("paste",l),document.addEventListener("pointerup",i),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",s),document.removeEventListener("paste",l),document.removeEventListener("pointerup",i)}},[t,n,o])}async function TA(t,n,o){const{type:r,quality:s,scale:a,width:i,height:l}=o;let[c,u]=await FT(i*a,l*a);c=Math.floor(c),u=Math.floor(u);const f=c/i,h=URL.createObjectURL(new Blob([t],{type:"image/svg+xml"})),d=await new Promise(y=>{const g=new Image;g.crossOrigin="anonymous",g.onload=async()=>{n&&await new Promise(v=>setTimeout(v,250));const b=document.createElement("canvas"),m=b.getContext("2d");b.width=c,b.height=u,m.imageSmoothingEnabled=!0,m.imageSmoothingQuality="high",m.drawImage(g,0,0,c,u),URL.revokeObjectURL(h),y(b)},g.onerror=()=>{y(null)},g.src=h});if(!d)return null;const p=await new Promise(y=>d.toBlob(g=>{(!g||jn.throwToBlob.get())&&y(null),y(g)},"image/"+r,s));if(!p)return null;if(r==="png"){const y=new DataView(await p.arrayBuffer());return xi.setPhysChunk(y,f,{type:"image/"+r})}else return p}async function IA(t,n,o){const r=await t.getSvgString(n!=null&&n.length?n:[...t.getCurrentPageShapeIds()],{scale:1,background:t.getInstanceState().exportBackground,...o});if(!r)throw new Error("Could not construct SVG.");return r}async function kw(t,n,o,r={}){var s;switch(o){case"svg":return(s=await IA(t,n,r))==null?void 0:s.svg;case"json":{const a=t.getContentFromCurrentPage(n);return JSON.stringify(a)}default:Ri(o)}}async function AA({editor:t,ids:n,format:o,opts:r={}}){switch(o){case"svg":return new Blob([await kw(t,n,"svg",r)],{type:"text/plain"});case"json":return new Blob([await kw(t,n,"json",r)],{type:"text/plain"});case"jpeg":case"png":case"webp":{const s=await IA(t,n,r);if(!s)throw new Error("Could not construct image.");const a=await TA(s.svg,t.environment.isSafari,{type:o,quality:1,scale:2,width:s.width,height:s.height});if(!a)throw new Error("Could not construct image.");return a}default:Ri(o)}}const kZ={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",json:"text/plain",svg:"text/plain"};function EZ(t,n,o,r={}){return{blobPromise:AA({editor:t,ids:n,format:o,opts:r}),mimeType:kZ[o]}}function CZ(t,n,o="svg",r={}){if(!window.navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(window.navigator.clipboard.write){const{blobPromise:s,mimeType:a}=EZ(t,n,o,r);return window.navigator.clipboard.write([new ClipboardItem({[a]:s})]).catch(i=>(console.error(i),s.then(l=>window.navigator.clipboard.write([new ClipboardItem({[a]:l})]))))}switch(o){case"json":case"svg":return PZ(async()=>kw(t,n,o,r));case"jpeg":case"png":throw new Error("Copy not supported");default:Ri(o)}}async function PZ(t){var n,o;await((o=(n=navigator.clipboard)==null?void 0:n.writeText)==null?void 0:o.call(n,await t()))}function MZ(){const t=Be(),{addToast:n}=Hs(),o=tr();return z.useCallback((r,s="svg")=>{CZ(t,r,s).catch(()=>{n({id:"copy-fail",severity:"warning",title:o("toast.error.copy-fail.title"),description:o("toast.error.copy-fail.desc")})})},[t,n,o])}async function TZ(t,n,o="png",r,s={}){if(!r&&(r=`shapes at ${OA()}`,n.length===1)){const l=t.getShape(n[0]);t.isShapeOfType(l,"frame")?r=l.props.name??"frame":r=`${l.id.replace(/:/,"_")} at ${OA()}`}r+=`.${o}`;const a=await AA({editor:t,ids:n,format:o,opts:s}),i=new File([a],r,{type:a.type});IZ(i)}function OA(){const t=new Date,n=String(t.getFullYear()).slice(2),o=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${n}-${o}-${r} ${s}.${a}.${i}`}function IZ(t){const n=document.createElement("a"),o=URL.createObjectURL(t);n.href=o,n.download=t.name,n.click(),URL.revokeObjectURL(o)}function AZ(){const t=Be(),{addToast:n}=Hs(),o=tr();return z.useCallback((r,s="png",a)=>{TZ(t,r,s,a,{scale:1,background:t.getInstanceState().exportBackground}).catch(i=>{console.error(i.message),n({id:"export-fail",title:o("toast.error.export-fail.title"),description:o("toast.error.export-fail.desc"),severity:"error"})})},[t,n,o])}function OZ(){const t=Be(),n=z.useRef(null),o=z.useRef(null);return z.useCallback(async function(){const r=document.createElement("div"),s=document.createElement("style"),a=(g,b)=>{g&&(g.innerHTML=""),b&&document.head.contains(b)&&document.head.removeChild(b),g&&document.body.contains(g)&&document.body.removeChild(g)};a(n.current,o.current),n.current=r,o.current=s;const i=`tl-print-surface-${Ir()}`;r.className=i,s.innerHTML=`
			.${i} {
				display: none;
			}

			.${i} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${i} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${i}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${i}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${i}__item__header {
					display: none;
				}

				.${i}__item__footer {
					display: none;
					text-align: right;
				}

				.${i}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(s),document.body.appendChild(r)},c=()=>{t.once("change-history",()=>{a(r,s)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function u(g,b,m){try{r.innerHTML+=`<div class="${i}__item">
        <div class="${i}__item__header">
          ${g.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${i}__item__main">
          ${m}
        </div>
        <div class="${i}__item__footer ${i}__item__footer__${b?"":"hide"}">
          ${b??""}
        </div>
      </div>`}catch(v){console.error(v)}}function f(){t.environment.isChromeForIos?(l(),window.print()):t.environment.isSafari?(l(),document.execCommand("print",!1)):window.print()}const h=t.getSelectedShapeIds(),d=t.getCurrentPageId(),p=t.getPages(),y={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.getSelectedShapeIds().length>0){const g=await t.getSvgString(h,y);if(g){const b=p.find(m=>m.id===d);u(`tldraw \u2014 ${b==null?void 0:b.name}`,null,g.svg),f()}}else{const g=t.getCurrentPage(),b=await t.getSvgString(t.getSortedChildIdsForParent(g.id),y);b&&(u(`tldraw \u2014 ${g.name}`,null,b.svg),f())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[t])}const LA=z.createContext({});function LZ(t){return Object.fromEntries(t.map(n=>[n.id,n]))}function Ou(t,n){if(t.getSelectedShapes().length===0)return t.getDocumentSettings().name||n}function RZ({overrides:t,children:n}){const o=Be(),{addDialog:r,clearDialogs:s}=Zl(),{clearToasts:a}=Hs(),i=tr(),l=bA(),c=OZ(),{cut:u,copy:f,paste:h}=jZ(),d=MZ(),p=AZ(),y=i("document.default-name"),g=mi(),b=z.useMemo(()=>{function m(){return o.isIn("select")||(o.complete(),o.setCurrentTool("select")),!1}function v(){return o.isIn("select")&&o.getSelectedShapeIds().length>0}const x=LZ([{id:"edit-link",label:"action.edit-link",icon:"link",onSelect(w){v()&&(m()||(g("edit-link",{source:w}),o.mark("edit-link"),r({component:oZ})))}},{id:"insert-embed",label:"action.insert-embed",kbd:"$i",onSelect(w){g("insert-embed",{source:w}),r({component:vA})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",onSelect(w){g("insert-media",{source:w}),l()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",onSelect(w){g("undo",{source:w}),o.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",onSelect(w){g("redo",{source:w}),o.redo()}},{id:"export-as-svg",label:{default:"action.export-as-svg",menu:"action.export-as-svg.short","context-menu":"action.export-as-svg.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("export-as",{format:"svg",source:w}),p(S,"svg",Ou(o,y)))}},{id:"export-as-png",label:{default:"action.export-as-png",menu:"action.export-as-png.short","context-menu":"action.export-as-png.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("export-as",{format:"png",source:w}),p(S,"png",Ou(o,y)))}},{id:"export-as-json",label:{default:"action.export-as-json",menu:"action.export-as-json.short","context-menu":"action.export-as-json.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("export-as",{format:"json",source:w}),p(S,"json",Ou(o,y)))}},{id:"export-all-as-svg",label:{default:"action.export-all-as-svg",menu:"action.export-all-as-svg.short","context-menu":"action.export-all-as-svg.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("export-all-as",{format:"svg",source:w}),p(Array.from(o.getCurrentPageShapeIds()),"svg",Ou(o,y)))}},{id:"export-all-as-png",label:{default:"action.export-all-as-png",menu:"action.export-all-as-png.short","context-menu":"action.export-all-as-png.short"},readonlyOk:!0,onSelect(w){const S=Array.from(o.getCurrentPageShapeIds().values());S.length!==0&&(g("export-all-as",{format:"png",source:w}),p(S,"png",Ou(o,y)))}},{id:"export-all-as-json",label:{default:"action.export-all-as-json",menu:"action.export-all-as-json.short","context-menu":"action.export-all-as-json.short"},readonlyOk:!0,onSelect(w){const S=Array.from(o.getCurrentPageShapeIds().values());S.length!==0&&(g("export-all-as",{format:"json",source:w}),p(S,"json",Ou(o,y)))}},{id:"copy-as-svg",label:{default:"action.copy-as-svg",menu:"action.copy-as-svg.short","context-menu":"action.copy-as-svg.short"},kbd:"$!c",readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("copy-as",{format:"svg",source:w}),d(S,"svg"))}},{id:"copy-as-png",label:{default:"action.copy-as-png",menu:"action.copy-as-png.short","context-menu":"action.copy-as-png.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("copy-as",{format:"png",source:w}),d(S,"png"))}},{id:"copy-as-json",label:{default:"action.copy-as-json",menu:"action.copy-as-json.short","context-menu":"action.copy-as-json.short"},readonlyOk:!0,onSelect(w){let S=o.getSelectedShapeIds();S.length===0&&(S=Array.from(o.getCurrentPageShapeIds().values())),S.length!==0&&(g("copy-as",{format:"json",source:w}),d(S,"json"))}},{id:"toggle-auto-size",label:"action.toggle-auto-size",onSelect(w){if(!v()||m())return;g("toggle-auto-size",{source:w}),o.mark("toggling auto size");const S=o.getSelectedShapes().filter(k=>o.isShapeOfType(k,"text")&&k.props.autoSize===!1);o.updateShapes(S.map(k=>({id:k.id,type:k.type,props:{...k.props,w:8,autoSize:!0}}))),Sr(o,S.map(k=>k.id))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(w){g("open-embed-link",{source:w});const S=o.getSelectedShapeIds(),k="No embed shapes selected";if(S.length!==1){console.error(k);return}const _=o.getShape(S[0]);if(!_||!o.isShapeOfType(_,"embed")){console.error(k);return}Fz(_.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(w){var S,k;if(((S=o.root.getCurrent())==null?void 0:S.id)!=="zoom"&&(g("zoom-tool",{source:w}),!(o.inputs.shiftKey||o.inputs.ctrlKey))){const _=o.root.getCurrent();_&&((k=_.getCurrent())==null?void 0:k.id)==="idle"&&o.setCurrentTool("zoom",{onInteractionEnd:_.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",onSelect(w){v()&&(m()||o.batch(()=>{g("convert-to-bookmark",{source:w});const S=o.getSelectedShapes(),k=[],_=[];for(const C of S){if(!C||!o.isShapeOfType(C,"embed")||!C.props.url)continue;const P=new q(C.x,C.y);P.rot(-C.rotation),P.add(new q(C.props.w/2-300/2,C.props.h/2-320/2)),P.rot(C.rotation);const A={id:ur(),type:"bookmark",rotation:C.rotation,x:P.x,y:P.y,opacity:1,props:{url:C.props.url}};k.push(A),_.push(C.id)}o.mark("convert shapes to bookmark"),o.deleteShapes(_),o.createShapes(k)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",onSelect(w){v()&&(m()||(g("convert-to-embed",{source:w}),o.batch(()=>{const S=o.getSelectedShapeIds(),k=Lt(S.map(P=>o.getShape(P))),_=[],C=[];for(const P of k){if(!o.isShapeOfType(P,"bookmark"))continue;const{url:A}=P.props,I=Xa(P.props.url);if(!I||!I.definition)continue;const{width:N,height:O}=I.definition,F=new q(P.x,P.y);F.rot(-P.rotation),F.add(new q(P.props.w/2-N/2,P.props.h/2-O/2)),F.rot(P.rotation);const U={id:ur(),type:"embed",x:F.x,y:F.y,rotation:P.rotation,props:{url:A,w:N,h:O}};_.push(U),C.push(P.id)}o.mark("convert shapes to embed"),o.deleteShapes(C),o.createShapes(_)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",onSelect(w){if(!v()||m())return;g("duplicate-shapes",{source:w});const S=o.getInstanceState();let k,_;if(S.duplicateProps)k=S.duplicateProps.shapeIds,_=S.duplicateProps.offset;else{k=o.getSelectedShapeIds();const C=mt.Common(Lt(k.map(P=>o.getShapePageBounds(P))));_=S.canMoveCamera?{x:C.width+20,y:0}:{x:20,y:20}}o.mark("duplicate shapes"),o.duplicateShapes(k,_),S.duplicateProps&&o.updateInstanceState({duplicateProps:{...S.duplicateProps,shapeIds:o.getSelectedShapeIds()}})}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",onSelect(w){v()&&(m()||(g("ungroup-shapes",{source:w}),o.mark("ungroup"),o.ungroupShapes(o.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",onSelect(w){if(!v()||m())return;g("group-shapes",{source:w});const S=o.getOnlySelectedShape();S&&o.isShapeOfType(S,"group")?(o.mark("ungroup"),o.ungroupShapes(o.getSelectedShapeIds())):(o.mark("group"),o.groupShapes(o.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",onSelect(w){if(!v())return;g("remove-frame",{source:w});const S=o.getSelectedShapes();S.length>0&&S.every(k=>o.isShapeOfType(k,"frame"))&&(o.mark("remove-frame"),tZ(o,S.map(k=>k.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",onSelect(w){if(!v())return;g("fit-frame-to-content",{source:w});const S=o.getOnlySelectedShape();S&&o.isShapeOfType(S,"frame")&&(o.mark("fit-frame-to-content"),nZ(o,S.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"left",source:w}),o.mark("align left");const S=o.getSelectedShapeIds();o.alignShapes(S,"left"),Sr(o,S)}},{id:"align-center-horizontal",label:{default:"action.align-center-horizontal","context-menu":"action.align-center-horizontal.short"},kbd:"?H",icon:"align-center-horizontal",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"center-horizontal",source:w}),o.mark("align center horizontal");const S=o.getSelectedShapeIds();o.alignShapes(S,"center-horizontal"),Sr(o,S)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"right",source:w}),o.mark("align right");const S=o.getSelectedShapeIds();o.alignShapes(S,"right"),Sr(o,S)}},{id:"align-center-vertical",label:{default:"action.align-center-vertical","context-menu":"action.align-center-vertical.short"},kbd:"?V",icon:"align-center-vertical",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"center-vertical",source:w}),o.mark("align center vertical");const S=o.getSelectedShapeIds();o.alignShapes(S,"center-vertical"),Sr(o,S)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"top",source:w}),o.mark("align top");const S=o.getSelectedShapeIds();o.alignShapes(S,"top"),Sr(o,S)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",onSelect(w){if(!v()||m())return;g("align-shapes",{operation:"bottom",source:w}),o.mark("align bottom");const S=o.getSelectedShapeIds();o.alignShapes(S,"bottom"),Sr(o,S)}},{id:"distribute-horizontal",label:{default:"action.distribute-horizontal","context-menu":"action.distribute-horizontal.short"},icon:"distribute-horizontal",kbd:"?!h",onSelect(w){if(!v()||m())return;g("distribute-shapes",{operation:"horizontal",source:w}),o.mark("distribute horizontal");const S=o.getSelectedShapeIds();o.distributeShapes(S,"horizontal"),Sr(o,S)}},{id:"distribute-vertical",label:{default:"action.distribute-vertical","context-menu":"action.distribute-vertical.short"},icon:"distribute-vertical",kbd:"?!V",onSelect(w){if(!v()||m())return;g("distribute-shapes",{operation:"vertical",source:w}),o.mark("distribute vertical");const S=o.getSelectedShapeIds();o.distributeShapes(S,"vertical"),Sr(o,S)}},{id:"stretch-horizontal",label:{default:"action.stretch-horizontal","context-menu":"action.stretch-horizontal.short"},icon:"stretch-horizontal",onSelect(w){if(!v()||m())return;g("stretch-shapes",{operation:"horizontal",source:w}),o.mark("stretch horizontal");const S=o.getSelectedShapeIds();o.stretchShapes(S,"horizontal"),Sr(o,S)}},{id:"stretch-vertical",label:{default:"action.stretch-vertical","context-menu":"action.stretch-vertical.short"},icon:"stretch-vertical",onSelect(w){if(!v()||m())return;g("stretch-shapes",{operation:"vertical",source:w}),o.mark("stretch vertical");const S=o.getSelectedShapeIds();o.stretchShapes(S,"vertical"),Sr(o,S)}},{id:"flip-horizontal",label:{default:"action.flip-horizontal","context-menu":"action.flip-horizontal.short"},kbd:"!h",onSelect(w){if(!v()||m())return;g("flip-shapes",{operation:"horizontal",source:w}),o.mark("flip horizontal");const S=o.getSelectedShapeIds();o.flipShapes(S,"horizontal"),Sr(o,S)}},{id:"flip-vertical",label:{default:"action.flip-vertical","context-menu":"action.flip-vertical.short"},kbd:"!v",onSelect(w){if(!v()||m())return;g("flip-shapes",{operation:"vertical",source:w}),o.mark("flip vertical");const S=o.getSelectedShapeIds();o.flipShapes(S,"vertical"),Sr(o,S)}},{id:"pack",label:"action.pack",icon:"pack",onSelect(w){if(!v()||m())return;g("pack-shapes",{source:w}),o.mark("pack");const S=o.getSelectedShapeIds();o.packShapes(S,16),Sr(o,S)}},{id:"stack-vertical",label:{default:"action.stack-vertical","context-menu":"action.stack-vertical.short"},icon:"stack-vertical",onSelect(w){if(!v()||m())return;g("stack-shapes",{operation:"vertical",source:w}),o.mark("stack-vertical");const S=o.getSelectedShapeIds();o.stackShapes(S,"vertical",16),Sr(o,S)}},{id:"stack-horizontal",label:{default:"action.stack-horizontal","context-menu":"action.stack-horizontal.short"},icon:"stack-horizontal",onSelect(w){if(!v()||m())return;g("stack-shapes",{operation:"horizontal",source:w}),o.mark("stack-horizontal");const S=o.getSelectedShapeIds();o.stackShapes(S,"horizontal",16),Sr(o,S)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",onSelect(w){v()&&(m()||(g("reorder-shapes",{operation:"toFront",source:w}),o.mark("bring to front"),o.bringToFront(o.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",onSelect(w){v()&&(m()||(g("reorder-shapes",{operation:"forward",source:w}),o.mark("bring forward"),o.bringForward(o.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",onSelect(w){v()&&(m()||(g("reorder-shapes",{operation:"backward",source:w}),o.mark("send backward"),o.sendBackward(o.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",onSelect(w){v()&&(m()||(g("reorder-shapes",{operation:"toBack",source:w}),o.mark("send to back"),o.sendToBack(o.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",onSelect(w){v()&&(m()||(o.mark("cut"),u(w)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(w){v()&&(m()||f(w))}},{id:"paste",label:"action.paste",kbd:"$v",onSelect(w){var S;(S=navigator.clipboard)==null||S.read().then(k=>{h(k,w,w==="context-menu"?o.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(w){o.batch(()=>{m()||(g("select-all-shapes",{source:w}),o.mark("select all kbd"),o.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(w){v()&&(m()||(g("select-none-shapes",{source:w}),o.mark("select none"),o.selectNone()))}},{id:"delete",label:"action.delete",kbd:"\u232B,del,backspace",icon:"trash",onSelect(w){v()&&(m()||(g("delete-shapes",{source:w}),o.mark("delete"),o.deleteShapes(o.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",onSelect(w){if(!v()||m())return;g("rotate-cw",{source:w}),o.mark("rotate-cw");const S=o.getSelectionRotation()%(hr/2),k=th(S,0)||th(S,hr/2),_=o.getSelectedShapeIds();o.rotateShapesBy(_,hr/2-(k?0:S)),Sr(o,_)}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",onSelect(w){if(!v()||m())return;g("rotate-ccw",{source:w}),o.mark("rotate-ccw");const S=o.getSelectionRotation()%(hr/2),k=th(S,0),_=o.getSelectedShapeIds();o.rotateShapesBy(_,k?-(hr/2):-S),Sr(o,_)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(w){g("zoom-in",{source:w}),o.zoomIn(o.getViewportScreenCenter(),{duration:si})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(w){g("zoom-out",{source:w}),o.zoomOut(o.getViewportScreenCenter(),{duration:si})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(w){g("reset-zoom",{source:w}),o.resetZoom(o.getViewportScreenCenter(),{duration:si})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(w){g("zoom-to-fit",{source:w}),o.zoomToFit({duration:si})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(w){v()&&(m()||(g("zoom-to-selection",{source:w}),o.zoomToSelection({duration:si})))}},{id:"toggle-snap-mode",label:{default:"action.toggle-snap-mode",menu:"action.toggle-snap-mode.menu"},onSelect(w){g("toggle-snap-mode",{source:w}),o.user.updateUserPreferences({isSnapMode:!o.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:{default:"action.toggle-dark-mode",menu:"action.toggle-dark-mode.menu"},kbd:"$/",readonlyOk:!0,onSelect(w){g("toggle-dark-mode",{source:w}),o.user.updateUserPreferences({isDarkMode:!o.user.getIsDarkMode()})},checkbox:!0},{id:"toggle-wrap-mode",label:{default:"action.toggle-wrap-mode",menu:"action.toggle-wrap-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-wrap-mode",{source:w}),o.user.updateUserPreferences({isWrapMode:!o.user.getIsWrapMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:{default:"action.toggle-reduce-motion",menu:"action.toggle-reduce-motion.menu"},readonlyOk:!0,onSelect(w){g("toggle-reduce-motion",{source:w}),o.user.updateUserPreferences({animationSpeed:o.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:{default:"action.toggle-edge-scrolling",menu:"action.toggle-edge-scrolling.menu"},readonlyOk:!0,onSelect(w){g("toggle-edge-scrolling",{source:w}),o.user.updateUserPreferences({edgeScrollSpeed:o.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:{default:"action.toggle-transparent",menu:"action.toggle-transparent.menu","context-menu":"action.toggle-transparent.context-menu"},readonlyOk:!0,onSelect(w){g("toggle-transparent",{source:w}),o.updateInstanceState({exportBackground:!o.getInstanceState().exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:{default:"action.toggle-tool-lock",menu:"action.toggle-tool-lock.menu"},kbd:"q",onSelect(w){g("toggle-tool-lock",{source:w}),o.updateInstanceState({isToolLocked:!o.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",onSelect(w){g("unlock-all",{source:w});const S=[];for(const k of o.getCurrentPageShapes())k.isLocked&&S.push({id:k.id,type:k.type,isLocked:!1});S.length>0&&o.updateShapes(S)}},{id:"toggle-focus-mode",label:{default:"action.toggle-focus-mode",menu:"action.toggle-focus-mode.menu"},readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(w){requestAnimationFrame(()=>{o.batch(()=>{g("toggle-focus-mode",{source:w}),s(),a(),o.updateInstanceState({isFocusMode:!o.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:{default:"action.toggle-grid",menu:"action.toggle-grid.menu"},readonlyOk:!0,kbd:"$'",onSelect(w){g("toggle-grid-mode",{source:w}),o.updateInstanceState({isGridMode:!o.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:{default:"action.toggle-debug-mode",menu:"action.toggle-debug-mode.menu"},readonlyOk:!0,onSelect(w){g("toggle-debug-mode",{source:w}),o.updateInstanceState({isDebugMode:!o.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(w){g("print",{source:w}),c()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(w){g("exit-pen-mode",{source:w}),o.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(w){g("stop-following",{source:w}),o.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(w){g("zoom-to-content",{source:w}),o.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",kbd:"!l",onSelect(w){o.mark("locking"),g("toggle-lock",{source:w}),o.toggleLock(o.getSelectedShapeIds())}},{id:"new-page",label:"context.pages.new-page",onSelect(w){const S=Ui.createId(),k=o.getSelectedShapeIds();o.batch(()=>{o.mark("move_shapes_to_page"),o.createPage({name:i("page-menu.new-page-initial-name"),id:S}),o.moveShapesToPage(k,S)}),g("new-page",{source:w})}},{id:"select-white-color",label:"color-style.white",kbd:"?t",onSelect(w){const S=Jo;o.batch(()=>{o.mark("change-color"),o.isIn("select")&&o.setStyleForSelectedShapes(S,"white",{squashing:!1}),o.setStyleForNextShapes(S,"white",{squashing:!1}),o.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),g("set-style",{source:w,id:S.id,value:"white"})}}]);return t?t(o,x,void 0):x},[o,g,t,r,l,p,d,u,f,h,s,a,c,i,y]);return E.jsx(LA.Provider,{value:b,children:n})}function _t(){const t=z.useContext(LA);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function Nh(t,n){return t?typeof t=="string"?t:n?t[n]??t.default:void 0:void 0}const DZ=["top","right","bottom","left"],el=Math.min,os=Math.max,my=Math.round,gy=Math.floor,tl=t=>({x:t,y:t}),FZ={left:"right",right:"left",bottom:"top",top:"bottom"},NZ={start:"end",end:"start"};function Ew(t,n,o){return os(t,el(n,o))}function ea(t,n){return typeof t=="function"?t(n):t}function ta(t){return t.split("-")[0]}function Lu(t){return t.split("-")[1]}function Cw(t){return t==="x"?"y":"x"}function Pw(t){return t==="y"?"height":"width"}function Ru(t){return["top","bottom"].includes(ta(t))?"y":"x"}function Mw(t){return Cw(Ru(t))}function UZ(t,n,o){o===void 0&&(o=!1);const r=Lu(t),s=Mw(t),a=Pw(s);let i=s==="x"?r===(o?"end":"start")?"right":"left":r==="start"?"bottom":"top";return n.reference[a]>n.floating[a]&&(i=yy(i)),[i,yy(i)]}function BZ(t){const n=yy(t);return[Tw(t),n,Tw(n)]}function Tw(t){return t.replace(/start|end/g,n=>NZ[n])}function zZ(t,n,o){const r=["left","right"],s=["right","left"],a=["top","bottom"],i=["bottom","top"];switch(t){case"top":case"bottom":return o?n?s:r:n?r:s;case"left":case"right":return n?a:i;default:return[]}}function GZ(t,n,o,r){const s=Lu(t);let a=zZ(ta(t),o==="start",r);return s&&(a=a.map(i=>i+"-"+s),n&&(a=a.concat(a.map(Tw)))),a}function yy(t){return t.replace(/left|right|bottom|top/g,n=>FZ[n])}function VZ(t){return{top:0,right:0,bottom:0,left:0,...t}}function RA(t){return typeof t!="number"?VZ(t):{top:t,right:t,bottom:t,left:t}}function vy(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function DA(t,n,o){let{reference:r,floating:s}=t;const a=Ru(n),i=Mw(n),l=Pw(i),c=ta(n),u=a==="y",f=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,d=r[l]/2-s[l]/2;let p;switch(c){case"top":p={x:f,y:r.y-s.height};break;case"bottom":p={x:f,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch(Lu(n)){case"start":p[i]-=d*(o&&u?-1:1);break;case"end":p[i]+=d*(o&&u?-1:1);break}return p}const HZ=async(t,n,o)=>{const{placement:r="bottom",strategy:s="absolute",middleware:a=[],platform:i}=o,l=a.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(n));let u=await i.getElementRects({reference:t,floating:n,strategy:s}),{x:f,y:h}=DA(u,r,c),d=r,p={},y=0;for(let g=0;g<l.length;g++){const{name:b,fn:m}=l[g],{x:v,y:x,data:w,reset:S}=await m({x:f,y:h,initialPlacement:r,placement:d,strategy:s,middlewareData:p,rects:u,platform:i,elements:{reference:t,floating:n}});f=v??f,h=x??h,p={...p,[b]:{...p[b],...w}},S&&y<=50&&(y++,typeof S=="object"&&(S.placement&&(d=S.placement),S.rects&&(u=S.rects===!0?await i.getElementRects({reference:t,floating:n,strategy:s}):S.rects),{x:f,y:h}=DA(u,d,c)),g=-1)}return{x:f,y:h,placement:d,strategy:s,middlewareData:p}};async function Uh(t,n){var o;n===void 0&&(n={});const{x:r,y:s,platform:a,rects:i,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=ea(n,t),y=RA(p),g=l[d?h==="floating"?"reference":"floating":h],b=vy(await a.getClippingRect({element:(o=await(a.isElement==null?void 0:a.isElement(g)))==null||o?g:g.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:c})),m=h==="floating"?{...i.floating,x:r,y:s}:i.reference,v=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),x=await(a.isElement==null?void 0:a.isElement(v))?await(a.getScale==null?void 0:a.getScale(v))||{x:1,y:1}:{x:1,y:1},w=vy(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:m,offsetParent:v,strategy:c}):m);return{top:(b.top-w.top+y.top)/x.y,bottom:(w.bottom-b.bottom+y.bottom)/x.y,left:(b.left-w.left+y.left)/x.x,right:(w.right-b.right+y.right)/x.x}}const WZ=t=>({name:"arrow",options:t,async fn(n){const{x:o,y:r,placement:s,rects:a,platform:i,elements:l,middlewareData:c}=n,{element:u,padding:f=0}=ea(t,n)||{};if(u==null)return{};const h=RA(f),d={x:o,y:r},p=Mw(s),y=Pw(p),g=await i.getDimensions(u),b=p==="y",m=b?"top":"left",v=b?"bottom":"right",x=b?"clientHeight":"clientWidth",w=a.reference[y]+a.reference[p]-d[p]-a.floating[y],S=d[p]-a.reference[p],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let _=k?k[x]:0;(!_||!await(i.isElement==null?void 0:i.isElement(k)))&&(_=l.floating[x]||a.floating[y]);const C=w/2-S/2,P=_/2-g[y]/2-1,A=el(h[m],P),I=el(h[v],P),N=A,O=_-g[y]-I,F=_/2-g[y]/2+C,U=Ew(N,F,O),G=!c.arrow&&Lu(s)!=null&&F!==U&&a.reference[y]/2-(F<N?A:I)-g[y]/2<0,Y=G?F<N?F-N:F-O:0;return{[p]:d[p]+Y,data:{[p]:U,centerOffset:F-U-Y,...G&&{alignmentOffset:Y}},reset:G}}}),$Z=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(n){var o,r;const{placement:s,middlewareData:a,rects:i,initialPlacement:l,platform:c,elements:u}=n,{mainAxis:f=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:g=!0,...b}=ea(t,n);if((o=a.arrow)!=null&&o.alignmentOffset)return{};const m=ta(s),v=ta(l)===l,x=await(c.isRTL==null?void 0:c.isRTL(u.floating)),w=d||(v||!g?[yy(l)]:BZ(l));!d&&y!=="none"&&w.push(...GZ(l,g,y,x));const S=[l,...w],k=await Uh(n,b),_=[];let C=((r=a.flip)==null?void 0:r.overflows)||[];if(f&&_.push(k[m]),h){const N=UZ(s,i,x);_.push(k[N[0]],k[N[1]])}if(C=[...C,{placement:s,overflows:_}],!_.every(N=>N<=0)){var P,A;const N=(((P=a.flip)==null?void 0:P.index)||0)+1,O=S[N];if(O)return{data:{index:N,overflows:C},reset:{placement:O}};let F=(A=C.filter(U=>U.overflows[0]<=0).sort((U,G)=>U.overflows[1]-G.overflows[1])[0])==null?void 0:A.placement;if(!F)switch(p){case"bestFit":{var I;const U=(I=C.map(G=>[G.placement,G.overflows.filter(Y=>Y>0).reduce((Y,$)=>Y+$,0)]).sort((G,Y)=>G[1]-Y[1])[0])==null?void 0:I[0];U&&(F=U);break}case"initialPlacement":F=l;break}if(s!==F)return{reset:{placement:F}}}return{}}}};function FA(t,n){return{top:t.top-n.height,right:t.right-n.width,bottom:t.bottom-n.height,left:t.left-n.width}}function NA(t){return DZ.some(n=>t[n]>=0)}const qZ=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(n){const{rects:o}=n,{strategy:r="referenceHidden",...s}=ea(t,n);switch(r){case"referenceHidden":{const a=await Uh(n,{...s,elementContext:"reference"}),i=FA(a,o.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:NA(i)}}}case"escaped":{const a=await Uh(n,{...s,altBoundary:!0}),i=FA(a,o.floating);return{data:{escapedOffsets:i,escaped:NA(i)}}}default:return{}}}}};async function YZ(t,n){const{placement:o,platform:r,elements:s}=t,a=await(r.isRTL==null?void 0:r.isRTL(s.floating)),i=ta(o),l=Lu(o),c=Ru(o)==="y",u=["left","top"].includes(i)?-1:1,f=a&&c?-1:1,h=ea(n,t);let{mainAxis:d,crossAxis:p,alignmentAxis:y}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return l&&typeof y=="number"&&(p=l==="end"?y*-1:y),c?{x:p*f,y:d*u}:{x:d*u,y:p*f}}const KZ=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(n){var o,r;const{x:s,y:a,placement:i,middlewareData:l}=n,c=await YZ(n,t);return i===((o=l.offset)==null?void 0:o.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:i}}}}},XZ=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(n){const{x:o,y:r,placement:s}=n,{mainAxis:a=!0,crossAxis:i=!1,limiter:l={fn:b=>{let{x:m,y:v}=b;return{x:m,y:v}}},...c}=ea(t,n),u={x:o,y:r},f=await Uh(n,c),h=Ru(ta(s)),d=Cw(h);let p=u[d],y=u[h];if(a){const b=d==="y"?"top":"left",m=d==="y"?"bottom":"right",v=p+f[b],x=p-f[m];p=Ew(v,p,x)}if(i){const b=h==="y"?"top":"left",m=h==="y"?"bottom":"right",v=y+f[b],x=y-f[m];y=Ew(v,y,x)}const g=l.fn({...n,[d]:p,[h]:y});return{...g,data:{x:g.x-o,y:g.y-r}}}}},QZ=function(t){return t===void 0&&(t={}),{options:t,fn(n){const{x:o,y:r,placement:s,rects:a,middlewareData:i}=n,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=ea(t,n),f={x:o,y:r},h=Ru(s),d=Cw(h);let p=f[d],y=f[h];const g=ea(l,n),b=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const x=d==="y"?"height":"width",w=a.reference[d]-a.floating[x]+b.mainAxis,S=a.reference[d]+a.reference[x]-b.mainAxis;p<w?p=w:p>S&&(p=S)}if(u){var m,v;const x=d==="y"?"width":"height",w=["top","left"].includes(ta(s)),S=a.reference[h]-a.floating[x]+(w&&((m=i.offset)==null?void 0:m[h])||0)+(w?0:b.crossAxis),k=a.reference[h]+a.reference[x]+(w?0:((v=i.offset)==null?void 0:v[h])||0)-(w?b.crossAxis:0);y<S?y=S:y>k&&(y=k)}return{[d]:p,[h]:y}}}},ZZ=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(n){const{placement:o,rects:r,platform:s,elements:a}=n,{apply:i=()=>{},...l}=ea(t,n),c=await Uh(n,l),u=ta(o),f=Lu(o),h=Ru(o)==="y",{width:d,height:p}=r.floating;let y,g;u==="top"||u==="bottom"?(y=u,g=f===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(g=u,y=f==="end"?"top":"bottom");const b=p-c[y],m=d-c[g],v=!n.middlewareData.shift;let x=b,w=m;if(h){const k=d-c.left-c.right;w=f||v?el(m,k):k}else{const k=p-c.top-c.bottom;x=f||v?el(b,k):k}if(v&&!f){const k=os(c.left,0),_=os(c.right,0),C=os(c.top,0),P=os(c.bottom,0);h?w=d-2*(k!==0||_!==0?k+_:os(c.left,c.right)):x=p-2*(C!==0||P!==0?C+P:os(c.top,c.bottom))}await i({...n,availableWidth:w,availableHeight:x});const S=await s.getDimensions(a.floating);return d!==S.width||p!==S.height?{reset:{rects:!0}}:{}}}};function rl(t){return UA(t)?(t.nodeName||"").toLowerCase():"#document"}function ss(t){var n;return(t==null||(n=t.ownerDocument)==null?void 0:n.defaultView)||window}function ra(t){var n;return(n=(UA(t)?t.ownerDocument:t.document)||window.document)==null?void 0:n.documentElement}function UA(t){return t instanceof Node||t instanceof ss(t).Node}function na(t){return t instanceof Element||t instanceof ss(t).Element}function gi(t){return t instanceof HTMLElement||t instanceof ss(t).HTMLElement}function BA(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ss(t).ShadowRoot}function Bh(t){const{overflow:n,overflowX:o,overflowY:r,display:s}=bs(t);return/auto|scroll|overlay|hidden|clip/.test(n+r+o)&&!["inline","contents"].includes(s)}function JZ(t){return["table","td","th"].includes(rl(t))}function Iw(t){const n=Aw(),o=bs(t);return o.transform!=="none"||o.perspective!=="none"||(o.containerType?o.containerType!=="normal":!1)||!n&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!n&&(o.filter?o.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(o.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(o.contain||"").includes(r))}function eJ(t){let n=Du(t);for(;gi(n)&&!by(n);){if(Iw(n))return n;n=Du(n)}return null}function Aw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function by(t){return["html","body","#document"].includes(rl(t))}function bs(t){return ss(t).getComputedStyle(t)}function xy(t){return na(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Du(t){if(rl(t)==="html")return t;const n=t.assignedSlot||t.parentNode||BA(t)&&t.host||ra(t);return BA(n)?n.host:n}function zA(t){const n=Du(t);return by(n)?t.ownerDocument?t.ownerDocument.body:t.body:gi(n)&&Bh(n)?n:zA(n)}function zh(t,n,o){var r;n===void 0&&(n=[]),o===void 0&&(o=!0);const s=zA(t),a=s===((r=t.ownerDocument)==null?void 0:r.body),i=ss(s);return a?n.concat(i,i.visualViewport||[],Bh(s)?s:[],i.frameElement&&o?zh(i.frameElement):[]):n.concat(s,zh(s,[],o))}function GA(t){const n=bs(t);let o=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const s=gi(t),a=s?t.offsetWidth:o,i=s?t.offsetHeight:r,l=my(o)!==a||my(r)!==i;return l&&(o=a,r=i),{width:o,height:r,$:l}}function Ow(t){return na(t)?t:t.contextElement}function Fu(t){const n=Ow(t);if(!gi(n))return tl(1);const o=n.getBoundingClientRect(),{width:r,height:s,$:a}=GA(n);let i=(a?my(o.width):o.width)/r,l=(a?my(o.height):o.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const tJ=tl(0);function VA(t){const n=ss(t);return!Aw()||!n.visualViewport?tJ:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function rJ(t,n,o){return n===void 0&&(n=!1),!o||n&&o!==ss(t)?!1:n}function ec(t,n,o,r){n===void 0&&(n=!1),o===void 0&&(o=!1);const s=t.getBoundingClientRect(),a=Ow(t);let i=tl(1);n&&(r?na(r)&&(i=Fu(r)):i=Fu(t));const l=rJ(a,o,r)?VA(a):tl(0);let c=(s.left+l.x)/i.x,u=(s.top+l.y)/i.y,f=s.width/i.x,h=s.height/i.y;if(a){const d=ss(a),p=r&&na(r)?ss(r):r;let y=d,g=y.frameElement;for(;g&&r&&p!==y;){const b=Fu(g),m=g.getBoundingClientRect(),v=bs(g),x=m.left+(g.clientLeft+parseFloat(v.paddingLeft))*b.x,w=m.top+(g.clientTop+parseFloat(v.paddingTop))*b.y;c*=b.x,u*=b.y,f*=b.x,h*=b.y,c+=x,u+=w,y=ss(g),g=y.frameElement}}return vy({width:f,height:h,x:c,y:u})}const nJ=[":popover-open",":modal"];function HA(t){return nJ.some(n=>{try{return t.matches(n)}catch{return!1}})}function oJ(t){let{elements:n,rect:o,offsetParent:r,strategy:s}=t;const a=s==="fixed",i=ra(r),l=n?HA(n.floating):!1;if(r===i||l&&a)return o;let c={scrollLeft:0,scrollTop:0},u=tl(1);const f=tl(0),h=gi(r);if((h||!h&&!a)&&((rl(r)!=="body"||Bh(i))&&(c=xy(r)),gi(r))){const d=ec(r);u=Fu(r),f.x=d.x+r.clientLeft,f.y=d.y+r.clientTop}return{width:o.width*u.x,height:o.height*u.y,x:o.x*u.x-c.scrollLeft*u.x+f.x,y:o.y*u.y-c.scrollTop*u.y+f.y}}function sJ(t){return Array.from(t.getClientRects())}function WA(t){return ec(ra(t)).left+xy(t).scrollLeft}function iJ(t){const n=ra(t),o=xy(t),r=t.ownerDocument.body,s=os(n.scrollWidth,n.clientWidth,r.scrollWidth,r.clientWidth),a=os(n.scrollHeight,n.clientHeight,r.scrollHeight,r.clientHeight);let i=-o.scrollLeft+WA(t);const l=-o.scrollTop;return bs(r).direction==="rtl"&&(i+=os(n.clientWidth,r.clientWidth)-s),{width:s,height:a,x:i,y:l}}function aJ(t,n){const o=ss(t),r=ra(t),s=o.visualViewport;let a=r.clientWidth,i=r.clientHeight,l=0,c=0;if(s){a=s.width,i=s.height;const u=Aw();(!u||u&&n==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:a,height:i,x:l,y:c}}function lJ(t,n){const o=ec(t,!0,n==="fixed"),r=o.top+t.clientTop,s=o.left+t.clientLeft,a=gi(t)?Fu(t):tl(1),i=t.clientWidth*a.x,l=t.clientHeight*a.y,c=s*a.x,u=r*a.y;return{width:i,height:l,x:c,y:u}}function $A(t,n,o){let r;if(n==="viewport")r=aJ(t,o);else if(n==="document")r=iJ(ra(t));else if(na(n))r=lJ(n,o);else{const s=VA(t);r={...n,x:n.x-s.x,y:n.y-s.y}}return vy(r)}function qA(t,n){const o=Du(t);return o===n||!na(o)||by(o)?!1:bs(o).position==="fixed"||qA(o,n)}function cJ(t,n){const o=n.get(t);if(o)return o;let r=zh(t,[],!1).filter(l=>na(l)&&rl(l)!=="body"),s=null;const a=bs(t).position==="fixed";let i=a?Du(t):t;for(;na(i)&&!by(i);){const l=bs(i),c=Iw(i);!c&&l.position==="fixed"&&(s=null),(a?!c&&!s:!c&&l.position==="static"&&s&&["absolute","fixed"].includes(s.position)||Bh(i)&&!c&&qA(t,i))?r=r.filter(u=>u!==i):s=l,i=Du(i)}return n.set(t,r),r}function uJ(t){let{element:n,boundary:o,rootBoundary:r,strategy:s}=t;const a=[...o==="clippingAncestors"?cJ(n,this._c):[].concat(o),r],i=a[0],l=a.reduce((c,u)=>{const f=$A(n,u,s);return c.top=os(f.top,c.top),c.right=el(f.right,c.right),c.bottom=el(f.bottom,c.bottom),c.left=os(f.left,c.left),c},$A(n,i,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function dJ(t){const{width:n,height:o}=GA(t);return{width:n,height:o}}function hJ(t,n,o){const r=gi(n),s=ra(n),a=o==="fixed",i=ec(t,!0,a,n);let l={scrollLeft:0,scrollTop:0};const c=tl(0);if(r||!r&&!a)if((rl(n)!=="body"||Bh(s))&&(l=xy(n)),r){const h=ec(n,!0,a,n);c.x=h.x+n.clientLeft,c.y=h.y+n.clientTop}else s&&(c.x=WA(s));const u=i.left+l.scrollLeft-c.x,f=i.top+l.scrollTop-c.y;return{x:u,y:f,width:i.width,height:i.height}}function YA(t,n){return!gi(t)||bs(t).position==="fixed"?null:n?n(t):t.offsetParent}function KA(t,n){const o=ss(t);if(!gi(t)||HA(t))return o;let r=YA(t,n);for(;r&&JZ(r)&&bs(r).position==="static";)r=YA(r,n);return r&&(rl(r)==="html"||rl(r)==="body"&&bs(r).position==="static"&&!Iw(r))?o:r||eJ(t)||o}const pJ=async function(t){const n=this.getOffsetParent||KA,o=this.getDimensions;return{reference:hJ(t.reference,await n(t.floating),t.strategy),floating:{x:0,y:0,...await o(t.floating)}}};function fJ(t){return bs(t).direction==="rtl"}const mJ={convertOffsetParentRelativeRectToViewportRelativeRect:oJ,getDocumentElement:ra,getClippingRect:uJ,getOffsetParent:KA,getElementRects:pJ,getClientRects:sJ,getDimensions:dJ,getScale:Fu,isElement:na,isRTL:fJ};function gJ(t,n){let o=null,r;const s=ra(t);function a(){var l;clearTimeout(r),(l=o)==null||l.disconnect(),o=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const{left:u,top:f,width:h,height:d}=t.getBoundingClientRect();if(l||n(),!h||!d)return;const p=gy(f),y=gy(s.clientWidth-(u+h)),g=gy(s.clientHeight-(f+d)),b=gy(u),m={rootMargin:-p+"px "+-y+"px "+-g+"px "+-b+"px",threshold:os(0,el(1,c))||1};let v=!0;function x(w){const S=w[0].intersectionRatio;if(S!==c){if(!v)return i();S?i(!1,S):r=setTimeout(()=>{i(!1,1e-7)},100)}v=!1}try{o=new IntersectionObserver(x,{...m,root:s.ownerDocument})}catch{o=new IntersectionObserver(x,m)}o.observe(t)}return i(!0),a}function yJ(t,n,o,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=Ow(t),f=s||a?[...u?zh(u):[],...zh(n)]:[];f.forEach(m=>{s&&m.addEventListener("scroll",o,{passive:!0}),a&&m.addEventListener("resize",o)});const h=u&&l?gJ(u,o):null;let d=-1,p=null;i&&(p=new ResizeObserver(m=>{let[v]=m;v&&v.target===u&&p&&(p.unobserve(n),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var x;(x=p)==null||x.observe(n)})),o()}),u&&!c&&p.observe(u),p.observe(n));let y,g=c?ec(t):null;c&&b();function b(){const m=ec(t);g&&(m.x!==g.x||m.y!==g.y||m.width!==g.width||m.height!==g.height)&&o(),g=m,y=requestAnimationFrame(b)}return o(),()=>{var m;f.forEach(v=>{s&&v.removeEventListener("scroll",o),a&&v.removeEventListener("resize",o)}),h==null||h(),(m=p)==null||m.disconnect(),p=null,c&&cancelAnimationFrame(y)}}const vJ=XZ,bJ=$Z,xJ=ZZ,wJ=qZ,XA=WZ,SJ=QZ,jJ=(t,n,o)=>{const r=new Map,s={platform:mJ,...o},a={...s.platform,_c:r};return HZ(t,n,{...s,platform:a})},_J=t=>{function n(o){return{}.hasOwnProperty.call(o,"current")}return{name:"arrow",options:t,fn(o){const{element:r,padding:s}=typeof t=="function"?t(o):t;return r&&n(r)?r.current!=null?XA({element:r.current,padding:s}).fn(o):{}:r?XA({element:r,padding:s}).fn(o):{}}}};var wy=typeof document<"u"?z.useLayoutEffect:z.useEffect;function Sy(t,n){if(t===n)return!0;if(typeof t!=typeof n)return!1;if(typeof t=="function"&&t.toString()===n.toString())return!0;let o,r,s;if(t&&n&&typeof t=="object"){if(Array.isArray(t)){if(o=t.length,o!==n.length)return!1;for(r=o;r--!==0;)if(!Sy(t[r],n[r]))return!1;return!0}if(s=Object.keys(t),o=s.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!{}.hasOwnProperty.call(n,s[r]))return!1;for(r=o;r--!==0;){const a=s[r];if(!(a==="_owner"&&t.$$typeof)&&!Sy(t[a],n[a]))return!1}return!0}return t!==t&&n!==n}function QA(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function ZA(t,n){const o=QA(t);return Math.round(n*o)/o}function JA(t){const n=z.useRef(t);return wy(()=>{n.current=t}),n}function kJ(t){t===void 0&&(t={});const{placement:n="bottom",strategy:o="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:i}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[f,h]=z.useState({x:0,y:0,strategy:o,placement:n,middlewareData:{},isPositioned:!1}),[d,p]=z.useState(r);Sy(d,r)||p(r);const[y,g]=z.useState(null),[b,m]=z.useState(null),v=z.useCallback(Y=>{Y!==k.current&&(k.current=Y,g(Y))},[]),x=z.useCallback(Y=>{Y!==_.current&&(_.current=Y,m(Y))},[]),w=a||y,S=i||b,k=z.useRef(null),_=z.useRef(null),C=z.useRef(f),P=c!=null,A=JA(c),I=JA(s),N=z.useCallback(()=>{if(!k.current||!_.current)return;const Y={placement:n,strategy:o,middleware:d};I.current&&(Y.platform=I.current),jJ(k.current,_.current,Y).then($=>{const H={...$,isPositioned:!0};O.current&&!Sy(C.current,H)&&(C.current=H,Tl.flushSync(()=>{h(H)}))})},[d,n,o,I]);wy(()=>{u===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,h(Y=>({...Y,isPositioned:!1})))},[u]);const O=z.useRef(!1);wy(()=>(O.current=!0,()=>{O.current=!1}),[]),wy(()=>{if(w&&(k.current=w),S&&(_.current=S),w&&S){if(A.current)return A.current(w,S,N);N()}},[w,S,N,A,P]);const F=z.useMemo(()=>({reference:k,floating:_,setReference:v,setFloating:x}),[v,x]),U=z.useMemo(()=>({reference:w,floating:S}),[w,S]),G=z.useMemo(()=>{const Y={position:o,left:0,top:0};if(!U.floating)return Y;const $=ZA(U.floating,f.x),H=ZA(U.floating,f.y);return l?{...Y,transform:"translate("+$+"px, "+H+"px)",...QA(U.floating)>=1.5&&{willChange:"transform"}}:{position:o,left:$,top:H}},[o,l,U.floating,f.x,f.y]);return z.useMemo(()=>({...f,update:N,refs:F,elements:U,floatingStyles:G}),[f,N,F,U,G])}function e5(t){const[n,o]=z.useState(void 0);return Ql(()=>{if(t){o({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let i,l;if("borderBoxSize"in a){const c=a.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,l=u.blockSize}else i=t.offsetWidth,l=t.offsetHeight;o({width:i,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else o(void 0)},[t]),n}const t5="Popper",[r5,jy]=hi(t5),[EJ,n5]=r5(t5),CJ=t=>{const{__scopePopper:n,children:o}=t,[r,s]=z.useState(null);return z.createElement(EJ,{scope:n,anchor:r,onAnchorChange:s},o)},PJ="PopperAnchor",MJ=z.forwardRef((t,n)=>{const{__scopePopper:o,virtualRef:r,...s}=t,a=n5(PJ,o),i=z.useRef(null),l=jr(n,i);return z.useEffect(()=>{a.onAnchorChange((r==null?void 0:r.current)||i.current)}),r?null:z.createElement(vr.div,ot({},s,{ref:l}))}),o5="PopperContent",[TJ,cse]=r5(o5),IJ=z.forwardRef((t,n)=>{var o,r,s,a,i,l,c,u;const{__scopePopper:f,side:h="bottom",sideOffset:d=0,align:p="center",alignOffset:y=0,arrowPadding:g=0,avoidCollisions:b=!0,collisionBoundary:m=[],collisionPadding:v=0,sticky:x="partial",hideWhenDetached:w=!1,updatePositionStrategy:S="optimized",onPlaced:k,..._}=t,C=n5(o5,f),[P,A]=z.useState(null),I=jr(n,de=>A(de)),[N,O]=z.useState(null),F=e5(N),U=(o=F==null?void 0:F.width)!==null&&o!==void 0?o:0,G=(r=F==null?void 0:F.height)!==null&&r!==void 0?r:0,Y=h+(p!=="center"?"-"+p:""),$=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},H=Array.isArray(m)?m:[m],Q=H.length>0,J={padding:$,boundary:H.filter(AJ),altBoundary:Q},{refs:ae,floatingStyles:T,placement:B,isPositioned:W,middlewareData:K}=kJ({strategy:"fixed",placement:Y,whileElementsMounted:(...de)=>yJ(...de,{animationFrame:S==="always"}),elements:{reference:C.anchor},middleware:[KZ({mainAxis:d+G,alignmentAxis:y}),b&&vJ({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?SJ():void 0,...J}),b&&bJ({...J}),xJ({...J,apply:({elements:de,rects:xe,availableWidth:Ie,availableHeight:we})=>{const{width:_e,height:Ae}=xe.reference,$e=de.floating.style;$e.setProperty("--radix-popper-available-width",`${Ie}px`),$e.setProperty("--radix-popper-available-height",`${we}px`),$e.setProperty("--radix-popper-anchor-width",`${_e}px`),$e.setProperty("--radix-popper-anchor-height",`${Ae}px`)}}),N&&_J({element:N,padding:g}),OJ({arrowWidth:U,arrowHeight:G}),w&&wJ({strategy:"referenceHidden",...J})]}),[te,ne]=s5(B),ce=eo(k);Ql(()=>{W&&(ce==null||ce())},[W,ce]);const fe=(s=K.arrow)===null||s===void 0?void 0:s.x,ue=(a=K.arrow)===null||a===void 0?void 0:a.y,ge=((i=K.arrow)===null||i===void 0?void 0:i.centerOffset)!==0,[me,oe]=z.useState();return Ql(()=>{P&&oe(window.getComputedStyle(P).zIndex)},[P]),z.createElement("div",{ref:ae.setFloating,"data-radix-popper-content-wrapper":"",style:{...T,transform:W?T.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(l=K.transformOrigin)===null||l===void 0?void 0:l.x,(c=K.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},z.createElement(TJ,{scope:f,placedSide:te,onArrowChange:O,arrowX:fe,arrowY:ue,shouldHideArrow:ge},z.createElement(vr.div,ot({"data-side":te,"data-align":ne},_,{ref:I,style:{..._.style,animation:W?void 0:"none",opacity:(u=K.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function AJ(t){return t!==null}const OJ=t=>({name:"transformOrigin",options:t,fn(n){var o,r,s,a,i;const{placement:l,rects:c,middlewareData:u}=n,f=((o=u.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,h=f?0:t.arrowWidth,d=f?0:t.arrowHeight,[p,y]=s5(l),g={start:"0%",center:"50%",end:"100%"}[y],b=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+h/2,m=((a=(i=u.arrow)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0)+d/2;let v="",x="";return p==="bottom"?(v=f?g:`${b}px`,x=`${-d}px`):p==="top"?(v=f?g:`${b}px`,x=`${c.floating.height+d}px`):p==="right"?(v=`${-d}px`,x=f?g:`${m}px`):p==="left"&&(v=`${c.floating.width+d}px`,x=f?g:`${m}px`),{data:{x:v,y:x}}}});function s5(t){const[n,o="center"]=t.split("-");return[n,o]}const Lw=CJ,i5=MJ,a5=IJ,l5="Popover",[c5,use]=hi(l5,[jy]),Rw=jy(),[LJ,Nu]=c5(l5),RJ=t=>{const{__scopePopover:n,children:o,open:r,defaultOpen:s,onOpenChange:a,modal:i=!1}=t,l=Rw(n),c=z.useRef(null),[u,f]=z.useState(!1),[h=!1,d]=Qa({prop:r,defaultProp:s,onChange:a});return z.createElement(Lw,l,z.createElement(LJ,{scope:n,contentId:Zi(),triggerRef:c,open:h,onOpenChange:d,onOpenToggle:z.useCallback(()=>d(p=>!p),[d]),hasCustomAnchor:u,onCustomAnchorAdd:z.useCallback(()=>f(!0),[]),onCustomAnchorRemove:z.useCallback(()=>f(!1),[]),modal:i},o))},DJ="PopoverTrigger",FJ=z.forwardRef((t,n)=>{const{__scopePopover:o,...r}=t,s=Nu(DJ,o),a=Rw(o),i=jr(n,s.triggerRef),l=z.createElement(vr.button,ot({type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":h5(s.open)},r,{ref:i,onClick:xt(t.onClick,s.onOpenToggle)}));return s.hasCustomAnchor?l:z.createElement(i5,ot({asChild:!0},a),l)}),u5="PopoverPortal",[NJ,UJ]=c5(u5,{forceMount:void 0}),BJ=t=>{const{__scopePopover:n,forceMount:o,children:r,container:s}=t,a=Nu(u5,n);return z.createElement(NJ,{scope:n,forceMount:o},z.createElement(pi,{present:o||a.open},z.createElement(Xg,{asChild:!0,container:s},r)))},Gh="PopoverContent",zJ=z.forwardRef((t,n)=>{const o=UJ(Gh,t.__scopePopover),{forceMount:r=o.forceMount,...s}=t,a=Nu(Gh,t.__scopePopover);return z.createElement(pi,{present:r||a.open},a.modal?z.createElement(GJ,ot({},s,{ref:n})):z.createElement(VJ,ot({},s,{ref:n})))}),GJ=z.forwardRef((t,n)=>{const o=Nu(Gh,t.__scopePopover),r=z.useRef(null),s=jr(n,r),a=z.useRef(!1);return z.useEffect(()=>{const i=r.current;if(i)return gw(i)},[]),z.createElement(fw,{as:Xl,allowPinchZoom:!0},z.createElement(d5,ot({},t,{ref:s,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:xt(t.onCloseAutoFocus,i=>{var l;i.preventDefault(),a.current||(l=o.triggerRef.current)===null||l===void 0||l.focus()}),onPointerDownOutside:xt(t.onPointerDownOutside,i=>{const l=i.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;a.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:xt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})))}),VJ=z.forwardRef((t,n)=>{const o=Nu(Gh,t.__scopePopover),r=z.useRef(!1),s=z.useRef(!1);return z.createElement(d5,ot({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i;if((i=t.onCloseAutoFocus)===null||i===void 0||i.call(t,a),!a.defaultPrevented){var l;r.current||(l=o.triggerRef.current)===null||l===void 0||l.focus(),a.preventDefault()}r.current=!1,s.current=!1},onInteractOutside:a=>{var i,l;(i=t.onInteractOutside)===null||i===void 0||i.call(t,a),a.defaultPrevented||(r.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=a.target;!((l=o.triggerRef.current)===null||l===void 0)&&l.contains(c)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}}))}),d5=z.forwardRef((t,n)=>{const{__scopePopover:o,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:f,...h}=t,d=Nu(Gh,o),p=Rw(o);return cw(),z.createElement(aw,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:a},z.createElement(Kg,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>d.onOpenChange(!1)},z.createElement(a5,ot({"data-state":h5(d.open),role:"dialog",id:d.contentId},p,h,{ref:n,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function h5(t){return t?"open":"closed"}const HJ=RJ,WJ=FJ,$J=BJ,qJ=zJ;function nl(t,n){const o=Be(),r=z.useRef(!1),s=mi(),a=z.useCallback(l=>{r.current=l,o.batch(()=>{l?(o.complete(),o.addOpenMenu(t)):o.updateInstanceState({openMenus:o.getOpenMenus().filter(c=>!c.startsWith(t))}),n==null||n(l)})},[o,t,n]),i=We("is menu open",()=>o.getOpenMenus().includes(t),[o,t]);return z.useEffect(()=>(r.current&&(s("open-menu",{source:"unknown",id:t}),o.addOpenMenu(t)),()=>{r.current&&(o.deleteOpenMenu(t),o.getOpenMenus().forEach(l=>{l.startsWith(t)&&(s("close-menu",{source:"unknown",id:t}),o.deleteOpenMenu(l))}),r.current=!1)}),[o,t,s]),[i,a]}function Dw({id:t,children:n,onOpenChange:o,open:r}){const[s,a]=nl(t,o);return E.jsx(HJ,{onOpenChange:a,open:r||s,children:E.jsx("div",{className:"tlui-popover",children:n})})}function Fw({children:t}){return E.jsx(WJ,{asChild:!0,dir:"ltr",children:t})}function Nw({side:t,children:n,align:o="center",sideOffset:r=8,alignOffset:s=0}){const a=Qn();return E.jsx($J,{container:a,children:E.jsx(qJ,{className:"tlui-popover__content",side:t,sideOffset:r,align:o,alignOffset:s,dir:"ltr",children:n})})}const p5=z.createContext({type:"menu",sourceId:"main-menu"});function _y(){return z.useContext(p5)}function xs({type:t,sourceId:n,children:o}){return E.jsx(p5.Provider,{value:{type:t,sourceId:n},children:o})}const YJ=z.createContext(void 0);function Uw(t){const n=z.useContext(YJ);return t||n||"ltr"}const Bw="rovingFocusGroup.onEntryFocus",KJ={bubbles:!1,cancelable:!0},zw="RovingFocusGroup",[Gw,f5,XJ]=Yg(zw),[QJ,m5]=hi(zw,[XJ]),[ZJ,JJ]=QJ(zw),eee=z.forwardRef((t,n)=>z.createElement(Gw.Provider,{scope:t.__scopeRovingFocusGroup},z.createElement(Gw.Slot,{scope:t.__scopeRovingFocusGroup},z.createElement(tee,ot({},t,{ref:n}))))),tee=z.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:o,orientation:r,loop:s=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,...f}=t,h=z.useRef(null),d=jr(n,h),p=Uw(a),[y=null,g]=Qa({prop:i,defaultProp:l,onChange:c}),[b,m]=z.useState(!1),v=eo(u),x=f5(o),w=z.useRef(!1),[S,k]=z.useState(0);return z.useEffect(()=>{const _=h.current;if(_)return _.addEventListener(Bw,v),()=>_.removeEventListener(Bw,v)},[v]),z.createElement(ZJ,{scope:o,orientation:r,dir:p,loop:s,currentTabStopId:y,onItemFocus:z.useCallback(_=>g(_),[g]),onItemShiftTab:z.useCallback(()=>m(!0),[]),onFocusableItemAdd:z.useCallback(()=>k(_=>_+1),[]),onFocusableItemRemove:z.useCallback(()=>k(_=>_-1),[])},z.createElement(vr.div,ot({tabIndex:b||S===0?-1:0,"data-orientation":r},f,{ref:d,style:{outline:"none",...t.style},onMouseDown:xt(t.onMouseDown,()=>{w.current=!0}),onFocus:xt(t.onFocus,_=>{const C=!w.current;if(_.target===_.currentTarget&&C&&!b){const P=new CustomEvent(Bw,KJ);if(_.currentTarget.dispatchEvent(P),!P.defaultPrevented){const A=x().filter(F=>F.focusable),I=A.find(F=>F.active),N=A.find(F=>F.id===y),O=[I,N,...A].filter(Boolean).map(F=>F.ref.current);g5(O)}}w.current=!1}),onBlur:xt(t.onBlur,()=>m(!1))})))}),ree="RovingFocusGroupItem",nee=z.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:o,focusable:r=!0,active:s=!1,tabStopId:a,...i}=t,l=Zi(),c=a||l,u=JJ(ree,o),f=u.currentTabStopId===c,h=f5(o),{onFocusableItemAdd:d,onFocusableItemRemove:p}=u;return z.useEffect(()=>{if(r)return d(),()=>p()},[r,d,p]),z.createElement(Gw.ItemSlot,{scope:o,id:c,focusable:r,active:s},z.createElement(vr.span,ot({tabIndex:f?0:-1,"data-orientation":u.orientation},i,{ref:n,onMouseDown:xt(t.onMouseDown,y=>{r?u.onItemFocus(c):y.preventDefault()}),onFocus:xt(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:xt(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const g=iee(y,u.orientation,u.dir);if(g!==void 0){y.preventDefault();let b=h().filter(m=>m.focusable).map(m=>m.ref.current);if(g==="last")b.reverse();else if(g==="prev"||g==="next"){g==="prev"&&b.reverse();const m=b.indexOf(y.currentTarget);b=u.loop?aee(b,m+1):b.slice(m+1)}setTimeout(()=>g5(b))}})})))}),oee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function see(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function iee(t,n,o){const r=see(t.key,o);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return oee[r]}function g5(t){const n=document.activeElement;for(const o of t)if(o===n||(o.focus(),document.activeElement!==n))return}function aee(t,n){return t.map((o,r)=>t[(n+r)%t.length])}const lee=eee,cee=nee,Vw=["Enter"," "],uee=["ArrowDown","PageUp","Home"],y5=["ArrowUp","PageDown","End"],dee=[...uee,...y5],hee={ltr:[...Vw,"ArrowRight"],rtl:[...Vw,"ArrowLeft"]},pee={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ky="Menu",[Vh,fee,mee]=Yg(ky),[tc,Ey]=hi(ky,[mee,jy,m5]),Cy=jy(),v5=m5(),[b5,ol]=tc(ky),[gee,Hh]=tc(ky),yee=t=>{const{__scopeMenu:n,open:o=!1,children:r,dir:s,onOpenChange:a,modal:i=!0}=t,l=Cy(n),[c,u]=z.useState(null),f=z.useRef(!1),h=eo(a),d=Uw(s);return z.useEffect(()=>{const p=()=>{f.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>f.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),z.createElement(Lw,l,z.createElement(b5,{scope:n,open:o,onOpenChange:h,content:c,onContentChange:u},z.createElement(gee,{scope:n,onClose:z.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:f,dir:d,modal:i},r)))},x5=z.forwardRef((t,n)=>{const{__scopeMenu:o,...r}=t,s=Cy(o);return z.createElement(i5,ot({},s,r,{ref:n}))}),w5="MenuPortal",[vee,S5]=tc(w5,{forceMount:void 0}),bee=t=>{const{__scopeMenu:n,forceMount:o,children:r,container:s}=t,a=ol(w5,n);return z.createElement(vee,{scope:n,forceMount:o},z.createElement(pi,{present:o||a.open},z.createElement(Xg,{asChild:!0,container:s},r)))},Ws="MenuContent",[xee,Hw]=tc(Ws),wee=z.forwardRef((t,n)=>{const o=S5(Ws,t.__scopeMenu),{forceMount:r=o.forceMount,...s}=t,a=ol(Ws,t.__scopeMenu),i=Hh(Ws,t.__scopeMenu);return z.createElement(Vh.Provider,{scope:t.__scopeMenu},z.createElement(pi,{present:r||a.open},z.createElement(Vh.Slot,{scope:t.__scopeMenu},i.modal?z.createElement(See,ot({},s,{ref:n})):z.createElement(jee,ot({},s,{ref:n})))))}),See=z.forwardRef((t,n)=>{const o=ol(Ws,t.__scopeMenu),r=z.useRef(null),s=jr(n,r);return z.useEffect(()=>{const a=r.current;if(a)return gw(a)},[]),z.createElement(Ww,ot({},t,{ref:s,trapFocus:o.open,disableOutsidePointerEvents:o.open,disableOutsideScroll:!0,onFocusOutside:xt(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>o.onOpenChange(!1)}))}),jee=z.forwardRef((t,n)=>{const o=ol(Ws,t.__scopeMenu);return z.createElement(Ww,ot({},t,{ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>o.onOpenChange(!1)}))}),Ww=z.forwardRef((t,n)=>{const{__scopeMenu:o,loop:r=!1,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:d,onDismiss:p,disableOutsideScroll:y,...g}=t,b=ol(Ws,o),m=Hh(Ws,o),v=Cy(o),x=v5(o),w=fee(o),[S,k]=z.useState(null),_=z.useRef(null),C=jr(n,_,b.onContentChange),P=z.useRef(0),A=z.useRef(""),I=z.useRef(0),N=z.useRef(null),O=z.useRef("right"),F=z.useRef(0),U=y?fw:z.Fragment,G=y?{as:Xl,allowPinchZoom:!0}:void 0,Y=H=>{var Q,J;const ae=A.current+H,T=w().filter(ce=>!ce.disabled),B=document.activeElement,W=(Q=T.find(ce=>ce.ref.current===B))===null||Q===void 0?void 0:Q.textValue,K=T.map(ce=>ce.textValue),te=Fee(K,ae,W),ne=(J=T.find(ce=>ce.textValue===te))===null||J===void 0?void 0:J.ref.current;(function ce(fe){A.current=fe,window.clearTimeout(P.current),fe!==""&&(P.current=window.setTimeout(()=>ce(""),1e3))})(ae),ne&&setTimeout(()=>ne.focus())};z.useEffect(()=>()=>window.clearTimeout(P.current),[]),cw();const $=z.useCallback(H=>{var Q,J;return O.current===((Q=N.current)===null||Q===void 0?void 0:Q.side)&&Uee(H,(J=N.current)===null||J===void 0?void 0:J.area)},[]);return z.createElement(xee,{scope:o,searchRef:A,onItemEnter:z.useCallback(H=>{$(H)&&H.preventDefault()},[$]),onItemLeave:z.useCallback(H=>{var Q;$(H)||((Q=_.current)===null||Q===void 0||Q.focus(),k(null))},[$]),onTriggerLeave:z.useCallback(H=>{$(H)&&H.preventDefault()},[$]),pointerGraceTimerRef:I,onPointerGraceIntentChange:z.useCallback(H=>{N.current=H},[])},z.createElement(U,G,z.createElement(aw,{asChild:!0,trapped:s,onMountAutoFocus:xt(a,H=>{var Q;H.preventDefault(),(Q=_.current)===null||Q===void 0||Q.focus()}),onUnmountAutoFocus:i},z.createElement(Kg,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:d,onDismiss:p},z.createElement(lee,ot({asChild:!0},x,{dir:m.dir,orientation:"vertical",loop:r,currentTabStopId:S,onCurrentTabStopIdChange:k,onEntryFocus:xt(c,H=>{m.isUsingKeyboardRef.current||H.preventDefault()})}),z.createElement(a5,ot({role:"menu","aria-orientation":"vertical","data-state":P5(b.open),"data-radix-menu-content":"",dir:m.dir},v,g,{ref:C,style:{outline:"none",...g.style},onKeyDown:xt(g.onKeyDown,H=>{const Q=H.target.closest("[data-radix-menu-content]")===H.currentTarget,J=H.ctrlKey||H.altKey||H.metaKey,ae=H.key.length===1;Q&&(H.key==="Tab"&&H.preventDefault(),!J&&ae&&Y(H.key));const T=_.current;if(H.target!==T||!dee.includes(H.key))return;H.preventDefault();const B=w().filter(W=>!W.disabled).map(W=>W.ref.current);y5.includes(H.key)&&B.reverse(),Ree(B)}),onBlur:xt(t.onBlur,H=>{H.currentTarget.contains(H.target)||(window.clearTimeout(P.current),A.current="")}),onPointerMove:xt(t.onPointerMove,Wh(H=>{const Q=H.target,J=F.current!==H.clientX;if(H.currentTarget.contains(Q)&&J){const ae=H.clientX>F.current?"right":"left";O.current=ae,F.current=H.clientX}}))})))))))}),_ee=z.forwardRef((t,n)=>{const{__scopeMenu:o,...r}=t;return z.createElement(vr.div,ot({role:"group"},r,{ref:n}))}),$w="MenuItem",j5="menu.itemSelect",_5=z.forwardRef((t,n)=>{const{disabled:o=!1,onSelect:r,...s}=t,a=z.useRef(null),i=Hh($w,t.__scopeMenu),l=Hw($w,t.__scopeMenu),c=jr(n,a),u=z.useRef(!1),f=()=>{const h=a.current;if(!o&&h){const d=new CustomEvent(j5,{bubbles:!0,cancelable:!0});h.addEventListener(j5,p=>r==null?void 0:r(p),{once:!0}),Jx(h,d),d.defaultPrevented?u.current=!1:i.onClose()}};return z.createElement(k5,ot({},s,{ref:c,disabled:o,onClick:xt(t.onClick,f),onPointerDown:h=>{var d;(d=t.onPointerDown)===null||d===void 0||d.call(t,h),u.current=!0},onPointerUp:xt(t.onPointerUp,h=>{var d;u.current||(d=h.currentTarget)===null||d===void 0||d.click()}),onKeyDown:xt(t.onKeyDown,h=>{const d=l.searchRef.current!=="";o||d&&h.key===" "||Vw.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})}))}),k5=z.forwardRef((t,n)=>{const{__scopeMenu:o,disabled:r=!1,textValue:s,...a}=t,i=Hw($w,o),l=v5(o),c=z.useRef(null),u=jr(n,c),[f,h]=z.useState(!1),[d,p]=z.useState("");return z.useEffect(()=>{const y=c.current;if(y){var g;p(((g=y.textContent)!==null&&g!==void 0?g:"").trim())}},[a.children]),z.createElement(Vh.ItemSlot,{scope:o,disabled:r,textValue:s??d},z.createElement(cee,ot({asChild:!0},l,{focusable:!r}),z.createElement(vr.div,ot({role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},a,{ref:u,onPointerMove:xt(t.onPointerMove,Wh(y=>{r?i.onItemLeave(y):(i.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus())})),onPointerLeave:xt(t.onPointerLeave,Wh(y=>i.onItemLeave(y))),onFocus:xt(t.onFocus,()=>h(!0)),onBlur:xt(t.onBlur,()=>h(!1))}))))}),kee=z.forwardRef((t,n)=>{const{checked:o=!1,onCheckedChange:r,...s}=t;return z.createElement(Pee,{scope:t.__scopeMenu,checked:o},z.createElement(_5,ot({role:"menuitemcheckbox","aria-checked":qw(o)?"mixed":o},s,{ref:n,"data-state":Lee(o),onSelect:xt(s.onSelect,()=>r==null?void 0:r(qw(o)?!0:!o),{checkForDefaultPrevented:!1})})))}),Eee="MenuRadioGroup";tc(Eee,{value:void 0,onValueChange:()=>{}});const Cee="MenuItemIndicator",[Pee,dse]=tc(Cee,{checked:!1}),E5="MenuSub",[Mee,C5]=tc(E5),Tee=t=>{const{__scopeMenu:n,children:o,open:r=!1,onOpenChange:s}=t,a=ol(E5,n),i=Cy(n),[l,c]=z.useState(null),[u,f]=z.useState(null),h=eo(s);return z.useEffect(()=>(a.open===!1&&h(!1),()=>h(!1)),[a.open,h]),z.createElement(Lw,i,z.createElement(b5,{scope:n,open:r,onOpenChange:h,content:u,onContentChange:f},z.createElement(Mee,{scope:n,contentId:Zi(),triggerId:Zi(),trigger:l,onTriggerChange:c},o)))},Py="MenuSubTrigger",Iee=z.forwardRef((t,n)=>{const o=ol(Py,t.__scopeMenu),r=Hh(Py,t.__scopeMenu),s=C5(Py,t.__scopeMenu),a=Hw(Py,t.__scopeMenu),i=z.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,u={__scopeMenu:t.__scopeMenu},f=z.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return z.useEffect(()=>f,[f]),z.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),z.createElement(x5,ot({asChild:!0},u),z.createElement(k5,ot({id:s.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":s.contentId,"data-state":P5(o.open)},t,{ref:qg(n,s.onTriggerChange),onClick:h=>{var d;(d=t.onClick)===null||d===void 0||d.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),o.open||o.onOpenChange(!0))},onPointerMove:xt(t.onPointerMove,Wh(h=>{a.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!o.open&&!i.current&&(a.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{o.onOpenChange(!0),f()},100))})),onPointerLeave:xt(t.onPointerLeave,Wh(h=>{var d;f();const p=(d=o.content)===null||d===void 0?void 0:d.getBoundingClientRect();if(p){var y;const g=(y=o.content)===null||y===void 0?void 0:y.dataset.side,b=g==="right",m=b?-5:5,v=p[b?"left":"right"],x=p[b?"right":"left"];a.onPointerGraceIntentChange({area:[{x:h.clientX+m,y:h.clientY},{x:v,y:p.top},{x,y:p.top},{x,y:p.bottom},{x:v,y:p.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(h),h.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:xt(t.onKeyDown,h=>{const d=a.searchRef.current!=="";if(!(t.disabled||d&&h.key===" ")&&hee[r.dir].includes(h.key)){var p;o.onOpenChange(!0),(p=o.content)===null||p===void 0||p.focus(),h.preventDefault()}})})))}),Aee="MenuSubContent",Oee=z.forwardRef((t,n)=>{const o=S5(Ws,t.__scopeMenu),{forceMount:r=o.forceMount,...s}=t,a=ol(Ws,t.__scopeMenu),i=Hh(Ws,t.__scopeMenu),l=C5(Aee,t.__scopeMenu),c=z.useRef(null),u=jr(n,c);return z.createElement(Vh.Provider,{scope:t.__scopeMenu},z.createElement(pi,{present:r||a.open},z.createElement(Vh.Slot,{scope:t.__scopeMenu},z.createElement(Ww,ot({id:l.contentId,"aria-labelledby":l.triggerId},s,{ref:u,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var h;i.isUsingKeyboardRef.current&&((h=c.current)===null||h===void 0||h.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:xt(t.onFocusOutside,f=>{f.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:xt(t.onEscapeKeyDown,f=>{i.onClose(),f.preventDefault()}),onKeyDown:xt(t.onKeyDown,f=>{const h=f.currentTarget.contains(f.target),d=pee[i.dir].includes(f.key);if(h&&d){var p;a.onOpenChange(!1),(p=l.trigger)===null||p===void 0||p.focus(),f.preventDefault()}})})))))});function P5(t){return t?"open":"closed"}function qw(t){return t==="indeterminate"}function Lee(t){return qw(t)?"indeterminate":t?"checked":"unchecked"}function Ree(t){const n=document.activeElement;for(const o of t)if(o===n||(o.focus(),document.activeElement!==n))return}function Dee(t,n){return t.map((o,r)=>t[(n+r)%t.length])}function Fee(t,n,o){const r=n.length>1&&Array.from(n).every(l=>l===n[0])?n[0]:n,s=o?t.indexOf(o):-1;let a=Dee(t,Math.max(s,0));r.length===1&&(a=a.filter(l=>l!==o));const i=a.find(l=>l.toLowerCase().startsWith(r.toLowerCase()));return i!==o?i:void 0}function Nee(t,n){const{x:o,y:r}=t;let s=!1;for(let a=0,i=n.length-1;a<n.length;i=a++){const l=n[a].x,c=n[a].y,u=n[i].x,f=n[i].y;c>r!=f>r&&o<(u-l)*(r-c)/(f-c)+l&&(s=!s)}return s}function Uee(t,n){if(!n)return!1;const o={x:t.clientX,y:t.clientY};return Nee(o,n)}function Wh(t){return n=>n.pointerType==="mouse"?t(n):void 0}const M5=yee,T5=x5,I5=bee,A5=wee,O5=_ee,L5=_5,R5=kee,D5=Tee,F5=Iee,N5=Oee,U5="ContextMenu",[Bee,hse]=hi(U5,[Ey]),yi=Ey(),[zee,B5]=Bee(U5),Gee=t=>{const{__scopeContextMenu:n,children:o,onOpenChange:r,dir:s,modal:a=!0}=t,[i,l]=z.useState(!1),c=yi(n),u=eo(r),f=z.useCallback(h=>{l(h),u(h)},[u]);return z.createElement(zee,{scope:n,open:i,onOpenChange:f,modal:a},z.createElement(M5,ot({},c,{dir:s,open:i,onOpenChange:f,modal:a}),o))},Vee="ContextMenuTrigger",Hee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,disabled:r=!1,...s}=t,a=B5(Vee,o),i=yi(o),l=z.useRef({x:0,y:0}),c=z.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),u=z.useRef(0),f=z.useCallback(()=>window.clearTimeout(u.current),[]),h=d=>{l.current={x:d.clientX,y:d.clientY},a.onOpenChange(!0)};return z.useEffect(()=>f,[f]),z.useEffect(()=>void(r&&f()),[r,f]),z.createElement(z.Fragment,null,z.createElement(T5,ot({},i,{virtualRef:c})),z.createElement(vr.span,ot({"data-state":a.open?"open":"closed","data-disabled":r?"":void 0},s,{ref:n,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:r?t.onContextMenu:xt(t.onContextMenu,d=>{f(),h(d),d.preventDefault()}),onPointerDown:r?t.onPointerDown:xt(t.onPointerDown,My(d=>{f(),u.current=window.setTimeout(()=>h(d),700)})),onPointerMove:r?t.onPointerMove:xt(t.onPointerMove,My(f)),onPointerCancel:r?t.onPointerCancel:xt(t.onPointerCancel,My(f)),onPointerUp:r?t.onPointerUp:xt(t.onPointerUp,My(f))})))}),z5=t=>{const{__scopeContextMenu:n,...o}=t,r=yi(n);return z.createElement(I5,ot({},r,o))},Wee="ContextMenuContent",$ee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=B5(Wee,o),a=yi(o),i=z.useRef(!1);return z.createElement(A5,ot({},a,r,{ref:n,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{var c;(c=t.onCloseAutoFocus)===null||c===void 0||c.call(t,l),!l.defaultPrevented&&i.current&&l.preventDefault(),i.current=!1},onInteractOutside:l=>{var c;(c=t.onInteractOutside)===null||c===void 0||c.call(t,l),!l.defaultPrevented&&!s.modal&&(i.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),qee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=yi(o);return z.createElement(O5,ot({},s,r,{ref:n}))}),Yee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=yi(o);return z.createElement(L5,ot({},s,r,{ref:n}))}),Kee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=yi(o);return z.createElement(R5,ot({},s,r,{ref:n}))}),Xee=t=>{const{__scopeContextMenu:n,children:o,onOpenChange:r,open:s,defaultOpen:a}=t,i=yi(n),[l,c]=Qa({prop:s,defaultProp:a,onChange:r});return z.createElement(D5,ot({},i,{open:l,onOpenChange:c}),o)},Qee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=yi(o);return z.createElement(F5,ot({},s,r,{ref:n}))}),Zee=z.forwardRef((t,n)=>{const{__scopeContextMenu:o,...r}=t,s=yi(o);return z.createElement(N5,ot({},s,r,{ref:n,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function My(t){return n=>n.pointerType!=="mouse"?t(n):void 0}const Jee=Gee,ete=Hee,tte=z5,rte=$ee,nte=Kee,G5=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,ote=G5?"\u2318":"Ctrl",ste=G5?"\u2325":"Alt";function V5(t){return t.split(",")[0].split("").map(n=>{const o=n.replace(/\$/g,ote).replace(/\?/g,ste).replace(/!/g,"\u21E7");return o[0].toUpperCase()+o.slice(1)})}function Yw(t){return"\u2014 "+V5(t).join("\u2009")}function ite(t){return E.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:E.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[E.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),E.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:E.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const H5="DropdownMenu",[ate,pse]=hi(H5,[Ey]),vi=Ey(),[lte,W5]=ate(H5),cte=t=>{const{__scopeDropdownMenu:n,children:o,dir:r,open:s,defaultOpen:a,onOpenChange:i,modal:l=!0}=t,c=vi(n),u=z.useRef(null),[f=!1,h]=Qa({prop:s,defaultProp:a,onChange:i});return z.createElement(lte,{scope:n,triggerId:Zi(),triggerRef:u,contentId:Zi(),open:f,onOpenChange:h,onOpenToggle:z.useCallback(()=>h(d=>!d),[h]),modal:l},z.createElement(M5,ot({},c,{open:f,onOpenChange:h,dir:r,modal:l}),o))},ute="DropdownMenuTrigger",dte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,disabled:r=!1,...s}=t,a=W5(ute,o),i=vi(o);return z.createElement(T5,ot({asChild:!0},i),z.createElement(vr.button,ot({type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},s,{ref:qg(n,a.triggerRef),onPointerDown:xt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:xt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})))}),hte=t=>{const{__scopeDropdownMenu:n,...o}=t,r=vi(n);return z.createElement(I5,ot({},r,o))},pte="DropdownMenuContent",fte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=W5(pte,o),a=vi(o),i=z.useRef(!1);return z.createElement(A5,ot({id:s.contentId,"aria-labelledby":s.triggerId},a,r,{ref:n,onCloseAutoFocus:xt(t.onCloseAutoFocus,l=>{var c;i.current||(c=s.triggerRef.current)===null||c===void 0||c.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:xt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,f=c.button===2||u;(!s.modal||f)&&(i.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),mte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=vi(o);return z.createElement(O5,ot({},s,r,{ref:n}))}),gte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=vi(o);return z.createElement(L5,ot({},s,r,{ref:n}))}),yte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=vi(o);return z.createElement(R5,ot({},s,r,{ref:n}))}),vte=t=>{const{__scopeDropdownMenu:n,children:o,open:r,onOpenChange:s,defaultOpen:a}=t,i=vi(n),[l=!1,c]=Qa({prop:r,defaultProp:a,onChange:s});return z.createElement(D5,ot({},i,{open:l,onOpenChange:c}),o)},bte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=vi(o);return z.createElement(F5,ot({},s,r,{ref:n}))}),xte=z.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...r}=t,s=vi(o);return z.createElement(N5,ot({},s,r,{ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),Kw=cte,Xw=dte,Ty=hte,Qw=fte,wte=mte,Ste=gte,jte=yte,_te=vte,kte=bte,Ete=xte;function rc({id:t,children:n,modal:o=!1,debugOpen:r=!1}){const[s,a]=nl(t);return E.jsx(Kw,{open:r||s,dir:"ltr",modal:o,onOpenChange:a,children:n})}function nc({children:t,...n}){return E.jsx(Xw,{dir:"ltr",asChild:!0,onTouchEnd:o=>Xt(o),...n,children:t})}function oc({side:t="bottom",align:n="start",sideOffset:o=8,alignOffset:r=8,children:s}){const a=Qn();return E.jsx(Ty,{container:a,children:E.jsx(Qw,{className:"tlui-menu",side:t,sideOffset:o,align:n,alignOffset:r,collisionPadding:4,children:s})})}function Cte({id:t,children:n}){const[o,r]=nl(t);return E.jsx(_te,{open:o,onOpenChange:r,children:n})}function Pte({id:t,label:n,title:o,disabled:r}){return E.jsx(kte,{dir:"ltr",asChild:!0,disabled:r,children:E.jsxs(It,{"data-testid":t,type:"menu",className:"tlui-menu__submenu__trigger",disabled:r,title:o,children:[E.jsx(rn,{children:n}),E.jsx(Qt,{icon:"chevron-right",small:!0})]})})}function Mte({id:t,alignOffset:n=-1,sideOffset:o=-4,size:r="small",children:s}){const a=Qn();return E.jsx(Ty,{container:a,children:E.jsx(Ete,{"data-testid":t,className:"tlui-menu tlui-menu__submenu__content",alignOffset:n,sideOffset:o,collisionPadding:4,"data-size":r,children:s})})}function Tte({children:t}){return E.jsx(wte,{dir:"ltr",className:"tlui-menu__group",children:t})}function $h({noClose:t,children:n}){return E.jsx(Ste,{dir:"ltr",asChild:!0,onClick:t?Xt:void 0,children:n})}function qh({children:t,visibleOnMobileLayout:n=!1}){const o=Do();return!n&&o<Xr.MOBILE?null:E.jsx("kbd",{className:"tlui-kbd",children:V5(t).map((r,s)=>E.jsx("span",{children:r},s))})}function Le({disabled:t=!1,spinner:n=!1,readonlyOk:o=!1,id:r,kbd:s,label:a,icon:i,onSelect:l,noClose:c,isSelected:u}){const{type:f,sourceId:h}=_y(),d=tr(),[p,y]=z.useState(!1);if(Ki()&&!o)return null;const g=Nh(a,f),b=s?Yw(s):void 0,m=g?d(g):void 0,v=m&&b?`${m} ${b}`:m;switch(f){case"menu":return E.jsx($h,{children:E.jsxs(It,{type:"menu","data-testid":`${h}.${r}`,disabled:t,title:v,onClick:x=>{c&&Xt(x),p?y(!1):l(h)},children:[E.jsx(rn,{children:m}),s&&E.jsx(qh,{children:s})]})});case"context-menu":return t?null:E.jsxs(Yee,{dir:"ltr",title:v,draggable:!1,className:"tlui-button tlui-button__menu","data-testid":`${h}.${r}`,onSelect:x=>{c&&Xt(x),p?y(!1):l(h)},children:[E.jsx("span",{className:"tlui-button__label",draggable:!1,children:m}),s&&E.jsx(qh,{children:s}),n&&E.jsx(ite,{})]});case"panel":return E.jsxs(It,{"data-testid":`${h}.${r}`,type:"menu",title:v,disabled:t,onClick:()=>l(h),children:[E.jsx(rn,{children:m}),i&&E.jsx(Qt,{icon:i})]});case"small-icons":case"icons":return E.jsx(It,{"data-testid":`${h}.${r}`,type:"icon",title:v,disabled:t,onClick:()=>l(h),children:E.jsx(Qt,{icon:i,small:f==="small-icons"})});case"keyboard-shortcuts":return s?E.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair","data-testid":`${h}.${r}`,children:[E.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:m}),E.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:E.jsx(qh,{visibleOnMobileLayout:!0,children:s})})]}):(console.warn(`Menu item '${a}' isn't shown in the keyboard shortcuts dialog because it doesn't have a keyboard shortcut.`),null);case"helper-buttons":return E.jsxs(It,{type:"low",onClick:()=>l(h),children:[E.jsx(Qt,{icon:i}),E.jsx(rn,{children:m})]});case"toolbar":return E.jsx(It,{type:"tool","data-testid":`tools.${r}`,"aria-label":g,"data-value":r,onClick:()=>l("toolbar"),title:v,onTouchStart:x=>{Xt(x),l("toolbar")},role:"radio","aria-checked":u?"true":"false",children:E.jsx(Qt,{icon:i})});case"toolbar-overflow":return E.jsx($h,{"aria-label":a,children:E.jsx(It,{type:"icon",className:"tlui-button-grid__button",onClick:()=>{l("toolbar")},"data-testid":`tools.more.${r}`,title:v,role:"radio","aria-checked":u?"true":"false","data-value":r,children:E.jsx(Qt,{icon:i})})});default:throw Ri(f)}}function Ite(){return E.jsxs(E.Fragment,{children:[E.jsx(Ate,{}),E.jsx(Ote,{}),E.jsx(Lte,{}),E.jsx(Rte,{}),E.jsx(Dte,{}),E.jsx(Ute,{}),E.jsx(Bte,{}),E.jsx(zte,{})]})}function Ate(){const t=_t(),n=bo(2);return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t["align-left"],disabled:!n}),E.jsx(Le,{...t["align-center-horizontal"],disabled:!n}),E.jsx(Le,{...t["align-right"],disabled:!n}),E.jsx(Le,{...t["stretch-horizontal"],disabled:!n}),E.jsx(Le,{...t["align-top"],disabled:!n}),E.jsx(Le,{...t["align-center-vertical"],disabled:!n}),E.jsx(Le,{...t["align-bottom"],disabled:!n}),E.jsx(Le,{...t["stretch-vertical"],disabled:!n})]})}function Ote(){const t=_t(),n=bo(3);return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t["distribute-horizontal"],disabled:!n}),E.jsx(Le,{...t["distribute-vertical"],disabled:!n})]})}function Lte(){const t=_t(),n=kT();return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t["stack-horizontal"],disabled:!n}),E.jsx(Le,{...t["stack-vertical"],disabled:!n})]})}function Rte(){const t=_t(),n=bo(1);return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t["send-to-back"],disabled:!n}),E.jsx(Le,{...t["send-backward"],disabled:!n}),E.jsx(Le,{...t["bring-forward"],disabled:!n}),E.jsx(Le,{...t["bring-to-front"],disabled:!n})]})}function Dte(){return Do()<Xr.TABLET_SM?E.jsx(Fte,{}):E.jsx(Nte,{})}function Fte(){const t=_t(),n=Be(),o=We("zoom is 1",()=>n.getZoomLevel()===1,[n]);return E.jsx(Le,{...t["zoom-to-100"],disabled:o})}function Nte(){const t=_t(),n=bo(1);return E.jsx(Le,{...t["rotate-ccw"],disabled:!n})}function Ute(){const t=_t(),n=bo(1);return E.jsx(Le,{...t["rotate-cw"],disabled:!n})}function Bte(){const t=_t(),n=PT();return E.jsx(Le,{...t["edit-link"],disabled:!n})}function zte(){const t=ET(),n=CT();return t?E.jsx($5,{}):n?E.jsx(Gte,{}):E.jsx($5,{})}function $5(){const t=_t(),n=bo(2);return E.jsx(Le,{...t.group,disabled:!n})}function Gte(){const t=_t();return E.jsx(Le,{...t.ungroup})}const Vte=z.memo(function({children:t}){const n=tr(),o=Do(),r=Ki(),s=Be(),a=We("should display quick actions when in readonly",()=>s.isInAny("hand","zoom"),[s]),i=t??E.jsx(Ite,{});if(!(r&&!a))return E.jsxs(Dw,{id:"actions-menu",children:[E.jsx(Fw,{children:E.jsx(It,{type:"icon","data-testid":"actions-menu.button",title:n("actions-menu.title"),children:E.jsx(Qt,{icon:"dots-vertical",small:!0})})}),E.jsx(Nw,{side:o>=Xr.TABLET?"bottom":"top",sideOffset:6,children:E.jsx("div",{className:"tlui-actions-menu tlui-buttons__grid","data-testid":"actions-menu.content",children:E.jsx(xs,{type:"icons",sourceId:"actions-menu",children:i})})})]})});function ws({id:t,kbd:n,label:o,readonlyOk:r,onSelect:s,disabled:a=!1,checked:i=!1}){const{type:l,sourceId:c}=_y(),u=Ki(),f=tr();if(u&&!r)return null;const h=Nh(o,l),d=h?f(h):void 0;switch(l){case"menu":return E.jsxs(jte,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",title:d,onSelect:p=>{s==null||s(c),Xt(p)},disabled:a,checked:i,children:[E.jsx(Ja,{small:!0,icon:i?"check":"checkbox-empty"}),d&&E.jsx("span",{className:"tlui-button__label",draggable:!1,children:d}),n&&E.jsx(qh,{children:n})]});case"context-menu":return E.jsxs(nte,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",title:d,onSelect:p=>{s(c),Xt(p)},disabled:a,checked:i,children:[E.jsx(Ja,{small:!0,icon:i?"check":"checkbox-empty"}),d&&E.jsx("span",{className:"tlui-button__label",draggable:!1,children:d}),n&&E.jsx(qh,{children:n})]},t);default:return null}}function Nt({id:t,label:n,children:o}){const{type:r,sourceId:s}=_y(),a=tr(),i=Nh(n,r),l=i?a(i):void 0;switch(r){case"panel":return E.jsx("div",{className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:o});case"menu":return E.jsx(Tte,{"data-testid":`${s}-group.${t}`,children:o});case"context-menu":return E.jsx(qee,{dir:"ltr",className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:o});case"keyboard-shortcuts":return E.jsxs("div",{className:"tlui-shortcuts-dialog__group","data-testid":`${s}-group.${t}`,children:[E.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:l}),E.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:o})]});default:return o}}function Ss({id:t,disabled:n=!1,label:o,size:r="small",children:s}){const{type:a,sourceId:i}=_y(),l=Qn(),c=tr(),u=o?typeof o=="string"?o:o[a]??o.default:void 0,f=u?c(u):void 0;switch(a){case"menu":return E.jsxs(Cte,{id:`${i}-sub.${t}`,children:[E.jsx(Pte,{id:`${i}-sub.${f?f.toLowerCase()+"-button":""}`,disabled:n,label:f,title:f}),E.jsx(Mte,{id:`${i}-sub.${f?f.toLowerCase()+"-content":""}`,size:r,children:s})]});case"context-menu":return n?null:E.jsxs(Hte,{id:`${i}-sub.${t}`,children:[E.jsx(Qee,{dir:"ltr",disabled:n,asChild:!0,children:E.jsxs(It,{"data-testid":`${i}-sub-trigger.${t}`,type:"menu",className:"tlui-menu__submenu__trigger",children:[E.jsx(rn,{children:f}),E.jsx(Qt,{icon:"chevron-right",small:!0})]})}),E.jsx(z5,{container:l,children:E.jsx(Zee,{"data-testid":`${i}-sub-content.${t}`,className:"tlui-menu tlui-menu__submenu__content",alignOffset:-1,sideOffset:-4,collisionPadding:4,"data-size":r,children:s})})]});default:return s}}function Hte({id:t,children:n}){const[o,r]=nl(t);return E.jsx(Xee,{open:o,onOpenChange:r,children:n})}function q5(){const t=_t();return I$()?E.jsx(Le,{...t["toggle-auto-size"]}):null}function Y5(){const t=_t();return PT()?E.jsx(Le,{...t["edit-link"]}):null}function Wte(){const t=_t();return bo(1)?E.jsx(Le,{...t.duplicate}):null}function K5(){const t=_t();return ET()?E.jsx(Le,{...t.group}):null}function X5(){const t=_t();return CT()?E.jsx(Le,{...t.ungroup}):null}function Q5(){const t=Be(),n=_t();return We("allow unframe",()=>{const o=t.getSelectedShapes();return o.length===0?!1:o.every(r=>t.isShapeOfType(r,"frame"))},[t])?E.jsx(Le,{...n["remove-frame"]}):null}function Z5(){const t=Be(),n=_t();return We("allow fit frame to content",()=>{const o=t.getOnlySelectedShape();return o?t.isShapeOfType(o,"frame")&&t.getSortedChildIdsForParent(o).length>0:!1},[t])?E.jsx(Le,{...n["fit-frame-to-content"]}):null}function J5(){const t=Be(),n=_t();return We("selected shapes",()=>t.getSelectedShapes().length>0,[t])?E.jsx(Le,{...n["toggle-lock"]}):null}function Zw(){const t=_t(),n=Be(),o=We("isTransparentBg",()=>!n.getInstanceState().exportBackground,[n]);return E.jsx(ws,{...t["toggle-transparent"],checked:o})}function $te(){const t=Be(),n=_t(),o=We("any shapes",()=>t.getCurrentPageShapeIds().size>0,[t]);return E.jsx(Le,{...n["unlock-all"],disabled:!o})}function eO(){const t=Be(),n=We("zoomed to 100",()=>t.getZoomLevel()===1,[t]),o=_t();return E.jsx(Le,{...o["zoom-to-100"],noClose:!0,disabled:n})}function tO(){const t=Be(),n=We("has shapes",()=>t.getCurrentPageShapeIds().size>0,[t]),o=_t();return E.jsx(Le,{...o["zoom-to-fit"],disabled:!n,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0})}function rO(){const t=Be(),n=We("has shapes",()=>t.getSelectedShapeIds().length>0,[t]),o=_t();return E.jsx(Le,{...o["zoom-to-selection"],disabled:!n,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})}function nO(){return E.jsxs(Nt,{id:"clipboard",children:[E.jsx(Yte,{}),E.jsx(Kte,{}),E.jsx(Xte,{}),E.jsx(Wte,{}),E.jsx(Qte,{})]})}function qte(){var r;const t=Be(),n=_t(),o=We("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t]);return E.jsxs(Ss,{id:"copy-as",label:"context-menu.copy-as",size:"small",disabled:!o,children:[E.jsxs(Nt,{id:"copy-as-group",children:[E.jsx(Le,{...n["copy-as-svg"]}),!!((r=window.navigator.clipboard)!=null&&r.write)&&E.jsx(Le,{...n["copy-as-png"]}),E.jsx(Le,{...n["copy-as-json"]})]}),E.jsx(Nt,{id:"copy-as-bg",children:E.jsx(Zw,{})})]})}function Yte(){const t=_t(),n=bo(1);return E.jsx(Le,{...t.cut,disabled:!n})}function Kte(){const t=_t(),n=T$(1);return E.jsx(Le,{...t.copy,disabled:!n})}function Xte(){const t=_t(),n=M$;return E.jsx(Le,{...t.paste,disabled:!n})}function oO(){const t=Be(),n=_t();return We("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t])?E.jsxs(Nt,{id:"conversions",children:[E.jsx(qte,{}),E.jsxs(Ss,{id:"export-as",label:"context-menu.export-as",size:"small",children:[E.jsxs(Nt,{id:"export-as-group",children:[E.jsx(Le,{...n["export-as-svg"]}),E.jsx(Le,{...n["export-as-png"]}),E.jsx(Le,{...n["export-as-json"]})]}),E.jsx(Nt,{id:"export-as-bg",children:E.jsx(Zw,{})})]})]}):null}function sO(){const t=_t(),n=Be(),o=We("atLeastOneShapeOnPage",()=>n.getCurrentPageShapeIds().size>0,[n]);return E.jsx(Le,{...t["select-all"],disabled:!o})}function Qte(){const t=_t(),n=bo(1);return E.jsx(Le,{...t.delete,disabled:!n})}function Zte(){const t=bo(2),n=A$(),o=_t();return t||n?E.jsxs(Ss,{id:"arrange",label:"context-menu.arrange",size:"small",children:[t&&E.jsxs(Nt,{id:"align",children:[E.jsx(Le,{...o["align-left"]}),E.jsx(Le,{...o["align-center-horizontal"]}),E.jsx(Le,{...o["align-right"]}),E.jsx(Le,{...o["align-top"]}),E.jsx(Le,{...o["align-center-vertical"]}),E.jsx(Le,{...o["align-bottom"]})]}),E.jsx(Jte,{}),t&&E.jsxs(Nt,{id:"stretch",children:[E.jsx(Le,{...o["stretch-horizontal"]}),E.jsx(Le,{...o["stretch-vertical"]})]}),(t||n)&&E.jsxs(Nt,{id:"flip",children:[E.jsx(Le,{...o["flip-horizontal"]}),E.jsx(Le,{...o["flip-vertical"]})]}),E.jsx(ere,{})]}):null}function Jte(){const t=_t();return bo(3)?E.jsxs(Nt,{id:"distribute",children:[E.jsx(Le,{...t["distribute-horizontal"]}),E.jsx(Le,{...t["distribute-vertical"]})]}):null}function ere(){const t=_t(),n=bo(2),o=kT();return n?E.jsxs(Nt,{id:"order",children:[E.jsx(Le,{...t.pack}),o&&E.jsx(Le,{...t["stack-horizontal"]}),o&&E.jsx(Le,{...t["stack-vertical"]})]}):null}function tre(){const t=_t();return bo(1)?E.jsx(Ss,{id:"reorder",label:"context-menu.reorder",size:"small",children:E.jsxs(Nt,{id:"reorder",children:[E.jsx(Le,{...t["bring-to-front"]}),E.jsx(Le,{...t["bring-forward"]}),E.jsx(Le,{...t["send-backward"]}),E.jsx(Le,{...t["send-to-back"]})]})}):null}function rre(){const t=Be(),n=We("pages",()=>t.getPages(),[t]),o=We("current page id",()=>t.getCurrentPageId(),[t]),{addToast:r}=Hs(),s=_t(),a=mi();return bo(1)?E.jsxs(Ss,{id:"move-to-page",label:"context-menu.move-to-page",size:"small",children:[E.jsx(Nt,{id:"pages",children:n.map(i=>E.jsx(Le,{id:i.id,disabled:o===i.id,label:i.name,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.getSelectedShapeIds(),i.id);const l=t.getPage(i.id);l&&r({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPage(o)}}]}),a("move-to-page",{source:"context-menu"})}},i.id))}),E.jsx(Nt,{id:"new-page",children:E.jsx(Le,{...s["new-page"]})})]}):null}function iO(){const t=Be(),n=_t();return We("oneEmbedSelected",()=>{const o=t.getOnlySelectedShape();return o?!!(t.isShapeOfType(o,"embed")&&o.props.url&&!t.isShapeOrAncestorLocked(o)):!1},[t])?E.jsx(Le,{...n["convert-to-bookmark"]}):null}function aO(){const t=Be(),n=_t();return We("oneEmbeddableBookmarkSelected",()=>{const o=t.getOnlySelectedShape();return o?!!(t.isShapeOfType(o,"bookmark")&&o.props.url&&Xa(o.props.url)&&!t.isShapeOrAncestorLocked(o)):!1},[t])?E.jsx(Le,{...n["convert-to-embed"]}):null}function nre(){const t=_t(),n=Be(),o=We("isSnapMode",()=>n.user.getIsSnapMode(),[n]);return E.jsx(ws,{...t["toggle-snap-mode"],checked:o})}function ore(){const t=_t(),n=Be(),o=We("isToolLock",()=>n.getInstanceState().isToolLocked,[n]);return E.jsx(ws,{...t["toggle-tool-lock"],checked:o})}function sre(){const t=_t(),n=Be(),o=We("isGridMode",()=>n.getInstanceState().isGridMode,[n]);return E.jsx(ws,{...t["toggle-grid"],checked:o})}function ire(){const t=_t(),n=Be(),o=We("isWrapMode",()=>n.user.getIsWrapMode(),[n]);return E.jsx(ws,{...t["toggle-wrap-mode"],checked:o})}function are(){const t=_t(),n=Be(),o=We("isDarkMode",()=>n.user.getIsDarkMode(),[n]);return E.jsx(ws,{...t["toggle-dark-mode"],checked:o})}function lre(){const t=_t(),n=Be(),o=We("isFocusMode",()=>n.getInstanceState().isFocusMode,[n]);return E.jsx(ws,{...t["toggle-focus-mode"],checked:o})}function cre(){const t=_t(),n=Be(),o=We("edgeScrollSpeed",()=>n.user.getEdgeScrollSpeed(),[n]);return E.jsx(ws,{...t["toggle-edge-scrolling"],checked:o===1})}function ure(){const t=_t(),n=Be(),o=We("animationSpeed",()=>n.user.getAnimationSpeed(),[n]);return E.jsx(ws,{...t["toggle-reduce-motion"],checked:o===0})}function dre(){const t=_t(),n=Be(),o=We("isDebugMode",()=>n.getInstanceState().isDebugMode,[n]);return E.jsx(ws,{...t["toggle-debug-mode"],checked:o})}function hre(){const t=Be();return We("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t])?E.jsxs(E.Fragment,{children:[E.jsxs(Nt,{id:"misc",children:[E.jsx(K5,{}),E.jsx(X5,{}),E.jsx(Y5,{}),E.jsx(q5,{}),E.jsx(Q5,{}),E.jsx(Z5,{}),E.jsx(aO,{}),E.jsx(iO,{}),E.jsx(J5,{})]}),E.jsxs(Nt,{id:"modify",children:[E.jsx(Zte,{}),E.jsx(tre,{}),E.jsx(rre,{})]}),E.jsx(nO,{}),E.jsx(oO,{}),E.jsx(Nt,{id:"select-all",children:E.jsx(sO,{})})]}):null}const pre=z.memo(function({children:t}){const n=Be(),{Canvas:o}=Vr(),r=z.useCallback(c=>{if(c){if(n.getInstanceState().isCoarsePointer){const u=n.getSelectedShapes(),{inputs:{currentPagePoint:f}}=n,h=n.getShapesAtPoint(f);if(!n.getSelectedShapes().length||!h.some(d=>u.includes(d))){const d=h.filter(p=>n.isShapeOrAncestorLocked(p));d.length&&n.select(...d.map(p=>p.id))}}}else{const u=n.getOnlySelectedShape();u&&n.isShapeOrAncestorLocked(u)&&n.setSelectedShapes([])}},[n]),s=Qn(),[a,i]=nl("context menu",r),l=t??E.jsx(hre,{});return E.jsxs(Jee,{dir:"ltr",onOpenChange:i,modal:!1,children:[E.jsx(ete,{onContextMenu:void 0,dir:"ltr",children:o?E.jsx(o,{}):null}),a&&E.jsx(tte,{container:s,children:E.jsx(rte,{className:"tlui-menu scrollable","data-testid":"context-menu",alignOffset:-4,collisionPadding:4,onContextMenu:Xt,children:E.jsx(xs,{type:"context-menu",sourceId:"context-menu",children:l})})})]})});function Jw({checked:t}){return E.jsx(Ja,{icon:t?"check":"checkbox-empty",className:"tlui-button__icon",small:!0})}function fre(){const t=Be(),{addToast:n}=Hs(),{addDialog:o}=Zl(),[r,s]=Bt.useState(!1);return E.jsxs(E.Fragment,{children:[E.jsxs(Nt,{id:"items",children:[E.jsx(Le,{id:"add-toast",onSelect:()=>{n({id:Ir(),title:"Something good happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"success"}),n({id:Ir(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"info",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),n({id:Ir(),title:"Something maybe bad happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"warning",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),n({id:Ir(),title:"Something bad happened",severity:"error",keepOpen:!0})},label:"Show toast"}),E.jsx(Le,{id:"show-dialog",label:"Show dialog",onSelect:()=>{o({component:({onClose:a})=>E.jsx(yre,{displayDontShowAgain:!0,onCancel:()=>a(),onContinue:()=>a()}),onClose:()=>{}})}}),E.jsx(Le,{id:"create-shapes",label:"Create 100 shapes",onSelect:()=>vre(t,100)}),E.jsx(Le,{id:"count-nodes",label:"Count shapes / nodes",onSelect:()=>{var l;const a=t.getSelectedShapes(),i=a.length===0?t.getRenderingShapes():a;window.alert(`Shapes ${i.length}, DOM nodes:${(l=document.querySelector(".tl-shapes").querySelectorAll("*"))==null?void 0:l.length}`)}}),(()=>{if(r)throw Error("oh no!");return null})(),E.jsx(Le,{id:"throw-error",onSelect:()=>s(!0),label:"Throw error"}),E.jsx(Le,{id:"hard-reset",onSelect:BC,label:"Hard reset"})]}),E.jsxs(Nt,{id:"flags",children:[E.jsx(mre,{}),E.jsx(gre,{})]})]})}function mre(){const t=Object.values(jn);return t.length?E.jsx(Ss,{id:"debug flags",label:"Debug Flags",children:E.jsx(Nt,{id:"debug flags",children:t.map(n=>E.jsx(lO,{flag:n},n.name))})}):null}function gre(){const t=Object.values(X6);return t.length?E.jsx(Ss,{id:"feature flags",label:"Feature Flags",children:E.jsx(Nt,{id:"feature flags",children:t.map(n=>E.jsx(lO,{flag:n},n.name))})}):null}function yre({title:t="title",body:n="hello hello hello",cancel:o="Cancel",confirm:r="Continue",displayDontShowAgain:s=!1,onCancel:a,onContinue:i}){const[l,c]=Bt.useState(!1);return E.jsxs(E.Fragment,{children:[E.jsxs(ly,{children:[E.jsx(cy,{children:t}),E.jsx(uy,{})]}),E.jsx(Dh,{style:{maxWidth:350},children:n}),E.jsxs(xw,{className:"tlui-dialog__footer__actions",children:[s&&E.jsxs(It,{type:"normal",onClick:()=>c(!l),style:{marginRight:"auto"},children:[E.jsx(Jw,{checked:l}),E.jsx(rn,{children:"Don't show again"})]}),E.jsx(It,{type:"normal",onClick:a,children:E.jsx(rn,{children:o})}),E.jsx(It,{type:"primary",onClick:async()=>i(),children:E.jsx(rn,{children:r})})]})]})}const lO=qo(function({flag:t,onChange:n}){const o=t.get();return E.jsx(ws,{id:t.name,title:t.name,label:t.name.replace(/([a-z0-9])([A-Z])/g,r=>`${r[0]} ${r[1].toLowerCase()}`).replace(/^[a-z]/,r=>r.toUpperCase()),checked:o,onSelect:()=>{t.set(!o),n==null||n(!o)}})});let cO=0;function vre(t,n){const o=Array(n),r=Math.floor(Math.sqrt(n));for(let s=0;s<n;s++)cO++,o[s]={id:ur("box"+cO),type:"geo",x:s%r*132,y:Math.floor(s/r)*132};t.batch(()=>{t.createShapes(o).setSelectedShapes(o.map(s=>s.id))})}function bre({children:t}){const n=t??E.jsx(fre,{});return E.jsxs(rc,{id:"debug",children:[E.jsx(nc,{children:E.jsx(It,{type:"icon",title:"Debug menu",children:E.jsx(Qt,{icon:"dots-horizontal"})})}),E.jsx(oc,{side:"top",align:"end",alignOffset:0,children:E.jsx(xs,{type:"menu",sourceId:"debug-panel",children:n})})]})}const xre=z.memo(function(){const{DebugMenu:t}=il();return E.jsxs("div",{className:"tlui-debug-panel",children:[E.jsx(Sre,{}),E.jsx(jre,{}),t&&E.jsx(t,{})]})});function wre(t=!0){const[n,o]=z.useState(0),r=Be();z.useEffect(()=>{if(!t)return;const s=()=>o(a=>a+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const Sre=qo(function(){wre();const t=Be(),n=t.getPath(),o=t.getHoveredShape(),r=t.getOnlySelectedShape(),s=n==="select.idle"||!n.includes("select.")?o:r,a=s&&n.includes("select.")?` / ${s.type||""}${"geo"in s.props?" / "+s.props.geo:""} / [${q.ToFixed(t.getPointInShapeSpace(s,t.inputs.currentPagePoint),0)}]`:"",i=n.startsWith("select.")&&!n.includes(".idle")?` / [${q.ToFixed(t.inputs.originPagePoint,0)}] \u2192 [${q.ToFixed(t.inputs.currentPagePoint,0)}] = ${q.Dist(t.inputs.originPagePoint,t.inputs.currentPagePoint).toFixed(0)}`:"";return E.jsx("div",{className:"tlui-debug-panel__current-state",children:`${n}${a}${i}`})});function jre(){const t=We("show_fps",()=>jn.showFps.get(),[jn]),n=z.useRef(null);return z.useEffect(()=>{if(!t)return;const o=250;let r=0,s=!1,a=performance.now(),i=0,l=0,c=!1;function u(){if(!s){if(l++,i=performance.now()-a,i>o){const f=Math.round(l*(o/i)*(1e3/o));f>r&&(r=f);const h=r*.75;(f<h&&!c||f>=h&&c)&&(c=!c),n.current.innerHTML=`FPS ${f.toString()}`,n.current.className="tlui-debug-panel__fps"+(c?" tlui-debug-panel__fps__slow":""),i-=o,l=0,a=performance.now()}requestAnimationFrame(u)}}return u(),()=>{s=!0}},[t]),t?E.jsx("div",{ref:n}):null}function uO(){const t=Be(),n=mi(),o=We("locale",()=>t.user.getLocale(),[t]);return E.jsx(Ss,{id:"help menu language",label:"menu.language",children:E.jsx(Nt,{id:"languages",children:Jd.map(({locale:r,label:s})=>E.jsx(ws,{id:`language-${r}`,title:r,label:s,checked:r===o,onSelect:()=>{t.user.updateUserPreferences({locale:r}),n("change-language",{source:"menu",locale:r})}},r))})})}function _re(){return E.jsxs(E.Fragment,{children:[E.jsx(uO,{}),E.jsx(kre,{})]})}function kre(){const{KeyboardShortcutsDialog:t}=il(),{addDialog:n}=Zl();return t?E.jsx(Le,{id:"keyboard-shortcuts-button",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:()=>{n({component:t})}}):null}const Ere=z.memo(function({children:t}){const n=tr(),o=Do(),r=t??E.jsx(_re,{});return o<Xr.MOBILE?null:E.jsx("div",{className:"tlui-help-menu",children:E.jsxs(rc,{id:"help menu",children:[E.jsx(nc,{children:E.jsx(It,{type:"help",title:n("help-menu.title"),"data-testid":"help-menu.button",children:E.jsx(Qt,{icon:"question-mark",small:!0})})}),E.jsx(oc,{side:"top",align:"end",alignOffset:0,sideOffset:8,children:E.jsx(xs,{type:"menu",sourceId:"help-menu",children:r})})]})})});function Cre(){const t=Be(),n=_t(),[o,r]=z.useState(!1),s=z.useRef(!1);return La("toggle showback to content",()=>{const a=s.current,i=t.getCurrentPageShapeIds();let l=!1;i.size&&(l=i.size===t.getCulledShapes().size),a!==l&&(r(l),s.current=l)},[t]),o?E.jsx(Le,{...n["back-to-content"],onSelect:()=>{n["back-to-content"].onSelect("helper-buttons"),r(!1)}}):null}function Pre(){const t=Be(),n=_t();return We("is pen mode",()=>t.getInstanceState().isPenMode,[t])?E.jsx(Le,{...n["exit-pen-mode"]}):null}function Mre(){const t=Be(),n=_t();return We("is following user",()=>!!t.getInstanceState().followingUserId,[t])?E.jsx(Le,{...n["stop-following"]}):null}function Tre(){return E.jsxs(E.Fragment,{children:[E.jsx(Pre,{}),E.jsx(Cre,{}),E.jsx(Mre,{})]})}function Ire({children:t}){const n=t??E.jsx(Tre,{});return E.jsx("div",{className:"tlui-helper-buttons",children:E.jsx(xs,{type:"helper-buttons",sourceId:"helper-buttons",children:n})})}function Are(){const t=_t(),n=or();return E.jsxs(E.Fragment,{children:[E.jsxs(Nt,{label:"shortcuts-dialog.tools",id:"tools",children:[E.jsx(Le,{...t["toggle-tool-lock"]}),E.jsx(Le,{...t["insert-media"]}),E.jsx(Le,{...n.select}),E.jsx(Le,{...n.draw}),E.jsx(Le,{...n.eraser}),E.jsx(Le,{...n.hand}),E.jsx(Le,{...n.rectangle}),E.jsx(Le,{...n.ellipse}),E.jsx(Le,{...n.arrow}),E.jsx(Le,{...n.line}),E.jsx(Le,{...n.text}),E.jsx(Le,{...n.frame}),E.jsx(Le,{...n.note}),E.jsx(Le,{...n.laser})]}),E.jsxs(Nt,{label:"shortcuts-dialog.preferences",id:"preferences",children:[E.jsx(Le,{...t["toggle-dark-mode"]}),E.jsx(Le,{...t["toggle-focus-mode"]}),E.jsx(Le,{...t["toggle-grid"]})]}),E.jsxs(Nt,{label:"shortcuts-dialog.edit",id:"edit",children:[E.jsx(Le,{...t.undo}),E.jsx(Le,{...t.redo}),E.jsx(Le,{...t.cut}),E.jsx(Le,{...t.copy}),E.jsx(Le,{...t.paste}),E.jsx(Le,{...t["select-all"]}),E.jsx(Le,{...t.delete}),E.jsx(Le,{...t.duplicate})]}),E.jsxs(Nt,{label:"shortcuts-dialog.view",id:"view",children:[E.jsx(Le,{...t["zoom-in"]}),E.jsx(Le,{...t["zoom-out"]}),E.jsx(Le,{...t["zoom-to-100"]}),E.jsx(Le,{...t["zoom-to-fit"]}),E.jsx(Le,{...t["zoom-to-selection"]})]}),E.jsxs(Nt,{label:"shortcuts-dialog.transform",id:"transform",children:[E.jsx(Le,{...t["bring-to-front"]}),E.jsx(Le,{...t["bring-forward"]}),E.jsx(Le,{...t["send-backward"]}),E.jsx(Le,{...t["send-to-back"]}),E.jsx(Le,{...t.group}),E.jsx(Le,{...t.ungroup}),E.jsx(Le,{...t["flip-horizontal"]}),E.jsx(Le,{...t["flip-vertical"]}),E.jsx(Le,{...t["align-top"]}),E.jsx(Le,{...t["align-center-vertical"]}),E.jsx(Le,{...t["align-bottom"]}),E.jsx(Le,{...t["align-left"]}),E.jsx(Le,{...t["align-center-horizontal"]}),E.jsx(Le,{...t["align-right"]})]})]})}const Ore=z.memo(function({children:t}){const n=tr(),o=Do(),r=t??E.jsx(Are,{});return E.jsxs(E.Fragment,{children:[E.jsxs(ly,{className:"tlui-shortcuts-dialog__header",children:[E.jsx(cy,{children:n("shortcuts-dialog.title")}),E.jsx(uy,{})]}),E.jsx(Dh,{className:Pt("tlui-shortcuts-dialog__body",{"tlui-shortcuts-dialog__body__mobile":o<=Xr.MOBILE_XS,"tlui-shortcuts-dialog__body__tablet":o<=Xr.TABLET}),children:E.jsx(xs,{type:"keyboard-shortcuts",sourceId:"kbd",children:r})}),E.jsx("div",{className:"tlui-dialog__scrim"})]})});function Lre(){return E.jsxs(E.Fragment,{children:[E.jsx(Dre,{}),E.jsx(Bre,{}),E.jsx(Rre,{}),E.jsx(zre,{}),E.jsx(Gre,{})]})}function Rre(){const t=_t();return E.jsxs(Ss,{id:"export-all-as",label:"context-menu.export-all-as",size:"small",children:[E.jsxs(Nt,{id:"export-all-as-group",children:[E.jsx(Le,{...t["export-all-as-svg"]}),E.jsx(Le,{...t["export-all-as-png"]}),E.jsx(Le,{...t["export-all-as-json"]})]}),E.jsx(Nt,{id:"export-all-as-bg",children:E.jsx(Zw,{})})]})}function Dre(){const t=Be(),n=We("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t]);return E.jsxs(Ss,{id:"edit",label:"menu.edit",disabled:!n,children:[E.jsx(Ure,{}),E.jsx(nO,{}),E.jsx(oO,{}),E.jsx(Fre,{}),E.jsx(Nre,{}),E.jsx(Nt,{id:"select-all",children:E.jsx(sO,{})})]})}function Fre(){return E.jsxs(Nt,{id:"misc",children:[E.jsx(K5,{}),E.jsx(X5,{}),E.jsx(Y5,{}),E.jsx(q5,{}),E.jsx(Q5,{}),E.jsx(Z5,{}),E.jsx(aO,{}),E.jsx(iO,{})]})}function Nre(){return E.jsxs(Nt,{id:"lock",children:[E.jsx(J5,{}),E.jsx($te,{})]})}function Ure(){const t=_t(),n=TT(),o=MT();return E.jsxs(Nt,{id:"undo-redo",children:[E.jsx(Le,{...t.undo,disabled:!n}),E.jsx(Le,{...t.redo,disabled:!o})]})}function Bre(){const t=_t();return E.jsx(Ss,{id:"view",label:"menu.view",children:E.jsxs(Nt,{id:"view-actions",children:[E.jsx(Le,{...t["zoom-in"]}),E.jsx(Le,{...t["zoom-out"]}),E.jsx(eO,{}),E.jsx(tO,{}),E.jsx(rO,{})]})})}function zre(){const t=_t();return E.jsxs(Nt,{id:"extras",children:[E.jsx(Le,{...t["insert-embed"]}),E.jsx(Le,{...t["insert-media"]})]})}function Gre(){return E.jsx(Nt,{id:"preferences",children:E.jsxs(Ss,{id:"preferences",label:"menu.preferences",children:[E.jsxs(Nt,{id:"preferences-actions",children:[E.jsx(nre,{}),E.jsx(ore,{}),E.jsx(sre,{}),E.jsx(ire,{}),E.jsx(are,{}),E.jsx(lre,{}),E.jsx(cre,{}),E.jsx(ure,{}),E.jsx(dre,{})]}),E.jsx(Nt,{id:"language",children:E.jsx(uO,{})})]})})}const Vre=z.memo(function({children:t}){const n=Qn(),[o,r]=nl("main menu"),s=tr(),a=t??E.jsx(Lre,{});return E.jsxs(Kw,{dir:"ltr",open:o,onOpenChange:r,modal:!1,children:[E.jsx(Xw,{asChild:!0,dir:"ltr",children:E.jsx(It,{type:"icon","data-testid":"main-menu.button",title:s("menu.title"),children:E.jsx(Qt,{icon:"menu",small:!0})})}),E.jsx(Ty,{container:n,children:E.jsx(Qw,{className:"tlui-menu",side:"bottom",align:"start",collisionPadding:4,alignOffset:0,sideOffset:6,children:E.jsx(xs,{type:"menu",sourceId:"main-menu",children:a})})})]})}),Hre=z.memo(function(){const t=Do(),{MainMenu:n,QuickActions:o,ActionsMenu:r,PageMenu:s}=il();return!n&&!s&&t<6?null:E.jsx("div",{className:"tlui-menu-zone",children:E.jsxs("div",{className:"tlui-buttons__horizontal",children:[n&&E.jsx(n,{}),s&&E.jsx(s,{}),t<6?null:E.jsxs(E.Fragment,{children:[o&&E.jsx(o,{}),r&&E.jsx(r,{})]})]})})}),eS={};function Yh(t){if(eS[t])return eS[t];const n=document.createElement("canvas").getContext("2d");n.fillStyle=t,n.fillRect(0,0,1,1);const[o,r,s,a]=n.getImageData(0,0,1,1).data,i=new Float32Array([o/255,r/255,s/255,a/255]);return eS[t]=i,i}const Iy=10,dO=4*6*Iy+12+4*12;function Uu(t,{center:n,radius:o,numArcSegments:r=20,startAngle:s=0,endAngle:a=nr,offset:i=0}){const l=(a-s)/r;let c=i;for(let u=s;u<a;u+=l)t[c++]=n.x,t[c++]=n.y,t[c++]=n.x+Math.cos(u)*o,t[c++]=n.y+Math.sin(u)*o,t[c++]=n.x+Math.cos(u+l)*o,t[c++]=n.y+Math.sin(u+l)*o;return t}function Bu(t,n,o,r,s,a){t[n++]=o,t[n++]=r,t[n++]=o,t[n++]=r+a,t[n++]=o+s,t[n++]=r,t[n++]=o+s,t[n++]=r,t[n++]=o,t[n++]=r+a,t[n++]=o+s,t[n++]=r+a}function Wre(t,n,o){const r=Iy;o=Math.min(o,Math.min(n.w,n.h)/2);const s=mt.ExpandBy(n,-o);if(s.w<=0||s.h<=0)return Uu(t,{center:n.center,radius:o,numArcSegments:Iy*4}),Iy*4*6;let a=0;return Bu(t,a,s.minX,s.minY,s.w,s.h),a+=12,Bu(t,a,s.minX,n.minY,s.w,o),a+=12,Bu(t,a,s.maxX,s.minY,o,s.h),a+=12,Bu(t,a,s.minX,s.maxY,s.w,o),a+=12,Bu(t,a,n.minX,s.minY,o,s.h),a+=12,Uu(t,{numArcSegments:r,offset:a,center:s.point,radius:o,startAngle:Yt,endAngle:Yt*1.5}),a+=r*6,Uu(t,{numArcSegments:r,offset:a,center:q.Add(s.point,new q(s.w,0)),radius:o,startAngle:Yt*1.5,endAngle:nr}),a+=r*6,Uu(t,{numArcSegments:r,offset:a,center:q.Add(s.point,s.size),radius:o,startAngle:0,endAngle:hr}),a+=r*6,Uu(t,{numArcSegments:r,offset:a,center:q.Add(s.point,new q(0,s.h)),radius:o,startAngle:hr,endAngle:Yt}),dO}function $re(t){if(!t)throw new Error("Canvas element not found");const n=t.getContext("webgl2",{premultipliedAlpha:!1});if(!n)throw new Error("Failed to get webgl2 context");const o=`#version 300 es
  precision mediump float;
  
  in vec2 shapeVertexPosition;

	uniform vec4 canvasPageBounds;

	// taken (with thanks) from
	// https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html
  void main() {
		// convert the position from pixels to 0.0 to 1.0
		vec2 zeroToOne = (shapeVertexPosition - canvasPageBounds.xy) / canvasPageBounds.zw;
	
		// convert from 0->1 to 0->2
		vec2 zeroToTwo = zeroToOne * 2.0;
	
		// convert from 0->2 to -1->+1 (clipspace)
		vec2 clipSpace = zeroToTwo - 1.0;
	
		gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }`,r=n.createShader(n.VERTEX_SHADER);if(!r)throw new Error("Failed to create vertex shader");if(n.shaderSource(r,o),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Failed to compile vertex shader");const s=`#version 300 es
  precision mediump float;
  
	uniform vec4 fillColor;
  out vec4 outputColor;

  void main() {
	outputColor = fillColor;
  }`,a=n.createShader(n.FRAGMENT_SHADER);if(!a)throw new Error("Failed to create fragment shader");if(n.shaderSource(a,s),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS))throw new Error("Failed to compile fragment shader");const i=n.createProgram();if(!i)throw new Error("Failed to create program");if(n.attachShader(i,r),n.attachShader(i,a),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw new Error("Failed to link program");n.useProgram(i);const l=n.getAttribLocation(i,"shapeVertexPosition");if(l<0)throw new Error("Failed to get shapeVertexPosition attribute location");n.enableVertexAttribArray(l);const c=n.getUniformLocation(i,"canvasPageBounds"),u=n.getUniformLocation(i,"fillColor");if(!n.createBuffer())throw new Error("Failed to create buffer");if(!n.createBuffer())throw new Error("Failed to create buffer");return{context:n,selectedShapes:Ay(n,1024),unselectedShapes:Ay(n,4096),viewport:Ay(n,dO),collaborators:Ay(n,1024),prepareTriangles(f,h){n.bindBuffer(n.ARRAY_BUFFER,f.buffer),n.bufferData(n.ARRAY_BUFFER,f.vertices,n.STATIC_DRAW,0,h),n.enableVertexAttribArray(l),n.vertexAttribPointer(l,2,n.FLOAT,!1,0,0)},drawTrianglesTransparently(f){n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.drawArrays(n.TRIANGLES,0,f/2),n.disable(n.BLEND)},drawTriangles(f){n.drawArrays(n.TRIANGLES,0,f/2)},setFillColor(f){n.uniform4fv(u,f)},setCanvasPageBounds(f){n.uniform4fv(c,f)}}}function Ay(t,n){const o=t.createBuffer();if(!o)throw new Error("Failed to create buffer");return{buffer:o,vertices:new Float32Array(n)}}function hO(t,n,o){let r=t.vertices.length;for(;r<n+o.length;)r*=2;if(r!=t.vertices.length){const s=new Float32Array(r);s.set(t.vertices),t.vertices=s}t.vertices.set(o,n)}var qre=Object.defineProperty,Yre=Object.getOwnPropertyDescriptor,sl=(t,n,o,r)=>{for(var s=r>1?void 0:r?Yre(n,o):n,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=(r?i(n,o,s):i(s))||s);return r&&s&&qre(n,o,s),s};class oa{constructor(n,o){R(this,"disposables",[]);R(this,"close",()=>this.disposables.forEach(n=>n()));R(this,"gl");R(this,"shapeGeometryCache");R(this,"colors");R(this,"id",Ir());R(this,"canvasBoundingClientRect",fo("canvasBoundingClientRect",new mt));R(this,"originPagePoint",new q);R(this,"originPageCenter",new q);R(this,"isInViewport",!1);R(this,"getMinimapPagePoint",(n,o)=>{const r=this.getCanvasPageBounds(),s=this.getCanvasScreenBounds();let a=n-s.x,i=o-s.y;return a*=r.width/s.width,i*=r.height/s.height,a+=r.minX,i+=r.minY,new q(a,i,1)});R(this,"minimapScreenPointToPagePoint",(n,o,r=!1,s=!1)=>{const{editor:a}=this,i=a.getViewportPageBounds();let{x:l,y:c}=this.getMinimapPagePoint(n,o);if(s){const u=this.editor.getCurrentPageBounds()??new mt,f=i,h=u.minX-f.width/2,d=u.maxX+f.width/2,p=u.minY-f.height/2,y=u.maxY+f.height/2,g=Math.max(0,h+f.width-l),b=Math.max(0,-(d-f.width-l)),m=Math.max(0,p+f.height-c),v=Math.max(0,-(y-f.height-c)),x=Math.max(0,g-b),w=Math.max(0,b-g),S=Math.max(0,m-v),k=Math.max(0,v-m);x&&x>w?l+=x/2:w&&(l-=w/2),S&&S>k?c+=S/2:k&&(c-=k/2),l=Ba(l,h,d),c=Ba(c,p,y)}if(r){const{originPagePoint:u}=this,f=Math.abs(l-u.x),h=Math.abs(c-u.y);f>h?c=u.y:l=u.x}return new q(l,c)});R(this,"render",()=>{const n=this.gl.context,o=this.getCanvasSize();this.gl.setCanvasPageBounds(this.getCanvasPageBoundsArray()),this.elem.width=o.x,this.elem.height=o.y,n.viewport(0,0,o.x,o.y),n.clearColor(this.colors.background[0],this.colors.background[1],this.colors.background[2],1),n.clear(n.COLOR_BUFFER_BIT);const r=new Set(this.editor.getSelectedShapeIds()),s=this.colors;let a=0,i=0;const l=this.editor.getCurrentPageShapeIdsSorted();for(let c=0,u=l.length;c<u;c++){const f=l[c],h=this.shapeGeometryCache.get(f);if(!h)continue;const d=h.length;r.has(f)?(hO(this.gl.selectedShapes,a,h),a+=d):(hO(this.gl.unselectedShapes,i,h),i+=d)}this.drawShapes(this.gl.unselectedShapes,i,s.shapeFill),this.drawShapes(this.gl.selectedShapes,a,s.selectFill),this.drawViewport(),this.drawCollaborators()});this.editor=n,this.elem=o,this.gl=$re(o),this.shapeGeometryCache=n.store.createComputedCache("webgl-geometry",r=>{const s=n.getShapeMaskedPageBounds(r.id);if(!s)return null;const a=new Float32Array(12);return Bu(a,0,s.x,s.y,s.w,s.h),a}),this.colors=this._getColors(),this.disposables.push(this._listenForCanvasResize(),Bc("minimap render",this.render))}_getColors(){const n=getComputedStyle(this.editor.getContainer());return{shapeFill:Yh(n.getPropertyValue("--color-text-3").trim()),selectFill:Yh(n.getPropertyValue("--color-selected").trim()),viewportFill:Yh(n.getPropertyValue("--color-muted-1").trim()),background:Yh(n.getPropertyValue("--color-low").trim())}}updateColors(){this.colors=this._getColors()}getDpr(){return this.editor.getInstanceState().devicePixelRatio}getContentPageBounds(){const n=this.editor.getViewportPageBounds(),o=this.editor.getCurrentPageBounds();return o?mt.Expand(o,n):n}getContentScreenBounds(){const n=this.getContentPageBounds(),o=this.editor.pageToScreen(n.point),r=this.editor.pageToScreen(new q(n.maxX,n.maxY));return new mt(o.x,o.y,r.x-o.x,r.y-o.y)}_getCanvasBoundingRect(){const{x:n,y:o,width:r,height:s}=this.elem.getBoundingClientRect();return new mt(n,o,r,s)}getCanvasScreenBounds(){return this.canvasBoundingClientRect.get()}_listenForCanvasResize(){const n=new ResizeObserver(()=>{const o=this._getCanvasBoundingRect();this.canvasBoundingClientRect.set(o)});return n.observe(this.elem),()=>n.disconnect()}getCanvasSize(){const n=this.canvasBoundingClientRect.get(),o=this.getDpr();return new q(n.width*o,n.height*o)}getCanvasClientPosition(){return this.canvasBoundingClientRect.get().point}getCanvasPageBounds(){const n=this.getCanvasScreenBounds(),o=this.getContentPageBounds(),r=n.width/n.height;let s=o.width,a=s/r;a<o.height&&(a=o.height,s=a*r);const i=new mt(0,0,s,a);return i.center=o.center,i}getZoom(){return this.getCanvasPageBounds().width/this.getCanvasScreenBounds().width}getCanvasPageBoundsArray(){const{x:n,y:o,w:r,h:s}=this.getCanvasPageBounds();return new Float32Array([n,o,r,s])}drawShapes(n,o,r){this.gl.prepareTriangles(n,o),this.gl.setFillColor(r),this.gl.drawTriangles(o)}drawViewport(){const n=this.editor.getViewportPageBounds(),o=Wre(this.gl.viewport.vertices,n,4*this.getZoom());this.gl.prepareTriangles(this.gl.viewport,o),this.gl.setFillColor(this.colors.viewportFill),this.gl.drawTrianglesTransparently(o)}drawCollaborators(){const n=this.editor.getCollaboratorsOnCurrentPage();if(!n.length)return;const o=20,r=o*6,s=r*n.length;this.gl.collaborators.vertices.length<s&&(this.gl.collaborators.vertices=new Float32Array(s));const a=this.gl.collaborators.vertices;let i=0;const l=this.getZoom();for(const{cursor:c}of n)Uu(a,{center:q.From(c),radius:3*l,offset:i,numArcSegments:o}),i+=r;this.gl.prepareTriangles(this.gl.collaborators,s),i=0;for(const{color:c}of n)this.gl.setFillColor(Yh(c)),this.gl.context.drawArrays(this.gl.context.TRIANGLES,i/2,r/2),i+=r}}sl([Ye],oa.prototype,"getDpr",1),sl([Ye],oa.prototype,"getContentPageBounds",1),sl([Ye],oa.prototype,"getContentScreenBounds",1),sl([Ye],oa.prototype,"getCanvasSize",1),sl([Ye],oa.prototype,"getCanvasClientPosition",1),sl([Ye],oa.prototype,"getCanvasPageBounds",1),sl([Ye],oa.prototype,"getZoom",1),sl([Ye],oa.prototype,"getCanvasPageBoundsArray",1);function Kre(){const t=Be(),n=z.useRef(null),o=z.useRef(!1),r=z.useRef();z.useEffect(()=>{const u=new oa(t,n.current);return r.current=u,r.current.close},[t]);const s=z.useCallback(u=>{if(!t.getCurrentPageShapeIds().size||!r.current)return;const f=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),h=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);r.current.originPagePoint.setTo(h),r.current.originPageCenter.setTo(t.getViewportPageBounds().center),t.centerOnPoint(f,{duration:si})},[t]),a=z.useCallback(u=>{if(!r.current)return;const f=u.currentTarget;if(ih(f,u),!t.getCurrentPageShapeIds().size)return;o.current=!0,r.current.isInViewport=!1;const h=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),d=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0),p=t.getViewportPageBounds();if(r.current.isInViewport=p.containsPoint(d),r.current.isInViewport)r.current.originPagePoint.setTo(d),r.current.originPageCenter.setTo(p.center);else{const g=q.Sub(p.center,p.point),b=q.Add(h,g);r.current.originPagePoint.setTo(b),r.current.originPageCenter.setTo(h),t.centerOnPoint(h,{duration:si})}function y(g){f&&ah(f,g),o.current=!1,document.body.removeEventListener("pointerup",y)}document.body.addEventListener("pointerup",y)},[t]),i=z.useCallback(u=>{if(!r.current)return;const f=r.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,u.shiftKey,!0);if(o.current){if(r.current.isInViewport){const y=r.current.originPagePoint.clone().sub(r.current.originPageCenter);t.centerOnPoint(q.Sub(f,y));return}t.centerOnPoint(f)}const h=r.current.getMinimapPagePoint(u.clientX,u.clientY),d=t.pageToScreen(h),p={type:"pointer",target:"canvas",name:"pointer_move",...Lo(u),point:d,isPen:t.getInstanceState().isPenMode};t.dispatch(p)},[t]),l=z.useCallback(u=>{const f=vC(u);t.dispatch({type:"wheel",name:"wheel",delta:f,point:new q(u.clientX,u.clientY),shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey})},[t]),c=yh();return z.useEffect(()=>{setTimeout(()=>{var u,f;(u=r.current)==null||u.updateColors(),(f=r.current)==null||f.render()})},[c]),E.jsx("div",{className:"tlui-minimap",children:E.jsx("canvas",{role:"img","aria-label":"minimap",ref:n,className:"tlui-minimap__canvas",onDoubleClick:s,onPointerMove:i,onPointerDown:a,onWheel:l})})}function Xre(t,n){const[o,r]=Bt.useState(n);Bt.useLayoutEffect(()=>{const a=mb(t);if(a)try{r(JSON.parse(a))}catch{console.error(`Could not restore value ${t} from local storage.`)}},[t]);const s=Bt.useCallback(a=>{r(i=>{const l=typeof a=="function"?a(i):a;return gb(t,JSON.stringify(l)),l})},[t]);return[o,s]}const Qre=z.memo(function(){const t=_t(),n=tr(),o=Do(),[r,s]=Xre("minimap",!0),a=z.useCallback(()=>{s(c=>!c)},[s]),{ZoomMenu:i,Minimap:l}=il();return o<Xr.MOBILE?null:E.jsxs("div",{className:"tlui-navigation-panel",children:[E.jsx("div",{className:"tlui-buttons__horizontal",children:i&&o<Xr.TABLET?E.jsx(i,{}):r?E.jsxs(E.Fragment,{children:[i&&E.jsx(i,{}),l&&E.jsx(It,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:a,children:E.jsx(Qt,{icon:r?"chevrons-ne":"chevrons-sw"})})]}):E.jsxs(E.Fragment,{children:[E.jsx(It,{type:"icon","data-testid":"minimap.zoom-out",title:`${n(Nh(t["zoom-out"].label))} ${Yw(t["zoom-out"].kbd)}`,onClick:()=>t["zoom-out"].onSelect("navigation-zone"),children:E.jsx(Qt,{icon:"minus"})}),i&&E.jsx(i,{}),E.jsx(It,{type:"icon","data-testid":"minimap.zoom-in",title:`${n(Nh(t["zoom-in"].label))} ${Yw(t["zoom-in"].kbd)}`,onClick:()=>t["zoom-in"].onSelect("navigation-zone"),children:E.jsx(Qt,{icon:"plus"})}),l&&E.jsx(It,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:a,children:E.jsx(Qt,{icon:r?"chevrons-ne":"chevrons-sw"})})]})}),l&&o>=Xr.TABLET&&!r&&E.jsx(l,{})]})}),Zre=function({name:t,id:n,isCurrentPage:o}){const r=Be(),s=z.useRef(null),a=z.useCallback(l=>{r.renamePage(n,l||"New Page",{ephemeral:!0})},[r,n]),i=z.useCallback(l=>{r.mark("rename page"),r.renamePage(n,l||"New Page",{ephemeral:!1})},[r,n]);return E.jsx(ww,{className:"tlui-page-menu__item__input",ref:l=>s.current=l,defaultValue:t,onValueChange:a,onComplete:i,onCancel:i,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:o,autoselect:!0})},tS=(t,n,o,r)=>{let s;const a=t.getPages(),i=o>r?a[r-1]:a[r],l=o>r?a[r]:a[r+1];i&&!l?s=Di(i.index):!i&&l?s=XR(a[0].index):s=Gd(i.index,l.index),s!==a[o].index&&(t.mark("moving page"),t.updatePage({id:n,index:s}))},pO=qo(function({index:t,listSize:n,item:o,onRename:r}){const s=Be(),a=tr(),i=s.getPages(),l=z.useCallback(()=>{s.mark("creating page");const h=Ui.createId();s.duplicatePage(o.id,h)},[s,o]),c=z.useCallback(()=>{tS(s,o.id,t,t-1)},[s,o,t]),u=z.useCallback(()=>{tS(s,o.id,t,t+1)},[s,o,t]),f=z.useCallback(()=>{s.mark("deleting page"),s.deletePage(o.id)},[s,o]);return E.jsxs(rc,{id:`page item submenu ${t}`,children:[E.jsx(nc,{children:E.jsx(It,{type:"icon",title:a("page-menu.submenu.title"),children:E.jsx(Qt,{icon:"dots-vertical"})})}),E.jsx(oc,{alignOffset:0,side:"right",sideOffset:-4,children:E.jsxs(xs,{type:"menu",sourceId:"page-menu",children:[E.jsxs(Nt,{id:"modify",children:[r&&E.jsx(Le,{id:"rename",label:"page-menu.submenu.rename",onSelect:r}),E.jsx(Le,{id:"duplicate",label:"page-menu.submenu.duplicate-page",onSelect:l,disabled:i.length>=pm}),t>0&&E.jsx(Le,{id:"move-up",onSelect:c,label:"page-menu.submenu.move-up"}),t<n-1&&E.jsx(Le,{id:"move-down",label:"page-menu.submenu.move-down",onSelect:u})]}),n>1&&E.jsx(Nt,{id:"delete",children:E.jsx(Le,{id:"delete",onSelect:f,label:"page-menu.submenu.delete"})})]})})]})}),Jre=z.memo(function(){const t=Be(),n=tr(),o=Do(),r=z.useCallback(()=>g(!1),[]),[s,a]=nl("page-menu",r),i=36,l=z.useRef(null),c=We("pages",()=>t.getPages(),[t]),u=We("currentPage",()=>t.getCurrentPage(),[t]),f=We("currentPageId",()=>t.getCurrentPageId(),[t]),h=Ki(),d=We("maxPageCountReached",()=>t.getPages().length>=pm,[t]),p=We("isCoarsePointer",()=>t.getInstanceState().isCoarsePointer,[t]),[y,g]=z.useState(!1),b=z.useCallback(()=>{h||g(P=>!P)},[h]),m=z.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[v,x]=z.useState(Object.fromEntries(c.map((P,A)=>[P.id,{y:A*i,offsetY:0,isSelected:!1}])));z.useLayoutEffect(()=>{x(Object.fromEntries(c.map((P,A)=>[P.id,{y:A*i,offsetY:0,isSelected:!1}])))},[i,c]),z.useEffect(()=>{s&&requestAnimationFrame(()=>{const P=document.querySelector(`[data-testid="page-menu-item-${f}"]`);if(P){const A=l.current;if(!A)return;const I=P.offsetTop,N=A.scrollTop;I<N&&A.scrollTo({top:I});const O=I+i,F=A.scrollTop+A.offsetHeight;O>F&&A.scrollTo({top:O-A.offsetHeight})}})},[i,f,s]);const w=z.useCallback(P=>{const{clientY:A,currentTarget:I}=P,{dataset:{id:N,index:O}}=I;if(!N||!O)return;const F=m.current;ih(P.currentTarget,P),F.status="pointing",F.pointing={id:N,index:+O};const U=v[N].y;F.startY=A,F.startIndex=Math.max(0,Math.min(Math.round(U/i),c.length-1))},[i,c.length,v]),S=z.useCallback(P=>{const A=m.current;if(A.status==="pointing"){const{clientY:I}=P,N=I-A.startY;Math.abs(N)>5&&(A.status="dragging")}if(A.status==="dragging"){const{clientY:I}=P,N=I-A.startY,O=v[A.pointing.id],{startIndex:F,pointing:U}=A,G=O.y+N,Y=Math.max(0,Math.min(Math.round(G/i),c.length-1)),$={...v};if($[U.id]={y:O.y,offsetY:N,isSelected:!0},Y!==A.dragIndex){A.dragIndex=Y;for(let H=0;H<c.length;H++){const Q=c[H];if(Q.id===A.pointing.id)continue;let{y:J}=$[Q.id];Y===F?J=H*i:Y<F?Y<=H&&H<F?J=(H+1)*i:J=H*i:Y>F&&(Y>=H&&H>F?J=(H-1)*i:J=H*i),J!==$[Q.id].y&&($[Q.id]={y:J,offsetY:0,isSelected:!0})}}x($)}},[i,c,v]),k=z.useCallback(P=>{const A=m.current;if(A.status==="dragging"){const{id:I,index:N}=A.pointing;tS(t,I,N,A.dragIndex)}ah(P.currentTarget,P),A.status="idle"},[t]),_=z.useCallback(P=>{const A=m.current;P.key==="Escape"&&(A.status==="dragging"&&x(Object.fromEntries(c.map((I,N)=>[I.id,{y:N*i,offsetY:0,isSelected:!1}]))),A.status="idle")},[i,c]),C=z.useCallback(()=>{h||t.batch(()=>{t.mark("creating page");const P=Ui.createId();t.createPage({name:n("page-menu.new-page-initial-name"),id:P}),t.setCurrentPage(P),g(!0)})},[t,n,h]);return E.jsxs(Dw,{id:"pages",onOpenChange:a,open:s,children:[E.jsx(Fw,{"data-testid":"main.page-menu",children:E.jsxs(It,{type:"menu",title:u.name,"data-testid":"page-menu.button",className:"tlui-page-menu__trigger",children:[E.jsx("div",{className:"tlui-page-menu__name",children:u.name}),E.jsx(Qt,{icon:"chevron-down",small:!0})]})}),E.jsx(Nw,{side:"bottom",align:"start",sideOffset:6,children:E.jsxs("div",{className:"tlui-page-menu__wrapper",children:[E.jsxs("div",{className:"tlui-page-menu__header",children:[E.jsx("div",{className:"tlui-page-menu__header__title",children:n("page-menu.title")}),!h&&E.jsxs("div",{className:"tlui-buttons__horizontal",children:[E.jsx(It,{type:"icon","data-testid":"page-menu.edit",title:n(y?"page-menu.edit-done":"page-menu.edit-start"),onClick:b,children:E.jsx(Qt,{icon:y?"check":"edit"})}),E.jsx(It,{type:"icon","data-testid":"page-menu.create",title:n(d?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:d,onClick:C,children:E.jsx(Qt,{icon:"plus"})})]})]}),E.jsx("div",{"data-testid":"page-menu.list",className:"tlui-page-menu__list tlui-menu__group",style:{height:i*c.length+4},ref:l,children:c.map((P,A)=>{const I=v[P.id]??{position:A*40,offsetY:0};return y?E.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page_menu__item__sortable",style:{zIndex:P.id===u.id?888:A,transform:`translate(0px, ${I.y+I.offsetY}px)`},children:[E.jsx(It,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",onPointerDown:w,onPointerUp:k,onPointerMove:S,onKeyDown:_,"data-id":P.id,"data-index":A,children:E.jsx(Qt,{icon:"drag-handle-dots"})}),o<Xr.TABLET_SM&&p?E.jsxs(It,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const N=window.prompt("Rename page",P.name);N&&N!==P.name&&t.renamePage(P.id,N)},onDoubleClick:b,children:[E.jsx(Jw,{checked:P.id===u.id}),E.jsx(rn,{children:P.name})]}):E.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:i},children:E.jsx(Zre,{id:P.id,name:P.name,isCurrentPage:P.id===u.id})}),!h&&E.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":y,children:E.jsx(pO,{index:A,item:P,listSize:c.length})})]},P.id+"_editing"):E.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page-menu__item",children:[E.jsxs(It,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>t.setCurrentPage(P.id),onDoubleClick:b,title:n("page-menu.go-to-page"),children:[E.jsx(Jw,{checked:P.id===u.id}),E.jsx(rn,{children:P.name})]}),!h&&E.jsx("div",{className:"tlui-page_menu__item__submenu",children:E.jsx(pO,{index:A,item:P,listSize:c.length,onRename:()=>{if(t.environment.isIos){const N=window.prompt("Rename page",P.name);N&&N!==P.name&&t.renamePage(P.id,N)}else t.batch(()=>{g(!0),t.setCurrentPage(P.id)})}})})]},P.id)})})]})})]})});function ene(){const t=_t(),n=Be(),o=TT(),r=MT(),s=bo(1),a=Ki(),i=We("should display quick actions",()=>n.isInAny("select","hand","zoom"),[n]);if(!(a&&!i))return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t.undo,disabled:!o}),E.jsx(Le,{...t.redo,disabled:!r}),E.jsx(Le,{...t.delete,disabled:!s}),E.jsx(Le,{...t.duplicate,disabled:!s})]})}const tne=z.memo(function({children:t}){const n=t??E.jsx(ene,{});return E.jsx(xs,{type:"small-icons",sourceId:"quick-actions",children:n})}),rne=Object.freeze([Jo,Rl,Kc,ni]);function fO(t=rne){const n=Be();return We("getRelevantStyles",()=>{var a;const o=new i1(n.getSharedStyles()),r=!!((a=n.root.getCurrent())!=null&&a.shapeType),s=n.isIn("select")&&n.getSelectedShapeIds().length>0;if(o.size===0&&n.isIn("select")&&n.getSelectedShapeIds().length===0)for(const i of t)o.applyValue(i,n.getStyleForNextShape(i));return r||s||o.size>0?o:null},[n])}const $s={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]};function nne(t){const{uiType:n,items:o,title:r,style:s,value:a,onValueChange:i,theme:l}=t,c=Be(),u=tr(),f=z.useRef(!1),{handleButtonClick:h,handleButtonPointerDown:d,handleButtonPointerEnter:p,handleButtonPointerUp:y}=z.useMemo(()=>{const g=()=>{f.current=!1,window.removeEventListener("pointerup",g)};return{handleButtonClick:b=>{const{id:m}=b.currentTarget.dataset;a.type==="shared"&&a.value===m||(c.mark("point picker item"),i(s,m,!1))},handleButtonPointerDown:b=>{const{id:m}=b.currentTarget.dataset;c.mark("point picker item"),i(s,m,!0),f.current=!0,window.addEventListener("pointerup",g)},handleButtonPointerEnter:b=>{if(!f.current)return;const{id:m}=b.currentTarget.dataset;i(s,m,!0)},handleButtonPointerUp:b=>{const{id:m}=b.currentTarget.dataset;a.type==="shared"&&a.value===m||i(s,m,!1)}}},[a,c,i,s]);return E.jsx("div",{"data-testid":`style.${n}`,className:Pt("tlui-buttons__grid"),children:o.map(g=>E.jsx(It,{type:"icon","data-id":g.value,"data-testid":`style.${n}.${g.value}`,"aria-label":g.value,"data-state":a.type==="shared"&&a.value===g.value?"hinted":void 0,title:r+" \u2014 "+u(`${n}-style.${g.value}`),className:Pt("tlui-button-grid__button"),style:s===Jo?{color:l[g.value].solid}:void 0,onPointerEnter:p,onPointerDown:d,onPointerUp:y,onClick:h,children:E.jsx(Qt,{icon:g.icon})},g.value))})}const zu=z.memo(nne);function mO(t,[n,o]){return Math.min(o,Math.max(n,t))}function one(t){const n=z.useRef({value:t,previous:t});return z.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}const gO=["PageUp","PageDown"],yO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],vO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Kh="Slider",[rS,sne,ine]=Yg(Kh),[bO,fse]=hi(Kh,[ine]),[ane,Oy]=bO(Kh),lne=z.forwardRef((t,n)=>{const{name:o,min:r=0,max:s=100,step:a=1,orientation:i="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[r],value:f,onValueChange:h=()=>{},onValueCommit:d=()=>{},inverted:p=!1,...y}=t,[g,b]=z.useState(null),m=jr(n,F=>b(F)),v=z.useRef(new Set),x=z.useRef(0),w=i==="horizontal",S=g?!!g.closest("form"):!0,k=w?cne:une,[_=[],C]=Qa({prop:f,defaultProp:u,onChange:F=>{var U;(U=[...v.current][x.current])===null||U===void 0||U.focus(),h(F)}}),P=z.useRef(_);function A(F){const U=bne(_,F);O(F,U)}function I(F){O(F,x.current)}function N(){const F=P.current[x.current];_[x.current]!==F&&d(_)}function O(F,U,{commit:G}={commit:!1}){const Y=jne(a),$=_ne(Math.round((F-r)/a)*a+r,Y),H=mO($,[r,s]);C((Q=[])=>{const J=yne(Q,H,U);if(Sne(J,c*a)){x.current=J.indexOf(H);const ae=String(J)!==String(Q);return ae&&G&&d(J),ae?J:Q}else return Q})}return z.createElement(ane,{scope:t.__scopeSlider,disabled:l,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:_,orientation:i},z.createElement(rS.Provider,{scope:t.__scopeSlider},z.createElement(rS.Slot,{scope:t.__scopeSlider},z.createElement(k,ot({"aria-disabled":l,"data-disabled":l?"":void 0},y,{ref:m,onPointerDown:xt(y.onPointerDown,()=>{l||(P.current=_)}),min:r,max:s,inverted:p,onSlideStart:l?void 0:A,onSlideMove:l?void 0:I,onSlideEnd:l?void 0:N,onHomeKeyDown:()=>!l&&O(r,0,{commit:!0}),onEndKeyDown:()=>!l&&O(s,_.length-1,{commit:!0}),onStepKeyDown:({event:F,direction:U})=>{if(!l){const G=gO.includes(F.key)||F.shiftKey&&yO.includes(F.key)?10:1,Y=x.current,$=_[Y],H=a*G*U;O($+H,Y,{commit:!0})}}})))),S&&_.map((F,U)=>z.createElement(gne,{key:U,name:o?o+(_.length>1?"[]":""):void 0,value:F})))}),[xO,wO]=bO(Kh,{startEdge:"left",endEdge:"right",size:"width",direction:1}),cne=z.forwardRef((t,n)=>{const{min:o,max:r,dir:s,inverted:a,onSlideStart:i,onSlideMove:l,onSlideEnd:c,onStepKeyDown:u,...f}=t,[h,d]=z.useState(null),p=jr(n,x=>d(x)),y=z.useRef(),g=Uw(s),b=g==="ltr",m=b&&!a||!b&&a;function v(x){const w=y.current||h.getBoundingClientRect(),S=[0,w.width],k=nS(S,m?[o,r]:[r,o]);return y.current=w,k(x-w.left)}return z.createElement(xO,{scope:t.__scopeSlider,startEdge:m?"left":"right",endEdge:m?"right":"left",direction:m?1:-1,size:"width"},z.createElement(SO,ot({dir:g,"data-orientation":"horizontal"},f,{ref:p,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:x=>{const w=v(x.clientX);i==null||i(w)},onSlideMove:x=>{const w=v(x.clientX);l==null||l(w)},onSlideEnd:()=>{y.current=void 0,c==null||c()},onStepKeyDown:x=>{const w=vO[m?"from-left":"from-right"].includes(x.key);u==null||u({event:x,direction:w?-1:1})}})))}),une=z.forwardRef((t,n)=>{const{min:o,max:r,inverted:s,onSlideStart:a,onSlideMove:i,onSlideEnd:l,onStepKeyDown:c,...u}=t,f=z.useRef(null),h=jr(n,f),d=z.useRef(),p=!s;function y(g){const b=d.current||f.current.getBoundingClientRect(),m=[0,b.height],v=nS(m,p?[r,o]:[o,r]);return d.current=b,v(g-b.top)}return z.createElement(xO,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1},z.createElement(SO,ot({"data-orientation":"vertical"},u,{ref:h,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const b=y(g.clientY);a==null||a(b)},onSlideMove:g=>{const b=y(g.clientY);i==null||i(b)},onSlideEnd:()=>{d.current=void 0,l==null||l()},onStepKeyDown:g=>{const b=vO[p?"from-bottom":"from-top"].includes(g.key);c==null||c({event:g,direction:b?-1:1})}})))}),SO=z.forwardRef((t,n)=>{const{__scopeSlider:o,onSlideStart:r,onSlideMove:s,onSlideEnd:a,onHomeKeyDown:i,onEndKeyDown:l,onStepKeyDown:c,...u}=t,f=Oy(Kh,o);return z.createElement(vr.span,ot({},u,{ref:n,onKeyDown:xt(t.onKeyDown,h=>{h.key==="Home"?(i(h),h.preventDefault()):h.key==="End"?(l(h),h.preventDefault()):gO.concat(yO).includes(h.key)&&(c(h),h.preventDefault())}),onPointerDown:xt(t.onPointerDown,h=>{const d=h.target;d.setPointerCapture(h.pointerId),h.preventDefault(),f.thumbs.has(d)?d.focus():r(h)}),onPointerMove:xt(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&s(h)}),onPointerUp:xt(t.onPointerUp,h=>{const d=h.target;d.hasPointerCapture(h.pointerId)&&(d.releasePointerCapture(h.pointerId),a(h))})}))}),dne="SliderTrack",hne=z.forwardRef((t,n)=>{const{__scopeSlider:o,...r}=t,s=Oy(dne,o);return z.createElement(vr.span,ot({"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation},r,{ref:n}))}),jO="SliderRange",pne=z.forwardRef((t,n)=>{const{__scopeSlider:o,...r}=t,s=Oy(jO,o),a=wO(jO,o),i=z.useRef(null),l=jr(n,i),c=s.values.length,u=s.values.map(d=>kO(d,s.min,s.max)),f=c>1?Math.min(...u):0,h=100-Math.max(...u);return z.createElement(vr.span,ot({"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0},r,{ref:l,style:{...t.style,[a.startEdge]:f+"%",[a.endEdge]:h+"%"}}))}),_O="SliderThumb",fne=z.forwardRef((t,n)=>{const o=sne(t.__scopeSlider),[r,s]=z.useState(null),a=jr(n,l=>s(l)),i=z.useMemo(()=>r?o().findIndex(l=>l.ref.current===r):-1,[o,r]);return z.createElement(mne,ot({},t,{ref:a,index:i}))}),mne=z.forwardRef((t,n)=>{const{__scopeSlider:o,index:r,...s}=t,a=Oy(_O,o),i=wO(_O,o),[l,c]=z.useState(null),u=jr(n,b=>c(b)),f=e5(l),h=a.values[r],d=h===void 0?0:kO(h,a.min,a.max),p=vne(r,a.values.length),y=f==null?void 0:f[i.size],g=y?xne(y,d,i.direction):0;return z.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),z.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[i.startEdge]:`calc(${d}% + ${g}px)`}},z.createElement(rS.ItemSlot,{scope:t.__scopeSlider},z.createElement(vr.span,ot({role:"slider","aria-label":t["aria-label"]||p,"aria-valuemin":a.min,"aria-valuenow":h,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0},s,{ref:u,style:h===void 0?{display:"none"}:t.style,onFocus:xt(t.onFocus,()=>{a.valueIndexToChangeRef.current=r})}))))}),gne=t=>{const{value:n,...o}=t,r=z.useRef(null),s=one(n);return z.useEffect(()=>{const a=r.current,i=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(i,"value").set;if(s!==n&&l){const c=new Event("input",{bubbles:!0});l.call(a,n),a.dispatchEvent(c)}},[s,n]),z.createElement("input",ot({style:{display:"none"}},o,{ref:r,defaultValue:n}))};function yne(t=[],n,o){const r=[...t];return r[o]=n,r.sort((s,a)=>s-a)}function kO(t,n,o){const r=100/(o-n)*(t-n);return mO(r,[0,100])}function vne(t,n){return n>2?`Value ${t+1} of ${n}`:n===2?["Minimum","Maximum"][t]:void 0}function bne(t,n){if(t.length===1)return 0;const o=t.map(s=>Math.abs(s-n)),r=Math.min(...o);return o.indexOf(r)}function xne(t,n,o){const r=t/2,s=nS([0,50],[0,r]);return(r-s(n)*o)*o}function wne(t){return t.slice(0,-1).map((n,o)=>t[o+1]-n)}function Sne(t,n){if(n>0){const o=wne(t);return Math.min(...o)>=n}return!0}function nS(t,n){return o=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(t[1]-t[0]);return n[0]+r*(o-t[0])}}function jne(t){return(String(t).split(".")[1]||"").length}function _ne(t,n){const o=Math.pow(10,n);return Math.round(t*o)/o}const kne=lne,Ene=hne,Cne=pne,Pne=fne,Mne=z.memo(function(t){const{title:n,steps:o,value:r,label:s,onValueChange:a}=t,i=Be(),l=tr(),c=z.useCallback(h=>{a(h[0],!0)},[a]),u=z.useCallback(()=>{i.mark("click slider")},[i]),f=z.useCallback(()=>{r&&a(r,!1)},[r,a]);return E.jsx("div",{className:"tlui-slider__container",children:E.jsxs(kne,{"data-testid":t["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:o,step:1,value:r?[r]:void 0,onPointerDown:u,onValueChange:c,onPointerUp:f,title:n+" \u2014 "+l(s),children:[E.jsx(Ene,{className:"tlui-slider__track",dir:"ltr",children:r!==null&&E.jsx(Cne,{className:"tlui-slider__range",dir:"ltr"})}),r!==null&&E.jsx(Pne,{className:"tlui-slider__thumb",dir:"ltr"})]})})});function Tne({label:t,uiTypeA:n,uiTypeB:o,labelA:r,labelB:s,itemsA:a,itemsB:i,styleA:l,styleB:c,valueA:u,valueB:f,onValueChange:h}){const d=tr(),p=z.useMemo(()=>{var g;return((g=a.find(b=>u.type==="shared"&&u.value===b.value))==null?void 0:g.icon)??"mixed"},[a,u]),y=z.useMemo(()=>{var g;return((g=i.find(b=>f.type==="shared"&&f.value===b.value))==null?void 0:g.icon)??"mixed"},[i,f]);return u===void 0&&f===void 0?null:E.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[E.jsx("div",{title:d(t),className:"tlui-style-panel__double-select-picker-label",children:d(t)}),E.jsxs("div",{className:"tlui-buttons__horizontal",children:[E.jsxs(rc,{id:`style panel ${n} A`,children:[E.jsx(nc,{children:E.jsx(It,{type:"icon","data-testid":`style.${n}`,title:d(r)+" \u2014 "+(u===null||u.type==="mixed"?d("style-panel.mixed"):d(`${n}-style.${u.value}`)),children:E.jsx(Qt,{icon:p,small:!0,invertIcon:!0})})}),E.jsx(oc,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:E.jsx("div",{className:"tlui-buttons__grid",children:a.map((g,b)=>E.jsx($h,{"data-testid":`style.${n}.${g.value}`,children:E.jsx(It,{type:"icon",onClick:()=>h(l,g.value,!1),title:`${d(r)} \u2014 ${d(`${n}-style.${g.value}`)}`,children:E.jsx(Qt,{icon:g.icon,invertIcon:!0})},g.value)},b))})})]}),E.jsxs(rc,{id:`style panel ${o}`,children:[E.jsx(nc,{children:E.jsx(It,{type:"icon","data-testid":`style.${o}`,title:d(s)+" \u2014 "+(f===null||f.type==="mixed"?d("style-panel.mixed"):d(`${o}-style.${f.value}`)),children:E.jsx(Qt,{icon:y,small:!0})})}),E.jsx(oc,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:E.jsx("div",{className:"tlui-buttons__grid",children:i.map(g=>E.jsx($h,{children:E.jsx(It,{type:"icon",title:`${d(s)} \u2014 ${d(`${o}-style.${g.value}`)}`,"data-testid":`style.${o}.${g.value}`,onClick:()=>h(c,g.value,!1),children:E.jsx(Qt,{icon:g.icon})})},g.value))})})]})]})]})}const Ine=z.memo(Tne);function Ane({id:t,label:n,uiType:o,style:r,items:s,type:a,value:i,onValueChange:l}){const c=tr(),u=Be(),f=z.useMemo(()=>{var p;return(p=s.find(y=>i.type==="shared"&&y.value===i.value))==null?void 0:p.icon},[s,i]),h=i.type==="mixed"?c("style-panel.mixed"):c(`${o}-style.${i.value}`),d=n?c(n):"";return E.jsxs(rc,{id:`style panel ${t}`,children:[E.jsx(nc,{children:E.jsxs(It,{type:a,"data-testid":`style.${o}`,title:h,children:[E.jsx(rn,{children:d}),E.jsx(Qt,{icon:f??"mixed"})]})}),E.jsx(oc,{side:"left",align:"center",alignOffset:0,children:E.jsx("div",{className:"tlui-buttons__grid",children:s.map(p=>E.jsx($h,{children:E.jsx(It,{type:"icon","data-testid":`style.${o}.${p.value}`,title:c(`${o}-style.${p.value}`),onClick:()=>{u.mark("select style dropdown item"),l(r,p.value,!1)},children:E.jsx(Qt,{icon:p.icon})})},p.value))})})]})}const oS=z.memo(Ane);function One({styles:t}){const n=yh();if(!t)return null;const o=t.get(oi),r=t.get(em),s=t.get(Jf),a=t.get(nm),i=t.get(ri),l=o===void 0,c=r===void 0&&s===void 0,u=a===void 0,f=i===void 0,h=Bi({isDarkMode:n});return E.jsxs(E.Fragment,{children:[E.jsx(Lne,{theme:h,styles:t}),!f&&E.jsx(Rne,{theme:h,styles:t}),!(l&&c&&u)&&E.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[E.jsx(Dne,{styles:t}),E.jsx(Nne,{styles:t}),E.jsx(Fne,{styles:t})]})]})}function Xh(){const t=Be(),n=mi();return Bt.useMemo(()=>function(o,r,s){t.batch(()=>{t.isIn("select")&&t.setStyleForSelectedShapes(o,r,{squashing:s}),t.setStyleForNextShapes(o,r,{squashing:s}),t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),n("set-style",{source:"style-panel",id:o.id,value:r})},[t,n])}function Lne({styles:t,theme:n}){const o=tr(),r=Be(),s=Xh(),a=t.get(Jo),i=t.get(Kc),l=t.get(Rl),c=t.get(ni),u=i!==void 0||l!==void 0||c!==void 0;return E.jsxs(E.Fragment,{children:[E.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles","data-testid":"style.panel",children:[a===void 0?null:E.jsx(zu,{title:o("style-panel.color"),uiType:"color",style:Jo,items:$s.color,value:a,onValueChange:s,theme:n}),E.jsx(Une,{})]}),u&&E.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[i===void 0?null:E.jsx(zu,{title:o("style-panel.fill"),uiType:"fill",style:Kc,items:$s.fill,value:i,onValueChange:s,theme:n}),l===void 0?null:E.jsx(zu,{title:o("style-panel.dash"),uiType:"dash",style:Rl,items:$s.dash,value:l,onValueChange:s,theme:n}),c===void 0?null:E.jsx(zu,{title:o("style-panel.size"),uiType:"size",style:ni,items:$s.size,value:c,onValueChange:(f,h,d)=>{s(f,h,d);const p=r.getSelectedShapeIds();p.length>0&&Sr(r,p)},theme:n})]})]})}function Rne({theme:t,styles:n}){const o=tr(),r=Xh(),s=n.get(ri),a=n.get(Zd),i=n.get(rm);return s===void 0&&a===void 0?null:E.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[s===void 0?null:E.jsx(zu,{title:o("style-panel.font"),uiType:"font",style:ri,items:$s.font,value:s,onValueChange:r,theme:t}),a===void 0?null:E.jsxs("div",{className:"tlui-style-panel__row",children:[E.jsx(zu,{title:o("style-panel.align"),uiType:"align",style:Zd,items:$s.horizontalAlign,value:a,onValueChange:r,theme:t}),E.jsx("div",{className:"tlui-style-panel__row__extra-button",children:i===void 0?E.jsx(It,{type:"icon",title:o("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:E.jsx(Qt,{icon:"vertical-align-center"})}):E.jsx(oS,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:rm,items:$s.verticalAlign,value:i,onValueChange:r})})]})]})}function Dne({styles:t}){const n=Xh(),o=t.get(oi);return o===void 0?null:E.jsx(oS,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:oi,items:$s.geo,value:o,onValueChange:n})}function Fne({styles:t}){const n=Xh(),o=t.get(nm);return o===void 0?null:E.jsx(oS,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:nm,items:$s.spline,value:o,onValueChange:n})}function Nne({styles:t}){const n=Xh(),o=t.get(em),r=t.get(Jf);return!o||!r?null:E.jsx(Ine,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:Jf,itemsA:$s.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:em,itemsB:$s.arrowheadEnd,valueB:o,onValueChange:n,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}const Qh=[.1,.25,.5,.75,1];function Une(){const t=Be(),n=We("opacity",()=>t.getSharedOpacity(),[t]),o=mi(),r=tr(),s=Bt.useCallback((i,l)=>{const c=Qh[i];t.batch(()=>{t.isIn("select")&&t.setOpacityForSelectedShapes(c,{squashing:l}),t.setOpacityForNextShapes(c,{squashing:l}),t.updateInstanceState({isChangingStyle:!0},{ephemeral:!0})}),o("set-style",{source:"style-panel",id:"opacity",value:i})},[t,o]);if(n===void 0)return null;const a=n.type==="mixed"?-1:Qh.indexOf(GR(Qh,i=>Math.abs(i-n.value)));return E.jsx(Mne,{"data-testid":"style.opacity",value:a>=0?a:Qh.length-1,label:n.type==="mixed"?"style-panel.mixed":`opacity-style.${n.value}`,onValueChange:s,steps:Qh.length-1,title:r("style-panel.opacity")})}const Bne=z.memo(function({isMobile:t,children:n}){const o=Be(),r=fO(),s=z.useCallback(()=>{t||o.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},[o,t]),a=n??E.jsx(One,{styles:r});return E.jsx("div",{className:Pt("tlui-style-panel",{"tlui-style-panel__wrapper":!t}),"data-ismobile":t,onPointerLeave:s,children:a})});function zne(){var c;const t=Be(),n=tr(),o=(c=fO())==null?void 0:c.get(Jo),r=Bi({isDarkMode:t.user.getIsDarkMode()}),s=((o==null?void 0:o.type)==="shared"?r[o.value]:r.black).solid,a=We("disable style panel",()=>t.isInAny("hand","zoom","eraser","laser"),[t]),i=z.useCallback(u=>{u||t.updateInstanceState({isChangingStyle:!1},{ephemeral:!0})},[t]),{StylePanel:l}=il();return l?E.jsxs(Dw,{id:"mobile style menu",onOpenChange:i,children:[E.jsx(Fw,{children:E.jsx(It,{type:"tool","data-testid":"mobile-styles.button",style:{color:a?"var(--color-muted-1)":s},title:n("style-panel.title"),disabled:a,children:E.jsx(Qt,{icon:a?"blob":(o==null?void 0:o.type)==="mixed"?"mixed":"blob"})})}),E.jsx(Nw,{side:"top",align:"end",children:l&&E.jsx(l,{isMobile:!0})})]}):null}function Gne(){return E.jsxs(E.Fragment,{children:[E.jsx(Vne,{}),E.jsx(Hne,{}),E.jsx(Wne,{}),E.jsx($ne,{}),E.jsx(qne,{}),E.jsx(Yne,{}),E.jsx(Kne,{}),E.jsx(Xne,{}),E.jsx(Qne,{}),E.jsx(Zne,{}),E.jsx(Jne,{}),E.jsx(eoe,{}),E.jsx(toe,{}),E.jsx(roe,{}),E.jsx(noe,{}),E.jsx(ooe,{}),E.jsx(soe,{}),E.jsx(ioe,{}),E.jsx(aoe,{}),E.jsx(loe,{}),E.jsx(coe,{}),E.jsx(uoe,{}),E.jsx(doe,{}),E.jsx(hoe,{}),E.jsx(poe,{}),E.jsx(foe,{}),E.jsx(moe,{}),E.jsx(goe,{})]})}function pr(t){var r;const n=Be(),o=(r=t.meta)==null?void 0:r.geo;return We("is tool selected",()=>{const s=n.getCurrentToolId(),a=n.getSharedStyles().getAsKnownValue(oi);return o?s==="geo"&&a===o:s===t.id},[n,t.id,o])}function Vne(){const t=or(),n=pr(t.select);return E.jsx(Le,{...t.select,isSelected:n})}function Hne(){const t=or(),n=pr(t.hand);return E.jsx(Le,{...t.hand,isSelected:n})}function Wne(){const t=or(),n=pr(t.draw);return E.jsx(Le,{...t.draw,isSelected:n})}function $ne(){const t=or(),n=pr(t.eraser);return E.jsx(Le,{...t.eraser,isSelected:n})}function qne(){const t=or(),n=pr(t.arrow);return E.jsx(Le,{...t.arrow,isSelected:n})}function Yne(){const t=or(),n=pr(t.text);return E.jsx(Le,{...t.text,isSelected:n})}function Kne(){const t=or(),n=pr(t.note);return E.jsx(Le,{...t.note,isSelected:n})}function Xne(){const t=or(),n=pr(t.asset);return E.jsx(Le,{...t.asset,isSelected:n})}function Qne(){const t=or(),n=pr(t.rectangle);return E.jsx(Le,{...t.rectangle,isSelected:n})}function Zne(){const t=or(),n=pr(t.ellipse);return E.jsx(Le,{...t.ellipse,isSelected:n})}function Jne(){const t=or(),n=pr(t.diamond);return E.jsx(Le,{...t.diamond,isSelected:n})}function eoe(){const t=or(),n=pr(t.triangle);return E.jsx(Le,{...t.triangle,isSelected:n})}function toe(){const t=or(),n=pr(t.trapezoid);return E.jsx(Le,{...t.trapezoid,isSelected:n})}function roe(){const t=or(),n=pr(t.rhombus);return E.jsx(Le,{...t.rhombus,isSelected:n})}function noe(){const t=or(),n=pr(t.hexagon);return E.jsx(Le,{...t.hexagon,isSelected:n})}function ooe(){const t=or(),n=pr(t.cloud);return E.jsx(Le,{...t.cloud,isSelected:n})}function soe(){const t=or(),n=pr(t.star);return E.jsx(Le,{...t.star,isSelected:n})}function ioe(){const t=or(),n=pr(t.oval);return E.jsx(Le,{...t.oval,isSelected:n})}function aoe(){const t=or(),n=pr(t["x-box"]);return E.jsx(Le,{...t["x-box"],isSelected:n})}function loe(){const t=or(),n=pr(t["check-box"]);return E.jsx(Le,{...t["check-box"],isSelected:n})}function coe(){const t=or(),n=pr(t["arrow-left"]);return E.jsx(Le,{...t["arrow-left"],isSelected:n})}function uoe(){const t=or(),n=pr(t["arrow-up"]);return E.jsx(Le,{...t["arrow-up"],isSelected:n})}function doe(){const t=or(),n=pr(t["arrow-down"]);return E.jsx(Le,{...t["arrow-down"],isSelected:n})}function hoe(){const t=or(),n=pr(t["arrow-right"]);return E.jsx(Le,{...t["arrow-right"],isSelected:n})}function poe(){const t=or(),n=pr(t.line);return E.jsx(Le,{...t.line,isSelected:n})}function foe(){const t=or(),n=pr(t.highlight);return E.jsx(Le,{...t.highlight,isSelected:n})}function moe(){const t=or(),n=pr(t.frame);return E.jsx(Le,{...t.frame,isSelected:n})}function goe(){const t=or(),n=pr(t.laser);return E.jsx(Le,{...t.laser,isSelected:n})}const sS=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function iS(t,n,o,r){t.addEventListener?t.addEventListener(n,o,r):t.attachEvent&&t.attachEvent("on".concat(n),o)}function Zh(t,n,o,r){t.removeEventListener?t.removeEventListener(n,o,r):t.detachEvent&&t.detachEvent("on".concat(n),o)}function EO(t,n){const o=n.slice(0,n.length-1);for(let r=0;r<o.length;r++)o[r]=t[o[r].toLowerCase()];return o}function CO(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const n=t.split(",");let o=n.lastIndexOf("");for(;o>=0;)n[o-1]+=",",n.splice(o,1),o=n.lastIndexOf("");return n}function yoe(t,n){const o=t.length>=n.length?t:n,r=t.length>=n.length?n:t;let s=!0;for(let a=0;a<o.length;a++)r.indexOf(o[a])===-1&&(s=!1);return s}const Jh={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":sS?173:189,"=":sS?61:187,";":sS?59:186,"'":222,"[":219,"]":221,"\\":220},bi={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},aS={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Dn={16:!1,18:!1,17:!1,91:!1},Hr={};for(let t=1;t<20;t++)Jh["f".concat(t)]=111+t;let _r=[],ep=null,PO="all";const sa=new Map,tp=t=>Jh[t.toLowerCase()]||bi[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),voe=t=>Object.keys(Jh).find(n=>Jh[n]===t),boe=t=>Object.keys(bi).find(n=>bi[n]===t);function MO(t){PO=t||"all"}function rp(){return PO||"all"}function xoe(){return _r.slice(0)}function woe(){return _r.map(t=>voe(t)||boe(t)||String.fromCharCode(t))}function Soe(){const t=[];return Object.keys(Hr).forEach(n=>{Hr[n].forEach(o=>{let{key:r,scope:s,mods:a,shortcut:i}=o;t.push({scope:s,shortcut:i,mods:a,keys:r.split("+").map(l=>tp(l))})})}),t}function joe(t){const n=t.target||t.srcElement,{tagName:o}=n;let r=!0;const s=o==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(n.type);return(n.isContentEditable||(s||o==="TEXTAREA"||o==="SELECT")&&!n.readOnly)&&(r=!1),r}function _oe(t){return typeof t=="string"&&(t=tp(t)),_r.indexOf(t)!==-1}function koe(t,n){let o,r;t||(t=rp());for(const s in Hr)if(Object.prototype.hasOwnProperty.call(Hr,s))for(o=Hr[s],r=0;r<o.length;)o[r].scope===t?o.splice(r,1).forEach(a=>{let{element:i}=a;return lS(i)}):r++;rp()===t&&MO(n||"all")}function Eoe(t){let n=t.keyCode||t.which||t.charCode;const o=_r.indexOf(n);if(o>=0&&_r.splice(o,1),t.key&&t.key.toLowerCase()==="meta"&&_r.splice(0,_r.length),(n===93||n===224)&&(n=91),n in Dn){Dn[n]=!1;for(const r in bi)bi[r]===n&&(Fo[r]=!1)}}function TO(t){if(typeof t>"u")Object.keys(Hr).forEach(s=>{Array.isArray(Hr[s])&&Hr[s].forEach(a=>Ly(a)),delete Hr[s]}),lS(null);else if(Array.isArray(t))t.forEach(s=>{s.key&&Ly(s)});else if(typeof t=="object")t.key&&Ly(t);else if(typeof t=="string"){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];let[s,a]=o;typeof s=="function"&&(a=s,s=""),Ly({key:t,scope:s,method:a,splitKey:"+"})}}const Ly=t=>{let{key:n,scope:o,method:r,splitKey:s="+"}=t;CO(n).forEach(a=>{const i=a.split(s),l=i.length,c=i[l-1],u=c==="*"?"*":tp(c);if(!Hr[u])return;o||(o=rp());const f=l>1?EO(bi,i):[],h=[];Hr[u]=Hr[u].filter(d=>{const p=(r?d.method===r:!0)&&d.scope===o&&yoe(d.mods,f);return p&&h.push(d.element),!p}),h.forEach(d=>lS(d))})};function IO(t,n,o,r){if(n.element!==r)return;let s;if(n.scope===o||n.scope==="all"){s=n.mods.length>0;for(const a in Dn)Object.prototype.hasOwnProperty.call(Dn,a)&&(!Dn[a]&&n.mods.indexOf(+a)>-1||Dn[a]&&n.mods.indexOf(+a)===-1)&&(s=!1);(n.mods.length===0&&!Dn[16]&&!Dn[18]&&!Dn[17]&&!Dn[91]||s||n.shortcut==="*")&&(n.keys=[],n.keys=n.keys.concat(_r),n.method(t,n)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function AO(t,n){const o=Hr["*"];let r=t.keyCode||t.which||t.charCode;if(!Fo.filter.call(this,t))return;if((r===93||r===224)&&(r=91),_r.indexOf(r)===-1&&r!==229&&_r.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(l=>{const c=aS[l];t[l]&&_r.indexOf(c)===-1?_r.push(c):!t[l]&&_r.indexOf(c)>-1?_r.splice(_r.indexOf(c),1):l==="metaKey"&&t[l]&&_r.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(_r=_r.slice(_r.indexOf(c))))}),r in Dn){Dn[r]=!0;for(const l in bi)bi[l]===r&&(Fo[l]=!0);if(!o)return}for(const l in Dn)Object.prototype.hasOwnProperty.call(Dn,l)&&(Dn[l]=t[aS[l]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(_r.indexOf(17)===-1&&_r.push(17),_r.indexOf(18)===-1&&_r.push(18),Dn[17]=!0,Dn[18]=!0);const s=rp();if(o)for(let l=0;l<o.length;l++)o[l].scope===s&&(t.type==="keydown"&&o[l].keydown||t.type==="keyup"&&o[l].keyup)&&IO(t,o[l],s,n);if(!(r in Hr))return;const a=Hr[r],i=a.length;for(let l=0;l<i;l++)if((t.type==="keydown"&&a[l].keydown||t.type==="keyup"&&a[l].keyup)&&a[l].key){const c=a[l],{splitKey:u}=c,f=c.key.split(u),h=[];for(let d=0;d<f.length;d++)h.push(tp(f[d]));h.sort().join("")===_r.sort().join("")&&IO(t,c,s,n)}}function Fo(t,n,o){_r=[];const r=CO(t);let s=[],a="all",i=document,l=0,c=!1,u=!0,f="+",h=!1,d=!1;for(o===void 0&&typeof n=="function"&&(o=n),Object.prototype.toString.call(n)==="[object Object]"&&(n.scope&&(a=n.scope),n.element&&(i=n.element),n.keyup&&(c=n.keyup),n.keydown!==void 0&&(u=n.keydown),n.capture!==void 0&&(h=n.capture),typeof n.splitKey=="string"&&(f=n.splitKey),n.single===!0&&(d=!0)),typeof n=="string"&&(a=n),d&&TO(t,a);l<r.length;l++)t=r[l].split(f),s=[],t.length>1&&(s=EO(bi,t)),t=t[t.length-1],t=t==="*"?"*":tp(t),t in Hr||(Hr[t]=[]),Hr[t].push({keyup:c,keydown:u,scope:a,mods:s,shortcut:r[l],method:o,key:r[l],splitKey:f,element:i});if(typeof i<"u"&&window){if(!sa.has(i)){const p=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return AO(g,i)},y=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;AO(g,i),Eoe(g)};sa.set(i,{keydownListener:p,keyupListenr:y,capture:h}),iS(i,"keydown",p,h),iS(i,"keyup",y,h)}if(!ep){const p=()=>{_r=[]};ep={listener:p,capture:h},iS(window,"focus",p,h)}}}function Coe(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(Hr).forEach(o=>{Hr[o].filter(r=>r.scope===n&&r.shortcut===t).forEach(r=>{r&&r.method&&r.method()})})}function lS(t){const n=Object.values(Hr).flat();if(n.findIndex(o=>{let{element:r}=o;return r===t})<0){const{keydownListener:o,keyupListenr:r,capture:s}=sa.get(t)||{};o&&r&&(Zh(t,"keyup",r,s),Zh(t,"keydown",o,s),sa.delete(t))}if((n.length<=0||sa.size<=0)&&(Object.keys(sa).forEach(o=>{const{keydownListener:r,keyupListenr:s,capture:a}=sa.get(o)||{};r&&s&&(Zh(o,"keyup",s,a),Zh(o,"keydown",r,a),sa.delete(o))}),sa.clear(),Object.keys(Hr).forEach(o=>delete Hr[o]),ep)){const{listener:o,capture:r}=ep;Zh(window,"focus",o,r),ep=null}}const cS={getPressedKeyString:woe,setScope:MO,getScope:rp,deleteScope:koe,getPressedKeyCodes:xoe,getAllKeyCodes:Soe,isPressed:_oe,filter:joe,trigger:Coe,unbind:TO,keyMap:Jh,modifier:bi,modifierMap:aS};for(const t in cS)Object.prototype.hasOwnProperty.call(cS,t)&&(Fo[t]=cS[t]);if(typeof window<"u"){const t=window.hotkeys;Fo.noConflict=n=>(n&&window.hotkeys===Fo&&(window.hotkeys=t),Fo),window.hotkeys=Fo}const OO=["copy","cut","paste","asset"];function Poe(){const t=Be(),n=Ki(),o=_t(),r=or(),s=We("is focused",()=>t.getInstanceState().isFocused,[t]);z.useEffect(()=>{if(!s)return;const a=t.getContainer();Fo.setScope(t.store.id);const i=(c,u)=>{Fo(c,{element:document.body,scope:t.store.id},u)},l=(c,u)=>{Fo(c,{element:document.body,keyup:!0,keydown:!1,scope:t.store.id},u)};for(const c of Object.values(o))c.kbd&&(n&&!c.readonlyOk||OO.includes(c.id)||i(LO(c.kbd),u=>{np(t)||(Xt(u),c.onSelect("kbd"))}));for(const c of Object.values(r))!c.kbd||!c.readonlyOk&&t.getInstanceState().isReadonly||OO.includes(c.id)||i(LO(c.kbd),u=>{np(t)||(Xt(u),c.onSelect("kbd"))});return i(",",c=>{if(np(t)||t.inputs.keys.has("Comma"))return;Xt(c),a.focus(),t.inputs.keys.add("Comma");const{x:u,y:f,z:h}=t.inputs.currentScreenPoint,d={type:"pointer",name:"pointer_down",point:{x:u,y:f,z:h},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(d)}),l(",",c=>{if(np(t)||!t.inputs.keys.has("Comma"))return;t.inputs.keys.delete("Comma");const{x:u,y:f,z:h}=t.inputs.currentScreenPoint,d={type:"pointer",name:"pointer_up",point:{x:u,y:f,z:h},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(d)}),()=>{Fo.deleteScope(t.store.id)}},[o,r,n,t,s])}function LO(t){return Moe(t).map(n=>{let o="";const r=n.split("");return r.length===1?o=r[0]:r[0]==="!"?o=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?o=`alt+shift+${r[2]}`:o=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?o=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?o=`cmd+\u2325+${r[2]},ctrl+alt+${r[2]}`:o=`cmd+${r[1]},ctrl+${r[1]}`:o=n,o}).join(",")}function Moe(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const n=t.split(",");let o=n.lastIndexOf("");for(;o>=0;)n[o-1]+=",",n.splice(o,1),o=n.lastIndexOf("");return n}function np(t){return t.getIsMenuOpen()||t.getEditingShapeId()!==null||t.getCrashingError()}const Toe=z.createContext(!1);function Ioe({children:t}){const n=Be(),o=Mz(),r=Do(),s=tr(),a=Math.min(8,5+r),[i,l]=z.useState(0),c=z.useRef(null),[u,f]=z.useState(null),h=z.useMemo(()=>{const p=[],y=[];u?p.push(`[data-value="${u}"]`):p.push(`:nth-child(${a+1})`);for(let g=0;g<a;g++)p.push(`:nth-child(${g+1})`),y.push(`:nth-child(${g+1})`);return`
			#${o}_main > *:not(${p.join(", ")}) {
				display: none;
			}
			${y.map(g=>`#${o}_more > *${g}`).join(", ")} {
				display: none;
			}
        `},[u,o,a]),d=d1(()=>{if(!c.current)return;const p=Array.from(c.current.children);l(p.length),p.findIndex(g=>g.getAttribute("data-value")===u)<=a&&f(null);const y=Array.from(c.current.children).findIndex(g=>g.getAttribute("aria-checked")==="true");y!==-1&&y>=a&&f(p[y].getAttribute("data-value"))});return z.useLayoutEffect(()=>{d()}),z.useLayoutEffect(()=>{if(!c.current)return;const p=new MutationObserver(d);return p.observe(c.current,{childList:!0,subtree:!0,attributeFilter:["data-value","aria-checked"]}),()=>{p.disconnect()}},[d]),z.useEffect(()=>{const p=[["1",0],["2",1],["3",2],["4",3],["5",4],["6",5],["7",6],["8",7],["9",8],["0",9]];for(const[y,g]of p)Fo(y,b=>{var v;if(np(n))return;Xt(b);const m=Array.from(((v=c.current)==null?void 0:v.children)??[]).filter(x=>!(x instanceof HTMLElement)||x.tagName.toLowerCase()!=="button"?!1:!!(x.offsetWidth||x.offsetHeight))[g];m&&m.click()});return()=>{Fo.unbind("1,2,3,4,5,6,7,8,9,0")}},[n]),E.jsxs(E.Fragment,{children:[E.jsx("style",{children:h}),E.jsxs("div",{className:Pt("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<Xr.TABLET_SM}),role:"radiogroup",children:[E.jsx("div",{id:`${o}_main`,ref:c,className:"tlui-toolbar__tools__list",children:E.jsx(xs,{type:"toolbar",sourceId:"toolbar",children:t})}),i>a&&E.jsx(Toe.Provider,{value:!0,children:E.jsxs(rc,{id:"toolbar overflow",modal:!1,children:[E.jsx(nc,{children:E.jsx(It,{title:s("tool-panel.more"),type:"tool",className:"tlui-toolbar__overflow","data-testid":"tools.more-button",children:E.jsx(Qt,{icon:"chevron-up"})})}),E.jsx(oc,{side:"top",align:"center",children:E.jsx("div",{className:"tlui-buttons__grid","data-testid":"tools.more-content",id:`${o}_more`,children:E.jsx(xs,{type:"toolbar-overflow",sourceId:"toolbar",children:t})})})]})})]})]})}const Aoe=["select","hand","draw","eraser","text","zoom","laser","highlight"];function Ooe({activeToolId:t}){const n=Be(),o=Do(),r=tr(),s=We("is tool locked",()=>n.getInstanceState().isToolLocked,[n]);return!t||Aoe.includes(t)?null:E.jsx(It,{type:"normal",title:r("action.toggle-tool-lock"),"data-testid":"tool-lock",className:Pt("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":o<Xr.TABLET_SM}),onClick:()=>n.updateInstanceState({isToolLocked:!s}),children:E.jsx(Qt,{icon:s?"lock":"unlock",small:!0})})}const Loe=z.memo(function({children:t}){const n=Be(),o=Do(),r=Ki(),s=We("current tool id",()=>n.getCurrentToolId(),[n]),{ActionsMenu:a,QuickActions:i}=il();return E.jsx("div",{className:"tlui-toolbar",children:E.jsxs("div",{className:"tlui-toolbar__inner",children:[E.jsxs("div",{className:"tlui-toolbar__left",children:[!r&&E.jsxs("div",{className:"tlui-toolbar__extras",children:[o<Xr.TABLET&&E.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[i&&E.jsx(i,{}),a&&E.jsx(a,{})]}),E.jsx(Ooe,{activeToolId:s})]}),E.jsx(Ioe,{children:t??E.jsx(Gne,{})})]}),o<Xr.TABLET_SM&&!r&&E.jsx("div",{className:"tlui-toolbar__tools",children:E.jsx(zne,{})})]})})});function Roe(){const t=_t();return E.jsxs(E.Fragment,{children:[E.jsx(Le,{...t["zoom-in"],noClose:!0}),E.jsx(Le,{...t["zoom-out"],noClose:!0}),E.jsx(eO,{}),E.jsx(tO,{}),E.jsx(rO,{})]})}const Doe=z.memo(function({children:t}){const n=Qn(),[o,r]=nl("zoom menu"),s=t??E.jsx(Roe,{});return E.jsxs(Kw,{dir:"ltr",open:o,onOpenChange:r,modal:!1,children:[E.jsx(Xw,{asChild:!0,dir:"ltr",children:E.jsx(Foe,{})}),E.jsx(Ty,{container:n,children:E.jsx(Qw,{className:"tlui-menu",side:"top",align:"start",alignOffset:0,sideOffset:8,collisionPadding:4,children:E.jsx(xs,{type:"menu",sourceId:"zoom-menu",children:s})})})]})}),Foe=z.forwardRef(function(t,n){const o=Be(),r=Do(),s=We("zoom",()=>o.getZoomLevel(),[o]),a=tr(),i=z.useCallback(()=>{o.resetZoom(o.getViewportScreenCenter(),{duration:si})},[o]);return E.jsx(It,{ref:n,...t,type:"icon",title:`${a("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu-button",className:r<Xr.TABLET_SM?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:i,icon:r<Xr.MOBILE?"zoom-in":void 0,children:r<Xr.MOBILE?null:E.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(s*100),"%"]})})}),RO=z.createContext({});function Noe({overrides:t={},children:n}){const o=Qb(t);return E.jsx(RO.Provider,{value:z.useMemo(()=>({ContextMenu:pre,ActionsMenu:Vte,HelpMenu:Ere,ZoomMenu:Doe,MainMenu:Vre,Minimap:Kre,StylePanel:Bne,PageMenu:Jre,NavigationPanel:Qre,Toolbar:Loe,KeyboardShortcutsDialog:Ore,QuickActions:tne,HelperButtons:Ire,DebugPanel:xre,DebugMenu:bre,MenuPanel:Hre,...o}),[o]),children:n})}function il(){return z.useContext(RO)}function Uoe({overrides:t,components:n,assetUrls:o,onUiEvent:r,forceMobile:s,children:a}){return E.jsx(aK,{assetUrls:YQ(o),children:E.jsx(uK,{overrides:JQ(t),children:E.jsx(LQ,{onEvent:r,children:E.jsx(zQ,{children:E.jsx(RQ,{children:E.jsx(XQ,{forceMobile:s,children:E.jsx(Noe,{overrides:n,children:E.jsx(Boe,{overrides:t,children:a})})})})})})})})}function Boe({overrides:t,children:n}){const o=eZ(t);return E.jsx(RZ,{overrides:o.actions,children:E.jsx(KQ,{overrides:o.tools,children:n})})}function zoe(){const t=Be(),{addToast:n}=Hs();z.useEffect(()=>{function o({name:r,count:s}){n({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${s}). Please delete some shapes or move to a different page to continue.`,severity:"warning"})}return t.addListener("max-shapes",o),()=>{t.removeListener("max-shapes",o)}},[t,n])}const Goe=Bt.memo(function({renderDebugMenuItems:t,children:n,hideUi:o,components:r,...s}){return E.jsx(Uoe,{...s,components:r,children:E.jsx(Voe,{hideUi:o,renderDebugMenuItems:t,children:n})})}),Voe=Bt.memo(function({children:t,hideUi:n,...o}){return E.jsxs(E.Fragment,{children:[t,n?null:E.jsx(Hoe,{...o})]})}),Hoe=Bt.memo(function(){const t=Be(),n=tr(),o=Do(),r=Ki(),s=We("focus",()=>t.getInstanceState().isFocusMode,[t]),a=We("debug",()=>t.getInstanceState().isDebugMode,[t]),{SharePanel:i,TopPanel:l,MenuPanel:c,StylePanel:u,Toolbar:f,HelpMenu:h,NavigationPanel:d,HelperButtons:p,DebugPanel:y}=il();Poe(),_Z(),zoe();const{"toggle-focus-mode":g}=_t();return E.jsx(I3,{children:E.jsxs("div",{className:Pt("tlui-layout",{"tlui-layout__mobile":o<Xr.TABLET_SM}),"data-breakpoint":o,children:[s?E.jsx("div",{className:"tlui-layout__top",children:E.jsx(It,{type:"icon",className:"tlui-focus-button",title:n("focus-mode.toggle-focus-mode"),onClick:()=>g.onSelect("menu"),children:E.jsx(Qt,{icon:"dot"})})}):E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"tlui-layout__top",children:[E.jsxs("div",{className:"tlui-layout__top__left",children:[c&&E.jsx(c,{}),p&&E.jsx(p,{})]}),E.jsx("div",{className:"tlui-layout__top__center",children:l&&E.jsx(l,{})}),E.jsxs("div",{className:"tlui-layout__top__right",children:[i&&E.jsx(i,{}),u&&o>=Xr.TABLET_SM&&!r&&E.jsx(u,{})]})]}),E.jsxs("div",{className:"tlui-layout__bottom",children:[E.jsxs("div",{className:"tlui-layout__bottom__main",children:[d&&E.jsx(d,{}),f&&E.jsx(f,{}),h&&E.jsx(h,{})]}),a&&y&&E.jsx(y,{})]})]}),E.jsx(WQ,{}),E.jsx(NQ,{}),E.jsx($Q,{}),E.jsx(UQ,{})]})})}),Ry=(t,n)=>{const[o,r]=z.useState(2);return z.useEffect(()=>{let s=!1;return r(2),jR(t,n).then(()=>{s||r(0)}).catch(a=>{s||(console.error(a),r(1))}),()=>{s=!0}},[t,n]),o};function Woe(t){return{draw:{url:t.fonts.draw,format:t.fonts.draw.split(".").pop()},serif:{url:t.fonts.serif,format:t.fonts.serif.split(".").pop()},sansSerif:{url:t.fonts.sansSerif,format:t.fonts.sansSerif.split(".").pop()},monospace:{url:t.fonts.monospace,format:t.fonts.monospace.split(".").pop()}}}function DO(t){const n=z.useMemo(()=>Woe(t),[t]),o=[Ry("tldraw_draw",n.draw),Ry("tldraw_serif",n.serif),Ry("tldraw_sans",n.sansSerif),Ry("tldraw_mono",n.monospace)];return{error:o.some(r=>r===1),done:!o.some(r=>r===2)}}function $oe(t){const{children:n,maxImageDimension:o,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:a,onMount:i,components:l={},shapeUtils:c=[],tools:u=[],...f}=t,h=Qb(l),d=z.useMemo(()=>({Scribble:AT,CollaboratorScribble:AT,SelectionForeground:B$,SelectionBackground:N$,Handles:O$,...h}),[h]),p=Xb(c),y=z.useMemo(()=>[...WI,...p],[p]),g=Xb(u),b=z.useMemo(()=>[...RK,...Fq,...g],[g]),m=yA(f.assetUrls),{done:v,error:x}=DO(m);return x?E.jsx(LP,{children:"Could not load assets. Please refresh the page."}):v?E.jsx(Sz,{initialState:"select",...f,components:d,shapeUtils:y,tools:b,children:E.jsxs(Goe,{...f,components:d,children:[E.jsx(Koe,{maxImageDimension:o,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:a,onMount:i}),n]})}):E.jsx(OP,{children:"Loading assets..."})}const qoe=Object.freeze(["image/jpeg","image/png","image/gif","image/svg+xml"]),Yoe=Object.freeze(["video/mp4","video/quicktime"]);function Koe({maxImageDimension:t=1e3,maxAssetSize:n=10*1024*1024,acceptedImageMimeTypes:o=qoe,acceptedVideoMimeTypes:r=Yoe,onMount:s}){const a=Be(),i=Hs(),l=tr(),c=d1(h=>{const d=[];return d.push(...bK(h)),xq(h,{maxImageDimension:t,maxAssetSize:n,acceptedImageMimeTypes:o,acceptedVideoMimeTypes:r},{toasts:i,msg:l}),d.push(s==null?void 0:s(h)),()=>{d.forEach(p=>p==null?void 0:p())}});z.useLayoutEffect(()=>{if(a)return c==null?void 0:c(a)},[a,c]);const{Canvas:u}=Vr(),{ContextMenu:f}=il();return f?E.jsx(f,{}):u?E.jsx(u,{}):null}z.memo(function(t){const[n,o]=z.useState(null),[r,s]=z.useState(null),a=Xb(t.shapeUtils??[]),i=z.useMemo(()=>[...WI,...a],[a]),l=MP({snapshot:t.snapshot,shapeUtils:i}),c=yA(),{done:u,error:f}=DO(c),{pageId:h,bounds:d,scale:p,background:y,padding:g,darkMode:b,preserveAspectRatio:m,format:v="svg"}=t;return z.useLayoutEffect(()=>{if(!r||!l||!u)return;let x=!1;const w=document.createElement("div");r.appendChild(w),r.classList.add("tl-container","tl-theme__light");const S=new pt({store:l,shapeUtils:i??[],tools:[],getContainer:()=>w});h&&S.setCurrentPage(h);const k=S.getCurrentPageShapeIds();async function _(){const C=await S.getSvgString([...k],{bounds:d,scale:p,background:y,padding:g,darkMode:b,preserveAspectRatio:m});if(C&&!x){if(v==="svg"){if(!x){const P=new Blob([C.svg],{type:"image/svg+xml"}),A=URL.createObjectURL(P);o(A)}}else if(v==="png"){const P=await TA(C.svg,S.environment.isSafari,{type:v,quality:1,scale:2,width:C.width,height:C.height});if(P&&!x){const A=URL.createObjectURL(P);o(A)}}}S.dispose()}return _(),()=>{x=!0}},[v,r,l,i,h,d,p,y,g,b,m,u,f]),f?E.jsx(LP,{children:"Could not load assets."}):u?E.jsx("div",{ref:s,style:{position:"relative",width:"100%",height:"100%"},children:n&&E.jsx("img",{src:n,style:{width:"100%",height:"100%"}})}):E.jsx(OP,{children:"Loading assets..."})});const Xoe=Gt({schemaVersion:qn(1),storeVersion:$f,recordVersions:qf(Dt,Gt({version:$f,subTypeVersions:qf(Dt,$f).optional(),subTypeKey:Dt.optional()}))}),Qoe=Gt({schemaVersion:qn(2),sequences:qf(Dt,$f)});Gt({tldrawFileFormatVersion:xD,schema:wD("schemaVersion",{1:Xoe,2:Qoe}),records:In(Gt({id:Dt,typeName:Dt}).allowUnknownProperties())});function Dy(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var FO={exports:{}};/*! p5.js v1.9.1 February 29, 2024 */(function(t,n){(function(o){t.exports=o()})(function(){var o;return function r(s,a,i){function l(f,h){if(!a[f]){if(!s[f]){var d=typeof Dy=="function"&&Dy;if(!h&&d)return d(f,!0);if(c)return c(f,!0);throw(h=new Error("Cannot find module '"+f+"'")).code="MODULE_NOT_FOUND",h}d=a[f]={exports:{}},s[f][0].call(d.exports,function(p){return l(s[f][1][p]||p)},d,d.exports,r,s,a,i)}return a[f].exports}for(var c=typeof Dy=="function"&&Dy,u=0;u<i.length;u++)l(i[u]);return l}({1:[function(r,s,a){a.byteLength=function(g){var g=d(g),y=g[0],g=g[1];return 3*(y+g)/4-g},a.toByteArray=function(p){var y,g,m=d(p),b=m[0],m=m[1],v=new c(function(S,k){return 3*(S+k)/4-k}(b,m)),x=0,w=0<m?b-4:b;for(g=0;g<w;g+=4)y=l[p.charCodeAt(g)]<<18|l[p.charCodeAt(g+1)]<<12|l[p.charCodeAt(g+2)]<<6|l[p.charCodeAt(g+3)],v[x++]=y>>16&255,v[x++]=y>>8&255,v[x++]=255&y;return m===2&&(y=l[p.charCodeAt(g)]<<2|l[p.charCodeAt(g+1)]>>4,v[x++]=255&y),m===1&&(y=l[p.charCodeAt(g)]<<10|l[p.charCodeAt(g+1)]<<4|l[p.charCodeAt(g+2)]>>2,v[x++]=y>>8&255,v[x++]=255&y),v},a.fromByteArray=function(p){for(var y,g=p.length,b=g%3,m=[],v=0,x=g-b;v<x;v+=16383)m.push(function(w,S,k){for(var _,C=[],P=S;P<k;P+=3)_=(w[P]<<16&16711680)+(w[P+1]<<8&65280)+(255&w[P+2]),C.push(function(A){return i[A>>18&63]+i[A>>12&63]+i[A>>6&63]+i[63&A]}(_));return C.join("")}(p,v,x<v+16383?x:v+16383));return b==1?(y=p[g-1],m.push(i[y>>2]+i[y<<4&63]+"==")):b==2&&(y=(p[g-2]<<8)+p[g-1],m.push(i[y>>10]+i[y>>4&63]+i[y<<2&63]+"=")),m.join("")};for(var i=[],l=[],c=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,h=u.length;f<h;++f)i[f]=u[f],l[u.charCodeAt(f)]=f;function d(p){var y=p.length;if(0<y%4)throw new Error("Invalid string. Length must be a multiple of 4");return p=p.indexOf("="),y=(p=p===-1?y:p)===y?0:4-p%4,[p,y]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},{}],2:[function(r,s,a){},{}],3:[function(r,s,a){},{}],4:[function(r,s,a){(function(d){var l=r("base64-js"),c=r("ieee754"),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,f=(a.Buffer=d,a.SlowBuffer=function(T){return+T!=T&&(T=0),d.alloc(+T)},a.INSPECT_MAX_BYTES=50,2147483647);function h(T){if(f<T)throw new RangeError('The value "'+T+'" is invalid for option "size"');return T=new Uint8Array(T),Object.setPrototypeOf(T,d.prototype),T}function d(T,B,W){if(typeof T!="number")return p(T,B,W);if(typeof B=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(T)}function p(T,B,W){if(typeof T=="string"){var K=T,te=B;if(d.isEncoding(te=typeof te=="string"&&te!==""?te:"utf8"))return ne=0|v(K,te),ce=h(ne),ce=(K=ce.write(K,te))!==ne?ce.slice(0,K):ce;throw new TypeError("Unknown encoding: "+te)}if(ArrayBuffer.isView(T))return b(T);if(T!=null){if(Q(T,ArrayBuffer)||T&&Q(T.buffer,ArrayBuffer)){var ne=T,K=B,ce=W;if(K<0||ne.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(ne.byteLength<K+(ce||0))throw new RangeError('"length" is outside of buffer bounds');return ne=K===void 0&&ce===void 0?new Uint8Array(ne):ce===void 0?new Uint8Array(ne,K):new Uint8Array(ne,K,ce),Object.setPrototypeOf(ne,d.prototype),ne}if(typeof T=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');if(te=T.valueOf&&T.valueOf(),te!=null&&te!==T)return d.from(te,B,W);var fe=function(ue){{var ge,me;if(d.isBuffer(ue))return ge=0|m(ue.length),(me=h(ge)).length!==0&&ue.copy(me,0,0,ge),me}if(ue.length!==void 0)return typeof ue.length!="number"||J(ue.length)?h(0):b(ue);if(ue.type==="Buffer"&&Array.isArray(ue.data))return b(ue.data)}(T);if(fe)return fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof T[Symbol.toPrimitive]=="function")return d.from(T[Symbol.toPrimitive]("string"),B,W)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof T)}function y(T){if(typeof T!="number")throw new TypeError('"size" argument must be of type number');if(T<0)throw new RangeError('The value "'+T+'" is invalid for option "size"')}function g(T){return y(T),h(T<0?0:0|m(T))}function b(T){for(var B=T.length<0?0:0|m(T.length),W=h(B),K=0;K<B;K+=1)W[K]=255&T[K];return W}function m(T){if(f<=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return 0|T}function v(T,B){if(d.isBuffer(T))return T.length;if(ArrayBuffer.isView(T)||Q(T,ArrayBuffer))return T.byteLength;if(typeof T!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof T);var W=T.length,K=2<arguments.length&&arguments[2]===!0;if(!K&&W===0)return 0;for(var te=!1;;)switch(B){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return Y(T).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*W;case"hex":return W>>>1;case"base64":return $(T).length;default:if(te)return K?-1:Y(T).length;B=(""+B).toLowerCase(),te=!0}}function x(T,B,W){var K,te=!1;if((B=B===void 0||B<0?0:B)>this.length||(W=W===void 0||W>this.length?this.length:W)<=0||(W>>>=0)<=(B>>>=0))return"";for(T=T||"utf8";;)switch(T){case"hex":var ne=this,we=B,ce=W,me=ne.length;(!ce||ce<0||me<ce)&&(ce=me);for(var fe="",ue=we=!we||we<0?0:we;ue<ce;++ue)fe+=ae[ne[ue]];return fe;case"utf8":case"utf-8":return P(this,B,W);case"ascii":var ge=this,me=B,oe=W,de="";oe=Math.min(ge.length,oe);for(var xe=me;xe<oe;++xe)de+=String.fromCharCode(127&ge[xe]);return de;case"latin1":case"binary":var Ie=this,we=B,_e=W,Ae="";_e=Math.min(Ie.length,_e);for(var $e=we;$e<_e;++$e)Ae+=String.fromCharCode(Ie[$e]);return Ae;case"base64":return Fe=this,K=W,(ut=B)===0&&K===Fe.length?l.fromByteArray(Fe):l.fromByteArray(Fe.slice(ut,K));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var Fe=B,ut=W,tt=this.slice(Fe,ut),rt="",it=0;it<tt.length;it+=2)rt+=String.fromCharCode(tt[it]+256*tt[it+1]);return rt;default:if(te)throw new TypeError("Unknown encoding: "+T);T=(T+"").toLowerCase(),te=!0}}function w(T,B,W){var K=T[B];T[B]=T[W],T[W]=K}function S(T,B,W,K,te){if(T.length===0)return-1;if(typeof W=="string"?(K=W,W=0):2147483647<W?W=2147483647:W<-2147483648&&(W=-2147483648),(W=(W=J(W=+W)?te?0:T.length-1:W)<0?T.length+W:W)>=T.length){if(te)return-1;W=T.length-1}else if(W<0){if(!te)return-1;W=0}if(typeof B=="string"&&(B=d.from(B,K)),d.isBuffer(B))return B.length===0?-1:k(T,B,W,K,te);if(typeof B=="number")return B&=255,typeof Uint8Array.prototype.indexOf=="function"?(te?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(T,B,W):k(T,[B],W,K,te);throw new TypeError("val must be string, number or Buffer")}function k(T,B,W,K,te){var ne=1,ce=T.length,fe=B.length;if(K!==void 0&&((K=String(K).toLowerCase())==="ucs2"||K==="ucs-2"||K==="utf16le"||K==="utf-16le")){if(T.length<2||B.length<2)return-1;ce/=ne=2,fe/=2,W/=2}function ue(xe,Ie){return ne===1?xe[Ie]:xe.readUInt16BE(Ie*ne)}if(te)for(var ge=-1,me=W;me<ce;me++)if(ue(T,me)===ue(B,ge===-1?0:me-ge)){if(me-(ge=ge===-1?me:ge)+1===fe)return ge*ne}else ge!==-1&&(me-=me-ge),ge=-1;else for(me=W=ce<W+fe?ce-fe:W;0<=me;me--){for(var oe=!0,de=0;de<fe;de++)if(ue(T,me+de)!==ue(B,de)){oe=!1;break}if(oe)return me}return-1}function _(T,B,W,K){return H(function(te){for(var ne=[],ce=0;ce<te.length;++ce)ne.push(255&te.charCodeAt(ce));return ne}(B),T,W,K)}function C(T,B,W,K){return H(function(te,ne){for(var ce,fe,ue=[],ge=0;ge<te.length&&!((ne-=2)<0);++ge)fe=te.charCodeAt(ge),ce=fe>>8,fe=fe%256,ue.push(fe),ue.push(ce);return ue}(B,T.length-W),T,W,K)}function P(T,B,W){W=Math.min(T.length,W);for(var K=[],te=B;te<W;){var ne,ce,fe,ue,ge=T[te],me=null,oe=239<ge?4:223<ge?3:191<ge?2:1;if(te+oe<=W)switch(oe){case 1:ge<128&&(me=ge);break;case 2:(192&(ne=T[te+1]))==128&&127<(ue=(31&ge)<<6|63&ne)&&(me=ue);break;case 3:ne=T[te+1],ce=T[te+2],(192&ne)==128&&(192&ce)==128&&2047<(ue=(15&ge)<<12|(63&ne)<<6|63&ce)&&(ue<55296||57343<ue)&&(me=ue);break;case 4:ne=T[te+1],ce=T[te+2],fe=T[te+3],(192&ne)==128&&(192&ce)==128&&(192&fe)==128&&65535<(ue=(15&ge)<<18|(63&ne)<<12|(63&ce)<<6|63&fe)&&ue<1114112&&(me=ue)}me===null?(me=65533,oe=1):65535<me&&(me-=65536,K.push(me>>>10&1023|55296),me=56320|1023&me),K.push(me),te+=oe}var de=K,xe=de.length;if(xe<=A)return String.fromCharCode.apply(String,de);for(var Ie="",we=0;we<xe;)Ie+=String.fromCharCode.apply(String,de.slice(we,we+=A));return Ie}a.kMaxLength=f,(d.TYPED_ARRAY_SUPPORT=function(){try{var T=new Uint8Array(1),B={foo:function(){return 42}};return Object.setPrototypeOf(B,Uint8Array.prototype),Object.setPrototypeOf(T,B),T.foo()===42}catch{return!1}}())||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),d.poolSize=8192,d.from=p,Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(T,B,W){return B=B,W=W,y(T=T),!(T<=0)&&B!==void 0?typeof W=="string"?h(T).fill(B,W):h(T).fill(B):h(T)},d.allocUnsafe=g,d.allocUnsafeSlow=g,d.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==d.prototype},d.compare=function(T,B){if(Q(T,Uint8Array)&&(T=d.from(T,T.offset,T.byteLength)),Q(B,Uint8Array)&&(B=d.from(B,B.offset,B.byteLength)),!d.isBuffer(T)||!d.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===B)return 0;for(var W=T.length,K=B.length,te=0,ne=Math.min(W,K);te<ne;++te)if(T[te]!==B[te]){W=T[te],K=B[te];break}return W<K?-1:K<W?1:0},d.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(T,B){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return d.alloc(0);if(B===void 0)for(te=B=0;te<T.length;++te)B+=T[te].length;for(var W=d.allocUnsafe(B),K=0,te=0;te<T.length;++te){var ne=T[te];if(Q(ne,Uint8Array)&&(ne=d.from(ne)),!d.isBuffer(ne))throw new TypeError('"list" argument must be an Array of Buffers');ne.copy(W,K),K+=ne.length}return W},d.byteLength=v,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var T=this.length;if(T%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<T;B+=2)w(this,B,B+1);return this},d.prototype.swap32=function(){var T=this.length;if(T%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<T;B+=4)w(this,B,B+3),w(this,B+1,B+2);return this},d.prototype.swap64=function(){var T=this.length;if(T%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<T;B+=8)w(this,B,B+7),w(this,B+1,B+6),w(this,B+2,B+5),w(this,B+3,B+4);return this},d.prototype.toLocaleString=d.prototype.toString=function(){var T=this.length;return T===0?"":arguments.length===0?P(this,0,T):x.apply(this,arguments)},d.prototype.equals=function(T){if(d.isBuffer(T))return this===T||d.compare(this,T)===0;throw new TypeError("Argument must be a Buffer")},d.prototype.inspect=function(){var B="",T=a.INSPECT_MAX_BYTES,B=this.toString("hex",0,T).replace(/(.{2})/g,"$1 ").trim();return this.length>T&&(B+=" ... "),"<Buffer "+B+">"},u&&(d.prototype[u]=d.prototype.inspect),d.prototype.compare=function(T,B,W,K,te){if(Q(T,Uint8Array)&&(T=d.from(T,T.offset,T.byteLength)),!d.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(W===void 0&&(W=T?T.length:0),K===void 0&&(K=0),te===void 0&&(te=this.length),(B=B===void 0?0:B)<0||W>T.length||K<0||te>this.length)throw new RangeError("out of range index");if(te<=K&&W<=B)return 0;if(te<=K)return-1;if(W<=B)return 1;if(this===T)return 0;for(var ne=(te>>>=0)-(K>>>=0),ce=(W>>>=0)-(B>>>=0),fe=Math.min(ne,ce),ue=this.slice(K,te),ge=T.slice(B,W),me=0;me<fe;++me)if(ue[me]!==ge[me]){ne=ue[me],ce=ge[me];break}return ne<ce?-1:ce<ne?1:0},d.prototype.includes=function(T,B,W){return this.indexOf(T,B,W)!==-1},d.prototype.indexOf=function(T,B,W){return S(this,T,B,W,!0)},d.prototype.lastIndexOf=function(T,B,W){return S(this,T,B,W,!1)},d.prototype.write=function(T,B,W,K){if(B===void 0)K="utf8",W=this.length,B=0;else if(W===void 0&&typeof B=="string")K=B,W=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(W)?(W>>>=0,K===void 0&&(K="utf8")):(K=W,W=void 0)}var te=this.length-B;if((W===void 0||te<W)&&(W=te),0<T.length&&(W<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");K=K||"utf8";for(var ne,ce,fe,ue=!1;;)switch(K){case"hex":var ge=this,me=T,oe=B,de=W,xe=(oe=Number(oe)||0,ge.length-oe);(!de||xe<(de=Number(de)))&&(de=xe),(xe=me.length)/2<de&&(de=xe/2);for(var Ie=0;Ie<de;++Ie){var we=parseInt(me.substr(2*Ie,2),16);if(J(we))return Ie;ge[oe+Ie]=we}return Ie;case"utf8":case"utf-8":return xe=B,fe=W,H(Y(T,(ce=this).length-xe),ce,xe,fe);case"ascii":return _(this,T,B,W);case"latin1":case"binary":return _(this,T,B,W);case"base64":return ce=this,fe=B,ne=W,H($(T),ce,fe,ne);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,T,B,W);default:if(ue)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase(),ue=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function I(T,B,W){if(T%1!=0||T<0)throw new RangeError("offset is not uint");if(W<T+B)throw new RangeError("Trying to access beyond buffer length")}function N(T,B,W,K,te,ne){if(!d.isBuffer(T))throw new TypeError('"buffer" argument must be a Buffer instance');if(te<B||B<ne)throw new RangeError('"value" argument is out of bounds');if(W+K>T.length)throw new RangeError("Index out of range")}function O(T,B,W,K){if(W+K>T.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function F(T,B,W,K,te){return B=+B,W>>>=0,te||O(T,0,W,4),c.write(T,B,W,K,23,4),W+4}function U(T,B,W,K,te){return B=+B,W>>>=0,te||O(T,0,W,8),c.write(T,B,W,K,52,8),W+8}d.prototype.slice=function(T,B){var W=this.length,W=((T=~~T)<0?(T+=W)<0&&(T=0):W<T&&(T=W),(B=B===void 0?W:~~B)<0?(B+=W)<0&&(B=0):W<B&&(B=W),B<T&&(B=T),this.subarray(T,B));return Object.setPrototypeOf(W,d.prototype),W},d.prototype.readUIntLE=function(T,B,W){T>>>=0,B>>>=0,W||I(T,B,this.length);for(var K=this[T],te=1,ne=0;++ne<B&&(te*=256);)K+=this[T+ne]*te;return K},d.prototype.readUIntBE=function(T,B,W){T>>>=0,B>>>=0,W||I(T,B,this.length);for(var K=this[T+--B],te=1;0<B&&(te*=256);)K+=this[T+--B]*te;return K},d.prototype.readUInt8=function(T,B){return T>>>=0,B||I(T,1,this.length),this[T]},d.prototype.readUInt16LE=function(T,B){return T>>>=0,B||I(T,2,this.length),this[T]|this[T+1]<<8},d.prototype.readUInt16BE=function(T,B){return T>>>=0,B||I(T,2,this.length),this[T]<<8|this[T+1]},d.prototype.readUInt32LE=function(T,B){return T>>>=0,B||I(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+16777216*this[T+3]},d.prototype.readUInt32BE=function(T,B){return T>>>=0,B||I(T,4,this.length),16777216*this[T]+(this[T+1]<<16|this[T+2]<<8|this[T+3])},d.prototype.readIntLE=function(T,B,W){T>>>=0,B>>>=0,W||I(T,B,this.length);for(var K=this[T],te=1,ne=0;++ne<B&&(te*=256);)K+=this[T+ne]*te;return(te*=128)<=K&&(K-=Math.pow(2,8*B)),K},d.prototype.readIntBE=function(T,B,W){T>>>=0,B>>>=0,W||I(T,B,this.length);for(var K=B,te=1,ne=this[T+--K];0<K&&(te*=256);)ne+=this[T+--K]*te;return(te*=128)<=ne&&(ne-=Math.pow(2,8*B)),ne},d.prototype.readInt8=function(T,B){return T>>>=0,B||I(T,1,this.length),128&this[T]?-1*(255-this[T]+1):this[T]},d.prototype.readInt16LE=function(T,B){return T>>>=0,B||I(T,2,this.length),B=this[T]|this[T+1]<<8,32768&B?4294901760|B:B},d.prototype.readInt16BE=function(T,B){return T>>>=0,B||I(T,2,this.length),B=this[T+1]|this[T]<<8,32768&B?4294901760|B:B},d.prototype.readInt32LE=function(T,B){return T>>>=0,B||I(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},d.prototype.readInt32BE=function(T,B){return T>>>=0,B||I(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},d.prototype.readFloatLE=function(T,B){return T>>>=0,B||I(T,4,this.length),c.read(this,T,!0,23,4)},d.prototype.readFloatBE=function(T,B){return T>>>=0,B||I(T,4,this.length),c.read(this,T,!1,23,4)},d.prototype.readDoubleLE=function(T,B){return T>>>=0,B||I(T,8,this.length),c.read(this,T,!0,52,8)},d.prototype.readDoubleBE=function(T,B){return T>>>=0,B||I(T,8,this.length),c.read(this,T,!1,52,8)},d.prototype.writeUIntLE=function(T,B,W,K){T=+T,B>>>=0,W>>>=0,K||N(this,T,B,W,Math.pow(2,8*W)-1,0);var te=1,ne=0;for(this[B]=255&T;++ne<W&&(te*=256);)this[B+ne]=T/te&255;return B+W},d.prototype.writeUIntBE=function(T,B,W,K){T=+T,B>>>=0,W>>>=0,K||N(this,T,B,W,Math.pow(2,8*W)-1,0);var te=W-1,ne=1;for(this[B+te]=255&T;0<=--te&&(ne*=256);)this[B+te]=T/ne&255;return B+W},d.prototype.writeUInt8=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,1,255,0),this[B]=255&T,B+1},d.prototype.writeUInt16LE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,2,65535,0),this[B]=255&T,this[B+1]=T>>>8,B+2},d.prototype.writeUInt16BE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,2,65535,0),this[B]=T>>>8,this[B+1]=255&T,B+2},d.prototype.writeUInt32LE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,4,4294967295,0),this[B+3]=T>>>24,this[B+2]=T>>>16,this[B+1]=T>>>8,this[B]=255&T,B+4},d.prototype.writeUInt32BE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,4,4294967295,0),this[B]=T>>>24,this[B+1]=T>>>16,this[B+2]=T>>>8,this[B+3]=255&T,B+4},d.prototype.writeIntLE=function(T,B,W,K){T=+T,B>>>=0,K||N(this,T,B,W,(K=Math.pow(2,8*W-1))-1,-K);var te=0,ne=1,ce=0;for(this[B]=255&T;++te<W&&(ne*=256);)T<0&&ce===0&&this[B+te-1]!==0&&(ce=1),this[B+te]=(T/ne>>0)-ce&255;return B+W},d.prototype.writeIntBE=function(T,B,W,K){T=+T,B>>>=0,K||N(this,T,B,W,(K=Math.pow(2,8*W-1))-1,-K);var te=W-1,ne=1,ce=0;for(this[B+te]=255&T;0<=--te&&(ne*=256);)T<0&&ce===0&&this[B+te+1]!==0&&(ce=1),this[B+te]=(T/ne>>0)-ce&255;return B+W},d.prototype.writeInt8=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,1,127,-128),this[B]=255&(T=T<0?255+T+1:T),B+1},d.prototype.writeInt16LE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,2,32767,-32768),this[B]=255&T,this[B+1]=T>>>8,B+2},d.prototype.writeInt16BE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,2,32767,-32768),this[B]=T>>>8,this[B+1]=255&T,B+2},d.prototype.writeInt32LE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,4,2147483647,-2147483648),this[B]=255&T,this[B+1]=T>>>8,this[B+2]=T>>>16,this[B+3]=T>>>24,B+4},d.prototype.writeInt32BE=function(T,B,W){return T=+T,B>>>=0,W||N(this,T,B,4,2147483647,-2147483648),this[B]=(T=T<0?4294967295+T+1:T)>>>24,this[B+1]=T>>>16,this[B+2]=T>>>8,this[B+3]=255&T,B+4},d.prototype.writeFloatLE=function(T,B,W){return F(this,T,B,!0,W)},d.prototype.writeFloatBE=function(T,B,W){return F(this,T,B,!1,W)},d.prototype.writeDoubleLE=function(T,B,W){return U(this,T,B,!0,W)},d.prototype.writeDoubleBE=function(T,B,W){return U(this,T,B,!1,W)},d.prototype.copy=function(T,B,W,K){if(!d.isBuffer(T))throw new TypeError("argument should be a Buffer");if(W=W||0,K||K===0||(K=this.length),B>=T.length&&(B=T.length),(K=0<K&&K<W?W:K)===W||T.length===0||this.length===0)return 0;if((B=B||0)<0)throw new RangeError("targetStart out of bounds");if(W<0||W>=this.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);var te=(K=T.length-B<K-W?T.length-B+W:K)-W;if(this===T&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(B,W,K);else if(this===T&&W<B&&B<K)for(var ne=te-1;0<=ne;--ne)T[ne+B]=this[ne+W];else Uint8Array.prototype.set.call(T,this.subarray(W,K),B);return te},d.prototype.fill=function(T,B,W,K){if(typeof T=="string"){if(typeof B=="string"?(K=B,B=0,W=this.length):typeof W=="string"&&(K=W,W=this.length),K!==void 0&&typeof K!="string")throw new TypeError("encoding must be a string");if(typeof K=="string"&&!d.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var te;T.length===1&&(te=T.charCodeAt(0),(K==="utf8"&&te<128||K==="latin1")&&(T=te))}else typeof T=="number"?T&=255:typeof T=="boolean"&&(T=Number(T));if(B<0||this.length<B||this.length<W)throw new RangeError("Out of range index");var ne;if(!(W<=B))if(B>>>=0,W=W===void 0?this.length:W>>>0,typeof(T=T||0)=="number")for(ne=B;ne<W;++ne)this[ne]=T;else{var ce=d.isBuffer(T)?T:d.from(T,K),fe=ce.length;if(fe===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(ne=0;ne<W-B;++ne)this[ne+B]=ce[ne%fe]}return this};var G=/[^+/0-9A-Za-z-_]/g;function Y(T,B){B=B||1/0;for(var W,K=T.length,te=null,ne=[],ce=0;ce<K;++ce){if(55295<(W=T.charCodeAt(ce))&&W<57344){if(!te){if(56319<W){-1<(B-=3)&&ne.push(239,191,189);continue}if(ce+1===K){-1<(B-=3)&&ne.push(239,191,189);continue}te=W;continue}if(W<56320){-1<(B-=3)&&ne.push(239,191,189),te=W;continue}W=65536+(te-55296<<10|W-56320)}else te&&-1<(B-=3)&&ne.push(239,191,189);if(te=null,W<128){if(--B<0)break;ne.push(W)}else if(W<2048){if((B-=2)<0)break;ne.push(W>>6|192,63&W|128)}else if(W<65536){if((B-=3)<0)break;ne.push(W>>12|224,W>>6&63|128,63&W|128)}else{if(!(W<1114112))throw new Error("Invalid code point");if((B-=4)<0)break;ne.push(W>>18|240,W>>12&63|128,W>>6&63|128,63&W|128)}}return ne}function $(T){return l.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(T))}function H(T,B,W,K){for(var te=0;te<K&&!(te+W>=B.length||te>=T.length);++te)B[te+W]=T[te];return te}function Q(T,B){return T instanceof B||T!=null&&T.constructor!=null&&T.constructor.name!=null&&T.constructor.name===B.name}function J(T){return T!=T}var ae=function(){for(var T="0123456789abcdef",B=new Array(256),W=0;W<16;++W)for(var K=16*W,te=0;te<16;++te)B[K+te]=T[W]+T[te];return B}()}).call(this,r("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:251}],5:[function(r,s,a){s.exports=function(i){if(typeof i!="function")throw TypeError(String(i)+" is not a function");return i}},{}],6:[function(r,s,a){var i=r("../internals/is-object");s.exports=function(l){if(i(l)||l===null)return l;throw TypeError("Can't set "+String(l)+" as a prototype")}},{"../internals/is-object":75}],7:[function(c,s,a){var i=c("../internals/well-known-symbol"),l=c("../internals/object-create"),c=c("../internals/object-define-property"),u=i("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},{"../internals/object-create":91,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],8:[function(r,s,a){var i=r("../internals/string-multibyte").charAt;s.exports=function(l,c,u){return c+(u?i(l,c).length:1)}},{"../internals/string-multibyte":124}],9:[function(r,s,a){s.exports=function(i,l,c){if(i instanceof l)return i;throw TypeError("Incorrect "+(c?c+" ":"")+"invocation")}},{}],10:[function(r,s,a){var i=r("../internals/is-object");s.exports=function(l){if(i(l))return l;throw TypeError(String(l)+" is not an object")}},{"../internals/is-object":75}],11:[function(r,s,a){s.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},{}],12:[function(O,s,a){function i(U){return h(U)&&d(F,p(U))}var l,c=O("../internals/array-buffer-native"),u=O("../internals/descriptors"),f=O("../internals/global"),h=O("../internals/is-object"),d=O("../internals/has"),p=O("../internals/classof"),y=O("../internals/create-non-enumerable-property"),g=O("../internals/redefine"),b=O("../internals/object-define-property").f,m=O("../internals/object-get-prototype-of"),v=O("../internals/object-set-prototype-of"),A=O("../internals/well-known-symbol"),O=O("../internals/uid"),x=f.Int8Array,w=x&&x.prototype,S=f.Uint8ClampedArray,S=S&&S.prototype,k=x&&m(x),_=w&&m(w),C=Object.prototype,P=C.isPrototypeOf,A=A("toStringTag"),I=O("TYPED_ARRAY_TAG"),N=c&&!!v&&p(f.opera)!=="Opera",O=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(l in F)f[l]||(N=!1);if((!N||typeof k!="function"||k===Function.prototype)&&(k=function(){throw TypeError("Incorrect invocation")},N))for(l in F)f[l]&&v(f[l],k);if((!N||!_||_===C)&&(_=k.prototype,N))for(l in F)f[l]&&v(f[l].prototype,_);if(N&&m(S)!==_&&v(S,_),u&&!d(_,A))for(l in O=!0,b(_,A,{get:function(){return h(this)?this[I]:void 0}}),F)f[l]&&y(f[l],I,l);s.exports={NATIVE_ARRAY_BUFFER_VIEWS:N,TYPED_ARRAY_TAG:O&&I,aTypedArray:function(U){if(i(U))return U;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(U){if(v){if(P.call(k,U))return U}else for(var G in F)if(d(F,l)&&(G=f[G],G&&(U===G||P.call(G,U))))return U;throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(U,G,Y){if(u){if(Y)for(var $ in F)$=f[$],$&&d($.prototype,U)&&delete $.prototype[U];_[U]&&!Y||g(_,U,!Y&&N&&w[U]||G)}},exportTypedArrayStaticMethod:function(U,G,Y){var $,H;if(u){if(v){if(Y)for($ in F)(H=f[$])&&d(H,U)&&delete H[U];if(k[U]&&!Y)return;try{return g(k,U,!Y&&N&&x[U]||G)}catch{}}for($ in F)!(H=f[$])||H[U]&&!Y||g(H,U,G)}},isView:function(U){return U=p(U),U==="DataView"||d(F,U)},isTypedArray:i,TypedArray:k,TypedArrayPrototype:_}},{"../internals/array-buffer-native":11,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/global":60,"../internals/has":61,"../internals/is-object":75,"../internals/object-define-property":93,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine":109,"../internals/uid":146,"../internals/well-known-symbol":149}],13:[function(W,s,a){function i(oe){return[255&oe]}function l(oe){return[255&oe,oe>>8&255]}function c(oe){return[255&oe,oe>>8&255,oe>>16&255,oe>>24&255]}function u(oe){return oe[3]<<24|oe[2]<<16|oe[1]<<8|oe[0]}function f(oe){return ne(oe,23,4)}function h(oe){return ne(oe,52,8)}function d(oe,de){O(oe[Q],de,{get:function(){return G(this)[de]}})}function p(Ae,de,_e,Ie){if(_e=C(_e),Ae=G(Ae),_e+de>Ae.byteLength)throw te(J);var we=G(Ae.buffer).bytes,_e=_e+Ae.byteOffset,Ae=we.slice(_e,_e+de);return Ie?Ae:Ae.reverse()}function y(oe,de,xe,Ie,we,_e){if(xe=C(xe),oe=G(oe),xe+de>oe.byteLength)throw te(J);for(var Ae=G(oe.buffer).bytes,$e=xe+oe.byteOffset,Fe=Ie(+we),ut=0;ut<de;ut++)Ae[$e+ut]=Fe[_e?ut:de-ut-1]}var g=W("../internals/global"),b=W("../internals/descriptors"),m=W("../internals/array-buffer-native"),v=W("../internals/create-non-enumerable-property"),x=W("../internals/redefine-all"),w=W("../internals/fails"),S=W("../internals/an-instance"),k=W("../internals/to-integer"),_=W("../internals/to-length"),C=W("../internals/to-index"),P=W("../internals/ieee754"),A=W("../internals/object-get-prototype-of"),I=W("../internals/object-set-prototype-of"),N=W("../internals/object-get-own-property-names").f,O=W("../internals/object-define-property").f,F=W("../internals/array-fill"),U=W("../internals/set-to-string-tag"),W=W("../internals/internal-state"),G=W.get,Y=W.set,$="ArrayBuffer",H="DataView",Q="prototype",J="Wrong index",ae=g[$],T=ae,B=g[H],W=B&&B[Q],K=Object.prototype,te=g.RangeError,ne=P.pack,ce=P.unpack;if(m){if(!w(function(){ae(1)})||!w(function(){new ae(-1)})||w(function(){return new ae,new ae(1.5),new ae(NaN),ae.name!=$})){for(var fe,g=(T=function(xe){return S(this,T),new ae(C(xe))})[Q]=ae[Q],ue=N(ae),ge=0;ue.length>ge;)(fe=ue[ge++])in T||v(T,fe,ae[fe]);g.constructor=T}I&&A(W)!==K&&I(W,K);var P=new B(new T(2)),me=W.setInt8;P.setInt8(0,2147483648),P.setInt8(1,2147483649),!P.getInt8(0)&&P.getInt8(1)||x(W,{setInt8:function(de,xe){me.call(this,de,xe<<24>>24)},setUint8:function(de,xe){me.call(this,de,xe<<24>>24)}},{unsafe:!0})}else T=function(oe){S(this,T,$),oe=C(oe),Y(this,{bytes:F.call(new Array(oe),0),byteLength:oe}),b||(this.byteLength=oe)},B=function(oe,we,xe){S(this,B,H),S(oe,T,H);var Ie=G(oe).byteLength,we=k(we);if(we<0||Ie<we)throw te("Wrong offset");if(Ie<we+(xe=xe===void 0?Ie-we:_(xe)))throw te("Wrong length");Y(this,{buffer:oe,byteLength:xe,byteOffset:we}),b||(this.buffer=oe,this.byteLength=xe,this.byteOffset=we)},b&&(d(T,"byteLength"),d(B,"buffer"),d(B,"byteLength"),d(B,"byteOffset")),x(B[Q],{getInt8:function(oe){return p(this,1,oe)[0]<<24>>24},getUint8:function(oe){return p(this,1,oe)[0]},getInt16:function(oe){return oe=p(this,2,oe,1<arguments.length?arguments[1]:void 0),(oe[1]<<8|oe[0])<<16>>16},getUint16:function(oe){return oe=p(this,2,oe,1<arguments.length?arguments[1]:void 0),oe[1]<<8|oe[0]},getInt32:function(oe){return u(p(this,4,oe,1<arguments.length?arguments[1]:void 0))},getUint32:function(oe){return u(p(this,4,oe,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(oe){return ce(p(this,4,oe,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(oe){return ce(p(this,8,oe,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(oe,de){y(this,1,oe,i,de)},setUint8:function(oe,de){y(this,1,oe,i,de)},setInt16:function(oe,de){y(this,2,oe,l,de,2<arguments.length?arguments[2]:void 0)},setUint16:function(oe,de){y(this,2,oe,l,de,2<arguments.length?arguments[2]:void 0)},setInt32:function(oe,de){y(this,4,oe,c,de,2<arguments.length?arguments[2]:void 0)},setUint32:function(oe,de){y(this,4,oe,c,de,2<arguments.length?arguments[2]:void 0)},setFloat32:function(oe,de){y(this,4,oe,f,de,2<arguments.length?arguments[2]:void 0)},setFloat64:function(oe,de){y(this,8,oe,h,de,2<arguments.length?arguments[2]:void 0)}});U(T,$),U(B,H),s.exports={ArrayBuffer:T,DataView:B}},{"../internals/an-instance":9,"../internals/array-buffer-native":11,"../internals/array-fill":15,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/ieee754":66,"../internals/internal-state":71,"../internals/object-define-property":93,"../internals/object-get-own-property-names":96,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine-all":108,"../internals/set-to-string-tag":118,"../internals/to-index":134,"../internals/to-integer":136,"../internals/to-length":137}],14:[function(r,s,a){var i=r("../internals/to-object"),l=r("../internals/to-absolute-index"),c=r("../internals/to-length"),u=Math.min;s.exports=[].copyWithin||function(b,h){var d=i(this),p=c(d.length),y=l(b,p),g=l(h,p),b=2<arguments.length?arguments[2]:void 0,m=u((b===void 0?p:l(b,p))-g,p-y),v=1;for(g<y&&y<g+m&&(v=-1,g+=m-1,y+=m-1);0<m--;)g in d?d[y]=d[g]:delete d[y],y+=v,g+=v;return d}},{"../internals/to-absolute-index":133,"../internals/to-length":137,"../internals/to-object":138}],15:[function(r,s,a){var i=r("../internals/to-object"),l=r("../internals/to-absolute-index"),c=r("../internals/to-length");s.exports=function(u){for(var f=i(this),h=c(f.length),p=arguments.length,d=l(1<p?arguments[1]:void 0,h),p=2<p?arguments[2]:void 0,y=p===void 0?h:l(p,h);d<y;)f[d++]=u;return f}},{"../internals/to-absolute-index":133,"../internals/to-length":137,"../internals/to-object":138}],16:[function(c,s,a){var i=c("../internals/array-iteration").forEach,l=c("../internals/array-method-is-strict"),c=c("../internals/array-method-uses-to-length"),l=l("forEach"),c=c("forEach");s.exports=l&&c?[].forEach:function(u){return i(this,u,1<arguments.length?arguments[1]:void 0)}},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23}],17:[function(r,s,a){var i=r("../internals/function-bind-context"),l=r("../internals/to-object"),c=r("../internals/call-with-safe-iteration-closing"),u=r("../internals/is-array-iterator-method"),f=r("../internals/to-length"),h=r("../internals/create-property"),d=r("../internals/get-iterator-method");s.exports=function(S){var y,g,b,m,v,x,w=l(S),S=typeof this=="function"?this:Array,k=arguments.length,_=1<k?arguments[1]:void 0,C=_!==void 0,P=d(w),A=0;if(C&&(_=i(_,2<k?arguments[2]:void 0,2)),P==null||S==Array&&u(P))for(g=new S(y=f(w.length));A<y;A++)x=C?_(w[A],A):w[A],h(g,A,x);else for(v=(m=P.call(w)).next,g=new S;!(b=v.call(m)).done;A++)x=C?c(m,_,[b.value,A],!0):b.value,h(g,A,x);return g.length=A,g}},{"../internals/call-with-safe-iteration-closing":26,"../internals/create-property":40,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137,"../internals/to-object":138}],18:[function(r,s,a){function i(f){return function(h,d,p){var y,g=l(h),b=c(g.length),m=u(p,b);if(f&&d!=d){for(;m<b;)if((y=g[m++])!=y)return!0}else for(;m<b;m++)if((f||m in g)&&g[m]===d)return f||m||0;return!f&&-1}}var l=r("../internals/to-indexed-object"),c=r("../internals/to-length"),u=r("../internals/to-absolute-index");s.exports={includes:i(!0),indexOf:i(!1)}},{"../internals/to-absolute-index":133,"../internals/to-indexed-object":135,"../internals/to-length":137}],19:[function(r,s,a){function i(p){var y=p==1,g=p==2,b=p==3,m=p==4,v=p==6,x=p==5||v;return function(w,S,k,_){for(var C,P,A=u(w),I=c(A),N=l(S,k,3),O=f(I.length),F=0,S=_||h,U=y?S(w,O):g?S(w,0):void 0;F<O;F++)if((x||F in I)&&(P=N(C=I[F],F,A),p)){if(y)U[F]=P;else if(P)switch(p){case 3:return!0;case 5:return C;case 6:return F;case 2:d.call(U,C)}else if(m)return!1}return v?-1:b||m?m:U}}var l=r("../internals/function-bind-context"),c=r("../internals/indexed-object"),u=r("../internals/to-object"),f=r("../internals/to-length"),h=r("../internals/array-species-create"),d=[].push;s.exports={forEach:i(0),map:i(1),filter:i(2),some:i(3),every:i(4),find:i(5),findIndex:i(6)}},{"../internals/array-species-create":25,"../internals/function-bind-context":55,"../internals/indexed-object":67,"../internals/to-length":137,"../internals/to-object":138}],20:[function(p,s,a){var i=p("../internals/to-indexed-object"),l=p("../internals/to-integer"),c=p("../internals/to-length"),d=p("../internals/array-method-is-strict"),p=p("../internals/array-method-uses-to-length"),u=Math.min,f=[].lastIndexOf,h=!!f&&1/[1].lastIndexOf(1,-0)<0,d=d("lastIndexOf"),p=p("indexOf",{ACCESSORS:!0,1:0});s.exports=h||!d||!p?function(y){if(h)return f.apply(this,arguments)||0;var g=i(this),b=c(g.length),m=b-1;for((m=1<arguments.length?u(m,l(arguments[1])):m)<0&&(m=b+m);0<=m;m--)if(m in g&&g[m]===y)return m||0;return-1}:f},{"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/to-indexed-object":135,"../internals/to-integer":136,"../internals/to-length":137}],21:[function(r,s,a){var i=r("../internals/fails"),l=r("../internals/well-known-symbol"),c=r("../internals/engine-v8-version"),u=l("species");s.exports=function(f){return 51<=c||!i(function(){var h=[];return(h.constructor={})[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},{"../internals/engine-v8-version":48,"../internals/fails":51,"../internals/well-known-symbol":149}],22:[function(r,s,a){var i=r("../internals/fails");s.exports=function(l,c){var u=[][l];return!!u&&i(function(){u.call(null,c||function(){throw 1},1)})}},{"../internals/fails":51}],23:[function(r,s,a){function i(d){throw d}var l=r("../internals/descriptors"),c=r("../internals/fails"),u=r("../internals/has"),f=Object.defineProperty,h={};s.exports=function(d,p){var y,g,b,m;return u(h,d)?h[d]:(y=[][d],g=!!u(p=p||{},"ACCESSORS")&&p.ACCESSORS,b=u(p,0)?p[0]:i,m=u(p,1)?p[1]:void 0,h[d]=!!y&&!c(function(){if(g&&!l)return!0;var v={length:-1};g?f(v,1,{enumerable:!0,get:i}):v[1]=1,y.call(v,b,m)}))}},{"../internals/descriptors":43,"../internals/fails":51,"../internals/has":61}],24:[function(r,s,a){function i(h){return function(d,p,y,g){l(p);var b=c(d),m=u(b),v=f(b.length),x=h?v-1:0,w=h?-1:1;if(y<2)for(;;){if(x in m){g=m[x],x+=w;break}if(x+=w,h?x<0:v<=x)throw TypeError("Reduce of empty array with no initial value")}for(;h?0<=x:x<v;x+=w)x in m&&(g=p(g,m[x],x,b));return g}}var l=r("../internals/a-function"),c=r("../internals/to-object"),u=r("../internals/indexed-object"),f=r("../internals/to-length");s.exports={left:i(!1),right:i(!0)}},{"../internals/a-function":5,"../internals/indexed-object":67,"../internals/to-length":137,"../internals/to-object":138}],25:[function(r,s,a){var i=r("../internals/is-object"),l=r("../internals/is-array"),c=r("../internals/well-known-symbol")("species");s.exports=function(u,f){var h;return new((h=l(u)&&(typeof(h=u.constructor)=="function"&&(h===Array||l(h.prototype))||i(h)&&(h=h[c])===null)?void 0:h)===void 0?Array:h)(f===0?0:f)}},{"../internals/is-array":73,"../internals/is-object":75,"../internals/well-known-symbol":149}],26:[function(r,s,a){var i=r("../internals/an-object");s.exports=function(l,c,u,f){try{return f?c(i(u)[0],u[1]):c(u)}catch(h){throw f=l.return,f!==void 0&&i(f.call(l)),h}}},{"../internals/an-object":10}],27:[function(r,s,a){var i=r("../internals/well-known-symbol")("iterator"),l=!1;try{var c=0,u={next:function(){return{done:!!c++}},return:function(){l=!0}};u[i]=function(){return this},Array.from(u,function(){throw 2})}catch{}s.exports=function(f,h){if(!h&&!l)return!1;var d=!1;try{var p={};p[i]=function(){return{next:function(){return{done:d=!0}}}},f(p)}catch{}return d}},{"../internals/well-known-symbol":149}],28:[function(r,s,a){var i={}.toString;s.exports=function(l){return i.call(l).slice(8,-1)}},{}],29:[function(r,s,a){var i=r("../internals/to-string-tag-support"),l=r("../internals/classof-raw"),c=r("../internals/well-known-symbol")("toStringTag"),u=l(function(){return arguments}())=="Arguments";s.exports=i?l:function(f){var h;return f===void 0?"Undefined":f===null?"Null":typeof(h=function(d,p){try{return d[p]}catch{}}(f=Object(f),c))=="string"?h:u?l(f):(h=l(f))=="Object"&&typeof f.callee=="function"?"Arguments":h}},{"../internals/classof-raw":28,"../internals/to-string-tag-support":142,"../internals/well-known-symbol":149}],30:[function(b,s,a){var i=b("../internals/object-define-property").f,l=b("../internals/object-create"),c=b("../internals/redefine-all"),u=b("../internals/function-bind-context"),f=b("../internals/an-instance"),h=b("../internals/iterate"),d=b("../internals/define-iterator"),p=b("../internals/set-species"),y=b("../internals/descriptors"),g=b("../internals/internal-metadata").fastKey,b=b("../internals/internal-state"),m=b.set,v=b.getterFor;s.exports={getConstructor:function(x,w,S,k){function _(I,N,O){var F,U=A(I),G=C(I,N);return G?G.value=O:(U.last=G={index:F=g(N,!0),key:N,value:O,previous:N=U.last,next:void 0,removed:!1},U.first||(U.first=G),N&&(N.next=G),y?U.size++:I.size++,F!=="F"&&(U.index[F]=G)),I}function C(F,N){var O,F=A(F),U=g(N);if(U!=="F")return F.index[U];for(O=F.first;O;O=O.next)if(O.key==N)return O}var P=x(function(I,N){f(I,P,w),m(I,{type:w,index:l(null),first:void 0,last:void 0,size:0}),y||(I.size=0),N!=null&&h(N,I[k],I,S)}),A=v(w);return c(P.prototype,{clear:function(){for(var I=A(this),N=I.index,O=I.first;O;)O.removed=!0,O.previous&&(O.previous=O.previous.next=void 0),delete N[O.index],O=O.next;I.first=I.last=void 0,y?I.size=0:this.size=0},delete:function(U){var N,O,F=A(this),U=C(this,U);return U&&(N=U.next,O=U.previous,delete F.index[U.index],U.removed=!0,O&&(O.next=N),N&&(N.previous=O),F.first==U&&(F.first=N),F.last==U&&(F.last=O),y?F.size--:this.size--),!!U},forEach:function(I){for(var N,O=A(this),F=u(I,1<arguments.length?arguments[1]:void 0,3);N=N?N.next:O.first;)for(F(N.value,N.key,this);N&&N.removed;)N=N.previous},has:function(I){return!!C(this,I)}}),c(P.prototype,S?{get:function(I){return I=C(this,I),I&&I.value},set:function(I,N){return _(this,I===0?0:I,N)}}:{add:function(I){return _(this,I=I===0?0:I,I)}}),y&&i(P.prototype,"size",{get:function(){return A(this).size}}),P},setStrong:function(x,w,S){var k=w+" Iterator",_=v(w),C=v(k);d(x,w,function(P,A){m(this,{type:k,target:P,state:_(P),kind:A,last:void 0})},function(){for(var P=C(this),A=P.kind,I=P.last;I&&I.removed;)I=I.previous;return P.target&&(P.last=I=I?I.next:P.state.first)?A=="keys"?{value:I.key,done:!1}:A=="values"?{value:I.value,done:!1}:{value:[I.key,I.value],done:!1}:{value:P.target=void 0,done:!0}},S?"entries":"values",!S,!0),p(w)}}},{"../internals/an-instance":9,"../internals/define-iterator":41,"../internals/descriptors":43,"../internals/function-bind-context":55,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/iterate":78,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/redefine-all":108,"../internals/set-species":117}],31:[function(m,s,a){function i(_){return _.frozen||(_.frozen=new l)}function l(){this.entries=[]}function c(_,C){return w(_.entries,function(P){return P[0]===C})}var u=m("../internals/redefine-all"),f=m("../internals/internal-metadata").getWeakData,h=m("../internals/an-object"),d=m("../internals/is-object"),p=m("../internals/an-instance"),y=m("../internals/iterate"),g=m("../internals/array-iteration"),b=m("../internals/has"),m=m("../internals/internal-state"),v=m.set,x=m.getterFor,w=g.find,S=g.findIndex,k=0;l.prototype={get:function(_){if(_=c(this,_),_)return _[1]},has:function(_){return!!c(this,_)},set:function(_,C){var P=c(this,_);P?P[1]=C:this.entries.push([_,C])},delete:function(_){var C=S(this.entries,function(P){return P[0]===_});return~C&&this.entries.splice(C,1),!!~C}},s.exports={getConstructor:function(_,C,P,A){function I(F,U,G){var Y=O(F),$=f(h(U),!0);return $===!0?i(Y).set(U,G):$[Y.id]=G,F}var N=_(function(F,U){p(F,N,C),v(F,{type:C,id:k++,frozen:void 0}),U!=null&&y(U,F[A],F,P)}),O=x(C);return u(N.prototype,{delete:function(F){var U,G=O(this);return!!d(F)&&((U=f(F))===!0?i(G).delete(F):U&&b(U,G.id)&&delete U[G.id])},has:function(F){var U,G=O(this);return!!d(F)&&((U=f(F))===!0?i(G).has(F):U&&b(U,G.id))}}),u(N.prototype,P?{get:function(F){var U,G=O(this);if(d(F))return(U=f(F))===!0?i(G).get(F):U?U[G.id]:void 0},set:function(F,U){return I(this,F,U)}}:{add:function(F){return I(this,F,!0)}}),N}}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/array-iteration":19,"../internals/has":61,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/is-object":75,"../internals/iterate":78,"../internals/redefine-all":108}],32:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/global"),c=r("../internals/is-forced"),u=r("../internals/redefine"),f=r("../internals/internal-metadata"),h=r("../internals/iterate"),d=r("../internals/an-instance"),p=r("../internals/is-object"),y=r("../internals/fails"),g=r("../internals/check-correctness-of-iteration"),b=r("../internals/set-to-string-tag"),m=r("../internals/inherit-if-required");s.exports=function(v,x,w){function S($){var H=U[$];u(U,$,$=="add"?function(Q){return H.call(this,Q===0?0:Q),this}:$=="delete"?function(Q){return!(N&&!p(Q))&&H.call(this,Q===0?0:Q)}:$=="get"?function(Q){return N&&!p(Q)?void 0:H.call(this,Q===0?0:Q)}:$=="has"?function(Q){return!(N&&!p(Q))&&H.call(this,Q===0?0:Q)}:function(Q,J){return H.call(this,Q===0?0:Q,J),this})}var k,_,C,P,A,I=v.indexOf("Map")!==-1,N=v.indexOf("Weak")!==-1,O=I?"set":"add",F=l[v],U=F&&F.prototype,G=F,Y={};return c(v,typeof F!="function"||!(N||U.forEach&&!y(function(){new F().entries().next()})))?(G=w.getConstructor(x,v,I,O),f.REQUIRED=!0):c(v,!0)&&(_=(k=new G)[O](N?{}:-0,1)!=k,C=y(function(){k.has(1)}),P=g(function($){new F($)}),A=!N&&y(function(){for(var $=new F,H=5;H--;)$[O](H,H);return!$.has(-0)}),P||(((G=x(function($,H){return d($,G,v),$=m(new F,$,G),H!=null&&h(H,$[O],$,I),$})).prototype=U).constructor=G),(C||A)&&(S("delete"),S("has"),I&&S("get")),(A||_)&&S(O),N&&U.clear&&delete U.clear),Y[v]=G,i({global:!0,forced:G!=F},Y),b(G,v),N||w.setStrong(G,v,I),G}},{"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/export":50,"../internals/fails":51,"../internals/global":60,"../internals/inherit-if-required":68,"../internals/internal-metadata":70,"../internals/is-forced":74,"../internals/is-object":75,"../internals/iterate":78,"../internals/redefine":109,"../internals/set-to-string-tag":118}],33:[function(r,s,a){var i=r("../internals/has"),l=r("../internals/own-keys"),c=r("../internals/object-get-own-property-descriptor"),u=r("../internals/object-define-property");s.exports=function(f,h){for(var d=l(h),p=u.f,y=c.f,g=0;g<d.length;g++){var b=d[g];i(f,b)||p(f,b,y(h,b))}}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/own-keys":104}],34:[function(r,s,a){var i=r("../internals/well-known-symbol")("match");s.exports=function(l){var c=/./;try{"/./"[l](c)}catch{try{return c[i]=!1,"/./"[l](c)}catch{}}return!1}},{"../internals/well-known-symbol":149}],35:[function(r,s,a){r=r("../internals/fails"),s.exports=!r(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},{"../internals/fails":51}],36:[function(r,s,a){var i=r("../internals/require-object-coercible"),l=/"/g;s.exports=function(d,u,f,h){var d=String(i(d)),p="<"+u;return f!==""&&(p+=" "+f+'="'+String(h).replace(l,"&quot;")+'"'),p+">"+d+"</"+u+">"}},{"../internals/require-object-coercible":114}],37:[function(r,s,a){function i(){return this}var l=r("../internals/iterators-core").IteratorPrototype,c=r("../internals/object-create"),u=r("../internals/create-property-descriptor"),f=r("../internals/set-to-string-tag"),h=r("../internals/iterators");s.exports=function(d,p,y){return p+=" Iterator",d.prototype=c(l,{next:u(1,y)}),f(d,p,!1,!0),h[p]=i,d}},{"../internals/create-property-descriptor":39,"../internals/iterators":80,"../internals/iterators-core":79,"../internals/object-create":91,"../internals/set-to-string-tag":118}],38:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=i?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/object-define-property":93}],39:[function(r,s,a){s.exports=function(i,l){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:l}}},{}],40:[function(r,s,a){var i=r("../internals/to-primitive"),l=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=function(u,f,h){f=i(f),f in u?l.f(u,f,c(0,h)):u[f]=h}},{"../internals/create-property-descriptor":39,"../internals/object-define-property":93,"../internals/to-primitive":141}],41:[function(m,s,a){function i(){return this}var l=m("../internals/export"),c=m("../internals/create-iterator-constructor"),u=m("../internals/object-get-prototype-of"),f=m("../internals/object-set-prototype-of"),h=m("../internals/set-to-string-tag"),d=m("../internals/create-non-enumerable-property"),p=m("../internals/redefine"),y=m("../internals/well-known-symbol"),g=m("../internals/is-pure"),b=m("../internals/iterators"),m=m("../internals/iterators-core"),v=m.IteratorPrototype,x=m.BUGGY_SAFARI_ITERATORS,w=y("iterator"),S="values",k="entries";s.exports=function(_,C,P,Y,I,N,O){c(P,C,Y);function F(T){if(T===I&&J)return J;if(!x&&T in H)return H[T];switch(T){case"keys":case S:case k:return function(){return new P(this,T)}}return function(){return new P(this)}}var U,G,Y=C+" Iterator",$=!1,H=_.prototype,Q=H[w]||H["@@iterator"]||I&&H[I],J=!x&&Q||F(I),ae=C=="Array"&&H.entries||Q;if(ae&&(ae=u(ae.call(new _)),v!==Object.prototype&&ae.next&&(g||u(ae)===v||(f?f(ae,v):typeof ae[w]!="function"&&d(ae,w,i)),h(ae,Y,!0,!0),g&&(b[Y]=i))),I==S&&Q&&Q.name!==S&&($=!0,J=function(){return Q.call(this)}),g&&!O||H[w]===J||d(H,w,J),b[C]=J,I)if(U={values:F(S),keys:N?J:F("keys"),entries:F(k)},O)for(G in U)!x&&!$&&G in H||p(H,G,U[G]);else l({target:C,proto:!0,forced:x||$},U);return U}},{"../internals/create-iterator-constructor":37,"../internals/create-non-enumerable-property":38,"../internals/export":50,"../internals/is-pure":76,"../internals/iterators":80,"../internals/iterators-core":79,"../internals/object-get-prototype-of":98,"../internals/object-set-prototype-of":102,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/well-known-symbol":149}],42:[function(r,s,a){var i=r("../internals/path"),l=r("../internals/has"),c=r("../internals/well-known-symbol-wrapped"),u=r("../internals/object-define-property").f;s.exports=function(f){var h=i.Symbol||(i.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/path":105,"../internals/well-known-symbol-wrapped":148}],43:[function(r,s,a){r=r("../internals/fails"),s.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},{"../internals/fails":51}],44:[function(l,s,a){var i=l("../internals/global"),l=l("../internals/is-object"),c=i.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},{"../internals/global":60,"../internals/is-object":75}],45:[function(r,s,a){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],46:[function(r,s,a){r=r("../internals/engine-user-agent"),s.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},{"../internals/engine-user-agent":47}],47:[function(r,s,a){r=r("../internals/get-built-in"),s.exports=r("navigator","userAgent")||""},{"../internals/get-built-in":57}],48:[function(c,s,a){var i,l,u=c("../internals/global"),c=c("../internals/engine-user-agent"),u=u.process,u=u&&u.versions,u=u&&u.v8;u?l=(i=u.split("."))[0]+i[1]:c&&(!(i=c.match(/Edge\/(\d+)/))||74<=i[1])&&(i=c.match(/Chrome\/(\d+)/))&&(l=i[1]),s.exports=l&&+l},{"../internals/engine-user-agent":47,"../internals/global":60}],49:[function(r,s,a){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],50:[function(r,s,a){var i=r("../internals/global"),l=r("../internals/object-get-own-property-descriptor").f,c=r("../internals/create-non-enumerable-property"),u=r("../internals/redefine"),f=r("../internals/set-global"),h=r("../internals/copy-constructor-properties"),d=r("../internals/is-forced");s.exports=function(p,y){var g,b,m,v=p.target,x=p.global,w=p.stat,S=x?i:w?i[v]||f(v,{}):(i[v]||{}).prototype;if(S)for(g in y){if(b=y[g],m=p.noTargetGet?(m=l(S,g))&&m.value:S[g],!d(x?g:v+(w?".":"#")+g,p.forced)&&m!==void 0){if(typeof b==typeof m)continue;h(b,m)}(p.sham||m&&m.sham)&&c(b,"sham",!0),u(S,g,b,p)}}},{"../internals/copy-constructor-properties":33,"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/is-forced":74,"../internals/object-get-own-property-descriptor":94,"../internals/redefine":109,"../internals/set-global":116}],51:[function(r,s,a){s.exports=function(i){try{return!!i()}catch{return!0}}},{}],52:[function(y,s,a){y("../modules/es.regexp.exec");var i=y("../internals/redefine"),l=y("../internals/fails"),c=y("../internals/well-known-symbol"),u=y("../internals/regexp-exec"),f=y("../internals/create-non-enumerable-property"),h=c("species"),d=!l(function(){var m=/./;return m.exec=function(){var v=[];return v.groups={a:"7"},v},"".replace(m,"$<a>")!=="7"}),p="a".replace(/./,"$0")==="$0",y=c("replace"),g=!!/./[y]&&/./[y]("a","$0")==="",b=!l(function(){var v=/(?:)/,m=v.exec,v=(v.exec=function(){return m.apply(this,arguments)},"ab".split(v));return v.length!==2||v[0]!=="a"||v[1]!=="b"});s.exports=function(m,v,x,w){var S,k,_=c(m),C=!l(function(){var A={};return A[_]=function(){return 7},""[m](A)!=7}),P=C&&!l(function(){var A=!1,I=/a/;return m==="split"&&((I={constructor:{}}).constructor[h]=function(){return I},I.flags="",I[_]=/./[_]),I.exec=function(){return A=!0,null},I[_](""),!A});C&&P&&(m!=="replace"||d&&p&&!g)&&(m!=="split"||b)||(S=/./[_],x=(P=x(_,""[m],function(A,I,N,O,F){return I.exec===u?C&&!F?{done:!0,value:S.call(I,N,O)}:{done:!0,value:A.call(N,I,O)}:{done:!1}},{REPLACE_KEEPS_$0:p,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:g}))[0],k=P[1],i(String.prototype,m,x),i(RegExp.prototype,_,v==2?function(A,I){return k.call(A,this,I)}:function(A){return k.call(A,this)})),w&&f(RegExp.prototype[_],"sham",!0)}},{"../internals/create-non-enumerable-property":38,"../internals/fails":51,"../internals/redefine":109,"../internals/regexp-exec":111,"../internals/well-known-symbol":149,"../modules/es.regexp.exec":192}],53:[function(r,s,a){function i(f,h,d,p,y,g,b,m){for(var v,x=y,w=0,S=!!b&&u(b,m,3);w<p;){if(w in d){if(v=S?S(d[w],w,h):d[w],0<g&&l(v))x=i(f,h,v,c(v.length),x,g-1)-1;else{if(9007199254740991<=x)throw TypeError("Exceed the acceptable array length");f[x]=v}x++}w++}return x}var l=r("../internals/is-array"),c=r("../internals/to-length"),u=r("../internals/function-bind-context");s.exports=i},{"../internals/function-bind-context":55,"../internals/is-array":73,"../internals/to-length":137}],54:[function(r,s,a){r=r("../internals/fails"),s.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},{"../internals/fails":51}],55:[function(r,s,a){var i=r("../internals/a-function");s.exports=function(l,c,u){if(i(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,d){return l.call(c,f,h,d)}}return function(){return l.apply(c,arguments)}}},{"../internals/a-function":5}],56:[function(r,s,a){var i=r("../internals/a-function"),l=r("../internals/is-object"),c=[].slice,u={};s.exports=Function.bind||function(f){var h=i(this),d=c.call(arguments,1),p=function(){var y=d.concat(c.call(arguments));if(this instanceof p){var g=h,b=y.length,m=y;if(!(b in u)){for(var v=[],x=0;x<b;x++)v[x]="a["+x+"]";u[b]=Function("C,a","return new C("+v.join(",")+")")}return u[b](g,m)}return h.apply(f,y)};return l(h.prototype)&&(p.prototype=h.prototype),p}},{"../internals/a-function":5,"../internals/is-object":75}],57:[function(r,s,a){function i(u){return typeof u=="function"?u:void 0}var l=r("../internals/path"),c=r("../internals/global");s.exports=function(u,f){return arguments.length<2?i(l[u])||i(c[u]):l[u]&&l[u][f]||c[u]&&c[u][f]}},{"../internals/global":60,"../internals/path":105}],58:[function(r,s,a){var i=r("../internals/classof"),l=r("../internals/iterators"),c=r("../internals/well-known-symbol")("iterator");s.exports=function(u){if(u!=null)return u[c]||u["@@iterator"]||l[i(u)]}},{"../internals/classof":29,"../internals/iterators":80,"../internals/well-known-symbol":149}],59:[function(r,s,a){var i=r("../internals/an-object"),l=r("../internals/get-iterator-method");s.exports=function(c){var u=l(c);if(typeof u!="function")throw TypeError(String(c)+" is not iterable");return i(u.call(c))}},{"../internals/an-object":10,"../internals/get-iterator-method":58}],60:[function(r,s,a){(function(i){function l(c){return c&&c.Math==Math&&c}s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof i=="object"&&i)||Function("return this")()}).call(this,typeof cn<"u"?cn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],61:[function(r,s,a){var i={}.hasOwnProperty;s.exports=function(l,c){return i.call(l,c)}},{}],62:[function(r,s,a){s.exports={}},{}],63:[function(r,s,a){var i=r("../internals/global");s.exports=function(l,c){var u=i.console;u&&u.error&&(arguments.length===1?u.error(l):u.error(l,c))}},{"../internals/global":60}],64:[function(r,s,a){r=r("../internals/get-built-in"),s.exports=r("document","documentElement")},{"../internals/get-built-in":57}],65:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/fails"),c=r("../internals/document-create-element");s.exports=!i&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},{"../internals/descriptors":43,"../internals/document-create-element":44,"../internals/fails":51}],66:[function(r,s,a){var i=Math.abs,l=Math.pow,c=Math.floor,u=Math.log,f=Math.LN2;s.exports={pack:function(h,d,x){var y,g,b,m=new Array(x),v=8*x-d-1,x=(1<<v)-1,w=x>>1,S=d===23?l(2,-24)-l(2,-77):0,k=h<0||h===0&&1/h<0?1:0,_=0;for((h=i(h))!=h||h===1/0?(g=h!=h?1:0,y=x):(y=c(u(h)/f),h*(b=l(2,-y))<1&&(y--,b*=2),2<=(h+=1<=y+w?S/b:S*l(2,1-w))*b&&(y++,b/=2),x<=y+w?(g=0,y=x):1<=y+w?(g=(h*b-1)*l(2,d),y+=w):(g=h*l(2,w-1)*l(2,d),y=0));8<=d;m[_++]=255&g,g/=256,d-=8);for(y=y<<d|g,v+=d;0<v;m[_++]=255&y,y/=256,v-=8);return m[--_]|=128*k,m},unpack:function(h,d){var p,y=h.length,x=8*y-d-1,g=(1<<x)-1,b=g>>1,m=x-7,v=y-1,x=h[v--],w=127&x;for(x>>=7;0<m;w=256*w+h[v],v--,m-=8);for(p=w&(1<<-m)-1,w>>=-m,m+=d;0<m;p=256*p+h[v],v--,m-=8);if(w===0)w=1-b;else{if(w===g)return p?NaN:x?-1/0:1/0;p+=l(2,d),w-=b}return(x?-1:1)*p*l(2,w-d)}}},{}],67:[function(r,s,a){var i=r("../internals/fails"),l=r("../internals/classof-raw"),c="".split;s.exports=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},{"../internals/classof-raw":28,"../internals/fails":51}],68:[function(r,s,a){var i=r("../internals/is-object"),l=r("../internals/object-set-prototype-of");s.exports=function(c,u,f){return l&&typeof(u=u.constructor)=="function"&&u!==f&&i(u=u.prototype)&&u!==f.prototype&&l(c,u),c}},{"../internals/is-object":75,"../internals/object-set-prototype-of":102}],69:[function(i,s,a){var i=i("../internals/shared-store"),l=Function.toString;typeof i.inspectSource!="function"&&(i.inspectSource=function(c){return l.call(c)}),s.exports=i.inspectSource},{"../internals/shared-store":120}],70:[function(r,s,a){function i(m){f(m,p,{value:{objectID:"O"+ ++y,weakData:{}}})}var l=r("../internals/hidden-keys"),c=r("../internals/is-object"),u=r("../internals/has"),f=r("../internals/object-define-property").f,h=r("../internals/uid"),d=r("../internals/freezing"),p=h("meta"),y=0,g=Object.isExtensible||function(){return!0},b=s.exports={REQUIRED:!1,fastKey:function(m,v){if(!c(m))return typeof m=="symbol"?m:(typeof m=="string"?"S":"P")+m;if(!u(m,p)){if(!g(m))return"F";if(!v)return"E";i(m)}return m[p].objectID},getWeakData:function(m,v){if(!u(m,p)){if(!g(m))return!0;if(!v)return!1;i(m)}return m[p].weakData},onFreeze:function(m){return d&&b.REQUIRED&&g(m)&&!u(m,p)&&i(m),m}};l[p]=!0},{"../internals/freezing":54,"../internals/has":61,"../internals/hidden-keys":62,"../internals/is-object":75,"../internals/object-define-property":93,"../internals/uid":146}],71:[function(x,s,a){var i,l,c,u,f,h,d,p,y=x("../internals/native-weak-map"),w=x("../internals/global"),g=x("../internals/is-object"),b=x("../internals/create-non-enumerable-property"),m=x("../internals/has"),v=x("../internals/shared-key"),x=x("../internals/hidden-keys"),w=w.WeakMap;d=y?(i=new w,l=i.get,c=i.has,u=i.set,f=function(S,k){return u.call(i,S,k),k},h=function(S){return l.call(i,S)||{}},function(S){return c.call(i,S)}):(x[p=v("state")]=!0,f=function(S,k){return b(S,p,k),k},h=function(S){return m(S,p)?S[p]:{}},function(S){return m(S,p)}),s.exports={set:f,get:h,has:d,enforce:function(S){return d(S)?h(S):f(S,{})},getterFor:function(S){return function(k){if(g(k)&&(k=h(k)).type===S)return k;throw TypeError("Incompatible receiver, "+S+" required")}}}},{"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/has":61,"../internals/hidden-keys":62,"../internals/is-object":75,"../internals/native-weak-map":86,"../internals/shared-key":119}],72:[function(r,s,a){var i=r("../internals/well-known-symbol"),l=r("../internals/iterators"),c=i("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},{"../internals/iterators":80,"../internals/well-known-symbol":149}],73:[function(r,s,a){var i=r("../internals/classof-raw");s.exports=Array.isArray||function(l){return i(l)=="Array"}},{"../internals/classof-raw":28}],74:[function(r,s,a){function i(p,y){return(p=f[u(p)])==d||p!=h&&(typeof y=="function"?l(y):!!y)}var l=r("../internals/fails"),c=/#|\.prototype\./,u=i.normalize=function(p){return String(p).replace(c,".").toLowerCase()},f=i.data={},h=i.NATIVE="N",d=i.POLYFILL="P";s.exports=i},{"../internals/fails":51}],75:[function(r,s,a){s.exports=function(i){return typeof i=="object"?i!==null:typeof i=="function"}},{}],76:[function(r,s,a){s.exports=!1},{}],77:[function(r,s,a){var i=r("../internals/is-object"),l=r("../internals/classof-raw"),c=r("../internals/well-known-symbol")("match");s.exports=function(u){var f;return i(u)&&((f=u[c])!==void 0?!!f:l(u)=="RegExp")}},{"../internals/classof-raw":28,"../internals/is-object":75,"../internals/well-known-symbol":149}],78:[function(r,s,a){function i(p,y){this.stopped=p,this.result=y}var l=r("../internals/an-object"),c=r("../internals/is-array-iterator-method"),u=r("../internals/to-length"),f=r("../internals/function-bind-context"),h=r("../internals/get-iterator-method"),d=r("../internals/call-with-safe-iteration-closing");(s.exports=function(p,y,g,b,m){var v,x,w,S,k,_,C=f(y,g,b?2:1);if(m)v=p;else{if(typeof(y=h(p))!="function")throw TypeError("Target is not iterable");if(c(y)){for(x=0,w=u(p.length);x<w;x++)if((S=b?C(l(_=p[x])[0],_[1]):C(p[x]))&&S instanceof i)return S;return new i(!1)}v=y.call(p)}for(k=v.next;!(_=k.call(v)).done;)if(typeof(S=d(v,C,_.value,b))=="object"&&S&&S instanceof i)return S;return new i(!1)}).stop=function(p){return new i(!0,p)}},{"../internals/an-object":10,"../internals/call-with-safe-iteration-closing":26,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137}],79:[function(h,s,a){var i,l,c=h("../internals/object-get-prototype-of"),u=h("../internals/create-non-enumerable-property"),f=h("../internals/has"),d=h("../internals/well-known-symbol"),h=h("../internals/is-pure"),d=d("iterator"),p=!1;[].keys&&("next"in(l=[].keys())?(c=c(c(l)))!==Object.prototype&&(i=c):p=!0),i==null&&(i={}),h||f(i,d)||u(i,d,function(){return this}),s.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},{"../internals/create-non-enumerable-property":38,"../internals/has":61,"../internals/is-pure":76,"../internals/object-get-prototype-of":98,"../internals/well-known-symbol":149}],80:[function(r,s,a){s.exports={}},{}],81:[function(r,s,a){s.exports=Math.sign||function(i){return(i=+i)==0||i!=i?i:i<0?-1:1}},{}],82:[function(b,s,a){var i,l,c,u,f,h,d,p,y=b("../internals/global"),k=b("../internals/object-get-own-property-descriptor").f,S=b("../internals/classof-raw"),g=b("../internals/task").set,b=b("../internals/engine-is-ios"),m=y.MutationObserver||y.WebKitMutationObserver,v=y.process,x=y.Promise,w=S(v)=="process",S=k(y,"queueMicrotask"),k=S&&S.value;k||(i=function(){var _,C;for(w&&(_=v.domain)&&_.exit();l;){C=l.fn,l=l.next;try{C()}catch(P){throw l?u():c=void 0,P}}c=void 0,_&&_.enter()},u=w?function(){v.nextTick(i)}:m&&!b?(f=!0,h=document.createTextNode(""),new m(i).observe(h,{characterData:!0}),function(){h.data=f=!f}):x&&x.resolve?(d=x.resolve(void 0),p=d.then,function(){p.call(d,i)}):function(){g.call(y,i)}),s.exports=k||function(_){_={fn:_,next:void 0},c&&(c.next=_),l||(l=_,u()),c=_}},{"../internals/classof-raw":28,"../internals/engine-is-ios":46,"../internals/global":60,"../internals/object-get-own-property-descriptor":94,"../internals/task":131}],83:[function(r,s,a){r=r("../internals/global"),s.exports=r.Promise},{"../internals/global":60}],84:[function(r,s,a){r=r("../internals/fails"),s.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())})},{"../internals/fails":51}],85:[function(r,s,a){var i=r("../internals/fails"),l=r("../internals/well-known-symbol"),c=r("../internals/is-pure"),u=l("iterator");s.exports=!i(function(){var f=new URL("b?a=1&b=2&c=3","http://a"),h=f.searchParams,d="";return f.pathname="c%20d",h.forEach(function(p,y){h.delete("b"),d+=y+p}),c&&!f.toJSON||!h.sort||f.href!=="http://a/c%20d?a=1&c=3"||h.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!h[u]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||d!=="a1c3"||new URL("http://x",void 0).host!=="x"})},{"../internals/fails":51,"../internals/is-pure":76,"../internals/well-known-symbol":149}],86:[function(i,s,a){var l=i("../internals/global"),i=i("../internals/inspect-source"),l=l.WeakMap;s.exports=typeof l=="function"&&/native code/.test(i(l))},{"../internals/global":60,"../internals/inspect-source":69}],87:[function(r,s,a){function i(c){var u,f;this.promise=new c(function(h,d){if(u!==void 0||f!==void 0)throw TypeError("Bad Promise constructor");u=h,f=d}),this.resolve=l(u),this.reject=l(f)}var l=r("../internals/a-function");s.exports.f=function(c){return new i(c)}},{"../internals/a-function":5}],88:[function(r,s,a){var i=r("../internals/is-regexp");s.exports=function(l){if(i(l))throw TypeError("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":77}],89:[function(r,s,a){var i=r("../internals/global").isFinite;s.exports=Number.isFinite||function(l){return typeof l=="number"&&i(l)}},{"../internals/global":60}],90:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/fails"),c=r("../internals/object-keys"),u=r("../internals/object-get-own-property-symbols"),f=r("../internals/object-property-is-enumerable"),h=r("../internals/to-object"),d=r("../internals/indexed-object"),p=Object.assign,y=Object.defineProperty;s.exports=!p||l(function(){var g,b,m,v;return!(!i||p({b:1},p(y({},"a",{enumerable:!0,get:function(){y(this,"b",{value:3,enumerable:!1})}}),{b:2})).b===1)||(b={},v="abcdefghijklmnopqrst",(g={})[m=Symbol()]=7,v.split("").forEach(function(x){b[x]=x}),p({},g)[m]!=7||c(p({},b)).join("")!=v)})?function(g,b){for(var m=h(g),v=arguments.length,x=1,w=u.f,S=f.f;x<v;)for(var k,_=d(arguments[x++]),C=w?c(_).concat(w(_)):c(_),P=C.length,A=0;A<P;)k=C[A++],i&&!S.call(_,k)||(m[k]=_[k]);return m}:p},{"../internals/descriptors":43,"../internals/fails":51,"../internals/indexed-object":67,"../internals/object-get-own-property-symbols":97,"../internals/object-keys":100,"../internals/object-property-is-enumerable":101,"../internals/to-object":138}],91:[function(y,s,a){function i(){}var l,c=y("../internals/an-object"),u=y("../internals/object-define-properties"),f=y("../internals/enum-bug-keys"),h=y("../internals/hidden-keys"),d=y("../internals/html"),p=y("../internals/document-create-element"),y=y("../internals/shared-key"),g="prototype",b="script",m=y("IE_PROTO"),v=function(w){return"<"+b+">"+w+"</"+b+">"},x=function(){try{l=document.domain&&new ActiveXObject("htmlfile")}catch{}x=l?((w=l).write(v("")),w.close(),S=w.parentWindow.Object,w=null,S):(w=p("iframe"),S="java"+b+":",w.style.display="none",d.appendChild(w),w.src=String(S),(S=w.contentWindow.document).open(),S.write(v("document.F=Object")),S.close(),S.F);for(var w,S,k=f.length;k--;)delete x[g][f[k]];return x()};h[m]=!0,s.exports=Object.create||function(w,S){var k;return w!==null?(i[g]=c(w),k=new i,i[g]=null,k[m]=w):k=x(),S===void 0?k:u(k,S)}},{"../internals/an-object":10,"../internals/document-create-element":44,"../internals/enum-bug-keys":49,"../internals/hidden-keys":62,"../internals/html":64,"../internals/object-define-properties":92,"../internals/shared-key":119}],92:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/object-define-property"),c=r("../internals/an-object"),u=r("../internals/object-keys");s.exports=i?Object.defineProperties:function(f,h){c(f);for(var d,p=u(h),y=p.length,g=0;g<y;)l.f(f,d=p[g++],h[d]);return f}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/object-define-property":93,"../internals/object-keys":100}],93:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/ie8-dom-define"),c=r("../internals/an-object"),u=r("../internals/to-primitive"),f=Object.defineProperty;a.f=i?f:function(h,d,p){if(c(h),d=u(d,!0),c(p),l)try{return f(h,d,p)}catch{}if("get"in p||"set"in p)throw TypeError("Accessors not supported");return"value"in p&&(h[d]=p.value),h}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/ie8-dom-define":65,"../internals/to-primitive":141}],94:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/object-property-is-enumerable"),c=r("../internals/create-property-descriptor"),u=r("../internals/to-indexed-object"),f=r("../internals/to-primitive"),h=r("../internals/has"),d=r("../internals/ie8-dom-define"),p=Object.getOwnPropertyDescriptor;a.f=i?p:function(y,g){if(y=u(y),g=f(g,!0),d)try{return p(y,g)}catch{}if(h(y,g))return c(!l.f.call(y,g),y[g])}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/has":61,"../internals/ie8-dom-define":65,"../internals/object-property-is-enumerable":101,"../internals/to-indexed-object":135,"../internals/to-primitive":141}],95:[function(r,s,a){var i=r("../internals/to-indexed-object"),l=r("../internals/object-get-own-property-names").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];s.exports.f=function(f){if(!u||c.call(f)!="[object Window]")return l(i(f));try{return l(f)}catch{return u.slice()}}},{"../internals/object-get-own-property-names":96,"../internals/to-indexed-object":135}],96:[function(r,s,a){var i=r("../internals/object-keys-internal"),l=r("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(c){return i(c,l)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":99}],97:[function(r,s,a){a.f=Object.getOwnPropertySymbols},{}],98:[function(u,s,a){var i=u("../internals/has"),l=u("../internals/to-object"),c=u("../internals/shared-key"),u=u("../internals/correct-prototype-getter"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(d){return d=l(d),i(d,f)?d[f]:typeof d.constructor=="function"&&d instanceof d.constructor?d.constructor.prototype:d instanceof Object?h:null}},{"../internals/correct-prototype-getter":35,"../internals/has":61,"../internals/shared-key":119,"../internals/to-object":138}],99:[function(r,s,a){var i=r("../internals/has"),l=r("../internals/to-indexed-object"),c=r("../internals/array-includes").indexOf,u=r("../internals/hidden-keys");s.exports=function(f,h){var d,p=l(f),y=0,g=[];for(d in p)!i(u,d)&&i(p,d)&&g.push(d);for(;h.length>y;)!i(p,d=h[y++])||~c(g,d)||g.push(d);return g}},{"../internals/array-includes":18,"../internals/has":61,"../internals/hidden-keys":62,"../internals/to-indexed-object":135}],100:[function(r,s,a){var i=r("../internals/object-keys-internal"),l=r("../internals/enum-bug-keys");s.exports=Object.keys||function(c){return i(c,l)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":99}],101:[function(r,s,a){var i={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!i.call({1:2},1);a.f=c?function(u){return u=l(this,u),!!u&&u.enumerable}:i},{}],102:[function(r,s,a){var i=r("../internals/an-object"),l=r("../internals/a-possible-prototype");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c,u=!1,f={};try{(c=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(f,[]),u=f instanceof Array}catch{}return function(h,d){return i(h),l(d),u?c.call(h,d):h.__proto__=d,h}}():void 0)},{"../internals/a-possible-prototype":6,"../internals/an-object":10}],103:[function(r,s,a){var i=r("../internals/to-string-tag-support"),l=r("../internals/classof");s.exports=i?{}.toString:function(){return"[object "+l(this)+"]"}},{"../internals/classof":29,"../internals/to-string-tag-support":142}],104:[function(r,s,a){var i=r("../internals/get-built-in"),l=r("../internals/object-get-own-property-names"),c=r("../internals/object-get-own-property-symbols"),u=r("../internals/an-object");s.exports=i("Reflect","ownKeys")||function(f){var h=l.f(u(f)),d=c.f;return d?h.concat(d(f)):h}},{"../internals/an-object":10,"../internals/get-built-in":57,"../internals/object-get-own-property-names":96,"../internals/object-get-own-property-symbols":97}],105:[function(r,s,a){r=r("../internals/global"),s.exports=r},{"../internals/global":60}],106:[function(r,s,a){s.exports=function(i){try{return{error:!1,value:i()}}catch(l){return{error:!0,value:l}}}},{}],107:[function(r,s,a){var i=r("../internals/an-object"),l=r("../internals/is-object"),c=r("../internals/new-promise-capability");s.exports=function(u,f){return i(u),l(f)&&f.constructor===u?f:((0,(u=c.f(u)).resolve)(f),u.promise)}},{"../internals/an-object":10,"../internals/is-object":75,"../internals/new-promise-capability":87}],108:[function(r,s,a){var i=r("../internals/redefine");s.exports=function(l,c,u){for(var f in c)i(l,f,c[f],u);return l}},{"../internals/redefine":109}],109:[function(h,s,a){var i=h("../internals/global"),l=h("../internals/create-non-enumerable-property"),c=h("../internals/has"),u=h("../internals/set-global"),f=h("../internals/inspect-source"),h=h("../internals/internal-state"),d=h.get,p=h.enforce,y=String(String).split("String");(s.exports=function(g,b,m,S){var x=!!S&&!!S.unsafe,w=!!S&&!!S.enumerable,S=!!S&&!!S.noTargetGet;typeof m=="function"&&(typeof b!="string"||c(m,"name")||l(m,"name",b),p(m).source=y.join(typeof b=="string"?b:"")),g===i?w?g[b]=m:u(b,m):(x?!S&&g[b]&&(w=!0):delete g[b],w?g[b]=m:l(g,b,m))})(Function.prototype,"toString",function(){return typeof this=="function"&&d(this).source||f(this)})},{"../internals/create-non-enumerable-property":38,"../internals/global":60,"../internals/has":61,"../internals/inspect-source":69,"../internals/internal-state":71,"../internals/set-global":116}],110:[function(r,s,a){var i=r("./classof-raw"),l=r("./regexp-exec");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){if(f=f.call(c,u),typeof f!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return f}if(i(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},{"./classof-raw":28,"./regexp-exec":111}],111:[function(u,s,a){var i,l,c=u("./regexp-flags"),u=u("./regexp-sticky-helpers"),f=RegExp.prototype.exec,h=String.prototype.replace,d=f,p=(i=/a/,l=/b*/g,f.call(i,"a"),f.call(l,"a"),i.lastIndex!==0||l.lastIndex!==0),y=u.UNSUPPORTED_Y||u.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0;s.exports=d=p||g||y?function(b){var m,v,x,w,S=this,k=y&&S.sticky,_=c.call(S),C=S.source,P=0,A=b;return k&&((_=_.replace("y","")).indexOf("g")===-1&&(_+="g"),A=String(b).slice(S.lastIndex),0<S.lastIndex&&(!S.multiline||S.multiline&&b[S.lastIndex-1]!==`
`)&&(C="(?: "+C+")",A=" "+A,P++),v=new RegExp("^(?:"+C+")",_)),g&&(v=new RegExp("^"+C+"$(?!\\s)",_)),p&&(m=S.lastIndex),x=f.call(k?v:S,A),k?x?(x.input=x.input.slice(P),x[0]=x[0].slice(P),x.index=S.lastIndex,S.lastIndex+=x[0].length):S.lastIndex=0:p&&x&&(S.lastIndex=S.global?x.index+x[0].length:m),g&&x&&1<x.length&&h.call(x[0],v,function(){for(w=1;w<arguments.length-2;w++)arguments[w]===void 0&&(x[w]=void 0)}),x}:d},{"./regexp-flags":112,"./regexp-sticky-helpers":113}],112:[function(r,s,a){var i=r("../internals/an-object");s.exports=function(){var l=i(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},{"../internals/an-object":10}],113:[function(r,s,a){r=r("./fails");function i(l,c){return RegExp(l,c)}a.UNSUPPORTED_Y=r(function(){var l=i("a","y");return l.lastIndex=2,l.exec("abcd")!=null}),a.BROKEN_CARET=r(function(){var l=i("^r","gy");return l.lastIndex=2,l.exec("str")!=null})},{"./fails":51}],114:[function(r,s,a){s.exports=function(i){if(i==null)throw TypeError("Can't call method on "+i);return i}},{}],115:[function(r,s,a){s.exports=Object.is||function(i,l){return i===l?i!==0||1/i==1/l:i!=i&&l!=l}},{}],116:[function(r,s,a){var i=r("../internals/global"),l=r("../internals/create-non-enumerable-property");s.exports=function(c,u){try{l(i,c,u)}catch{i[c]=u}return u}},{"../internals/create-non-enumerable-property":38,"../internals/global":60}],117:[function(r,s,a){var i=r("../internals/get-built-in"),l=r("../internals/object-define-property"),c=r("../internals/well-known-symbol"),u=r("../internals/descriptors"),f=c("species");s.exports=function(d){var d=i(d),p=l.f;u&&d&&!d[f]&&p(d,f,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":43,"../internals/get-built-in":57,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],118:[function(r,s,a){var i=r("../internals/object-define-property").f,l=r("../internals/has"),c=r("../internals/well-known-symbol")("toStringTag");s.exports=function(u,f,h){u&&!l(u=h?u:u.prototype,c)&&i(u,c,{configurable:!0,value:f})}},{"../internals/has":61,"../internals/object-define-property":93,"../internals/well-known-symbol":149}],119:[function(r,s,a){var i=r("../internals/shared"),l=r("../internals/uid"),c=i("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},{"../internals/shared":121,"../internals/uid":146}],120:[function(i,s,a){var c=i("../internals/global"),i=i("../internals/set-global"),l="__core-js_shared__",c=c[l]||i(l,{});s.exports=c},{"../internals/global":60,"../internals/set-global":116}],121:[function(r,s,a){var i=r("../internals/is-pure"),l=r("../internals/shared-store");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:i?"pure":"global",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":76,"../internals/shared-store":120}],122:[function(r,s,a){var i=r("../internals/an-object"),l=r("../internals/a-function"),c=r("../internals/well-known-symbol")("species");s.exports=function(h,f){var h=i(h).constructor;return h===void 0||(h=i(h)[c])==null?f:l(h)}},{"../internals/a-function":5,"../internals/an-object":10,"../internals/well-known-symbol":149}],123:[function(r,s,a){var i=r("../internals/fails");s.exports=function(l){return i(function(){var c=""[l]('"');return c!==c.toLowerCase()||3<c.split('"').length})}},{"../internals/fails":51}],124:[function(r,s,a){function i(u){return function(p,y){var d,p=String(c(p)),y=l(y),g=p.length;return y<0||g<=y?u?"":void 0:(d=p.charCodeAt(y))<55296||56319<d||y+1===g||(g=p.charCodeAt(y+1))<56320||57343<g?u?p.charAt(y):d:u?p.slice(y,y+2):g-56320+(d-55296<<10)+65536}}var l=r("../internals/to-integer"),c=r("../internals/require-object-coercible");s.exports={codeAt:i(!1),charAt:i(!0)}},{"../internals/require-object-coercible":114,"../internals/to-integer":136}],125:[function(r,s,a){r=r("../internals/engine-user-agent"),s.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},{"../internals/engine-user-agent":47}],126:[function(r,s,a){function i(h){return function(g,v,m){var g=String(u(g)),b=g.length,m=m===void 0?" ":String(m),v=l(v);return v<=b||m==""?g:((b=c.call(m,f((v=v-b)/m.length))).length>v&&(b=b.slice(0,v)),h?g+b:b+g)}}var l=r("../internals/to-length"),c=r("../internals/string-repeat"),u=r("../internals/require-object-coercible"),f=Math.ceil;s.exports={start:i(!1),end:i(!0)}},{"../internals/require-object-coercible":114,"../internals/string-repeat":128,"../internals/to-length":137}],127:[function(r,s,a){function i(x){return x+22+75*(x<26)}function l(x){var w,S=[],k=(x=function(Q){for(var J=[],ae=0,T=Q.length;ae<T;){var B,W=Q.charCodeAt(ae++);55296<=W&&W<=56319&&ae<T?(64512&(B=Q.charCodeAt(ae++)))==56320?J.push(((1023&W)<<10)+(1023&B)+65536):(J.push(W),ae--):J.push(W)}return J}(x)).length,_=128,C=0,P=72;for(O=0;O<x.length;O++)(w=x[O])<128&&S.push(v(w));var A=S.length,I=A;for(A&&S.push("-");I<k;){for(var N=c,O=0;O<x.length;O++)_<=(w=x[O])&&w<N&&(N=w);var F=I+1;if(N-_>m((c-C)/F))throw RangeError(g);for(C+=(N-_)*F,_=N,O=0;O<x.length;O++){if((w=x[O])<_&&++C>c)throw RangeError(g);if(w==_){for(var U=C,G=u;;G+=u){var Y=G<=P?1:P+f<=G?f:G-P;if(U<Y)break;var $=U-Y,H=u-Y;S.push(v(i(Y+$%H))),U=m($/H)}S.push(v(i(U))),P=function(Q,J,ae){var T=0;for(Q=ae?m(Q/d):Q>>1,Q+=m(Q/J);b*f>>1<Q;T+=u)Q=m(Q/b);return m(T+(b+1)*Q/(Q+h))}(C,F,I==A),C=0,++I}}++C,++_}return S.join("")}var c=2147483647,u=36,f=26,h=38,d=700,p=/[^\0-\u007E]/,y=/[.\u3002\uFF0E\uFF61]/g,g="Overflow: input needs wider integers to process",b=u-1,m=Math.floor,v=String.fromCharCode;s.exports=function(x){for(var w,S=[],k=x.toLowerCase().replace(y,".").split("."),_=0;_<k.length;_++)w=k[_],S.push(p.test(w)?"xn--"+l(w):w);return S.join(".")}},{}],128:[function(r,s,a){var i=r("../internals/to-integer"),l=r("../internals/require-object-coercible");s.exports="".repeat||function(c){var u=String(l(this)),f="",h=i(c);if(h<0||h==1/0)throw RangeError("Wrong number of repetitions");for(;0<h;(h>>>=1)&&(u+=u))1&h&&(f+=u);return f}},{"../internals/require-object-coercible":114,"../internals/to-integer":136}],129:[function(r,s,a){var i=r("../internals/fails"),l=r("../internals/whitespaces");s.exports=function(c){return i(function(){return!!l[c]()||"\u200B\x85\u180E"[c]()!="\u200B\x85\u180E"||l[c].name!==c})}},{"../internals/fails":51,"../internals/whitespaces":150}],130:[function(c,s,a){function i(h){return function(d){return d=String(l(d)),1&h&&(d=d.replace(u,"")),d=2&h?d.replace(f,""):d}}var l=c("../internals/require-object-coercible"),c="["+c("../internals/whitespaces")+"]",u=RegExp("^"+c+c+"*"),f=RegExp(c+c+"*$");s.exports={start:i(1),end:i(2),trim:i(3)}},{"../internals/require-object-coercible":114,"../internals/whitespaces":150}],131:[function(b,s,a){function i(I){return function(){A(I)}}function l(I){A(I.data)}function c(I){f.postMessage(I+"",m.protocol+"//"+m.host)}var u,f=b("../internals/global"),h=b("../internals/fails"),d=b("../internals/classof-raw"),p=b("../internals/function-bind-context"),y=b("../internals/html"),g=b("../internals/document-create-element"),b=b("../internals/engine-is-ios"),m=f.location,v=f.setImmediate,x=f.clearImmediate,w=f.process,S=f.MessageChannel,k=f.Dispatch,_=0,C={},P="onreadystatechange",A=function(I){var N;C.hasOwnProperty(I)&&(N=C[I],delete C[I],N())};v&&x||(v=function(I){for(var N=[],O=1;O<arguments.length;)N.push(arguments[O++]);return C[++_]=function(){(typeof I=="function"?I:Function(I)).apply(void 0,N)},u(_),_},x=function(I){delete C[I]},d(w)=="process"?u=function(I){w.nextTick(i(I))}:k&&k.now?u=function(I){k.now(i(I))}:S&&!b?(b=(d=new S).port2,d.port1.onmessage=l,u=p(b.postMessage,b,1)):!f.addEventListener||typeof postMessage!="function"||f.importScripts||h(c)||m.protocol==="file:"?u=P in g("script")?function(I){y.appendChild(g("script"))[P]=function(){y.removeChild(this),A(I)}}:function(I){setTimeout(i(I),0)}:(u=c,f.addEventListener("message",l,!1))),s.exports={set:v,clear:x}},{"../internals/classof-raw":28,"../internals/document-create-element":44,"../internals/engine-is-ios":46,"../internals/fails":51,"../internals/function-bind-context":55,"../internals/global":60,"../internals/html":64}],132:[function(r,s,a){var i=r("../internals/classof-raw");s.exports=function(l){if(typeof l!="number"&&i(l)!="Number")throw TypeError("Incorrect invocation");return+l}},{"../internals/classof-raw":28}],133:[function(r,s,a){var i=r("../internals/to-integer"),l=Math.max,c=Math.min;s.exports=function(u,f){return u=i(u),u<0?l(u+f,0):c(u,f)}},{"../internals/to-integer":136}],134:[function(r,s,a){var i=r("../internals/to-integer"),l=r("../internals/to-length");s.exports=function(u){if(u===void 0)return 0;var u=i(u),f=l(u);if(u!==f)throw RangeError("Wrong length or index");return f}},{"../internals/to-integer":136,"../internals/to-length":137}],135:[function(r,s,a){var i=r("../internals/indexed-object"),l=r("../internals/require-object-coercible");s.exports=function(c){return i(l(c))}},{"../internals/indexed-object":67,"../internals/require-object-coercible":114}],136:[function(r,s,a){var i=Math.ceil,l=Math.floor;s.exports=function(c){return isNaN(c=+c)?0:(0<c?l:i)(c)}},{}],137:[function(r,s,a){var i=r("../internals/to-integer"),l=Math.min;s.exports=function(c){return 0<c?l(i(c),9007199254740991):0}},{"../internals/to-integer":136}],138:[function(r,s,a){var i=r("../internals/require-object-coercible");s.exports=function(l){return Object(i(l))}},{"../internals/require-object-coercible":114}],139:[function(r,s,a){var i=r("../internals/to-positive-integer");s.exports=function(l,c){if(l=i(l),l%c)throw RangeError("Wrong offset");return l}},{"../internals/to-positive-integer":140}],140:[function(r,s,a){var i=r("../internals/to-integer");s.exports=function(l){if(l=i(l),l<0)throw RangeError("The argument can't be less than 0");return l}},{"../internals/to-integer":136}],141:[function(r,s,a){var i=r("../internals/is-object");s.exports=function(l,c){if(!i(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!i(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!i(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!i(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":75}],142:[function(r,s,a){var i={};i[r("../internals/well-known-symbol")("toStringTag")]="z",s.exports=String(i)==="[object z]"},{"../internals/well-known-symbol":149}],143:[function(r,s,a){function i(we,_e){for(var Ae=0,$e=_e.length,Fe=new(oe(we))($e);Ae<$e;)Fe[Ae]=_e[Ae++];return Fe}function l(we,_e){B(we,_e,{get:function(){return ae(this)[_e]}})}function c(we){return we instanceof ne||(we=A(we))=="ArrayBuffer"||we=="SharedArrayBuffer"}function u(we,_e){return de(we)&&typeof _e!="symbol"&&_e in we&&String(+_e)==String(_e)}function f(we,_e){return u(we,_e=C(_e,!0))?x(2,we[_e]):W(we,_e)}function h(we,_e,Ae){return!(u(we,_e=C(_e,!0))&&I(Ae)&&P(Ae,"value"))||P(Ae,"get")||P(Ae,"set")||Ae.configurable||P(Ae,"writable")&&!Ae.writable||P(Ae,"enumerable")&&!Ae.enumerable?B(we,_e,Ae):(we[_e]=Ae.value,we)}var d=r("../internals/export"),p=r("../internals/global"),y=r("../internals/descriptors"),g=r("../internals/typed-array-constructors-require-wrappers"),b=r("../internals/array-buffer-view-core"),m=r("../internals/array-buffer"),v=r("../internals/an-instance"),x=r("../internals/create-property-descriptor"),w=r("../internals/create-non-enumerable-property"),S=r("../internals/to-length"),k=r("../internals/to-index"),_=r("../internals/to-offset"),C=r("../internals/to-primitive"),P=r("../internals/has"),A=r("../internals/classof"),I=r("../internals/is-object"),N=r("../internals/object-create"),O=r("../internals/object-set-prototype-of"),F=r("../internals/object-get-own-property-names").f,U=r("../internals/typed-array-from"),G=r("../internals/array-iteration").forEach,Y=r("../internals/set-species"),$=r("../internals/object-define-property"),H=r("../internals/object-get-own-property-descriptor"),Q=r("../internals/internal-state"),J=r("../internals/inherit-if-required"),ae=Q.get,T=Q.set,B=$.f,W=H.f,K=Math.round,te=p.RangeError,ne=m.ArrayBuffer,ce=m.DataView,fe=b.NATIVE_ARRAY_BUFFER_VIEWS,ue=b.TYPED_ARRAY_TAG,ge=b.TypedArray,me=b.TypedArrayPrototype,oe=b.aTypedArrayConstructor,de=b.isTypedArray,xe="BYTES_PER_ELEMENT",Ie="Wrong length";y?(fe||(H.f=f,$.f=h,l(me,"buffer"),l(me,"byteOffset"),l(me,"byteLength"),l(me,"length")),d({target:"Object",stat:!0,forced:!fe},{getOwnPropertyDescriptor:f,defineProperty:h}),s.exports=function(Ee,_e,Ae){function $e(Me,re){B(Me,re,{get:function(){var ie=this,ee=re;return(ie=ae(ie)).view[tt](ee*Fe+ie.byteOffset,!0)},set:function(ie){var ee=this,le=re;ee=ae(ee),Ae&&(ie=(ie=K(ie))<0?0:255<ie?255:255&ie),ee.view[rt](le*Fe+ee.byteOffset,ie,!0)},enumerable:!0})}var Fe=Ee.match(/\d+$/)[0]/8,ut=Ee+(Ae?"Clamped":"")+"Array",tt="get"+Ee,rt="set"+Ee,it=p[ut],nt=it,Ee=nt&&nt.prototype,Ve={};fe?g&&(nt=_e(function(Me,re,ie,ee){return v(Me,nt,ut),J(I(re)?c(re)?ee!==void 0?new it(re,_(ie,Fe),ee):ie!==void 0?new it(re,_(ie,Fe)):new it(re):de(re)?i(nt,re):U.call(nt,re):new it(k(re)),Me,nt)}),O&&O(nt,ge),G(F(it),function(Me){Me in nt||w(nt,Me,it[Me])}),nt.prototype=Ee):(nt=_e(function(Me,re,ie,ee){v(Me,nt,ut);var le,Se,Pe=0,Ue=0;if(I(re)){if(!c(re))return de(re)?i(nt,re):U.call(nt,re);var Xe=re,Ue=_(ie,Fe),ie=re.byteLength;if(ee===void 0){if(ie%Fe||(le=ie-Ue)<0)throw te(Ie)}else if(ie<(le=S(ee)*Fe)+Ue)throw te(Ie);Se=le/Fe}else Se=k(re),Xe=new ne(le=Se*Fe);for(T(Me,{buffer:Xe,byteOffset:Ue,byteLength:le,length:Se,view:new ce(Xe)});Pe<Se;)$e(Me,Pe++)}),O&&O(nt,ge),Ee=nt.prototype=N(me)),Ee.constructor!==nt&&w(Ee,"constructor",nt),ue&&w(Ee,ue,ut),Ve[ut]=nt,d({global:!0,forced:nt!=it,sham:!fe},Ve),xe in nt||w(nt,xe,Fe),xe in Ee||w(Ee,xe,Fe),Y(ut)}):s.exports=function(){}},{"../internals/an-instance":9,"../internals/array-buffer":13,"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/inherit-if-required":68,"../internals/internal-state":71,"../internals/is-object":75,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/object-set-prototype-of":102,"../internals/set-species":117,"../internals/to-index":134,"../internals/to-length":137,"../internals/to-offset":139,"../internals/to-primitive":141,"../internals/typed-array-constructors-require-wrappers":144,"../internals/typed-array-from":145}],144:[function(u,s,a){var i=u("../internals/global"),l=u("../internals/fails"),c=u("../internals/check-correctness-of-iteration"),u=u("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,f=i.ArrayBuffer,h=i.Int8Array;s.exports=!u||!l(function(){h(1)})||!l(function(){new h(-1)})||!c(function(d){new h,new h(null),new h(1.5),new h(d)},!0)||l(function(){return new h(new f(2),1,void 0).length!==1})},{"../internals/array-buffer-view-core":12,"../internals/check-correctness-of-iteration":27,"../internals/fails":51,"../internals/global":60}],145:[function(r,s,a){var i=r("../internals/to-object"),l=r("../internals/to-length"),c=r("../internals/get-iterator-method"),u=r("../internals/is-array-iterator-method"),f=r("../internals/function-bind-context"),h=r("../internals/array-buffer-view-core").aTypedArrayConstructor;s.exports=function(d){var p,y,g,b,m,v,x=i(d),w=arguments.length,S=1<w?arguments[1]:void 0,k=S!==void 0,_=c(x);if(_!=null&&!u(_))for(v=(m=_.call(x)).next,x=[];!(b=v.call(m)).done;)x.push(b.value);for(k&&2<w&&(S=f(S,arguments[2],2)),y=l(x.length),g=new(h(this))(y),p=0;p<y;p++)g[p]=k?S(x[p],p):x[p];return g}},{"../internals/array-buffer-view-core":12,"../internals/function-bind-context":55,"../internals/get-iterator-method":58,"../internals/is-array-iterator-method":72,"../internals/to-length":137,"../internals/to-object":138}],146:[function(r,s,a){var i=0,l=Math.random();s.exports=function(c){return"Symbol("+String(c===void 0?"":c)+")_"+(++i+l).toString(36)}},{}],147:[function(r,s,a){r=r("../internals/native-symbol"),s.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/native-symbol":84}],148:[function(r,s,a){r=r("../internals/well-known-symbol"),a.f=r},{"../internals/well-known-symbol":149}],149:[function(h,s,a){var i=h("../internals/global"),l=h("../internals/shared"),c=h("../internals/has"),u=h("../internals/uid"),f=h("../internals/native-symbol"),h=h("../internals/use-symbol-as-uid"),d=l("wks"),p=i.Symbol,y=h?p:p&&p.withoutSetter||u;s.exports=function(g){return c(d,g)||(f&&c(p,g)?d[g]=p[g]:d[g]=y("Symbol."+g)),d[g]}},{"../internals/global":60,"../internals/has":61,"../internals/native-symbol":84,"../internals/shared":121,"../internals/uid":146,"../internals/use-symbol-as-uid":147}],150:[function(r,s,a){s.exports=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},{}],151:[function(c,s,a){var i=c("../internals/export"),l=c("../internals/global"),f=c("../internals/array-buffer"),c=c("../internals/set-species"),u="ArrayBuffer",f=f[u];i({global:!0,forced:l[u]!==f},{ArrayBuffer:f}),c(u)},{"../internals/array-buffer":13,"../internals/export":50,"../internals/global":60,"../internals/set-species":117}],152:[function(x,s,a){var i=x("../internals/export"),l=x("../internals/fails"),c=x("../internals/is-array"),u=x("../internals/is-object"),f=x("../internals/to-object"),h=x("../internals/to-length"),d=x("../internals/create-property"),p=x("../internals/array-species-create"),y=x("../internals/array-method-has-species-support"),v=x("../internals/well-known-symbol"),x=x("../internals/engine-v8-version"),g=v("isConcatSpreadable"),b=9007199254740991,m="Maximum allowed index exceeded",v=51<=x||!l(function(){var w=[];return w[g]=!1,w.concat()[0]!==w}),x=y("concat");i({target:"Array",proto:!0,forced:!v||!x},{concat:function(w){for(var S,k,_,C,P,A=f(this),I=p(A,0),N=0,O=-1,F=arguments.length;O<F;O++)if(P=void 0,!u(C=_=O===-1?A:arguments[O])||((P=C[g])!==void 0?!P:!c(C))){if(b<=N)throw TypeError(m);d(I,N++,_)}else{if(k=h(_.length),b<N+k)throw TypeError(m);for(S=0;S<k;S++,N++)S in _&&d(I,N,_[S])}return I.length=N,I}})},{"../internals/array-method-has-species-support":21,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/fails":51,"../internals/is-array":73,"../internals/is-object":75,"../internals/to-length":137,"../internals/to-object":138,"../internals/well-known-symbol":149}],153:[function(c,s,a){var i=c("../internals/export"),l=c("../internals/array-copy-within"),c=c("../internals/add-to-unscopables");i({target:"Array",proto:!0},{copyWithin:l}),c("copyWithin")},{"../internals/add-to-unscopables":7,"../internals/array-copy-within":14,"../internals/export":50}],154:[function(u,s,a){var i=u("../internals/export"),l=u("../internals/array-iteration").every,c=u("../internals/array-method-is-strict"),u=u("../internals/array-method-uses-to-length"),c=c("every"),u=u("every");i({target:"Array",proto:!0,forced:!c||!u},{every:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],155:[function(c,s,a){var i=c("../internals/export"),l=c("../internals/array-fill"),c=c("../internals/add-to-unscopables");i({target:"Array",proto:!0},{fill:l}),c("fill")},{"../internals/add-to-unscopables":7,"../internals/array-fill":15,"../internals/export":50}],156:[function(u,s,a){var i=u("../internals/export"),l=u("../internals/array-iteration").filter,c=u("../internals/array-method-has-species-support"),u=u("../internals/array-method-uses-to-length"),c=c("filter"),u=u("filter");i({target:"Array",proto:!0,forced:!c||!u},{filter:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],157:[function(h,s,a){var i=h("../internals/export"),l=h("../internals/array-iteration").findIndex,c=h("../internals/add-to-unscopables"),h=h("../internals/array-method-uses-to-length"),u="findIndex",f=!0,h=h(u);u in[]&&Array(1)[u](function(){f=!1}),i({target:"Array",proto:!0,forced:f||!h},{findIndex:function(d){return l(this,d,1<arguments.length?arguments[1]:void 0)}}),c(u)},{"../internals/add-to-unscopables":7,"../internals/array-iteration":19,"../internals/array-method-uses-to-length":23,"../internals/export":50}],158:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/flatten-into-array"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/a-function"),h=r("../internals/array-species-create");i({target:"Array",proto:!0},{flatMap:function(d){var p,y=c(this),g=u(y.length);return f(d),(p=h(y,0)).length=l(p,y,y,g,0,1,d,1<arguments.length?arguments[1]:void 0),p}})},{"../internals/a-function":5,"../internals/array-species-create":25,"../internals/export":50,"../internals/flatten-into-array":53,"../internals/to-length":137,"../internals/to-object":138}],159:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/flatten-into-array"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/to-integer"),h=r("../internals/array-species-create");i({target:"Array",proto:!0},{flat:function(){var d=arguments.length?arguments[0]:void 0,p=c(this),y=u(p.length),g=h(p,0);return g.length=l(g,p,p,y,0,d===void 0?1:f(d)),g}})},{"../internals/array-species-create":25,"../internals/export":50,"../internals/flatten-into-array":53,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],160:[function(l,s,a){var i=l("../internals/export"),l=l("../internals/array-for-each");i({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},{"../internals/array-for-each":16,"../internals/export":50}],161:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/array-from");i({target:"Array",stat:!0,forced:!r("../internals/check-correctness-of-iteration")(function(c){Array.from(c)})},{from:l})},{"../internals/array-from":17,"../internals/check-correctness-of-iteration":27,"../internals/export":50}],162:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/array-includes").includes,c=r("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:!r("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(u){return l(this,u,1<arguments.length?arguments[1]:void 0)}}),c("includes")},{"../internals/add-to-unscopables":7,"../internals/array-includes":18,"../internals/array-method-uses-to-length":23,"../internals/export":50}],163:[function(h,s,a){var i=h("../internals/export"),l=h("../internals/array-includes").indexOf,f=h("../internals/array-method-is-strict"),h=h("../internals/array-method-uses-to-length"),c=[].indexOf,u=!!c&&1/[1].indexOf(1,-0)<0,f=f("indexOf"),h=h("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:u||!f||!h},{indexOf:function(d){return u?c.apply(this,arguments)||0:l(this,d,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-includes":18,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],164:[function(f,s,a){var i=f("../internals/to-indexed-object"),l=f("../internals/add-to-unscopables"),c=f("../internals/iterators"),u=f("../internals/internal-state"),f=f("../internals/define-iterator"),h="Array Iterator",d=u.set,p=u.getterFor(h);s.exports=f(Array,"Array",function(y,g){d(this,{type:h,target:i(y),index:0,kind:g})},function(){var y=p(this),g=y.target,b=y.kind,m=y.index++;return!g||m>=g.length?{value:y.target=void 0,done:!0}:b=="keys"?{value:m,done:!1}:b=="values"?{value:g[m],done:!1}:{value:[m,g[m]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},{"../internals/add-to-unscopables":7,"../internals/define-iterator":41,"../internals/internal-state":71,"../internals/iterators":80,"../internals/to-indexed-object":135}],165:[function(f,s,a){var i=f("../internals/export"),u=f("../internals/indexed-object"),l=f("../internals/to-indexed-object"),f=f("../internals/array-method-is-strict"),c=[].join,u=u!=Object,f=f("join",",");i({target:"Array",proto:!0,forced:u||!f},{join:function(h){return c.call(l(this),h===void 0?",":h)}})},{"../internals/array-method-is-strict":22,"../internals/export":50,"../internals/indexed-object":67,"../internals/to-indexed-object":135}],166:[function(l,s,a){var i=l("../internals/export"),l=l("../internals/array-last-index-of");i({target:"Array",proto:!0,forced:l!==[].lastIndexOf},{lastIndexOf:l})},{"../internals/array-last-index-of":20,"../internals/export":50}],167:[function(u,s,a){var i=u("../internals/export"),l=u("../internals/array-iteration").map,c=u("../internals/array-method-has-species-support"),u=u("../internals/array-method-uses-to-length"),c=c("map"),u=u("map");i({target:"Array",proto:!0,forced:!c||!u},{map:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],168:[function(g,s,a){var i=g("../internals/export"),l=g("../internals/is-object"),c=g("../internals/is-array"),u=g("../internals/to-absolute-index"),f=g("../internals/to-length"),h=g("../internals/to-indexed-object"),d=g("../internals/create-property"),p=g("../internals/well-known-symbol"),y=g("../internals/array-method-has-species-support"),g=g("../internals/array-method-uses-to-length"),y=y("slice"),g=g("slice",{ACCESSORS:!0,0:0,1:2}),b=p("species"),m=[].slice,v=Math.max;i({target:"Array",proto:!0,forced:!y||!g},{slice:function(x,w){var S,k,_,C=h(this),P=f(C.length),A=u(x,P),I=u(w===void 0?P:w,P);if(c(C)&&((S=typeof(S=C.constructor)=="function"&&(S===Array||c(S.prototype))||l(S)&&(S=S[b])===null?void 0:S)===Array||S===void 0))return m.call(C,A,I);for(k=new(S===void 0?Array:S)(v(I-A,0)),_=0;A<I;A++,_++)A in C&&d(k,_,C[A]);return k.length=_,k}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/create-property":40,"../internals/export":50,"../internals/is-array":73,"../internals/is-object":75,"../internals/to-absolute-index":133,"../internals/to-indexed-object":135,"../internals/to-length":137,"../internals/well-known-symbol":149}],169:[function(u,s,a){var i=u("../internals/export"),l=u("../internals/array-iteration").some,c=u("../internals/array-method-is-strict"),u=u("../internals/array-method-uses-to-length"),c=c("some"),u=u("some");i({target:"Array",proto:!0,forced:!c||!u},{some:function(f){return l(this,f,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],170:[function(y,s,a){var i=y("../internals/export"),l=y("../internals/to-absolute-index"),c=y("../internals/to-integer"),u=y("../internals/to-length"),f=y("../internals/to-object"),h=y("../internals/array-species-create"),d=y("../internals/create-property"),p=y("../internals/array-method-has-species-support"),y=y("../internals/array-method-uses-to-length"),p=p("splice"),y=y("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,b=Math.min;i({target:"Array",proto:!0,forced:!p||!y},{splice:function(N,v){var x,w,S,k,_,C,P=f(this),A=u(P.length),I=l(N,A),N=arguments.length;if(N===0?x=w=0:w=N===1?(x=0,A-I):(x=N-2,b(g(c(v),0),A-I)),9007199254740991<A+x-w)throw TypeError("Maximum allowed length exceeded");for(S=h(P,w),k=0;k<w;k++)(_=I+k)in P&&d(S,k,P[_]);if(x<(S.length=w)){for(k=I;k<A-w;k++)C=k+x,(_=k+w)in P?P[C]=P[_]:delete P[C];for(k=A;A-w+x<k;k--)delete P[k-1]}else if(w<x)for(k=A-w;I<k;k--)C=k+x-1,(_=k+w-1)in P?P[C]=P[_]:delete P[C];for(k=0;k<x;k++)P[k+I]=arguments[k+2];return P.length=A-w+x,S}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/export":50,"../internals/to-absolute-index":133,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],171:[function(r,s,a){r("../internals/add-to-unscopables")("flatMap")},{"../internals/add-to-unscopables":7}],172:[function(r,s,a){r("../internals/add-to-unscopables")("flat")},{"../internals/add-to-unscopables":7}],173:[function(l,s,a){var i=l("../internals/descriptors"),l=l("../internals/object-define-property").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/;!i||"name"in c||l(c,"name",{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},{"../internals/descriptors":43,"../internals/object-define-property":93}],174:[function(l,s,a){var i=l("../internals/collection"),l=l("../internals/collection-strong");s.exports=i("Map",function(c){return function(){return c(this,arguments.length?arguments[0]:void 0)}},l)},{"../internals/collection":32,"../internals/collection-strong":30}],175:[function(i,s,a){var i=i("../internals/export"),l=Math.hypot,c=Math.abs,u=Math.sqrt;i({target:"Math",stat:!0,forced:!!l&&l(1/0,NaN)!==1/0},{hypot:function(f,h){for(var d,p,y=0,g=0,b=arguments.length,m=0;g<b;)m<(d=c(arguments[g++]))?(y=y*(p=m/d)*p+1,m=d):y+=0<d?(p=d/m)*p:d;return m===1/0?1/0:m*u(y)}})},{"../internals/export":50}],176:[function(i,s,a){var i=i("../internals/export"),l=Math.log,c=Math.LN2;i({target:"Math",stat:!0},{log2:function(u){return l(u)/c}})},{"../internals/export":50}],177:[function(r,s,a){r("../internals/export")({target:"Math",stat:!0},{sign:r("../internals/math-sign")})},{"../internals/export":50,"../internals/math-sign":81}],178:[function(r,s,a){function i(O){var F,U,G,Y,$,H,Q,J=y(O,!1);if(typeof J=="string"&&2<J.length){if((O=(J=w(J)).charCodeAt(0))===43||O===45){if((F=J.charCodeAt(2))===88||F===120)return NaN}else if(O===48){switch(J.charCodeAt(1)){case 66:case 98:U=2,G=49;break;case 79:case 111:U=8,G=55;break;default:return+J}for($=(Y=J.slice(2)).length,H=0;H<$;H++)if((Q=Y.charCodeAt(H))<48||G<Q)return NaN;return parseInt(Y,U)}}return+J}var l=r("../internals/descriptors"),c=r("../internals/global"),u=r("../internals/is-forced"),f=r("../internals/redefine"),h=r("../internals/has"),d=r("../internals/classof-raw"),p=r("../internals/inherit-if-required"),y=r("../internals/to-primitive"),g=r("../internals/fails"),b=r("../internals/object-create"),m=r("../internals/object-get-own-property-names").f,v=r("../internals/object-get-own-property-descriptor").f,x=r("../internals/object-define-property").f,w=r("../internals/string-trim").trim,S="Number",k=c[S],_=k.prototype,C=d(b(_))==S;if(u(S,!k(" 0o1")||!k("0b1")||k("+0x1"))){for(var P,A=function(F){var F=arguments.length<1?0:F,U=this;return U instanceof A&&(C?g(function(){_.valueOf.call(U)}):d(U)!=S)?p(new k(i(F)),U,A):i(F)},I=l?m(k):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;I.length>N;N++)h(k,P=I[N])&&!h(A,P)&&x(A,P,v(k,P));(A.prototype=_).constructor=A,f(c,S,A)}},{"../internals/classof-raw":28,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/has":61,"../internals/inherit-if-required":68,"../internals/is-forced":74,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/redefine":109,"../internals/string-trim":130,"../internals/to-primitive":141}],179:[function(r,s,a){r("../internals/export")({target:"Number",stat:!0},{isFinite:r("../internals/number-is-finite")})},{"../internals/export":50,"../internals/number-is-finite":89}],180:[function(h,s,a){function i(y,g,b){return g===0?b:g%2==1?i(y,g-1,b*y):i(y*y,g/2,b)}var l=h("../internals/export"),c=h("../internals/to-integer"),u=h("../internals/this-number-value"),f=h("../internals/string-repeat"),h=h("../internals/fails"),d=1 .toFixed,p=Math.floor;l({target:"Number",proto:!0,forced:d&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!h(function(){d.call({})})},{toFixed:function(S){function g(P,A){for(var I=-1,N=A;++I<6;)N+=P*k[I],k[I]=N%1e7,N=p(N/1e7)}function b(P){for(var A=6,I=0;0<=--A;)I+=k[A],k[A]=p(I/P),I=I%P*1e7}function m(){for(var P,A=6,I="";0<=--A;)I===""&&A!==0&&k[A]===0||(P=String(k[A]),I=I===""?P:I+f.call("0",7-P.length)+P);return I}var v,x,w=u(this),S=c(S),k=[0,0,0,0,0,0],_="",C="0";if(S<0||20<S)throw RangeError("Incorrect fraction digits");if(w!=w)return"NaN";if(w<=-1e21||1e21<=w)return String(w);if(w<0&&(_="-",w=-w),1e-21<w)if(w=(v=function(P){for(var A=0,I=P;4096<=I;)A+=12,I/=4096;for(;2<=I;)A+=1,I/=2;return A}(w*i(2,69,1))-69)<0?w*i(2,-v,1):w/i(2,v,1),w*=4503599627370496,0<(v=52-v)){for(g(0,w),x=S;7<=x;)g(1e7,0),x-=7;for(g(i(10,x,1),0),x=v-1;23<=x;)b(1<<23),x-=23;b(1<<x),g(1,1),b(2),C=m()}else g(0,w),g(1<<-v,0),C=m()+f.call("0",S);return C=0<S?_+((w=C.length)<=S?"0."+f.call("0",S-w)+C:C.slice(0,w-S)+"."+C.slice(w-S)):_+C}})},{"../internals/export":50,"../internals/fails":51,"../internals/string-repeat":128,"../internals/this-number-value":132,"../internals/to-integer":136}],181:[function(l,s,a){var i=l("../internals/export"),l=l("../internals/object-assign");i({target:"Object",stat:!0,forced:Object.assign!==l},{assign:l})},{"../internals/export":50,"../internals/object-assign":90}],182:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/iterate"),c=r("../internals/create-property");i({target:"Object",stat:!0},{fromEntries:function(u){var f={};return l(u,function(h,d){c(f,h,d)},void 0,!0),f}})},{"../internals/create-property":40,"../internals/export":50,"../internals/iterate":78}],183:[function(u,s,a){var i=u("../internals/export"),f=u("../internals/fails"),l=u("../internals/to-indexed-object"),c=u("../internals/object-get-own-property-descriptor").f,u=u("../internals/descriptors"),f=f(function(){c(1)});i({target:"Object",stat:!0,forced:!u||f,sham:!u},{getOwnPropertyDescriptor:function(h,d){return c(l(h),d)}})},{"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-descriptor":94,"../internals/to-indexed-object":135}],184:[function(c,s,a){var i=c("../internals/export"),l=c("../internals/fails"),c=c("../internals/object-get-own-property-names-external").f;i({target:"Object",stat:!0,forced:l(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:c})},{"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-names-external":95}],185:[function(f,s,a){var i=f("../internals/export"),l=f("../internals/fails"),c=f("../internals/to-object"),u=f("../internals/object-get-prototype-of"),f=f("../internals/correct-prototype-getter");i({target:"Object",stat:!0,forced:l(function(){u(1)}),sham:!f},{getPrototypeOf:function(h){return u(c(h))}})},{"../internals/correct-prototype-getter":35,"../internals/export":50,"../internals/fails":51,"../internals/object-get-prototype-of":98,"../internals/to-object":138}],186:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/to-object"),c=r("../internals/object-keys");i({target:"Object",stat:!0,forced:r("../internals/fails")(function(){c(1)})},{keys:function(u){return c(l(u))}})},{"../internals/export":50,"../internals/fails":51,"../internals/object-keys":100,"../internals/to-object":138}],187:[function(c,s,a){var i=c("../internals/to-string-tag-support"),l=c("../internals/redefine"),c=c("../internals/object-to-string");i||l(Object.prototype,"toString",c,{unsafe:!0})},{"../internals/object-to-string":103,"../internals/redefine":109,"../internals/to-string-tag-support":142}],188:[function(Ae,s,a){var i,l,c,u,f=Ae("../internals/export"),h=Ae("../internals/is-pure"),d=Ae("../internals/global"),p=Ae("../internals/get-built-in"),y=Ae("../internals/native-promise-constructor"),g=Ae("../internals/redefine"),b=Ae("../internals/redefine-all"),m=Ae("../internals/set-to-string-tag"),v=Ae("../internals/set-species"),x=Ae("../internals/is-object"),w=Ae("../internals/a-function"),S=Ae("../internals/an-instance"),k=Ae("../internals/classof-raw"),_=Ae("../internals/inspect-source"),C=Ae("../internals/iterate"),P=Ae("../internals/check-correctness-of-iteration"),A=Ae("../internals/species-constructor"),I=Ae("../internals/task").set,N=Ae("../internals/microtask"),O=Ae("../internals/promise-resolve"),F=Ae("../internals/host-report-errors"),U=Ae("../internals/new-promise-capability"),G=Ae("../internals/perform"),Y=Ae("../internals/internal-state"),$=Ae("../internals/is-forced"),$e=Ae("../internals/well-known-symbol"),H=Ae("../internals/engine-v8-version"),Q=$e("species"),J="Promise",ae=Y.get,T=Y.set,B=Y.getterFor(J),W=y,K=d.TypeError,te=d.document,ne=d.process,ce=p("fetch"),fe=U.f,ue=fe,ge=k(ne)=="process",me=!!(te&&te.createEvent&&d.dispatchEvent),oe="unhandledrejection",de="rejectionhandled",xe=1,Ie=2,we=1,_e=2,Ae=$(J,function(){var Ve,Me;return _(W)===String(W)&&(H===66||!ge&&typeof PromiseRejectionEvent!="function")?!0:!(!h||W.prototype.finally)||!(51<=H&&/native code/.test(W))&&(Me=function(re){re(function(){},function(){})},((Ve=W.resolve(1)).constructor={})[Q]=Me,!(Ve.then(function(){})instanceof Me))}),$e=Ae||!P(function(Ve){W.all(Ve).catch(function(){})}),Fe=function(Ve){var Me;return!(!x(Ve)||typeof(Me=Ve.then)!="function")&&Me},ut=function(Ve,Me,re){var ie;Me.notified||(Me.notified=!0,ie=Me.reactions,N(function(){for(var ee,le,Se=Me.value,Pe=Me.state==xe,Ue=0;ie.length>Ue;){var Xe,Ze,et,at=ie[Ue++],At=Pe?at.ok:at.fail,Et=at.resolve,dt=at.reject,Ct=at.domain;try{At?(Pe||(Me.rejection===_e&&function(kt,rr){I.call(d,function(){ge?ne.emit("rejectionHandled",kt):tt(de,kt,rr.value)})}(Ve,Me),Me.rejection=we),At===!0?Xe=Se:(Ct&&Ct.enter(),Xe=At(Se),Ct&&(Ct.exit(),et=!0)),Xe===at.promise?dt(K("Promise-chain cycle")):(Ze=Fe(Xe))?Ze.call(Xe,Et,dt):Et(Xe)):dt(Se)}catch(kt){Ct&&!et&&Ct.exit(),dt(kt)}}Me.reactions=[],Me.notified=!1,re&&!Me.rejection&&(ee=Ve,le=Me,I.call(d,function(){var kt=le.value,rr=rt(le);if(rr&&(rr=G(function(){ge?ne.emit("unhandledRejection",kt,ee):tt(oe,ee,kt)}),le.rejection=ge||rt(le)?_e:we,rr.error))throw rr.value}))}))},tt=function(Ve,Me,re){var ie;me?((ie=te.createEvent("Event")).promise=Me,ie.reason=re,ie.initEvent(Ve,!1,!0),d.dispatchEvent(ie)):ie={promise:Me,reason:re},(Me=d["on"+Ve])?Me(ie):Ve===oe&&F("Unhandled promise rejection",re)},rt=function(Ve){return Ve.rejection!==we&&!Ve.parent},it=function(Ve,Me,re,ie){return function(ee){Ve(Me,re,ee,ie)}},nt=function(Ve,Me,re,ie){Me.done||(Me.done=!0,(Me=ie||Me).value=re,Me.state=Ie,ut(Ve,Me,!0))},Ee=function(Ve,Me,re,ie){if(!Me.done){Me.done=!0,ie&&(Me=ie);try{if(Ve===re)throw K("Promise can't be resolved itself");var ee=Fe(re);ee?N(function(){var le={done:!1};try{ee.call(re,it(Ee,Ve,le,Me),it(nt,Ve,le,Me))}catch(Se){nt(Ve,le,Se,Me)}}):(Me.value=re,Me.state=xe,ut(Ve,Me,!1))}catch(le){nt(Ve,{done:!1},le,Me)}}};Ae&&(W=function(Ve){S(this,W,J),w(Ve),i.call(this);var Me=ae(this);try{Ve(it(Ee,this,Me),it(nt,this,Me))}catch(re){nt(this,Me,re)}},(i=function(Ve){T(this,{type:J,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=b(W.prototype,{then:function(Ve,Me){var re=B(this),ie=fe(A(this,W));return ie.ok=typeof Ve!="function"||Ve,ie.fail=typeof Me=="function"&&Me,ie.domain=ge?ne.domain:void 0,re.parent=!0,re.reactions.push(ie),re.state!=0&&ut(this,re,!1),ie.promise},catch:function(Ve){return this.then(void 0,Ve)}}),l=function(){var Ve=new i,Me=ae(Ve);this.promise=Ve,this.resolve=it(Ee,Ve,Me),this.reject=it(nt,Ve,Me)},U.f=fe=function(Ve){return Ve===W||Ve===c?new l:ue(Ve)},h||typeof y!="function"||(u=y.prototype.then,g(y.prototype,"then",function(Ve,Me){var re=this;return new W(function(ie,ee){u.call(re,ie,ee)}).then(Ve,Me)},{unsafe:!0}),typeof ce=="function"&&f({global:!0,enumerable:!0,forced:!0},{fetch:function(Ve){return O(W,ce.apply(d,arguments))}}))),f({global:!0,wrap:!0,forced:Ae},{Promise:W}),m(W,J,!1,!0),v(J),c=p(J),f({target:J,stat:!0,forced:Ae},{reject:function(Ve){var Me=fe(this);return Me.reject.call(void 0,Ve),Me.promise}}),f({target:J,stat:!0,forced:h||Ae},{resolve:function(Ve){return O(h&&this===c?W:this,Ve)}}),f({target:J,stat:!0,forced:$e},{all:function(Ve){var Me=this,re=fe(Me),ie=re.resolve,ee=re.reject,le=G(function(){var Se=w(Me.resolve),Pe=[],Ue=0,Xe=1;C(Ve,function(Ze){var et=Ue++,at=!1;Pe.push(void 0),Xe++,Se.call(Me,Ze).then(function(At){at||(at=!0,Pe[et]=At,--Xe||ie(Pe))},ee)}),--Xe||ie(Pe)});return le.error&&ee(le.value),re.promise},race:function(Ve){var Me=this,re=fe(Me),ie=re.reject,ee=G(function(){var le=w(Me.resolve);C(Ve,function(Se){le.call(Me,Se).then(re.resolve,ie)})});return ee.error&&ie(ee.value),re.promise}})},{"../internals/a-function":5,"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/classof-raw":28,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/get-built-in":57,"../internals/global":60,"../internals/host-report-errors":63,"../internals/inspect-source":69,"../internals/internal-state":71,"../internals/is-forced":74,"../internals/is-object":75,"../internals/is-pure":76,"../internals/iterate":78,"../internals/microtask":82,"../internals/native-promise-constructor":83,"../internals/new-promise-capability":87,"../internals/perform":106,"../internals/promise-resolve":107,"../internals/redefine":109,"../internals/redefine-all":108,"../internals/set-species":117,"../internals/set-to-string-tag":118,"../internals/species-constructor":122,"../internals/task":131,"../internals/well-known-symbol":149}],189:[function(d,s,a){var i=d("../internals/export"),b=d("../internals/get-built-in"),l=d("../internals/a-function"),c=d("../internals/an-object"),u=d("../internals/is-object"),f=d("../internals/object-create"),h=d("../internals/function-bind"),d=d("../internals/fails"),p=b("Reflect","construct"),y=d(function(){function m(){}return!(p(function(){},[],m)instanceof m)}),g=!d(function(){p(function(){})}),b=y||g;i({target:"Reflect",stat:!0,forced:b,sham:b},{construct:function(m,v){l(m),c(v);var x=arguments.length<3?m:l(arguments[2]);if(g&&!y)return p(m,v,x);if(m==x){switch(v.length){case 0:return new m;case 1:return new m(v[0]);case 2:return new m(v[0],v[1]);case 3:return new m(v[0],v[1],v[2]);case 4:return new m(v[0],v[1],v[2],v[3])}var w=[null];return w.push.apply(w,v),new(h.apply(m,w))}return w=x.prototype,x=f(u(w)?w:Object.prototype),w=Function.apply.call(m,x,v),u(w)?w:x}})},{"../internals/a-function":5,"../internals/an-object":10,"../internals/export":50,"../internals/fails":51,"../internals/function-bind":56,"../internals/get-built-in":57,"../internals/is-object":75,"../internals/object-create":91}],190:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/is-object"),c=r("../internals/an-object"),u=r("../internals/has"),f=r("../internals/object-get-own-property-descriptor"),h=r("../internals/object-get-prototype-of");i({target:"Reflect",stat:!0},{get:function d(p,y){var g,b=arguments.length<3?p:arguments[2];return c(p)===b?p[y]:(g=f.f(p,y))?u(g,"value")?g.value:g.get===void 0?void 0:g.get.call(b):l(g=h(p))?d(g,y,b):void 0}})},{"../internals/an-object":10,"../internals/export":50,"../internals/has":61,"../internals/is-object":75,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-prototype-of":98}],191:[function(r,s,a){var i=r("../internals/descriptors"),l=r("../internals/global"),c=r("../internals/is-forced"),u=r("../internals/inherit-if-required"),f=r("../internals/object-define-property").f,h=r("../internals/object-get-own-property-names").f,d=r("../internals/is-regexp"),p=r("../internals/regexp-flags"),y=r("../internals/regexp-sticky-helpers"),g=r("../internals/redefine"),b=r("../internals/fails"),m=r("../internals/internal-state").set,v=r("../internals/set-species"),x=r("../internals/well-known-symbol")("match"),w=l.RegExp,S=w.prototype,k=/a/g,_=/a/g,C=new w(k)!==k,P=y.UNSUPPORTED_Y;if(i&&c("RegExp",!C||P||b(function(){return _[x]=!1,w(k)!=k||w(_)==_||w(k,"i")!="/a/i"}))){for(var A=function(O,F){var U,G=this instanceof A,Y=d(O),$=F===void 0;return!G&&Y&&O.constructor===A&&$?O:(C?Y&&!$&&(O=O.source):O instanceof A&&($&&(F=p.call(O)),O=O.source),P&&(U=!!F&&-1<F.indexOf("y"))&&(F=F.replace(/y/g,"")),Y=u(C?new w(O,F):w(O,F),G?this:S,A),P&&U&&m(Y,{sticky:U}),Y)},I=h(w),N=0;I.length>N;)(function(O){O in A||f(A,O,{configurable:!0,get:function(){return w[O]},set:function(F){w[O]=F}})})(I[N++]);(S.constructor=A).prototype=S,g(l,"RegExp",A)}v("RegExp")},{"../internals/descriptors":43,"../internals/fails":51,"../internals/global":60,"../internals/inherit-if-required":68,"../internals/internal-state":71,"../internals/is-forced":74,"../internals/is-regexp":77,"../internals/object-define-property":93,"../internals/object-get-own-property-names":96,"../internals/redefine":109,"../internals/regexp-flags":112,"../internals/regexp-sticky-helpers":113,"../internals/set-species":117,"../internals/well-known-symbol":149}],192:[function(l,s,a){var i=l("../internals/export"),l=l("../internals/regexp-exec");i({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},{"../internals/export":50,"../internals/regexp-exec":111}],193:[function(u,s,a){var i=u("../internals/redefine"),l=u("../internals/an-object"),d=u("../internals/fails"),c=u("../internals/regexp-flags"),u="toString",f=RegExp.prototype,h=f[u],d=d(function(){return h.call({source:"a",flags:"b"})!="/a/b"}),p=h.name!=u;(d||p)&&i(RegExp.prototype,u,function(){var y=l(this),g=String(y.source),b=y.flags;return"/"+g+"/"+String(b===void 0&&y instanceof RegExp&&!("flags"in f)?c.call(y):b)},{unsafe:!0})},{"../internals/an-object":10,"../internals/fails":51,"../internals/redefine":109,"../internals/regexp-flags":112}],194:[function(l,s,a){var i=l("../internals/collection"),l=l("../internals/collection-strong");s.exports=i("Set",function(c){return function(){return c(this,arguments.length?arguments[0]:void 0)}},l)},{"../internals/collection":32,"../internals/collection-strong":30}],195:[function(h,s,a){var i=h("../internals/export"),l=h("../internals/object-get-own-property-descriptor").f,c=h("../internals/to-length"),u=h("../internals/not-a-regexp"),f=h("../internals/require-object-coercible"),y=h("../internals/correct-is-regexp-logic"),h=h("../internals/is-pure"),d="".endsWith,p=Math.min,y=y("endsWith");i({target:"String",proto:!0,forced:!!(h||y||!(i=l(String.prototype,"endsWith"))||i.writable)&&!y},{endsWith:function(g){var b=String(f(this)),m=(u(g),1<arguments.length?arguments[1]:void 0),v=c(b.length),m=m===void 0?v:p(c(m),v),v=String(g);return d?d.call(b,v,m):b.slice(m-v.length,m)===v}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":76,"../internals/not-a-regexp":88,"../internals/object-get-own-property-descriptor":94,"../internals/require-object-coercible":114,"../internals/to-length":137}],196:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/not-a-regexp"),c=r("../internals/require-object-coercible");i({target:"String",proto:!0,forced:!r("../internals/correct-is-regexp-logic")("includes")},{includes:function(u){return!!~String(c(this)).indexOf(l(u),1<arguments.length?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/not-a-regexp":88,"../internals/require-object-coercible":114}],197:[function(c,s,a){var i=c("../internals/string-multibyte").charAt,l=c("../internals/internal-state"),c=c("../internals/define-iterator"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(d){f(this,{type:u,string:String(d),index:0})},function(){var d=h(this),p=d.string,y=d.index;return y>=p.length?{value:void 0,done:!0}:(p=i(p,y),d.index+=p.length,{value:p,done:!1})})},{"../internals/define-iterator":41,"../internals/internal-state":71,"../internals/string-multibyte":124}],198:[function(r,s,a){var i=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/to-length"),u=r("../internals/require-object-coercible"),f=r("../internals/advance-string-index"),h=r("../internals/regexp-exec-abstract");i("match",1,function(d,p,y){return[function(g){var b=u(this),m=g==null?void 0:g[d];return m!==void 0?m.call(g,b):new RegExp(g)[d](String(b))},function(g){var b=y(p,g,this);if(b.done)return b.value;var m=l(g),v=String(this);if(!m.global)return h(m,v);for(var x=m.unicode,w=[],S=m.lastIndex=0;(k=h(m,v))!==null;){var k=String(k[0]);(w[S]=k)===""&&(m.lastIndex=f(v,c(m.lastIndex),x)),S++}return S===0?null:w}]})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/to-length":137}],199:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/string-pad").start;i({target:"String",proto:!0,forced:r("../internals/string-pad-webkit-bug")},{padStart:function(c){return l(this,c,1<arguments.length?arguments[1]:void 0)}})},{"../internals/export":50,"../internals/string-pad":126,"../internals/string-pad-webkit-bug":125}],200:[function(r,s,a){r("../internals/export")({target:"String",proto:!0},{repeat:r("../internals/string-repeat")})},{"../internals/export":50,"../internals/string-repeat":128}],201:[function(r,s,a){var i=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/to-object"),u=r("../internals/to-length"),f=r("../internals/to-integer"),h=r("../internals/require-object-coercible"),d=r("../internals/advance-string-index"),p=r("../internals/regexp-exec-abstract"),y=Math.max,g=Math.min,b=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;i("replace",2,function(x,w,S,k){var _=k.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,C=k.REPLACE_KEEPS_$0,P=_?"$":"$0";return[function(A,I){var N=h(this),O=A==null?void 0:A[x];return O!==void 0?O.call(A,N,I):w.call(String(N),A,I)},function(A,I){if(!_&&C||typeof I=="string"&&I.indexOf(P)===-1){var N=S(w,A,this,I);if(N.done)return N.value}for(var O,F=l(A),U=String(this),G=typeof I=="function",Y=(G||(I=String(I)),F.global),$=(Y&&(O=F.unicode,F.lastIndex=0),[]);(T=p(F,U))!==null&&($.push(T),Y);)String(T[0])===""&&(F.lastIndex=d(U,u(F.lastIndex),O));for(var H,Q="",J=0,ae=0;ae<$.length;ae++){for(var T=$[ae],B=String(T[0]),W=y(g(f(T.index),U.length),0),K=[],te=1;te<T.length;te++)K.push((H=T[te])===void 0?H:String(H));var ne=T.groups,ce=G?(ce=[B].concat(K,W,U),ne!==void 0&&ce.push(ne),String(I.apply(void 0,ce))):function(fe,ue,ge,me,oe,de){var xe=ge+fe.length,Ie=me.length,we=v;return oe!==void 0&&(oe=c(oe),we=m),w.call(de,we,function(_e,Ae){var $e;switch(Ae.charAt(0)){case"$":return"$";case"&":return fe;case"`":return ue.slice(0,ge);case"'":return ue.slice(xe);case"<":$e=oe[Ae.slice(1,-1)];break;default:var Fe,ut=+Ae;if(ut==0)return _e;if(Ie<ut)return(Fe=b(ut/10))!==0&&Fe<=Ie?me[Fe-1]===void 0?Ae.charAt(1):me[Fe-1]+Ae.charAt(1):_e;$e=me[ut-1]}return $e===void 0?"":$e})}(B,U,W,K,ne,I);J<=W&&(Q+=U.slice(J,W)+ce,J=W+B.length)}return Q+U.slice(J)}]})},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/to-integer":136,"../internals/to-length":137,"../internals/to-object":138}],202:[function(r,s,a){var i=r("../internals/fix-regexp-well-known-symbol-logic"),l=r("../internals/an-object"),c=r("../internals/require-object-coercible"),u=r("../internals/same-value"),f=r("../internals/regexp-exec-abstract");i("search",1,function(h,d,p){return[function(y){var g=c(this),b=y==null?void 0:y[h];return b!==void 0?b.call(y,g):new RegExp(y)[h](String(g))},function(y){var g,b=p(d,y,this);return b.done?b.value:(b=l(y),y=String(this),g=b.lastIndex,u(g,0)||(b.lastIndex=0),y=f(b,y),u(b.lastIndex,g)||(b.lastIndex=g),y===null?-1:y.index)}]})},{"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/same-value":115}],203:[function(g,s,a){var i=g("../internals/fix-regexp-well-known-symbol-logic"),l=g("../internals/is-regexp"),c=g("../internals/an-object"),u=g("../internals/require-object-coercible"),f=g("../internals/species-constructor"),h=g("../internals/advance-string-index"),d=g("../internals/to-length"),p=g("../internals/regexp-exec-abstract"),y=g("../internals/regexp-exec"),g=g("../internals/fails"),b=[].push,m=Math.min,v=4294967295,x=!g(function(){return!RegExp(v,"y")});i("split",2,function(w,S,k){var _="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(C,P){var A=String(u(this)),I=P===void 0?v:P>>>0;if(I==0)return[];if(C===void 0)return[A];if(!l(C))return S.call(A,C,I);for(var N,O,F,U=[],P=(C.ignoreCase?"i":"")+(C.multiline?"m":"")+(C.unicode?"u":"")+(C.sticky?"y":""),G=0,Y=new RegExp(C.source,P+"g");(N=y.call(Y,A))&&!(G<(O=Y.lastIndex)&&(U.push(A.slice(G,N.index)),1<N.length&&N.index<A.length&&b.apply(U,N.slice(1)),F=N[0].length,G=O,U.length>=I));)Y.lastIndex===N.index&&Y.lastIndex++;return G===A.length?!F&&Y.test("")||U.push(""):U.push(A.slice(G)),U.length>I?U.slice(0,I):U}:"0".split(void 0,0).length?function(C,P){return C===void 0&&P===0?[]:S.call(this,C,P)}:S;return[function(C,P){var A=u(this),I=C==null?void 0:C[w];return I!==void 0?I.call(C,A,P):_.call(String(A),C,P)},function(N,P){var A=k(_,N,this,P,_!==S);if(A.done)return A.value;var A=c(N),I=String(this),N=f(A,RegExp),O=A.unicode,F=(A.ignoreCase?"i":"")+(A.multiline?"m":"")+(A.unicode?"u":"")+(x?"y":"g"),U=new N(x?A:"^(?:"+A.source+")",F),G=P===void 0?v:P>>>0;if(G==0)return[];if(I.length===0)return p(U,I)===null?[I]:[];for(var Y=0,$=0,H=[];$<I.length;){U.lastIndex=x?$:0;var Q,J=p(U,x?I:I.slice($));if(J===null||(Q=m(d(U.lastIndex+(x?0:$)),I.length))===Y)$=h(I,$,O);else{if(H.push(I.slice(Y,$)),H.length===G)return H;for(var ae=1;ae<=J.length-1;ae++)if(H.push(J[ae]),H.length===G)return H;$=Y=Q}}return H.push(I.slice(Y)),H}]},!x)},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fails":51,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/is-regexp":77,"../internals/regexp-exec":111,"../internals/regexp-exec-abstract":110,"../internals/require-object-coercible":114,"../internals/species-constructor":122,"../internals/to-length":137}],204:[function(h,s,a){var i=h("../internals/export"),l=h("../internals/object-get-own-property-descriptor").f,c=h("../internals/to-length"),u=h("../internals/not-a-regexp"),f=h("../internals/require-object-coercible"),y=h("../internals/correct-is-regexp-logic"),h=h("../internals/is-pure"),d="".startsWith,p=Math.min,y=y("startsWith");i({target:"String",proto:!0,forced:!!(h||y||!(i=l(String.prototype,"startsWith"))||i.writable)&&!y},{startsWith:function(v){var b=String(f(this)),m=(u(v),c(p(1<arguments.length?arguments[1]:void 0,b.length))),v=String(v);return d?d.call(b,v,m):b.slice(m,m+v.length)===v}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":76,"../internals/not-a-regexp":88,"../internals/object-get-own-property-descriptor":94,"../internals/require-object-coercible":114,"../internals/to-length":137}],205:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/create-html");i({target:"String",proto:!0,forced:r("../internals/string-html-forced")("sub")},{sub:function(){return l(this,"sub","","")}})},{"../internals/create-html":36,"../internals/export":50,"../internals/string-html-forced":123}],206:[function(r,s,a){var i=r("../internals/export"),l=r("../internals/string-trim").trim;i({target:"String",proto:!0,forced:r("../internals/string-trim-forced")("trim")},{trim:function(){return l(this)}})},{"../internals/export":50,"../internals/string-trim":130,"../internals/string-trim-forced":129}],207:[function(m,s,a){var i,l,c,u,f,h=m("../internals/export"),d=m("../internals/descriptors"),p=m("../internals/global"),y=m("../internals/has"),g=m("../internals/is-object"),b=m("../internals/object-define-property").f,m=m("../internals/copy-constructor-properties"),v=p.Symbol;!d||typeof v!="function"||"description"in v.prototype&&v().description===void 0||(i={},m(l=function(){var x=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),w=this instanceof l?new v(x):x===void 0?v():v(x);return x===""&&(i[w]=!0),w},v),(p=l.prototype=v.prototype).constructor=l,c=p.toString,u=String(v("test"))=="Symbol(test)",f=/^Symbol\((.*)\)[^)]+$/,b(p,"description",{configurable:!0,get:function(){var x=g(this)?this.valueOf():this,w=c.call(x);return y(i,x)?"":(x=u?w.slice(7,-1):w.replace(f,"$1"))===""?void 0:x}}),h({global:!0,forced:!0},{Symbol:l}))},{"../internals/copy-constructor-properties":33,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/is-object":75,"../internals/object-define-property":93}],208:[function(r,s,a){r("../internals/define-well-known-symbol")("iterator")},{"../internals/define-well-known-symbol":42}],209:[function(ue,s,a){function i(ee,le){var Se=$e[ee]=A(de[fe]);return ge(Se,{type:ce,tag:ee,description:le}),y||(Se.description=le),Se}function l(ee,Pe){S(ee);var Se=_(Pe),Pe=I(Se).concat(ie(Se));return te(Pe,function(Ue){y&&!re.call(Se,Ue)||Me(ee,Ue,Se[Ue])}),ee}function c(Pe,Ue){var Se,Pe=_(Pe),Ue=C(Ue,!0);if(Pe!==oe||!v($e,Ue)||v(Fe,Ue))return!(Se=Ie(Pe,Ue))||!v($e,Ue)||v(Pe,ne)&&Pe[ne][Ue]||(Se.enumerable=!0),Se}function u(le){var le=_e(_(le)),Se=[];return te(le,function(Pe){v($e,Pe)||v(J,Pe)||Se.push(Pe)}),Se}var f=ue("../internals/export"),h=ue("../internals/global"),d=ue("../internals/get-built-in"),p=ue("../internals/is-pure"),y=ue("../internals/descriptors"),g=ue("../internals/native-symbol"),b=ue("../internals/use-symbol-as-uid"),m=ue("../internals/fails"),v=ue("../internals/has"),x=ue("../internals/is-array"),w=ue("../internals/is-object"),S=ue("../internals/an-object"),k=ue("../internals/to-object"),_=ue("../internals/to-indexed-object"),C=ue("../internals/to-primitive"),P=ue("../internals/create-property-descriptor"),A=ue("../internals/object-create"),I=ue("../internals/object-keys"),N=ue("../internals/object-get-own-property-names"),O=ue("../internals/object-get-own-property-names-external"),F=ue("../internals/object-get-own-property-symbols"),U=ue("../internals/object-get-own-property-descriptor"),G=ue("../internals/object-define-property"),Y=ue("../internals/object-property-is-enumerable"),$=ue("../internals/create-non-enumerable-property"),H=ue("../internals/redefine"),Q=ue("../internals/shared"),rt=ue("../internals/shared-key"),J=ue("../internals/hidden-keys"),ae=ue("../internals/uid"),T=ue("../internals/well-known-symbol"),B=ue("../internals/well-known-symbol-wrapped"),W=ue("../internals/define-well-known-symbol"),K=ue("../internals/set-to-string-tag"),it=ue("../internals/internal-state"),te=ue("../internals/array-iteration").forEach,ne=rt("hidden"),ce="Symbol",fe="prototype",ue=T("toPrimitive"),ge=it.set,me=it.getterFor(ce),oe=Object[fe],de=h.Symbol,xe=d("JSON","stringify"),Ie=U.f,we=G.f,_e=O.f,Ae=Y.f,$e=Q("symbols"),Fe=Q("op-symbols"),ut=Q("string-to-symbol-registry"),tt=Q("symbol-to-string-registry"),rt=Q("wks"),it=h.QObject,nt=!it||!it[fe]||!it[fe].findChild,Ee=y&&m(function(){return A(we({},"a",{get:function(){return we(this,"a",{value:7}).a}})).a!=7})?function(ee,le,Se){var Pe=Ie(oe,le);Pe&&delete oe[le],we(ee,le,Se),Pe&&ee!==oe&&we(oe,le,Pe)}:we,Ve=b?function(ee){return typeof ee=="symbol"}:function(ee){return Object(ee)instanceof de},Me=function(ee,le,Se){return ee===oe&&Me(Fe,le,Se),S(ee),le=C(le,!0),S(Se),(v($e,le)?(Se.enumerable?(v(ee,ne)&&ee[ne][le]&&(ee[ne][le]=!1),Se=A(Se,{enumerable:P(0,!1)})):(v(ee,ne)||we(ee,ne,P(1,{})),ee[ne][le]=!0),Ee):we)(ee,le,Se)},re=function(le){var le=C(le,!0),Se=Ae.call(this,le);return!(this===oe&&v($e,le)&&!v(Fe,le))&&(!(Se||!v(this,le)||!v($e,le)||v(this,ne)&&this[ne][le])||Se)},ie=function(Se){var le=Se===oe,Se=_e(le?Fe:_(Se)),Pe=[];return te(Se,function(Ue){!v($e,Ue)||le&&!v(oe,Ue)||Pe.push($e[Ue])}),Pe};g||(H((de=function(){if(this instanceof de)throw TypeError("Symbol is not a constructor");var ee=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,le=ae(ee),Se=function(Pe){this===oe&&Se.call(Fe,Pe),v(this,ne)&&v(this[ne],le)&&(this[ne][le]=!1),Ee(this,le,P(1,Pe))};return y&&nt&&Ee(oe,le,{configurable:!0,set:Se}),i(le,ee)})[fe],"toString",function(){return me(this).tag}),H(de,"withoutSetter",function(ee){return i(ae(ee),ee)}),Y.f=re,G.f=Me,U.f=c,N.f=O.f=u,F.f=ie,B.f=function(ee){return i(T(ee),ee)},y&&(we(de[fe],"description",{configurable:!0,get:function(){return me(this).description}}),p||H(oe,"propertyIsEnumerable",re,{unsafe:!0}))),f({global:!0,wrap:!0,forced:!g,sham:!g},{Symbol:de}),te(I(rt),function(ee){W(ee)}),f({target:ce,stat:!0,forced:!g},{for:function(Se){var le,Se=String(Se);return v(ut,Se)?ut[Se]:(le=de(Se),ut[Se]=le,tt[le]=Se,le)},keyFor:function(ee){if(!Ve(ee))throw TypeError(ee+" is not a symbol");if(v(tt,ee))return tt[ee]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),f({target:"Object",stat:!0,forced:!g,sham:!y},{create:function(ee,le){return le===void 0?A(ee):l(A(ee),le)},defineProperty:Me,defineProperties:l,getOwnPropertyDescriptor:c}),f({target:"Object",stat:!0,forced:!g},{getOwnPropertyNames:u,getOwnPropertySymbols:ie}),f({target:"Object",stat:!0,forced:m(function(){F.f(1)})},{getOwnPropertySymbols:function(ee){return F.f(k(ee))}}),xe&&f({target:"JSON",stat:!0,forced:!g||m(function(){var ee=de();return xe([ee])!="[null]"||xe({a:ee})!="{}"||xe(Object(ee))!="{}"})},{stringify:function(ee,le,Se){for(var Pe,Ue=[ee],Xe=1;Xe<arguments.length;)Ue.push(arguments[Xe++]);if((w(Pe=le)||ee!==void 0)&&!Ve(ee))return x(le)||(le=function(Ze,et){if(typeof Pe=="function"&&(et=Pe.call(this,Ze,et)),!Ve(et))return et}),Ue[1]=le,xe.apply(null,Ue)}}),de[fe][ue]||$(de[fe],ue,de[fe].valueOf),K(de,ce),J[ne]=!0},{"../internals/an-object":10,"../internals/array-iteration":19,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/define-well-known-symbol":42,"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/get-built-in":57,"../internals/global":60,"../internals/has":61,"../internals/hidden-keys":62,"../internals/internal-state":71,"../internals/is-array":73,"../internals/is-object":75,"../internals/is-pure":76,"../internals/native-symbol":84,"../internals/object-create":91,"../internals/object-define-property":93,"../internals/object-get-own-property-descriptor":94,"../internals/object-get-own-property-names":96,"../internals/object-get-own-property-names-external":95,"../internals/object-get-own-property-symbols":97,"../internals/object-keys":100,"../internals/object-property-is-enumerable":101,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/shared":121,"../internals/shared-key":119,"../internals/to-indexed-object":135,"../internals/to-object":138,"../internals/to-primitive":141,"../internals/uid":146,"../internals/use-symbol-as-uid":147,"../internals/well-known-symbol":149,"../internals/well-known-symbol-wrapped":148}],210:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-copy-within"),c=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",function(u,f){return l.call(c(this),u,f,2<arguments.length?arguments[2]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-copy-within":14}],211:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").every,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("every",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],212:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-fill"),c=i.aTypedArray;(0,i.exportTypedArrayMethod)("fill",function(u){return l.apply(c(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-fill":15}],213:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").filter,c=r("../internals/species-constructor"),u=i.aTypedArray,f=i.aTypedArrayConstructor;(0,i.exportTypedArrayMethod)("filter",function(h){for(var d=l(u(this),h,1<arguments.length?arguments[1]:void 0),h=c(this,this.constructor),p=0,y=d.length,g=new(f(h))(y);p<y;)g[p]=d[p++];return g})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":122}],214:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").findIndex,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("findIndex",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],215:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").find,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("find",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],216:[function(r,s,a){r("../internals/typed-array-constructor")("Float32",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],217:[function(r,s,a){r("../internals/typed-array-constructor")("Float64",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],218:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").forEach,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("forEach",function(u){l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],219:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-includes").includes,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("includes",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],220:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-includes").indexOf,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("indexOf",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],221:[function(r,s,a){r("../internals/typed-array-constructor")("Int16",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],222:[function(r,s,a){r("../internals/typed-array-constructor")("Int32",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],223:[function(l,s,a){function i(){return c.call(h(this))}var y=l("../internals/global"),p=l("../internals/array-buffer-view-core"),d=l("../modules/es.array.iterator"),l=l("../internals/well-known-symbol")("iterator"),y=y.Uint8Array,c=d.values,u=d.keys,f=d.entries,h=p.aTypedArray,d=p.exportTypedArrayMethod,p=y&&y.prototype[l],y=!!p&&(p.name=="values"||p.name==null);d("entries",function(){return f.call(h(this))}),d("keys",function(){return u.call(h(this))}),d("values",i,!y),d(l,i,!y)},{"../internals/array-buffer-view-core":12,"../internals/global":60,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],224:[function(l,s,a){var l=l("../internals/array-buffer-view-core"),i=l.aTypedArray,l=l.exportTypedArrayMethod,c=[].join;l("join",function(u){return c.apply(i(this),arguments)})},{"../internals/array-buffer-view-core":12}],225:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-last-index-of"),c=i.aTypedArray;(0,i.exportTypedArrayMethod)("lastIndexOf",function(u){return l.apply(c(this),arguments)})},{"../internals/array-buffer-view-core":12,"../internals/array-last-index-of":20}],226:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").map,c=r("../internals/species-constructor"),u=i.aTypedArray,f=i.aTypedArrayConstructor;(0,i.exportTypedArrayMethod)("map",function(h){return l(u(this),h,1<arguments.length?arguments[1]:void 0,function(d,p){return new(f(c(d,d.constructor)))(p)})})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":122}],227:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-reduce").right,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("reduceRight",function(u){return l(c(this),u,arguments.length,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],228:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-reduce").left,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("reduce",function(u){return l(c(this),u,arguments.length,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],229:[function(l,s,a){var l=l("../internals/array-buffer-view-core"),i=l.aTypedArray,l=l.exportTypedArrayMethod,c=Math.floor;l("reverse",function(){for(var u,f=i(this).length,h=c(f/2),d=0;d<h;)u=this[d],this[d++]=this[--f],this[f]=u;return this})},{"../internals/array-buffer-view-core":12}],230:[function(f,s,a){var i=f("../internals/array-buffer-view-core"),l=f("../internals/to-length"),c=f("../internals/to-offset"),u=f("../internals/to-object"),f=f("../internals/fails"),h=i.aTypedArray;(0,i.exportTypedArrayMethod)("set",function(d){h(this);var p=c(1<arguments.length?arguments[1]:void 0,1),y=this.length,g=u(d),b=l(g.length),m=0;if(y<b+p)throw RangeError("Wrong length");for(;m<b;)this[p+m]=g[m++]},f(function(){new Int8Array(1).set({})}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/to-length":137,"../internals/to-object":138,"../internals/to-offset":139}],231:[function(l,s,a){var f=l("../internals/array-buffer-view-core"),i=l("../internals/species-constructor"),l=l("../internals/fails"),c=f.aTypedArray,u=f.aTypedArrayConstructor,f=f.exportTypedArrayMethod,h=[].slice;f("slice",function(d,p){for(var y=h.call(c(this),d,p),d=i(this,this.constructor),g=0,b=y.length,m=new(u(d))(b);g<b;)m[g]=y[g++];return m},l(function(){new Int8Array(1).slice()}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/species-constructor":122}],232:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/array-iteration").some,c=i.aTypedArray;(0,i.exportTypedArrayMethod)("some",function(u){return l(c(this),u,1<arguments.length?arguments[1]:void 0)})},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],233:[function(l,s,a){var l=l("../internals/array-buffer-view-core"),i=l.aTypedArray,l=l.exportTypedArrayMethod,c=[].sort;l("sort",function(u){return c.call(i(this),u)})},{"../internals/array-buffer-view-core":12}],234:[function(r,s,a){var i=r("../internals/array-buffer-view-core"),l=r("../internals/to-length"),c=r("../internals/to-absolute-index"),u=r("../internals/species-constructor"),f=i.aTypedArray;(0,i.exportTypedArrayMethod)("subarray",function(g,d){var p=f(this),y=p.length,g=c(g,y);return new(u(p,p.constructor))(p.buffer,p.byteOffset+g*p.BYTES_PER_ELEMENT,l((d===void 0?y:c(d,y))-g))})},{"../internals/array-buffer-view-core":12,"../internals/species-constructor":122,"../internals/to-absolute-index":133,"../internals/to-length":137}],235:[function(l,s,a){var f=l("../internals/global"),i=l("../internals/array-buffer-view-core"),l=l("../internals/fails"),c=f.Int8Array,u=i.aTypedArray,f=i.exportTypedArrayMethod,h=[].toLocaleString,d=[].slice,p=!!c&&l(function(){h.call(new c(1))});f("toLocaleString",function(){return h.apply(p?d.call(u(this)):u(this),arguments)},l(function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()})||!l(function(){c.prototype.toLocaleString.call([1,2])}))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":60}],236:[function(l,s,a){var i=l("../internals/array-buffer-view-core").exportTypedArrayMethod,f=l("../internals/fails"),l=l("../internals/global").Uint8Array,l=l&&l.prototype||{},c=[].toString,u=[].join,f=(f(function(){c.call({})})&&(c=function(){return u.call(this)}),l.toString!=c);i("toString",c,f)},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":60}],237:[function(r,s,a){r("../internals/typed-array-constructor")("Uint16",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],238:[function(r,s,a){r("../internals/typed-array-constructor")("Uint32",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],239:[function(r,s,a){r("../internals/typed-array-constructor")("Uint8",function(i){return function(l,c,u){return i(this,l,c,u)}})},{"../internals/typed-array-constructor":143}],240:[function(r,s,a){r("../internals/typed-array-constructor")("Uint8",function(i){return function(l,c,u){return i(this,l,c,u)}},!0)},{"../internals/typed-array-constructor":143}],241:[function(v,S,a){function i(k){return function(){return k(this,arguments.length?arguments[0]:void 0)}}var l,c,u,f,h,x=v("../internals/global"),d=v("../internals/redefine-all"),p=v("../internals/internal-metadata"),y=v("../internals/collection"),g=v("../internals/collection-weak"),b=v("../internals/is-object"),m=v("../internals/internal-state").enforce,v=v("../internals/native-weak-map"),x=!x.ActiveXObject&&"ActiveXObject"in x,w=Object.isExtensible,S=S.exports=y("WeakMap",i,g);v&&x&&(l=g.getConstructor(i,"WeakMap",!0),p.REQUIRED=!0,y=S.prototype,c=y.delete,u=y.has,f=y.get,h=y.set,d(y,{delete:function(k){var _;return b(k)&&!w(k)?((_=m(this)).frozen||(_.frozen=new l),c.call(this,k)||_.frozen.delete(k)):c.call(this,k)},has:function(k){var _;return b(k)&&!w(k)?((_=m(this)).frozen||(_.frozen=new l),u.call(this,k)||_.frozen.has(k)):u.call(this,k)},get:function(k){var _;return!b(k)||w(k)||((_=m(this)).frozen||(_.frozen=new l),u.call(this,k))?f.call(this,k):_.frozen.get(k)},set:function(k,_){var C;return!b(k)||w(k)||((C=m(this)).frozen||(C.frozen=new l),u.call(this,k))?h.call(this,k,_):C.frozen.set(k,_),this}}))},{"../internals/collection":32,"../internals/collection-weak":31,"../internals/global":60,"../internals/internal-metadata":70,"../internals/internal-state":71,"../internals/is-object":75,"../internals/native-weak-map":86,"../internals/redefine-all":108}],242:[function(r,s,a){var i,l=r("../internals/global"),c=r("../internals/dom-iterables"),u=r("../internals/array-for-each"),f=r("../internals/create-non-enumerable-property");for(i in c){var h=l[i],h=h&&h.prototype;if(h&&h.forEach!==u)try{f(h,"forEach",u)}catch{h.forEach=u}}},{"../internals/array-for-each":16,"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":60}],243:[function(h,s,a){var i,l=h("../internals/global"),c=h("../internals/dom-iterables"),u=h("../modules/es.array.iterator"),f=h("../internals/create-non-enumerable-property"),h=h("../internals/well-known-symbol"),d=h("iterator"),p=h("toStringTag"),y=u.values;for(i in c){var g=l[i],b=g&&g.prototype;if(b){if(b[d]!==y)try{f(b,d,y)}catch{b[d]=y}if(b[p]||f(b,p,i),c[i]){for(var m in u)if(b[m]!==u[m])try{f(b,m,u[m])}catch{b[m]=u[m]}}}}},{"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":60,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],244:[function(ne,s,a){ne("../modules/es.array.iterator");function i(ce){try{return decodeURIComponent(ce)}catch{return ce}}function l(ce){return W[ce]}function c(ce){return encodeURIComponent(ce).replace(B,l)}function u(ce){this.entries.length=0,K(this.entries,ce)}function f(ce,fe){if(ce<fe)throw TypeError("Not enough arguments")}function h(){x(this,h,G);var ce,fe,ue,ge,me,oe,de,xe,Ie=0<arguments.length?arguments[0]:void 0,we=[];if($(this,{type:G,entries:we,updateURL:function(){},updateSearchParams:u}),Ie!==void 0)if(C(Ie))if(typeof(ce=N(Ie))=="function")for(ue=(fe=ce.call(Ie)).next;!(ge=ue.call(fe)).done;){if((oe=(me=(ge=I(_(ge.value))).next).call(ge)).done||(de=me.call(ge)).done||!me.call(ge).done)throw TypeError("Expected sequence with length 2");we.push({key:oe.value+"",value:de.value+""})}else for(xe in Ie)w(Ie,xe)&&we.push({key:xe,value:Ie[xe]+""});else K(we,typeof Ie=="string"?Ie.charAt(0)==="?"?Ie.slice(1):Ie:Ie+"")}var d=ne("../internals/export"),U=ne("../internals/get-built-in"),p=ne("../internals/native-url"),y=ne("../internals/redefine"),g=ne("../internals/redefine-all"),b=ne("../internals/set-to-string-tag"),m=ne("../internals/create-iterator-constructor"),v=ne("../internals/internal-state"),x=ne("../internals/an-instance"),w=ne("../internals/has"),S=ne("../internals/function-bind-context"),k=ne("../internals/classof"),_=ne("../internals/an-object"),C=ne("../internals/is-object"),P=ne("../internals/object-create"),A=ne("../internals/create-property-descriptor"),I=ne("../internals/get-iterator"),N=ne("../internals/get-iterator-method"),ne=ne("../internals/well-known-symbol"),O=U("fetch"),F=U("Headers"),U=ne("iterator"),G="URLSearchParams",Y=G+"Iterator",$=v.set,H=v.getterFor(G),Q=v.getterFor(Y),J=/\+/g,ae=Array(4),T=function(ce){var fe,ue=ce.replace(J," "),ge=4;try{return decodeURIComponent(ue)}catch{for(;ge;)ue=ue.replace((fe=ge--,ae[fe-1]||(ae[fe-1]=RegExp("((?:%[\\da-f]{2}){"+fe+"})","gi"))),i);return ue}},B=/[!'()~]|%20/g,W={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},K=function(ce,fe){if(fe)for(var ue,ge=fe.split("&"),me=0;me<ge.length;)(ue=ge[me++]).length&&(ue=ue.split("="),ce.push({key:T(ue.shift()),value:T(ue.join("="))}))},te=m(function(ce,fe){$(this,{type:Y,iterator:I(H(ce).entries),kind:fe})},"Iterator",function(){var fe=Q(this),ce=fe.kind,fe=fe.iterator.next(),ue=fe.value;return fe.done||(fe.value=ce==="keys"?ue.key:ce==="values"?ue.value:[ue.key,ue.value]),fe}),ne=h.prototype;g(ne,{append:function(ce,fe){f(arguments.length,2);var ue=H(this);ue.entries.push({key:ce+"",value:fe+""}),ue.updateURL()},delete:function(ce){f(arguments.length,1);for(var fe=H(this),ue=fe.entries,ge=ce+"",me=0;me<ue.length;)ue[me].key===ge?ue.splice(me,1):me++;fe.updateURL()},get:function(ce){f(arguments.length,1);for(var fe=H(this).entries,ue=ce+"",ge=0;ge<fe.length;ge++)if(fe[ge].key===ue)return fe[ge].value;return null},getAll:function(ce){f(arguments.length,1);for(var fe=H(this).entries,ue=ce+"",ge=[],me=0;me<fe.length;me++)fe[me].key===ue&&ge.push(fe[me].value);return ge},has:function(ce){f(arguments.length,1);for(var fe=H(this).entries,ue=ce+"",ge=0;ge<fe.length;)if(fe[ge++].key===ue)return!0;return!1},set:function(ce,fe){f(arguments.length,1);for(var ue,ge=H(this),me=ge.entries,oe=!1,de=ce+"",xe=fe+"",Ie=0;Ie<me.length;Ie++)(ue=me[Ie]).key===de&&(oe?me.splice(Ie--,1):(oe=!0,ue.value=xe));oe||me.push({key:de,value:xe}),ge.updateURL()},sort:function(){for(var ce,fe,ue=H(this),ge=ue.entries,me=ge.slice(),oe=ge.length=0;oe<me.length;oe++){for(ce=me[oe],fe=0;fe<oe;fe++)if(ge[fe].key>ce.key){ge.splice(fe,0,ce);break}fe===oe&&ge.push(ce)}ue.updateURL()},forEach:function(ce){for(var fe,ue=H(this).entries,ge=S(ce,1<arguments.length?arguments[1]:void 0,3),me=0;me<ue.length;)ge((fe=ue[me++]).value,fe.key,this)},keys:function(){return new te(this,"keys")},values:function(){return new te(this,"values")},entries:function(){return new te(this,"entries")}},{enumerable:!0}),y(ne,U,ne.entries),y(ne,"toString",function(){for(var ce,fe=H(this).entries,ue=[],ge=0;ge<fe.length;)ce=fe[ge++],ue.push(c(ce.key)+"="+c(ce.value));return ue.join("&")},{enumerable:!0}),b(h,G),d({global:!0,forced:!p},{URLSearchParams:h}),p||typeof O!="function"||typeof F!="function"||d({global:!0,enumerable:!0,forced:!0},{fetch:function(me){var fe,ue,ge,me=[me];return 1<arguments.length&&(C(fe=arguments[1])&&(ue=fe.body,k(ue)===G&&((ge=fe.headers?new F(fe.headers):new F).has("content-type")||ge.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),fe=P(fe,{body:A(0,String(ue)),headers:A(0,ge)}))),me.push(fe)),O.apply(this,me)}}),s.exports={URLSearchParams:h,getState:H}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/classof":29,"../internals/create-iterator-constructor":37,"../internals/create-property-descriptor":39,"../internals/export":50,"../internals/function-bind-context":55,"../internals/get-built-in":57,"../internals/get-iterator":59,"../internals/get-iterator-method":58,"../internals/has":61,"../internals/internal-state":71,"../internals/is-object":75,"../internals/native-url":85,"../internals/object-create":91,"../internals/redefine":109,"../internals/redefine-all":108,"../internals/set-to-string-tag":118,"../internals/well-known-symbol":149,"../modules/es.array.iterator":164}],245:[function(I,s,a){I("../modules/es.string.iterator");function i(be){var Qe,ct,Ke,Ut;if(typeof be=="number"){for(Qe=[],ct=0;ct<4;ct++)Qe.unshift(be%256),be=Y(be/256);return Qe.join(".")}if(typeof be!="object")return be;for(Qe="",Ke=de(be),ct=0;ct<8;ct++)Ut&&be[ct]===0||(Ut=Ut&&!1,Ke===ct?(Qe+=ct?":":"::",Ut=!0):(Qe+=be[ct].toString(16),ct<7&&(Qe+=":")));return"["+Qe+"]"}function l(be){return!be.host||be.cannotBeABaseURL||be.scheme=="file"}function c(be,Qe,ct,Ke){var Ut,Ge,$t,st=ct||Ve,zt=0,lt="",Fr=!1,Or=!1,Lr=!1;for(ct||(be.scheme="",be.username="",be.password="",be.host=null,be.port=null,be.path=[],be.query=null,be.fragment=null,be.cannotBeABaseURL=!1,Qe=Qe.replace(ge,"")),Qe=Qe.replace(me,""),Ut=k(Qe);zt<=Ut.length;){switch(Ge=Ut[zt],st){case Ve:if(!Ge||!T.test(Ge)){if(ct)return Q;st=re;continue}lt+=Ge.toLowerCase(),st=Me;break;case Me:if(Ge&&(B.test(Ge)||Ge=="+"||Ge=="-"||Ge=="."))lt+=Ge.toLowerCase();else{if(Ge!=":"){if(ct)return Q;lt="",st=re,zt=0;continue}if(ct&&(Fe(be)!=w($e,lt)||lt=="file"&&(ut(be)||be.port!==null)||be.scheme=="file"&&!be.host))return;if(be.scheme=lt,ct)return void(Fe(be)&&$e[be.scheme]==be.port&&(be.port=null));lt="",be.scheme=="file"?st=At:Fe(be)&&Ke&&Ke.scheme==be.scheme?st=ie:Fe(be)?st=Pe:Ut[zt+1]=="/"?(st=ee,zt++):(be.cannotBeABaseURL=!0,be.path.push(""),st=rr)}break;case re:if(!Ke||Ke.cannotBeABaseURL&&Ge!="#")return Q;if(Ke.cannotBeABaseURL&&Ge=="#"){be.scheme=Ke.scheme,be.path=Ke.path.slice(),be.query=Ke.query,be.fragment="",be.cannotBeABaseURL=!0,st=$r;break}st=Ke.scheme=="file"?At:le;continue;case ie:if(Ge!="/"||Ut[zt+1]!="/"){st=le;continue}st=Ue,zt++;break;case ee:if(Ge=="/"){st=Xe;break}st=kt;continue;case le:if(be.scheme=Ke.scheme,Ge==h)be.username=Ke.username,be.password=Ke.password,be.host=Ke.host,be.port=Ke.port,be.path=Ke.path.slice(),be.query=Ke.query;else if(Ge=="/"||Ge=="\\"&&Fe(be))st=Se;else if(Ge=="?")be.username=Ke.username,be.password=Ke.password,be.host=Ke.host,be.port=Ke.port,be.path=Ke.path.slice(),be.query="",st=Wr;else{if(Ge!="#"){be.username=Ke.username,be.password=Ke.password,be.host=Ke.host,be.port=Ke.port,be.path=Ke.path.slice(),be.path.pop(),st=kt;continue}be.username=Ke.username,be.password=Ke.password,be.host=Ke.host,be.port=Ke.port,be.path=Ke.path.slice(),be.query=Ke.query,be.fragment="",st=$r}break;case Se:if(!Fe(be)||Ge!="/"&&Ge!="\\"){if(Ge!="/"){be.username=Ke.username,be.password=Ke.password,be.host=Ke.host,be.port=Ke.port,st=kt;continue}st=Xe}else st=Ue;break;case Pe:if(st=Ue,Ge!="/"||lt.charAt(zt+1)!="/")continue;zt++;break;case Ue:if(Ge=="/"||Ge=="\\")break;st=Xe;continue;case Xe:if(Ge=="@"){Fr&&(lt="%40"+lt);for(var Fr=!0,nn=k(lt),mn=0;mn<nn.length;mn++){var no=nn[mn];no!=":"||Lr?(no=Ae(no,_e),Lr?be.password+=no:be.username+=no):Lr=!0}lt=""}else if(Ge==h||Ge=="/"||Ge=="?"||Ge=="#"||Ge=="\\"&&Fe(be)){if(Fr&&lt=="")return H;zt-=k(lt).length+1,lt="",st=Ze}else lt+=Ge;break;case Ze:case et:if(ct&&be.scheme=="file"){st=dt;continue}if(Ge!=":"||Or){if(Ge==h||Ge=="/"||Ge=="?"||Ge=="#"||Ge=="\\"&&Fe(be)){if(Fe(be)&&lt=="")return J;if(ct&&lt==""&&(ut(be)||be.port!==null))return;if($t=oe(be,lt))return $t;if(lt="",st=Ct,ct)return;continue}Ge=="["?Or=!0:Ge=="]"&&(Or=!1),lt+=Ge}else{if(lt=="")return J;if($t=oe(be,lt))return $t;if(lt="",st=at,ct==et)return}break;case at:if(!W.test(Ge)){if(Ge==h||Ge=="/"||Ge=="?"||Ge=="#"||Ge=="\\"&&Fe(be)||ct){if(lt!=""){var is=parseInt(lt,10);if(65535<is)return ae;be.port=Fe(be)&&is===$e[be.scheme]?null:is,lt=""}if(ct)return;st=Ct;continue}return ae}lt+=Ge;break;case At:if(be.scheme="file",Ge=="/"||Ge=="\\")st=Et;else{if(!Ke||Ke.scheme!="file"){st=kt;continue}if(Ge==h)be.host=Ke.host,be.path=Ke.path.slice(),be.query=Ke.query;else if(Ge=="?")be.host=Ke.host,be.path=Ke.path.slice(),be.query="",st=Wr;else{if(Ge!="#"){rt(Ut.slice(zt).join(""))||(be.host=Ke.host,be.path=Ke.path.slice(),it(be)),st=kt;continue}be.host=Ke.host,be.path=Ke.path.slice(),be.query=Ke.query,be.fragment="",st=$r}}break;case Et:if(Ge=="/"||Ge=="\\"){st=dt;break}Ke&&Ke.scheme=="file"&&!rt(Ut.slice(zt).join(""))&&(tt(Ke.path[0],!0)?be.path.push(Ke.path[0]):be.host=Ke.host),st=kt;continue;case dt:if(Ge==h||Ge=="/"||Ge=="\\"||Ge=="?"||Ge=="#"){if(!ct&&tt(lt))st=kt;else{if(lt==""){if(be.host="",ct)return}else{if($t=oe(be,lt))return $t;if(be.host=="localhost"&&(be.host=""),ct)return;lt=""}st=Ct}continue}lt+=Ge;break;case Ct:if(Fe(be)){if(st=kt,Ge!="/"&&Ge!="\\")continue}else if(ct||Ge!="?")if(ct||Ge!="#"){if(Ge!=h&&(st=kt,Ge!="/"))continue}else be.fragment="",st=$r;else be.query="",st=Wr;break;case kt:if(Ge==h||Ge=="/"||Ge=="\\"&&Fe(be)||!ct&&(Ge=="?"||Ge=="#")){if(Ee(lt)?(it(be),Ge=="/"||Ge=="\\"&&Fe(be)||be.path.push("")):nt(lt)?Ge=="/"||Ge=="\\"&&Fe(be)||be.path.push(""):(be.scheme=="file"&&!be.path.length&&tt(lt)&&(be.host&&(be.host=""),lt=lt.charAt(0)+":"),be.path.push(lt)),lt="",be.scheme=="file"&&(Ge==h||Ge=="?"||Ge=="#"))for(;1<be.path.length&&be.path[0]==="";)be.path.shift();Ge=="?"?(be.query="",st=Wr):Ge=="#"&&(be.fragment="",st=$r)}else lt+=Ae(Ge,we);break;case rr:Ge=="?"?(be.query="",st=Wr):Ge=="#"?(be.fragment="",st=$r):Ge!=h&&(be.path[0]+=Ae(Ge,xe));break;case Wr:ct||Ge!="#"?Ge!=h&&(Ge=="'"&&Fe(be)?be.query+="%27":be.query+=Ge=="#"?"%23":Ae(Ge,xe)):(be.fragment="",st=$r);break;case $r:Ge!=h&&(be.fragment+=Ae(Ge,Ie))}zt++}}function u(Ge){var Qe,ct,Ke=x(this,u,"URL"),Ut=1<arguments.length?arguments[1]:void 0,Ge=String(Ge),$t=U(Ke,{type:"URL"});if(Ut!==void 0){if(Ut instanceof u)Qe=G(Ut);else if(ct=c(Qe={},String(Ut)))throw TypeError(ct)}if(ct=c($t,Ge,null,Qe))throw TypeError(ct);var st=$t.searchParams=new O;(Ut=F(st)).updateSearchParams($t.query),Ut.updateURL=function(){$t.query=String(st)||null},g||(Ke.href=fr.call(Ke),Ke.origin=Wt.call(Ke),Ke.protocol=fn.call(Ke),Ke.username=Qr.call(Ke),Ke.password=Jt.call(Ke),Ke.host=kr.call(Ke),Ke.hostname=al.call(Ke),Ke.port=ll.call(Ke),Ke.pathname=cl.call(Ke),Ke.search=sc.call(Ke),Ke.searchParams=ul.call(Ke),Ke.hash=ro.call(Ke))}function f(be,Qe){return{get:be,set:Qe,configurable:!0,enumerable:!0}}var h,d,p,y=I("../internals/export"),g=I("../internals/descriptors"),b=I("../internals/native-url"),Zt=I("../internals/global"),m=I("../internals/object-define-properties"),v=I("../internals/redefine"),x=I("../internals/an-instance"),w=I("../internals/has"),S=I("../internals/object-assign"),k=I("../internals/array-from"),_=I("../internals/string-multibyte").codeAt,C=I("../internals/string-punycode-to-ascii"),P=I("../internals/set-to-string-tag"),A=I("../modules/web.url-search-params"),I=I("../internals/internal-state"),N=Zt.URL,O=A.URLSearchParams,F=A.getState,U=I.set,G=I.getterFor("URL"),Y=Math.floor,$=Math.pow,H="Invalid authority",Q="Invalid scheme",J="Invalid host",ae="Invalid port",T=/[A-Za-z]/,B=/[\d+-.A-Za-z]/,W=/\d/,K=/^(0x|0X)/,te=/^[0-7]+$/,ne=/^\d+$/,ce=/^[\dA-Fa-f]+$/,fe=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,ue=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,ge=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,me=/[\u0009\u000A\u000D]/g,oe=function(be,Qe){var ct,Ke,Ut;if(Qe.charAt(0)=="[")return Qe.charAt(Qe.length-1)=="]"&&(ct=function(Ge){var $t=[0,0,0,0,0,0,0,0],st=0,zt=null,lt=0,Fr,Or,Lr,nn,mn,no,is,on=function(){return Ge.charAt(lt)};if(on()==":"){if(Ge.charAt(1)!=":")return;lt+=2,st++,zt=st}for(;on();){if(st==8)return;if(on()==":"){if(zt!==null)return;lt++,st++,zt=st;continue}for(Fr=Or=0;Or<4&&ce.test(on());)Fr=Fr*16+parseInt(on(),16),lt++,Or++;if(on()=="."){if(Or==0||(lt-=Or,st>6))return;for(Lr=0;on();){if(nn=null,Lr>0)if(on()=="."&&Lr<4)lt++;else return;if(!W.test(on()))return;for(;W.test(on());){if(mn=parseInt(on(),10),nn===null)nn=mn;else{if(nn==0)return;nn=nn*10+mn}if(nn>255)return;lt++}$t[st]=$t[st]*256+nn,Lr++,(Lr==2||Lr==4)&&st++}if(Lr!=4)return;break}else if(on()==":"){if(lt++,!on())return}else if(on())return;$t[st++]=Fr}if(zt!==null)for(no=st-zt,st=7;st!=0&&no>0;)is=$t[st],$t[st--]=$t[zt+no-1],$t[zt+--no]=is;else if(st!=8)return;return $t}(Qe.slice(1,-1)))?void(be.host=ct):J;if(Fe(be))return Qe=C(Qe),fe.test(Qe)||(ct=function(Ge){var $t=Ge.split("."),st,zt,lt,Fr,Or,Lr,nn;if($t.length&&$t[$t.length-1]==""&&$t.pop(),(st=$t.length)>4)return Ge;for(zt=[],lt=0;lt<st;lt++){if(Fr=$t[lt],Fr=="")return Ge;if(Or=10,Fr.length>1&&Fr.charAt(0)=="0"&&(Or=K.test(Fr)?16:8,Fr=Fr.slice(Or==8?1:2)),Fr==="")Lr=0;else{if(!(Or==10?ne:Or==8?te:ce).test(Fr))return Ge;Lr=parseInt(Fr,Or)}zt.push(Lr)}for(lt=0;lt<st;lt++)if(Lr=zt[lt],lt==st-1){if(Lr>=$(256,5-st))return null}else if(Lr>255)return null;for(nn=zt.pop(),lt=0;lt<zt.length;lt++)nn+=zt[lt]*$(256,3-lt);return nn}(Qe))===null?J:void(be.host=ct);if(ue.test(Qe))return J;for(ct="",Ke=k(Qe),Ut=0;Ut<Ke.length;Ut++)ct+=Ae(Ke[Ut],xe);be.host=ct},de=function(be){for(var Qe=null,ct=1,Ke=null,Ut=0,Ge=0;Ge<8;Ge++)be[Ge]!==0?(ct<Ut&&(Qe=Ke,ct=Ut),Ke=null,Ut=0):(Ke===null&&(Ke=Ge),++Ut);return ct<Ut&&(Qe=Ke,ct=Ut),Qe},xe={},Ie=S({},xe,{" ":1,'"':1,"<":1,">":1,"`":1}),we=S({},Ie,{"#":1,"?":1,"{":1,"}":1}),_e=S({},we,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ae=function(be,Qe){var ct=_(be,0);return 32<ct&&ct<127&&!w(Qe,be)?be:encodeURIComponent(be)},$e={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Fe=function(be){return w($e,be.scheme)},ut=function(be){return be.username!=""||be.password!=""},tt=function(be,Qe){return be.length==2&&T.test(be.charAt(0))&&((be=be.charAt(1))==":"||!Qe&&be=="|")},rt=function(be){return 1<be.length&&tt(be.slice(0,2))&&(be.length==2||(be=be.charAt(2))==="/"||be==="\\"||be==="?"||be==="#")},it=function(be){var Qe=be.path,ct=Qe.length;!ct||be.scheme=="file"&&ct==1&&tt(Qe[0],!0)||Qe.pop()},nt=function(be){return be==="."||be.toLowerCase()==="%2e"},Ee=function(be){return(be=be.toLowerCase())===".."||be==="%2e."||be===".%2e"||be==="%2e%2e"},Ve={},Me={},re={},ie={},ee={},le={},Se={},Pe={},Ue={},Xe={},Ze={},et={},at={},At={},Et={},dt={},Ct={},kt={},rr={},Wr={},$r={},Zt=u.prototype,fr=function(){var be=G(this),Qe=be.scheme,ct=be.username,Ke=be.password,Ut=be.host,Ge=be.port,$t=be.path,st=be.query,zt=be.fragment,lt=Qe+":";return Ut!==null?(lt+="//",ut(be)&&(lt+=ct+(Ke?":"+Ke:"")+"@"),lt+=i(Ut),Ge!==null&&(lt+=":"+Ge)):Qe=="file"&&(lt+="//"),lt+=be.cannotBeABaseURL?$t[0]:$t.length?"/"+$t.join("/"):"",st!==null&&(lt+="?"+st),zt!==null&&(lt+="#"+zt),lt},Wt=function(){var be=G(this),Qe=be.scheme,ct=be.port;if(Qe=="blob")try{return new URL(Qe.path[0]).origin}catch{return"null"}return Qe!="file"&&Fe(be)?Qe+"://"+i(be.host)+(ct!==null?":"+ct:""):"null"},fn=function(){return G(this).scheme+":"},Qr=function(){return G(this).username},Jt=function(){return G(this).password},kr=function(){var Qe=G(this),be=Qe.host,Qe=Qe.port;return be===null?"":Qe===null?i(be):i(be)+":"+Qe},al=function(){var be=G(this).host;return be===null?"":i(be)},ll=function(){var be=G(this).port;return be===null?"":String(be)},cl=function(){var be=G(this),Qe=be.path;return be.cannotBeABaseURL?Qe[0]:Qe.length?"/"+Qe.join("/"):""},sc=function(){var be=G(this).query;return be?"?"+be:""},ul=function(){return G(this).searchParams},ro=function(){var be=G(this).fragment;return be?"#"+be:""};g&&m(Zt,{href:f(fr,function(ct){var Qe=G(this),ct=String(ct),ct=c(Qe,ct);if(ct)throw TypeError(ct);F(Qe.searchParams).updateSearchParams(Qe.query)}),origin:f(Wt),protocol:f(fn,function(be){var Qe=G(this);c(Qe,String(be)+":",Ve)}),username:f(Qr,function(be){var Qe=G(this),ct=k(String(be));if(!l(Qe)){Qe.username="";for(var Ke=0;Ke<ct.length;Ke++)Qe.username+=Ae(ct[Ke],_e)}}),password:f(Jt,function(be){var Qe=G(this),ct=k(String(be));if(!l(Qe)){Qe.password="";for(var Ke=0;Ke<ct.length;Ke++)Qe.password+=Ae(ct[Ke],_e)}}),host:f(kr,function(be){var Qe=G(this);Qe.cannotBeABaseURL||c(Qe,String(be),Ze)}),hostname:f(al,function(be){var Qe=G(this);Qe.cannotBeABaseURL||c(Qe,String(be),et)}),port:f(ll,function(be){var Qe=G(this);l(Qe)||((be=String(be))==""?Qe.port=null:c(Qe,be,at))}),pathname:f(cl,function(be){var Qe=G(this);Qe.cannotBeABaseURL||(Qe.path=[],c(Qe,be+"",Ct))}),search:f(sc,function(be){var Qe=G(this);(be=String(be))==""?Qe.query=null:(be.charAt(0)=="?"&&(be=be.slice(1)),Qe.query="",c(Qe,be,Wr)),F(Qe.searchParams).updateSearchParams(Qe.query)}),searchParams:f(ul),hash:f(ro,function(be){var Qe=G(this);(be=String(be))==""?Qe.fragment=null:(be.charAt(0)=="#"&&(be=be.slice(1)),Qe.fragment="",c(Qe,be,$r))})}),v(Zt,"toJSON",function(){return fr.call(this)},{enumerable:!0}),v(Zt,"toString",function(){return fr.call(this)},{enumerable:!0}),N&&(d=N.createObjectURL,p=N.revokeObjectURL,d&&v(u,"createObjectURL",function(be){return d.apply(N,arguments)}),p&&v(u,"revokeObjectURL",function(be){return p.apply(N,arguments)})),P(u,"URL"),y({global:!0,forced:!b,sham:!g},{URL:u})},{"../internals/an-instance":9,"../internals/array-from":17,"../internals/descriptors":43,"../internals/export":50,"../internals/global":60,"../internals/has":61,"../internals/internal-state":71,"../internals/native-url":85,"../internals/object-assign":90,"../internals/object-define-properties":92,"../internals/redefine":109,"../internals/set-to-string-tag":118,"../internals/string-multibyte":124,"../internals/string-punycode-to-ascii":127,"../modules/es.string.iterator":197,"../modules/web.url-search-params":244}],246:[function(r,s,a){s.exports=r("./").polyfill()},{"./":247}],247:[function(r,s,a){(function(i,l){var c,u;c=this,u=function(){function f(oe){return typeof oe=="function"}var h=Array.isArray||function(oe){return Object.prototype.toString.call(oe)==="[object Array]"},d=0,p=void 0,y=void 0,g=function(oe,de){S[d]=oe,S[d+1]=de,(d+=2)===2&&(y?y(k):O())},b=typeof window<"u"?window:void 0,m=b||{},m=m.MutationObserver||m.WebKitMutationObserver,v=typeof self>"u"&&i!==void 0&&{}.toString.call(i)==="[object process]",x=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function w(){var oe=setTimeout;return function(){return oe(k,1)}}var S=new Array(1e3);function k(){for(var oe=0;oe<d;oe+=2)(0,S[oe])(S[oe+1]),S[oe]=void 0,S[oe+1]=void 0;d=0}function _(){try{var oe=Function("return this")().require("vertx");return(p=oe.runOnLoop||oe.runOnContext)!==void 0?function(){p(k)}:w()}catch{return w()}}var C,P,A,O=void 0;function I(oe,de){var xe,Ie=this,we=new this.constructor(U),_e=(we[F]===void 0&&ce(we),Ie._state);return _e?(xe=arguments[_e-1],g(function(){return te(_e,we,xe,Ie._result)})):W(Ie,we,oe,de),we}function N(oe){var de;return oe&&typeof oe=="object"&&oe.constructor===this?oe:(J(de=new this(U),oe),de)}var O=v?function(){return i.nextTick(k)}:m?(P=0,v=new m(k),A=document.createTextNode(""),v.observe(A,{characterData:!0}),function(){A.data=P=++P%2}):x?((C=new MessageChannel).port1.onmessage=k,function(){return C.port2.postMessage(0)}):(b===void 0&&typeof r=="function"?_:w)(),F=Math.random().toString(36).substring(2);function U(){}var G=void 0,Y=1,$=2;function H(oe,de,xe){g(function(Ie){var we=!1,_e=function(Ae,$e,Fe,ut){try{Ae.call($e,Fe,ut)}catch(tt){return tt}}(xe,de,function(Ae){we||(we=!0,(de!==Ae?J:T)(Ie,Ae))},function(Ae){we||(we=!0,B(Ie,Ae))},Ie._label);!we&&_e&&(we=!0,B(Ie,_e))},oe)}function Q(oe,de,xe){var Ie,we;de.constructor===oe.constructor&&xe===I&&de.constructor.resolve===N?(Ie=oe,(we=de)._state===Y?T(Ie,we._result):we._state===$?B(Ie,we._result):W(we,void 0,function(_e){return J(Ie,_e)},function(_e){return B(Ie,_e)})):xe!==void 0&&f(xe)?H(oe,de,xe):T(oe,de)}function J(oe,de){if(oe===de)B(oe,new TypeError("You cannot resolve a promise with itself"));else if(xe=typeof de,de===null||xe!="object"&&xe!="function")T(oe,de);else{xe=void 0;try{xe=de.then}catch(Ie){return void B(oe,Ie)}Q(oe,de,xe)}var xe}function ae(oe){oe._onerror&&oe._onerror(oe._result),K(oe)}function T(oe,de){oe._state===G&&(oe._result=de,oe._state=Y,oe._subscribers.length!==0&&g(K,oe))}function B(oe,de){oe._state===G&&(oe._state=$,oe._result=de,g(ae,oe))}function W(oe,de,xe,Ie){var we=oe._subscribers,_e=we.length;oe._onerror=null,we[_e]=de,we[_e+Y]=xe,we[_e+$]=Ie,_e===0&&oe._state&&g(K,oe)}function K(oe){var de=oe._subscribers,xe=oe._state;if(de.length!==0){for(var Ie,we=void 0,_e=oe._result,Ae=0;Ae<de.length;Ae+=3)Ie=de[Ae],we=de[Ae+xe],Ie?te(xe,Ie,we,_e):we(_e);oe._subscribers.length=0}}function te(oe,de,xe,Ie){var we=f(xe),_e=void 0,Ae=void 0,$e=!0;if(we){try{_e=xe(Ie)}catch(Fe){$e=!1,Ae=Fe}if(de===_e)return void B(de,new TypeError("A promises callback cannot return that same promise."))}else _e=Ie;de._state===G&&(we&&$e?J(de,_e):$e===!1?B(de,Ae):oe===Y?T(de,_e):oe===$&&B(de,_e))}var ne=0;function ce(oe){oe[F]=ne++,oe._state=void 0,oe._result=void 0,oe._subscribers=[]}ue.prototype._enumerate=function(oe){for(var de=0;this._state===G&&de<oe.length;de++)this._eachEntry(oe[de],de)},ue.prototype._eachEntry=function(oe,de){var xe=this._instanceConstructor,Ie=xe.resolve;if(Ie===N){var we,_e=void 0,Ae=void 0,$e=!1;try{_e=oe.then}catch(Fe){$e=!0,Ae=Fe}_e===I&&oe._state!==G?this._settledAt(oe._state,de,oe._result):typeof _e!="function"?(this._remaining--,this._result[de]=oe):xe===ge?(we=new xe(U),$e?B(we,Ae):Q(we,oe,_e),this._willSettleAt(we,de)):this._willSettleAt(new xe(function(Fe){return Fe(oe)}),de)}else this._willSettleAt(Ie(oe),de)},ue.prototype._settledAt=function(oe,de,xe){var Ie=this.promise;Ie._state===G&&(this._remaining--,oe===$?B(Ie,xe):this._result[de]=xe),this._remaining===0&&T(Ie,this._result)},ue.prototype._willSettleAt=function(oe,de){var xe=this;W(oe,void 0,function(Ie){return xe._settledAt(Y,de,Ie)},function(Ie){return xe._settledAt($,de,Ie)})};var fe=ue;function ue(oe,de){this._instanceConstructor=oe,this.promise=new oe(U),this.promise[F]||ce(this.promise),h(de)?(this.length=de.length,this._remaining=de.length,this._result=new Array(this.length),this.length!==0&&(this.length=this.length||0,this._enumerate(de),this._remaining!==0)||T(this.promise,this._result)):B(this.promise,new Error("Array Methods must be provided an Array"))}me.prototype.catch=function(oe){return this.then(null,oe)},me.prototype.finally=function(oe){var de=this.constructor;return f(oe)?this.then(function(xe){return de.resolve(oe()).then(function(){return xe})},function(xe){return de.resolve(oe()).then(function(){throw xe})}):this.then(oe,oe)};var ge=me;function me(oe){if(this[F]=ne++,this._result=this._state=void 0,this._subscribers=[],U!==oe){if(typeof oe!="function")throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof me))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var de=this;try{oe(function(xe){J(de,xe)},function(xe){B(de,xe)})}catch(xe){B(de,xe)}}}return ge.prototype.then=I,ge.all=function(oe){return new fe(this,oe).promise},ge.race=function(oe){var de=this;return h(oe)?new de(function(xe,Ie){for(var we=oe.length,_e=0;_e<we;_e++)de.resolve(oe[_e]).then(xe,Ie)}):new de(function(xe,Ie){return Ie(new TypeError("You must pass an array to race."))})},ge.resolve=N,ge.reject=function(oe){var de=new this(U);return B(de,oe),de},ge._setScheduler=function(oe){y=oe},ge._setAsap=function(oe){g=oe},ge._asap=g,ge.polyfill=function(){var oe=void 0;if(l!==void 0)oe=l;else if(typeof self<"u")oe=self;else try{oe=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var de=oe.Promise;if(de){var xe=null;try{xe=Object.prototype.toString.call(de.resolve())}catch{}if(xe==="[object Promise]"&&!de.cast)return}oe.Promise=ge},ge.Promise=ge},typeof a=="object"&&s!==void 0?s.exports=u():c.ES6Promise=u()}).call(this,r("_process"),typeof cn<"u"?cn:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:256}],248:[function(r,s,a){var i,l;i=this,l=function(c,u){var f=5e3,h="callback";function d(y){try{delete window[y]}catch{window[y]=void 0}}function p(y){y=document.getElementById(y),y&&document.getElementsByTagName("head")[0].removeChild(y)}u.exports=function(y){var g=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],b=y,m=g.timeout||f,v=g.jsonpCallback||h,x=void 0;return new Promise(function(w,S){var k=g.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),_=v+"_"+k,C=(window[k]=function(P){w({ok:!0,json:function(){return Promise.resolve(P)}}),x&&clearTimeout(x),p(_),d(k)},b+=b.indexOf("?")===-1?"?":"&",document.createElement("script"));C.setAttribute("src",""+b+v+"="+k),g.charset&&C.setAttribute("charset",g.charset),C.id=_,document.getElementsByTagName("head")[0].appendChild(C),x=setTimeout(function(){S(new Error("JSONP request to "+y+" timed out")),d(k),p(_),window[k]=function(){d(k)}},m),C.onerror=function(){S(new Error("JSONP request to "+y+" failed")),d(k),p(_),x&&clearTimeout(x)}})}},a!==void 0&&s!==void 0?l(0,s):(l(l={exports:{}},l),i.fetchJsonp=l.exports)},{}],249:[function(r,s,a){var i=function(l){var c,u,f,h,d,p,y,g,b,m,v;if(!(l===void 0||typeof navigator<"u"&&/MSIE [1-9]\./.test(navigator.userAgent)))return v=l.document,c=function(){return l.URL||l.webkitURL||l},u=v.createElementNS("http://www.w3.org/1999/xhtml","a"),f="download"in u,h=/constructor/i.test(l.HTMLElement)||l.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent),p=function(x){(l.setImmediate||l.setTimeout)(function(){throw x},0)},y=4e4,g=function(x){setTimeout(function(){typeof x=="string"?c().revokeObjectURL(x):x.remove()},y)},b=function(x){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob([String.fromCharCode(65279),x],{type:x.type}):x},v=(m=function(x,w,P){P||(x=b(x));var k,_,C=this,P=x.type==="application/octet-stream",A=function(){for(var I=C,N="writestart progress write writeend".split(" "),O=void 0,F=(N=[].concat(N)).length;F--;){var U=I["on"+N[F]];if(typeof U=="function")try{U.call(I,O||I)}catch(G){p(G)}}};C.readyState=C.INIT,f?(k=c().createObjectURL(x),setTimeout(function(){var I,N;u.href=k,u.download=w,I=u,N=new MouseEvent("click"),I.dispatchEvent(N),A(),g(k),C.readyState=C.DONE})):(d||P&&h)&&l.FileReader?((_=new FileReader).onloadend=function(){var I=d?_.result:_.result.replace(/^data:[^;]*;/,"data:attachment/file;");l.open(I,"_blank")||(l.location.href=I),I=void 0,C.readyState=C.DONE,A()},_.readAsDataURL(x),C.readyState=C.INIT):(k=k||c().createObjectURL(x),!P&&l.open(k,"_blank")||(l.location.href=k),C.readyState=C.DONE,A(),g(k))}).prototype,typeof navigator<"u"&&navigator.msSaveOrOpenBlob?function(x,w,S){return w=w||x.name||"download",S||(x=b(x)),navigator.msSaveOrOpenBlob(x,w)}:(v.abort=function(){},v.readyState=v.INIT=0,v.WRITING=1,v.DONE=2,v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null,function(x,w,S){return new m(x,w||x.name||"download",S)})}(typeof self<"u"&&self||typeof window<"u"&&window||this.content);s!==void 0&&s.exports?s.exports.saveAs=i:o!=null},{}],250:[function(r,s,a){var i,l=Object.defineProperty,c=(l(a,"__esModule",{value:!0}),a),u={GIFEncoder:()=>A,applyPalette:()=>function(G,Y,$="rgb565"){if(!G||!G.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(G instanceof Uint8Array||G instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(256<Y.length)throw new Error("applyPalette() only works with 256 colors or less");const H=new Uint32Array(G.buffer),Q=H.length,J=$==="rgb444"?4096:65536,ae=new Uint8Array(Q),T=new Array(J);if($==="rgba4444")for(let me=0;me<Q;me++){var te=H[me],B=te>>24&255,W=te>>16&255,K=te>>8&255,te=255&te,ne=g(te,K,W,B),ne=ne in T?T[ne]:T[ne]=function(oe,de,xe,Ie,we){let _e=0,Ae=1e100;for(let tt=0;tt<we.length;tt++){var $e,Fe=we[tt],ut=_(Fe[3]-Ie);ut>Ae||($e=Fe[0],(ut+=_($e-oe))>Ae||($e=Fe[1],(ut+=_($e-de))>Ae||($e=Fe[2],(ut+=_($e-xe))>Ae||(Ae=ut,_e=tt))))}return _e}(te,K,W,B,Y);ae[me]=ne}else{const me=$==="rgb444"?b:y;for(let oe=0;oe<Q;oe++){var ue=H[oe],ce=ue>>16&255,fe=ue>>8&255,ue=255&ue,ge=me(ue,fe,ce),ge=ge in T?T[ge]:T[ge]=function(de,xe,Ie,we){let _e=0,Ae=1e100;for(let tt=0;tt<we.length;tt++){var $e,Fe=we[tt],ut=_(Fe[0]-de);ut>Ae||($e=Fe[1],(ut+=_($e-xe))>Ae||($e=Fe[2],(ut+=_($e-Ie))>Ae||(Ae=ut,_e=tt)))}return _e}(ue,fe,ce,Y);ae[oe]=ge}}return ae},default:()=>U,nearestColor:()=>function(G,Y,$=S){return G[C(G,Y,$)]},nearestColorIndex:()=>C,nearestColorIndexWithDistance:()=>P,prequantize:()=>function(G,{roundRGB:Y=5,roundAlpha:$=10,oneBitAlpha:H=null}={}){const Q=new Uint32Array(G.buffer);for(let W=0;W<Q.length;W++){var B=Q[W];let K=B>>24&255;var J,ae=B>>16&255,T=B>>8&255,B=255&B;K=k(K,$),H&&(J=typeof H=="number"?H:127,K=K<=J?0:255),B=k(B,Y),T=k(T,Y),ae=k(ae,Y),Q[W]=K<<24|ae<<16|T<<8|B<<0}},quantize:()=>function(G,Y,$={}){var{format:H="rgb565",clearAlpha:Q=!0,clearAlphaColor:J=0,clearAlphaThreshold:ae=0,oneBitAlpha:T=!1}=$;if(!G||!G.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(G instanceof Uint8Array||G instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");G=new Uint32Array(G.buffer);let B=$.useSqrt!==!1;const W=H==="rgba4444",K=function(rt,it){const nt=it==="rgb444"?4096:65536,Ee=new Array(nt),Ve=rt.length;if(it==="rgba4444")for(let Et=0;Et<Ve;++Et){var ee=rt[Et],Me=ee>>24&255,re=ee>>16&255,ie=ee>>8&255,ee=255&ee,le=g(ee,ie,re,Me);let dt=le in Ee?Ee[le]:Ee[le]=w();dt.rc+=ee,dt.gc+=ie,dt.bc+=re,dt.ac+=Me,dt.cnt++}else if(it==="rgb444")for(let Et=0;Et<Ve;++Et){var Ue=rt[Et],Se=Ue>>16&255,Pe=Ue>>8&255,Ue=255&Ue,Xe=b(Ue,Pe,Se);let dt=Xe in Ee?Ee[Xe]:Ee[Xe]=w();dt.rc+=Ue,dt.gc+=Pe,dt.bc+=Se,dt.cnt++}else for(let Et=0;Et<Ve;++Et){var at=rt[Et],Ze=at>>16&255,et=at>>8&255,at=255&at,At=y(at,et,Ze);let dt=At in Ee?Ee[At]:Ee[At]=w();dt.rc+=at,dt.gc+=et,dt.bc+=Ze,dt.cnt++}return Ee}(G,H),te=K.length,ne=te-1,ce=new Uint32Array(te+1);for(var fe=0,ue=0;ue<te;++ue){const rt=K[ue];rt!=null&&(Fe=1/rt.cnt,W&&(rt.ac*=Fe),rt.rc*=Fe,rt.gc*=Fe,rt.bc*=Fe,K[fe++]=rt)}v(Y)/fe<.022&&(B=!1);for(var ge,me,oe,ue=0;ue<fe-1;++ue)K[ue].fw=ue+1,K[ue+1].bk=ue,B&&(K[ue].cnt=Math.sqrt(K[ue].cnt));for(B&&(K[ue].cnt=Math.sqrt(K[ue].cnt)),ue=0;ue<fe;++ue){x(K,ue,!1);var de=K[ue].err;for(me=++ce[0];1<me&&(oe=me>>1,!(K[ge=ce[oe]].err<=de));me=oe)ce[me]=ge;ce[me]=ue}var xe,Ie=fe-Y;for(ue=0;ue<Ie;){for(;;){var we=ce[1];if((xe=K[we]).tm>=xe.mtm&&K[xe.nn].mtm<=xe.tm)break;for(xe.mtm==ne?we=ce[1]=ce[ce[0]--]:(x(K,we,!1),xe.tm=ue),de=K[we].err,me=1;(oe=me+me)<=ce[0]&&(oe<ce[0]&&K[ce[oe]].err>K[ce[oe+1]].err&&oe++,!(de<=K[ge=ce[oe]].err));me=oe)ce[me]=ge;ce[me]=we}var _e=K[xe.nn],Ae=xe.cnt,$e=_e.cnt,Fe=1/(Ae+$e);W&&(xe.ac=Fe*(Ae*xe.ac+$e*_e.ac)),xe.rc=Fe*(Ae*xe.rc+$e*_e.rc),xe.gc=Fe*(Ae*xe.gc+$e*_e.gc),xe.bc=Fe*(Ae*xe.bc+$e*_e.bc),xe.cnt+=_e.cnt,xe.mtm=++ue,K[_e.bk].fw=_e.fw,K[_e.fw].bk=_e.bk,_e.mtm=ne}let ut=[];for(ue=0;;0){let rt=m(Math.round(K[ue].rc),0,255),it=m(Math.round(K[ue].gc),0,255),nt=m(Math.round(K[ue].bc),0,255),Ee=255;W&&(Ee=m(Math.round(K[ue].ac),0,255),T&&(tt=typeof T=="number"?T:127,Ee=Ee<=tt?0:255),Q&&Ee<=ae&&(rt=it=nt=J,Ee=0));var tt=W?[rt,it,nt,Ee]:[rt,it,nt];if(function(Ve,Me){for(let ee=0;ee<Ve.length;ee++){var ie=Ve[ee],re=ie[0]===Me[0]&&ie[1]===Me[1]&&ie[2]===Me[2],ie=!(4<=ie.length&&4<=Me.length)||ie[3]===Me[3];if(re&&ie)return!0}return!1}(ut,tt)||ut.push(tt),(ue=K[ue].fw)==0)break}return ut},snapColorsToPalette:()=>function(G,Y,$=5){if(G.length&&Y.length){var H=G.map(B=>B.slice(0,3)),Q=$*$,J=G[0].length;for(let B=0;B<Y.length;B++){let W=Y[B];W=W.length<J?[W[0],W[1],W[2],255]:W.length>J?W.slice(0,3):W.slice();var T=P(H,W.slice(0,3),S),ae=T[0],T=T[1];0<T&&T<=Q&&(G[ae]=W)}}}};for(i in u)l(c,i,{get:u[i],enumerable:!0});var f={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function h(G=256){let Y=0,$=new Uint8Array(G);return{get buffer(){return $.buffer},reset(){Y=0},bytesView(){return $.subarray(0,Y)},bytes(){return $.slice(0,Y)},writeByte(Q){H(Y+1),$[Y]=Q,Y++},writeBytes(Q,J=0,ae=Q.length){H(Y+ae);for(let T=0;T<ae;T++)$[Y++]=Q[T+J]},writeBytesView(Q,J=0,ae=Q.byteLength){H(Y+ae),$.set(Q.subarray(J,J+ae),Y),Y+=ae}};function H(Q){var J=$.length;if(!(Q<=J)){Q=Math.max(Q,J*(J<1048576?2:1.125)>>>0),J!=0&&(Q=Math.max(Q,256));const ae=$;$=new Uint8Array(Q),0<Y&&$.set(ae.subarray(0,Y),0)}}}var d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],p=function(G,Y,$,W,Q=h(512),J=new Uint8Array(256),ae=new Int32Array(5003),T=new Int32Array(5003)){var B=ae.length,W=Math.max(2,W);J.fill(0),T.fill(0),ae.fill(-1);let K=0,te=0;var ne=W+1;const ce=ne;let fe=!1,ue=ce,ge=(1<<ue)-1;var me=1<<ne-1;const oe=1+me;let de=2+me,xe=0,Ie=$[0],we=0;for(let tt=B;tt<65536;tt*=2)++we;we=8-we,Q.writeByte(W),ut(me);var _e=$.length;for(let tt=1;tt<_e;tt++)e:{var Ae=$[tt],$e=(Ae<<12)+Ie;let rt=Ae<<we^Ie;if(ae[rt]===$e)Ie=T[rt];else{for(var Fe=rt===0?1:B-rt;0<=ae[rt];)if((rt-=Fe)<0&&(rt+=B),ae[rt]===$e){Ie=T[rt];break e}ut(Ie),Ie=Ae,de<4096?(T[rt]=de++,ae[rt]=$e):(ae.fill(-1),de=2+me,fe=!0,ut(me))}}return ut(Ie),ut(oe),Q.writeByte(0),Q.bytesView();function ut(tt){for(K&=d[te],0<te?K|=tt<<te:K=tt,te+=ue;8<=te;)J[xe++]=255&K,254<=xe&&(Q.writeByte(xe),Q.writeBytesView(J,0,xe),xe=0),K>>=8,te-=8;if((de>ge||fe)&&(fe?(ue=ce,ge=(1<<ue)-1,fe=!1):(++ue,ge=ue===12?1<<ue:(1<<ue)-1)),tt==oe){for(;0<te;)J[xe++]=255&K,254<=xe&&(Q.writeByte(xe),Q.writeBytesView(J,0,xe),xe=0),K>>=8,te-=8;0<xe&&(Q.writeByte(xe),Q.writeBytesView(J,0,xe),xe=0)}}};function y(G,Y,$){return G<<8&63488|Y<<2&992|$>>3}function g(G,Y,$,H){return G>>4|240&Y|(240&$)<<4|(240&H)<<8}function b(G,Y,$){return G>>4<<8|240&Y|$>>4}function m(G,Y,$){return G<Y?Y:$<G?$:G}function v(G){return G*G}function x(G,Y,$){var H=0,Q=1e100;const J=G[Y];for(var ae=J.cnt,T=J.ac,B=J.rc,W=J.gc,K=J.bc,te=J.fw;te!=0;te=G[te].fw){var ne,ce=G[te],fe=ce.cnt,fe=ae*fe/(ae+fe);Q<=fe||(ne=0,$&&Q<=(ne+=fe*v(ce.ac-T))||Q<=(ne+=fe*v(ce.rc-B))||Q<=(ne+=fe*v(ce.gc-W))||Q<=(ne+=fe*v(ce.bc-K))||(Q=ne,H=te))}J.err=Q,J.nn=H}function w(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function S(G,Y){for(var $=0,H=0;H<G.length;H++){var Q=G[H]-Y[H];$+=Q*Q}return $}function k(G,Y){return 1<Y?Math.round(G/Y)*Y:G}function _(G){return G*G}function C(G,Y,$=S){let H=1/0,Q=-1;for(let ae=0;ae<G.length;ae++){var J=$(Y,G[ae]);J<H&&(H=J,Q=ae)}return Q}function P(G,Y,$=S){let H=1/0,Q=-1;for(let ae=0;ae<G.length;ae++){var J=$(Y,G[ae]);J<H&&(H=J,Q=ae)}return[Q,H]}function A(G={}){const{initialCapacity:Y=4096,auto:$=!0}=G,H=h(Y),Q=new Uint8Array(256),J=new Int32Array(5003),ae=new Int32Array(5003);let T=!1;return{reset(){H.reset(),T=!1},finish(){H.writeByte(f.trailer)},bytes(){return H.bytes()},bytesView(){return H.bytesView()},get buffer(){return H.buffer},get stream(){return H},writeHeader:B,writeFrame(W,K,te,Ie={}){var{transparent:ce=!1,transparentIndex:fe=0,delay:Fe=0,palette:ue=null,repeat:_e=0,colorDepth:ge=8,dispose:me=-1}=Ie;let oe=!1;if($?T||(oe=!0,B(),T=!0):oe=!!Ie.first,K=Math.max(0,Math.floor(K)),te=Math.max(0,Math.floor(te)),oe){if(!ue)throw new Error("First frame must include a { palette } option");var[Ie,Ae,xe,$e,we=8]=[H,K,te,ue,ge];$e=F($e.length)-1,we=128|we-1<<4|$e,N(Ie,Ae),N(Ie,xe),Ie.writeBytes([we,0,0]),I(H,ue),0<=_e&&($e=H,Ae=_e,$e.writeByte(33),$e.writeByte(255),$e.writeByte(11),O($e,"NETSCAPE2.0"),$e.writeByte(3),$e.writeByte(1),N($e,Ae),$e.writeByte(0))}var de,xe=Math.round(Fe/10),Ie=H,we=me,_e=xe,Ae=ce,$e=fe,Fe=(Ie.writeByte(33),Ie.writeByte(249),Ie.writeByte(4),$e<0&&($e=0,Ae=!1),Ae=Ae?(de=1,2):de=0,0<=we&&(Ae=7&we),Ae<<=2,Ie.writeByte(0|Ae|de),N(Ie,_e),Ie.writeByte($e||0),Ie.writeByte(0),!!ue&&!oe);me=H,ce=K,fe=te,de=Fe?ue:null,me.writeByte(44),N(me,0),N(me,0),N(me,ce),N(me,fe),de?(ce=F(de.length)-1,me.writeByte(128|ce)):me.writeByte(0),Fe&&I(H,ue),[_e,Ie,fe,ce,me=8,Fe,ue,W]=[H,W,K,te,ge,Q,J,ae],p(fe,ce,Ie,me,_e,Fe,ue,W)}};function B(){O(H,"GIF89a")}}function I(G,Y){var $=1<<F(Y.length);for(let H=0;H<$;H++){let Q=[0,0,0];H<Y.length&&(Q=Y[H]),G.writeByte(Q[0]),G.writeByte(Q[1]),G.writeByte(Q[2])}}function N(G,Y){G.writeByte(255&Y),G.writeByte(Y>>8&255)}function O(G,Y){for(var $=0;$<Y.length;$++)G.writeByte(Y.charCodeAt($))}function F(G){return Math.max(Math.ceil(Math.log2(G)),1)}var U=A},{}],251:[function(r,s,a){a.read=function(i,l,c,u,x){var h,d,p=8*x-u-1,y=(1<<p)-1,g=y>>1,b=-7,m=c?x-1:0,v=c?-1:1,x=i[l+m];for(m+=v,h=x&(1<<-b)-1,x>>=-b,b+=p;0<b;h=256*h+i[l+m],m+=v,b-=8);for(d=h&(1<<-b)-1,h>>=-b,b+=u;0<b;d=256*d+i[l+m],m+=v,b-=8);if(h===0)h=1-g;else{if(h===y)return d?NaN:1/0*(x?-1:1);d+=Math.pow(2,u),h-=g}return(x?-1:1)*d*Math.pow(2,h-u)},a.write=function(i,l,c,u,f,w){var d,p,y=8*w-f-1,g=(1<<y)-1,b=g>>1,m=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=u?0:w-1,x=u?1:-1,w=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(p=isNaN(l)?1:0,d=g):(d=Math.floor(Math.log(l)/Math.LN2),l*(u=Math.pow(2,-d))<1&&(d--,u*=2),2<=(l+=1<=d+b?m/u:m*Math.pow(2,1-b))*u&&(d++,u/=2),g<=d+b?(p=0,d=g):1<=d+b?(p=(l*u-1)*Math.pow(2,f),d+=b):(p=l*Math.pow(2,b-1)*Math.pow(2,f),d=0));8<=f;i[c+v]=255&p,v+=x,p/=256,f-=8);for(d=d<<f|p,y+=f;0<y;i[c+v]=255&d,v+=x,d/=256,y-=8);i[c+v-x]|=128*w}},{}],252:[function(r,s,a){var i;function l(re,ie){return re.b===ie.b&&re.a===ie.a}function c(re,ie){return re.b<ie.b||re.b===ie.b&&re.a<=ie.a}function u(re,ie,ee){var le=ie.b-re.b,Se=ee.b-ie.b;return 0<le+Se?le<Se?ie.a-re.a+le/(le+Se)*(re.a-ee.a):ie.a-ee.a+Se/(le+Se)*(ee.a-re.a):0}function f(re,ie,ee){var le=ie.b-re.b,Se=ee.b-ie.b;return 0<le+Se?(ie.a-ee.a)*le+(ie.a-re.a)*Se:0}function h(re,ie){return re.a<ie.a||re.a===ie.a&&re.b<=ie.b}function d(re,ie,ee){var le=ie.a-re.a,Se=ee.a-ie.a;return 0<le+Se?le<Se?ie.b-re.b+le/(le+Se)*(re.b-ee.b):ie.b-ee.b+Se/(le+Se)*(ee.b-re.b):0}function p(re,ie,ee){var le=ie.a-re.a,Se=ee.a-ie.a;return 0<le+Se?(ie.b-ee.b)*le+(ie.b-re.b)*Se:0}function y(re,ie,ee,le){return(re=re<0?0:re)<=(ee=ee<0?0:ee)?ee===0?(ie+le)/2:ie+re/(re+ee)*(le-ie):le+ee/(re+ee)*(ie-le)}function g(re){var ie=w(re.b);return k(ie,re.c),k(ie.b,re.c),_(ie,re.a),ie}function b(re,ie){var ee=!1,le=!1;re!==ie&&(ie.a!==re.a&&(le=!0,P(ie.a,re.a)),ie.d!==re.d&&(ee=!0,A(ie.d,re.d)),S(ie,re),le||(k(ie,re.a),re.a.c=re),ee||(_(ie,re.d),re.d.a=re))}function m(re){var ie=re.b,ee=!1;re.d!==re.b.d&&(ee=!0,A(re.d,re.b.d)),re.c===re?P(re.a,null):(re.b.d.a=re.b.e,re.a.c=re.c,S(re,re.b.e),ee||_(re,re.d)),ie.c===ie?(P(ie.a,null),A(ie.d,null)):(re.d.a=ie.b.e,ie.a.c=ie.c,S(ie,ie.b.e)),C(re)}function v(re){var ie=w(re),ee=ie.b;return S(ie,re.e),ie.a=re.b.a,k(ee,ie.a),ie.d=ee.d=re.d,ie=ie.b,S(re.b,re.b.b.e),S(re.b,ie),re.b.a=ie.a,ie.b.a.c=ie.b,ie.b.d=re.b.d,ie.f=re.f,ie.b.f=re.b.f,ie}function x(re,ie){var ee=!1,le=w(re),Se=le.b;return ie.d!==re.d&&(ee=!0,A(ie.d,re.d)),S(le,re.e),S(Se,ie),le.a=re.b.a,Se.a=ie.a,le.d=Se.d=re.d,re.d.a=Se,ee||_(le,re.d),le}function w(re){var ie=new xe,ee=new xe,le=re.b.h;return(((ee.h=le).b.h=ie).h=re).b.h=ee,ie.b=ee,((ie.c=ie).e=ee).b=ie,(ee.c=ee).e=ie}function S(re,ie){var ee=re.c,le=ie.c;ee.b.e=ie,(le.b.e=re).c=le,ie.c=ee}function k(re,ie){var ee=ie.f,le=new we(ie,ee);for(ee.e=le,ee=(ie.f=le).c=re;ee.a=le,(ee=ee.c)!==re;);}function _(re,ie){var ee=ie.d,le=new de(ie,ee);for(ee.b=le,(ie.d=le).a=re,le.c=ie.c,ee=re;ee.d=le,(ee=ee.e)!==re;);}function C(re){var ie=re.h;re=re.b.h,(ie.b.h=re).b.h=ie}function P(re,ie){for(var ee=re.c,le=ee;le.a=ie,(le=le.c)!==ee;);ee=re.f,((le=re.e).f=ee).e=le}function A(re,ie){for(var ee=re.a,le=ee;le.d=ie,(le=le.e)!==ee;);ee=re.d,((le=re.b).d=ee).b=le}function I(re){var ie=0;return Math.abs(re[1])>Math.abs(re[0])&&(ie=1),ie=Math.abs(re[2])>Math.abs(re[ie])?2:ie}function N(re,ie){re.f+=ie.f,re.b.f+=ie.b.f}function O(re,ie,ee){return re=re.a,ie=ie.a,ee=ee.a,ie.b.a===re?ee.b.a===re?c(ie.a,ee.a)?f(ee.b.a,ie.a,ee.a)<=0:0<=f(ie.b.a,ee.a,ie.a):f(ee.b.a,re,ee.a)<=0:ee.b.a===re?0<=f(ie.b.a,re,ie.a):(ie=u(ie.b.a,re,ie.a),(re=u(ee.b.a,re,ee.a))<=ie)}function F(re){re.a.i=null;var ie=re.e;ie.a.c=ie.c,ie.c.a=ie.a,re.e=null}function U(re,ie){m(re.a),re.c=!1,(re.a=ie).i=re}function G(re){for(var ie=re.a.a;(re=Me(re)).a.a===ie;);return re.c&&(U(re,ie=x(Ve(re).a.b,re.a.e)),re=Me(re)),re}function Y(re,ie,ee){var le=new Ee;return le.a=ee,le.e=fe(re.f,ie.e,le),ee.i=le}function $(re,ie){switch(re.s){case 100130:return(1&ie)!=0;case 100131:return ie!==0;case 100132:return 0<ie;case 100133:return ie<0;case 100134:return 2<=ie||ie<=-2}return!1}function H(re){var ie=re.a,ee=ie.d;ee.c=re.d,ee.a=ie,F(re)}function Q(re,ie,ee){for(ie=(re=ie).a;re!==ee;){re.c=!1;var le=Ve(re),Se=le.a;if(Se.a!==ie.a){if(!le.c){H(re);break}U(le,Se=x(ie.c.b,Se.b))}ie.c!==Se&&(b(Se.b.e,Se),b(ie,Se)),H(re),ie=le.a,re=le}return ie}function J(re,ie,ee,le,Se,Pe){for(var Ue=!0;Y(re,ie,ee.b),(ee=ee.c)!==le;);for(Se===null&&(Se=Ve(ie).a.b.c);(ee=(le=Ve(ie)).a.b).a===Se.a;)ee.c!==Se&&(b(ee.b.e,ee),b(Se.b.e,ee)),le.f=ie.f-ee.f,le.d=$(re,le.f),ie.b=!0,!Ue&&W(re,ie)&&(N(ee,Se),F(ie),m(Se)),Ue=!1,ie=le,Se=ee;ie.b=!0,Pe&&te(re,ie)}function ae(re,ie,ee,le,Se){var Pe=[ie.g[0],ie.g[1],ie.g[2]];ie.d=null,ie.d=re.o&&re.o(Pe,ee,le,re.c)||null,ie.d===null&&(Se?re.n||(oe(re,100156),re.n=!0):ie.d=ee[0])}function T(re,ie,ee){var le=[null,null,null,null];le[0]=ie.a.d,le[1]=ee.a.d,ae(re,ie.a,le,[.5,.5,0,0],!1),b(ie,ee)}function B(re,ie,ee,le,Se){var Pe=Math.abs(ie.b-re.b)+Math.abs(ie.a-re.a),Ue=Math.abs(ee.b-re.b)+Math.abs(ee.a-re.a),Xe=Se+1;le[Se]=.5*Ue/(Pe+Ue),le[Xe]=.5*Pe/(Pe+Ue),re.g[0]+=le[Se]*ie.g[0]+le[Xe]*ee.g[0],re.g[1]+=le[Se]*ie.g[1]+le[Xe]*ee.g[1],re.g[2]+=le[Se]*ie.g[2]+le[Xe]*ee.g[2]}function W(re,ie){var ee=Ve(ie),le=ie.a,Se=ee.a;if(c(le.a,Se.a)){if(0<f(Se.b.a,le.a,Se.a))return;if(l(le.a,Se.a)){if(le.a!==Se.a){var ee=re.e,Pe=le.a.h;if(0<=Pe){var Ue=(ee=ee.b).d,Xe=ee.e,Ze=ee.c,et=Ze[Pe];Ue[et]=Ue[ee.a],(Ze[Ue[et]]=et)<=--ee.a&&(et<=1||c(Xe[Ue[et>>1]],Xe[Ue[et]])?it:nt)(ee,et),Xe[Pe]=null,Ze[Pe]=ee.b,ee.b=Pe}else for(ee.c[-(Pe+1)]=null;0<ee.a&&ee.c[ee.d[ee.a-1]]===null;)--ee.a;T(re,Se.b.e,le)}}else v(Se.b),b(le,Se.b.e),ie.b=ee.b=!0}else{if(f(le.b.a,Se.a,le.a)<0)return;Me(ie).b=ie.b=!0,v(le.b),b(Se.b.e,le)}return 1}function K(re,ie){var ee=Ve(ie),le=ie.a,Se=ee.a,Pe=le.a,Ue=Se.a,Xe=le.b.a,Ze=Se.b.a,et=new we;if(f(Xe,re.a,Pe),f(Ze,re.a,Ue),!(Pe===Ue||Math.min(Pe.a,Xe.a)>Math.max(Ue.a,Ze.a))){if(c(Pe,Ue)){if(0<f(Ze,Pe,Ue))return}else if(f(Xe,Ue,Pe)<0)return;var at,At,Et=Xe,dt=Pe,Ct=Ze,kt=Ue;if(c(Et,dt)||(at=Et,Et=dt,dt=at),c(Ct,kt)||(at=Ct,Ct=kt,kt=at),c(Et,Ct)||(at=Et,Et=Ct,Ct=at,at=dt,dt=kt,kt=at),c(Ct,dt)?c(dt,kt)?((at=u(Et,Ct,dt))+(At=u(Ct,dt,kt))<0&&(at=-at,At=-At),et.b=y(at,Ct.b,At,dt.b)):((at=f(Et,Ct,dt))+(At=-f(Et,kt,dt))<0&&(at=-at,At=-At),et.b=y(at,Ct.b,At,kt.b)):et.b=(Ct.b+dt.b)/2,h(Et,dt)||(at=Et,Et=dt,dt=at),h(Ct,kt)||(at=Ct,Ct=kt,kt=at),h(Et,Ct)||(at=Et,Et=Ct,Ct=at,at=dt,dt=kt,kt=at),h(Ct,dt)?h(dt,kt)?((at=d(Et,Ct,dt))+(At=d(Ct,dt,kt))<0&&(at=-at,At=-At),et.a=y(at,Ct.a,At,dt.a)):((at=p(Et,Ct,dt))+(At=-p(Et,kt,dt))<0&&(at=-at,At=-At),et.a=y(at,Ct.a,At,kt.a)):et.a=(Ct.a+dt.a)/2,c(et,re.a)&&(et.b=re.a.b,et.a=re.a.a),Et=c(Pe,Ue)?Pe:Ue,c(Et,et)&&(et.b=Et.b,et.a=Et.a),l(et,Pe)||l(et,Ue))return W(re,ie),0;if(!l(Xe,re.a)&&0<=f(Xe,re.a,et)||!l(Ze,re.a)&&f(Ze,re.a,et)<=0){if(Ze===re.a)v(le.b),b(Se.b,le),le=Ve(ie=G(ie)).a,Q(re,Ve(ie),ee),J(re,ie,le.b.e,le,le,!0);else{if(Xe!==re.a)return 0<=f(Xe,re.a,et)&&(Me(ie).b=ie.b=!0,v(le.b),le.a.b=re.a.b,le.a.a=re.a.a),void(f(Ze,re.a,et)<=0&&(ie.b=ee.b=!0,v(Se.b),Se.a.b=re.a.b,Se.a.a=re.a.a));for(v(Se.b),b(le.e,Se.b.e),Ue=(Pe=ee=ie).a.b.a;(Pe=Me(Pe)).a.b.a===Ue;);Pe=Ve(ie=Pe).a.b.c,ee.a=Se.b.e,J(re,ie,(Se=Q(re,ee,null)).c,le.b.c,Pe,!0)}return 1}v(le.b),v(Se.b),b(Se.b.e,le),le.a.b=et.b,le.a.a=et.a,le.a.h=Ae(re.e,le.a),le=le.a,Se=[0,0,0,0],et=[Pe.d,Xe.d,Ue.d,Ze.d],le.g[0]=le.g[1]=le.g[2]=0,B(le,Pe,Xe,Se,0),B(le,Ue,Ze,Se,2),ae(re,le,et,Se,!0),Me(ie).b=ie.b=ee.b=!0}}function te(re,ie){for(var ee=Ve(ie);;){for(;ee.b;)ee=Ve(ie=ee);if(!ie.b&&((ie=Me(ee=ie))===null||!ie.b))break;ie.b=!1;var le=ie.a,Se=ee.a;if(Pe=le.b.a!==Se.b.a)e:{var Pe,Ue=Ve(Pe=ie),Xe=Pe.a,Ze=Ue.a,et=void 0;if(c(Xe.b.a,Ze.b.a)){if(f(Xe.b.a,Ze.b.a,Xe.a)<0){Pe=!1;break e}Me(Pe).b=Pe.b=!0,et=v(Xe),b(Ze.b,et),et.d.c=Pe.d}else{if(0<f(Ze.b.a,Xe.b.a,Ze.a)){Pe=!1;break e}Pe.b=Ue.b=!0,et=v(Ze),b(Xe.e,Ze.b),et.b.d.c=Pe.d}Pe=!0}if(Pe&&(ee.c?(F(ee),m(Se),Se=(ee=Ve(ie)).a):ie.c&&(F(ie),m(le),le=(ie=Me(ee)).a)),le.a!==Se.a){if(le.b.a===Se.b.a||ie.c||ee.c||le.b.a!==re.a&&Se.b.a!==re.a)W(re,ie);else if(K(re,ie))break}le.a===Se.a&&le.b.a===Se.b.a&&(N(Se,le),F(ie),m(le),ie=Me(ee))}}function ne(re,ie){var ee=new Ee,le=g(re.b);le.a.b=4e150,le.a.a=ie,le.b.a.b=-4e150,le.b.a.a=ie,re.a=le.b.a,ee.a=le,ee.f=0,ee.d=!1,ee.c=!1,ee.h=!0,ee.b=!1,le=fe(le=re.f,le.a,ee),ee.e=le}function ce(re){this.a=new ue,this.b=re,this.c=O}function fe(re,ie,ee){for(;(ie=ie.c).b!==null&&!re.c(re.b,ie.b,ee););return re=new ue(ee,ie.a,ie),ie.a.c=re,ie.a=re}function ue(re,ie,ee){this.b=re||null,this.a=ie||this,this.c=ee||this}function ge(){this.d=0,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}function me(re,ie){if(re.d!==ie)for(;re.d!==ie;)if(re.d<ie)switch(re.d){case 0:oe(re,100151),re.u(null);break;case 1:oe(re,100152),re.t()}else switch(re.d){case 2:oe(re,100154),re.v();break;case 1:oe(re,100153),re.w()}}function oe(re,ie){re.p&&re.p(ie,re.c)}function de(re,ie){this.b=re||this,this.d=ie||this,this.a=null,this.c=!1}function xe(){(this.h=this).i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function Ie(){this.c=new we,this.a=new de,this.b=new xe,this.d=new xe,this.b.b=this.d,this.d.b=this.b}function we(re,ie){this.e=re||this,this.f=ie||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function _e(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Fe}function Ae(re,ie){var ee,le,Se;return re.e?(2*(le=++(ee=re.b).a)>ee.f&&(ee.f*=2,ee.c=ut(ee.c,ee.f+1)),ee.b===0?Se=le:(Se=ee.b,ee.b=ee.c[ee.b]),ee.e[Se]=ie,ee.c[Se]=le,ee.d[le]=Se,ee.h&&nt(ee,le),Se):(ee=re.a++,re.c[ee]=ie,-(ee+1))}function $e(re){if(re.a===0)return rt(re.b);var ie=re.c[re.d[re.a-1]];if(re.b.a!==0&&c(tt(re.b),ie))return rt(re.b);for(;--re.a,0<re.a&&re.c[re.d[re.a-1]]===null;);return ie}function Fe(){this.d=ut([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function ut(re,ie){for(var ee=Array(ie),le=0;le<re.length;le++)ee[le]=re[le];for(;le<ie;le++)ee[le]=0;return ee}function tt(re){return re.e[re.d[1]]}function rt(re){var ie=re.d,ee=re.e,le=re.c,Se=ie[1],Pe=ee[Se];return 0<re.a&&(ie[1]=ie[re.a],le[ie[1]]=1,ee[Se]=null,le[Se]=re.b,re.b=Se,0<--re.a&&it(re,1)),Pe}function it(re,ie){for(var ee=re.d,le=re.e,Se=re.c,Pe=ie,Ue=ee[Pe];;){var Xe=Pe<<1,Ze=(Xe<re.a&&c(le[ee[Xe+1]],le[ee[Xe]])&&(Xe+=1),ee[Xe]);if(Xe>re.a||c(le[Ue],le[Ze])){Se[ee[Pe]=Ue]=Pe;break}Se[ee[Pe]=Ze]=Pe,Pe=Xe}}function nt(re,ie){for(var ee=re.d,le=re.e,Se=re.c,Pe=ie,Ue=ee[Pe];;){var Xe=Pe>>1,Ze=ee[Xe];if(Xe==0||c(le[Ze],le[Ue])){Se[ee[Pe]=Ue]=Pe;break}Se[ee[Pe]=Ze]=Pe,Pe=Xe}}function Ee(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function Ve(re){return re.e.c.b}function Me(re){return re.e.a.b}(i=ge.prototype).x=function(){me(this,0)},i.B=function(re,ie){switch(re){case 100142:return;case 100140:switch(ie){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=ie)}break;case 100141:return void(this.m=!!ie);default:return void oe(this,100900)}oe(this,100901)},i.y=function(re){switch(re){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:oe(this,100900)}return!1},i.A=function(re,ie,ee){this.j[0]=re,this.j[1]=ie,this.j[2]=ee},i.z=function(re,ie){var ee=ie||null;switch(re){case 100100:case 100106:this.h=ee;break;case 100104:case 100110:this.l=ee;break;case 100101:case 100107:this.k=ee;break;case 100102:case 100108:this.i=ee;break;case 100103:case 100109:this.p=ee;break;case 100105:case 100111:this.o=ee;break;case 100112:this.r=ee;break;default:oe(this,100900)}},i.C=function(re,ie){var ee=!1,le=[0,0,0];me(this,2);for(var Se=0;Se<3;++Se){var Pe=re[Se];Pe<-1e150&&(Pe=-1e150,ee=!0),1e150<Pe&&(Pe=1e150,ee=!0),le[Se]=Pe}ee&&oe(this,100155),(ee=this.q)===null?b(ee=g(this.b),ee.b):(v(ee),ee=ee.e),ee.a.d=ie,ee.a.g[0]=le[0],ee.a.g[1]=le[1],ee.a.g[2]=le[2],ee.f=1,ee.b.f=-1,this.q=ee},i.u=function(re){me(this,0),this.d=1,this.b=new Ie,this.c=re},i.t=function(){me(this,1),this.d=2,this.q=null},i.v=function(){me(this,2),this.d=1},i.w=function(){me(this,1),this.d=0;var re,ie,ee=this.j[0],le=this.j[1],Se=this.j[2],Pe=!1,Ue=[ee,le,Se];if(ee===0&&le===0&&Se===0){for(var le=[-2e150,-2e150,-2e150],Xe=[2e150,2e150,2e150],Se=[],Ze=[],ee=(Pe=this.b.c).e;ee!==Pe;ee=ee.e)for(var et=0;et<3;++et){var at=ee.g[et];at<Xe[et]&&(Xe[et]=at,Ze[et]=ee),at>le[et]&&(le[et]=at,Se[et]=ee)}if(le[1]-Xe[1]>le[ee=0]-Xe[0]&&(ee=1),Xe[ee=le[2]-Xe[2]>le[ee]-Xe[ee]?2:ee]>=le[ee])Ue[0]=0,Ue[1]=0,Ue[2]=1;else{for(Xe=Ze[ee],Se=Se[ee],Ze=[le=0,0,0],Xe=[Xe.g[0]-Se.g[0],Xe.g[1]-Se.g[1],Xe.g[2]-Se.g[2]],et=[0,0,0],ee=Pe.e;ee!==Pe;ee=ee.e)et[0]=ee.g[0]-Se.g[0],et[1]=ee.g[1]-Se.g[1],et[2]=ee.g[2]-Se.g[2],Ze[0]=Xe[1]*et[2]-Xe[2]*et[1],Ze[1]=Xe[2]*et[0]-Xe[0]*et[2],Ze[2]=Xe[0]*et[1]-Xe[1]*et[0],le<(at=Ze[0]*Ze[0]+Ze[1]*Ze[1]+Ze[2]*Ze[2])&&(le=at,Ue[0]=Ze[0],Ue[1]=Ze[1],Ue[2]=Ze[2]);le<=0&&(Ue[0]=Ue[1]=Ue[2]=0,Ue[I(Xe)]=1)}Pe=!0}for(Ze=I(Ue),ee=this.b.c,le=(Ze+1)%3,Se=(Ze+2)%3,Ze=0<Ue[Ze]?1:-1,Ue=ee.e;Ue!==ee;Ue=Ue.e)Ue.b=Ue.g[le],Ue.a=Ze*Ue.g[Se];if(Pe){for(Ue=0,ee=(Pe=this.b.a).b;ee!==Pe;ee=ee.b)if(!((le=ee.a).f<=0))for(;Ue+=(le.a.b-le.b.a.b)*(le.a.a+le.b.a.a),(le=le.e)!==ee.a;);if(Ue<0)for(Pe=(Ue=this.b.c).e;Pe!==Ue;Pe=Pe.e)Pe.a=-Pe.a}for(this.n=!1,Ue=this.b.b,ee=Ue.h;ee!==Ue;ee=Pe)Pe=ee.h,le=ee.e,l(ee.a,ee.b.a)&&ee.e.e!==ee&&(T(this,le,ee),m(ee),le=(ee=le).e),le.e===ee&&(le!==ee&&(le!==Pe&&le!==Pe.b||(Pe=Pe.h),m(le)),ee!==Pe&&ee!==Pe.b||(Pe=Pe.h),m(ee));for(this.e=Ue=new _e,Pe=this.b.c,ee=Pe.e;ee!==Pe;ee=ee.e)ee.h=Ae(Ue,ee);var At=Ue;At.d=[];for(var Et=0;Et<At.a;Et++)At.d[Et]=Et;At.d.sort(function(kt){return function(rr,Wr){return c(kt[rr],kt[Wr])?1:-1}}(At.c)),At.e=!0;for(var dt=At.b,Ct=dt.a;1<=Ct;--Ct)it(dt,Ct);for(dt.h=!0,this.f=new ce(this),ne(this,-4e150),ne(this,4e150);(Ue=$e(this.e))!==null;){for(;;){e:if((ee=this.e).a===0)Pe=tt(ee.b);else if(Pe=ee.c[ee.d[ee.a-1]],ee.b.a!==0&&c(ee=tt(ee.b),Pe)){Pe=ee;break e}if(Pe===null||!l(Pe,Ue))break;Pe=$e(this.e),T(this,Ue.c,Pe.c)}(function kt(rr,Wr){for(var $r,Zt=(rr.a=Wr).c;Zt.i===null;)if((Zt=Zt.c)===Wr.c){var Zt=rr,fr=Wr;(Jt=new Ee).a=fr.c.b;for(var kr=(Wt=Zt.f).a;(kr=kr.a).b!==null&&!Wt.c(Wt.b,Jt,kr.b););var Wt,fn,Qr=Ve(Wt=kr.b),Jt=Wt.a,kr=Qr.a;return void(f(Jt.b.a,fr,Jt.a)===0?l((Jt=Wt.a).a,fr)||l(Jt.b.a,fr)||(v(Jt.b),Wt.c&&(m(Jt.c),Wt.c=!1),b(fr.c,Jt),kt(Zt,fr)):(fn=c(kr.b.a,Jt.b.a)?Wt:Qr,Qr=void 0,Wt.d||fn.c?(Qr=fn===Wt?x(fr.c.b,Jt.e):x(kr.b.c.b,fr.c).b,fn.c?U(fn,Qr):((Wt=Y(Jt=Zt,Wt,Qr)).f=Me(Wt).f+Wt.a.f,Wt.d=$(Jt,Wt.f)),kt(Zt,fr)):J(Zt,Wt,fr.c,fr.c,null,!0)))}Wt=(Jt=Ve(Zt=G(Zt.i))).a,(Jt=Q(rr,Jt,null)).c===Wt?(Jt=(Wt=Jt).c,kr=Ve(Zt),Qr=Zt.a,fn=kr.a,$r=!1,Qr.b.a!==fn.b.a&&K(rr,Zt),l(Qr.a,rr.a)&&(b(Jt.b.e,Qr),Jt=Ve(Zt=G(Zt)).a,Q(rr,Ve(Zt),kr),$r=!0),l(fn.a,rr.a)&&(b(Wt,fn.b.e),Wt=Q(rr,kr,null),$r=!0),$r?J(rr,Zt,Wt.c,Jt,Jt,!0):(fr=c(fn.a,Qr.a)?fn.b.e:Qr,J(rr,Zt,fr=x(Wt.c.b,fr),fr.c,fr.c,!1),fr.b.i.c=!0,te(rr,Zt))):J(rr,Zt,Jt.c,Wt,Wt,!0)})(this,Ue)}for(this.a=this.f.a.a.b.a.a,Ue=0;(Pe=this.f.a.a.b)!==null;)Pe.h||++Ue,F(Pe);for(this.f=null,(Ue=this.e).b=null,Ue.d=null,this.e=Ue.c=null,Ue=this.b,ee=Ue.a.b;ee!==Ue.a;ee=Pe)Pe=ee.b,(ee=ee.a).e.e===ee&&(N(ee.c,ee),m(ee));if(!this.n){if(Ue=this.b,this.m)for(ee=Ue.b.h;ee!==Ue.b;ee=Pe)Pe=ee.h,ee.b.d.c!==ee.d.c?ee.f=ee.d.c?1:-1:m(ee);else for(ee=Ue.a.b;ee!==Ue.a;ee=Pe)if(Pe=ee.b,ee.c){for(ee=ee.a;c(ee.b.a,ee.a);ee=ee.c.b);for(;c(ee.a,ee.b.a);ee=ee.e);for(le=ee.c.b,Se=void 0;ee.e!==le;)if(c(ee.b.a,le.a)){for(;le.e!==ee&&(c((ie=le.e).b.a,ie.a)||f(le.a,le.b.a,le.e.b.a)<=0);)le=(Se=x(le.e,le)).b;le=le.c.b}else{for(;le.e!==ee&&(c((re=ee.c.b).a,re.b.a)||0<=f(ee.b.a,ee.a,ee.c.b.a));)ee=(Se=x(ee,ee.c.b)).b;ee=ee.e}for(;le.e.e!==ee;)Se=x(le.e,le),le=Se.b}if(this.h||this.i||this.k||this.l)if(this.m){for(Pe=(Ue=this.b).a.b;Pe!==Ue.a;Pe=Pe.b)if(Pe.c){for(this.h&&this.h(2,this.c),ee=Pe.a;this.k&&this.k(ee.a.d,this.c),(ee=ee.e)!==Pe.a;);this.i&&this.i(this.c)}}else{for(Ue=this.b,Pe=!!this.l,ee=!1,le=-1,Se=Ue.a.d;Se!==Ue.a;Se=Se.d)if(Se.c)for(ee||(this.h&&this.h(4,this.c),ee=!0),Ze=Se.a;Pe&&(Xe=Ze.b.d.c?0:1,le!==Xe&&(le=Xe,this.l&&this.l(!!le,this.c))),this.k&&this.k(Ze.a.d,this.c),(Ze=Ze.e)!==Se.a;);ee&&this.i&&this.i(this.c)}if(this.r){for(Ue=this.b,ee=Ue.a.b;ee!==Ue.a;ee=Pe)if(Pe=ee.b,!ee.c){for(Se=(le=ee.a).e,Ze=void 0;Se=(Ze=Se).e,(Ze.d=null)===Ze.b.d&&(Ze.c===Ze?P(Ze.a,null):(Ze.a.c=Ze.c,S(Ze,Ze.b.e)),(Xe=Ze.b).c===Xe?P(Xe.a,null):(Xe.a.c=Xe.c,S(Xe,Xe.b.e)),C(Ze)),Ze!==le;);le=ee.d,((ee=ee.b).d=le).b=ee}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:ge,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},ge.prototype.gluDeleteTess=ge.prototype.x,ge.prototype.gluTessProperty=ge.prototype.B,ge.prototype.gluGetTessProperty=ge.prototype.y,ge.prototype.gluTessNormal=ge.prototype.A,ge.prototype.gluTessCallback=ge.prototype.z,ge.prototype.gluTessVertex=ge.prototype.C,ge.prototype.gluTessBeginPolygon=ge.prototype.u,ge.prototype.gluTessBeginContour=ge.prototype.t,ge.prototype.gluTessEndContour=ge.prototype.v,ge.prototype.gluTessEndPolygon=ge.prototype.w,s!==void 0&&(s.exports=this.libtess)},{}],253:[function(r,s,a){function i(c,u,f,h){var d=0,p=(h=h===void 0?{}:h).loop===void 0?null:h.loop,y=h.palette===void 0?null:h.palette;if(u<=0||f<=0||65535<u||65535<f)throw new Error("Width/Height invalid.");function g(_){if(_=_.length,_<2||256<_||_&_-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return _}c[d++]=71,c[d++]=73,c[d++]=70,c[d++]=56,c[d++]=57,c[d++]=97;var b=0,m=0;if(y!==null){for(var v=g(y);v>>=1;)++b;if(v=1<<b,--b,h.background!==void 0){if(v<=(m=h.background))throw new Error("Background index out of range.");if(m===0)throw new Error("Background index explicitly passed as 0.")}}if(c[d++]=255&u,c[d++]=u>>8&255,c[d++]=255&f,c[d++]=f>>8&255,c[d++]=(y!==null?128:0)|b,c[d++]=m,c[d++]=0,y!==null)for(var x=0,w=y.length;x<w;++x){var S=y[x];c[d++]=S>>16&255,c[d++]=S>>8&255,c[d++]=255&S}if(p!==null){if(p<0||65535<p)throw new Error("Loop count invalid.");c[d++]=33,c[d++]=255,c[d++]=11,c[d++]=78,c[d++]=69,c[d++]=84,c[d++]=83,c[d++]=67,c[d++]=65,c[d++]=80,c[d++]=69,c[d++]=50,c[d++]=46,c[d++]=48,c[d++]=3,c[d++]=1,c[d++]=255&p,c[d++]=p>>8&255,c[d++]=0}var k=!1;this.addFrame=function(_,C,P,A,I,N){if(k===!0&&(--d,k=!1),N=N===void 0?{}:N,_<0||C<0||65535<_||65535<C)throw new Error("x/y invalid.");if(P<=0||A<=0||65535<P||65535<A)throw new Error("Width/Height invalid.");if(I.length<P*A)throw new Error("Not enough pixels for the frame size.");var O=!0,F=N.palette;if(F==null&&(O=!1,F=y),F==null)throw new Error("Must supply either a local or global palette.");for(var G=g(F),U=0;G>>=1;)++U;var G=1<<U,Y=N.delay===void 0?0:N.delay,$=N.disposal===void 0?0:N.disposal;if($<0||3<$)throw new Error("Disposal out of range.");var H=!1,Q=0;if(N.transparent!==void 0&&N.transparent!==null&&(H=!0,(Q=N.transparent)<0||G<=Q))throw new Error("Transparent color index.");if($===0&&!H&&Y===0||(c[d++]=33,c[d++]=249,c[d++]=4,c[d++]=$<<2|(H===!0?1:0),c[d++]=255&Y,c[d++]=Y>>8&255,c[d++]=Q,c[d++]=0),c[d++]=44,c[d++]=255&_,c[d++]=_>>8&255,c[d++]=255&C,c[d++]=C>>8&255,c[d++]=255&P,c[d++]=P>>8&255,c[d++]=255&A,c[d++]=A>>8&255,c[d++]=O===!0?128|U-1:0,O===!0)for(var J=0,ae=F.length;J<ae;++J){var T=F[J];c[d++]=T>>16&255,c[d++]=T>>8&255,c[d++]=255&T}return d=function(B,W,K,te){B[W++]=K;var ne=W++,ce=1<<K,fe=ce-1,ue=1+ce,ge=1+ue,me=K+1,oe=0,de=0;function xe(rt){for(;rt<=oe;)B[W++]=255&de,de>>=8,oe-=8,W===ne+256&&(B[ne]=255,ne=W++)}function Ie(rt){de|=rt<<oe,oe+=me,xe(8)}var we=te[0]&fe,_e={};Ie(ce);for(var Ae=1,$e=te.length;Ae<$e;++Ae){var Fe=te[Ae]&fe,ut=we<<8|Fe,tt=_e[ut];if(tt===void 0){for(de|=we<<oe,oe+=me;8<=oe;)B[W++]=255&de,de>>=8,oe-=8,W===ne+256&&(B[ne]=255,ne=W++);ge===4096?(Ie(ce),ge=1+ue,me=K+1,_e={}):(1<<me<=ge&&++me,_e[ut]=ge++),we=Fe}else we=tt}return Ie(we),Ie(ue),xe(1),ne+1===W?B[ne]=0:(B[ne]=W-ne-1,B[W++]=0),W}(c,d,U<2?2:U,I)},this.end=function(){return k===!1&&(c[d++]=59,k=!0),d},this.getOutputBuffer=function(){return c},this.setOutputBuffer=function(_){c=_},this.getOutputBufferPosition=function(){return d},this.setOutputBufferPosition=function(_){d=_}}function l(c,u,f,h){for(var d=c[u++],p=1<<d,y=1+p,g=1+y,b=d+1,m=(1<<b)-1,v=0,x=0,w=0,S=c[u++],k=new Int32Array(4096),_=null;;){for(;v<16&&S!==0;)x|=c[u++]<<v,v+=8,S===1?S=c[u++]:--S;if(v<b)break;var C=x&m;if(x>>=b,v-=b,C==p)g=1+y,m=(1<<(b=d+1))-1,_=null;else{if(C==y)break;for(var P=C<g?C:_,A=0,I=P;p<I;)I=k[I]>>8,++A;var N=I;if(h<w+A+(P!==C?1:0))return void console.log("Warning, gif stream longer than expected.");f[w++]=N;var O=w+=A;for(P!==C&&(f[w++]=N),I=P;A--;)I=k[I],f[--O]=255&I,I>>=8;_!==null&&g<4096&&(k[g++]=_<<8|N,m+1<=g&&b<12&&(++b,m=m<<1|1)),_=C}}w!==h&&console.log("Warning, gif stream shorter than expected.")}try{a.GifWriter=i,a.GifReader=function(c){var u=0;if(c[u++]!==71||c[u++]!==73||c[u++]!==70||c[u++]!==56||(c[u++]+1&253)!=56||c[u++]!==97)throw new Error("Invalid GIF 87a/89a header.");var f=c[u++]|c[u++]<<8,h=c[u++]|c[u++]<<8,d=c[u++],p=1<<1+(7&d),y=(c[u++],c[u++],null),g=null,b=(d>>7&&(y=u,u+=3*(g=p)),!0),m=[],v=0,x=null,w=0,S=null;for(this.width=f,this.height=h;b&&u<c.length;)switch(c[u++]){case 33:switch(c[u++]){case 255:if(c[u]!==11||c[u+1]==78&&c[u+2]==69&&c[u+3]==84&&c[u+4]==83&&c[u+5]==67&&c[u+6]==65&&c[u+7]==80&&c[u+8]==69&&c[u+9]==50&&c[u+10]==46&&c[u+11]==48&&c[u+12]==3&&c[u+13]==1&&c[u+16]==0)u+=14,S=c[u++]|c[u++]<<8,u++;else for(u+=12;;){if(!(0<=(_=c[u++])))throw Error("Invalid block size");if(_===0)break;u+=_}break;case 249:if(c[u++]!==4||c[u+4]!==0)throw new Error("Invalid graphics extension block.");var k=c[u++],v=c[u++]|c[u++]<<8,x=c[u++];!(1&k)&&(x=null),w=k>>2&7,u++;break;case 254:for(;;){if(!(0<=(_=c[u++])))throw Error("Invalid block size");if(_===0)break;u+=_}break;default:throw new Error("Unknown graphic control label: 0x"+c[u-1].toString(16))}break;case 44:var _,C=c[u++]|c[u++]<<8,P=c[u++]|c[u++]<<8,A=c[u++]|c[u++]<<8,I=c[u++]|c[u++]<<8,Y=c[u++],N=Y>>6&1,O=1<<1+(7&Y),F=y,U=g,G=!1,Y=(Y>>7&&(G=!0,F=u,u+=3*(U=O)),u);for(u++;;){if(!(0<=(_=c[u++])))throw Error("Invalid block size");if(_===0)break;u+=_}m.push({x:C,y:P,width:A,height:I,has_local_palette:G,palette_offset:F,palette_size:U,data_offset:Y,data_length:u-Y,transparent_index:x,interlaced:!!N,delay:v,disposal:w});break;case 59:b=!1;break;default:throw new Error("Unknown gif block: 0x"+c[u-1].toString(16))}this.numFrames=function(){return m.length},this.loopCount=function(){return S},this.frameInfo=function($){if($<0||$>=m.length)throw new Error("Frame index out of range.");return m[$]},this.decodeAndBlitFrameBGRA=function($,H){for(var $=this.frameInfo($),Q=$.width*$.height,J=new Uint8Array(Q),ae=(l(c,$.data_offset,J,Q),$.palette_offset),T=$.transparent_index,B=(T===null&&(T=256),$.width),W=f-B,K=B,te=4*($.y*f+$.x),ne=4*(($.y+$.height)*f+$.x),ce=te,fe=4*W,ue=($.interlaced===!0&&(fe+=4*f*7),8),ge=0,me=J.length;ge<me;++ge){var oe,de,xe=J[ge];K===0&&(K=B,ne<=(ce+=fe)&&(fe=4*W+4*f*(ue-1),ce=te+(B+W)*(ue<<1),ue>>=1)),xe===T?ce+=4:(oe=c[ae+3*xe],de=c[ae+3*xe+1],xe=c[ae+3*xe+2],H[ce++]=xe,H[ce++]=de,H[ce++]=oe,H[ce++]=255),--K}},this.decodeAndBlitFrameRGBA=function($,H){for(var $=this.frameInfo($),Q=$.width*$.height,J=new Uint8Array(Q),ae=(l(c,$.data_offset,J,Q),$.palette_offset),T=$.transparent_index,B=(T===null&&(T=256),$.width),W=f-B,K=B,te=4*($.y*f+$.x),ne=4*(($.y+$.height)*f+$.x),ce=te,fe=4*W,ue=($.interlaced===!0&&(fe+=4*f*7),8),ge=0,me=J.length;ge<me;++ge){var oe,de,xe=J[ge];K===0&&(K=B,ne<=(ce+=fe)&&(fe=4*W+4*f*(ue-1),ce=te+(B+W)*(ue<<1),ue>>=1)),xe===T?ce+=4:(oe=c[ae+3*xe],de=c[ae+3*xe+1],xe=c[ae+3*xe+2],H[ce++]=oe,H[ce++]=de,H[ce++]=xe,H[ce++]=255),--K}}}}catch{}},{}],254:[function(r,s,a){(function(i){var l,c;l=this,c=function(u){function f(V){if(this==null)throw TypeError();var M,L=String(this),D=L.length,V=V?Number(V):0;if(!((V=V!=V?0:V)<0||D<=V))return 55296<=(M=L.charCodeAt(V))&&M<=56319&&V+1<D&&56320<=(D=L.charCodeAt(V+1))&&D<=57343?1024*(M-55296)+D-56320+65536:M}String.prototype.codePointAt||((h=function(){try{var j={},M=Object.defineProperty,L=M(j,j,j)&&M}catch{}return L}())?h(String.prototype,"codePointAt",{value:f,configurable:!0,writable:!0}):String.prototype.codePointAt=f);var h,d=0,p=-3;function y(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function g(j,M){this.source=j,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=M,this.destLen=0,this.ltree=new y,this.dtree=new y}var b=new y,m=new y,v=new Uint8Array(30),x=new Uint16Array(30),w=new Uint8Array(30),S=new Uint16Array(30),k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_=new y,C=new Uint8Array(320);function P(j,M,L,D){for(var V,X=0;X<L;++X)j[X]=0;for(X=0;X<30-L;++X)j[X+L]=X/L|0;for(V=D,X=0;X<30;++X)M[X]=V,V+=1<<j[X]}var A=new Uint16Array(16);function I(j,M,L,D){for(var V,X=0;X<16;++X)j.table[X]=0;for(X=0;X<D;++X)j.table[M[L+X]]++;for(X=V=j.table[0]=0;X<16;++X)A[X]=V,V+=j.table[X];for(X=0;X<D;++X)M[L+X]&&(j.trans[A[M[L+X]]++]=X)}function N(j,M,L){if(!M)return L;for(;j.bitcount<24;)j.tag|=j.source[j.sourceIndex++]<<j.bitcount,j.bitcount+=8;var D=j.tag&65535>>>16-M;return j.tag>>>=M,j.bitcount-=M,D+L}function O(j,M){for(;j.bitcount<24;)j.tag|=j.source[j.sourceIndex++]<<j.bitcount,j.bitcount+=8;for(var L=0,D=0,V=0,X=j.tag;D=2*D+(1&X),X>>>=1,L+=M.table[++V],0<=(D-=M.table[V]););return j.tag=X,j.bitcount-=V,M.trans[L+D]}function F(j,M,L){for(;;){var D=O(j,M);if(D===256)return d;if(D<256)j.dest[j.destLen++]=D;else for(var V,X=N(j,v[D-=257],x[D]),D=O(j,L),Z=V=j.destLen-N(j,w[D],S[D]);Z<V+X;++Z)j.dest[j.destLen++]=j.dest[Z]}}for(var U=b,G=m,Y=0;Y<7;++Y)U.table[Y]=0;for(U.table[7]=24,U.table[8]=152,U.table[9]=112,Y=0;Y<24;++Y)U.trans[Y]=256+Y;for(Y=0;Y<144;++Y)U.trans[24+Y]=Y;for(Y=0;Y<8;++Y)U.trans[168+Y]=280+Y;for(Y=0;Y<112;++Y)U.trans[176+Y]=144+Y;for(Y=0;Y<5;++Y)G.table[Y]=0;for(G.table[5]=32,Y=0;Y<32;++Y)G.trans[Y]=Y;P(v,x,4,3),P(w,S,2,1),v[28]=0,x[28]=258;var $=function(j,M){var L,D,V,X=new g(j,M);do{switch(V=void 0,(D=X).bitcount--||(D.tag=D.source[D.sourceIndex++],D.bitcount=7),V=1&D.tag,D.tag>>>=1,D=V,N(X,2,0)){case 0:L=function(De){for(var wt,Ot;8<De.bitcount;)De.sourceIndex--,De.bitcount-=8;if((wt=256*De.source[De.sourceIndex+1]+De.source[De.sourceIndex])!==(65535&~(256*De.source[De.sourceIndex+3]+De.source[De.sourceIndex+2])))return p;for(De.sourceIndex+=4,Ot=wt;Ot;--Ot)De.dest[De.destLen++]=De.source[De.sourceIndex++];return De.bitcount=0,d}(X);break;case 1:L=F(X,b,m);break;case 2:ze=Ne=He=Re=Z=ve=Ce=Oe=je=he=pe=se=void 0;for(var Z,se=X,pe=X.ltree,he=X.dtree,je=N(se,5,257),Oe=N(se,5,1),Ce=N(se,4,4),ve=0;ve<19;++ve)C[ve]=0;for(ve=0;ve<Ce;++ve){var He=N(se,3,0);C[k[ve]]=He}for(I(_,C,0,19),Z=0;Z<je+Oe;){var Ne=O(se,_);switch(Ne){case 16:for(var ze=C[Z-1],Re=N(se,2,3);Re;--Re)C[Z++]=ze;break;case 17:for(Re=N(se,3,3);Re;--Re)C[Z++]=0;break;case 18:for(Re=N(se,7,11);Re;--Re)C[Z++]=0;break;default:C[Z++]=Ne}}I(pe,C,0,je),I(he,C,je,Oe),L=F(X,X.ltree,X.dtree);break;default:L=p}if(L!==d)throw new Error("Data error")}while(!D);return X.destLen<X.dest.length?typeof X.dest.slice=="function"?X.dest.slice(0,X.destLen):X.dest.subarray(0,X.destLen):X.dest};function H(j,M,L,D,V){return Math.pow(1-V,3)*j+3*Math.pow(1-V,2)*V*M+3*(1-V)*Math.pow(V,2)*L+Math.pow(V,3)*D}function Q(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function J(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function ae(j){throw new Error(j)}function T(j,M){j||ae(M)}Q.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},Q.prototype.addPoint=function(j,M){typeof j=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=j,this.x2=j),j<this.x1&&(this.x1=j),j>this.x2&&(this.x2=j)),typeof M=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=M,this.y2=M),M<this.y1&&(this.y1=M),M>this.y2&&(this.y2=M))},Q.prototype.addX=function(j){this.addPoint(j,null)},Q.prototype.addY=function(j){this.addPoint(null,j)},Q.prototype.addBezier=function(j,M,L,D,V,X,Z,se){var pe=[j,M],he=[L,D],je=[V,X],Oe=[Z,se];this.addPoint(j,M),this.addPoint(Z,se);for(var Ce=0;Ce<=1;Ce++){var ve,He=6*pe[Ce]-12*he[Ce]+6*je[Ce],Ne=-3*pe[Ce]+9*he[Ce]-9*je[Ce]+3*Oe[Ce],ze=3*he[Ce]-3*pe[Ce];Ne==0?He==0||0<(ve=-ze/He)&&ve<1&&(Ce===0&&this.addX(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ve)),Ce===1&&this.addY(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ve))):(ve=Math.pow(He,2)-4*ze*Ne)<0||(0<(ze=(-He+Math.sqrt(ve))/(2*Ne))&&ze<1&&(Ce===0&&this.addX(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ze)),Ce===1&&this.addY(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ze))),0<(ze=(-He-Math.sqrt(ve))/(2*Ne))&&ze<1&&(Ce===0&&this.addX(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ze)),Ce===1&&this.addY(H(pe[Ce],he[Ce],je[Ce],Oe[Ce],ze))))}},Q.prototype.addQuad=function(j,M,L,D,V,X){L=j+2/3*(L-j),D=M+2/3*(D-M),this.addBezier(j,M,L,D,L+1/3*(V-j),D+1/3*(X-M),V,X)},J.prototype.moveTo=function(j,M){this.commands.push({type:"M",x:j,y:M})},J.prototype.lineTo=function(j,M){this.commands.push({type:"L",x:j,y:M})},J.prototype.curveTo=J.prototype.bezierCurveTo=function(j,M,L,D,V,X){this.commands.push({type:"C",x1:j,y1:M,x2:L,y2:D,x:V,y:X})},J.prototype.quadTo=J.prototype.quadraticCurveTo=function(j,M,L,D){this.commands.push({type:"Q",x1:j,y1:M,x:L,y:D})},J.prototype.close=J.prototype.closePath=function(){this.commands.push({type:"Z"})},J.prototype.extend=function(j){var M;if(j.commands)j=j.commands;else if(j instanceof Q)return M=j,this.moveTo(M.x1,M.y1),this.lineTo(M.x2,M.y1),this.lineTo(M.x2,M.y2),this.lineTo(M.x1,M.y2),void this.close();Array.prototype.push.apply(this.commands,j)},J.prototype.getBoundingBox=function(){for(var j=new Q,M=0,L=0,D=0,V=0,X=0;X<this.commands.length;X++){var Z=this.commands[X];switch(Z.type){case"M":j.addPoint(Z.x,Z.y),M=D=Z.x,L=V=Z.y;break;case"L":j.addPoint(Z.x,Z.y),D=Z.x,V=Z.y;break;case"Q":j.addQuad(D,V,Z.x1,Z.y1,Z.x,Z.y),D=Z.x,V=Z.y;break;case"C":j.addBezier(D,V,Z.x1,Z.y1,Z.x2,Z.y2,Z.x,Z.y),D=Z.x,V=Z.y;break;case"Z":D=M,V=L;break;default:throw new Error("Unexpected path command "+Z.type)}}return j.isEmpty()&&j.addPoint(0,0),j},J.prototype.draw=function(j){j.beginPath();for(var M=0;M<this.commands.length;M+=1){var L=this.commands[M];L.type==="M"?j.moveTo(L.x,L.y):L.type==="L"?j.lineTo(L.x,L.y):L.type==="C"?j.bezierCurveTo(L.x1,L.y1,L.x2,L.y2,L.x,L.y):L.type==="Q"?j.quadraticCurveTo(L.x1,L.y1,L.x,L.y):L.type==="Z"&&j.closePath()}this.fill&&(j.fillStyle=this.fill,j.fill()),this.stroke&&(j.strokeStyle=this.stroke,j.lineWidth=this.strokeWidth,j.stroke())},J.prototype.toPathData=function(j){function M(){for(var X=arguments,Z="",se=0;se<arguments.length;se+=1){var pe=X[se];0<=pe&&0<se&&(Z+=" "),Z+=(pe=pe,Math.round(pe)===pe?""+Math.round(pe):pe.toFixed(j))}return Z}j=j!==void 0?j:2;for(var L="",D=0;D<this.commands.length;D+=1){var V=this.commands[D];V.type==="M"?L+="M"+M(V.x,V.y):V.type==="L"?L+="L"+M(V.x,V.y):V.type==="C"?L+="C"+M(V.x1,V.y1,V.x2,V.y2,V.x,V.y):V.type==="Q"?L+="Q"+M(V.x1,V.y1,V.x,V.y):V.type==="Z"&&(L+="Z")}return L},J.prototype.toSVG=function(j){var M=(M='<path d="')+this.toPathData(j)+'"';return this.fill&&this.fill!=="black"&&(this.fill===null?M+=' fill="none"':M+=' fill="'+this.fill+'"'),this.stroke&&(M+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),M+="/>"},J.prototype.toDOMElement=function(M){var M=this.toPathData(M),L=document.createElementNS("http://www.w3.org/2000/svg","path");return L.setAttribute("d",M),L};var B={fail:ae,argument:T,assert:T},W={},K={},te={};function ne(j){return function(){return j}}K.BYTE=function(j){return B.argument(0<=j&&j<=255,"Byte value should be between 0 and 255."),[j]},te.BYTE=ne(1),K.CHAR=function(j){return[j.charCodeAt(0)]},te.CHAR=ne(1),K.CHARARRAY=function(j){for(var M=[],L=0;L<j.length;L+=1)M[L]=j.charCodeAt(L);return M},te.CHARARRAY=function(j){return j.length},K.USHORT=function(j){return[j>>8&255,255&j]},te.USHORT=ne(2),K.SHORT=function(j){return[(j=32768<=j?-(65536-j):j)>>8&255,255&j]},te.SHORT=ne(2),K.UINT24=function(j){return[j>>16&255,j>>8&255,255&j]},te.UINT24=ne(3),K.ULONG=function(j){return[j>>24&255,j>>16&255,j>>8&255,255&j]},te.ULONG=ne(4),K.LONG=function(j){return[(j=2147483648<=j?-(4294967296-j):j)>>24&255,j>>16&255,j>>8&255,255&j]},te.LONG=ne(4),K.FIXED=K.ULONG,te.FIXED=te.ULONG,K.FWORD=K.SHORT,te.FWORD=te.SHORT,K.UFWORD=K.USHORT,te.UFWORD=te.USHORT,K.LONGDATETIME=function(j){return[0,0,0,0,j>>24&255,j>>16&255,j>>8&255,255&j]},te.LONGDATETIME=ne(8),K.TAG=function(j){return B.argument(j.length===4,"Tag should be exactly 4 ASCII characters."),[j.charCodeAt(0),j.charCodeAt(1),j.charCodeAt(2),j.charCodeAt(3)]},te.TAG=ne(4),K.Card8=K.BYTE,te.Card8=te.BYTE,K.Card16=K.USHORT,te.Card16=te.USHORT,K.OffSize=K.BYTE,te.OffSize=te.BYTE,K.SID=K.USHORT,te.SID=te.USHORT,K.NUMBER=function(j){return-107<=j&&j<=107?[j+139]:108<=j&&j<=1131?[247+((j-=108)>>8),255&j]:-1131<=j&&j<=-108?[251+((j=-j-108)>>8),255&j]:-32768<=j&&j<=32767?K.NUMBER16(j):K.NUMBER32(j)},te.NUMBER=function(j){return K.NUMBER(j).length},K.NUMBER16=function(j){return[28,j>>8&255,255&j]},te.NUMBER16=ne(3),K.NUMBER32=function(j){return[29,j>>24&255,j>>16&255,j>>8&255,255&j]},te.NUMBER32=ne(5),K.REAL=function(j){for(var M=j.toString(),L=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(M),D=(L&&(L=parseFloat("1e"+((L[2]?+L[2]:0)+L[1].length)),M=(Math.round(j*L)/L).toString()),""),V=0,X=M.length;V<X;V+=1){var Z=M[V];D+=Z==="e"?M[++V]==="-"?"c":"b":Z==="."?"a":Z==="-"?"e":Z}for(var se=[30],pe=0,he=(D+=1&D.length?"f":"ff").length;pe<he;pe+=2)se.push(parseInt(D.substr(pe,2),16));return se},te.REAL=function(j){return K.REAL(j).length},K.NAME=K.CHARARRAY,te.NAME=te.CHARARRAY,K.STRING=K.CHARARRAY,te.STRING=te.CHARARRAY,W.UTF8=function(j,M,L){for(var D=[],V=L,X=0;X<V;X++,M+=1)D[X]=j.getUint8(M);return String.fromCharCode.apply(null,D)},W.UTF16=function(j,M,L){for(var D=[],V=L/2,X=0;X<V;X++,M+=2)D[X]=j.getUint16(M);return String.fromCharCode.apply(null,D)},K.UTF16=function(j){for(var M=[],L=0;L<j.length;L+=1){var D=j.charCodeAt(L);M[M.length]=D>>8&255,M[M.length]=255&D}return M},te.UTF16=function(j){return 2*j.length};var ce,fe={"x-mac-croatian":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\u0160\u2122\xB4\xA8\u2260\u017D\xD8\u221E\xB1\u2264\u2265\u2206\xB5\u2202\u2211\u220F\u0161\u222B\xAA\xBA\u03A9\u017E\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u0106\xAB\u010C\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u0110\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\uF8FF\xA9\u2044\u20AC\u2039\u203A\xC6\xBB\u2013\xB7\u201A\u201E\u2030\xC2\u0107\xC1\u010D\xC8\xCD\xCE\xCF\xCC\xD3\xD4\u0111\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u03C0\xCB\u02DA\xB8\xCA\xE6\u02C7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041A\u041B\u041C\u041D\u041E\u041F\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042A\u042B\u042C\u042D\u042E\u042F\u2020\xB0\u0490\xA3\xA7\u2022\xB6\u0406\xAE\xA9\u2122\u0402\u0452\u2260\u0403\u0453\u221E\xB1\u2264\u2265\u0456\xB5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040A\u045A\u0458\u0405\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\u040B\u045B\u040C\u045C\u0455\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u201E\u040E\u045E\u040F\u045F\u2116\u0401\u0451\u044F\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043A\u043B\u043C\u043D\u043E\u043F\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044A\u044B\u044C\u044D\u044E","x-mac-gaelic":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u1E02\xB1\u2264\u2265\u1E03\u010A\u010B\u1E0A\u1E0B\u1E1E\u1E1F\u0120\u0121\u1E40\xE6\xF8\u1E41\u1E56\u1E57\u027C\u0192\u017F\u1E60\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\u1E61\u1E9B\xFF\u0178\u1E6A\u20AC\u2039\u203A\u0176\u0177\u1E6B\xB7\u1EF2\u1EF3\u204A\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\u2663\xD2\xDA\xDB\xD9\u0131\xDD\xFD\u0174\u0175\u1E84\u1E85\u1E80\u1E81\u1E82\u1E83","x-mac-greek":"\xC4\xB9\xB2\xC9\xB3\xD6\xDC\u0385\xE0\xE2\xE4\u0384\xA8\xE7\xE9\xE8\xEA\xEB\xA3\u2122\xEE\xEF\u2022\xBD\u2030\xF4\xF6\xA6\u20AC\xF9\xFB\xFC\u2020\u0393\u0394\u0398\u039B\u039E\u03A0\xDF\xAE\xA9\u03A3\u03AA\xA7\u2260\xB0\xB7\u0391\xB1\u2264\u2265\xA5\u0392\u0395\u0396\u0397\u0399\u039A\u039C\u03A6\u03AB\u03A8\u03A9\u03AC\u039D\xAC\u039F\u03A1\u2248\u03A4\xAB\xBB\u2026\xA0\u03A5\u03A7\u0386\u0388\u0153\u2013\u2015\u201C\u201D\u2018\u2019\xF7\u0389\u038A\u038C\u038E\u03AD\u03AE\u03AF\u03CC\u038F\u03CD\u03B1\u03B2\u03C8\u03B4\u03B5\u03C6\u03B3\u03B7\u03B9\u03BE\u03BA\u03BB\u03BC\u03BD\u03BF\u03C0\u03CE\u03C1\u03C3\u03C4\u03B8\u03C9\u03C2\u03C7\u03C5\u03B6\u03CA\u03CB\u0390\u03B0\xAD","x-mac-icelandic":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\xDD\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\xD0\xF0\xDE\xFE\xFD\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140A\u140B\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144E\u144F\u1450\u1451\u1455\u1456\u1466\u146D\u146E\u146F\u1470\u1472\u1473\u1483\u148B\u148C\u148D\u148E\u1490\u1491\xB0\u14A1\u14A5\u14A6\u2022\xB6\u14A7\xAE\xA9\u2122\u14A8\u14AA\u14AB\u14BB\u14C2\u14C3\u14C4\u14C5\u14C7\u14C8\u14D0\u14EF\u14F0\u14F1\u14F2\u14F4\u14F5\u1505\u14D5\u14D6\u14D7\u14D8\u14DA\u14DB\u14EA\u1528\u1529\u152A\u152B\u152D\u2026\xA0\u152E\u153E\u1555\u1556\u1557\u2013\u2014\u201C\u201D\u2018\u2019\u1558\u1559\u155A\u155D\u1546\u1547\u1548\u1549\u154B\u154C\u1550\u157F\u1580\u1581\u1582\u1583\u1584\u1585\u158F\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15A0\u15A1\u15A2\u15A3\u15A4\u15A5\u15A6\u157C\u0141\u0142","x-mac-ce":"\xC4\u0100\u0101\xC9\u0104\xD6\xDC\xE1\u0105\u010C\xE4\u010D\u0106\u0107\xE9\u0179\u017A\u010E\xED\u010F\u0112\u0113\u0116\xF3\u0117\xF4\xF6\xF5\xFA\u011A\u011B\xFC\u2020\xB0\u0118\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\u0119\xA8\u2260\u0123\u012E\u012F\u012A\u2264\u2265\u012B\u0136\u2202\u2211\u0142\u013B\u013C\u013D\u013E\u0139\u013A\u0145\u0146\u0143\xAC\u221A\u0144\u0147\u2206\xAB\xBB\u2026\xA0\u0148\u0150\xD5\u0151\u014C\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\u014D\u0154\u0155\u0158\u2039\u203A\u0159\u0156\u0157\u0160\u201A\u201E\u0161\u015A\u015B\xC1\u0164\u0165\xCD\u017D\u017E\u016A\xD3\xD4\u016B\u016E\xDA\u016F\u0170\u0171\u0172\u0173\xDD\xFD\u0137\u017B\u0141\u017C\u0122\u02C7",macintosh:"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-romanian":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\u0102\u0218\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\u0103\u0219\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u2044\u20AC\u2039\u203A\u021A\u021B\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\u0131\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7","x-mac-turkish":"\xC4\xC5\xC7\xC9\xD1\xD6\xDC\xE1\xE0\xE2\xE4\xE3\xE5\xE7\xE9\xE8\xEA\xEB\xED\xEC\xEE\xEF\xF1\xF3\xF2\xF4\xF6\xF5\xFA\xF9\xFB\xFC\u2020\xB0\xA2\xA3\xA7\u2022\xB6\xDF\xAE\xA9\u2122\xB4\xA8\u2260\xC6\xD8\u221E\xB1\u2264\u2265\xA5\xB5\u2202\u2211\u220F\u03C0\u222B\xAA\xBA\u03A9\xE6\xF8\xBF\xA1\xAC\u221A\u0192\u2248\u2206\xAB\xBB\u2026\xA0\xC0\xC3\xD5\u0152\u0153\u2013\u2014\u201C\u201D\u2018\u2019\xF7\u25CA\xFF\u0178\u011E\u011F\u0130\u0131\u015E\u015F\u2021\xB7\u201A\u201E\u2030\xC2\xCA\xC1\xCB\xC8\xCD\xCE\xCF\xCC\xD3\xD4\uF8FF\xD2\xDA\xDB\xD9\uF8A0\u02C6\u02DC\xAF\u02D8\u02D9\u02DA\xB8\u02DD\u02DB\u02C7"},ue=(W.MACSTRING=function(j,M,L,D){var V=fe[D];if(V!==void 0){for(var X="",Z=0;Z<L;Z++){var se=j.getUint8(M+Z);X+=se<=127?String.fromCharCode(se):V[127&se]}return X}},typeof WeakMap=="function"&&new WeakMap);function ge(j){return-128<=j&&j<=127}K.MACSTRING=function(j,M){var L=function(Z){if(!ce)for(var se in ce={},fe)ce[se]=new String(se);var pe=ce[Z];if(pe!==void 0){if(ue){var he=ue.get(pe);if(he!==void 0)return he}var je=fe[Z];if(je!==void 0){for(var Oe={},Ce=0;Ce<je.length;Ce++)Oe[je.charCodeAt(Ce)]=Ce+128;return ue&&ue.set(pe,Oe),Oe}}}(M);if(L!==void 0){for(var D=[],V=0;V<j.length;V++){var X=j.charCodeAt(V);if(128<=X&&(X=L[X])===void 0)return;D[V]=X}return D}},te.MACSTRING=function(j,M){return j=K.MACSTRING(j,M),j!==void 0?j.length:0},K.VARDELTAS=function(j){for(var D=0,M=[];D<j.length;)var L=j[D],D=(L===0?function(V,X,Z){for(var se=0,pe=V.length;X<pe&&se<64&&V[X]===0;)++X,++se;return Z.push(128|se-1),X}:-128<=L&&L<=127?function(V,X,Z){for(var se=0,pe=V.length,he=X;he<pe&&se<64;){var je=V[he];if(!ge(je)||je===0&&he+1<pe&&V[he+1]===0)break;++he,++se}Z.push(se-1);for(var Oe=X;Oe<he;++Oe)Z.push(V[Oe]+256&255);return he}:function(V,X,Z){for(var se=0,pe=V.length,he=X;he<pe&&se<64;){var je=V[he];if(je===0||ge(je)&&he+1<pe&&ge(V[he+1]))break;++he,++se}Z.push(64|se-1);for(var Oe=X;Oe<he;++Oe){var Ce=V[Oe];Z.push(Ce+65536>>8&255,Ce+256&255)}return he})(j,D,M);return M},K.INDEX=function(j){for(var M=1,L=[M],D=[],V=0;V<j.length;V+=1){var X=K.OBJECT(j[V]);Array.prototype.push.apply(D,X),M+=X.length,L.push(M)}if(D.length===0)return[0,0];for(var Z=[],se=1+Math.floor(Math.log(M)/Math.log(2))/8|0,pe=[void 0,K.BYTE,K.USHORT,K.UINT24,K.ULONG][se],he=0;he<L.length;he+=1){var je=pe(L[he]);Array.prototype.push.apply(Z,je)}return Array.prototype.concat(K.Card16(j.length),K.OffSize(se),Z,D)},te.INDEX=function(j){return K.INDEX(j).length},K.DICT=function(j){for(var M=[],L=Object.keys(j),D=L.length,V=0;V<D;V+=1){var X=parseInt(L[V],0),Z=j[X];M=(M=M.concat(K.OPERAND(Z.value,Z.type))).concat(K.OPERATOR(X))}return M},te.DICT=function(j){return K.DICT(j).length},K.OPERATOR=function(j){return j<1200?[j]:[12,j-1200]},K.OPERAND=function(j,M){var L=[];if(Array.isArray(M))for(var D=0;D<M.length;D+=1)B.argument(j.length===M.length,"Not enough arguments given for type"+M),L=L.concat(K.OPERAND(j[D],M[D]));else if(M==="SID")L=L.concat(K.NUMBER(j));else if(M==="offset")L=L.concat(K.NUMBER32(j));else if(M==="number")L=L.concat(K.NUMBER(j));else{if(M!=="real")throw new Error("Unknown operand type "+M);L=L.concat(K.REAL(j))}return L},K.OP=K.BYTE,te.OP=te.BYTE;var me=typeof WeakMap=="function"&&new WeakMap;function oe(j,M,L){for(var D=0;D<M.length;D+=1){var V=M[D];this[V.name]=V.value}if(this.tableName=j,this.fields=M,L)for(var X=Object.keys(L),Z=0;Z<X.length;Z+=1){var se=X[Z],pe=L[se];this[se]!==void 0&&(this[se]=pe)}}function de(j,M,L){L===void 0&&(L=M.length);var D=new Array(M.length+1);D[0]={name:j+"Count",type:"USHORT",value:L};for(var V=0;V<M.length;V++)D[V+1]={name:j+V,type:"USHORT",value:M[V]};return D}function xe(j,M,L){var D=M.length,V=new Array(D+1);V[0]={name:j+"Count",type:"USHORT",value:D};for(var X=0;X<D;X++)V[X+1]={name:j+X,type:"TABLE",value:L(M[X],X)};return V}function Ie(j,M,L){var D=M.length,V=[];V[0]={name:j+"Count",type:"USHORT",value:D};for(var X=0;X<D;X++)V=V.concat(L(M[X],X));return V}function we(j){j.format===1?oe.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(de("glyph",j.glyphs))):B.assert(!1,"Can't create coverage table format 2 yet.")}function _e(j){oe.call(this,"scriptListTable",Ie("scriptRecord",j,function(M,L){var D=M.script,V=D.defaultLangSys;return B.assert(!!V,"Unable to write GSUB: script "+M.tag+" has no default language system."),[{name:"scriptTag"+L,type:"TAG",value:M.tag},{name:"script"+L,type:"TABLE",value:new oe("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new oe("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:V.reqFeatureIndex}].concat(de("featureIndex",V.featureIndexes)))}].concat(Ie("langSys",D.langSysRecords,function(X,Z){var se=X.langSys;return[{name:"langSysTag"+Z,type:"TAG",value:X.tag},{name:"langSys"+Z,type:"TABLE",value:new oe("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:se.reqFeatureIndex}].concat(de("featureIndex",se.featureIndexes)))}]})))}]}))}function Ae(j){oe.call(this,"featureListTable",Ie("featureRecord",j,function(M,L){var D=M.feature;return[{name:"featureTag"+L,type:"TAG",value:M.tag},{name:"feature"+L,type:"TABLE",value:new oe("featureTable",[{name:"featureParams",type:"USHORT",value:D.featureParams}].concat(de("lookupListIndex",D.lookupListIndexes)))}]}))}function $e(j,M){oe.call(this,"lookupListTable",xe("lookup",j,function(L){var D=M[L.lookupType];return B.assert(!!D,"Unable to write GSUB lookup type "+L.lookupType+" tables."),new oe("lookupTable",[{name:"lookupType",type:"USHORT",value:L.lookupType},{name:"lookupFlag",type:"USHORT",value:L.lookupFlag}].concat(xe("subtable",L.subtables,D)))}))}K.CHARSTRING=function(j){if(me){var M=me.get(j);if(M!==void 0)return M}for(var X=[],L=j.length,D=0;D<L;D+=1)var V=j[D],X=X.concat(K[V.type](V.value));return me&&me.set(j,X),X},te.CHARSTRING=function(j){return K.CHARSTRING(j).length},K.OBJECT=function(j){var M=K[j.type];return B.argument(M!==void 0,"No encoding function for type "+j.type),M(j.value)},te.OBJECT=function(j){var M=te[j.type];return B.argument(M!==void 0,"No sizeOf function for type "+j.type),M(j.value)},K.TABLE=function(j){for(var M=[],L=j.fields.length,D=[],V=[],X=0;X<L;X+=1){var Z=j.fields[X],pe=K[Z.type],se=(B.argument(pe!==void 0,"No encoding function for field type "+Z.type+" ("+Z.name+")"),j[Z.name]),pe=pe(se=se===void 0?Z.value:se);Z.type==="TABLE"?(V.push(M.length),M=M.concat([0,0]),D.push(pe)):M=M.concat(pe)}for(var he=0;he<D.length;he+=1){var je=V[he],Oe=M.length;B.argument(Oe<65536,"Table "+j.tableName+" too big."),M[je]=Oe>>8,M[je+1]=255&Oe,M=M.concat(D[he])}return M},te.TABLE=function(j){for(var M=0,L=j.fields.length,D=0;D<L;D+=1){var V=j.fields[D],X=te[V.type],Z=(B.argument(X!==void 0,"No sizeOf function for field type "+V.type+" ("+V.name+")"),j[V.name]);M+=X(Z=Z===void 0?V.value:Z),V.type==="TABLE"&&(M+=2)}return M},K.RECORD=K.TABLE,te.RECORD=te.TABLE,K.LITERAL=function(j){return j},te.LITERAL=function(j){return j.length},oe.prototype.encode=function(){return K.TABLE(this)},oe.prototype.sizeOf=function(){return te.TABLE(this)};var Fe={Table:oe,Record:oe,Coverage:(we.prototype=Object.create(oe.prototype)).constructor=we,ScriptList:(_e.prototype=Object.create(oe.prototype)).constructor=_e,FeatureList:(Ae.prototype=Object.create(oe.prototype)).constructor=Ae,LookupList:($e.prototype=Object.create(oe.prototype)).constructor=$e,ushortList:de,tableList:xe,recordList:Ie};function ut(j,M){return j.getUint8(M)}function tt(j,M){return j.getUint16(M,!1)}function rt(j,M){return j.getUint32(M,!1)}function it(j,M){return j.getInt16(M,!1)+j.getUint16(M+2,!1)/65535}var nt={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Ee(j,M){this.data=j,this.offset=M,this.relativeOffset=0}Ee.prototype.parseByte=function(){var j=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,j},Ee.prototype.parseChar=function(){var j=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,j},Ee.prototype.parseCard8=Ee.prototype.parseByte,Ee.prototype.parseCard16=Ee.prototype.parseUShort=function(){var j=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,j},Ee.prototype.parseSID=Ee.prototype.parseUShort,Ee.prototype.parseOffset16=Ee.prototype.parseUShort,Ee.prototype.parseShort=function(){var j=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,j},Ee.prototype.parseF2Dot14=function(){var j=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,j},Ee.prototype.parseOffset32=Ee.prototype.parseULong=function(){var j=rt(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,j},Ee.prototype.parseFixed=function(){var j=it(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,j},Ee.prototype.parseString=function(j){var M=this.data,L=this.offset+this.relativeOffset,D="";this.relativeOffset+=j;for(var V=0;V<j;V++)D+=String.fromCharCode(M.getUint8(L+V));return D},Ee.prototype.parseTag=function(){return this.parseString(4)},Ee.prototype.parseLongDateTime=function(){var j=rt(this.data,this.offset+this.relativeOffset+4);return j-=2082844800,this.relativeOffset+=8,j},Ee.prototype.parseVersion=function(j){var M=tt(this.data,this.offset+this.relativeOffset),L=tt(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,M+L/(j=j===void 0?4096:j)/10},Ee.prototype.skip=function(j,M){this.relativeOffset+=nt[j]*(M=M===void 0?1:M)},Ee.prototype.parseULongList=function(j){j===void 0&&(j=this.parseULong());for(var M=new Array(j),L=this.data,D=this.offset+this.relativeOffset,V=0;V<j;V++)M[V]=L.getUint32(D),D+=4;return this.relativeOffset+=4*j,M},Ee.prototype.parseOffset16List=Ee.prototype.parseUShortList=function(j){j===void 0&&(j=this.parseUShort());for(var M=new Array(j),L=this.data,D=this.offset+this.relativeOffset,V=0;V<j;V++)M[V]=L.getUint16(D),D+=2;return this.relativeOffset+=2*j,M},Ee.prototype.parseShortList=function(j){for(var M=new Array(j),L=this.data,D=this.offset+this.relativeOffset,V=0;V<j;V++)M[V]=L.getInt16(D),D+=2;return this.relativeOffset+=2*j,M},Ee.prototype.parseByteList=function(j){for(var M=new Array(j),L=this.data,D=this.offset+this.relativeOffset,V=0;V<j;V++)M[V]=L.getUint8(D++);return this.relativeOffset+=j,M},Ee.prototype.parseList=function(j,M){M||(M=j,j=this.parseUShort());for(var L=new Array(j),D=0;D<j;D++)L[D]=M.call(this);return L},Ee.prototype.parseList32=function(j,M){M||(M=j,j=this.parseULong());for(var L=new Array(j),D=0;D<j;D++)L[D]=M.call(this);return L},Ee.prototype.parseRecordList=function(j,M){M||(M=j,j=this.parseUShort());for(var L=new Array(j),D=Object.keys(M),V=0;V<j;V++){for(var X={},Z=0;Z<D.length;Z++){var se=D[Z],pe=M[se];X[se]=pe.call(this)}L[V]=X}return L},Ee.prototype.parseRecordList32=function(j,M){M||(M=j,j=this.parseULong());for(var L=new Array(j),D=Object.keys(M),V=0;V<j;V++){for(var X={},Z=0;Z<D.length;Z++){var se=D[Z],pe=M[se];X[se]=pe.call(this)}L[V]=X}return L},Ee.prototype.parseStruct=function(j){if(typeof j=="function")return j.call(this);for(var M=Object.keys(j),L={},D=0;D<M.length;D++){var V=M[D],X=j[V];L[V]=X.call(this)}return L},Ee.prototype.parseValueRecord=function(j){var M;if((j=j===void 0?this.parseUShort():j)!==0)return M={},1&j&&(M.xPlacement=this.parseShort()),2&j&&(M.yPlacement=this.parseShort()),4&j&&(M.xAdvance=this.parseShort()),8&j&&(M.yAdvance=this.parseShort()),16&j&&(M.xPlaDevice=void 0,this.parseShort()),32&j&&(M.yPlaDevice=void 0,this.parseShort()),64&j&&(M.xAdvDevice=void 0,this.parseShort()),128&j&&(M.yAdvDevice=void 0,this.parseShort()),M},Ee.prototype.parseValueRecordList=function(){for(var j=this.parseUShort(),M=this.parseUShort(),L=new Array(M),D=0;D<M;D++)L[D]=this.parseValueRecord(j);return L},Ee.prototype.parsePointer=function(j){var M=this.parseOffset16();if(0<M)return new Ee(this.data,this.offset+M).parseStruct(j)},Ee.prototype.parsePointer32=function(j){var M=this.parseOffset32();if(0<M)return new Ee(this.data,this.offset+M).parseStruct(j)},Ee.prototype.parseListOfLists=function(j){for(var M=this.parseOffset16List(),L=M.length,D=this.relativeOffset,V=new Array(L),X=0;X<L;X++){var Z=M[X];if(Z===0)V[X]=void 0;else if(this.relativeOffset=Z,j){for(var se=this.parseOffset16List(),pe=new Array(se.length),he=0;he<se.length;he++)this.relativeOffset=Z+se[he],pe[he]=j.call(this);V[X]=pe}else V[X]=this.parseUShortList()}return this.relativeOffset=D,V},Ee.prototype.parseCoverage=function(){var j=this.offset+this.relativeOffset,M=this.parseUShort(),L=this.parseUShort();if(M===1)return{format:1,glyphs:this.parseUShortList(L)};if(M!==2)throw new Error("0x"+j.toString(16)+": Coverage format must be 1 or 2.");for(var D=new Array(L),V=0;V<L;V++)D[V]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:D}},Ee.prototype.parseClassDef=function(){var j=this.offset+this.relativeOffset,M=this.parseUShort();if(M===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(M===2)return{format:2,ranges:this.parseRecordList({start:Ee.uShort,end:Ee.uShort,classId:Ee.uShort})};throw new Error("0x"+j.toString(16)+": ClassDef format must be 1 or 2.")},Ee.list=function(j,M){return function(){return this.parseList(j,M)}},Ee.list32=function(j,M){return function(){return this.parseList32(j,M)}},Ee.recordList=function(j,M){return function(){return this.parseRecordList(j,M)}},Ee.recordList32=function(j,M){return function(){return this.parseRecordList32(j,M)}},Ee.pointer=function(j){return function(){return this.parsePointer(j)}},Ee.pointer32=function(j){return function(){return this.parsePointer32(j)}},Ee.tag=Ee.prototype.parseTag,Ee.byte=Ee.prototype.parseByte,Ee.uShort=Ee.offset16=Ee.prototype.parseUShort,Ee.uShortList=Ee.prototype.parseUShortList,Ee.uLong=Ee.offset32=Ee.prototype.parseULong,Ee.uLongList=Ee.prototype.parseULongList,Ee.struct=Ee.prototype.parseStruct,Ee.coverage=Ee.prototype.parseCoverage,Ee.classDef=Ee.prototype.parseClassDef;var Ve={reserved:Ee.uShort,reqFeatureIndex:Ee.uShort,featureIndexes:Ee.uShortList},Me=(Ee.prototype.parseScriptList=function(){return this.parsePointer(Ee.recordList({tag:Ee.tag,script:Ee.pointer({defaultLangSys:Ee.pointer(Ve),langSysRecords:Ee.recordList({tag:Ee.tag,langSys:Ee.pointer(Ve)})})}))||[]},Ee.prototype.parseFeatureList=function(){return this.parsePointer(Ee.recordList({tag:Ee.tag,feature:Ee.pointer({featureParams:Ee.offset16,lookupListIndexes:Ee.uShortList})}))||[]},Ee.prototype.parseLookupList=function(j){return this.parsePointer(Ee.list(Ee.pointer(function(){var M=this.parseUShort(),L=(B.argument(1<=M&&M<=9,"GPOS/GSUB lookup type "+M+" unknown."),this.parseUShort()),D=16&L;return{lookupType:M,lookupFlag:L,subtables:this.parseList(Ee.pointer(j[M])),markFilteringSet:D?this.parseUShort():void 0}})))||[]},Ee.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var j=this.parseUShort(),M=this.parseUShort();return B.argument(j===1&&M<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:Ee.offset32,featureTableSubstitutionOffset:Ee.offset32})})||[]},{getByte:ut,getCard8:ut,getUShort:tt,getCard16:tt,getShort:function(j,M){return j.getInt16(M,!1)},getULong:rt,getFixed:it,getTag:function(j,M){for(var L="",D=M;D<M+4;D+=1)L+=String.fromCharCode(j.getInt8(D));return L},getOffset:function(j,M,L){for(var D=0,V=0;V<L;V+=1)D=(D<<=8)+j.getUint8(M+V);return D},getBytes:function(j,M,L){for(var D=[],V=M;V<L;V+=1)D.push(j.getUint8(V));return D},bytesToString:function(j){for(var M="",L=0;L<j.length;L+=1)M+=String.fromCharCode(j[L]);return M},Parser:Ee}),re={parse:function(j,M){for(var L={},D=(L.version=Me.getUShort(j,M),B.argument(L.version===0,"cmap table version should be 0."),L.numTables=Me.getUShort(j,M+2),-1),V=L.numTables-1;0<=V;--V){var X=Me.getUShort(j,M+4+8*V),Z=Me.getUShort(j,M+4+8*V+2);if(X===3&&(Z===0||Z===1||Z===10)||X===0&&(Z===0||Z===1||Z===2||Z===3||Z===4)){D=Me.getULong(j,M+4+8*V+4);break}}if(D===-1)throw new Error("No valid cmap sub-tables found.");var se=new Me.Parser(j,M+D);if(L.format=se.parseUShort(),L.format===12){var pe,he=L,je=se;je.parseUShort(),he.length=je.parseULong(),he.language=je.parseULong(),he.groupCount=pe=je.parseULong(),he.glyphIndexMap={};for(var Oe=0;Oe<pe;Oe+=1)for(var Ce=je.parseULong(),ve=je.parseULong(),He=je.parseULong(),Ne=Ce;Ne<=ve;Ne+=1)he.glyphIndexMap[Ne]=He,He++}else{if(L.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+L.format+").");var ze=L,Re=j,De=M,wt=D;ze.length=se.parseUShort(),ze.language=se.parseUShort(),ze.segCount=Ot=se.parseUShort()>>1,se.skip("uShort",3),ze.glyphIndexMap={};for(var Ot,St=new Me.Parser(Re,De+wt+14),jt=new Me.Parser(Re,De+wt+16+2*Ot),Ft=new Me.Parser(Re,De+wt+16+4*Ot),br=new Me.Parser(Re,De+wt+16+6*Ot),qr=De+wt+16+8*Ot,ln=0;ln<Ot-1;ln+=1)for(var Nn=void 0,Un=St.parseUShort(),Es=jt.parseUShort(),yr=Ft.parseShort(),Cr=br.parseUShort(),ir=Es;ir<=Un;ir+=1)Cr!==0?(qr=(qr=br.offset+br.relativeOffset-2)+Cr+2*(ir-Es),(Nn=Me.getUShort(Re,qr))!==0&&(Nn=Nn+yr&65535)):Nn=ir+yr&65535,ze.glyphIndexMap[ir]=Nn}return L},make:function(j){for(var M=!0,L=j.length-1;0<L;--L)if(65535<j.get(L).unicode){console.log("Adding CMAP format 12 (needed!)"),M=!1;break}var D,V,X=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:M?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:M?12:20}],Z=(X=(X=M?X:X.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])).concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),new Fe.Table("cmap",X));for(Z.segments=[],L=0;L<j.length;L+=1){for(var se=j.get(L),pe=0;pe<se.unicodes.length;pe+=1)D=se.unicodes[pe],V=L,Z.segments.push({end:D,start:D,delta:-(D-V),offset:0,glyphIndex:V});Z.segments=Z.segments.sort(function(De,wt){return De.start-wt.start})}Z.segments.push({end:65535,start:65535,delta:1,offset:0});var he=Z.segments.length,je=0,Oe=[],Ce=[],ve=[],He=[],Ne=[],ze=[];for(L=0;L<he;L+=1){var Re=Z.segments[L];Re.end<=65535&&Re.start<=65535?(Oe=Oe.concat({name:"end_"+L,type:"USHORT",value:Re.end}),Ce=Ce.concat({name:"start_"+L,type:"USHORT",value:Re.start}),ve=ve.concat({name:"idDelta_"+L,type:"SHORT",value:Re.delta}),He=He.concat({name:"idRangeOffset_"+L,type:"USHORT",value:Re.offset}),Re.glyphId!==void 0&&(Ne=Ne.concat({name:"glyph_"+L,type:"USHORT",value:Re.glyphId}))):je+=1,M||Re.glyphIndex===void 0||(ze=(ze=(ze=ze.concat({name:"cmap12Start_"+L,type:"ULONG",value:Re.start})).concat({name:"cmap12End_"+L,type:"ULONG",value:Re.end})).concat({name:"cmap12Glyph_"+L,type:"ULONG",value:Re.glyphIndex}))}return Z.segCountX2=2*(he-je),Z.searchRange=2*Math.pow(2,Math.floor(Math.log(he-je)/Math.log(2))),Z.entrySelector=Math.log(Z.searchRange/2)/Math.log(2),Z.rangeShift=Z.segCountX2-Z.searchRange,Z.fields=Z.fields.concat(Oe),Z.fields.push({name:"reservedPad",type:"USHORT",value:0}),Z.fields=Z.fields.concat(Ce),Z.fields=Z.fields.concat(ve),Z.fields=Z.fields.concat(He),Z.fields=Z.fields.concat(Ne),Z.cmap4Length=14+2*Oe.length+2+2*Ce.length+2*ve.length+2*He.length+2*Ne.length,M||(X=16+4*ze.length,Z.cmap12Offset=20+Z.cmap4Length,Z.fields=Z.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:X},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:ze.length/3}]),Z.fields=Z.fields.concat(ze)),Z}},ie=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ee=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],le=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Se=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Pe(j){this.font=j}function Ue(j){this.cmap=j}function Xe(j,M){this.encoding=j,this.charset=M}function Ze(j){switch(j.version){case 1:this.names=Se.slice();break;case 2:this.names=new Array(j.numberOfGlyphs);for(var M=0;M<j.numberOfGlyphs;M++)j.glyphNameIndex[M]<Se.length?this.names[M]=Se[j.glyphNameIndex[M]]:this.names[M]=j.names[j.glyphNameIndex[M]-Se.length];break;case 2.5:this.names=new Array(j.numberOfGlyphs);for(var L=0;L<j.numberOfGlyphs;L++)this.names[L]=Se[L+j.glyphNameIndex[L]];break;default:this.names=[]}}Pe.prototype.charToGlyphIndex=function(j){var M=j.codePointAt(0),L=this.font.glyphs;if(L){for(var D=0;D<L.length;D+=1)for(var V=L.get(D),X=0;X<V.unicodes.length;X+=1)if(V.unicodes[X]===M)return D}return null},Ue.prototype.charToGlyphIndex=function(j){return this.cmap.glyphIndexMap[j.codePointAt(0)]||0},Xe.prototype.charToGlyphIndex=function(j){return j=j.codePointAt(0),j=this.encoding[j],this.charset.indexOf(j)},Ze.prototype.nameToGlyphIndex=function(j){return this.names.indexOf(j)},Ze.prototype.glyphIndexToName=function(j){return this.names[j]};var et={line:function(j,M,L,D,V){j.beginPath(),j.moveTo(M,L),j.lineTo(D,V),j.stroke()}};function at(j){this.bindConstructorValues(j)}function At(j,M,L){Object.defineProperty(j,M,{get:function(){return j.path,j[L]},set:function(D){j[L]=D},enumerable:!0,configurable:!0})}function Et(j,M){if(this.font=j,this.glyphs={},Array.isArray(M))for(var L=0;L<M.length;L++)this.glyphs[L]=M[L];this.length=M&&M.length||0}at.prototype.bindConstructorValues=function(j){var M;this.index=j.index||0,this.name=j.name||null,this.unicode=j.unicode||void 0,this.unicodes=j.unicodes||j.unicode!==void 0?[j.unicode]:[],j.xMin&&(this.xMin=j.xMin),j.yMin&&(this.yMin=j.yMin),j.xMax&&(this.xMax=j.xMax),j.yMax&&(this.yMax=j.yMax),j.advanceWidth&&(this.advanceWidth=j.advanceWidth),Object.defineProperty(this,"path",(j=j.path,M=j||new J,{configurable:!0,get:function(){return M=typeof M=="function"?M():M},set:function(L){M=L}}))},at.prototype.addUnicode=function(j){this.unicodes.length===0&&(this.unicode=j),this.unicodes.push(j)},at.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},at.prototype.getPath=function(j,M,L,D,V){j=j!==void 0?j:0,M=M!==void 0?M:0,L=L!==void 0?L:72;for(var X,Z,se=(D=D||{}).xScale,pe=D.yScale,he=((X=D.hinting&&V&&V.hinting?this.path&&V.hinting.exec(this,L):X)?(Z=V.hinting.getCommands(X),j=Math.round(j),M=Math.round(M),se=pe=1):(Z=this.path.commands,D=1/this.path.unitsPerEm*L,se===void 0&&(se=D),pe===void 0&&(pe=D)),new J),je=0;je<Z.length;je+=1){var Oe=Z[je];Oe.type==="M"?he.moveTo(j+Oe.x*se,M+-Oe.y*pe):Oe.type==="L"?he.lineTo(j+Oe.x*se,M+-Oe.y*pe):Oe.type==="Q"?he.quadraticCurveTo(j+Oe.x1*se,M+-Oe.y1*pe,j+Oe.x*se,M+-Oe.y*pe):Oe.type==="C"?he.curveTo(j+Oe.x1*se,M+-Oe.y1*pe,j+Oe.x2*se,M+-Oe.y2*pe,j+Oe.x*se,M+-Oe.y*pe):Oe.type==="Z"&&he.closePath()}return he},at.prototype.getContours=function(){if(this.points===void 0)return[];for(var j=[],M=[],L=0;L<this.points.length;L+=1){var D=this.points[L];M.push(D),D.lastPointOfContour&&(j.push(M),M=[])}return B.argument(M.length===0,"There are still points left in the current contour."),j},at.prototype.getMetrics=function(){for(var j=this.path.commands,M=[],L=[],D=0;D<j.length;D+=1){var V=j[D];V.type!=="Z"&&(M.push(V.x),L.push(V.y)),V.type!=="Q"&&V.type!=="C"||(M.push(V.x1),L.push(V.y1)),V.type==="C"&&(M.push(V.x2),L.push(V.y2))}var X={xMin:Math.min.apply(null,M),yMin:Math.min.apply(null,L),xMax:Math.max.apply(null,M),yMax:Math.max.apply(null,L),leftSideBearing:this.leftSideBearing};return isFinite(X.xMin)||(X.xMin=0),isFinite(X.xMax)||(X.xMax=this.advanceWidth),isFinite(X.yMin)||(X.yMin=0),isFinite(X.yMax)||(X.yMax=0),X.rightSideBearing=this.advanceWidth-X.leftSideBearing-(X.xMax-X.xMin),X},at.prototype.draw=function(j,M,L,D,V){this.getPath(M,L,D,V).draw(j)},at.prototype.drawPoints=function(j,M,L,D){function V(je,Oe,Ce,ve){var He=2*Math.PI;j.beginPath();for(var Ne=0;Ne<je.length;Ne+=1)j.moveTo(Oe+je[Ne].x*ve,Ce+je[Ne].y*ve),j.arc(Oe+je[Ne].x*ve,Ce+je[Ne].y*ve,2,0,He,!1);j.closePath(),j.fill()}M=M!==void 0?M:0,L=L!==void 0?L:0;for(var D=1/this.path.unitsPerEm*(D=D!==void 0?D:24),X=[],Z=[],se=this.path,pe=0;pe<se.commands.length;pe+=1){var he=se.commands[pe];he.x!==void 0&&X.push({x:he.x,y:-he.y}),he.x1!==void 0&&Z.push({x:he.x1,y:-he.y1}),he.x2!==void 0&&Z.push({x:he.x2,y:-he.y2})}j.fillStyle="blue",V(X,M,L,D),j.fillStyle="red",V(Z,M,L,D)},at.prototype.drawMetrics=function(j,M,L,D){M=M!==void 0?M:0,L=L!==void 0?L:0,D=1/this.path.unitsPerEm*(D=D!==void 0?D:24),j.lineWidth=1,j.strokeStyle="black",et.line(j,M,-1e4,M,1e4),et.line(j,-1e4,L,1e4,L);var V=this.xMin||0,X=this.yMin||0,Z=this.xMax||0,se=this.yMax||0,pe=this.advanceWidth||0;j.strokeStyle="blue",et.line(j,M+V*D,-1e4,M+V*D,1e4),et.line(j,M+Z*D,-1e4,M+Z*D,1e4),et.line(j,-1e4,L+-X*D,1e4,L+-X*D),et.line(j,-1e4,L+-se*D,1e4,L+-se*D),j.strokeStyle="green",et.line(j,M+pe*D,-1e4,M+pe*D,1e4)},Et.prototype.get=function(j){return typeof this.glyphs[j]=="function"&&(this.glyphs[j]=this.glyphs[j]()),this.glyphs[j]},Et.prototype.push=function(j,M){this.glyphs[j]=M,this.length++};var dt={GlyphSet:Et,glyphLoader:function(j,M){return new at({index:M,font:j})},ttfGlyphLoader:function(j,M,L,D,V,X){return function(){var Z=new at({index:M,font:j});return Z.path=function(){L(Z,D,V);var se=X(j.glyphs,Z);return se.unitsPerEm=j.unitsPerEm,se},At(Z,"xMin","_xMin"),At(Z,"xMax","_xMax"),At(Z,"yMin","_yMin"),At(Z,"yMax","_yMax"),Z}},cffGlyphLoader:function(j,M,L,D){return function(){var V=new at({index:M,font:j});return V.path=function(){var X=L(j,V,D);return X.unitsPerEm=j.unitsPerEm,X},V}}};function Ct(j){return j=j.length<1240?107:j.length<33900?1131:32768,j}function kt(j,M,L){var D,V=[],X=[],Z=Me.getCard16(j,M);if(Z!==0){for(var se=Me.getByte(j,M+2),pe=M+(Z+1)*se+2,he=M+3,je=0;je<Z+1;je+=1)V.push(Me.getOffset(j,he,se)),he+=se;D=pe+V[Z]}else D=M+2;for(var Oe=0;Oe<V.length-1;Oe+=1){var Ce=Me.getBytes(j,pe+V[Oe],pe+V[Oe+1]);L&&(Ce=L(Ce)),X.push(Ce)}return{objects:X,startOffset:M,endOffset:D}}function rr(j,M){if(M===28)return j.parseByte()<<8|j.parseByte();if(M===29)return j.parseByte()<<24|j.parseByte()<<16|j.parseByte()<<8|j.parseByte();if(M===30){for(var L=j,D="",V=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Z=L.parseByte(),X=Z>>4,Z=15&Z;if(X==15||(D+=V[X],Z==15))break;D+=V[Z]}return parseFloat(D)}if(32<=M&&M<=246)return M-139;if(247<=M&&M<=250)return 256*(M-247)+j.parseByte()+108;if(251<=M&&M<=254)return 256*-(M-251)-j.parseByte()-108;throw new Error("Invalid b0 "+M)}function Wr(j,M,L){var D=new Me.Parser(j,M=M!==void 0?M:0),V=[],X=[];for(L=L!==void 0?L:j.length;D.relativeOffset<L;){var Z=D.parseByte();Z<=21?(Z===12&&(Z=1200+D.parseByte()),V.push([Z,X]),X=[]):X.push(rr(D,Z))}for(var se=V,pe={},he=0;he<se.length;he+=1){var je=se[he][0],Oe=se[he][1],Ce=void 0,Ce=Oe.length===1?Oe[0]:Oe;if(pe.hasOwnProperty(je)&&!isNaN(pe[je]))throw new Error("Object "+pe+" already has key "+je);pe[je]=Ce}return pe}function $r(j,M){return M=M<=390?ie[M]:j[M-391]}function Zt(j,M,L){for(var D,V={},X=0;X<M.length;X+=1){var Z=M[X];if(Array.isArray(Z.type)){var se=[];se.length=Z.type.length;for(var pe=0;pe<Z.type.length;pe++)(D=j[Z.op]!==void 0?j[Z.op][pe]:void 0)===void 0&&(D=Z.value!==void 0&&Z.value[pe]!==void 0?Z.value[pe]:null),Z.type[pe]==="SID"&&(D=$r(L,D)),se[pe]=D;V[Z.name]=se}else(D=j[Z.op])===void 0&&(D=Z.value!==void 0?Z.value:null),Z.type==="SID"&&(D=$r(L,D)),V[Z.name]=D}return V}var fr=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Wt=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function fn(j,M,L,D){return Zt(Wr(j,M,L),Wt,D)}function Qr(j,M,L,D){for(var V=[],X=0;X<L.length;X+=1){var Z=new DataView(new Uint8Array(L[X]).buffer),Z=(se=D,Zt(Wr(Z,0,Z.byteLength),fr,se)),se=(Z._subrs=[],Z._subrsBias=0,Z.private[0]),pe=Z.private[1];se!==0&&pe!==0&&(se=fn(j,pe+M,se,D),Z._defaultWidthX=se.defaultWidthX,Z._nominalWidthX=se.nominalWidthX,se.subrs!==0&&(pe=kt(j,pe+se.subrs+M),Z._subrs=pe.objects,Z._subrsBias=Ct(Z._subrs)),Z._privateDict=se),V.push(Z)}return V}function Jt(j,M,L){var D,V,X,Z,se,pe,he,je,Oe,Ce=new J,ve=[],He=0,Ne=!1,ze=!1,Re=0,De=0,wt=(Oe=(j.isCIDFont?(se=j.tables.cff.topDict._fdSelect[M.index],se=j.tables.cff.topDict._fdArray[se],pe=se._subrs,he=se._subrsBias,je=se._defaultWidthX,se):(pe=j.tables.cff.topDict._subrs,he=j.tables.cff.topDict._subrsBias,je=j.tables.cff.topDict._defaultWidthX,j.tables.cff.topDict))._nominalWidthX,je);function Ot(jt,Ft){ze&&Ce.closePath(),Ce.moveTo(jt,Ft),ze=!0}function St(){ve.length%2==0||Ne||(wt=ve.shift()+Oe),He+=ve.length>>1,ve.length=0,Ne=!0}return function jt(Ft){for(var br,qr,ln,Nn,Un,Es,yr,Cr,ir,Bn,Nr,Cn,Pr=0;Pr<Ft.length;){var xn=Ft[Pr];switch(Pr+=1,xn){case 1:case 3:St();break;case 4:1<ve.length&&!Ne&&(wt=ve.shift()+Oe,Ne=!0),De+=ve.pop(),Ot(Re,De);break;case 5:for(;0<ve.length;)Re+=ve.shift(),De+=ve.shift(),Ce.lineTo(Re,De);break;case 6:for(;0<ve.length&&(Re+=ve.shift(),Ce.lineTo(Re,De),ve.length!==0);)De+=ve.shift(),Ce.lineTo(Re,De);break;case 7:for(;0<ve.length&&(De+=ve.shift(),Ce.lineTo(Re,De),ve.length!==0);)Re+=ve.shift(),Ce.lineTo(Re,De);break;case 8:for(;0<ve.length;)D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z+ve.shift(),Ce.curveTo(D,V,X,Z,Re,De);break;case 10:Un=ve.pop()+he,(Es=pe[Un])&&jt(Es);break;case 11:return;case 12:switch(xn=Ft[Pr],Pr+=1,xn){case 35:D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),yr=X+ve.shift(),Cr=Z+ve.shift(),ir=yr+ve.shift(),Bn=Cr+ve.shift(),Nr=ir+ve.shift(),Cn=Bn+ve.shift(),Re=Nr+ve.shift(),De=Cn+ve.shift(),ve.shift(),Ce.curveTo(D,V,X,Z,yr,Cr),Ce.curveTo(ir,Bn,Nr,Cn,Re,De);break;case 34:D=Re+ve.shift(),V=De,X=D+ve.shift(),Z=V+ve.shift(),yr=X+ve.shift(),Cr=Z,ir=yr+ve.shift(),Bn=Z,Nr=ir+ve.shift(),Cn=De,Re=Nr+ve.shift(),Ce.curveTo(D,V,X,Z,yr,Cr),Ce.curveTo(ir,Bn,Nr,Cn,Re,De);break;case 36:D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),yr=X+ve.shift(),Cr=Z,ir=yr+ve.shift(),Bn=Z,Nr=ir+ve.shift(),Cn=Bn+ve.shift(),Re=Nr+ve.shift(),Ce.curveTo(D,V,X,Z,yr,Cr),Ce.curveTo(ir,Bn,Nr,Cn,Re,De);break;case 37:D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),yr=X+ve.shift(),Cr=Z+ve.shift(),ir=yr+ve.shift(),Bn=Cr+ve.shift(),Nr=ir+ve.shift(),Cn=Bn+ve.shift(),Math.abs(Nr-Re)>Math.abs(Cn-De)?Re=Nr+ve.shift():De=Cn+ve.shift(),Ce.curveTo(D,V,X,Z,yr,Cr),Ce.curveTo(ir,Bn,Nr,Cn,Re,De);break;default:console.log("Glyph "+M.index+": unknown operator 1200"+xn),ve.length=0}break;case 14:0<ve.length&&!Ne&&(wt=ve.shift()+Oe,Ne=!0),ze&&(Ce.closePath(),ze=!1);break;case 18:St();break;case 19:case 20:St(),Pr+=He+7>>3;break;case 21:2<ve.length&&!Ne&&(wt=ve.shift()+Oe,Ne=!0),De+=ve.pop(),Ot(Re+=ve.pop(),De);break;case 22:1<ve.length&&!Ne&&(wt=ve.shift()+Oe,Ne=!0),Ot(Re+=ve.pop(),De);break;case 23:St();break;case 24:for(;2<ve.length;)D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z+ve.shift(),Ce.curveTo(D,V,X,Z,Re,De);Re+=ve.shift(),De+=ve.shift(),Ce.lineTo(Re,De);break;case 25:for(;6<ve.length;)Re+=ve.shift(),De+=ve.shift(),Ce.lineTo(Re,De);D=Re+ve.shift(),V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z+ve.shift(),Ce.curveTo(D,V,X,Z,Re,De);break;case 26:for(ve.length%2&&(Re+=ve.shift());0<ve.length;)D=Re,V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X,De=Z+ve.shift(),Ce.curveTo(D,V,X,Z,Re,De);break;case 27:for(ve.length%2&&(De+=ve.shift());0<ve.length;)D=Re+ve.shift(),V=De,X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z,Ce.curveTo(D,V,X,Z,Re,De);break;case 28:br=Ft[Pr],qr=Ft[Pr+1],ve.push((br<<24|qr<<16)>>16),Pr+=2;break;case 29:Un=ve.pop()+j.gsubrsBias,(Es=j.gsubrs[Un])&&jt(Es);break;case 30:for(;0<ve.length&&(D=Re,V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z+(ve.length===1?ve.shift():0),Ce.curveTo(D,V,X,Z,Re,De),ve.length!==0);)D=Re+ve.shift(),V=De,X=D+ve.shift(),Z=V+ve.shift(),De=Z+ve.shift(),Re=X+(ve.length===1?ve.shift():0),Ce.curveTo(D,V,X,Z,Re,De);break;case 31:for(;0<ve.length&&(D=Re+ve.shift(),V=De,X=D+ve.shift(),Z=V+ve.shift(),De=Z+ve.shift(),Re=X+(ve.length===1?ve.shift():0),Ce.curveTo(D,V,X,Z,Re,De),ve.length!==0);)D=Re,V=De+ve.shift(),X=D+ve.shift(),Z=V+ve.shift(),Re=X+ve.shift(),De=Z+(ve.length===1?ve.shift():0),Ce.curveTo(D,V,X,Z,Re,De);break;default:xn<32?console.log("Glyph "+M.index+": unknown operator "+xn):xn<247?ve.push(xn-139):xn<251?(br=Ft[Pr],Pr+=1,ve.push(256*(xn-247)+br+108)):xn<255?(br=Ft[Pr],Pr+=1,ve.push(256*-(xn-251)-br-108)):(br=Ft[Pr],qr=Ft[Pr+1],ln=Ft[Pr+2],Nn=Ft[Pr+3],Pr+=4,ve.push((br<<24|qr<<16|ln<<8|Nn)/65536))}}}(L),M.advanceWidth=wt,Ce}function kr(j,M){var L,D=ie.indexOf(j);return 0<=D&&(L=D),0<=(D=M.indexOf(j))?L=D+ie.length:(L=ie.length+M.length,M.push(j)),L}function al(j,M,L){for(var D={},V=0;V<j.length;V+=1){var X=j[V],Z=M[X.name];Z===void 0||function se(pe,he){if(pe===he)return 1;if(Array.isArray(pe)&&Array.isArray(he)&&pe.length===he.length){for(var je=0;je<pe.length;je+=1)if(!se(pe[je],he[je]))return;return 1}}(Z,X.value)||(X.type==="SID"&&(Z=kr(Z,L)),D[X.op]={name:X.name,type:X.type,value:Z})}return D}function ll(j,M){var L=new Fe.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return L.dict=al(fr,j,M),L}function cl(j){var M=new Fe.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return M.topDicts=[{name:"topDict_0",type:"TABLE",value:j}],M}function sc(j){for(var M=new Fe.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),L=0;L<j.length;L+=1){var D=j.get(L),V=function(X){for(var Z=[],se=X.path,pe=(Z.push({name:"width",type:"NUMBER",value:X.advanceWidth}),0),he=0,je=0;je<se.commands.length;je+=1){var Oe,Ce,ve,He,Ne=void 0,ze=void 0,Re=se.commands[je];(Re=Re.type==="Q"?{type:"C",x:Re.x,y:Re.y,x1:1/3*pe+2/3*Re.x1,y1:1/3*he+2/3*Re.y1,x2:1/3*Re.x+2/3*Re.x1,y2:1/3*Re.y+2/3*Re.y1}:Re).type==="M"?(Ne=Math.round(Re.x-pe),ze=Math.round(Re.y-he),Z.push({name:"dx",type:"NUMBER",value:Ne}),Z.push({name:"dy",type:"NUMBER",value:ze}),Z.push({name:"rmoveto",type:"OP",value:21}),pe=Math.round(Re.x),he=Math.round(Re.y)):Re.type==="L"?(Ne=Math.round(Re.x-pe),ze=Math.round(Re.y-he),Z.push({name:"dx",type:"NUMBER",value:Ne}),Z.push({name:"dy",type:"NUMBER",value:ze}),Z.push({name:"rlineto",type:"OP",value:5}),pe=Math.round(Re.x),he=Math.round(Re.y)):Re.type==="C"&&(Oe=Math.round(Re.x1-pe),Ce=Math.round(Re.y1-he),ve=Math.round(Re.x2-Re.x1),He=Math.round(Re.y2-Re.y1),Ne=Math.round(Re.x-Re.x2),ze=Math.round(Re.y-Re.y2),Z.push({name:"dx1",type:"NUMBER",value:Oe}),Z.push({name:"dy1",type:"NUMBER",value:Ce}),Z.push({name:"dx2",type:"NUMBER",value:ve}),Z.push({name:"dy2",type:"NUMBER",value:He}),Z.push({name:"dx",type:"NUMBER",value:Ne}),Z.push({name:"dy",type:"NUMBER",value:ze}),Z.push({name:"rrcurveto",type:"OP",value:8}),pe=Math.round(Re.x),he=Math.round(Re.y))}return Z.push({name:"endchar",type:"OP",value:14}),Z}(D);M.charStrings.push({name:D.name,type:"CHARSTRING",value:V})}return M}var ul={parse:function(j,M,L){L.tables.cff={},se=j,D=M,(V={}).formatMajor=Me.getCard8(se,D),V.formatMinor=Me.getCard8(se,D+1),V.size=Me.getCard8(se,D+2),V.offsetSize=Me.getCard8(se,D+3),V.startOffset=D,V.endOffset=D+4;var se=kt(j,V.endOffset,Me.bytesToString),D=kt(j,se.endOffset),V=kt(j,D.endOffset,Me.bytesToString),se=kt(j,V.endOffset);if(L.gsubrs=se.objects,L.gsubrsBias=Ct(L.gsubrs),(se=Qr(j,M,D.objects,V.objects)).length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+se.length);if(D=se[0],(L.tables.cff.topDict=D)._privateDict&&(L.defaultWidthX=D._privateDict.defaultWidthX,L.nominalWidthX=D._privateDict.nominalWidthX),D.ros[0]!==void 0&&D.ros[1]!==void 0&&(L.isCIDFont=!0),L.isCIDFont){var se=D.fdArray,X=D.fdSelect;if(se===0||X===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");se=Qr(j,M,kt(j,se+=M).objects,V.objects),D._fdArray=se,D._fdSelect=function(Ce,ve,He,Ne){var ze,Re=[],De=new Me.Parser(Ce,ve);if((Ce=De.parseCard8())===0)for(var wt=0;wt<He;wt++){if(Ne<=(ze=De.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+ze+" (FD count "+Ne+")");Re.push(ze)}else{if(Ce!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Ce);var Ot,St=De.parseCard16(),jt=De.parseCard16();if(jt!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+jt);for(var Ft=0;Ft<St;Ft++){if(ze=De.parseCard8(),Ot=De.parseCard16(),Ne<=ze)throw new Error("CFF table CID Font FDSelect has bad FD index value "+ze+" (FD count "+Ne+")");if(He<Ot)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ot);for(;jt<Ot;jt++)Re.push(ze);jt=Ot}if(Ot!==He)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ot)}return Re}(j,X+=M,L.numGlyphs,se.length)}var X=M+D.private[1],se=fn(j,X,D.private[0],V.objects),Z=(L.defaultWidthX=se.defaultWidthX,L.nominalWidthX=se.nominalWidthX,se.subrs!==0?(X=kt(j,X+se.subrs),L.subrs=X.objects,L.subrsBias=Ct(L.subrs)):(L.subrs=[],L.subrsBias=0),kt(j,M+D.charStrings)),se=(L.nGlyphs=Z.objects.length,function(je,Oe,Ce,ve){var He=new Me.Parser(je,Oe),Ne=(--Ce,[".notdef"]);if((je=He.parseCard8())===0)for(var ze=0;ze<Ce;ze+=1)Re=He.parseSID(),Ne.push($r(ve,Re));else if(je===1)for(;Ne.length<=Ce;)for(var Re=He.parseSID(),De=He.parseCard8(),wt=0;wt<=De;wt+=1)Ne.push($r(ve,Re)),Re+=1;else{if(je!==2)throw new Error("Unknown charset format "+je);for(;Ne.length<=Ce;){Re=He.parseSID(),De=He.parseCard16();for(var Ot=0;Ot<=De;Ot+=1)Ne.push($r(ve,Re)),Re+=1}}return Ne}(j,M+D.charset,L.nGlyphs,V.objects));D.encoding===0?L.cffEncoding=new Xe(ee,se):D.encoding===1?L.cffEncoding=new Xe(le,se):L.cffEncoding=function(je,Oe,Ce){var ve={},He=new Me.Parser(je,Oe);if((je=He.parseCard8())===0)for(var Ne=He.parseCard8(),ze=0;ze<Ne;ze+=1)ve[De=He.parseCard8()]=ze;else{if(je!==1)throw new Error("Unknown encoding format "+je);for(var Re=He.parseCard8(),De=1,wt=0;wt<Re;wt+=1)for(var Ot=He.parseCard8(),St=He.parseCard8(),jt=Ot;jt<=Ot+St;jt+=1)ve[jt]=De,De+=1}return new Xe(ve,Ce)}(j,M+D.encoding,se),L.encoding=L.encoding||L.cffEncoding,L.glyphs=new dt.GlyphSet(L);for(var pe=0;pe<L.nGlyphs;pe+=1){var he=Z.objects[pe];L.glyphs.push(pe,dt.cffGlyphLoader(L,pe,Jt,he))}},make:function(j,je){for(var L,D=new Fe.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),V=1/je.unitsPerEm,V={version:je.version,fullName:je.fullName,familyName:je.familyName,weight:je.weightName,fontBBox:je.fontBBox||[0,0,0,0],fontMatrix:[V,0,0,V,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},X=[],Z=1;Z<j.length;Z+=1)L=j.get(Z),X.push(L.name);var se,pe,he=[],je=(D.header=new Fe.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),D.nameIndex=function(Ce){var ve=new Fe.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);ve.names=[];for(var He=0;He<Ce.length;He+=1)ve.names.push({name:"name_"+He,type:"NAME",value:Ce[He]});return ve}([je.postScriptName]),ll(V,he)),Oe=(D.topDictIndex=cl(je),D.globalSubrIndex=new Fe.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),D.charsets=function(Ce,ve){for(var He=new Fe.Record("Charsets",[{name:"format",type:"Card8",value:0}]),Ne=0;Ne<Ce.length;Ne+=1){var ze=kr(Ce[Ne],ve);He.fields.push({name:"glyph_"+Ne,type:"SID",value:ze})}return He}(X,he),D.charStringsIndex=sc(j),D.privateDict=(Oe={},se=he,(pe=new Fe.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=al(Wt,Oe,se),pe),D.stringIndex=function(Ce){var ve=new Fe.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);ve.strings=[];for(var He=0;He<Ce.length;He+=1)ve.strings.push({name:"string_"+He,type:"STRING",value:Ce[He]});return ve}(he),D.header.sizeOf()+D.nameIndex.sizeOf()+D.topDictIndex.sizeOf()+D.stringIndex.sizeOf()+D.globalSubrIndex.sizeOf());return V.charset=Oe,V.encoding=0,V.charStrings=V.charset+D.charsets.sizeOf(),V.private[1]=V.charStrings+D.charStringsIndex.sizeOf(),je=ll(V,he),D.topDictIndex=cl(je),D}},ro={parse:function(D,M){var L={},D=new Me.Parser(D,M);return L.version=D.parseVersion(),L.fontRevision=Math.round(1e3*D.parseFixed())/1e3,L.checkSumAdjustment=D.parseULong(),L.magicNumber=D.parseULong(),B.argument(L.magicNumber===1594834165,"Font header has wrong magic number."),L.flags=D.parseUShort(),L.unitsPerEm=D.parseUShort(),L.created=D.parseLongDateTime(),L.modified=D.parseLongDateTime(),L.xMin=D.parseShort(),L.yMin=D.parseShort(),L.xMax=D.parseShort(),L.yMax=D.parseShort(),L.macStyle=D.parseUShort(),L.lowestRecPPEM=D.parseUShort(),L.fontDirectionHint=D.parseShort(),L.indexToLocFormat=D.parseShort(),L.glyphDataFormat=D.parseShort(),L},make:function(j){var M=Math.round(new Date().getTime()/1e3)+2082844800,L=M;return j.createdTimestamp&&(L=j.createdTimestamp+2082844800),new Fe.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:L},{name:"modified",type:"LONGDATETIME",value:M},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],j)}},be={parse:function(D,M){var L={},D=new Me.Parser(D,M);return L.version=D.parseVersion(),L.ascender=D.parseShort(),L.descender=D.parseShort(),L.lineGap=D.parseShort(),L.advanceWidthMax=D.parseUShort(),L.minLeftSideBearing=D.parseShort(),L.minRightSideBearing=D.parseShort(),L.xMaxExtent=D.parseShort(),L.caretSlopeRise=D.parseShort(),L.caretSlopeRun=D.parseShort(),L.caretOffset=D.parseShort(),D.relativeOffset+=8,L.metricDataFormat=D.parseShort(),L.numberOfHMetrics=D.parseUShort(),L},make:function(j){return new Fe.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],j)}},Qe={parse:function(j,M,L,D,V){for(var X,Z,se=new Me.Parser(j,M),pe=0;pe<D;pe+=1){pe<L&&(X=se.parseUShort(),Z=se.parseShort());var he=V.get(pe);he.advanceWidth=X,he.leftSideBearing=Z}},make:function(j){for(var M=new Fe.Table("hmtx",[]),L=0;L<j.length;L+=1){var V=j.get(L),D=V.advanceWidth||0,V=V.leftSideBearing||0;M.fields.push({name:"advanceWidth_"+L,type:"USHORT",value:D}),M.fields.push({name:"leftSideBearing_"+L,type:"SHORT",value:V})}return M}},ct={make:function(j){for(var M=new Fe.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:j.length}]),L="",D=12+4*j.length,V=0;V<j.length;++V){var X=L.indexOf(j[V]);X<0&&(X=L.length,L+=j[V]),M.fields.push({name:"offset "+V,type:"USHORT",value:D+X}),M.fields.push({name:"length "+V,type:"USHORT",value:j[V].length})}return M.fields.push({name:"stringPool",type:"CHARARRAY",value:L}),M},parse:function(j,M){for(var L=new Me.Parser(j,M),D=L.parseULong(),V=(B.argument(D===1,"Unsupported ltag table version."),L.skip("uLong",1),L.parseULong()),X=[],Z=0;Z<V;Z++){for(var se="",pe=M+L.parseUShort(),he=L.parseUShort(),je=pe;je<pe+he;++je)se+=String.fromCharCode(j.getInt8(je));X.push(se)}return X}},Ke={parse:function(D,M){var L={},D=new Me.Parser(D,M);return L.version=D.parseVersion(),L.numGlyphs=D.parseUShort(),L.version===1&&(L.maxPoints=D.parseUShort(),L.maxContours=D.parseUShort(),L.maxCompositePoints=D.parseUShort(),L.maxCompositeContours=D.parseUShort(),L.maxZones=D.parseUShort(),L.maxTwilightPoints=D.parseUShort(),L.maxStorage=D.parseUShort(),L.maxFunctionDefs=D.parseUShort(),L.maxInstructionDefs=D.parseUShort(),L.maxStackElements=D.parseUShort(),L.maxSizeOfInstructions=D.parseUShort(),L.maxComponentElements=D.parseUShort(),L.maxComponentDepth=D.parseUShort()),L},make:function(j){return new Fe.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:j}])}},Ut=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Ge={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},$t={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},st={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},zt="utf-16",lt={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Fr={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Or(j,M,L){switch(j){case 0:return zt;case 1:return Fr[L]||lt[M];case 3:if(M===1||M===10)return zt}}function Lr(j){var M,L={};for(M in j)L[j[M]]=parseInt(M);return L}function nn(j,M,L,D,V,X){return new Fe.Record("NameRecord",[{name:"platformID",type:"USHORT",value:j},{name:"encodingID",type:"USHORT",value:M},{name:"languageID",type:"USHORT",value:L},{name:"nameID",type:"USHORT",value:D},{name:"length",type:"USHORT",value:V},{name:"offset",type:"USHORT",value:X}])}function mn(j,M){if((L=function(X,Z){var se=X.length,pe=Z.length-se+1;e:for(var he=0;he<pe;he++)for(;he<pe;he++){for(var je=0;je<se;je++)if(Z[he+je]!==X[je])continue e;return he}return-1}(j,M))<0)for(var L=M.length,D=0,V=j.length;D<V;++D)M.push(j[D]);return L}var no={parse:function(j,M,L){for(var D={},V=new Me.Parser(j,M),M=V.parseUShort(),X=V.parseUShort(),Z=V.offset+V.parseUShort(),se=0;se<X;se++){var He=V.parseUShort(),pe=V.parseUShort(),he=V.parseUShort(),je=V.parseUShort(),je=Ut[je]||je,Oe=V.parseUShort(),Ce=V.parseUShort(),ve=function(ze,Re,De){switch(ze){case 0:if(Re===65535)return"und";if(De)return De[Re];break;case 1:return Ge[Re];case 3:return st[Re]}}(He,he,L),He=Or(He,pe,he);He!==void 0&&ve!==void 0&&(pe=void 0,(pe=He===zt?W.UTF16(j,Z+Ce,Oe):W.MACSTRING(j,Z+Ce,Oe,He))&&((he=(he=D[je])===void 0?D[je]={}:he)[ve]=pe))}return M===1&&V.parseUShort(),D},make:function(j,M){var L,D=[],V={},X=Lr(Ut);for(L in j){var Z=X[L];if(Z===void 0&&(Z=L),Ce=parseInt(Z),isNaN(Ce))throw new Error('Name table entry "'+L+'" does not exist, see nameTableNames for complete list.');V[Ce]=j[L],D.push(Ce)}for(var se=Lr(Ge),pe=Lr(st),he=[],je=[],Oe=0;Oe<D.length;Oe++){var Ce,ve,He=V[Ce=D[Oe]];for(ve in He){var Ne=He[ve],Ot=1,ze=se[ve],Re=$t[ze],De=Or(Ot,Re,ze),De=K.MACSTRING(Ne,De),wt=(De===void 0&&(Ot=0,(ze=M.indexOf(ve))<0&&(ze=M.length,M.push(ve)),Re=4,De=K.UTF16(Ne)),mn(De,je)),Ot=(he.push(nn(Ot,Re,ze,Ce,De.length,wt)),pe[ve]);Ot!==void 0&&(ze=mn(Re=K.UTF16(Ne),je),he.push(nn(3,1,Ot,Ce,Re.length,ze)))}}he.sort(function(Ft,br){return Ft.platformID-br.platformID||Ft.encodingID-br.encodingID||Ft.languageID-br.languageID||Ft.nameID-br.nameID});for(var St=new Fe.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:he.length},{name:"stringOffset",type:"USHORT",value:6+12*he.length}]),jt=0;jt<he.length;jt++)St.fields.push({name:"record_"+jt,type:"RECORD",value:he[jt]});return St.fields.push({name:"strings",type:"LITERAL",value:je}),St}},is=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],on={parse:function(j,M){var L={},D=new Me.Parser(j,M);L.version=D.parseUShort(),L.xAvgCharWidth=D.parseShort(),L.usWeightClass=D.parseUShort(),L.usWidthClass=D.parseUShort(),L.fsType=D.parseUShort(),L.ySubscriptXSize=D.parseShort(),L.ySubscriptYSize=D.parseShort(),L.ySubscriptXOffset=D.parseShort(),L.ySubscriptYOffset=D.parseShort(),L.ySuperscriptXSize=D.parseShort(),L.ySuperscriptYSize=D.parseShort(),L.ySuperscriptXOffset=D.parseShort(),L.ySuperscriptYOffset=D.parseShort(),L.yStrikeoutSize=D.parseShort(),L.yStrikeoutPosition=D.parseShort(),L.sFamilyClass=D.parseShort(),L.panose=[];for(var V=0;V<10;V++)L.panose[V]=D.parseByte();return L.ulUnicodeRange1=D.parseULong(),L.ulUnicodeRange2=D.parseULong(),L.ulUnicodeRange3=D.parseULong(),L.ulUnicodeRange4=D.parseULong(),L.achVendID=String.fromCharCode(D.parseByte(),D.parseByte(),D.parseByte(),D.parseByte()),L.fsSelection=D.parseUShort(),L.usFirstCharIndex=D.parseUShort(),L.usLastCharIndex=D.parseUShort(),L.sTypoAscender=D.parseShort(),L.sTypoDescender=D.parseShort(),L.sTypoLineGap=D.parseShort(),L.usWinAscent=D.parseUShort(),L.usWinDescent=D.parseUShort(),1<=L.version&&(L.ulCodePageRange1=D.parseULong(),L.ulCodePageRange2=D.parseULong()),2<=L.version&&(L.sxHeight=D.parseShort(),L.sCapHeight=D.parseShort(),L.usDefaultChar=D.parseUShort(),L.usBreakChar=D.parseUShort(),L.usMaxContent=D.parseUShort()),L},make:function(j){return new Fe.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],j)},unicodeRanges:is,getUnicodeRange:function(j){for(var M=0;M<is.length;M+=1){var L=is[M];if(j>=L.begin&&j<L.end)return M}return-1}},op={parse:function(j,M){var L={},D=new Me.Parser(j,M);switch(L.version=D.parseVersion(),L.italicAngle=D.parseFixed(),L.underlinePosition=D.parseShort(),L.underlineThickness=D.parseShort(),L.isFixedPitch=D.parseULong(),L.minMemType42=D.parseULong(),L.maxMemType42=D.parseULong(),L.minMemType1=D.parseULong(),L.maxMemType1=D.parseULong(),L.version){case 1:L.names=Se.slice();break;case 2:L.numberOfGlyphs=D.parseUShort(),L.glyphNameIndex=new Array(L.numberOfGlyphs);for(var V=0;V<L.numberOfGlyphs;V++)L.glyphNameIndex[V]=D.parseUShort();L.names=[];for(var X,Z=0;Z<L.numberOfGlyphs;Z++)L.glyphNameIndex[Z]>=Se.length&&(X=D.parseChar(),L.names.push(D.parseString(X)));break;case 2.5:L.numberOfGlyphs=D.parseUShort(),L.offset=new Array(L.numberOfGlyphs);for(var se=0;se<L.numberOfGlyphs;se++)L.offset[se]=D.parseChar()}return L},make:function(){return new Fe.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},No=new Array(9),aa=(No[1]=function(){var j=this.offset+this.relativeOffset,M=this.parseUShort();return M===1?{substFormat:1,coverage:this.parsePointer(Ee.coverage),deltaGlyphId:this.parseUShort()}:M===2?{substFormat:2,coverage:this.parsePointer(Ee.coverage),substitute:this.parseOffset16List()}:void B.assert(!1,"0x"+j.toString(16)+": lookup type 1 format must be 1 or 2.")},No[2]=function(){var j=this.parseUShort();return B.argument(j===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:j,coverage:this.parsePointer(Ee.coverage),sequences:this.parseListOfLists()}},No[3]=function(){var j=this.parseUShort();return B.argument(j===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:j,coverage:this.parsePointer(Ee.coverage),alternateSets:this.parseListOfLists()}},No[4]=function(){var j=this.parseUShort();return B.argument(j===1,"GSUB ligature table identifier-format must be 1"),{substFormat:j,coverage:this.parsePointer(Ee.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}},{sequenceIndex:Ee.uShort,lookupListIndex:Ee.uShort});No[5]=function(){var j,M,L=this.offset+this.relativeOffset,D=this.parseUShort();return D===1?{substFormat:D,coverage:this.parsePointer(Ee.coverage),ruleSets:this.parseListOfLists(function(){var V=this.parseUShort(),X=this.parseUShort();return{input:this.parseUShortList(V-1),lookupRecords:this.parseRecordList(X,aa)}})}:D===2?{substFormat:D,coverage:this.parsePointer(Ee.coverage),classDef:this.parsePointer(Ee.classDef),classSets:this.parseListOfLists(function(){var V=this.parseUShort(),X=this.parseUShort();return{classes:this.parseUShortList(V-1),lookupRecords:this.parseRecordList(X,aa)}})}:D===3?(j=this.parseUShort(),M=this.parseUShort(),{substFormat:D,coverages:this.parseList(j,Ee.pointer(Ee.coverage)),lookupRecords:this.parseRecordList(M,aa)}):void B.assert(!1,"0x"+L.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},No[6]=function(){var j=this.offset+this.relativeOffset,M=this.parseUShort();return M===1?{substFormat:1,coverage:this.parsePointer(Ee.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(aa)}})}:M===2?{substFormat:2,coverage:this.parsePointer(Ee.coverage),backtrackClassDef:this.parsePointer(Ee.classDef),inputClassDef:this.parsePointer(Ee.classDef),lookaheadClassDef:this.parsePointer(Ee.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(aa)}})}:M===3?{substFormat:3,backtrackCoverage:this.parseList(Ee.pointer(Ee.coverage)),inputCoverage:this.parseList(Ee.pointer(Ee.coverage)),lookaheadCoverage:this.parseList(Ee.pointer(Ee.coverage)),lookupRecords:this.parseRecordList(aa)}:void B.assert(!1,"0x"+j.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},No[7]=function(){var j=this.parseUShort(),j=(B.argument(j===1,"GSUB Extension Substitution subtable identifier-format must be 1"),this.parseUShort()),M=new Ee(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:j,extension:No[j].call(M)}},No[8]=function(){var j=this.parseUShort();return B.argument(j===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:j,coverage:this.parsePointer(Ee.coverage),backtrackCoverage:this.parseList(Ee.pointer(Ee.coverage)),lookaheadCoverage:this.parseList(Ee.pointer(Ee.coverage)),substitutes:this.parseUShortList()}};var wi=new Array(9);wi[1]=function(j){return j.substFormat===1?new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(j.coverage)},{name:"deltaGlyphID",type:"USHORT",value:j.deltaGlyphId}]):new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Fe.Coverage(j.coverage)}].concat(Fe.ushortList("substitute",j.substitute)))},wi[3]=function(j){return B.assert(j.substFormat===1,"Lookup type 3 substFormat must be 1."),new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(j.coverage)}].concat(Fe.tableList("altSet",j.alternateSets,function(M){return new Fe.Table("alternateSetTable",Fe.ushortList("alternate",M))})))},wi[4]=function(j){return B.assert(j.substFormat===1,"Lookup type 4 substFormat must be 1."),new Fe.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Fe.Coverage(j.coverage)}].concat(Fe.tableList("ligSet",j.ligatureSets,function(M){return new Fe.Table("ligatureSetTable",Fe.tableList("ligature",M,function(L){return new Fe.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:L.ligGlyph}].concat(Fe.ushortList("component",L.components,L.components.length+1)))}))})))};var sp={parse:function(j,M){return M=(j=new Ee(j,M=M||0)).parseVersion(1),B.argument(M===1||M===1.1,"Unsupported GSUB table version."),M===1?{version:M,scripts:j.parseScriptList(),features:j.parseFeatureList(),lookups:j.parseLookupList(No)}:{version:M,scripts:j.parseScriptList(),features:j.parseFeatureList(),lookups:j.parseLookupList(No),variations:j.parseFeatureVariationsList()}},make:function(j){return new Fe.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Fe.ScriptList(j.scripts)},{name:"features",type:"TABLE",value:new Fe.FeatureList(j.features)},{name:"lookups",type:"TABLE",value:new Fe.LookupList(j.lookups,wi)}])}},la={parse:function(j,M){for(var L=new Me.Parser(j,M),D=L.parseULong(),V=(B.argument(D===1,"Unsupported META table version."),L.parseULong(),L.parseULong(),L.parseULong()),X={},Z=0;Z<V;Z++){var se=L.parseTag(),he=L.parseULong(),pe=L.parseULong(),he=W.UTF8(j,M+he,pe);X[se]=he}return X},make:function(j){var M,L=Object.keys(j).length,D="",V=16+12*L,X=new Fe.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:V},{name:"numTags",type:"ULONG",value:L}]);for(M in j){var Z=D.length;D+=j[M],X.fields.push({name:"tag "+M,type:"TAG",value:M}),X.fields.push({name:"offset "+M,type:"ULONG",value:V+Z}),X.fields.push({name:"length "+M,type:"ULONG",value:j[M].length})}return X.fields.push({name:"stringPool",type:"CHARARRAY",value:D}),X}};function Vu(j){return Math.log(j)/Math.log(2)|0}function ic(j){for(;j.length%4!=0;)j.push(0);for(var M=0,L=0;L<j.length;L+=4)M+=(j[L]<<24)+(j[L+1]<<16)+(j[L+2]<<8)+j[L+3];return M%=Math.pow(2,32)}function ip(j,M,L,D){return new Fe.Record("Table Record",[{name:"tag",type:"TAG",value:j!==void 0?j:""},{name:"checkSum",type:"ULONG",value:M!==void 0?M:0},{name:"offset",type:"ULONG",value:L!==void 0?L:0},{name:"length",type:"ULONG",value:D!==void 0?D:0}])}function ap(j){for(var M=new Fe.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),L=(M.tables=j,M.numTables=j.length,Math.pow(2,Vu(M.numTables))),D=(M.searchRange=16*L,M.entrySelector=Vu(L),M.rangeShift=16*M.numTables-M.searchRange,[]),V=[],X=M.sizeOf()+ip().sizeOf()*M.numTables;X%4!=0;)X+=1,V.push({name:"padding",type:"BYTE",value:0});for(var Z=0;Z<j.length;Z+=1){var se=j[Z],pe=(B.argument(se.tableName.length===4,"Table name"+se.tableName+" is invalid."),se.sizeOf()),he=ip(se.tableName,ic(se.encode()),X,pe);for(D.push({name:he.tag+" Table Record",type:"RECORD",value:he}),V.push({name:se.tableName+" table",type:"RECORD",value:se}),X+=pe,B.argument(!isNaN(X),"Something went wrong calculating the offset.");X%4!=0;)X+=1,V.push({name:"padding",type:"BYTE",value:0})}return D.sort(function(je,Oe){return je.value.tag>Oe.value.tag?1:-1}),M.fields=M.fields.concat(D),M.fields=M.fields.concat(V),M}function lp(j,M,L){for(var D=0;D<M.length;D+=1){var V=j.charToGlyphIndex(M[D]);if(0<V)return j.glyphs.get(V).getMetrics()}return L}var Uy={make:ap,fontToTable:function(j){for(var M,L=[],D=[],V=[],X=[],Z=[],se=[],pe=[],he=0,je=0,Oe=0,Ce=0,ve=0,He=0;He<j.glyphs.length;He+=1){var Ne=j.glyphs.get(He),ze=0|Ne.unicode;if(isNaN(Ne.advanceWidth))throw new Error("Glyph "+Ne.name+" ("+He+"): advanceWidth is not a number.");(ze<M||M===void 0)&&0<ze&&(M=ze),he<ze&&(he=ze);var ze=on.getUnicodeRange(ze);if(ze<32)je|=1<<ze;else if(ze<64)Oe|=1<<ze-32;else if(ze<96)Ce|=1<<ze-64;else{if(!(ze<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");ve|=1<<ze-96}Ne.name!==".notdef"&&(ze=Ne.getMetrics(),L.push(ze.xMin),D.push(ze.yMin),V.push(ze.xMax),X.push(ze.yMax),se.push(ze.leftSideBearing),pe.push(ze.rightSideBearing),Z.push(Ne.advanceWidth))}var Re,De={xMin:Math.min.apply(null,L),yMin:Math.min.apply(null,D),xMax:Math.max.apply(null,V),yMax:Math.max.apply(null,X),advanceWidthMax:Math.max.apply(null,Z),advanceWidthAvg:function(xn){for(var Ku=0,cc=0;cc<xn.length;cc+=1)Ku+=xn[cc];return Ku/xn.length}(Z),minLeftSideBearing:Math.min.apply(null,se),maxLeftSideBearing:Math.max.apply(null,se),minRightSideBearing:Math.min.apply(null,pe)},wt=(De.ascender=j.ascender,De.descender=j.descender,ro.make({flags:3,unitsPerEm:j.unitsPerEm,xMin:De.xMin,yMin:De.yMin,xMax:De.xMax,yMax:De.yMax,lowestRecPPEM:3,createdTimestamp:j.createdTimestamp})),Ot=be.make({ascender:De.ascender,descender:De.descender,advanceWidthMax:De.advanceWidthMax,minLeftSideBearing:De.minLeftSideBearing,minRightSideBearing:De.minRightSideBearing,xMaxExtent:De.maxLeftSideBearing+(De.xMax-De.xMin),numberOfHMetrics:j.glyphs.length}),St=Ke.make(j.glyphs.length),jt=on.make({xAvgCharWidth:Math.round(De.advanceWidthAvg),usWeightClass:j.tables.os2.usWeightClass,usWidthClass:j.tables.os2.usWidthClass,usFirstCharIndex:M,usLastCharIndex:he,ulUnicodeRange1:je,ulUnicodeRange2:Oe,ulUnicodeRange3:Ce,ulUnicodeRange4:ve,fsSelection:j.tables.os2.fsSelection,sTypoAscender:De.ascender,sTypoDescender:De.descender,sTypoLineGap:0,usWinAscent:De.yMax,usWinDescent:Math.abs(De.yMin),ulCodePageRange1:1,sxHeight:lp(j,"xyvw",{yMax:Math.round(De.ascender/2)}).yMax,sCapHeight:lp(j,"HIKLEFJMNTZBDPRAGOQSUVWXY",De).yMax,usDefaultChar:j.hasChar(" ")?32:0,usBreakChar:j.hasChar(" ")?32:0}),Ft=Qe.make(j.glyphs),br=re.make(j.glyphs),Cr=j.getEnglishName("fontFamily"),ir=j.getEnglishName("fontSubfamily"),yr=Cr+" "+ir,qr=(qr=j.getEnglishName("postScriptName"))||Cr.replace(/\s/g,"")+"-"+ir,ln={};for(Re in j.names)ln[Re]=j.names[Re];ln.uniqueID||(ln.uniqueID={en:j.getEnglishName("manufacturer")+":"+yr}),ln.postScriptName||(ln.postScriptName={en:qr}),ln.preferredFamily||(ln.preferredFamily=j.names.fontFamily),ln.preferredSubfamily||(ln.preferredSubfamily=j.names.fontSubfamily);var Un=[],Nn=no.make(ln,Un),Un=0<Un.length?ct.make(Un):void 0,Es=op.make(),yr=ul.make(j.glyphs,{version:j.getEnglishName("version"),fullName:yr,familyName:Cr,weightName:ir,postScriptName:qr,unitsPerEm:j.unitsPerEm,fontBBox:[0,De.yMin,De.ascender,De.advanceWidthMax]}),Cr=j.metas&&0<Object.keys(j.metas).length?la.make(j.metas):void 0,ir=[wt,Ot,St,jt,Nn,br,Es,yr,Ft];Un&&ir.push(Un),j.tables.gsub&&ir.push(sp.make(j.tables.gsub)),Cr&&ir.push(Cr);for(var Bn=ic((qr=ap(ir)).encode()),Nr=qr.fields,Cn=!1,Pr=0;Pr<Nr.length;Pr+=1)if(Nr[Pr].name==="head table"){Nr[Pr].value.checkSumAdjustment=2981146554-Bn,Cn=!0;break}if(Cn)return qr;throw new Error("Could not find head table with checkSum to adjust.")},computeCheckSum:ic};function ac(j,M){for(var L=0,D=j.length-1;L<=D;){var V=L+D>>>1,X=j[V].tag;if(X===M)return V;X<M?L=1+V:D=V-1}return-L-1}function cp(j,M){for(var L=0,D=j.length-1;L<=D;){var V=L+D>>>1,X=j[V];if(X===M)return V;X<M?L=1+V:D=V-1}return-L-1}function up(j,M){for(var L=0,D=j.length-1;L<=D;){var V,X=L+D>>>1,Z=(V=j[X]).start;if(Z===M)return V;Z<M?L=1+X:D=X-1}if(0<L)return M>(V=j[L-1]).end?0:V}function dl(j,M){this.font=j,this.tableName=M}function Si(j){dl.call(this,j,"gpos")}function En(j){dl.call(this,j,"gsub")}function dp(j,M,L){for(var D=j.subtables,V=0;V<D.length;V++){var X=D[V];if(X.substFormat===M)return X}if(L)return D.push(L),L}function hp(j){for(var M=new ArrayBuffer(j.length),L=new Uint8Array(M),D=0;D<j.length;++D)L[D]=j[D];return M}function oo(j,M){if(!j)throw M}function pp(j,M,L,D,V){var X=0<(M&D)?(X=j.parseByte(),L+(X=M&V?X:-X)):0<(M&V)?L:L+j.parseShort();return X}function By(j,M,L){var D,V=new Me.Parser(M,L);if(j.numberOfContours=V.parseShort(),j._xMin=V.parseShort(),j._yMin=V.parseShort(),j._xMax=V.parseShort(),j._yMax=V.parseShort(),0<j.numberOfContours){for(var X=j.endPointIndices=[],Z=0;Z<j.numberOfContours;Z+=1)X.push(V.parseUShort());j.instructionLength=V.parseUShort(),j.instructions=[];for(var se=0;se<j.instructionLength;se+=1)j.instructions.push(V.parseByte());for(var pe=X[X.length-1]+1,he=[],je=0;je<pe;je+=1)if(D=V.parseByte(),he.push(D),0<(8&D))for(var Oe=V.parseByte(),Ce=0;Ce<Oe;Ce+=1)he.push(D),je+=1;if(B.argument(he.length===pe,"Bad flags."),0<X.length){var ve,He=[];if(0<pe){for(var Ne=0;Ne<pe;Ne+=1)D=he[Ne],(ve={}).onCurve=!!(1&D),ve.lastPointOfContour=0<=X.indexOf(Ne),He.push(ve);for(var ze=0,Re=0;Re<pe;Re+=1)D=he[Re],(ve=He[Re]).x=pp(V,D,ze,2,16),ze=ve.x;for(var De=0,wt=0;wt<pe;wt+=1)D=he[wt],(ve=He[wt]).y=pp(V,D,De,4,32),De=ve.y}j.points=He}else j.points=[]}else if(j.numberOfContours===0)j.points=[];else{j.isComposite=!0,j.points=[],j.components=[];for(var Ot=!0;Ot;){he=V.parseUShort();var St={glyphIndex:V.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&he)?0<(2&he)?(St.dx=V.parseShort(),St.dy=V.parseShort()):St.matchedPoints=[V.parseUShort(),V.parseUShort()]:0<(2&he)?(St.dx=V.parseChar(),St.dy=V.parseChar()):St.matchedPoints=[V.parseByte(),V.parseByte()],0<(8&he)?St.xScale=St.yScale=V.parseF2Dot14():0<(64&he)?(St.xScale=V.parseF2Dot14(),St.yScale=V.parseF2Dot14()):0<(128&he)&&(St.xScale=V.parseF2Dot14(),St.scale01=V.parseF2Dot14(),St.scale10=V.parseF2Dot14(),St.yScale=V.parseF2Dot14()),j.components.push(St),Ot=!!(32&he)}if(256&he){j.instructionLength=V.parseUShort(),j.instructions=[];for(var jt=0;jt<j.instructionLength;jt+=1)j.instructions.push(V.parseByte())}}}function Hu(j,M){for(var L=[],D=0;D<j.length;D+=1){var V=j[D],V={x:M.xScale*V.x+M.scale01*V.y+M.dx,y:M.scale10*V.x+M.yScale*V.y+M.dy,onCurve:V.onCurve,lastPointOfContour:V.lastPointOfContour};L.push(V)}return L}function fp(j){var M=new J;if(j)for(var L=function(Oe){for(var Ce=[],ve=[],He=0;He<Oe.length;He+=1){var Ne=Oe[He];ve.push(Ne),Ne.lastPointOfContour&&(Ce.push(ve),ve=[])}return B.argument(ve.length===0,"There are still points left in the current contour."),Ce}(j),D=0;D<L.length;++D){var V,X=L[D],Z=X[X.length-1],se=X[0];Z.onCurve?M.moveTo(Z.x,Z.y):se.onCurve?M.moveTo(se.x,se.y):(V={x:.5*(Z.x+se.x),y:.5*(Z.y+se.y)},M.moveTo(V.x,V.y));for(var pe=0;pe<X.length;++pe){var he,je=Z,Z=se,se=X[(pe+1)%X.length];Z.onCurve?M.lineTo(Z.x,Z.y):(he=se,je.onCurve||(Z.x,je.x,Z.y,je.y),se.onCurve||(he={x:.5*(Z.x+se.x),y:.5*(Z.y+se.y)}),M.quadraticCurveTo(Z.x,Z.y,he.x,he.y))}M.closePath()}return M}function zy(j,M){if(M.isComposite)for(var L=0;L<M.components.length;L+=1){var D=M.components[L],V=j.get(D.glyphIndex);if(V.getPath(),V.points){var X=void 0;if(D.matchedPoints===void 0)X=Hu(V.points,D);else{if(D.matchedPoints[0]>M.points.length-1||D.matchedPoints[1]>V.points.length-1)throw Error("Matched points out of range in "+M.name);var Z=M.points[D.matchedPoints[0]],se=V.points[D.matchedPoints[1]],D={xScale:D.xScale,scale01:D.scale01,scale10:D.scale10,yScale:D.yScale,dx:0,dy:0},se=Hu([se],D)[0];D.dx=Z.x-se.x,D.dy=Z.y-se.y,X=Hu(V.points,D)}M.points=M.points.concat(X)}}return fp(M.points)}(Si.prototype=dl.prototype={searchTag:ac,binSearch:cp,getTable:function(j){var M=this.font.tables[this.tableName];return M=!M&&j?this.font.tables[this.tableName]=this.createDefaultTable():M},getScriptNames:function(){var j=this.getTable();return j?j.scripts.map(function(M){return M.tag}):[]},getDefaultScriptName:function(){var j=this.getTable();if(j){for(var M=!1,L=0;L<j.scripts.length;L++){var D=j.scripts[L].tag;if(D==="DFLT")return D;D==="latn"&&(M=!0)}return M?"latn":void 0}},getScriptTable:function(j,M){var L,D=this.getTable(M);if(D)return L=D.scripts,0<=(D=ac(D.scripts,j=j||"DFLT"))?L[D].script:M?(L.splice(-1-D,0,M={tag:j,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}),M.script):void 0},getLangSysTable:function(V,M,L){var D,V=this.getScriptTable(V,L);if(V)return M&&M!=="dflt"&&M!=="DFLT"?0<=(D=ac(V.langSysRecords,M))?V.langSysRecords[D].langSys:L?(V.langSysRecords.splice(-1-D,0,L={tag:M,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}}),L.langSys):void 0:V.defaultLangSys},getFeatureTable:function(j,M,L,D){if(j=this.getLangSysTable(j,M,D),j){for(var V,X=j.featureIndexes,Z=this.font.tables[this.tableName].features,se=0;se<X.length;se++)if((V=Z[X[se]]).tag===L)return V.feature;if(D)return M=Z.length,B.assert(M===0||L>=Z[M-1].tag,"Features must be added in alphabetical order."),Z.push(V={tag:L,feature:{params:0,lookupListIndexes:[]}}),X.push(M),V.feature}},getLookupTables:function(X,M,L,D,V){var X=this.getFeatureTable(X,M,L,V),Z=[];if(X){for(var se,pe=X.lookupListIndexes,he=this.font.tables[this.tableName].lookups,je=0;je<pe.length;je++)(se=he[pe[je]]).lookupType===D&&Z.push(se);if(Z.length===0&&V)return M=he.length,he.push(se={lookupType:D,lookupFlag:0,subtables:[],markFilteringSet:void 0}),pe.push(M),[se]}return Z},getGlyphClass:function(j,M){switch(j.format){case 1:return j.startGlyph<=M&&M<j.startGlyph+j.classes.length?j.classes[M-j.startGlyph]:0;case 2:var L=up(j.ranges,M);return L?L.classId:0}},getCoverageIndex:function(j,M){switch(j.format){case 1:var L=cp(j.glyphs,M);return 0<=L?L:-1;case 2:return L=up(j.ranges,M),L?L.index+M-L.start:-1}},expandCoverage:function(j){if(j.format===1)return j.glyphs;for(var M=[],L=j.ranges,D=0;D<L.length;D++)for(var V=L[D],X=V.start,Z=V.end,se=X;se<=Z;se++)M.push(se);return M}}).init=function(){var j=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(j)},Si.prototype.getKerningValue=function(j,M,L){for(var D=0;D<j.length;D++)for(var V=j[D].subtables,X=0;X<V.length;X++){var Z=V[X],se=this.getCoverageIndex(Z.coverage,M);if(!(se<0))switch(Z.posFormat){case 1:for(var pe=Z.pairSets[se],he=0;he<pe.length;he++){var je=pe[he];if(je.secondGlyph===L)return je.value1&&je.value1.xAdvance||0}break;case 2:var Ce=this.getGlyphClass(Z.classDef1,M),Oe=this.getGlyphClass(Z.classDef2,L),Ce=Z.classRecords[Ce][Oe];return Ce.value1&&Ce.value1.xAdvance||0}}return 0},Si.prototype.getKerningTables=function(j,M){if(this.font.tables.gpos)return this.getLookupTables(j,M,"kern",2)},(En.prototype=dl.prototype).createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},En.prototype.getSingle=function(j,M,L){for(var D=[],V=this.getLookupTables(M,L,j,1),X=0;X<V.length;X++)for(var Z=V[X].subtables,se=0;se<Z.length;se++){var pe=Z[se],he=this.expandCoverage(pe.coverage),je=void 0;if(pe.substFormat===1)for(var Oe=pe.deltaGlyphId,je=0;je<he.length;je++){var Ce=he[je];D.push({sub:Ce,by:Ce+Oe})}else{var ve=pe.substitute;for(je=0;je<he.length;je++)D.push({sub:he[je],by:ve[je]})}}return D},En.prototype.getAlternates=function(j,M,L){for(var D=[],V=this.getLookupTables(M,L,j,3),X=0;X<V.length;X++)for(var Z=V[X].subtables,se=0;se<Z.length;se++)for(var pe=Z[se],he=this.expandCoverage(pe.coverage),je=pe.alternateSets,Oe=0;Oe<he.length;Oe++)D.push({sub:he[Oe],by:je[Oe]});return D},En.prototype.getLigatures=function(j,M,L){for(var D=[],V=this.getLookupTables(M,L,j,4),X=0;X<V.length;X++)for(var Z=V[X].subtables,se=0;se<Z.length;se++)for(var pe=Z[se],he=this.expandCoverage(pe.coverage),je=pe.ligatureSets,Oe=0;Oe<he.length;Oe++)for(var Ce=he[Oe],ve=je[Oe],He=0;He<ve.length;He++){var Ne=ve[He];D.push({sub:[Ce].concat(Ne.components),by:Ne.ligGlyph})}return D},En.prototype.addSingle=function(j,M,L,D){L=dp(this.getLookupTables(L,D,j,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]}),B.assert(L.coverage.format===1,"Ligature: unable to modify coverage table format "+L.coverage.format),D=M.sub,j=this.binSearch(L.coverage.glyphs,D),j<0&&(L.coverage.glyphs.splice(j=-1-j,0,D),L.substitute.splice(j,0,0)),L.substitute[j]=M.by},En.prototype.addAlternate=function(j,M,L,D){L=dp(this.getLookupTables(L,D,j,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]}),B.assert(L.coverage.format===1,"Ligature: unable to modify coverage table format "+L.coverage.format),D=M.sub,j=this.binSearch(L.coverage.glyphs,D),j<0&&(L.coverage.glyphs.splice(j=-1-j,0,D),L.alternateSets.splice(j,0,0)),L.alternateSets[j]=M.by},En.prototype.addLigature=function(X,pe,se,V){var se=this.getLookupTables(se,V,X,4,!0)[0],V=se.subtables[0],X=(V||(se.subtables[0]=V={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),B.assert(V.coverage.format===1,"Ligature: unable to modify coverage table format "+V.coverage.format),pe.sub[0]),Z=pe.sub.slice(1),se={ligGlyph:pe.by,components:Z},pe=this.binSearch(V.coverage.glyphs,X);if(0<=pe){for(var he=V.ligatureSets[pe],je=0;je<he.length;je++)if(function(Oe,Ce){var ve=Oe.length;if(ve===Ce.length){for(var He=0;He<ve;He++)if(Oe[He]!==Ce[He])return;return 1}}(he[je].components,Z))return;he.push(se)}else V.coverage.glyphs.splice(pe=-1-pe,0,X),V.ligatureSets.splice(pe,0,[se])},En.prototype.getFeature=function(j,M,L){if(/ss\d\d/.test(j))return this.getSingle(j,M,L);switch(j){case"aalt":case"salt":return this.getSingle(j,M,L).concat(this.getAlternates(j,M,L));case"dlig":case"liga":case"rlig":return this.getLigatures(j,M,L)}},En.prototype.add=function(j,M,L,D){if(/ss\d\d/.test(j))return this.addSingle(j,M,L,D);switch(j){case"aalt":case"salt":return typeof M.by=="number"?this.addSingle(j,M,L,D):this.addAlternate(j,M,L,D);case"dlig":case"liga":case"rlig":return this.addLigature(j,M,L,D)}};var qs={getPath:fp,parse:function(j,M,L,D){for(var V=new dt.GlyphSet(D),X=0;X<L.length-1;X+=1){var Z=L[X];Z!==L[X+1]?V.push(X,dt.ttfGlyphLoader(D,X,By,j,M+Z,zy)):V.push(X,dt.glyphLoader(D,X))}return V}};function Wu(j){this.font=j,this.getCommands=function(M){return qs.getPath(M).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Gy(j){return j}function hl(j){return Math.sign(j)*Math.round(Math.abs(j))}function Vy(j){return Math.sign(j)*Math.round(Math.abs(2*j))/2}function $u(j){return Math.sign(j)*(Math.round(Math.abs(j)+.5)-.5)}function Hy(j){return Math.sign(j)*Math.ceil(Math.abs(j))}function mp(j){return Math.sign(j)*Math.floor(Math.abs(j))}function qu(j){var M=this.srPeriod,L=this.srPhase,D=1;return j<0&&(j=-j,D=-1),j+=this.srThreshold-L,j=Math.trunc(j/M)*M,(j+=L)<0?L*D:j*D}var Uo={x:1,y:0,axis:"x",distance:function(j,M,L,D){return(L?j.xo:j.x)-(D?M.xo:M.x)},interpolate:function(j,M,L,D){var V,X,Z,se,pe,he,je;if(!D||D===this)return V=j.xo-M.xo,X=j.xo-L.xo,pe=M.x-M.xo,he=L.x-L.xo,(je=(Z=Math.abs(V))+(se=Math.abs(X)))===0?void(j.x=j.xo+(pe+he)/2):void(j.x=j.xo+(pe*se+he*Z)/je);V=D.distance(j,M,!0,!0),X=D.distance(j,L,!0,!0),pe=D.distance(M,M,!1,!0),he=D.distance(L,L,!1,!0),(je=(Z=Math.abs(V))+(se=Math.abs(X)))===0?Uo.setRelative(j,j,(pe+he)/2,D,!0):Uo.setRelative(j,j,(pe*se+he*Z)/je,D,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(j,M,L,D,V){var X,Z;D&&D!==this?(X=V?M.xo:M.x,Z=V?M.yo:M.y,X+=L*D.x,Z+=L*D.y,j.x=X+(j.y-Z)/D.normalSlope):j.x=(V?M.xo:M.x)+L},slope:0,touch:function(j){j.xTouched=!0},touched:function(j){return j.xTouched},untouch:function(j){j.xTouched=!1}},so={x:0,y:1,axis:"y",distance:function(j,M,L,D){return(L?j.yo:j.y)-(D?M.yo:M.y)},interpolate:function(j,M,L,D){var V,X,Z,se,pe,he,je;if(!D||D===this)return V=j.yo-M.yo,X=j.yo-L.yo,pe=M.y-M.yo,he=L.y-L.yo,(je=(Z=Math.abs(V))+(se=Math.abs(X)))===0?void(j.y=j.yo+(pe+he)/2):void(j.y=j.yo+(pe*se+he*Z)/je);V=D.distance(j,M,!0,!0),X=D.distance(j,L,!0,!0),pe=D.distance(M,M,!1,!0),he=D.distance(L,L,!1,!0),(je=(Z=Math.abs(V))+(se=Math.abs(X)))===0?so.setRelative(j,j,(pe+he)/2,D,!0):so.setRelative(j,j,(pe*se+he*Z)/je,D,!0)},normalSlope:0,setRelative:function(j,M,L,D,V){var X,Z;D&&D!==this?(X=V?M.xo:M.x,Z=V?M.yo:M.y,X+=L*D.x,Z+=L*D.y,j.y=Z+D.normalSlope*(j.x-X)):j.y=(V?M.yo:M.y)+L},slope:Number.POSITIVE_INFINITY,touch:function(j){j.yTouched=!0},touched:function(j){return j.yTouched},untouch:function(j){j.yTouched=!1}};function ca(j,M){this.x=j,this.y=M,this.axis=void 0,this.slope=M/j,this.normalSlope=-j/M,Object.freeze(this)}function pl(j,M){var L=Math.sqrt(j*j+M*M);return M/=L,(j/=L)===1&&M===0?Uo:j===0&&M===1?so:new ca(j,M)}function js(j,M,L,D){this.x=this.xo=Math.round(64*j)/64,this.y=this.yo=Math.round(64*M)/64,this.lastPointOfContour=L,this.onCurve=D,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Uo),Object.freeze(so),ca.prototype.distance=function(j,M,L,D){return this.x*Uo.distance(j,M,L,D)+this.y*so.distance(j,M,L,D)},ca.prototype.interpolate=function(j,V,X,D){var Z=D.distance(j,V,!0,!0),se=D.distance(j,X,!0,!0),V=D.distance(V,V,!1,!0),X=D.distance(X,X,!1,!0),Z=Math.abs(Z),se=Math.abs(se),pe=Z+se;pe===0?this.setRelative(j,j,(V+X)/2,D,!0):this.setRelative(j,j,(V*se+X*Z)/pe,D,!0)},ca.prototype.setRelative=function(j,X,pe,he,se){var Z=se?X.xo:X.x,se=se?X.yo:X.y,X=Z+pe*(he=he||this).x,Z=se+pe*he.y,se=he.normalSlope,pe=this.slope,he=j.x,je=j.y;j.x=(pe*he-se*X+Z-je)/(pe-se),j.y=pe*(j.x-he)+je},ca.prototype.touch=function(j){j.xTouched=!0,j.yTouched=!0},js.prototype.nextTouched=function(j){for(var M=this.nextPointOnContour;!j.touched(M)&&M!==this;)M=M.nextPointOnContour;return M},js.prototype.prevTouched=function(j){for(var M=this.prevPointOnContour;!j.touched(M)&&M!==this;)M=M.prevPointOnContour;return M};var fl=Object.freeze(new js(0,0)),ye={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Te(j,M){switch(this.env=j,this.stack=[],this.prog=M,j){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Uo,this.round=hl}}function qe(j){for(var M=j.tZone=new Array(j.gZone.length),L=0;L<M.length;L++)M[L]=new js(0,0)}function ht(j,M){var L,D=j.prog,V=j.ip,X=1;do if((L=D[++V])===88)X++;else if(L===89)X--;else if(L===64)V+=D[V+1]+1;else if(L===65)V+=2*D[V+1]+1;else if(176<=L&&L<=183)V+=L-176+1;else if(184<=L&&L<=191)V+=2*(L-184+1);else if(M&&X===1&&L===27)break;while(0<X);j.ip=V}function cr(j,M){u.DEBUG&&console.log(M.step,"SVTCA["+j.axis+"]"),M.fv=M.pv=M.dpv=j}function Rt(j,M){u.DEBUG&&console.log(M.step,"SPVTCA["+j.axis+"]"),M.pv=M.dpv=j}function Er(j,M){u.DEBUG&&console.log(M.step,"SFVTCA["+j.axis+"]"),M.fv=j}function Zr(j,M){var L,V=M.stack,D=V.pop(),V=V.pop(),X=M.z2[D],Z=M.z1[V];u.DEBUG&&console.log("SPVTL["+j+"]",D,V),D=j?(L=X.y-Z.y,Z.x-X.x):(L=Z.x-X.x,Z.y-X.y),M.pv=M.dpv=pl(L,D)}function sn(j,M){var L,V=M.stack,D=V.pop(),V=V.pop(),X=M.z2[D],Z=M.z1[V];u.DEBUG&&console.log("SFVTL["+j+"]",D,V),D=j?(L=X.y-Z.y,Z.x-X.x):(L=Z.x-X.x,Z.y-X.y),M.fv=pl(L,D)}function mr(j){u.DEBUG&&console.log(j.step,"POP[]"),j.stack.pop()}function Fn(j,M){var L=M.stack.pop(),D=M.z0[L],V=M.fv,X=M.pv,Z=(u.DEBUG&&console.log(M.step,"MDAP["+j+"]",L),X.distance(D,fl));j&&(Z=M.round(Z)),V.setRelative(D,fl,Z,X),V.touch(D),M.rp0=M.rp1=L}function So(j,M){var L,D,V,X=M.z2,Z=X.length-2;u.DEBUG&&console.log(M.step,"IUP["+j.axis+"]");for(var se=0;se<Z;se++)L=X[se],j.touched(L)||(D=L.prevTouched(j))!==L&&(D===(V=L.nextTouched(j))&&j.setRelative(L,L,j.distance(D,D,!1,!0),j,!0),j.interpolate(L,D,V,j))}function gn(j,M){for(var L=M.stack,D=j?M.rp1:M.rp2,V=(j?M.z0:M.z1)[D],X=M.fv,Z=M.pv,se=M.loop,pe=M.z2;se--;){var he=L.pop(),je=pe[he],Oe=Z.distance(V,V,!1,!0);X.setRelative(je,je,Oe,Z),X.touch(je),u.DEBUG&&console.log(M.step,(1<M.loop?"loop "+(M.loop-se)+": ":"")+"SHP["+(j?"rp1":"rp2")+"]",he)}M.loop=1}function io(j,M){for(var L=M.stack,Z=j?M.rp1:M.rp2,D=(j?M.z0:M.z1)[Z],V=M.fv,X=M.pv,Z=L.pop(),se=M.z2[M.contours[Z]],pe=se,he=(u.DEBUG&&console.log(M.step,"SHC["+j+"]",Z),X.distance(D,D,!1,!0));pe!==D&&V.setRelative(pe,pe,he,X),(pe=pe.nextPointOnContour)!==se;);}function ao(j,M){var L,D,se=M.stack,V=j?M.rp1:M.rp2,V=(j?M.z0:M.z1)[V],X=M.fv,Z=M.pv,se=se.pop();switch(u.DEBUG&&console.log(M.step,"SHZ["+j+"]",se),se){case 0:L=M.tZone;break;case 1:L=M.gZone;break;default:throw new Error("Invalid zone")}for(var pe=Z.distance(V,V,!1,!0),he=L.length-2,je=0;je<he;je++)D=L[je],X.setRelative(D,D,pe,Z)}function _s(j,M){var D=M.stack,L=D.pop()/64,D=D.pop(),V=M.z1[D],X=M.z0[M.rp0],Z=M.fv,se=M.pv;Z.setRelative(V,X,L,se),Z.touch(V),u.DEBUG&&console.log(M.step,"MSIRP["+j+"]",L,D),M.rp1=M.rp0,M.rp2=D,j&&(M.rp0=D)}function as(j,M){var L=M.stack,se=L.pop(),L=L.pop(),D=M.z0[L],V=M.fv,X=M.pv,Z=M.cvt[se],se=(u.DEBUG&&console.log(M.step,"MIAP["+j+"]",se,"(",Z,")",L),X.distance(D,fl));j&&(Math.abs(se-Z)<M.cvCutIn&&(se=Z),se=M.round(se)),V.setRelative(D,fl,se,X),M.zp0===0&&(D.xo=D.x,D.yo=D.y),V.touch(D),M.rp0=M.rp1=L}function Ys(j,M){var L=M.stack,D=L.pop(),V=M.z2[D];u.DEBUG&&console.log(M.step,"GC["+j+"]",D),L.push(64*M.dpv.distance(V,fl,j,!1))}function Yu(j,M){var D=M.stack,L=D.pop(),D=D.pop(),V=M.z1[L],X=M.z0[D],X=M.dpv.distance(X,V,j,j);u.DEBUG&&console.log(M.step,"MD["+j+"]",L,D,"->",X),M.stack.push(Math.round(64*X))}function ua(j,M){var L=M.stack,D=L.pop(),V=M.fv,X=M.pv,Z=M.ppem,se=M.deltaBase+16*(j-1),pe=M.deltaShift,he=M.z0;u.DEBUG&&console.log(M.step,"DELTAP["+j+"]",D,L);for(var je=0;je<D;je++){var Oe=L.pop(),Ce=L.pop();se+((240&Ce)>>4)===Z&&(0<=(Ce=(15&Ce)-8)&&Ce++,u.DEBUG&&console.log(M.step,"DELTAPFIX",Oe,"by",Ce*pe),Oe=he[Oe],V.setRelative(Oe,Oe,Ce*pe,X))}}function ji(j,M){var L=M.stack,D=L.pop();u.DEBUG&&console.log(M.step,"ROUND[]"),L.push(64*M.round(D/64))}function Wy(j,M){var L=M.stack,D=L.pop(),V=M.ppem,X=M.deltaBase+16*(j-1),Z=M.deltaShift;u.DEBUG&&console.log(M.step,"DELTAC["+j+"]",D,L);for(var se=0;se<D;se++){var pe=L.pop(),he=L.pop();X+((240&he)>>4)===V&&(0<=(he=(15&he)-8)&&he++,he=he*Z,u.DEBUG&&console.log(M.step,"DELTACFIX",pe,"by",he),M.cvt[pe]+=he)}}function OS(j,M){var L,V=M.stack,D=V.pop(),V=V.pop(),X=M.z2[D],Z=M.z1[V];u.DEBUG&&console.log(M.step,"SDPVTL["+j+"]",D,V),D=j?(L=X.y-Z.y,Z.x-X.x):(L=Z.x-X.x,Z.y-X.y),M.dpv=pl(L,D)}function da(j,M){var L=M.stack,D=M.prog,V=M.ip;u.DEBUG&&console.log(M.step,"PUSHB["+j+"]");for(var X=0;X<j;X++)L.push(D[++V]);M.ip=V}function ha(j,M){var L=M.ip,D=M.prog,V=M.stack;u.DEBUG&&console.log(M.ip,"PUSHW["+j+"]");for(var X=0;X<j;X++){var Z=D[++L]<<8|D[++L];32768&Z&&(Z=-(1+(65535^Z))),V.push(Z)}M.ip=L}function yt(j,M,L,D,V,X){var Z,se,he=X.stack,pe=j&&he.pop(),he=he.pop(),je=X.rp0,je=X.z0[je],Oe=X.z1[he],Ce=X.minDis,ve=X.fv,He=X.dpv,Ne=Z=He.distance(Oe,je,!0,!0),ze=0<=Ne?1:-1;Ne=Math.abs(Ne),j&&(se=X.cvt[pe],D&&Math.abs(Ne-se)<X.cvCutIn&&(Ne=se)),L&&Ne<Ce&&(Ne=Ce),D&&(Ne=X.round(Ne)),ve.setRelative(Oe,je,ze*Ne,He),ve.touch(Oe),u.DEBUG&&console.log(X.step,(j?"MIRP[":"MDRP[")+(M?"M":"m")+(L?">":"_")+(D?"R":"_")+(V===0?"Gr":V===1?"Bl":V===2?"Wh":"")+"]",j?pe+"("+X.cvt[pe]+","+se+")":"",he,"(d =",Z,"->",ze*Ne,")"),X.rp1=X.rp0,X.rp2=he,M&&(X.rp0=he)}Wu.prototype.exec=function(j,M){if(typeof M!="number")throw new Error("Point size is not a number!");if(!(2<this._errorState)){var L=this.font,D=this._prepState;if(!D||D.ppem!==M){var V=this._fpgmState;if(!V){Te.prototype=ye,(V=this._fpgmState=new Te("fpgm",L.tables.fpgm)).funcs=[],V.font=L,u.DEBUG&&(console.log("---EXEC FPGM---"),V.step=-1);try{lc(V)}catch(he){return console.log("Hinting error in FPGM:"+he),void(this._errorState=3)}}Te.prototype=V,(D=this._prepState=new Te("prep",L.tables.prep)).ppem=M;var X=L.tables.cvt;if(X)for(var Z=D.cvt=new Array(X.length),se=M/L.unitsPerEm,pe=0;pe<X.length;pe++)Z[pe]=X[pe]*se;else D.cvt=[];u.DEBUG&&(console.log("---EXEC PREP---"),D.step=-1);try{lc(D)}catch(he){this._errorState<2&&console.log("Hinting error in PREP:"+he),this._errorState=2}}if(!(1<this._errorState))try{return NO(j,D)}catch(he){this._errorState<1&&(console.log("Hinting error:"+he),console.log("Note: further hinting errors are silenced")),this._errorState=1}}};var NO=function(j,M){var L=M.ppem/M.font.unitsPerEm,D=L,V=j.components;if(Te.prototype=M,V){for(var X=M.font,Z=[],se=[],pe=0;pe<V.length;pe++){var he=V[pe],je=X.glyphs.get(he.glyphIndex),Oe=new Te("glyf",je.instructions);u.DEBUG&&(console.log("---EXEC COMP "+pe+"---"),Oe.step=-1),LS(je,Oe,L,D);for(var Ce=Math.round(he.dx*L),ve=Math.round(he.dy*D),He=Oe.gZone,Ne=Oe.contours,ze=0;ze<He.length;ze++){var Re=He[ze];Re.xTouched=Re.yTouched=!1,Re.xo=Re.x=Re.x+Ce,Re.yo=Re.y=Re.y+ve}var De=Z.length;Z.push.apply(Z,He);for(var wt=0;wt<Ne.length;wt++)se.push(Ne[wt]+De)}j.instructions&&!Oe.inhibitGridFit&&((Oe=new Te("glyf",j.instructions)).gZone=Oe.z0=Oe.z1=Oe.z2=Z,Oe.contours=se,Z.push(new js(0,0),new js(Math.round(j.advanceWidth*L),0)),u.DEBUG&&(console.log("---EXEC COMPOSITE---"),Oe.step=-1),lc(Oe),Z.length-=2)}else Oe=new Te("glyf",j.instructions),u.DEBUG&&(console.log("---EXEC GLYPH---"),Oe.step=-1),LS(j,Oe,L,D),Z=Oe.gZone;return Z},LS=function(j,M,L,D){for(var V,X,Z,se=j.points||[],pe=se.length,he=M.gZone=M.z0=M.z1=M.z2=[],je=M.contours=[],Oe=0;Oe<pe;Oe++)V=se[Oe],he[Oe]=new js(V.x*L,V.y*D,V.lastPointOfContour,V.onCurve);for(var Ce=0;Ce<pe;Ce++)V=he[Ce],X||(X=V,je.push(Ce)),V.lastPointOfContour?((V.nextPointOnContour=X).prevPointOnContour=V,X=void 0):(Z=he[Ce+1],(V.nextPointOnContour=Z).prevPointOnContour=V);if(!M.inhibitGridFit){if(u.DEBUG){console.log("PROCESSING GLYPH",M.stack);for(var ve=0;ve<pe;ve++)console.log(ve,he[ve].x,he[ve].y)}if(he.push(new js(0,0),new js(Math.round(j.advanceWidth*L),0)),lc(M),he.length-=2,u.DEBUG){console.log("FINISHED GLYPH",M.stack);for(var He=0;He<pe;He++)console.log(He,he[He].x,he[He].y)}}},lc=function(j){var M=j.prog;if(M){var L,D=M.length;for(j.ip=0;j.ip<D;j.ip++){if(u.DEBUG&&j.step++,!(L=UO[M[j.ip]]))throw new Error("unknown instruction: 0x"+Number(M[j.ip]).toString(16));L(j)}}},UO=[cr.bind(void 0,so),cr.bind(void 0,Uo),Rt.bind(void 0,so),Rt.bind(void 0,Uo),Er.bind(void 0,so),Er.bind(void 0,Uo),Zr.bind(void 0,0),Zr.bind(void 0,1),sn.bind(void 0,0),sn.bind(void 0,1),function(j){var M=(L=j.stack).pop(),L=L.pop();u.DEBUG&&console.log(j.step,"SPVFS[]",M,L),j.pv=j.dpv=pl(L,M)},function(j){var M=(L=j.stack).pop(),L=L.pop();u.DEBUG&&console.log(j.step,"SPVFS[]",M,L),j.fv=pl(L,M)},function(j){var M=j.stack,L=j.pv;u.DEBUG&&console.log(j.step,"GPV[]"),M.push(16384*L.x),M.push(16384*L.y)},function(j){var M=j.stack,L=j.fv;u.DEBUG&&console.log(j.step,"GFV[]"),M.push(16384*L.x),M.push(16384*L.y)},function(j){j.fv=j.pv,u.DEBUG&&console.log(j.step,"SFVTPV[]")},function(M){var L=(Z=M.stack).pop(),D=Z.pop(),V=Z.pop(),X=Z.pop(),Z=Z.pop(),pe=M.z0,je=M.z1,se=pe[L],pe=pe[D],he=je[V],je=je[X],M=M.z2[Z],L=(u.DEBUG&&console.log("ISECT[], ",L,D,V,X,Z),se.x),D=se.y,V=pe.x,X=pe.y,Z=he.x,se=he.y,pe=je.x,he=je.y,je=(L-V)*(se-he)-(D-X)*(Z-pe),Oe=L*X-D*V,Ce=Z*he-se*pe;M.x=(Oe*(Z-pe)-Ce*(L-V))/je,M.y=(Oe*(se-he)-Ce*(D-X))/je},function(j){j.rp0=j.stack.pop(),u.DEBUG&&console.log(j.step,"SRP0[]",j.rp0)},function(j){j.rp1=j.stack.pop(),u.DEBUG&&console.log(j.step,"SRP1[]",j.rp1)},function(j){j.rp2=j.stack.pop(),u.DEBUG&&console.log(j.step,"SRP2[]",j.rp2)},function(j){var M=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"SZP0[]",M),j.zp0=M){case 0:j.tZone||qe(j),j.z0=j.tZone;break;case 1:j.z0=j.gZone;break;default:throw new Error("Invalid zone pointer")}},function(j){var M=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"SZP1[]",M),j.zp1=M){case 0:j.tZone||qe(j),j.z1=j.tZone;break;case 1:j.z1=j.gZone;break;default:throw new Error("Invalid zone pointer")}},function(j){var M=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"SZP2[]",M),j.zp2=M){case 0:j.tZone||qe(j),j.z2=j.tZone;break;case 1:j.z2=j.gZone;break;default:throw new Error("Invalid zone pointer")}},function(j){var M=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"SZPS[]",M),j.zp0=j.zp1=j.zp2=M){case 0:j.tZone||qe(j),j.z0=j.z1=j.z2=j.tZone;break;case 1:j.z0=j.z1=j.z2=j.gZone;break;default:throw new Error("Invalid zone pointer")}},function(j){j.loop=j.stack.pop(),u.DEBUG&&console.log(j.step,"SLOOP[]",j.loop)},function(j){u.DEBUG&&console.log(j.step,"RTG[]"),j.round=hl},function(j){u.DEBUG&&console.log(j.step,"RTHG[]"),j.round=$u},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SMD[]",M),j.minDis=M/64},function(j){u.DEBUG&&console.log(j.step,"ELSE[]"),ht(j,!1)},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"JMPR[]",M),j.ip+=M-1},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SCVTCI[]",M),j.cvCutIn=M/64},void 0,void 0,function(j){var M=j.stack;u.DEBUG&&console.log(j.step,"DUP[]"),M.push(M[M.length-1])},mr,function(j){u.DEBUG&&console.log(j.step,"CLEAR[]"),j.stack.length=0},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"SWAP[]"),M.push(L),M.push(D)},function(j){var M=j.stack;u.DEBUG&&console.log(j.step,"DEPTH[]"),M.push(M.length)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"CINDEX[]",L),M.push(M[M.length-L])},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"MINDEX[]",L),M.push(M.splice(M.length-L,1)[0])},void 0,void 0,void 0,function(j){var M=(D=j.stack).pop(),L=D.pop(),D=(u.DEBUG&&console.log(j.step,"LOOPCALL[]",M,L),j.ip),V=j.prog;j.prog=j.funcs[M];for(var X=0;X<L;X++)lc(j),u.DEBUG&&console.log(++j.step,X+1<L?"next loopcall":"done loopcall",X);j.ip=D,j.prog=V},function(j){var M=j.stack.pop(),L=(u.DEBUG&&console.log(j.step,"CALL[]",M),j.ip),D=j.prog;j.prog=j.funcs[M],lc(j),j.ip=L,j.prog=D,u.DEBUG&&console.log(++j.step,"returning from",M)},function(j){if(j.env!=="fpgm")throw new Error("FDEF not allowed here");var D=j.stack,M=j.prog,L=j.ip,D=D.pop(),V=L;for(u.DEBUG&&console.log(j.step,"FDEF[]",D);M[++L]!==45;);j.ip=L,j.funcs[D]=M.slice(V+1,L)},void 0,Fn.bind(void 0,0),Fn.bind(void 0,1),So.bind(void 0,so),So.bind(void 0,Uo),gn.bind(void 0,0),gn.bind(void 0,1),io.bind(void 0,0),io.bind(void 0,1),ao.bind(void 0,0),ao.bind(void 0,1),function(j){for(var M=j.stack,L=j.loop,D=j.fv,V=M.pop()/64,X=j.z2;L--;){var Z=M.pop(),se=X[Z];u.DEBUG&&console.log(j.step,(1<j.loop?"loop "+(j.loop-L)+": ":"")+"SHPIX[]",Z,V),D.setRelative(se,se,V),D.touch(se)}j.loop=1},function(j){for(var M=j.stack,L=j.rp1,D=j.rp2,V=j.loop,X=j.z0[L],Z=j.z1[D],se=j.fv,pe=j.dpv,he=j.z2;V--;){var je=M.pop(),Oe=he[je];u.DEBUG&&console.log(j.step,(1<j.loop?"loop "+(j.loop-V)+": ":"")+"IP[]",je,L,"<->",D),se.interpolate(Oe,X,Z,pe),se.touch(Oe)}j.loop=1},_s.bind(void 0,0),_s.bind(void 0,1),function(j){for(var M=j.stack,L=j.rp0,D=j.z0[L],V=j.loop,X=j.fv,Z=j.pv,se=j.z1;V--;){var pe=M.pop(),he=se[pe];u.DEBUG&&console.log(j.step,(1<j.loop?"loop "+(j.loop-V)+": ":"")+"ALIGNRP[]",pe),X.setRelative(he,D,0,Z),X.touch(he)}j.loop=1},function(j){u.DEBUG&&console.log(j.step,"RTDG[]"),j.round=Vy},as.bind(void 0,0),as.bind(void 0,1),function(j){var M=j.prog,L=j.ip,D=j.stack,V=M[++L];u.DEBUG&&console.log(j.step,"NPUSHB[]",V);for(var X=0;X<V;X++)D.push(M[++L]);j.ip=L},function(j){var M=j.ip,L=j.prog,D=j.stack,V=L[++M];u.DEBUG&&console.log(j.step,"NPUSHW[]",V);for(var X=0;X<V;X++){var Z=L[++M]<<8|L[++M];32768&Z&&(Z=-(1+(65535^Z))),D.push(Z)}j.ip=M},function(j){var D=j.stack,M=(M=j.store)||(j.store=[]),L=D.pop(),D=D.pop();u.DEBUG&&console.log(j.step,"WS",L,D),M[D]=L},function(V){var M=V.stack,L=V.store,D=M.pop(),V=(u.DEBUG&&console.log(V.step,"RS",D),L&&L[D]||0);M.push(V)},function(j){var M=(L=j.stack).pop(),L=L.pop();u.DEBUG&&console.log(j.step,"WCVTP",M,L),j.cvt[L]=M/64},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"RCVT",L),M.push(64*j.cvt[L])},Ys.bind(void 0,0),Ys.bind(void 0,1),void 0,Yu.bind(void 0,0),Yu.bind(void 0,1),function(j){u.DEBUG&&console.log(j.step,"MPPEM[]"),j.stack.push(j.ppem)},void 0,function(j){u.DEBUG&&console.log(j.step,"FLIPON[]"),j.autoFlip=!0},void 0,void 0,function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"LT[]",L,D),M.push(D<L?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"LTEQ[]",L,D),M.push(D<=L?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"GT[]",L,D),M.push(L<D?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"GTEQ[]",L,D),M.push(L<=D?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"EQ[]",L,D),M.push(L===D?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"NEQ[]",L,D),M.push(L!==D?1:0)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"ODD[]",L),M.push(Math.trunc(L)%2?1:0)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"EVEN[]",L),M.push(Math.trunc(L)%2?0:1)},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"IF[]",M),M||(ht(j,!0),u.DEBUG&&console.log(j.step,"EIF[]"))},function(j){u.DEBUG&&console.log(j.step,"EIF[]")},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"AND[]",L,D),M.push(L&&D?1:0)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"OR[]",L,D),M.push(L||D?1:0)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"NOT[]",L),M.push(L?0:1)},ua.bind(void 0,1),function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SDB[]",M),j.deltaBase=M},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SDS[]",M),j.deltaShift=Math.pow(.5,M)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"ADD[]",L,D),M.push(D+L)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"SUB[]",L,D),M.push(D-L)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"DIV[]",L,D),M.push(64*D/L)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"MUL[]",L,D),M.push(D*L/64)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"ABS[]",L),M.push(Math.abs(L))},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"NEG[]",L),M.push(-L)},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"FLOOR[]",L),M.push(64*Math.floor(L/64))},function(j){var M=j.stack,L=M.pop();u.DEBUG&&console.log(j.step,"CEILING[]",L),M.push(64*Math.ceil(L/64))},ji.bind(void 0,0),ji.bind(void 0,1),ji.bind(void 0,2),ji.bind(void 0,3),void 0,void 0,void 0,void 0,function(j){var M=(L=j.stack).pop(),L=L.pop();u.DEBUG&&console.log(j.step,"WCVTF[]",M,L),j.cvt[L]=M*j.ppem/j.font.unitsPerEm},ua.bind(void 0,2),ua.bind(void 0,3),Wy.bind(void 0,1),Wy.bind(void 0,2),Wy.bind(void 0,3),function(j){var M,L=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"SROUND[]",L),j.round=qu,192&L){case 0:M=.5;break;case 64:M=1;break;case 128:M=2;break;default:throw new Error("invalid SROUND value")}switch(j.srPeriod=M,48&L){case 0:j.srPhase=0;break;case 16:j.srPhase=.25*M;break;case 32:j.srPhase=.5*M;break;case 48:j.srPhase=.75*M;break;default:throw new Error("invalid SROUND value")}j.srThreshold=(L&=15)===0?0:(L/8-.5)*M},function(j){var M,L=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"S45ROUND[]",L),j.round=qu,192&L){case 0:M=Math.sqrt(2)/2;break;case 64:M=Math.sqrt(2);break;case 128:M=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(j.srPeriod=M,48&L){case 0:j.srPhase=0;break;case 16:j.srPhase=.25*M;break;case 32:j.srPhase=.5*M;break;case 48:j.srPhase=.75*M;break;default:throw new Error("invalid S45ROUND value")}j.srThreshold=(L&=15)===0?0:(L/8-.5)*M},void 0,void 0,function(j){u.DEBUG&&console.log(j.step,"ROFF[]"),j.round=Gy},void 0,function(j){u.DEBUG&&console.log(j.step,"RUTG[]"),j.round=Hy},function(j){u.DEBUG&&console.log(j.step,"RDTG[]"),j.round=mp},mr,mr,void 0,void 0,void 0,void 0,void 0,function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SCANCTRL[]",M)},OS.bind(void 0,0),OS.bind(void 0,1),function(j){var M=j.stack,L=M.pop(),D=0;u.DEBUG&&console.log(j.step,"GETINFO[]",L),1&L&&(D=35),32&L&&(D|=4096),M.push(D)},void 0,function(j){var M=j.stack,L=M.pop(),D=M.pop(),V=M.pop();u.DEBUG&&console.log(j.step,"ROLL[]"),M.push(D),M.push(L),M.push(V)},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"MAX[]",L,D),M.push(Math.max(D,L))},function(j){var M=j.stack,L=M.pop(),D=M.pop();u.DEBUG&&console.log(j.step,"MIN[]",L,D),M.push(Math.min(D,L))},function(j){var M=j.stack.pop();u.DEBUG&&console.log(j.step,"SCANTYPE[]",M)},function(j){var M=j.stack.pop(),L=j.stack.pop();switch(u.DEBUG&&console.log(j.step,"INSTCTRL[]",M,L),M){case 1:return void(j.inhibitGridFit=!!L);case 2:return void(j.ignoreCvt=!!L);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,da.bind(void 0,1),da.bind(void 0,2),da.bind(void 0,3),da.bind(void 0,4),da.bind(void 0,5),da.bind(void 0,6),da.bind(void 0,7),da.bind(void 0,8),ha.bind(void 0,1),ha.bind(void 0,2),ha.bind(void 0,3),ha.bind(void 0,4),ha.bind(void 0,5),ha.bind(void 0,6),ha.bind(void 0,7),ha.bind(void 0,8),yt.bind(void 0,0,0,0,0,0),yt.bind(void 0,0,0,0,0,1),yt.bind(void 0,0,0,0,0,2),yt.bind(void 0,0,0,0,0,3),yt.bind(void 0,0,0,0,1,0),yt.bind(void 0,0,0,0,1,1),yt.bind(void 0,0,0,0,1,2),yt.bind(void 0,0,0,0,1,3),yt.bind(void 0,0,0,1,0,0),yt.bind(void 0,0,0,1,0,1),yt.bind(void 0,0,0,1,0,2),yt.bind(void 0,0,0,1,0,3),yt.bind(void 0,0,0,1,1,0),yt.bind(void 0,0,0,1,1,1),yt.bind(void 0,0,0,1,1,2),yt.bind(void 0,0,0,1,1,3),yt.bind(void 0,0,1,0,0,0),yt.bind(void 0,0,1,0,0,1),yt.bind(void 0,0,1,0,0,2),yt.bind(void 0,0,1,0,0,3),yt.bind(void 0,0,1,0,1,0),yt.bind(void 0,0,1,0,1,1),yt.bind(void 0,0,1,0,1,2),yt.bind(void 0,0,1,0,1,3),yt.bind(void 0,0,1,1,0,0),yt.bind(void 0,0,1,1,0,1),yt.bind(void 0,0,1,1,0,2),yt.bind(void 0,0,1,1,0,3),yt.bind(void 0,0,1,1,1,0),yt.bind(void 0,0,1,1,1,1),yt.bind(void 0,0,1,1,1,2),yt.bind(void 0,0,1,1,1,3),yt.bind(void 0,1,0,0,0,0),yt.bind(void 0,1,0,0,0,1),yt.bind(void 0,1,0,0,0,2),yt.bind(void 0,1,0,0,0,3),yt.bind(void 0,1,0,0,1,0),yt.bind(void 0,1,0,0,1,1),yt.bind(void 0,1,0,0,1,2),yt.bind(void 0,1,0,0,1,3),yt.bind(void 0,1,0,1,0,0),yt.bind(void 0,1,0,1,0,1),yt.bind(void 0,1,0,1,0,2),yt.bind(void 0,1,0,1,0,3),yt.bind(void 0,1,0,1,1,0),yt.bind(void 0,1,0,1,1,1),yt.bind(void 0,1,0,1,1,2),yt.bind(void 0,1,0,1,1,3),yt.bind(void 0,1,1,0,0,0),yt.bind(void 0,1,1,0,0,1),yt.bind(void 0,1,1,0,0,2),yt.bind(void 0,1,1,0,0,3),yt.bind(void 0,1,1,0,1,0),yt.bind(void 0,1,1,0,1,1),yt.bind(void 0,1,1,0,1,2),yt.bind(void 0,1,1,0,1,3),yt.bind(void 0,1,1,1,0,0),yt.bind(void 0,1,1,1,0,1),yt.bind(void 0,1,1,1,0,2),yt.bind(void 0,1,1,1,0,3),yt.bind(void 0,1,1,1,1,0),yt.bind(void 0,1,1,1,1,1),yt.bind(void 0,1,1,1,1,2),yt.bind(void 0,1,1,1,1,3)],BO=Array.from||function(j){return j.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function gr(j){(j=j||{}).empty||(oo(j.familyName,"When creating a new Font object, familyName is required."),oo(j.styleName,"When creating a new Font object, styleName is required."),oo(j.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),oo(j.ascender,"When creating a new Font object, ascender is required."),oo(j.descender,"When creating a new Font object, descender is required."),oo(j.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:j.familyName||" "},fontSubfamily:{en:j.styleName||" "},fullName:{en:j.fullName||j.familyName+" "+j.styleName},postScriptName:{en:j.postScriptName||(j.familyName+j.styleName).replace(/\s/g,"")},designer:{en:j.designer||" "},designerURL:{en:j.designerURL||" "},manufacturer:{en:j.manufacturer||" "},manufacturerURL:{en:j.manufacturerURL||" "},license:{en:j.license||" "},licenseURL:{en:j.licenseURL||" "},version:{en:j.version||"Version 0.1"},description:{en:j.description||" "},copyright:{en:j.copyright||" "},trademark:{en:j.trademark||" "}},this.unitsPerEm=j.unitsPerEm||1e3,this.ascender=j.ascender,this.descender=j.descender,this.createdTimestamp=j.createdTimestamp,this.tables={os2:{usWeightClass:j.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:j.widthClass||this.usWidthClasses.MEDIUM,fsSelection:j.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new dt.GlyphSet(this,j.glyphs||[]),this.encoding=new Pe(this),this.position=new Si(this),this.substitution=new En(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting||(this.outlinesFormat==="truetype"?this._hinting=new Wu(this):void 0)}})}function RS(j,M){var L,D=JSON.stringify(j),V=256;for(L in M){var X=parseInt(L);if(X&&!(X<256)){if(JSON.stringify(M[L])===D)return X;V<=X&&(V=X+1)}}return M[V]=j,V}gr.prototype.hasChar=function(j){return this.encoding.charToGlyphIndex(j)!==null},gr.prototype.charToGlyphIndex=function(j){return this.encoding.charToGlyphIndex(j)},gr.prototype.charToGlyph=function(j){return j=this.charToGlyphIndex(j),this.glyphs.get(j)||this.glyphs.get(0)},gr.prototype.stringToGlyphs=function(j,M){M=M||this.defaultRenderOptions;for(var L=BO(j),D=[],V=0;V<L.length;V+=1){var X=L[V];D.push(this.charToGlyphIndex(X))}var Z=D.length;if(M.features){var j=M.script||this.substitution.getDefaultScriptName(),se=[];M.features.liga&&(se=se.concat(this.substitution.getFeature("liga",j,M.language))),M.features.rlig&&(se=se.concat(this.substitution.getFeature("rlig",j,M.language)));for(var pe=0;pe<Z;pe+=1)for(var he=0;he<se.length;he++){for(var je=se[he],Oe=je.sub,Ce=Oe.length,ve=0;ve<Ce&&Oe[ve]===D[pe+ve];)ve++;ve===Ce&&(D.splice(pe,Ce,je.by),Z=Z-Ce+1)}}for(var He=new Array(Z),Ne=this.glyphs.get(0),ze=0;ze<Z;ze+=1)He[ze]=this.glyphs.get(D[ze])||Ne;return He},gr.prototype.nameToGlyphIndex=function(j){return this.glyphNames.nameToGlyphIndex(j)},gr.prototype.nameToGlyph=function(j){return j=this.nameToGlyphIndex(j),this.glyphs.get(j)||this.glyphs.get(0)},gr.prototype.glyphIndexToName=function(j){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(j):""},gr.prototype.getKerningValue=function(j,M){j=j.index||j,M=M.index||M;var L=this.position.defaultKerningTables;return L?this.position.getKerningValue(L,j,M):this.kerningPairs[j+","+M]||0},gr.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},gr.prototype.forEachGlyph=function(j,M,L,D,V,X){M=M!==void 0?M:0,L=L!==void 0?L:0,V=V||this.defaultRenderOptions;var Z,se=1/this.unitsPerEm*(D=D!==void 0?D:72),pe=this.stringToGlyphs(j,V);V.kerning&&(j=V.script||this.position.getDefaultScriptName(),Z=this.position.getKerningTables(j,V.language));for(var he=0;he<pe.length;he+=1){var je=pe[he];X.call(this,je,M,L,D,V),je.advanceWidth&&(M+=je.advanceWidth*se),V.kerning&&he<pe.length-1&&(M+=(Z?this.position.getKerningValue(Z,je.index,pe[he+1].index):this.getKerningValue(je,pe[he+1]))*se),V.letterSpacing?M+=V.letterSpacing*D:V.tracking&&(M+=V.tracking/1e3*D)}return M},gr.prototype.getPath=function(j,M,L,D,V){var X=new J;return this.forEachGlyph(j,M,L,D,V,function(Z,se,pe,he){Z=Z.getPath(se,pe,he,V,this),X.extend(Z)}),X},gr.prototype.getPaths=function(j,M,L,D,V){var X=[];return this.forEachGlyph(j,M,L,D,V,function(Z,se,pe,he){Z=Z.getPath(se,pe,he,V,this),X.push(Z)}),X},gr.prototype.getAdvanceWidth=function(j,M,L){return this.forEachGlyph(j,0,0,M,L,function(){})},gr.prototype.draw=function(j,M,L,D,V,X){this.getPath(M,L,D,V,X).draw(j)},gr.prototype.drawPoints=function(j,M,L,D,V,X){this.forEachGlyph(M,L,D,V,X,function(Z,se,pe,he){Z.drawPoints(j,se,pe,he)})},gr.prototype.drawMetrics=function(j,M,L,D,V,X){this.forEachGlyph(M,L,D,V,X,function(Z,se,pe,he){Z.drawMetrics(j,se,pe,he)})},gr.prototype.getEnglishName=function(j){if(j=this.names[j],j)return j.en},gr.prototype.validate=function(){var j=this;function M(L){L=j.getEnglishName(L),L&&L.trim().length}M("fontFamily"),M("weightName"),M("manufacturer"),M("copyright"),M("version"),this.unitsPerEm},gr.prototype.toTables=function(){return Uy.fontToTable(this)},gr.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},gr.prototype.toArrayBuffer=function(){for(var j=this.toTables().encode(),M=new ArrayBuffer(j.length),L=new Uint8Array(M),D=0;D<j.length;D++)L[D]=j[D];return M},gr.prototype.download=function(j){var M=this.getEnglishName("fontFamily"),L=this.getEnglishName("fontSubfamily"),D=(j=j||M.replace(/\s/g,"")+"-"+L+".otf",this.toArrayBuffer());typeof window<"u"?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,D.byteLength,function(V){V.root.getFile(j,{create:!0},function(X){X.createWriter(function(Z){var se=new DataView(D),se=new Blob([se],{type:"font/opentype"});Z.write(se),Z.addEventListener("writeend",function(){location.href=X.toURL()},!1)})})},function(V){throw new Error(V.name+": "+V.message)})):(M=r("fs"),L=function(V){for(var X=new i(V.byteLength),Z=new Uint8Array(V),se=0;se<X.length;++se)X[se]=Z[se];return X}(D),M.writeFileSync(j,L))},gr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},gr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},gr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var zO={make:function(j,M){var L=new Fe.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:j.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:j.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*j.axes.length}]);L.offsetToData=L.sizeOf();for(var D,V,X,Z=0;Z<j.axes.length;Z++)L.fields=L.fields.concat((D=Z,V=j.axes[Z],X=M,X=RS(V.name,M),[{name:"tag_"+D,type:"TAG",value:V.tag},{name:"minValue_"+D,type:"FIXED",value:V.minValue<<16},{name:"defaultValue_"+D,type:"FIXED",value:V.defaultValue<<16},{name:"maxValue_"+D,type:"FIXED",value:V.maxValue<<16},{name:"flags_"+D,type:"USHORT",value:0},{name:"nameID_"+D,type:"USHORT",value:X}]));for(var se=0;se<j.instances.length;se++)L.fields=L.fields.concat(function(pe,he,je,Oe){for(var Ce=[{name:"nameID_"+pe,type:"USHORT",value:RS(he.name,Oe)},{name:"flags_"+pe,type:"USHORT",value:0}],ve=0;ve<je.length;++ve){var He=je[ve].tag;Ce.push({name:"axis_"+pe+" "+He,type:"FIXED",value:he.coordinates[He]<<16})}return Ce}(se,j.instances[se],j.axes,M));return L},parse:function(j,M,L){for(var D,V,X,Z,se=new Me.Parser(j,M),pe=se.parseULong(),he=(B.argument(pe===65536,"Unsupported fvar table version."),se.parseOffset16()),je=(se.skip("uShort",1),se.parseUShort()),Oe=se.parseUShort(),Ce=se.parseUShort(),ve=se.parseUShort(),He=[],Ne=0;Ne<je;Ne++)He.push((D=j,V=M+he+Ne*Oe,X=L,Z={},D=new Me.Parser(D,V),Z.tag=D.parseTag(),Z.minValue=D.parseFixed(),Z.defaultValue=D.parseFixed(),Z.maxValue=D.parseFixed(),D.skip("uShort",1),Z.name=X[D.parseUShort()]||{},Z));for(var ze=[],Re=M+he+je*Oe,De=0;De<Ce;De++)ze.push(function(wt,Ot,St,jt){var Ft={},br=new Me.Parser(wt,Ot);Ft.name=jt[br.parseUShort()]||{},br.skip("uShort",1),Ft.coordinates={};for(var qr=0;qr<St.length;++qr)Ft.coordinates[St[qr].tag]=br.parseFixed();return Ft}(j,Re+De*ve,He,L));return{axes:He,instances:ze}}},ks=new Array(10);ks[1]=function(){var j=this.offset+this.relativeOffset,M=this.parseUShort();return M===1?{posFormat:1,coverage:this.parsePointer(Ee.coverage),value:this.parseValueRecord()}:M===2?{posFormat:2,coverage:this.parsePointer(Ee.coverage),values:this.parseValueRecordList()}:void B.assert(!1,"0x"+j.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},ks[2]=function(){var j,M,L,D,X=this.offset+this.relativeOffset,V=this.parseUShort(),X=(B.assert(V===1||V===2,"0x"+X.toString(16)+": GPOS lookup type 2 format must be 1 or 2."),this.parsePointer(Ee.coverage)),Z=this.parseUShort(),se=this.parseUShort();return V===1?{posFormat:V,coverage:X,valueFormat1:Z,valueFormat2:se,pairSets:this.parseList(Ee.pointer(Ee.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(Z),value2:this.parseValueRecord(se)}})))}:V===2?(j=this.parsePointer(Ee.classDef),M=this.parsePointer(Ee.classDef),L=this.parseUShort(),D=this.parseUShort(),{posFormat:V,coverage:X,valueFormat1:Z,valueFormat2:se,classDef1:j,classDef2:M,class1Count:L,class2Count:D,classRecords:this.parseList(L,Ee.list(D,function(){return{value1:this.parseValueRecord(Z),value2:this.parseValueRecord(se)}}))}):void 0},ks[3]=function(){return{error:"GPOS Lookup 3 not supported"}},ks[4]=function(){return{error:"GPOS Lookup 4 not supported"}},ks[5]=function(){return{error:"GPOS Lookup 5 not supported"}},ks[6]=function(){return{error:"GPOS Lookup 6 not supported"}},ks[7]=function(){return{error:"GPOS Lookup 7 not supported"}},ks[8]=function(){return{error:"GPOS Lookup 8 not supported"}},ks[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var GO=new Array(10),VO={parse:function(j,M){return M=(j=new Ee(j,M=M||0)).parseVersion(1),B.argument(M===1||M===1.1,"Unsupported GPOS table version "+M),M===1?{version:M,scripts:j.parseScriptList(),features:j.parseFeatureList(),lookups:j.parseLookupList(ks)}:{version:M,scripts:j.parseScriptList(),features:j.parseFeatureList(),lookups:j.parseLookupList(ks),variations:j.parseFeatureVariationsList()}},make:function(j){return new Fe.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Fe.ScriptList(j.scripts)},{name:"features",type:"TABLE",value:new Fe.FeatureList(j.features)},{name:"lookups",type:"TABLE",value:new Fe.LookupList(j.lookups,GO)}])}},HO={parse:function(j,M){if(j=new Me.Parser(j,M),(M=j.parseUShort())===0){var L=j,D={},Oe=(L.skip("uShort"),L.parseUShort()),V=(B.argument(Oe===0,"Unsupported kern sub-table version."),L.skip("uShort",2),L.parseUShort());L.skip("uShort",3);for(var X=0;X<V;X+=1){var Z=L.parseUShort(),se=L.parseUShort(),pe=L.parseShort();D[Z+","+se]=pe}return D}if(M!==1)throw new Error("Unsupported kern table version ("+M+").");var he=j,je={},Oe=(he.skip("uShort"),1<he.parseULong()&&console.warn("Only the first kern subtable is supported."),he.skip("uLong"),255&he.parseUShort());if(he.skip("uShort"),Oe==0){var Ce=he.parseUShort();he.skip("uShort",3);for(var ve=0;ve<Ce;ve+=1){var He=he.parseUShort(),Ne=he.parseUShort(),ze=he.parseShort();je[He+","+Ne]=ze}}return je}},WO={parse:function(j,M,L,D){for(var V=new Me.Parser(j,M),X=D?V.parseUShort:V.parseULong,Z=[],se=0;se<L+1;se+=1){var pe=X.call(V);D&&(pe*=2),Z.push(pe)}return Z}};function $O(j,M){r("fs").readFile(j,function(L,D){if(L)return M(L.message);M(null,hp(D))})}function qO(j,M){var L=new XMLHttpRequest;L.open("get",j,!0),L.responseType="arraybuffer",L.onload=function(){return L.response?M(null,L.response):M("Font could not be loaded: "+L.statusText)},L.onerror=function(){M("Font could not be loaded")},L.send()}function DS(j,M){for(var L=[],D=12,V=0;V<M;V+=1){var X=Me.getTag(j,D),Z=Me.getULong(j,D+4),se=Me.getULong(j,D+8),pe=Me.getULong(j,D+12);L.push({tag:X,checksum:Z,offset:se,length:pe,compression:!1}),D+=16}return L}function an(L,M){if(M.compression!=="WOFF")return{data:L,offset:M.offset};var L=new Uint8Array(L.buffer,M.offset+2,M.compressedLength-2),D=new Uint8Array(M.length);if($(L,D),D.byteLength!==M.length)throw new Error("Decompression error: "+M.tag+" decompressed length doesn't match recorded length");return{data:new DataView(D.buffer,0),offset:0}}function $y(De){var M,L,D,V,X,Z,se,pe,he,je,Oe,Ce,ve,He,Ne=new gr({empty:!0}),ze=new DataView(De,0),Re=[],De=Me.getTag(ze,0);if(De===String.fromCharCode(0,1,0,0)||De==="true"||De==="typ1")Ne.outlinesFormat="truetype",Re=DS(ze,D=Me.getUShort(ze,4));else if(De==="OTTO")Ne.outlinesFormat="cff",Re=DS(ze,D=Me.getUShort(ze,4));else{if(De!=="wOFF")throw new Error("Unsupported OpenType signature "+De);var wt=Me.getTag(ze,4);if(wt===String.fromCharCode(0,1,0,0))Ne.outlinesFormat="truetype";else{if(wt!=="OTTO")throw new Error("Unsupported OpenType flavor "+De);Ne.outlinesFormat="cff"}Re=function(Cr,ir){for(var Bn=[],Nr=44,Cn=0;Cn<ir;Cn+=1){var Pr=Me.getTag(Cr,Nr),xn=Me.getULong(Cr,Nr+4),Ku=Me.getULong(Cr,Nr+8),cc=Me.getULong(Cr,Nr+12),FS=void 0,FS=Ku<cc&&"WOFF";Bn.push({tag:Pr,offset:xn,compression:FS,compressedLength:Ku,length:cc}),Nr+=20}return Bn}(ze,D=Me.getUShort(ze,12))}for(var Ot=0;Ot<D;Ot+=1){var St=Re[Ot],jt=void 0;switch(St.tag){case"cmap":jt=an(ze,St),Ne.tables.cmap=re.parse(jt.data,jt.offset),Ne.encoding=new Ue(Ne.tables.cmap);break;case"cvt ":jt=an(ze,St),He=new Me.Parser(jt.data,jt.offset),Ne.tables.cvt=He.parseShortList(St.length/2);break;case"fvar":X=St;break;case"fpgm":jt=an(ze,St),He=new Me.Parser(jt.data,jt.offset),Ne.tables.fpgm=He.parseByteList(St.length);break;case"head":jt=an(ze,St),Ne.tables.head=ro.parse(jt.data,jt.offset),Ne.unitsPerEm=Ne.tables.head.unitsPerEm,M=Ne.tables.head.indexToLocFormat;break;case"hhea":jt=an(ze,St),Ne.tables.hhea=be.parse(jt.data,jt.offset),Ne.ascender=Ne.tables.hhea.ascender,Ne.descender=Ne.tables.hhea.descender,Ne.numberOfHMetrics=Ne.tables.hhea.numberOfHMetrics;break;case"hmtx":he=St;break;case"ltag":jt=an(ze,St),L=ct.parse(jt.data,jt.offset);break;case"maxp":jt=an(ze,St),Ne.tables.maxp=Ke.parse(jt.data,jt.offset),Ne.numGlyphs=Ne.tables.maxp.numGlyphs;break;case"name":Ce=St;break;case"OS/2":jt=an(ze,St),Ne.tables.os2=on.parse(jt.data,jt.offset);break;case"post":jt=an(ze,St),Ne.tables.post=op.parse(jt.data,jt.offset),Ne.glyphNames=new Ze(Ne.tables.post);break;case"prep":jt=an(ze,St),He=new Me.Parser(jt.data,jt.offset),Ne.tables.prep=He.parseByteList(St.length);break;case"glyf":Z=St;break;case"loca":Oe=St;break;case"CFF ":V=St;break;case"kern":je=St;break;case"GPOS":se=St;break;case"GSUB":pe=St;break;case"meta":ve=St}}if(wt=an(ze,Ce),Ne.tables.name=no.parse(wt.data,wt.offset,L),Ne.names=Ne.tables.name,Z&&Oe)De=M===0,wt=an(ze,Oe),wt=WO.parse(wt.data,wt.offset,Ne.numGlyphs,De),De=an(ze,Z),Ne.glyphs=qs.parse(De.data,De.offset,wt,Ne);else{if(!V)throw new Error("Font doesn't contain TrueType or CFF outlines.");De=an(ze,V),ul.parse(De.data,De.offset,Ne)}for(var wt=an(ze,he),Ft=(Qe.parse(wt.data,wt.offset,Ne.numberOfHMetrics,Ne.numGlyphs,Ne.glyphs),Ne),br=Ft.tables.cmap.glyphIndexMap,qr=Object.keys(br),ln=0;ln<qr.length;ln+=1){var Nn,Un=qr[ln],Es=br[Un];(Nn=Ft.glyphs.get(Es)).addUnicode(parseInt(Un))}for(var yr=0;yr<Ft.glyphs.length;yr+=1)Nn=Ft.glyphs.get(yr),Ft.cffEncoding?Ft.isCIDFont?Nn.name="gid"+yr:Nn.name=Ft.cffEncoding.charset[yr]:Ft.glyphNames.names&&(Nn.name=Ft.glyphNames.glyphIndexToName(yr));return je?(De=an(ze,je),Ne.kerningPairs=HO.parse(De.data,De.offset)):Ne.kerningPairs={},se&&(wt=an(ze,se),Ne.tables.gpos=VO.parse(wt.data,wt.offset),Ne.position.init()),pe&&(De=an(ze,pe),Ne.tables.gsub=sp.parse(De.data,De.offset)),X&&(wt=an(ze,X),Ne.tables.fvar=zO.parse(wt.data,wt.offset,Ne.names)),ve&&(De=an(ze,ve),Ne.tables.meta=la.parse(De.data,De.offset),Ne.metas=Ne.tables.meta),Ne}u.Font=gr,u.Glyph=at,u.Path=J,u.BoundingBox=Q,u._parse=Me,u.parse=$y,u.load=function(j,M){(typeof window>"u"?$O:qO)(j,function(L,D){if(L)return M(L);var V;try{V=$y(D)}catch(X){return M(X,null)}return M(null,V)})},u.loadSync=function(j){return $y(hp(r("fs").readFileSync(j)))},Object.defineProperty(u,"__esModule",{value:!0})},c(typeof a=="object"&&s!==void 0?a:l.opentype={})}).call(this,r("buffer").Buffer)},{buffer:4,fs:2}],255:[function(r,s,a){(function(i){function l(f,h){for(var d=0,p=f.length-1;0<=p;p--){var y=f[p];y==="."?f.splice(p,1):y===".."?(f.splice(p,1),d++):d&&(f.splice(p,1),d--)}if(h)for(;d--;)f.unshift("..");return f}function c(f,h){if(f.filter)return f.filter(h);for(var d=[],p=0;p<f.length;p++)h(f[p],p,f)&&d.push(f[p]);return d}a.resolve=function(){for(var f="",h=!1,d=arguments.length-1;-1<=d&&!h;d--){var p=0<=d?arguments[d]:i.cwd();if(typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");p&&(f=p+"/"+f,h=p.charAt(0)==="/")}return(h?"/":"")+(f=l(c(f.split("/"),function(y){return!!y}),!h).join("/"))||"."},a.normalize=function(f){var h=a.isAbsolute(f),d=u(f,-1)==="/";return(f=(f=l(c(f.split("/"),function(p){return!!p}),!h).join("/"))||h?f:".")&&d&&(f+="/"),(h?"/":"")+f},a.isAbsolute=function(f){return f.charAt(0)==="/"},a.join=function(){var f=Array.prototype.slice.call(arguments,0);return a.normalize(c(f,function(h,d){if(typeof h!="string")throw new TypeError("Arguments to path.join must be strings");return h}).join("/"))},a.relative=function(f,h){function d(x){for(var w=0;w<x.length&&x[w]==="";w++);for(var S=x.length-1;0<=S&&x[S]==="";S--);return S<w?[]:x.slice(w,S-w+1)}f=a.resolve(f).substr(1),h=a.resolve(h).substr(1);for(var p=d(f.split("/")),y=d(h.split("/")),g=Math.min(p.length,y.length),b=g,m=0;m<g;m++)if(p[m]!==y[m]){b=m;break}for(var v=[],m=b;m<p.length;m++)v.push("..");return(v=v.concat(y.slice(b))).join("/")},a.sep="/",a.delimiter=":",a.dirname=function(f){if(typeof f!="string"&&(f+=""),f.length===0)return".";for(var h=f.charCodeAt(0)===47,d=-1,p=!0,y=f.length-1;1<=y;--y)if(f.charCodeAt(y)===47){if(!p){d=y;break}}else p=!1;return d===-1?h?"/":".":h&&d===1?"/":f.slice(0,d)},a.basename=function(f,h){return f=function(d){typeof d!="string"&&(d+="");for(var p=0,y=-1,g=!0,b=d.length-1;0<=b;--b)if(d.charCodeAt(b)===47){if(!g){p=b+1;break}}else y===-1&&(g=!1,y=b+1);return y===-1?"":d.slice(p,y)}(f),f=h&&f.substr(-1*h.length)===h?f.substr(0,f.length-h.length):f},a.extname=function(f){typeof f!="string"&&(f+="");for(var h=-1,d=0,p=-1,y=!0,g=0,b=f.length-1;0<=b;--b){var m=f.charCodeAt(b);if(m===47){if(y)continue;d=b+1;break}p===-1&&(y=!1,p=b+1),m===46?h===-1?h=b:g!==1&&(g=1):h!==-1&&(g=-1)}return h===-1||p===-1||g===0||g===1&&h===p-1&&h===d+1?"":f.slice(h,p)};var u="ab".substr(-1)==="b"?function(f,h,d){return f.substr(h,d)}:function(f,h,d){return h<0&&(h=f.length+h),f.substr(h,d)}}).call(this,r("_process"))},{_process:256}],256:[function(r,c,a){var i,l,c=c.exports={};function u(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}try{i=typeof setTimeout=="function"?setTimeout:u}catch{i=u}try{l=typeof clearTimeout=="function"?clearTimeout:f}catch{l=f}function h(w){if(i===setTimeout)return setTimeout(w,0);if((i===u||!i)&&setTimeout)return(i=setTimeout)(w,0);try{return i(w,0)}catch{try{return i.call(null,w,0)}catch{return i.call(this,w,0)}}}var d,p=[],y=!1,g=-1;function b(){y&&d&&(y=!1,d.length?p=d.concat(p):g=-1,p.length&&m())}function m(){if(!y){for(var w=h(b),S=(y=!0,p.length);S;){for(d=p,p=[];++g<S;)d&&d[g].run();g=-1,S=p.length}d=null,y=!1,function(k){if(l===clearTimeout)return clearTimeout(k);if((l===f||!l)&&clearTimeout)return(l=clearTimeout)(k);try{l(k)}catch{try{return l.call(null,k)}catch{return l.call(this,k)}}}(w)}}function v(w,S){this.fun=w,this.array=S}function x(){}c.nextTick=function(w){var S=new Array(arguments.length-1);if(1<arguments.length)for(var k=1;k<arguments.length;k++)S[k-1]=arguments[k];p.push(new v(w,S)),p.length!==1||y||h(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=x,c.addListener=x,c.once=x,c.off=x,c.removeListener=x,c.removeAllListeners=x,c.emit=x,c.prependListener=x,c.prependOnceListener=x,c.listeners=function(w){return[]},c.binding=function(w){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(w){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],257:[function(r,s,a){s=function(i){var l,c=Object.prototype,u=c.hasOwnProperty,_=typeof Symbol=="function"?Symbol:{},f=_.iterator||"@@iterator",h=_.asyncIterator||"@@asyncIterator",d=_.toStringTag||"@@toStringTag";function p(Y,W,H,K){var J,ae,T,B,W=W&&W.prototype instanceof w?W:w,W=Object.create(W.prototype),K=new F(K||[]);return W._invoke=(J=Y,ae=H,T=K,B=g,function(te,ne){if(B===m)throw new Error("Generator is already running");if(B===v){if(te==="throw")throw ne;return G()}for(T.method=te,T.arg=ne;;){var ce=T.delegate;if(ce&&(ce=function fe(ue,ge){var me=ue.iterator[ge.method];if(me===l){if(ge.delegate=null,ge.method==="throw"){if(ue.iterator.return&&(ge.method="return",ge.arg=l,fe(ue,ge),ge.method==="throw"))return x;ge.method="throw",ge.arg=new TypeError("The iterator does not provide a 'throw' method")}return x}if(me=y(me,ue.iterator,ge.arg),me.type==="throw")return ge.method="throw",ge.arg=me.arg,ge.delegate=null,x;if(me=me.arg,!me)return ge.method="throw",ge.arg=new TypeError("iterator result is not an object"),ge.delegate=null,x;{if(!me.done)return me;ge[ue.resultName]=me.value,ge.next=ue.nextLoc,ge.method!=="return"&&(ge.method="next",ge.arg=l)}return ge.delegate=null,x}(ce,T),ce)){if(ce===x)continue;return ce}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(B===g)throw B=v,T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);if(B=m,ce=y(J,ae,T),ce.type==="normal"){if(B=T.done?v:b,ce.arg!==x)return{value:ce.arg,done:T.done}}else ce.type==="throw"&&(B=v,T.method="throw",T.arg=ce.arg)}}),W}function y(Y,$,H){try{return{type:"normal",arg:Y.call($,H)}}catch(Q){return{type:"throw",arg:Q}}}i.wrap=p;var g="suspendedStart",b="suspendedYield",m="executing",v="completed",x={};function w(){}function S(){}function k(){}var _={},C=(_[f]=function(){return this},Object.getPrototypeOf),C=C&&C(C(U([]))),P=(C&&C!==c&&u.call(C,f)&&(_=C),k.prototype=w.prototype=Object.create(_));function A(Y){["next","throw","return"].forEach(function($){Y[$]=function(H){return this._invoke($,H)}})}function I(Y){var $;this._invoke=function(H,Q){function J(){return new Promise(function(ae,T){(function B(fe,K,te,ne){var ce,fe=y(Y[fe],Y,K);if(fe.type!=="throw")return(K=(ce=fe.arg).value)&&typeof K=="object"&&u.call(K,"__await")?Promise.resolve(K.__await).then(function(ue){B("next",ue,te,ne)},function(ue){B("throw",ue,te,ne)}):Promise.resolve(K).then(function(ue){ce.value=ue,te(ce)},function(ue){return B("throw",ue,te,ne)});ne(fe.arg)})(H,Q,ae,T)})}return $=$?$.then(J,J):J()}}function N(Y){var $={tryLoc:Y[0]};1 in Y&&($.catchLoc=Y[1]),2 in Y&&($.finallyLoc=Y[2],$.afterLoc=Y[3]),this.tryEntries.push($)}function O(Y){var $=Y.completion||{};$.type="normal",delete $.arg,Y.completion=$}function F(Y){this.tryEntries=[{tryLoc:"root"}],Y.forEach(N,this),this.reset(!0)}function U(Y){if(Y){var $,H=Y[f];if(H)return H.call(Y);if(typeof Y.next=="function")return Y;if(!isNaN(Y.length))return $=-1,(H=function Q(){for(;++$<Y.length;)if(u.call(Y,$))return Q.value=Y[$],Q.done=!1,Q;return Q.value=l,Q.done=!0,Q}).next=H}return{next:G}}function G(){return{value:l,done:!0}}return(S.prototype=P.constructor=k).constructor=S,k[d]=S.displayName="GeneratorFunction",i.isGeneratorFunction=function(Y){return Y=typeof Y=="function"&&Y.constructor,!!Y&&(Y===S||(Y.displayName||Y.name)==="GeneratorFunction")},i.mark=function(Y){return Object.setPrototypeOf?Object.setPrototypeOf(Y,k):(Y.__proto__=k,d in Y||(Y[d]="GeneratorFunction")),Y.prototype=Object.create(P),Y},i.awrap=function(Y){return{__await:Y}},A(I.prototype),I.prototype[h]=function(){return this},i.AsyncIterator=I,i.async=function(Y,$,H,Q){var J=new I(p(Y,$,H,Q));return i.isGeneratorFunction($)?J:J.next().then(function(ae){return ae.done?ae.value:J.next()})},A(P),P[d]="Generator",P[f]=function(){return this},P.toString=function(){return"[object Generator]"},i.keys=function(Y){var $,H=[];for($ in Y)H.push($);return H.reverse(),function Q(){for(;H.length;){var J=H.pop();if(J in Y)return Q.value=J,Q.done=!1,Q}return Q.done=!0,Q}},i.values=U,F.prototype={constructor:F,reset:function(Y){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(O),!Y)for(var $ in this)$.charAt(0)==="t"&&u.call(this,$)&&!isNaN(+$.slice(1))&&(this[$]=l)},stop:function(){this.done=!0;var Y=this.tryEntries[0].completion;if(Y.type==="throw")throw Y.arg;return this.rval},dispatchException:function(Y){if(this.done)throw Y;var $=this;function H(W,K){return ae.type="throw",ae.arg=Y,$.next=W,K&&($.method="next",$.arg=l),!!K}for(var Q=this.tryEntries.length-1;0<=Q;--Q){var J=this.tryEntries[Q],ae=J.completion;if(J.tryLoc==="root")return H("end");if(J.tryLoc<=this.prev){var T=u.call(J,"catchLoc"),B=u.call(J,"finallyLoc");if(T&&B){if(this.prev<J.catchLoc)return H(J.catchLoc,!0);if(this.prev<J.finallyLoc)return H(J.finallyLoc)}else if(T){if(this.prev<J.catchLoc)return H(J.catchLoc,!0)}else{if(!B)throw new Error("try statement without catch or finally");if(this.prev<J.finallyLoc)return H(J.finallyLoc)}}}},abrupt:function(Y,$){for(var H=this.tryEntries.length-1;0<=H;--H){var Q=this.tryEntries[H];if(Q.tryLoc<=this.prev&&u.call(Q,"finallyLoc")&&this.prev<Q.finallyLoc){var J=Q;break}}var ae=(J=J&&(Y==="break"||Y==="continue")&&J.tryLoc<=$&&$<=J.finallyLoc?null:J)?J.completion:{};return ae.type=Y,ae.arg=$,J?(this.method="next",this.next=J.finallyLoc,x):this.complete(ae)},complete:function(Y,$){if(Y.type==="throw")throw Y.arg;return Y.type==="break"||Y.type==="continue"?this.next=Y.arg:Y.type==="return"?(this.rval=this.arg=Y.arg,this.method="return",this.next="end"):Y.type==="normal"&&$&&(this.next=$),x},finish:function(Y){for(var $=this.tryEntries.length-1;0<=$;--$){var H=this.tryEntries[$];if(H.finallyLoc===Y)return this.complete(H.completion,H.afterLoc),O(H),x}},catch:function(Y){for(var $=this.tryEntries.length-1;0<=$;--$){var H,Q,J=this.tryEntries[$];if(J.tryLoc===Y)return(H=J.completion).type==="throw"&&(Q=H.arg,O(J)),Q}throw new Error("illegal catch attempt")},delegateYield:function(Y,$,H){return this.delegate={iterator:U(Y),resultName:$,nextLoc:H},this.method==="next"&&(this.arg=l),x}},i}(typeof s=="object"?s.exports:{});try{regeneratorRuntime=s}catch{Function("r","regeneratorRuntime = r")(s)}},{}],258:[function(r,s,a){(function(i){var l,c,u,f,h,d,p,y,g,b;function m(O){if(typeof O!="string"&&(O=String(O)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(O))throw new TypeError("Invalid character in header field name");return O.toLowerCase()}function v(O){return O=typeof O!="string"?String(O):O}function x(O){var F={next:function(){var U=O.shift();return{done:U===void 0,value:U}}};return c&&(F[Symbol.iterator]=function(){return F}),F}function w(O){this.map={},O instanceof w?O.forEach(function(F,U){this.append(U,F)},this):Array.isArray(O)?O.forEach(function(F){this.append(F[0],F[1])},this):O&&Object.getOwnPropertyNames(O).forEach(function(F){this.append(F,O[F])},this)}function S(O){if(O.bodyUsed)return Promise.reject(new TypeError("Already read"));O.bodyUsed=!0}function k(O){return new Promise(function(F,U){O.onload=function(){F(O.result)},O.onerror=function(){U(O.error)}})}function _(O){var F=new FileReader,U=k(F);return F.readAsArrayBuffer(O),U}function C(O){var F;return O.slice?O.slice(0):((F=new Uint8Array(O.byteLength)).set(new Uint8Array(O)),F.buffer)}function P(){return this.bodyUsed=!1,this._initBody=function(O){if(this._bodyInit=O)if(typeof O=="string")this._bodyText=O;else if(u&&Blob.prototype.isPrototypeOf(O))this._bodyBlob=O;else if(f&&FormData.prototype.isPrototypeOf(O))this._bodyFormData=O;else if(l&&URLSearchParams.prototype.isPrototypeOf(O))this._bodyText=O.toString();else if(h&&u&&p(O))this._bodyArrayBuffer=C(O.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!h||!ArrayBuffer.prototype.isPrototypeOf(O)&&!y(O))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=C(O)}else this._bodyText="";this.headers.get("content-type")||(typeof O=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l&&URLSearchParams.prototype.isPrototypeOf(O)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var O=S(this);if(O)return O;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?S(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(_)}),this.text=function(){var O,F,U=S(this);if(U)return U;if(this._bodyBlob)return U=this._bodyBlob,O=new FileReader,F=k(O),O.readAsText(U),F;if(this._bodyArrayBuffer)return Promise.resolve(function(G){for(var Y=new Uint8Array(G),$=new Array(Y.length),H=0;H<Y.length;H++)$[H]=String.fromCharCode(Y[H]);return $.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f&&(this.formData=function(){return this.text().then(I)}),this.json=function(){return this.text().then(JSON.parse)},this}function A(O,F){var U,G=(F=F||{}).body;if(O instanceof A){if(O.bodyUsed)throw new TypeError("Already read");this.url=O.url,this.credentials=O.credentials,F.headers||(this.headers=new w(O.headers)),this.method=O.method,this.mode=O.mode,G||O._bodyInit==null||(G=O._bodyInit,O.bodyUsed=!0)}else this.url=String(O);if(this.credentials=F.credentials||this.credentials||"omit",!F.headers&&this.headers||(this.headers=new w(F.headers)),this.method=(O=F.method||this.method||"GET",U=O.toUpperCase(),-1<g.indexOf(U)?U:O),this.mode=F.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(G)}function I(O){var F=new FormData;return O.trim().split("&").forEach(function(U){var G;U&&(G=(U=U.split("=")).shift().replace(/\+/g," "),U=U.join("=").replace(/\+/g," "),F.append(decodeURIComponent(G),decodeURIComponent(U)))}),F}function N(O,F){F=F||{},this.type="default",this.status=F.status===void 0?200:F.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in F?F.statusText:"OK",this.headers=new w(F.headers),this.url=F.url||"",this._initBody(O)}i.fetch||(l="URLSearchParams"in i,c="Symbol"in i&&"iterator"in Symbol,u="FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),f="FormData"in i,(h="ArrayBuffer"in i)&&(d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(O){return O&&DataView.prototype.isPrototypeOf(O)},y=ArrayBuffer.isView||function(O){return O&&-1<d.indexOf(Object.prototype.toString.call(O))}),w.prototype.append=function(O,F){O=m(O),F=v(F);var U=this.map[O];this.map[O]=U?U+","+F:F},w.prototype.delete=function(O){delete this.map[m(O)]},w.prototype.get=function(O){return O=m(O),this.has(O)?this.map[O]:null},w.prototype.has=function(O){return this.map.hasOwnProperty(m(O))},w.prototype.set=function(O,F){this.map[m(O)]=v(F)},w.prototype.forEach=function(O,F){for(var U in this.map)this.map.hasOwnProperty(U)&&O.call(F,this.map[U],U,this)},w.prototype.keys=function(){var O=[];return this.forEach(function(F,U){O.push(U)}),x(O)},w.prototype.values=function(){var O=[];return this.forEach(function(F){O.push(F)}),x(O)},w.prototype.entries=function(){var O=[];return this.forEach(function(F,U){O.push([U,F])}),x(O)},c&&(w.prototype[Symbol.iterator]=w.prototype.entries),g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],A.prototype.clone=function(){return new A(this,{body:this._bodyInit})},P.call(A.prototype),P.call(N.prototype),N.prototype.clone=function(){return new N(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},N.error=function(){var O=new N(null,{status:0,statusText:""});return O.type="error",O},b=[301,302,303,307,308],N.redirect=function(O,F){if(b.indexOf(F)===-1)throw new RangeError("Invalid status code");return new N(null,{status:F,headers:{location:O}})},i.Headers=w,i.Request=A,i.Response=N,i.fetch=function(O,F){return new Promise(function(U,G){var Y=new A(O,F),$=new XMLHttpRequest;$.onload=function(){var H,Q={status:$.status,statusText:$.statusText,headers:(Q=$.getAllResponseHeaders()||"",H=new w,Q.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(T){var T=T.split(":"),B=T.shift().trim();B&&(T=T.join(":").trim(),H.append(B,T))}),H)},J=(Q.url="responseURL"in $?$.responseURL:Q.headers.get("X-Request-URL"),"response"in $?$.response:$.responseText);U(new N(J,Q))},$.onerror=function(){G(new TypeError("Network request failed"))},$.ontimeout=function(){G(new TypeError("Network request failed"))},$.open(Y.method,Y.url,!0),Y.credentials==="include"?$.withCredentials=!0:Y.credentials==="omit"&&($.withCredentials=!1),"responseType"in $&&u&&($.responseType="blob"),Y.headers.forEach(function(H,Q){$.setRequestHeader(Q,H)}),$.send(Y._bodyInit===void 0?null:Y._bodyInit)})},i.fetch.polyfill=!0)})(typeof self<"u"?self:this)},{}],259:[function(r,s,a){r("core-js/modules/es.function.name"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,l=u(r("../core/main")),c=u(r("../color/color_conversion"));function u(d){return d&&d.__esModule?d:{default:d}}var f=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],h=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];l.default.prototype._rgbColorName=function(g){var p,y,g=c.default._rgbaToHSBA(g),b=[(i=g)[0],g[1],g[2]];b[0]!==0&&(b[0]=Math.round(100*b[0]),(g=b[0].toString().split(""))[y=g.length-1]=parseInt(g[y]),g[y]<2.5?g[y]=0:2.5<=g[y]&&g[y]<7.5&&(g[y]=5),g.length===2?(g[0]=parseInt(g[0]),7.5<=g[y]&&(g[y]=0,g[0]=g[0]+1),b[0]=10*g[0]+g[1]):7.5<=g[y]?b[0]=10:b[0]=g[y]),b[2]=b[2]/255;for(var m=b.length-1;1<=m;m--)b[m]<=.25?b[m]=0:.25<b[m]&&b[m]<.75?b[m]=.5:b[m]=1;if(b[0]===0&&b[1]===0&&b[2]===1){for(var v=2;0<=v;v--)i[v]=Math.round(1e4*i[v])/1e4;for(var x=0;x<f.length;x++){if(f[x].h===i[0]&&f[x].s===i[1]&&f[x].b===i[2]){p=f[x].name;break}p="white"}}else for(var w=0;w<h.length;w++)if(h[w].h===b[0]&&h[w].s===b[1]&&h[w].b===b[2]){p=h[w].name;break}return p},r=l.default,a.default=r},{"../color/color_conversion":265,"../core/main":280,"core-js/modules/es.function.name":173,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.split":203}],260:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.replace"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r},l="_Description",c="_fallbackDesc",u="_fallbackTable",f="_Label",h="_labelDesc",d="_labelTable";function p(y){if(y==="label"||y==="fallback")throw new Error("description should not be LABEL or FALLBACK");return y.endsWith(".")||y.endsWith(";")||y.endsWith(",")||y.endsWith("?")||y.endsWith("!")||(y+="."),y}i.default.prototype.describe=function(y,g){var b;i.default._validateParameters("describe",arguments),typeof y=="string"&&(b=this.canvas.id,y=p(y),this.dummyDOM||(this.dummyDOM=document.getElementById(b).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==y&&(this.descriptions.fallback.innerHTML=y):this._describeHTML("fallback",y),g===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==y&&(this.descriptions.label.innerHTML=y):this._describeHTML("label",y)))},i.default.prototype.describeElement=function(y,g,b){var m,v;i.default._validateParameters("describeElement",arguments),typeof g=="string"&&typeof y=="string"&&(m=this.canvas.id,g=p(g),v=function(x){if(x==="label"||x==="fallback")throw new Error("element name should not be LABEL or FALLBACK");return x.endsWith(".")||x.endsWith(";")||x.endsWith(",")?x=x.replace(/.$/,":"):x.endsWith(":")||(x+=":"),x}(y),y=y.replace(/[^a-zA-Z0-9]/g,""),v='<th scope="row">'.concat(v,"</th><td>").concat(g,"</td>"),this.dummyDOM||(this.dummyDOM=document.getElementById(m).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[y]?this.descriptions.fallbackElements[y].innerHTML!==v&&(this.descriptions.fallbackElements[y].innerHTML=v):this._describeElementHTML("fallback",y,v),b===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[y]?this.descriptions.labelElements[y].innerHTML!==v&&(this.descriptions.labelElements[y].innerHTML=v):this._describeElementHTML("label",y,v)))},i.default.prototype._describeHTML=function(y,g){var b,m=this.canvas.id;y==="fallback"?(this.dummyDOM.querySelector("#".concat(m+l))?this.dummyDOM.querySelector("#"+m+u).insertAdjacentHTML("beforebegin",'<p id="'.concat(m+c,'"></p>')):(b='<div id="'.concat(m).concat(l,'" role="region" aria-label="Canvas Description"><p id="').concat(m).concat(c,'"></p></div>'),this.dummyDOM.querySelector("#".concat(m,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(m,"accessibleOutput")).insertAdjacentHTML("beforebegin",b):this.dummyDOM.querySelector("#".concat(m)).innerHTML=b),this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(m).concat(c)),this.descriptions.fallback.innerHTML=g):y==="label"&&(this.dummyDOM.querySelector("#".concat(m+f))?this.dummyDOM.querySelector("#".concat(m+d))&&this.dummyDOM.querySelector("#".concat(m+d)).insertAdjacentHTML("beforebegin",'<p id="'.concat(m).concat(h,'"></p>')):(b='<div id="'.concat(m).concat(f,'" class="p5Label"><p id="').concat(m).concat(h,'"></p></div>'),this.dummyDOM.querySelector("#".concat(m,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(m,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",b):this.dummyDOM.querySelector("#"+m).insertAdjacentHTML("afterend",b)),this.descriptions.label=this.dummyDOM.querySelector("#"+m+h),this.descriptions.label.innerHTML=g)},i.default.prototype._describeElementHTML=function(y,g,b){var m,v=this.canvas.id;y==="fallback"?(this.dummyDOM.querySelector("#".concat(v+l))?this.dummyDOM.querySelector("#"+v+u)||this.dummyDOM.querySelector("#"+v+c).insertAdjacentHTML("afterend",'<table id="'.concat(v).concat(u,'"><caption>Canvas elements and their descriptions</caption></table>')):(m='<div id="'.concat(v).concat(l,'" role="region" aria-label="Canvas Description"><table id="').concat(v).concat(u,'"><caption>Canvas elements and their descriptions</caption></table></div>'),this.dummyDOM.querySelector("#".concat(v,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutput")).insertAdjacentHTML("beforebegin",m):this.dummyDOM.querySelector("#"+v).innerHTML=m),(m=document.createElement("tr")).id=v+"_fte_"+g,this.dummyDOM.querySelector("#"+v+u).appendChild(m),this.descriptions.fallbackElements[g]=this.dummyDOM.querySelector("#".concat(v).concat("_fte_").concat(g)),this.descriptions.fallbackElements[g].innerHTML=b):y==="label"&&(this.dummyDOM.querySelector("#".concat(v+f))?this.dummyDOM.querySelector("#".concat(v+d))||this.dummyDOM.querySelector("#"+v+h).insertAdjacentHTML("afterend",'<table id="'.concat(v+d,'"></table>')):(m='<div id="'.concat(v).concat(f,'" class="p5Label"><table id="').concat(v).concat(d,'"></table></div>'),this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(v,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",m):this.dummyDOM.querySelector("#"+v).insertAdjacentHTML("afterend",m)),(y=document.createElement("tr")).id=v+"_lte_"+g,this.dummyDOM.querySelector("#"+v+d).appendChild(y),this.descriptions.labelElements[g]=this.dummyDOM.querySelector("#".concat(v).concat("_lte_").concat(g)),this.descriptions.labelElements[g].innerHTML=b)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.ends-with":195,"core-js/modules/es.string.replace":201}],261:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.map"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.map"),r("core-js/modules/es.string.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype._updateGridOutput=function(i){var l,c,u,f;this.dummyDOM.querySelector("#".concat(i,"_summary"))&&(l=this._accessibleOutputs[i],u=function(h,d,p,y){return d="".concat(d," canvas, ").concat(p," by ").concat(y," pixels, contains ").concat(h[0]),d=(h[0]===1?"".concat(d," shape: "):"".concat(d," shapes: ")).concat(h[1]),d}((c=function(h,d){var p,y="",g="",b=0;for(p in d){var m,v=0;for(m in d[p]){var x='<li id="'.concat(h,"shape").concat(b,'">').concat(d[p][m].color," ").concat(p,",");p==="line"?x+=" location = ".concat(d[p][m].pos,", length = ").concat(d[p][m].length," pixels"):(x+=" location = ".concat(d[p][m].pos),p!=="point"&&(x+=", area = ".concat(d[p][m].area," %")),x+="</li>"),y+=x,v++,b++}g=1<v?"".concat(g," ").concat(v," ").concat(p,"s"):"".concat(g," ").concat(v," ").concat(p)}return{numShapes:[b,g],details:y}}(i,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),f=function(h,d){var p,y,g=0,b="",m=Array.from(Array(10),function(){return Array(10)});for(p in d)for(var v in d[p]){var x=void 0;x=p!=="line"?'<a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][v].color," ").concat(p,"</a>"):'<a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][v].color," ").concat(p," midpoint</a>"),m[d[p][v].loc.locY][d[p][v].loc.locX]?m[d[p][v].loc.locY][d[p][v].loc.locX]=m[d[p][v].loc.locY][d[p][v].loc.locX]+"  "+x:m[d[p][v].loc.locY][d[p][v].loc.locX]=x,g++}for(y in m){var w,S="<tr>";for(w in m[y])S+="<td>",m[y][w]!==void 0&&(S+=m[y][w]),S+="</td>";b=b+S+"</tr>"}return b}(i,this.ingredients.shapes),u!==l.summary.innerHTML&&(l.summary.innerHTML=u),f!==l.map.innerHTML&&(l.map.innerHTML=f),c.details!==l.shapeDetails.innerHTML&&(l.shapeDetails.innerHTML=c.details),this._accessibleOutputs[i]=l)},r=r.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.from":161,"core-js/modules/es.array.map":167,"core-js/modules/es.string.iterator":197}],262:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.to-fixed"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u){return function(f){if(Array.isArray(f)){for(var h=0,d=new Array(f.length);h<f.length;h++)d[h]=f[h];return d}}(u)||function(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(u,f,h){return f=Math.floor(u[0]/f*10),u=Math.floor(u[1]/h*10),f===10&&(f-=1),u===10&&(u-=1),{locX:f,locY:u}}i.default.prototype.textOutput=function(u){i.default._validateParameters("textOutput",arguments),this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),u===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},i.default.prototype.gridOutput=function(u){i.default._validateParameters("gridOutput",arguments),this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),u===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},i.default.prototype._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},i.default.prototype._createOutput=function(u,f){var h,d,p,y=this.canvas.id,g=(this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:"",pBackground:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(y).parentNode),"");f==="Fallback"?(h=y+u,this.dummyDOM.querySelector("#".concat(d=y+"accessibleOutput"))||(this.dummyDOM.querySelector("#".concat(y,"_Description"))?this.dummyDOM.querySelector("#".concat(y,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(d,'" role="region" aria-label="Canvas Outputs"></div>')):this.dummyDOM.querySelector("#".concat(y)).innerHTML='<div id="'.concat(d,'" role="region" aria-label="Canvas Outputs"></div>'))):f==="Label"&&(h=y+u+(g=f),this.dummyDOM.querySelector("#".concat(d=y+"accessibleOutput"+f))||(this.dummyDOM.querySelector("#".concat(y,"_Label"))?this.dummyDOM.querySelector("#".concat(y,"_Label")):this.dummyDOM.querySelector("#".concat(y))).insertAdjacentHTML("afterend",'<div id="'.concat(d,'"></div>'))),this._accessibleOutputs[h]={},u==="textOutput"?(g="#".concat(y,"gridOutput").concat(g),p='<div id="'.concat(h,'">Text Output<div id="').concat(h,'Summary" aria-label="text output summary"><p id="').concat(h,'_summary"></p><ul id="').concat(h,'_list"></ul></div><table id="').concat(h,'_shapeDetails" summary="text output shape details"></table></div>'),this.dummyDOM.querySelector(g)?this.dummyDOM.querySelector(g).insertAdjacentHTML("beforebegin",p):this.dummyDOM.querySelector("#".concat(d)).innerHTML=p,this._accessibleOutputs[h].list=this.dummyDOM.querySelector("#".concat(h,"_list"))):u==="gridOutput"&&(g="#".concat(y,"textOutput").concat(g),p='<div id="'.concat(h,'">Grid Output<p id="').concat(h,'_summary" aria-label="grid output summary"><table id="').concat(h,'_map" summary="grid output content"></table><ul id="').concat(h,'_shapeDetails" aria-label="grid output shape details"></ul></div>'),this.dummyDOM.querySelector(g)?this.dummyDOM.querySelector(g).insertAdjacentHTML("afterend",p):this.dummyDOM.querySelector("#".concat(d)).innerHTML=p,this._accessibleOutputs[h].map=this.dummyDOM.querySelector("#".concat(h,"_map"))),this._accessibleOutputs[h].shapeDetails=this.dummyDOM.querySelector("#".concat(h,"_shapeDetails")),this._accessibleOutputs[h].summary=this.dummyDOM.querySelector("#".concat(h,"_summary"))},i.default.prototype._updateAccsOutput=function(){var u=this.canvas.id;JSON.stringify(this.ingredients.shapes)===this.ingredients.pShapes&&this.ingredients.colors.background===this.ingredients.pBackground||(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(u+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(u+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(u+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(u+"gridOutputLabel"))},i.default.prototype._accsBackground=function(u){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.pBackground=this.ingredients.colors.background,this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==u&&(this.ingredients.colors.backgroundRGBA=u,this.ingredients.colors.background=this._rgbColorName(u))},i.default.prototype._accsCanvasColors=function(u,f){u==="fill"?this.ingredients.colors.fillRGBA!==f&&(this.ingredients.colors.fillRGBA=f,this.ingredients.colors.fill=this._rgbColorName(f)):u==="stroke"&&this.ingredients.colors.strokeRGBA!==f&&(this.ingredients.colors.strokeRGBA=f,this.ingredients.colors.stroke=this._rgbColorName(f))},i.default.prototype._accsOutput=function(u,f){u==="ellipse"&&f[2]===f[3]?u="circle":u==="rectangle"&&f[2]===f[3]&&(u="square");var h,d,p={},y=!0,g=function(m,v){var x;return m=m==="rectangle"||m==="ellipse"||m==="arc"||m==="circle"||m==="square"?(x=Math.round(v[0]+v[2]/2),Math.round(v[1]+v[3]/2)):m==="triangle"?(x=(v[0]+v[2]+v[4])/3,(v[1]+v[3]+v[5])/3):m==="quadrilateral"?(x=(v[0]+v[2]+v[4]+v[6])/4,(v[1]+v[3]+v[5]+v[7])/4):m==="line"?(x=(v[0]+v[2])/2,(v[1]+v[3])/2):(x=v[0],v[1]),[x,m]}(u,f);if(u==="line"?(p.color=this.ingredients.colors.stroke,p.length=Math.round(this.dist(f[0],f[1],f[2],f[3])),h=this._getPos(f[0],[1]),d=this._getPos(f[2],[3]),p.loc=c(g,this.width,this.height),p.pos=h===d?"at ".concat(h):"from ".concat(h," to ").concat(d)):(u==="point"?p.color=this.ingredients.colors.stroke:(p.color=this.ingredients.colors.fill,p.area=this._getArea(u,f)),p.pos=this._getPos.apply(this,l(g)),p.loc=c(g,this.width,this.height)),this.ingredients.shapes[u]){if(this.ingredients.shapes[u]!==[p]){for(var b in this.ingredients.shapes[u])JSON.stringify(this.ingredients.shapes[u][b])===JSON.stringify(p)&&(y=!1);y===!0&&this.ingredients.shapes[u].push(p)}}else this.ingredients.shapes[u]=[p]},i.default.prototype._getPos=function(d,h){var d=new DOMPointReadOnly(d,h),h=this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform(),d=d.matrixTransform(h),h=d.x,d=d.y,p=this.width*this._pixelDensity,y=this.height*this._pixelDensity;return h<.4*p?d<.4*y?"top left":.6*y<d?"bottom left":"mid left":.6*p<h?d<.4*y?"top right":.6*y<d?"bottom right":"mid right":d<.4*y?"top middle":.6*y<d?"bottom middle":"middle"},i.default.prototype._getArea=function(u,f){var h,d,p=0,y=(u==="arc"?(p=(h=((f[5]-f[4])%(2*Math.PI)+2*Math.PI)%(2*Math.PI))*f[2]*f[3]/8,f[6]!=="open"&&f[6]!=="chord"||(d=f[0],v=f[1],y=f[0]+f[2]/2*Math.cos(f[4]).toFixed(2),x=f[1]+f[3]/2*Math.sin(f[4]).toFixed(2),b=f[0]+f[2]/2*Math.cos(f[5]).toFixed(2),g=f[1]+f[3]/2*Math.sin(f[5]).toFixed(2),d=Math.abs(d*(x-g)+y*(g-v)+b*(v-x))/2,h>Math.PI?p+=d:p-=d)):u==="ellipse"||u==="circle"?p=3.14*f[2]/2*f[3]/2:u==="line"||u==="point"?p=0:u==="quadrilateral"?p=Math.abs((f[6]+f[0])*(f[7]-f[1])+(f[0]+f[2])*(f[1]-f[3])+(f[2]+f[4])*(f[3]-f[5])+(f[4]+f[6])*(f[5]-f[7]))/2:u==="rectangle"||u==="square"?p=f[2]*f[3]:u==="triangle"&&(p=Math.abs(f[0]*(f[3]-f[5])+f[2]*(f[5]-f[1])+f[4]*(f[1]-f[3]))/2),this.width*this._pixelDensity),g=this.height*this._pixelDensity,b=[new DOMPoint(0,0),new DOMPoint(y,0),new DOMPoint(y,g),new DOMPoint(0,g)],m=(this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform()).inverse(),v=b.map(function(w){return w.matrixTransform(m)}),x=Math.abs((v[3].x+v[0].x)*(v[3].y-v[0].y)+(v[0].x+v[1].x)*(v[0].y-v[1].y)+(v[1].x+v[2].x)*(v[1].y-v[2].y)+(v[2].x+v[3].x)*(v[2].y-v[3].y))/2;return Math.round(100*p/x)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],263:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.concat"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype._updateTextOutput=function(i){var l,c,u,f;this.dummyDOM.querySelector("#".concat(i,"_summary"))&&(l=this._accessibleOutputs[i],u=function(h,d,p,y){return p="Your output is a, ".concat(p," by ").concat(y," pixels, ").concat(d," canvas containing the following"),p=h===1?"".concat(p," shape:"):"".concat(p," ").concat(h," shapes:"),p}((c=function(h,d){var p,y="",g=0;for(p in d)for(var b in d[p]){var m='<li><a href="#'.concat(h,"shape").concat(g,'">').concat(d[p][b].color," ").concat(p,"</a>");p==="line"?m+=", ".concat(d[p][b].pos,", ").concat(d[p][b].length," pixels long.</li>"):(m+=", at ".concat(d[p][b].pos),p!=="point"&&(m+=", covering ".concat(d[p][b].area,"% of the canvas")),m+=".</li>"),y+=m,g++}return{numShapes:g,listShapes:y}}(i,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),f=function(h,d){var p,y="",g=0;for(p in d)for(var b in d[p]){var m='<tr id="'.concat(h,"shape").concat(g,'"><th>').concat(d[p][b].color," ").concat(p,"</th>");p==="line"?m+="<td>location = ".concat(d[p][b].pos,"</td><td>length = ").concat(d[p][b].length," pixels</td></tr>"):(m+="<td>location = ".concat(d[p][b].pos,"</td>"),p!=="point"&&(m+="<td> area = ".concat(d[p][b].area,"%</td>")),m+="</tr>"),y+=m,g++}return y}(i,this.ingredients.shapes),u!==l.summary.innerHTML&&(l.summary.innerHTML=u),c.listShapes!==l.list.innerHTML&&(l.list.innerHTML=c.listShapes),f!==l.shapeDetails.innerHTML&&(l.shapeDetails.innerHTML=f),this._accessibleOutputs[i]=l)},r=r.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152}],264:[function(r,s,a){var i=(i=r("./core/main"))&&i.__esModule?i:{default:i};r("./core/constants"),r("./core/environment"),r("./core/friendly_errors/stacktrace"),r("./core/friendly_errors/validate_params"),r("./core/friendly_errors/file_errors"),r("./core/friendly_errors/fes_core"),r("./core/friendly_errors/sketch_reader"),r("./core/helpers"),r("./core/legacy"),r("./core/preload"),r("./core/p5.Element"),r("./core/p5.Graphics"),r("./core/p5.Renderer"),r("./core/p5.Renderer2D"),r("./core/rendering"),r("./core/shim"),r("./core/structure"),r("./core/transform"),r("./core/shape/2d_primitives"),r("./core/shape/attributes"),r("./core/shape/curves"),r("./core/shape/vertex"),r("./accessibility/outputs"),r("./accessibility/textOutput"),r("./accessibility/gridOutput"),r("./accessibility/color_namer"),r("./color/color_conversion"),r("./color/creating_reading"),r("./color/p5.Color"),r("./color/setting"),r("./data/p5.TypedDict"),r("./data/local_storage.js"),r("./dom/dom"),r("./accessibility/describe"),r("./events/acceleration"),r("./events/keyboard"),r("./events/mouse"),r("./events/touch"),r("./image/filters"),r("./image/image"),r("./image/loading_displaying"),r("./image/p5.Image"),r("./image/pixels"),r("./io/files"),r("./io/p5.Table"),r("./io/p5.TableRow"),r("./io/p5.XML"),r("./math/calculation"),r("./math/math"),r("./math/noise"),r("./math/p5.Vector"),r("./math/random"),r("./math/trigonometry"),r("./typography/attributes"),r("./typography/loading_displaying"),r("./typography/p5.Font"),r("./utilities/array_functions"),r("./utilities/conversion"),r("./utilities/string_functions"),r("./utilities/time_date"),r("./webgl/3d_primitives"),r("./webgl/interaction"),r("./webgl/light"),r("./webgl/loading"),r("./webgl/material"),r("./webgl/p5.Camera"),r("./webgl/p5.DataArray"),r("./webgl/p5.Geometry"),r("./webgl/p5.Matrix"),r("./webgl/p5.RendererGL.Immediate"),r("./webgl/p5.RendererGL"),r("./webgl/p5.RendererGL.Retained"),r("./webgl/p5.Framebuffer"),r("./webgl/p5.Shader"),r("./webgl/p5.RenderBuffer"),r("./webgl/p5.Texture"),r("./webgl/text"),r("./core/init"),s.exports=i.default},{"./accessibility/color_namer":259,"./accessibility/describe":260,"./accessibility/gridOutput":261,"./accessibility/outputs":262,"./accessibility/textOutput":263,"./color/color_conversion":265,"./color/creating_reading":266,"./color/p5.Color":267,"./color/setting":268,"./core/constants":269,"./core/environment":270,"./core/friendly_errors/fes_core":271,"./core/friendly_errors/file_errors":272,"./core/friendly_errors/sketch_reader":273,"./core/friendly_errors/stacktrace":274,"./core/friendly_errors/validate_params":275,"./core/helpers":276,"./core/init":277,"./core/legacy":279,"./core/main":280,"./core/p5.Element":281,"./core/p5.Graphics":282,"./core/p5.Renderer":283,"./core/p5.Renderer2D":284,"./core/preload":285,"./core/rendering":286,"./core/shape/2d_primitives":287,"./core/shape/attributes":288,"./core/shape/curves":289,"./core/shape/vertex":290,"./core/shim":291,"./core/structure":292,"./core/transform":293,"./data/local_storage.js":294,"./data/p5.TypedDict":295,"./dom/dom":296,"./events/acceleration":297,"./events/keyboard":298,"./events/mouse":299,"./events/touch":300,"./image/filters":301,"./image/image":302,"./image/loading_displaying":303,"./image/p5.Image":304,"./image/pixels":305,"./io/files":306,"./io/p5.Table":307,"./io/p5.TableRow":308,"./io/p5.XML":309,"./math/calculation":310,"./math/math":311,"./math/noise":312,"./math/p5.Vector":313,"./math/random":314,"./math/trigonometry":315,"./typography/attributes":316,"./typography/loading_displaying":317,"./typography/p5.Font":318,"./utilities/array_functions":319,"./utilities/conversion":320,"./utilities/string_functions":321,"./utilities/time_date":322,"./webgl/3d_primitives":323,"./webgl/interaction":325,"./webgl/light":326,"./webgl/loading":327,"./webgl/material":328,"./webgl/p5.Camera":329,"./webgl/p5.DataArray":330,"./webgl/p5.Framebuffer":331,"./webgl/p5.Geometry":332,"./webgl/p5.Matrix":333,"./webgl/p5.RenderBuffer":334,"./webgl/p5.RendererGL":337,"./webgl/p5.RendererGL.Immediate":335,"./webgl/p5.RendererGL.Retained":336,"./webgl/p5.Shader":338,"./webgl/p5.Texture":339,"./webgl/text":340}],265:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.ColorConversion={_hsbaToHSLA:function(i){var l=i[0],c=i[1],u=i[2],f=(2-c)*u/2;return f!=0&&(f==1?c=0:f<.5?c/=2-c:c=c*u/(2-2*f)),[l,c,f,i[3]]},_hsbaToRGBA:function(i){var l,c,u,f,h,d=6*i[0],p=i[1],y=i[2];return p===0?[y,y,y,i[3]]:(c=y*(1-p),u=y*(1-p*(d-(l=Math.floor(d)))),p=y*(1-p*(1+l-d)),d=l===1?(f=u,h=y,c):l===2?(f=c,h=y,p):l===3?(f=c,h=u,y):l===4?(f=p,h=c,y):l===5?(f=y,h=c,u):(f=y,h=p,c),[f,h,d,i[3]])},_hslaToHSBA:function(i){var l=i[0],c=i[1],u=i[2],f=u<.5?(1+c)*u:u+c-u*c;return[l,c=2*(f-u)/f,f,i[3]]},_hslaToRGBA:function(i){var l,c=6*i[0],u=i[1],f=i[2];return u===0?[f,f,f,i[3]]:[(l=function(h,d,p){return h<0?h+=6:6<=h&&(h-=6),h<1?d+(p-d)*h:h<3?p:h<4?d+(p-d)*(4-h):d})(2+c,u=2*f-(f=f<.5?(1+u)*f:f+u-f*u),f),l(c,u,f),l(c-2,u,f),i[3]]},_rgbaToHSBA:function(i){var l,c,u=i[0],f=i[1],h=i[2],d=Math.max(u,f,h),p=d-Math.min(u,f,h);return p==0?c=l=0:(c=p/d,u===d?l=(f-h)/p:f===d?l=2+(h-u)/p:h===d&&(l=4+(u-f)/p),l<0?l+=6:6<=l&&(l-=6)),[l/6,c,d,i[3]]},_rgbaToHSLA:function(i){var l,c,u=i[0],f=i[1],h=i[2],d=Math.max(u,f,h),y=Math.min(u,f,h),p=d+y,y=d-y;return y==0?c=l=0:(c=p<1?y/p:y/(2-p),u===d?l=(f-h)/y:f===d?l=2+(h-u)/y:h===d&&(l=4+(u-f)/y),l<0?l+=6:6<=l&&(l-=6)),[l/6,c,p/2,i[3]]}},r=r.default.ColorConversion,a.default=r},{"../core/main":280}],266:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.map"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Color"),r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.alpha=function(d){return c.default._validateParameters("alpha",arguments),this.color(d)._getAlpha()},c.default.prototype.blue=function(d){return c.default._validateParameters("blue",arguments),this.color(d)._getBlue()},c.default.prototype.brightness=function(d){return c.default._validateParameters("brightness",arguments),this.color(d)._getBrightness()},c.default.prototype.color=function(){for(var d,p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];return c.default._validateParameters("color",y),y[0]instanceof c.default.Color?y[0]:(d=Array.isArray(y[0])?y[0]:y,new c.default.Color(this,d))},c.default.prototype.green=function(d){return c.default._validateParameters("green",arguments),this.color(d)._getGreen()},c.default.prototype.hue=function(d){return c.default._validateParameters("hue",arguments),this.color(d)._getHue()},c.default.prototype.lerpColor=function(d,p,y){c.default._validateParameters("lerpColor",arguments);var g,b,m,v=this._colorMode,x=this._colorMaxes;if(v===u.RGB)b=d.levels.map(function(w){return w/255}),m=p.levels.map(function(w){return w/255});else if(v===u.HSB)d._getBrightness(),p._getBrightness(),b=d.hsba,m=p.hsba;else{if(v!==u.HSL)throw new Error("".concat(v," cannot be used for interpolation."));d._getLightness(),p._getLightness(),b=d.hsla,m=p.hsla}return y=Math.max(Math.min(y,1),0),this.lerp===void 0&&(this.lerp=function(w,S,k){return k*(S-w)+w}),v===u.RGB?g=this.lerp(b[0],m[0],y):(.5<Math.abs(b[0]-m[0])&&(b[0]>m[0]?m[0]+=1:b[0]+=1),1<=(g=this.lerp(b[0],m[0],y))&&--g),d=this.lerp(b[1],m[1],y),p=this.lerp(b[2],m[2],y),b=this.lerp(b[3],m[3],y),g*=x[v][0],d*=x[v][1],p*=x[v][2],b*=x[v][3],this.color(g,d,p,b)},c.default.prototype.lightness=function(d){return c.default._validateParameters("lightness",arguments),this.color(d)._getLightness()},c.default.prototype.red=function(d){return c.default._validateParameters("red",arguments),this.color(d)._getRed()},c.default.prototype.saturation=function(d){return c.default._validateParameters("saturation",arguments),this.color(d)._getSaturation()};var h=c.default;a.default=h},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"./p5.Color":267,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],267:[function(g,s,a){function i(w){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(w)}function l(w){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(S){return i(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":i(S)})(w)}g("core-js/modules/es.symbol"),g("core-js/modules/es.symbol.description"),g("core-js/modules/es.symbol.iterator"),g("core-js/modules/es.array.includes"),g("core-js/modules/es.array.iterator"),g("core-js/modules/es.array.join"),g("core-js/modules/es.array.map"),g("core-js/modules/es.array.slice"),g("core-js/modules/es.object.get-own-property-descriptor"),g("core-js/modules/es.object.to-string"),g("core-js/modules/es.regexp.constructor"),g("core-js/modules/es.regexp.exec"),g("core-js/modules/es.regexp.to-string"),g("core-js/modules/es.string.includes"),g("core-js/modules/es.string.iterator"),g("core-js/modules/es.string.trim"),g("core-js/modules/es.weak-map"),g("core-js/modules/web.dom-collections.iterator"),g("core-js/modules/es.array.includes"),g("core-js/modules/es.array.join"),g("core-js/modules/es.array.map"),g("core-js/modules/es.array.slice"),g("core-js/modules/es.object.to-string"),g("core-js/modules/es.regexp.constructor"),g("core-js/modules/es.regexp.exec"),g("core-js/modules/es.regexp.to-string"),g("core-js/modules/es.string.includes"),g("core-js/modules/es.string.trim"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=d(g("../core/main")),u=function(w){if(w&&w.__esModule)return w;if(w===null||l(w)!=="object"&&typeof w!="function")return{default:w};var S=h();if(S&&S.has(w))return S.get(w);var k,_={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(k in w){var P;Object.prototype.hasOwnProperty.call(w,k)&&((P=C?Object.getOwnPropertyDescriptor(w,k):null)&&(P.get||P.set)?Object.defineProperty(_,k,P):_[k]=w[k])}return _.default=w,S&&S.set(w,_),_}(g("../core/constants")),f=d(g("./color_conversion"));function h(){var w;return typeof WeakMap!="function"?null:(w=new WeakMap,h=function(){return w},w)}function d(w){return w&&w.__esModule?w:{default:w}}function p(w,S){for(var k=0;k<S.length;k++){var _=S[k];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(w,_.key,_)}}var y={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},g=/\s*/,x=/(\d{1,3})/,b=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,m=new RegExp("".concat(b.source,"%")),v={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",x.source,",",x.source,",",x.source,"\\)$"].join(g.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",m.source,",",m.source,",",m.source,"\\)$"].join(g.source),"i"),RGBA:new RegExp(["^rgba\\(",x.source,",",x.source,",",x.source,",",b.source,"\\)$"].join(g.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",m.source,",",m.source,",",m.source,",",b.source,"\\)$"].join(g.source),"i"),HSL:new RegExp(["^hsl\\(",x.source,",",m.source,",",m.source,"\\)$"].join(g.source),"i"),HSLA:new RegExp(["^hsla\\(",x.source,",",m.source,",",m.source,",",b.source,"\\)$"].join(g.source),"i"),HSB:new RegExp(["^hsb\\(",x.source,",",m.source,",",m.source,"\\)$"].join(g.source),"i"),HSBA:new RegExp(["^hsba\\(",x.source,",",m.source,",",m.source,",",b.source,"\\)$"].join(g.source),"i")},x=(c.default.Color=function(){function w(C,P){if(!(this instanceof w))throw new TypeError("Cannot call a class as a function");if(this._storeModeAndMaxes(C._colorMode,C._colorMaxes),![u.RGB,u.HSL,u.HSB].includes(this.mode))throw new Error("".concat(this.mode," is an invalid colorMode."));this._array=w._parseInputs.apply(this,P),this._calculateLevels()}var S,k,_;return S=w,_=[{key:"_parseInputs",value:function(C,P,A,I){var N,O=arguments.length,F=this.mode,U=this.maxes[F],G=[];if(3<=O){for(G[0]=C/U[0],G[1]=P/U[1],G[2]=A/U[2],G[3]=typeof I=="number"?I/U[3]:1,N=G.length-1;0<=N;--N){var Y=G[N];Y<0?G[N]=0:1<Y&&(G[N]=1)}return F===u.HSL?f.default._hslaToRGBA(G):F===u.HSB?f.default._hsbaToRGBA(G):G}if(O===1&&typeof C=="string"){if(A=C.trim().toLowerCase(),y[A])return w._parseInputs.call(this,y[A]);if(v.HEX3.test(A))return(G=v.HEX3.exec(A).slice(1).map(function($){return parseInt($+$,16)/255}))[3]=1,G;if(v.HEX6.test(A))return(G=v.HEX6.exec(A).slice(1).map(function($){return parseInt($,16)/255}))[3]=1,G;if(v.HEX4.test(A))return G=v.HEX4.exec(A).slice(1).map(function($){return parseInt($+$,16)/255});if(v.HEX8.test(A))return G=v.HEX8.exec(A).slice(1).map(function($){return parseInt($,16)/255});if(v.RGB.test(A))return(G=v.RGB.exec(A).slice(1).map(function($){return $/255}))[3]=1,G;if(v.RGB_PERCENT.test(A))return(G=v.RGB_PERCENT.exec(A).slice(1).map(function($){return parseFloat($)/100}))[3]=1,G;if(v.RGBA.test(A))return G=v.RGBA.exec(A).slice(1).map(function($,H){return H===3?parseFloat($):$/255});if(v.RGBA_PERCENT.test(A))return G=v.RGBA_PERCENT.exec(A).slice(1).map(function($,H){return H===3?parseFloat($):parseFloat($)/100});if(v.HSL.test(A)?(G=v.HSL.exec(A).slice(1).map(function($,H){return H===0?parseInt($,10)/360:parseInt($,10)/100}))[3]=1:v.HSLA.test(A)&&(G=v.HSLA.exec(A).slice(1).map(function($,H){return H===0?parseInt($,10)/360:H===3?parseFloat($):parseInt($,10)/100})),(G=G.map(function($){return Math.max(Math.min($,1),0)})).length)return f.default._hslaToRGBA(G);if(v.HSB.test(A)?(G=v.HSB.exec(A).slice(1).map(function($,H){return H===0?parseInt($,10)/360:parseInt($,10)/100}))[3]=1:v.HSBA.test(A)&&(G=v.HSBA.exec(A).slice(1).map(function($,H){return H===0?parseInt($,10)/360:H===3?parseFloat($):parseInt($,10)/100})),G.length){for(N=G.length-1;0<=N;--N)G[N]=Math.max(Math.min(G[N],1),0);return f.default._hsbaToRGBA(G)}G=[1,1,1,1]}else{if(O!==1&&O!==2||typeof C!="number")throw new Error("".concat(arguments,"is not a valid color representation."));G[0]=C/U[2],G[1]=C/U[2],G[2]=C/U[2],G[3]=typeof P=="number"?P/U[3]:1,G=G.map(function($){return Math.max(Math.min($,1),0)})}return G}}],(k=[{key:"toString",value:function(C){var P=this.levels,A=this._array,I=A[3];switch(C){case"#rrggbb":return"#".concat(P[0]<16?"0".concat(P[0].toString(16)):P[0].toString(16),P[1]<16?"0".concat(P[1].toString(16)):P[1].toString(16),P[2]<16?"0".concat(P[2].toString(16)):P[2].toString(16));case"#rrggbbaa":return"#".concat(P[0]<16?"0".concat(P[0].toString(16)):P[0].toString(16),P[1]<16?"0".concat(P[1].toString(16)):P[1].toString(16),P[2]<16?"0".concat(P[2].toString(16)):P[2].toString(16),P[3]<16?"0".concat(P[3].toString(16)):P[3].toString(16));case"#rgb":return"#".concat(Math.round(15*A[0]).toString(16),Math.round(15*A[1]).toString(16),Math.round(15*A[2]).toString(16));case"#rgba":return"#".concat(Math.round(15*A[0]).toString(16),Math.round(15*A[1]).toString(16),Math.round(15*A[2]).toString(16),Math.round(15*A[3]).toString(16));case"rgb":return"rgb(".concat(P[0],", ",P[1],", ",P[2],")");case"rgb%":return"rgb(".concat((100*A[0]).toPrecision(3),"%, ",(100*A[1]).toPrecision(3),"%, ",(100*A[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*A[0]).toPrecision(3),"%, ",(100*A[1]).toPrecision(3),"%, ",(100*A[2]).toPrecision(3),"%, ",(100*A[3]).toPrecision(3),"%)");case"hsb":case"hsv":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsb(".concat(this.hsba[0]*this.maxes[u.HSB][0],", ",this.hsba[1]*this.maxes[u.HSB][1],", ",this.hsba[2]*this.maxes[u.HSB][2],")");case"hsb%":case"hsv%":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsba(".concat(this.hsba[0]*this.maxes[u.HSB][0],", ",this.hsba[1]*this.maxes[u.HSB][1],", ",this.hsba[2]*this.maxes[u.HSB][2],", ",I,")");case"hsba%":case"hsva%":return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*I).toPrecision(3),"%)");case"hsl":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat(this.hsla[0]*this.maxes[u.HSL][0],", ",this.hsla[1]*this.maxes[u.HSL][1],", ",this.hsla[2]*this.maxes[u.HSL][2],")");case"hsl%":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsla(".concat(this.hsla[0]*this.maxes[u.HSL][0],", ",this.hsla[1]*this.maxes[u.HSL][1],", ",this.hsla[2]*this.maxes[u.HSL][2],", ",I,")");case"hsla%":return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*I).toPrecision(3),"%)");default:return"rgba(".concat(P[0],",",P[1],",",P[2],",",I,")")}}},{key:"setRed",value:function(C){this._array[0]=C/this.maxes[u.RGB][0],this._calculateLevels()}},{key:"setGreen",value:function(C){this._array[1]=C/this.maxes[u.RGB][1],this._calculateLevels()}},{key:"setBlue",value:function(C){this._array[2]=C/this.maxes[u.RGB][2],this._calculateLevels()}},{key:"setAlpha",value:function(C){this._array[3]=C/this.maxes[this.mode][3],this._calculateLevels()}},{key:"_calculateLevels",value:function(){for(var C=this._array,P=this.levels=new Array(C.length),A=C.length-1;0<=A;--A)P[A]=Math.round(255*C[A]);this.hsla=null,this.hsba=null}},{key:"_getAlpha",value:function(){return this._array[3]*this.maxes[this.mode][3]}},{key:"_storeModeAndMaxes",value:function(C,P){this.mode=C,this.maxes=P}},{key:"_getMode",value:function(){return this.mode}},{key:"_getMaxes",value:function(){return this.maxes}},{key:"_getBlue",value:function(){return this._array[2]*this.maxes[u.RGB][2]}},{key:"_getBrightness",value:function(){return this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[u.HSB][2]}},{key:"_getGreen",value:function(){return this._array[1]*this.maxes[u.RGB][1]}},{key:"_getHue",value:function(){return this.mode===u.HSB?(this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[u.HSB][0]):(this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[u.HSL][0])}},{key:"_getLightness",value:function(){return this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[u.HSL][2]}},{key:"_getRed",value:function(){return this._array[0]*this.maxes[u.RGB][0]}},{key:"_getSaturation",value:function(){return this.mode===u.HSB?(this.hsba||(this.hsba=f.default._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[u.HSB][1]):(this.hsla||(this.hsla=f.default._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[u.HSL][1])}}])&&p(S.prototype,k),_&&p(S,_),w}(),c.default.Color);a.default=x},{"../core/constants":269,"../core/main":280,"./color_conversion":265,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],268:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.fill"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Color"),c.default.prototype.beginClip=function(){this._renderer.beginClip(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{})},c.default.prototype.endClip=function(){this._renderer.endClip()},c.default.prototype.clip=function(d,p){this._renderer.beginClip(p),d(),this._renderer.endClip(p)},c.default.prototype.background=function(){var d;return(d=this._renderer).background.apply(d,arguments),this},c.default.prototype.clear=function(){return this._renderer.clear((arguments.length<=0?void 0:arguments[0])||0,(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0,(arguments.length<=3?void 0:arguments[3])||0),this},c.default.prototype.colorMode=function(d,p,y,g,b){return c.default._validateParameters("colorMode",arguments),d!==u.RGB&&d!==u.HSB&&d!==u.HSL||(this._colorMode=d,d=this._colorMaxes[d],arguments.length===2?(d[0]=p,d[1]=p,d[2]=p,d[3]=p):arguments.length===4?(d[0]=p,d[1]=y,d[2]=g):arguments.length===5&&(d[0]=p,d[1]=y,d[2]=g,d[3]=b)),this},c.default.prototype.fill=function(){var d;return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),(d=this._renderer).fill.apply(d,arguments),this},c.default.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},c.default.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},c.default.prototype.stroke=function(){var d;return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),(d=this._renderer).stroke.apply(d,arguments),this},c.default.prototype.erase=function(){return this._renderer.erase(0<arguments.length&&arguments[0]!==void 0?arguments[0]:255,1<arguments.length&&arguments[1]!==void 0?arguments[1]:255),this},c.default.prototype.noErase=function(){return this._renderer.noErase(),this};var h=c.default;a.default=h},{"../core/constants":269,"../core/main":280,"./p5.Color":267,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],269:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QUADRATIC=a.LINEAR=a._CTX_MIDDLE=a._DEFAULT_LEADMULT=a._DEFAULT_TEXT_FILL=a.WORD=a.CHAR=a.BOLDITALIC=a.BOLD=a.ITALIC=a.NORMAL=a.BLUR=a.ERODE=a.DILATE=a.POSTERIZE=a.INVERT=a.OPAQUE=a.GRAY=a.THRESHOLD=a.BURN=a.DODGE=a.SOFT_LIGHT=a.HARD_LIGHT=a.OVERLAY=a.REPLACE=a.SCREEN=a.MULTIPLY=a.EXCLUSION=a.SUBTRACT=a.DIFFERENCE=a.LIGHTEST=a.DARKEST=a.ADD=a.REMOVE=a.BLEND=a.UP_ARROW=a.TAB=a.SHIFT=a.RIGHT_ARROW=a.RETURN=a.OPTION=a.LEFT_ARROW=a.ESCAPE=a.ENTER=a.DOWN_ARROW=a.DELETE=a.CONTROL=a.BACKSPACE=a.ALT=a.AUTO=a.HSL=a.HSB=a.RGB=a.MITER=a.BEVEL=a.ROUND=a.SQUARE=a.PROJECT=a.PIE=a.CHORD=a.OPEN=a.CLOSE=a.TESS=a.QUAD_STRIP=a.QUADS=a.TRIANGLE_STRIP=a.TRIANGLE_FAN=a.TRIANGLES=a.LINE_LOOP=a.LINE_STRIP=a.LINES=a.POINTS=a.BASELINE=a.BOTTOM=a.TOP=a.CENTER=a.LEFT=a.RIGHT=a.RADIUS=a.CORNERS=a.CORNER=a.RAD_TO_DEG=a.DEG_TO_RAD=a.RADIANS=a.DEGREES=a.TWO_PI=a.TAU=a.QUARTER_PI=a.PI=a.HALF_PI=a.WAIT=a.TEXT=a.MOVE=a.HAND=a.CROSS=a.ARROW=a.WEBGL2=a.WEBGL=a.P2D=a.VERSION=void 0,a.RGBA=a.HALF_FLOAT=a.FLOAT=a.UNSIGNED_INT=a.UNSIGNED_BYTE=a.COVER=a.CONTAIN=a.FALLBACK=a.LABEL=a.AXES=a.GRID=a._DEFAULT_FILL=a._DEFAULT_STROKE=a.PORTRAIT=a.LANDSCAPE=a.SMOOTH=a.FLAT=a.MIRROR=a.CLAMP=a.REPEAT=a.NEAREST=a.IMAGE=a.IMMEDIATE=a.TEXTURE=a.FILL=a.STROKE=a.CURVE=a.BEZIER=void 0;var i=Math.PI,l=(a.VERSION="1.9.1",a.P2D="p2d",a.WEBGL="webgl",a.WEBGL2="webgl2",a.ARROW="default",a.CROSS="crosshair",a.HAND="pointer",a.MOVE="move",a.TEXT="text",a.WAIT="wait",i/2),l=(a.HALF_PI=l,i),l=(a.PI=l,i/4),l=(a.QUARTER_PI=l,2*i),l=(a.TAU=l,2*i),l=(a.TWO_PI=l,a.DEGREES="degrees",a.RADIANS="radians",i/180),l=(a.DEG_TO_RAD=l,180/i);a.RAD_TO_DEG=l,a.CORNER="corner",a.CORNERS="corners",a.RADIUS="radius",a.RIGHT="right",a.LEFT="left",a.CENTER="center",a.TOP="top",a.BOTTOM="bottom",a.BASELINE="alphabetic",a.POINTS=0,a.LINES=1,a.LINE_STRIP=3,a.LINE_LOOP=2,a.TRIANGLES=4,a.TRIANGLE_FAN=6,a.TRIANGLE_STRIP=5,a.QUADS="quads",a.QUAD_STRIP="quad_strip",a.TESS="tess",a.CLOSE="close",a.OPEN="open",a.CHORD="chord",a.PIE="pie",a.PROJECT="square",a.SQUARE="butt",a.ROUND="round",a.BEVEL="bevel",a.MITER="miter",a.RGB="rgb",a.HSB="hsb",a.HSL="hsl",a.AUTO="auto",a.ALT=18,a.BACKSPACE=8,a.CONTROL=17,a.DELETE=46,a.DOWN_ARROW=40,a.ENTER=13,a.ESCAPE=27,a.LEFT_ARROW=37,a.OPTION=18,a.RETURN=13,a.RIGHT_ARROW=39,a.SHIFT=16,a.TAB=9,a.UP_ARROW=38,a.BLEND="source-over",a.REMOVE="destination-out",a.ADD="lighter",a.DARKEST="darken",a.LIGHTEST="lighten",a.DIFFERENCE="difference",a.SUBTRACT="subtract",a.EXCLUSION="exclusion",a.MULTIPLY="multiply",a.SCREEN="screen",a.REPLACE="copy",a.OVERLAY="overlay",a.HARD_LIGHT="hard-light",a.SOFT_LIGHT="soft-light",a.DODGE="color-dodge",a.BURN="color-burn",a.THRESHOLD="threshold",a.GRAY="gray",a.OPAQUE="opaque",a.INVERT="invert",a.POSTERIZE="posterize",a.DILATE="dilate",a.ERODE="erode",a.BLUR="blur",a.NORMAL="normal",a.ITALIC="italic",a.BOLD="bold",a.BOLDITALIC="bold italic",a.CHAR="CHAR",a.WORD="WORD",a._DEFAULT_TEXT_FILL="#000000",a._DEFAULT_LEADMULT=1.25,a._CTX_MIDDLE="middle",a.LINEAR="linear",a.QUADRATIC="quadratic",a.BEZIER="bezier",a.CURVE="curve",a.STROKE="stroke",a.FILL="fill",a.TEXTURE="texture",a.IMMEDIATE="immediate",a.IMAGE="image",a.NEAREST="nearest",a.REPEAT="repeat",a.CLAMP="clamp",a.MIRROR="mirror",a.FLAT="flat",a.SMOOTH="smooth",a.LANDSCAPE="landscape",a.PORTRAIT="portrait",a._DEFAULT_STROKE="#000000",a._DEFAULT_FILL="#FFFFFF",a.GRID="grid",a.AXES="axes",a.LABEL="label",a.FALLBACK="fallback",a.CONTAIN="contain",a.COVER="cover",a.UNSIGNED_BYTE="unsigned-byte",a.UNSIGNED_INT="unsigned-int",a.FLOAT="float",a.HALF_FLOAT="half-float",a.RGBA="rgba"},{}],270:[function(r,s,a){function i(b){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(b)}function l(b){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(m){return i(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":i(m)})(b)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.search"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.search"),r("core-js/modules/es.string.split"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(u=r("./main"))&&u.__esModule?u:{default:u},u=function(b){if(b&&b.__esModule)return b;if(b===null||l(b)!=="object"&&typeof b!="function")return{default:b};var m=f();if(m&&m.has(b))return m.get(b);var v,x={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(v in b){var S;Object.prototype.hasOwnProperty.call(b,v)&&((S=w?Object.getOwnPropertyDescriptor(b,v):null)&&(S.get||S.set)?Object.defineProperty(x,v,S):x[v]=b[v])}return x.default=b,m&&m.set(b,x),x}(r("./constants"));function f(){var b;return typeof WeakMap!="function"?null:(b=new WeakMap,f=function(){return b},b)}var h=[u.ARROW,u.CROSS,u.HAND,u.MOVE,u.TEXT,u.WAIT],d=(c.default.prototype._frameRate=0,c.default.prototype._lastFrameTime=window.performance.now(),c.default.prototype._targetFrameRate=60,window.print),p=!1;function y(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function g(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}c.default.prototype.print=function(){var b;arguments.length?(b=console).log.apply(b,arguments):p||(d(),window.confirm("You just tried to print the webpage. Do you want to prevent this from running again?")&&(p=!0))},c.default.prototype.frameCount=0,c.default.prototype.deltaTime=0,c.default.prototype.focused=document.hasFocus(),c.default.prototype.cursor=function(b,m,v){var x,w="auto",S=this._curElement.elt;h.includes(b)?w=b:typeof b=="string"&&(x="",m&&v&&typeof m=="number"&&typeof v=="number"&&(x="".concat(m," ").concat(v)),w=b.substring(0,7)==="http://"||b.substring(0,8)==="https://"||/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(b)?"url(".concat(b,") ").concat(x,", auto"):b),S.style.cursor=w},c.default.prototype.frameRate=function(b){return c.default._validateParameters("frameRate",arguments),typeof b!="number"||b<0?this._frameRate:(this._setProperty("_targetFrameRate",b),b===0&&this._setProperty("_frameRate",b),this)},c.default.prototype.getFrameRate=function(){return this.frameRate()},c.default.prototype.setFrameRate=function(b){return this.frameRate(b)},c.default.prototype.getTargetFrameRate=function(){return this._targetFrameRate},c.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},c.default.prototype.webglVersion=u.P2D,c.default.prototype.displayWidth=screen.width,c.default.prototype.displayHeight=screen.height,c.default.prototype.windowWidth=y(),c.default.prototype.windowHeight=g(),c.default.prototype._onresize=function(b){this._setProperty("windowWidth",y()),this._setProperty("windowHeight",g());var m=this._isGlobal?window:this;typeof m.windowResized!="function"||(m=m.windowResized(b))===void 0||m||b.preventDefault()},c.default.prototype.width=0,c.default.prototype.height=0,c.default.prototype.fullscreen=function(b){if(c.default._validateParameters("fullscreen",arguments),b===void 0)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(b){if(b=document.documentElement,!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen&&b.msRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},c.default.prototype.pixelDensity=function(b){var m;return c.default._validateParameters("pixelDensity",arguments),typeof b=="number"?(b!==this._pixelDensity&&(this._pixelDensity=b),(m=this).resizeCanvas(this.width,this.height,!0)):m=this._pixelDensity,m},c.default.prototype.displayDensity=function(){return window.devicePixelRatio},c.default.prototype.getURL=function(){return location.href},c.default.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(b){return b!==""})},c.default.prototype.getURLParams=function(){for(var b,m=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,v={};(b=m.exec(location.search))!=null;)b.index===m.lastIndex&&m.lastIndex++,v[b[1]]=b[2];return v},r=c.default,a.default=r},{"./constants":269,"./main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.search":202,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],271:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.starts-with"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.starts-with"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(h=r("../main"))&&h.__esModule?h:{default:h};r("../internationalization");function l(d,p){p=p||console.log.bind(console),c||f(),c.some(function(y){var g;if(d.message&&d.message.match("\\W?".concat(y.name,"\\W"))!==null)return g=y.type==="function"?"".concat(y.name,"()"):y.name,p("Did you just try to use p5.js's ".concat(g," ").concat(y.type,`? If so, you may want to move it into your sketch's setup() function.

For more details, see: `).concat(u)),!0})}var c=null,f=null,u=(i.default._friendlyError=i.default._checkForUserDefinedFunctions=i.default._fesErrorMonitor=function(){},c=null,"https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"),f=function(){function d(y){return Object.getOwnPropertyNames(y).filter(function(g){return g[0]!=="_"&&!(g in p)&&(p[g]=!0)}).map(function(g){var b=typeof y[g]=="function"?"function":g===g.toUpperCase()?"constant":"variable";return{name:g,type:b}})}var p={};(c=[].concat(d(i.default.prototype),d(r("../constants")))).sort(function(y,g){return g.name.length-y.name.length})},h=(i.default.prototype._helpForMisusedAtTopLevelCode=l,document.readyState!=="complete"&&(window.addEventListener("error",l,!1),window.addEventListener("load",function(){window.removeEventListener("error",l,!1)})),i.default);a.default=h},{"../constants":269,"../internationalization":278,"../main":280,"./browser_errors":void 0,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.function.name":173,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-names":184,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.starts-with":204,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],272:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(i=r("../main"))&&i.__esModule?i:{default:i};r("../internationalization"),i.default._friendlyFileLoadError=function(){},r=i.default,a.default=r},{"../internationalization":278,"../main":280}],273:[function(r,s,a){function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}function l(p){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(y){return i(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":i(y)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=h(r("../main"));r("../internationalization"),f(r("../constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var y=u();if(y&&y.has(p))return y.get(p);var g,b,m={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&((b=v?Object.getOwnPropertyDescriptor(p,g):null)&&(b.get||b.set)?Object.defineProperty(m,g,b):m[g]=p[g]);return m.default=p,y&&y.set(p,m),m}function h(p){return p&&p.__esModule?p:{default:p}}c.default._fesCodeReader=function(){};var d=c.default;a.default=d},{"../constants":269,"../internationalization":278,"../main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],274:[function(r,s,a){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../main"))&&r.__esModule?r:{default:r};function i(){var l=/(^|@)\S+:\d+/,c=/^\s*at .*(\S+:\d+|\(native\))/m,u=/^(eval@)?(\[native code])?$/;return{parse:function(f){return f.stacktrace!==void 0||f["opera#sourceloc"]!==void 0?this.parseOpera(f):f.stack&&f.stack.match(c)?this.parseV8OrIE(f):f.stack?this.parseFFOrSafari(f):void 0},extractLocation:function(f){return f.indexOf(":")===-1?[f]:[(f=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(f.replace(/[()]/g,"")))[1],f[2]||void 0,f[3]||void 0]},parseV8OrIE:function(f){return f.stack.split(`
`).filter(function(h){return!!h.match(c)},this).map(function(h){var d=(h=-1<h.indexOf("(eval ")?h.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""):h).replace(/^\s+/,"").replace(/\(eval code/g,"("),p=d.match(/ (\((.+):(\d+):(\d+)\)$)/),d=(d=p?d.replace(p[0],""):d).split(/\s+/).slice(1),p=this.extractLocation(p?p[1]:d.pop());return{functionName:d.join(" ")||void 0,fileName:-1<["eval","<anonymous>"].indexOf(p[0])?void 0:p[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)},parseFFOrSafari:function(f){return f.stack.split(`
`).filter(function(h){return!h.match(u)},this).map(function(h){var d,p;return(h=-1<h.indexOf(" > eval")?h.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):h).indexOf("@")===-1&&h.indexOf(":")===-1?{functionName:h}:{functionName:(p=h.match(d=/((.*".+"[^@]*)?[^@]*)(?:@)/))&&p[1]?p[1]:void 0,fileName:(p=this.extractLocation(h.replace(d,"")))[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)},parseOpera:function(f){return!f.stacktrace||-1<f.message.indexOf(`
`)&&f.message.split(`
`).length>f.stacktrace.split(`
`).length?this.parseOpera9(f):f.stack?this.parseOpera11(f):this.parseOpera10(f)},parseOpera9:function(f){for(var h=/Line (\d+).*script (?:in )?(\S+)/i,d=f.message.split(`
`),p=[],y=2,g=d.length;y<g;y+=2){var b=h.exec(d[y]);b&&p.push({fileName:b[2],lineNumber:b[1],source:d[y]})}return p},parseOpera10:function(f){for(var h=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,d=f.stacktrace.split(`
`),p=[],y=0,g=d.length;y<g;y+=2){var b=h.exec(d[y]);b&&p.push({functionName:b[3]||void 0,fileName:b[2],lineNumber:b[1],source:d[y]})}return p},parseOpera11:function(f){return f.stack.split(`
`).filter(function(h){return!!h.match(l)&&!h.match(/^Error created at/)},this).map(function(h){var d,y=h.split("@"),p=this.extractLocation(y.pop()),y=y.shift()||"";return{functionName:y.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,args:(d=y.match(/\(([^)]*)\)/)?y.replace(/^[^(]+\(([^)]*)\)$/,"$1"):d)===void 0||d==="[arguments not available]"?void 0:d.split(","),fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:h}},this)}}}r.default._getErrorStackParser=function(){return new i},r=r.default,a.default=r},{"../main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203}],275:[function(r,s,a){function i(f){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(l=r("../main"))&&l.__esModule?l:{default:l};(function(f){if(!(f&&f.__esModule)&&!(f===null||u(f)!=="object"&&typeof f!="function")){var h=c();if(h&&h.has(f))return h.get(f);var d,p={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(d in f){var g;Object.prototype.hasOwnProperty.call(f,d)&&((g=y?Object.getOwnPropertyDescriptor(f,d):null)&&(g.get||g.set)?Object.defineProperty(p,d,g):p[d]=f[d])}p.default=f,h&&h.set(f,p)}})(r("../constants")),r("../internationalization");function c(){var f;return typeof WeakMap!="function"?null:(f=new WeakMap,c=function(){return f},f)}function u(f){return(u=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(h){return i(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":i(h)})(f)}l.default._validateParameters=l.default._clearValidateParamsCache=function(){},r=l.default,a.default=r},{"../../../docs/parameterData.json":void 0,"../constants":269,"../internationalization":278,"../main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.function.name":173,"core-js/modules/es.map":174,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],276:[function(r,s,a){function i(f){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}function l(f){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(h){return i(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":i(h)})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=function(f){if(f&&f.__esModule)return f;if(f===null||l(f)!=="object"&&typeof f!="function")return{default:f};var h=u();if(h&&h.has(f))return h.get(f);var d,p={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(d in f){var g;Object.prototype.hasOwnProperty.call(f,d)&&((g=y?Object.getOwnPropertyDescriptor(f,d):null)&&(g.get||g.set)?Object.defineProperty(p,d,g):p[d]=f[d])}return p.default=f,h&&h.set(f,p),p}(r("./constants"));function u(){var f;return typeof WeakMap!="function"?null:(f=new WeakMap,u=function(){return f},f)}a.default={modeAdjust:function(f,h,d,p,y){return y===c.CORNER?{x:f,y:h,w:d,h:p}:y===c.CORNERS?{x:f,y:h,w:d-f,h:p-h}:y===c.RADIUS?{x:f-d,y:h-p,w:2*d,h:2*p}:y===c.CENTER?{x:f-.5*d,y:h-.5*p,w:d,h:p}:void 0}}},{"./constants":269,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],277:[function(r,s,a){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var i=(l=r("../core/main"))&&l.__esModule?l:{default:l};r("./internationalization");var l=Promise.resolve();Promise.all([new Promise(function(c,u){document.readyState==="complete"?c():window.addEventListener("load",c,!1)}),l]).then(function(){window._setupDone!==void 0?console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import"):window.mocha||(window.setup&&typeof window.setup=="function"||window.draw&&typeof window.draw=="function")&&!i.default.instance&&new i.default})},{"../core/main":280,"./internationalization":278,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.string.iterator":197,"core-js/modules/web.dom-collections.iterator":243}],278:[function(r,s,a){r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.setTranslatorLanguage=a.currentTranslatorLanguage=a.availableTranslatorLanguages=a.initialize=a.translator=void 0;var i,l,c=f(r("i18next")),u=f(r("i18next-browser-languagedetector"));function f(p){return p&&p.__esModule?p:{default:p}}function h(p,y){for(var g=0;g<y.length;g++){var b=y[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}var d=function(){function p(b,m){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");this.init(b,m)}var y,g;return y=p,(g=[{key:"fetchWithTimeout",value:function(b,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:2e3;return Promise.race([fetch(b,m),new Promise(function(x,w){return setTimeout(function(){return w(new Error("timeout"))},v)})])}},{key:"init",value:function(b){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};this.services=b,this.options=m}},{key:"read",value:function(b,m,v){var x=this.options.loadPath;b===this.options.fallback?v(null,i[b][m]):l.includes(b)?(x=this.services.interpolator.interpolate(x,{lng:b,ns:m}),this.loadUrl(x,v)):v("Not found",!1)}},{key:"loadUrl",value:function(b,m){this.fetchWithTimeout(b).then(function(v){if(v.ok)return v.json();throw new Error("failed loading ".concat(b))},function(){throw new Error("failed loading ".concat(b))}).then(function(v){return m(null,v)}).catch(m)}}])&&h(y.prototype,g),p}();d.type="backend",a.translator=function(p,y){console.debug("p5.js translator called before translations were loaded"),c.default.t(p,y)},a.initialize=function(){return c.default.use(u.default).use(d).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:i}).then(function(p){a.translator=p},function(p){return console.debug("Translations failed to load (".concat(p,")"))})},a.availableTranslatorLanguages=function(){return c.default.languages},a.currentTranslatorLanguage=function(p){return c.default.language},a.setTranslatorLanguage=function(p){return c.default.changeLanguage(p||void 0,function(y){return console.debug("Translations failed to load (".concat(y,")"))})}},{"../../translations":void 0,"../../translations/dev":void 0,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/web.dom-collections.iterator":243,i18next:3,"i18next-browser-languagedetector":3}],279:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("./main"))&&r.__esModule?r:{default:r},r.default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},r.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},r.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},r.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},r=r.default,a.default=r},{"./main":280}],280:[function(r,s,a){function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}function l(p){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(y){return i(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":i(y)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-names"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r("./shim");var c=function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var y=u();if(y&&y.has(p))return y.get(p);var g,b={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=m?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,y&&y.set(p,b),b}(r("./constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p,y){for(var g=0;g<y.length;g++){var b=y[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}var h,d=function(){function p(b,x){var v=this;if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");this._setupDone=!1,this._preloadDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._userNode=x,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._startListener=null,this._initializeInstanceVariables(),this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this.touchstart=!1,this.touchend=!1,this._lcg_random_state=null,this._gaussian_previous=!1,this._events.wheel=null,this._loadingScreenId="p5_loading",this._registeredMethods={};var x=Object.getOwnPropertyNames(p.prototype._registeredMethods),w=!0,S=!1,k=void 0;try{for(var _,C=x[Symbol.iterator]();!(w=(_=C.next()).done);w=!0){var P=_.value;this._registeredMethods[P]=p.prototype._registeredMethods[P].slice()}}catch($){S=!0,k=$}finally{try{w||C.return==null||C.return()}finally{if(S)throw k}}window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),p.prototype.callRegisteredHooksFor=function($){var H=this||p.prototype,Q=this._isGlobal?window:this;if(H._registeredMethods.hasOwnProperty($)){var H=H._registeredMethods[$],J=!0,$=!1,ae=void 0;try{for(var T,B=H[Symbol.iterator]();!(J=(T=B.next()).done);J=!0){var W=T.value;typeof W=="function"&&W.call(Q)}}catch(ne){$=!0,ae=ne}finally{try{J||B.return==null||B.return()}finally{if($)throw ae}}}},this._start=function(){v._userNode&&typeof v._userNode=="string"&&(v._userNode=document.getElementById(v._userNode));var $=v._isGlobal?window:v;if($.preload){v.callRegisteredHooksFor("beforePreload");var H,Q=document.getElementById(v._loadingScreenId),J=(Q||((Q=document.createElement("div")).innerHTML="Loading...",Q.style.position="absolute",Q.id=v._loadingScreenId,(v._userNode||document.body).appendChild(Q)),v._preloadMethods);for(H in J){J[H]=J[H]||p;var ae=J[H];ae!==p.prototype&&ae!==p||(v._isGlobal&&(window[H]=v._wrapPreload(v,H)),ae=v),v._registeredPreloadMethods[H]=ae[H],ae[H]=v._wrapPreload(ae,H)}$.preload(),v._runIfPreloadsAreDone()}else v._setup(),v._recording||v._draw()},this._runIfPreloadsAreDone=function(){var $,H=this._isGlobal?window:this;H._preloadCount===0&&(($=document.getElementById(H._loadingScreenId))&&$.parentNode.removeChild($),this.callRegisteredHooksFor("afterPreload"),this._setupDone||(this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),H._setup(),this._recording||H._draw()))},this._decrementPreload=function(){var $=this._isGlobal?window:this;$._preloadDone||typeof $.preload!="function"||($._setProperty("_preloadCount",$._preloadCount-1),$._runIfPreloadsAreDone())},this._wrapPreload=function($,H){var Q=this;return function(){Q._incrementPreload();for(var J=arguments.length,ae=new Array(J),T=0;T<J;T++)ae[T]=arguments[T];return Q._registeredPreloadMethods[H].apply($,ae)}},this._incrementPreload=function(){var $=this._isGlobal?window:this;$._preloadDone||$._setProperty("_preloadCount",$._preloadCount+1)},this._setup=function(){v.callRegisteredHooksFor("beforeSetup"),v.createCanvas(v._defaultCanvasSize.width,v._defaultCanvasSize.height,"p2d");var $=v._isGlobal?window:v;if(typeof $.preload=="function")for(var H in v._preloadMethods)$[H]=v._preloadMethods[H][H],$[H]&&v&&($[H]=$[H].bind(v));v._millisStart=window.performance.now(),$._preloadDone=!0,typeof $.setup=="function"&&$.setup();var Q=document.getElementsByTagName("canvas"),J=!0,ae=!1,T=void 0;try{for(var B,W=Q[Symbol.iterator]();!(J=(B=W.next()).done);J=!0){var K=B.value;K.dataset.hidden==="true"&&(K.style.visibility="",delete K.dataset.hidden)}}catch(te){ae=!0,T=te}finally{try{J||W.return==null||W.return()}finally{if(ae)throw T}}v._lastTargetFrameTime=window.performance.now(),v._lastRealFrameTime=window.performance.now(),v._setupDone=!0,(v._accessibleOutputs.grid||v._accessibleOutputs.text)&&v._updateAccsOutput(),v.callRegisteredHooksFor("afterSetup")},this._draw=function(){var $=window.performance.now(),H=$-v._lastTargetFrameTime,Q=1e3/v._targetFrameRate;(!v._loop||Q-5<=H)&&(v.deltaTime=$-v._lastRealFrameTime,v._setProperty("deltaTime",v.deltaTime),v._frameRate=1e3/v.deltaTime,v.redraw(),v._lastTargetFrameTime=Math.max(v._lastTargetFrameTime+Q,$),v._lastRealFrameTime=$,v._updateMouseCoords!==void 0&&(v._updateMouseCoords(),v._setProperty("movedX",0),v._setProperty("movedY",0))),v._loop&&(v._requestAnimId=window.requestAnimationFrame(v._draw))},this._setProperty=function($,H){v[$]=H,v._isGlobal&&(window[$]=H)},this.remove=function(){v._startListener&&window.removeEventListener("load",v._startListener,!1);var $=document.getElementById(v._loadingScreenId);if($&&($.parentNode.removeChild($),v._incrementPreload()),v._curElement){for(var H in v._loop=!1,v._requestAnimId&&window.cancelAnimationFrame(v._requestAnimId),v._events)window.removeEventListener(H,v._events[H]);var Q=!0,$=!1,J=void 0;try{for(var ae,T=v._elements[Symbol.iterator]();!(Q=(ae=T.next()).done);Q=!0){var B,W=ae.value;for(B in W.elt&&W.elt.parentNode&&W.elt.parentNode.removeChild(W.elt),W._events)W.elt.removeEventListener(B,W._events[B])}}catch(fe){$=!0,J=fe}finally{try{Q||T.return==null||T.return()}finally{if($)throw J}}var K=v;v._registeredMethods.remove.forEach(function(fe){fe!==void 0&&fe.call(K)})}if(v._isGlobal){for(var te in p.prototype)try{delete window[te]}catch{window[te]=void 0}for(var ne in v)if(v.hasOwnProperty(ne))try{delete window[ne]}catch{window[ne]=void 0}p.instance=null}},this._registeredMethods.init.forEach(function($){$!==void 0&&$.call(this)},this),this._setupPromisePreloads();var A,I,N=this._createFriendlyGlobalFunctionBinder();if(b)b(this),p._checkForUserDefinedFunctions(this);else{for(var O in this._isGlobal=!0,p.instance=this,p.prototype)typeof p.prototype[O]=="function"?(A=O.substring(2),this._events.hasOwnProperty(A)||(Math.hasOwnProperty(O)&&Math[O]===p.prototype[O]?N(O,p.prototype[O]):N(O,p.prototype[O].bind(this)))):N(O,p.prototype[O]);for(var F in this)this.hasOwnProperty(F)&&N(F,this[F])}for(I in this._events){var U=this["_on".concat(I)];U&&(U=U.bind(this),window.addEventListener(I,U,{passive:!1}),this._events[I]=U)}function G(){v._setProperty("focused",!0)}function Y(){v._setProperty("focused",!1)}window.addEventListener("focus",G),window.addEventListener("blur",Y),this.registerMethod("remove",function(){window.removeEventListener("focus",G),window.removeEventListener("blur",Y)}),document.readyState==="complete"?this._start():(this._startListener=this._start.bind(this),window.addEventListener("load",this._startListener,!1))}var y,g;return y=p,(g=[{key:"_initializeInstanceVariables",value:function(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._bezierDetail=20,this._curveDetail=20,this._colorMode=c.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},this._downKeys={}}},{key:"registerPreloadMethod",value:function(b,m){p.prototype._preloadMethods.hasOwnProperty(b)||(p.prototype._preloadMethods[b]=m)}},{key:"registerMethod",value:function(b,m){var v=this||p.prototype;v._registeredMethods.hasOwnProperty(b)||(v._registeredMethods[b]=[]),v._registeredMethods[b].push(m)}},{key:"unregisterMethod",value:function(b,m){var v=this||p.prototype;if(v._registeredMethods.hasOwnProperty(b)){for(var x=v._registeredMethods[b],w=[],S=0;S<x.length;S++)x[S]===m&&w.push(S);for(var k=w.length-1;0<=k;k--)x.splice(w[k],1)}}},{key:"_createFriendlyGlobalFunctionBinder",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},m=b.globalObject||window;return b.log||console.log.bind(console),function(v,x){p.disableFriendlyErrors,m[v]=x}}}])&&f(y.prototype,g),p}();for(h in d.instance=null,d.disableFriendlyErrors=!1,c)d.prototype[h]=c[h];d.VERSION=c.VERSION,d.prototype._preloadMethods={loadJSON:d.prototype,loadImage:d.prototype,loadStrings:d.prototype,loadXML:d.prototype,loadBytes:d.prototype,loadTable:d.prototype,loadFont:d.prototype,loadModel:d.prototype,loadShader:d.prototype},d.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},d.prototype._registeredPreloadMethods={},a.default=d},{"./constants":269,"./shim":291,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-own-property-names":184,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],281:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("./main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}i.default.Element=function(){function c(d,p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.elt=d,this._pInst=this._pixelsState=p,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight}var u,f,h;return u=c,h=[{key:"_adjustListener",value:function(d,p,y){return p===!1?i.default.Element._detachListener(d,y):i.default.Element._attachListener(d,p,y),this}},{key:"_attachListener",value:function(d,p,y){y._events[d]&&i.default.Element._detachListener(d,y),p=p.bind(y),y.elt.addEventListener(d,p,!1),y._events[d]=p}},{key:"_detachListener",value:function(d,p){var y=p._events[d];p.elt.removeEventListener(d,y,!1),p._events[d]=null}}],(f=[{key:"parent",value:function(d){return d===void 0?this.elt.parentNode:(typeof d=="string"?(d[0]==="#"&&(d=d.substring(1)),d=document.getElementById(d)):d instanceof i.default.Element&&(d=d.elt),d.appendChild(this.elt),this)}},{key:"id",value:function(d){return d===void 0?this.elt.id:(this.elt.id=d,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)}},{key:"class",value:function(d){return d===void 0?this.elt.className:(this.elt.className=d,this)}},{key:"mousePressed",value:function(d){return i.default.Element._adjustListener("mousedown",function(p){return this._pInst._setProperty("mouseIsPressed",!0),this._pInst._setMouseButton(p),d.call(this,p)},this),this}},{key:"doubleClicked",value:function(d){return i.default.Element._adjustListener("dblclick",d,this),this}},{key:"mouseWheel",value:function(d){return i.default.Element._adjustListener("wheel",d,this),this}},{key:"mouseReleased",value:function(d){return i.default.Element._adjustListener("mouseup",d,this),this}},{key:"mouseClicked",value:function(d){return i.default.Element._adjustListener("click",d,this),this}},{key:"mouseMoved",value:function(d){return i.default.Element._adjustListener("mousemove",d,this),this}},{key:"mouseOver",value:function(d){return i.default.Element._adjustListener("mouseover",d,this),this}},{key:"mouseOut",value:function(d){return i.default.Element._adjustListener("mouseout",d,this),this}},{key:"touchStarted",value:function(d){return i.default.Element._adjustListener("touchstart",d,this),this}},{key:"touchMoved",value:function(d){return i.default.Element._adjustListener("touchmove",d,this),this}},{key:"touchEnded",value:function(d){return i.default.Element._adjustListener("touchend",d,this),this}},{key:"dragOver",value:function(d){return i.default.Element._adjustListener("dragover",d,this),this}},{key:"dragLeave",value:function(d){return i.default.Element._adjustListener("dragleave",d,this),this}},{key:"_setProperty",value:function(d,p){this[d]=p}}])&&l(u.prototype,f),h&&l(u,h),c}(),r=i.default.Element,a.default=r},{"./main":280}],282:[function(r,s,a){function i(v){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function l(v){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(x){return i(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":i(x)})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.get-prototype-of"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(m=r("./main"))&&m.__esModule?m:{default:m},u=function(v){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var x=f();if(x&&x.has(v))return x.get(v);var w,S={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in v){var _;Object.prototype.hasOwnProperty.call(v,w)&&((_=k?Object.getOwnPropertyDescriptor(v,w):null)&&(_.get||_.set)?Object.defineProperty(S,w,_):S[w]=v[w])}return S.default=v,x&&x.set(v,S),S}(r("./constants"));function f(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,f=function(){return v},v)}function h(v,x){for(var w=0;w<x.length;w++){var S=x[w];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}function d(v,x){return(d=Object.setPrototypeOf||function(w,S){return w.__proto__=S,w})(v,x)}function p(v){return function(){var x,w=b(v);return y(this,function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(x=b(this).constructor,Reflect.construct(w,arguments,x)):w.apply(this,arguments))}}function y(v,x){return!x||l(x)!=="object"&&typeof x!="function"?g(v):x}function g(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function b(v){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}c.default.Graphics=function(v){var x=S;if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(v&&v.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),v&&d(x,v);var w=p(S);function S(k,_,F,P,A){var I;if(!(this instanceof S))throw new TypeError("Cannot call a class as a function");O=A||document.createElement("canvas"),(I=w.call(this,O,P)).canvas=O;var N,O=F||u.P2D,F=P._userNode||document.body;for(N in A||F.appendChild(I.canvas),c.default.prototype)I[N]||(typeof c.default.prototype[N]=="function"?I[N]=c.default.prototype[N].bind(g(I)):I[N]=c.default.prototype[N]);return c.default.prototype._initializeInstanceVariables.apply(g(I)),I.width=k,I.height=_,I._pixelDensity=P._pixelDensity,O===u.WEBGL?I._renderer=new c.default.RendererGL(I.canvas,g(I),!1):I._renderer=new c.default.Renderer2D(I.canvas,g(I),!1),P._elements.push(g(I)),Object.defineProperty(g(I),"deltaTime",{get:function(){return this._pInst.deltaTime}}),I._renderer.resize(k,_),I._renderer._applyDefaults(),y(I,g(I))}return x=S,(v=[{key:"reset",value:function(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()}},{key:"remove",value:function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);var k,_=this._pInst._elements.indexOf(this);for(k in _!==-1&&this._pInst._elements.splice(_,1),this._events)this.elt.removeEventListener(k,this._events[k])}},{key:"createFramebuffer",value:function(k){return new c.default.Framebuffer(this,k)}}])&&h(x.prototype,v),S}(c.default.Element);var m=c.default.Graphics;a.default=m},{"./constants":269,"./main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],283:[function(r,s,a){function i(v){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(b=r("./main"))&&b.__esModule?b:{default:b},c=function(v){if(v&&v.__esModule)return v;if(v===null||f(v)!=="object"&&typeof v!="function")return{default:v};var x=u();if(x&&x.has(v))return x.get(v);var w,S={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in v){var _;Object.prototype.hasOwnProperty.call(v,w)&&((_=k?Object.getOwnPropertyDescriptor(v,w):null)&&(_.get||_.set)?Object.defineProperty(S,w,_):S[w]=v[w])}return S.default=v,x&&x.set(v,S),S}(r("../core/constants"));function u(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,u=function(){return v},v)}function f(v){return(f=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(x){return i(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":i(x)})(v)}function h(v,x){for(var w=0;w<x.length;w++){var S=x[w];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}function d(v,x){return(d=Object.setPrototypeOf||function(w,S){return w.__proto__=S,w})(v,x)}function p(v){return function(){var x,w,S=g(v);return x=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(x=g(this).constructor,Reflect.construct(S,arguments,x)):S.apply(this,arguments),S=this,!(w=x)||f(w)!=="object"&&typeof w!="function"?y(S):w}}function y(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function g(v){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}var b=function(v){var x=S;if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(v&&v.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),v&&d(x,v);var w=p(S);function S(k,_,C){var P;if(this instanceof S)return(P=w.call(this,k,_)).canvas=k,P._pixelsState=_,C?(P._isMainCanvas=!0,P._pInst._setProperty("_curElement",y(P)),P._pInst._setProperty("canvas",P.canvas),P._pInst._setProperty("width",P.width),P._pInst._setProperty("height",P.height)):(P.canvas.style.display="none",P._styles=[]),P._clipping=!1,P._clipInvert=!1,P._textSize=12,P._textLeading=15,P._textFont="sans-serif",P._textStyle=c.NORMAL,P._textAscent=null,P._textDescent=null,P._textAlign=c.LEFT,P._textBaseline=c.BASELINE,P._textWrap=c.WORD,P._rectMode=c.CORNER,P._ellipseMode=c.CENTER,P._curveTightness=0,P._imageMode=c.CORNER,P._tint=null,P._doStroke=!0,P._doFill=!0,P._strokeSet=!1,P._fillSet=!1,P._leadingSet=!1,P._pushPopDepth=0,P;throw new TypeError("Cannot call a class as a function")}return x=S,(v=[{key:"push",value:function(){return this._pushPopDepth++,{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}}},{key:"pop",value:function(k){this._pushPopDepth--,k.properties&&Object.assign(this,k.properties)}},{key:"beginClip",value:function(){var k=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};if(this._clipping)throw new Error("It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?");this._clipping=!0,this._clipInvert=k.invert}},{key:"endClip",value:function(){if(!this._clipping)throw new Error("It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?");this._clipping=!1}},{key:"resize",value:function(k,_){this.width=k,this.height=_,this.elt.width=k*this._pInst._pixelDensity,this.elt.height=_*this._pInst._pixelDensity,this.elt.style.width="".concat(k,"px"),this.elt.style.height="".concat(_,"px"),this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))}},{key:"get",value:function(k,_,C,P){var A=this._pixelsState,I=A._pixelDensity,N=this.canvas;if(k===void 0&&_===void 0)k=_=0,C=A.width,P=A.height;else if(k*=I,_*=I,C===void 0&&P===void 0)return k<0||_<0||k>=N.width||_>=N.height?[0,0,0,0]:this._getPixel(k,_);return A=new l.default.Image(C*I,P*I),A.pixelDensity(I),A.canvas.getContext("2d").drawImage(N,k,_,C*I,P*I,0,0,C*I,P*I),A}},{key:"textLeading",value:function(k){return typeof k=="number"?(this._setProperty("_leadingSet",!0),this._setProperty("_textLeading",k),this._pInst):this._textLeading}},{key:"textStyle",value:function(k){return k?(k!==c.NORMAL&&k!==c.ITALIC&&k!==c.BOLD&&k!==c.BOLDITALIC||this._setProperty("_textStyle",k),this._applyTextProperties()):this._textStyle}},{key:"textAscent",value:function(){return this._textAscent===null&&this._updateTextMetrics(),this._textAscent}},{key:"textDescent",value:function(){return this._textDescent===null&&this._updateTextMetrics(),this._textDescent}},{key:"textAlign",value:function(k,_){return k!==void 0?(this._setProperty("_textAlign",k),_!==void 0&&this._setProperty("_textBaseline",_),this._applyTextProperties()):{horizontal:this._textAlign,vertical:this._textBaseline}}},{key:"textWrap",value:function(k){return this._setProperty("_textWrap",k),this._textWrap}},{key:"text",value:function(k,_,C,P,A){var I,N,O,F,U=this._pInst,G=this._textWrap,Y=Number.MAX_VALUE,$=C;if((this._doFill||this._doStroke)&&k!==void 0){if(I=(k=(k=typeof k!="string"?k.toString():k).replace(/(\t)/g,"  ")).split(`
`),P!==void 0){switch(this._rectMode===c.CENTER&&(_-=P/2),this._textAlign){case c.CENTER:_+=P/2;break;case c.RIGHT:_+=P}if(A!==void 0){this._rectMode===c.CENTER&&(C-=A/2,$-=A/2);var k=C,H=U.textAscent();switch(this._textBaseline){case c.BOTTOM:F=C+A,C=Math.max(F,C),$+=H;break;case c.CENTER:F=C+A/2,C=Math.max(F,C),$+=H/2}Y=C+A-H,this._textBaseline===c.CENTER&&(Y=k+A-H/2)}else this._textBaseline!==c.BOTTOM&&this._textBaseline!==c.CENTER||($=C-(k=U.textSize()*this._textLeading)/2,Y=C+k/2);if(G===c.WORD){for(var Q=[],J=0;J<I.length;J++){for(var ae="",T=I[J].split(" "),B=0;B<T.length;B++)N="".concat(ae+T[B])+" ",ae=P<(O=this.textWidth(N))&&0<ae.length?(Q.push(ae),"".concat(T[B])+" "):N;Q.push(ae)}var W=0;this._textBaseline===c.CENTER?W=(Q.length-1)*U.textLeading()/2:this._textBaseline===c.BOTTOM&&(W=(Q.length-1)*U.textLeading());for(var K=0;K<I.length;K++){ae="",T=I[K].split(" ");for(var te=0;te<T.length;te++)N="".concat(ae+T[te])+" ",P<(O=this.textWidth(N))&&0<ae.length?(this._renderText(U,ae.trim(),_,C-W,Y,$),ae="".concat(T[te])+" ",C+=U.textLeading()):ae=N;this._renderText(U,ae.trim(),_,C-W,Y,$),C+=U.textLeading()}}else{for(var ne=[],ce=0;ce<I.length;ce++)for(var fe=I[ce].split(ae=""),ue=0;ue<fe.length;ue++)N="".concat(ae+fe[ue]),(O=this.textWidth(N))<=P?ae+=fe[ue]:P<O&&0<ae.length&&(ne.push(ae),ae="".concat(fe[ue]));ne.push(ae);var ge=0;this._textBaseline===c.CENTER?ge=(ne.length-1)*U.textLeading()/2:this._textBaseline===c.BOTTOM&&(ge=(ne.length-1)*U.textLeading());for(var me=0;me<I.length;me++){fe=I[me].split(ae="");for(var oe=0;oe<fe.length;oe++)N="".concat(ae+fe[oe]),(O=this.textWidth(N))<=P?ae+=fe[oe]:P<O&&0<ae.length&&(this._renderText(U,ae.trim(),_,C-ge,Y,$),C+=U.textLeading(),ae="".concat(fe[oe]))}this._renderText(U,ae.trim(),_,C-ge,Y,$),C+=U.textLeading()}}else{var de=0;this._textBaseline===c.CENTER?de=(I.length-1)*U.textLeading()/2:this._textBaseline===c.BOTTOM&&(de=(I.length-1)*U.textLeading());for(var xe=0;xe<I.length;xe++)this._renderText(U,I[xe],_,C-de,Y,$-de),C+=U.textLeading()}return U}}},{key:"_applyDefaults",value:function(){return this}},{key:"_isOpenType",value:function(){var k=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this._textFont;return f(k)==="object"&&k.font&&k.font.supported}},{key:"_updateTextMetrics",value:function(){var k,_,C,P,A,I;return this._isOpenType()?(this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent())):((k=document.createElement("span")).style.fontFamily=this._textFont,k.style.fontSize="".concat(this._textSize,"px"),k.innerHTML="ABCjgq|",(I=document.createElement("div")).style.display="inline-block",I.style.width="1px",I.style.height="0px",P=((_=document.createElement("div")).appendChild(k),_.appendChild(I),_.style.height="0px",_.style.overflow="hidden",document.body.appendChild(_),I.style.verticalAlign="baseline",m(I)),A=m(k),C=P[1]-A[1],P=(I.style.verticalAlign="bottom",m(I)),A=m(k),I=P[1]-A[1]-C,document.body.removeChild(_),this._setProperty("_textAscent",C),this._setProperty("_textDescent",I)),this}}])&&h(x.prototype,v),S}(l.default.Element);function m(v){var x=0,w=0;if(v.offsetParent)for(;x+=v.offsetLeft,w+=v.offsetTop,v=v.offsetParent;);else x+=v.offsetLeft,w+=v.offsetTop;return[x,w]}b.prototype.textSize=function(v){return typeof v=="number"?(this._setProperty("_textSize",v),this._leadingSet||this._setProperty("_textLeading",v*c._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},l.default.Renderer=b,r=l.default.Renderer,a.default=r},{"../core/constants":269,"./main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],284:[function(v,s,a){function i(x){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(x)}function l(x){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(w){return i(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":i(w)})(x)}v("core-js/modules/es.symbol"),v("core-js/modules/es.symbol.description"),v("core-js/modules/es.symbol.iterator"),v("core-js/modules/es.array.concat"),v("core-js/modules/es.array.fill"),v("core-js/modules/es.array.for-each"),v("core-js/modules/es.array.iterator"),v("core-js/modules/es.array.join"),v("core-js/modules/es.array.slice"),v("core-js/modules/es.function.name"),v("core-js/modules/es.number.to-fixed"),v("core-js/modules/es.object.get-own-property-descriptor"),v("core-js/modules/es.object.get-prototype-of"),v("core-js/modules/es.object.to-string"),v("core-js/modules/es.reflect.construct"),v("core-js/modules/es.reflect.get"),v("core-js/modules/es.regexp.to-string"),v("core-js/modules/es.string.iterator"),v("core-js/modules/es.weak-map"),v("core-js/modules/web.dom-collections.iterator"),v("core-js/modules/es.array.concat"),v("core-js/modules/es.array.fill"),v("core-js/modules/es.array.for-each"),v("core-js/modules/es.array.join"),v("core-js/modules/es.array.slice"),v("core-js/modules/es.function.name"),v("core-js/modules/es.number.to-fixed"),v("core-js/modules/es.object.get-prototype-of"),v("core-js/modules/es.object.to-string"),v("core-js/modules/es.regexp.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(m=v("./main"))&&m.__esModule?m:{default:m},u=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var w=f();if(w&&w.has(x))return w.get(x);var S,k={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in x){var C;Object.prototype.hasOwnProperty.call(x,S)&&((C=_?Object.getOwnPropertyDescriptor(x,S):null)&&(C.get||C.set)?Object.defineProperty(k,S,C):k[S]=x[S])}return k.default=x,w&&w.set(x,k),k}(v("./constants"));function f(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,f=function(){return x},x)}function h(x,w){for(var S=0;S<w.length;S++){var k=w[S];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}function d(x,w,S){return(d=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(P,_,C){var P=function(A,I){for(;!Object.prototype.hasOwnProperty.call(A,I)&&(A=g(A))!==null;);return A}(P,_);if(P)return(P=Object.getOwnPropertyDescriptor(P,_)).get?P.get.call(C):P.value})(x,w,S||x)}function p(x,w){return(p=Object.setPrototypeOf||function(S,k){return S.__proto__=k,S})(x,w)}function y(x){return function(){var w,S=g(x),S=(w=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(w=g(this).constructor,Reflect.construct(S,arguments,w)):S.apply(this,arguments),this);if(!w||l(w)!=="object"&&typeof w!="function"){if(S!==void 0)return S;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return w}}function g(x){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(x)}v("./p5.Renderer");var b="rgba(0,0,0,0)",m=function(x){var w=k;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(x&&x.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),x&&p(w,x);var S=y(k);function k(_,C,P){if(this instanceof k)return(_=S.call(this,_,C,P)).drawingContext=_.canvas.getContext("2d"),_._pInst._setProperty("drawingContext",_.drawingContext),_;throw new TypeError("Cannot call a class as a function")}return w=k,(x=[{key:"getFilterGraphicsLayer",value:function(){var _;return this.filterGraphicsLayer||(_=(this._pInst instanceof c.default.Graphics?this._pInst:this)._pInst,this.filterGraphicsLayer=new c.default.Graphics(this.width,this.height,u.WEBGL,_)),this.filterGraphicsLayer.width===this.width&&this.filterGraphicsLayer.height===this.height||this.filterGraphicsLayer.resizeCanvas(this.width,this.height),this.filterGraphicsLayer.pixelDensity()!==this._pInst.pixelDensity()&&this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity()),this.filterGraphicsLayer}},{key:"_applyDefaults",value:function(){this._cachedFillStyle=this._cachedStrokeStyle=void 0,this._cachedBlendMode=u.BLEND,this._setFill(u._DEFAULT_FILL),this._setStroke(u._DEFAULT_STROKE),this.drawingContext.lineCap=u.ROUND,this.drawingContext.font="normal 12px sans-serif"}},{key:"resize",value:function(_,C){d(g(k.prototype),"resize",this).call(this,_,C),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)}},{key:"background",value:function(){var _,C;this.drawingContext.save(),this.resetMatrix(),(arguments.length<=0?void 0:arguments[0])instanceof c.default.Image?0<=(arguments.length<=1?void 0:arguments[1])?(_=arguments.length<=0?void 0:arguments[0],this.drawingContext.globalAlpha=(arguments.length<=1?void 0:arguments[1])/255,this._pInst.image(_,0,0,this.width,this.height)):this._pInst.image(arguments.length<=0?void 0:arguments[0],0,0,this.width,this.height):(_=this._getFill(),C=(C=this._pInst).color.apply(C,arguments),this._pInst._addAccsOutput()&&this._pInst._accsBackground(C.levels),C=C.toString(),this._setFill(C),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(_),this._isErasing&&this._pInst.erase()),this.drawingContext.restore()}},{key:"clear",value:function(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()}},{key:"fill",value:function(){var _=(_=this._pInst).color.apply(_,arguments);this._setFill(_.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",_.levels)}},{key:"stroke",value:function(){var _=(_=this._pInst).color.apply(_,arguments);this._setStroke(_.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",_.levels)}},{key:"erase",value:function(_,C){this._isErasing||(this._cachedFillStyle=this.drawingContext.fillStyle,_=this._pInst.color(255,_).toString(),this.drawingContext.fillStyle=_,this._cachedStrokeStyle=this.drawingContext.strokeStyle,_=this._pInst.color(255,C).toString(),this.drawingContext.strokeStyle=_,C=this._cachedBlendMode,this.blendMode(u.REMOVE),this._cachedBlendMode=C,this._isErasing=!0)}},{key:"noErase",value:function(){this._isErasing&&(this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)}},{key:"beginClip",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},_=(d(g(k.prototype),"beginClip",this).call(this,_),this._cachedFillStyle=this.drawingContext.fillStyle,this._pInst.color(255,0).toString()),_=(this.drawingContext.fillStyle=_,this._cachedStrokeStyle=this.drawingContext.strokeStyle,this._pInst.color(255,0).toString()),_=(this.drawingContext.strokeStyle=_,this._cachedBlendMode);this.blendMode(u.BLEND),this._cachedBlendMode=_,this.drawingContext.beginPath(),this._clipInvert&&(this.drawingContext.moveTo(-2*this.width,-2*this.height),this.drawingContext.lineTo(-2*this.width,2*this.height),this.drawingContext.lineTo(2*this.width,2*this.height),this.drawingContext.lineTo(2*this.width,-2*this.height),this.drawingContext.closePath())}},{key:"endClip",value:function(){this._doFillStrokeClose(),this.drawingContext.clip(),d(g(k.prototype),"endClip",this).call(this),this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode)}},{key:"image",value:function(_,C,P,A,I,N,O,F,U){_.gifProperties&&_._animateGif(this._pInst);try{c.default.MediaElement&&_ instanceof c.default.MediaElement&&_._ensureCanvas();var G=(G=this._tint&&_.canvas?this._getTintedImageCanvas(_):G)||_.canvas||_.elt,Y=1;_.width&&0<_.width&&(Y=G.width/_.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(G,Y*C,Y*P,Y*A,Y*I,N,O,F,U),this._isErasing&&this._pInst.erase()}catch($){if($.name!=="NS_ERROR_NOT_AVAILABLE")throw $}}},{key:"_getTintedImageCanvas",value:function(_){if(!_.canvas)return _;_.tintCanvas||(_.tintCanvas=document.createElement("canvas")),_.tintCanvas.width!==_.canvas.width&&(_.tintCanvas.width=_.canvas.width),_.tintCanvas.height!==_.canvas.height&&(_.tintCanvas.height=_.canvas.height);var C=_.tintCanvas.getContext("2d");return C.save(),C.clearRect(0,0,_.canvas.width,_.canvas.height),(this._tint[0]<255||this._tint[1]<255||this._tint[2]<255)&&(C.drawImage(_.canvas,0,0),C.globalCompositeOperation="luminosity",C.drawImage(_.canvas,0,0),C.globalCompositeOperation="color",C.drawImage(_.canvas,0,0),C.globalCompositeOperation="multiply",C.fillStyle="rgb(".concat(this._tint.slice(0,3).join(", "),")"),C.fillRect(0,0,_.canvas.width,_.canvas.height),C.globalCompositeOperation="destination-in"),C.globalAlpha=this._tint[3]/255,C.drawImage(_.canvas,0,0),C.restore(),_.tintCanvas}},{key:"blendMode",value:function(_){if(_===u.SUBTRACT)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else{if(_!==u.BLEND&&_!==u.REMOVE&&_!==u.DARKEST&&_!==u.LIGHTEST&&_!==u.DIFFERENCE&&_!==u.MULTIPLY&&_!==u.EXCLUSION&&_!==u.SCREEN&&_!==u.REPLACE&&_!==u.OVERLAY&&_!==u.HARD_LIGHT&&_!==u.SOFT_LIGHT&&_!==u.DODGE&&_!==u.BURN&&_!==u.ADD)throw new Error("Mode ".concat(_," not recognized."));this._cachedBlendMode=_,this.drawingContext.globalCompositeOperation=_}}},{key:"blend",value:function(){for(var _=this.drawingContext.globalCompositeOperation,C=arguments.length,P=new Array(C),A=0;A<C;A++)P[A]=arguments[A];var I=P[P.length-1],N=Array.prototype.slice.call(P,0,P.length-1);this.drawingContext.globalCompositeOperation=I,c.default.prototype.copy.apply(this,N),this.drawingContext.globalCompositeOperation=_}},{key:"_getPixel",value:function(_,C){return _=this.drawingContext.getImageData(_,C,1,1).data,[_[0],_[1],_[2],_[3]]}},{key:"loadPixels",value:function(){var _=this._pixelsState,C=_._pixelDensity,P=this.width*C,C=this.height*C,P=this.drawingContext.getImageData(0,0,P,C);_._setProperty("imageData",P),_._setProperty("pixels",P.data)}},{key:"set",value:function(_,C,P){_=Math.floor(_),C=Math.floor(C);var A=this._pixelsState;if(P instanceof c.default.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(A._pixelDensity,A._pixelDensity),this.drawingContext.clearRect(_,C,P.width,P.height),this.drawingContext.drawImage(P.canvas,_,C),this.drawingContext.restore();else{var I=0,N=0,O=0,F=0,U=4*(C*A._pixelDensity*(this.width*A._pixelDensity)+_*A._pixelDensity);if(A.imageData||A.loadPixels(),typeof P=="number")U<A.pixels.length&&(O=N=I=P,F=255);else if(Array.isArray(P)){if(P.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");U<A.pixels.length&&(I=P[0],N=P[1],O=P[2],F=P[3])}else P instanceof c.default.Color&&U<A.pixels.length&&(I=P.levels[0],N=P.levels[1],O=P.levels[2],F=P.levels[3]);for(var G=0;G<A._pixelDensity;G++)for(var Y=0;Y<A._pixelDensity;Y++)U=4*((C*A._pixelDensity+Y)*this.width*A._pixelDensity+(_*A._pixelDensity+G)),A.pixels[U]=I,A.pixels[U+1]=N,A.pixels[U+2]=O,A.pixels[U+3]=F}}},{key:"updatePixels",value:function(_,C,P,A){var I=this._pixelsState,N=I._pixelDensity;_===void 0&&C===void 0&&P===void 0&&A===void 0&&(C=_=0,P=this.width,A=this.height),_*=N,C*=N,P*=N,A*=N,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=I.imageData),this.drawingContext.putImageData(I.imageData,_,C,0,0,P,A)}},{key:"_acuteArcToBezier",value:function(_,C){var N=C/2,P=Math.cos(N),F=Math.sin(N),A=1/Math.tan(N),N=_+N,I=Math.cos(N),N=Math.sin(N),O=(4-P)/3,F=F+(P-O)*A;return{ax:Math.cos(_).toFixed(7),ay:Math.sin(_).toFixed(7),bx:(O*I+F*N).toFixed(7),by:(O*N-F*I).toFixed(7),cx:(O*I-F*N).toFixed(7),cy:(O*N+F*I).toFixed(7),dx:Math.cos(_+C).toFixed(7),dy:Math.sin(_+C).toFixed(7)}}},{key:"arc",value:function(_,C,P,A,I,N,O){var F,U=this.drawingContext,G=P/2,Y=A/2,$=[];for(_+=G,C+=Y;1e-5<=N-I;)F=Math.min(N-I,u.HALF_PI),$.push(this._acuteArcToBezier(I,F)),I+=F;return this._doFill&&(this._clipping||U.beginPath(),$.forEach(function(H,Q){Q===0&&U.moveTo(_+H.ax*G,C+H.ay*Y),U.bezierCurveTo(_+H.bx*G,C+H.by*Y,_+H.cx*G,C+H.cy*Y,_+H.dx*G,C+H.dy*Y)}),O!==u.PIE&&O!=null||U.lineTo(_,C),U.closePath(),this._clipping||U.fill()),this._doStroke&&(this._clipping||U.beginPath(),$.forEach(function(H,Q){Q===0&&U.moveTo(_+H.ax*G,C+H.ay*Y),U.bezierCurveTo(_+H.bx*G,C+H.by*Y,_+H.cx*G,C+H.cy*Y,_+H.dx*G,C+H.dy*Y)}),O===u.PIE?(U.lineTo(_,C),U.closePath()):O===u.CHORD&&U.closePath(),this._clipping||U.stroke()),this}},{key:"ellipse",value:function(F){var C=this.drawingContext,P=this._doFill,A=this._doStroke,I=parseFloat(F[0]),N=parseFloat(F[1]),O=parseFloat(F[2]),F=parseFloat(F[3]);if(P&&!A){if(this._getFill()===b)return this}else if(!P&&A&&this._getStroke()===b)return this;I+=O/2,N+=F/2,O/=2,F/=2,this._clipping||C.beginPath(),C.ellipse(I,N,O,F,0,0,2*Math.PI),!this._clipping&&P&&C.fill(),!this._clipping&&A&&C.stroke()}},{key:"line",value:function(_,C,P,A){var I=this.drawingContext;return this._doStroke&&this._getStroke()!==b&&(this._clipping||I.beginPath(),I.moveTo(_,C),I.lineTo(P,A),I.stroke()),this}},{key:"point",value:function(_,C){var P,A,I=this.drawingContext;return!this._doStroke||this._getStroke()===b?this:(P=this._getStroke(),A=this._getFill(),this._clipping||this._setFill(P),this._clipping||I.beginPath(),I.arc(_,C,I.lineWidth/2,0,u.TWO_PI,!1),void(this._clipping||(I.fill(),this._setFill(A))))}},{key:"quad",value:function(_,C,P,A,I,N,O,F){var U=this.drawingContext,G=this._doFill,Y=this._doStroke;if(G&&!Y){if(this._getFill()===b)return this}else if(!G&&Y&&this._getStroke()===b)return this;return this._clipping||U.beginPath(),U.moveTo(_,C),U.lineTo(P,A),U.lineTo(I,N),U.lineTo(O,F),U.closePath(),!this._clipping&&G&&U.fill(),!this._clipping&&Y&&U.stroke(),this}},{key:"rect",value:function(Y){var C,P,A=Y[0],I=Y[1],N=Y[2],O=Y[3],F=Y[4],U=Y[5],G=Y[6],Y=Y[7],$=this.drawingContext,H=this._doFill,Q=this._doStroke;if(H&&!Q){if(this._getFill()===b)return this}else if(!H&&Q&&this._getStroke()===b)return this;return this._clipping||$.beginPath(),F===void 0?$.rect(A,I,N,O):(U===void 0&&(U=F),G===void 0&&(G=U),Y===void 0&&(Y=G),Q=(H=Math.abs(N))/2,P=(C=Math.abs(O))/2,C<2*(F=H<2*F?Q:F)&&(F=P),C<2*(U=H<2*U?Q:U)&&(U=P),C<2*(G=H<2*G?Q:G)&&(G=P),C<2*(Y=H<2*Y?Q:Y)&&(Y=P),this._clipping||$.beginPath(),$.moveTo(A+F,I),$.arcTo(A+N,I,A+N,I+O,U),$.arcTo(A+N,I+O,A,I+O,G),$.arcTo(A,I+O,A,I,Y),$.arcTo(A,I,A+N,I,F),$.closePath()),!this._clipping&&this._doFill&&$.fill(),!this._clipping&&this._doStroke&&$.stroke(),this}},{key:"triangle",value:function(G){var C=this.drawingContext,P=this._doFill,A=this._doStroke,I=G[0],N=G[1],O=G[2],F=G[3],U=G[4],G=G[5];if(P&&!A){if(this._getFill()===b)return this}else if(!P&&A&&this._getStroke()===b)return this;this._clipping||C.beginPath(),C.moveTo(I,N),C.lineTo(O,F),C.lineTo(U,G),C.closePath(),!this._clipping&&P&&C.fill(),!this._clipping&&A&&C.stroke()}},{key:"endShape",value:function(_,C,P,A,I,N,O){if(C.length!==0&&(this._doStroke||this._doFill)){var F,U,G,Y=_===u.CLOSE,$=(Y&&!N&&C.push(C[0]),C.length);if(P&&O===null){if(3<$){var H=[],Q=1-this._curveTightness;for(this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(C[1][0],C[1][1]),U=1;U+2<$;U++)F=C[U],H[0]=[F[0],F[1]],H[1]=[F[0]+(Q*C[U+1][0]-Q*C[U-1][0])/6,F[1]+(Q*C[U+1][1]-Q*C[U-1][1])/6],H[2]=[C[U+1][0]+(Q*C[U][0]-Q*C[U+2][0])/6,C[U+1][1]+(Q*C[U][1]-Q*C[U+2][1])/6],H[3]=[C[U+1][0],C[U+1][1]],this.drawingContext.bezierCurveTo(H[1][0],H[1][1],H[2][0],H[2][1],H[3][0],H[3][1]);Y&&this.drawingContext.lineTo(C[U+1][0],C[U+1][1]),this._doFillStrokeClose(Y)}}else if(A&&O===null){for(this._clipping||this.drawingContext.beginPath(),U=0;U<$;U++)C[U].isVert?C[U].moveTo?this.drawingContext.moveTo(C[U][0],C[U][1]):this.drawingContext.lineTo(C[U][0],C[U][1]):this.drawingContext.bezierCurveTo(C[U][0],C[U][1],C[U][2],C[U][3],C[U][4],C[U][5]);this._doFillStrokeClose(Y)}else if(I&&O===null){for(this._clipping||this.drawingContext.beginPath(),U=0;U<$;U++)C[U].isVert?C[U].moveTo?this.drawingContext.moveTo(C[U][0],C[U][1]):this.drawingContext.lineTo(C[U][0],C[U][1]):this.drawingContext.quadraticCurveTo(C[U][0],C[U][1],C[U][2],C[U][3]);this._doFillStrokeClose(Y)}else if(O===u.POINTS)for(U=0;U<$;U++)F=C[U],this._doStroke&&this._pInst.stroke(F[6]),this._pInst.point(F[0],F[1]);else if(O===u.LINES)for(U=0;U+1<$;U+=2)F=C[U],this._doStroke&&this._pInst.stroke(C[U+1][6]),this._pInst.line(F[0],F[1],C[U+1][0],C[U+1][1]);else if(O===u.TRIANGLES)for(U=0;U+2<$;U+=3)F=C[U],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(F[0],F[1]),this.drawingContext.lineTo(C[U+1][0],C[U+1][1]),this.drawingContext.lineTo(C[U+2][0],C[U+2][1]),this.drawingContext.closePath(),!this._clipping&&this._doFill&&(this._pInst.fill(C[U+2][5]),this.drawingContext.fill()),!this._clipping&&this._doStroke&&(this._pInst.stroke(C[U+2][6]),this.drawingContext.stroke());else if(O===u.TRIANGLE_STRIP)for(U=0;U+1<$;U++)F=C[U],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(C[U+1][0],C[U+1][1]),this.drawingContext.lineTo(F[0],F[1]),!this._clipping&&this._doStroke&&this._pInst.stroke(C[U+1][6]),!this._clipping&&this._doFill&&this._pInst.fill(C[U+1][5]),U+2<$&&(this.drawingContext.lineTo(C[U+2][0],C[U+2][1]),!this._clipping&&this._doStroke&&this._pInst.stroke(C[U+2][6]),!this._clipping&&this._doFill&&this._pInst.fill(C[U+2][5])),this._doFillStrokeClose(Y);else if(O===u.TRIANGLE_FAN){if(2<$){for(this._clipping||this.drawingContext.beginPath(),U=2;U<$;U++)F=C[U],this.drawingContext.moveTo(C[0][0],C[0][1]),this.drawingContext.lineTo(C[U-1][0],C[U-1][1]),this.drawingContext.lineTo(F[0],F[1]),this.drawingContext.lineTo(C[0][0],C[0][1]),U<$-1&&(this._doFill&&F[5]!==C[U+1][5]||this._doStroke&&F[6]!==C[U+1][6])&&(!this._clipping&&this._doFill&&(this._pInst.fill(F[5]),this.drawingContext.fill(),this._pInst.fill(C[U+1][5])),!this._clipping&&this._doStroke&&(this._pInst.stroke(F[6]),this.drawingContext.stroke(),this._pInst.stroke(C[U+1][6])),this.drawingContext.closePath(),this._clipping||this.drawingContext.beginPath());this._doFillStrokeClose(Y)}}else if(O===u.QUADS)for(U=0;U+3<$;U+=4){for(F=C[U],this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(F[0],F[1]),G=1;G<4;G++)this.drawingContext.lineTo(C[U+G][0],C[U+G][1]);this.drawingContext.lineTo(F[0],F[1]),!this._clipping&&this._doFill&&this._pInst.fill(C[U+3][5]),!this._clipping&&this._doStroke&&this._pInst.stroke(C[U+3][6]),this._doFillStrokeClose(Y)}else if(O===u.QUAD_STRIP){if(3<$)for(U=0;U+1<$;U+=2)F=C[U],this._clipping||this.drawingContext.beginPath(),U+3<$?(this.drawingContext.moveTo(C[U+2][0],C[U+2][1]),this.drawingContext.lineTo(F[0],F[1]),this.drawingContext.lineTo(C[U+1][0],C[U+1][1]),this.drawingContext.lineTo(C[U+3][0],C[U+3][1]),!this._clipping&&this._doFill&&this._pInst.fill(C[U+3][5]),!this._clipping&&this._doStroke&&this._pInst.stroke(C[U+3][6])):(this.drawingContext.moveTo(F[0],F[1]),this.drawingContext.lineTo(C[U+1][0],C[U+1][1])),this._doFillStrokeClose(Y)}else{for(this._clipping||this.drawingContext.beginPath(),this.drawingContext.moveTo(C[0][0],C[0][1]),U=1;U<$;U++)(F=C[U]).isVert&&(F.moveTo?(Y&&this.drawingContext.closePath(),this.drawingContext.moveTo(F[0],F[1])):this.drawingContext.lineTo(F[0],F[1]));this._doFillStrokeClose(Y)}N=I=A=P=!1,Y&&C.pop()}return this}},{key:"strokeCap",value:function(_){return _!==u.ROUND&&_!==u.SQUARE&&_!==u.PROJECT||(this.drawingContext.lineCap=_),this}},{key:"strokeJoin",value:function(_){return _!==u.ROUND&&_!==u.BEVEL&&_!==u.MITER||(this.drawingContext.lineJoin=_),this}},{key:"strokeWeight",value:function(_){return this.drawingContext.lineWidth=_===void 0||_===0?1e-4:_,this}},{key:"_getFill",value:function(){return this._cachedFillStyle||(this._cachedFillStyle=this.drawingContext.fillStyle),this._cachedFillStyle}},{key:"_setFill",value:function(_){_!==this._cachedFillStyle&&(this.drawingContext.fillStyle=_,this._cachedFillStyle=_)}},{key:"_getStroke",value:function(){return this._cachedStrokeStyle||(this._cachedStrokeStyle=this.drawingContext.strokeStyle),this._cachedStrokeStyle}},{key:"_setStroke",value:function(_){_!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=_,this._cachedStrokeStyle=_)}},{key:"bezier",value:function(_,C,P,A,I,N,O,F){return this._pInst.beginShape(),this._pInst.vertex(_,C),this._pInst.bezierVertex(P,A,I,N,O,F),this._pInst.endShape(),this}},{key:"curve",value:function(_,C,P,A,I,N,O,F){return this._pInst.beginShape(),this._pInst.curveVertex(_,C),this._pInst.curveVertex(P,A),this._pInst.curveVertex(I,N),this._pInst.curveVertex(O,F),this._pInst.endShape(),this}},{key:"_doFillStrokeClose",value:function(_){_&&this.drawingContext.closePath(),!this._clipping&&this._doFill&&this.drawingContext.fill(),!this._clipping&&this._doStroke&&this.drawingContext.stroke()}},{key:"applyMatrix",value:function(_,C,P,A,I,N){this.drawingContext.transform(_,C,P,A,I,N)}},{key:"resetMatrix",value:function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this}},{key:"rotate",value:function(_){this.drawingContext.rotate(_)}},{key:"scale",value:function(_,C){return this.drawingContext.scale(_,C),this}},{key:"translate",value:function(_,C){return _ instanceof c.default.Vector&&(C=_.y,_=_.x),this.drawingContext.translate(_,C),this}},{key:"_renderText",value:function(_,C,P,A,I,N){if(!(A<N||I<=A))return _.push(),this._isOpenType()?this._textFont._renderPath(C,P,A,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(C,P,A),!this._clipping&&this._doFill&&(this._fillSet||this._setFill(u._DEFAULT_TEXT_FILL),this.drawingContext.fillText(C,P,A))),_.pop(),_}},{key:"textWidth",value:function(_){return this._isOpenType()?this._textFont._textWidth(_,this._textSize):this.drawingContext.measureText(_).width}},{key:"_applyTextProperties",value:function(){var _,C=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),_=this._textFont,this._isOpenType()&&(_=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,'px "').concat(_||"sans-serif",'"'),this.drawingContext.textAlign=this._textAlign,this._textBaseline===u.CENTER?this.drawingContext.textBaseline=u._CTX_MIDDLE:this.drawingContext.textBaseline=this._textBaseline,C}},{key:"push",value:function(){return this.drawingContext.save(),d(g(k.prototype),"push",this).call(this)}},{key:"pop",value:function(_){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle,d(g(k.prototype),"pop",this).call(this,_)}}])&&h(w.prototype,x),k}(c.default.Renderer),v=(m.prototype.text=function(x,w,S,P,_){P!==void 0&&this.drawingContext.textBaseline===u.BASELINE&&(C=!0,this.drawingContext.textBaseline=u.TOP);var C,P=c.default.Renderer.prototype.text.apply(this,arguments);return C&&(this.drawingContext.textBaseline=u.BASELINE),P},c.default.Renderer2D=m,c.default.Renderer2D);a.default=v},{"./constants":269,"./main":280,"./p5.Renderer":283,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.function.name":173,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],285:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var i=(r=r("./main"))&&r.__esModule?r:{default:r};i.default.prototype._promisePreloads=[];function l(){return{}}var c=!(i.default.prototype.registerPromisePreload=function(u){i.default.prototype._promisePreloads.push(u)});i.default.prototype._setupPromisePreloads=function(){var u=!0,f=!1,h=void 0;try{for(var d,p=this._promisePreloads[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var y=d.value,g=this,b=y.method,m=y.addCallbacks,v=y.legacyPreloadSetup,x=y.target||this,w=x[b].bind(x);if(x===i.default.prototype){if(c)continue;g=null,w=x[b]}x[b]=this._wrapPromisePreload(g,w,m),v&&(x[v.method]=this._legacyPreloadGenerator(g,v,x[b]))}}catch(S){f=!0,h=S}finally{try{u||p.return==null||p.return()}finally{if(f)throw h}}c=!0},i.default.prototype._wrapPromisePreload=function(u,f,h){var d=function(){for(var p=this,y=(this._incrementPreload(),null),g=null,b=arguments.length,m=new Array(b),v=0;v<b;v++)m[v]=arguments[v];if(h)for(var x=m.length-1;0<=x&&!g&&typeof m[x]=="function";x--)g=y,y=m.pop();var w=Promise.resolve(f.apply(this,m));return y&&w.then(y),g&&w.catch(g),w.then(function(){return p._decrementPreload()}),w};return d=u?d.bind(u):d},i.default.prototype._legacyPreloadGenerator=function(u,p,h){var d=p.createBaseObject||l,p=function(){var y=this;this._incrementPreload();for(var g=arguments.length,b=new Array(g),m=0;m<g;m++)b[m]=arguments[m];var v=d.apply(this,b);return h.apply(this,b).then(function(x){Object.assign(v,x),y._decrementPreload()}),v};return p=u?p.bind(u):p}},{"./main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],286:[function(r,s,a){function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(d=r("./main"))&&d.__esModule?d:{default:d},c=function(p){if(p&&p.__esModule)return p;if(p===null||f(p)!=="object"&&typeof p!="function")return{default:p};var y=u();if(y&&y.has(p))return y.get(p);var g,b={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=m?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,y&&y.set(p,b),b}(r("./constants"));function u(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,u=function(){return p},p)}function f(p){return(f=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(y){return i(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":i(y)})(p)}r("./p5.Graphics"),r("./p5.Renderer2D"),r("../webgl/p5.RendererGL");var h="defaultCanvas0",d=(l.default.prototype.createCanvas=function(p,y,g,b){var m,v,x;if(l.default._validateParameters("createCanvas",arguments),arguments[2]instanceof HTMLCanvasElement?(g=c.P2D,b=arguments[2]):m=g||c.P2D,b)(x=document.getElementById(h))&&x.parentNode.removeChild(x),x=b,this._defaultGraphicsCreated=!1;else{if(m===c.WEBGL)(x=document.getElementById(h))&&(x.parentNode.removeChild(x),v=this._renderer,this._elements=this._elements.filter(function(S){return S!==v})),(x=document.createElement("canvas")).id=h,x.classList.add("p5Canvas");else if(this._defaultGraphicsCreated)x=this.canvas;else{x=b||document.createElement("canvas");for(var w=0;document.getElementById("defaultCanvas".concat(w));)w++;h="defaultCanvas".concat(w),x.id=h,x.classList.add("p5Canvas")}this._setupDone||(x.dataset.hidden=!0,x.style.visibility="hidden"),(this._userNode||(document.getElementsByTagName("main").length===0&&(g=document.createElement("main"),document.body.appendChild(g)),document.getElementsByTagName("main")[0])).appendChild(x)}return m===c.WEBGL?(this._setProperty("_renderer",new l.default.RendererGL(x,this,!0)),this._elements.push(this._renderer)):this._defaultGraphicsCreated||(this._setProperty("_renderer",new l.default.Renderer2D(x,this,!0)),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer)),this._renderer.resize(p,y),this._renderer._applyDefaults(),this._renderer},l.default.prototype.resizeCanvas=function(p,y,g){if(l.default._validateParameters("resizeCanvas",arguments),this._renderer){var b,m,v={};for(b in this.drawingContext){var x=this.drawingContext[b];f(x)!=="object"&&typeof x!="function"&&(v[b]=x)}for(m in this.width=p,this.height=y,this._renderer.resize(p,y),v)try{this.drawingContext[m]=v[m]}catch{}g||this.redraw()}this._addAccsOutput()&&this._updateAccsOutput()},l.default.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},l.default.prototype.createGraphics=function(p,y){for(var g=arguments.length,b=new Array(2<g?g-2:0),m=2;m<g;m++)b[m-2]=arguments[m];return b[0]instanceof HTMLCanvasElement&&(b[1]=b[0],b[0]=c.P2D),l.default._validateParameters("createGraphics",arguments),new l.default.Graphics(p,y,b[0],this,b[1])},l.default.prototype.createFramebuffer=function(p){return new l.default.Framebuffer(this,p)},l.default.prototype.clearDepth=function(p){this._assert3d("clearDepth"),this._renderer.clearDepth(p)},l.default.prototype.blendMode=function(p){l.default._validateParameters("blendMode",arguments),p===c.NORMAL&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),p=c.BLEND),this._renderer.blendMode(p)},l.default);a.default=d},{"../webgl/p5.RendererGL":337,"./constants":269,"./main":280,"./p5.Graphics":282,"./p5.Renderer2D":284,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],287:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}function l(y){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.slice"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=d(r("../main")),u=function(y){if(y&&y.__esModule)return y;if(y===null||l(y)!=="object"&&typeof y!="function")return{default:y};var g=h();if(g&&g.has(y))return g.get(y);var b,m={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in y){var x;Object.prototype.hasOwnProperty.call(y,b)&&((x=v?Object.getOwnPropertyDescriptor(y,b):null)&&(x.get||x.set)?Object.defineProperty(m,b,x):m[b]=y[b])}return m.default=y,g&&g.set(y,m),m}(r("../constants")),f=d(r("../helpers"));function h(){var y;return typeof WeakMap!="function"?null:(y=new WeakMap,h=function(){return y},y)}function d(y){return y&&y.__esModule?y:{default:y}}function p(y){return function(g){if(Array.isArray(g)){for(var b=0,m=new Array(g.length);b<g.length;b++)m[b]=g[b];return m}}(y)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r("../friendly_errors/fes_core"),r("../friendly_errors/file_errors"),r("../friendly_errors/validate_params"),c.default.prototype._normalizeArcAngles=function(y,g,b,m,v){var x;return y-=u.TWO_PI*Math.floor(y/u.TWO_PI),g-=u.TWO_PI*Math.floor(g/u.TWO_PI),x=Math.min(Math.abs(y-g),u.TWO_PI-Math.abs(y-g)),v&&(y=y<=u.HALF_PI?Math.atan(b/m*Math.tan(y)):y>u.HALF_PI&&y<=3*u.HALF_PI?Math.atan(b/m*Math.tan(y))+u.PI:Math.atan(b/m*Math.tan(y))+u.TWO_PI,g=g<=u.HALF_PI?Math.atan(b/m*Math.tan(g)):g>u.HALF_PI&&g<=3*u.HALF_PI?Math.atan(b/m*Math.tan(g))+u.PI:Math.atan(b/m*Math.tan(g))+u.TWO_PI),g<y&&(g+=u.TWO_PI),{start:y,stop:g,correspondToSamePoint:x<1e-5}},c.default.prototype.arc=function(y,g,b,m,v,x,w,S){return c.default._validateParameters("arc",arguments),(this._renderer._doStroke||this._renderer._doFill)&&v!==x&&(v=this._toRadians(v),x=this._toRadians(x),b=Math.abs(b),m=Math.abs(m),y=f.default.modeAdjust(y,g,b,m,this._renderer._ellipseMode),(g=this._normalizeArcAngles(v,x,y.w,y.h,!0)).correspondToSamePoint?this._renderer.ellipse([y.x,y.y,y.w,y.h,S]):(this._renderer.arc(y.x,y.y,y.w,y.h,g.start,g.stop,w,S),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[y.x,y.y,y.w,y.h,g.start,g.stop,w]))),this},c.default.prototype.ellipse=function(y,g,b,m,v){return c.default._validateParameters("ellipse",arguments),this._renderEllipse.apply(this,arguments)},c.default.prototype.circle=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];c.default._validateParameters("circle",g);var m=g.slice(0,2);return m.push(g[2],g[2]),this._renderEllipse.apply(this,p(m))},c.default.prototype._renderEllipse=function(y,g,b,m,v){return(this._renderer._doStroke||this._renderer._doFill)&&(b<0&&(b=Math.abs(b)),m===void 0?m=b:m<0&&(m=Math.abs(m)),y=f.default.modeAdjust(y,g,b,m,this._renderer._ellipseMode),this._renderer.ellipse([y.x,y.y,y.w,y.h,v]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[y.x,y.y,y.w,y.h])),this},c.default.prototype.line=function(){for(var y,g=arguments.length,b=new Array(g),m=0;m<g;m++)b[m]=arguments[m];return c.default._validateParameters("line",b),this._renderer._doStroke&&(y=this._renderer).line.apply(y,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",b),this},c.default.prototype.point=function(){for(var y,g=arguments.length,b=new Array(g),m=0;m<g;m++)b[m]=arguments[m];return c.default._validateParameters("point",b),this._renderer._doStroke&&(b.length===1&&b[0]instanceof c.default.Vector?this._renderer.point.call(this._renderer,b[0].x,b[0].y,b[0].z):((y=this._renderer).point.apply(y,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",b))),this},c.default.prototype.quad=function(){for(var y,g=arguments.length,b=new Array(g),m=0;m<g;m++)b[m]=arguments[m];return c.default._validateParameters("quad",b),(this._renderer._doStroke||this._renderer._doFill)&&(this._renderer.isP3D&&b.length<12?this._renderer.quad.call(this._renderer,b[0],b[1],0,b[2],b[3],0,b[4],b[5],0,b[6],b[7],0,b[8],b[9]):((y=this._renderer).quad.apply(y,b),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",b))),this},c.default.prototype.rect=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];return c.default._validateParameters("rect",g),this._renderRect.apply(this,g)},c.default.prototype.square=function(y,g,b,m,v,x,w){return c.default._validateParameters("square",arguments),this._renderRect.call(this,y,g,b,b,m,v,x,w)},c.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){arguments.length===3&&(arguments[3]=arguments[2]);for(var y=f.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode),g=[y.x,y.y,y.w,y.h],b=4;b<arguments.length;b++)g[b]=arguments[b];this._renderer.rect(g),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[y.x,y.y,y.w,y.h])}return this},c.default.prototype.triangle=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];return c.default._validateParameters("triangle",g),(this._renderer._doStroke||this._renderer._doFill)&&this._renderer.triangle(g),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",g),this},r=c.default,a.default=r},{"../constants":269,"../friendly_errors/fes_core":271,"../friendly_errors/file_errors":272,"../friendly_errors/validate_params":275,"../helpers":276,"../main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],288:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.prototype.ellipseMode=function(d){return c.default._validateParameters("ellipseMode",arguments),d!==u.CORNER&&d!==u.CORNERS&&d!==u.RADIUS&&d!==u.CENTER||(this._renderer._ellipseMode=d),this},c.default.prototype.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},c.default.prototype.rectMode=function(d){return c.default._validateParameters("rectMode",arguments),d!==u.CORNER&&d!==u.CORNERS&&d!==u.RADIUS&&d!==u.CENTER||(this._renderer._rectMode=d),this},c.default.prototype.smooth=function(){return this.setAttributes("antialias",!0),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},c.default.prototype.strokeCap=function(d){return c.default._validateParameters("strokeCap",arguments),d!==u.ROUND&&d!==u.SQUARE&&d!==u.PROJECT||this._renderer.strokeCap(d),this},c.default.prototype.strokeJoin=function(d){return c.default._validateParameters("strokeJoin",arguments),d!==u.ROUND&&d!==u.BEVEL&&d!==u.MITER||this._renderer.strokeJoin(d),this},c.default.prototype.strokeWeight=function(d){return c.default._validateParameters("strokeWeight",arguments),this._renderer.strokeWeight(d),this};var h=c.default;a.default=h},{"../constants":269,"../main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],289:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(l=r("../main"))&&l.__esModule?l:{default:l};r("../friendly_errors/fes_core"),r("../friendly_errors/file_errors"),r("../friendly_errors/validate_params"),i.default.prototype.bezier=function(){for(var c,u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("bezier",f),(this._renderer._doStroke||this._renderer._doFill)&&(c=this._renderer).bezier.apply(c,f),this},i.default.prototype.bezierDetail=function(c){return i.default._validateParameters("bezierDetail",arguments),this._bezierDetail=c,this},i.default.prototype.bezierPoint=function(c,u,f,h,d){i.default._validateParameters("bezierPoint",arguments);var p=1-d;return Math.pow(p,3)*c+3*Math.pow(p,2)*d*u+3*p*Math.pow(d,2)*f+Math.pow(d,3)*h},i.default.prototype.bezierTangent=function(c,u,f,h,d){i.default._validateParameters("bezierTangent",arguments);var p=1-d;return 3*h*Math.pow(d,2)-3*f*Math.pow(d,2)+6*f*p*d-6*u*p*d+3*u*Math.pow(p,2)-3*c*Math.pow(p,2)},i.default.prototype.curve=function(){for(var c,u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("curve",f),this._renderer._doStroke&&(c=this._renderer).curve.apply(c,f),this},i.default.prototype.curveDetail=function(c){return i.default._validateParameters("curveDetail",arguments),this._curveDetail=c<3?3:c,this},i.default.prototype.curveTightness=function(c){return i.default._validateParameters("curveTightness",arguments),this._renderer._curveTightness=c,this},i.default.prototype.curvePoint=function(c,u,f,h,d){i.default._validateParameters("curvePoint",arguments);var p=this._renderer._curveTightness,y=d*d*d,g=d*d;return c*((p-1)/2*y+(1-p)*g+(p-1)/2*d)+u*((p+3)/2*y+(-5-p)/2*g+1)+f*((-3-p)/2*y+(p+2)*g+(1-p)/2*d)+h*((1-p)/2*y+(p-1)/2*g)},i.default.prototype.curveTangent=function(c,u,f,h,g){i.default._validateParameters("curveTangent",arguments);var p=this._renderer._curveTightness,y=g*g*3,g=2*g;return c*((p-1)/2*y+(1-p)*g+(p-1)/2)+u*((p+3)/2*y+(-5-p)/2*g)+f*((-3-p)/2*y+(p+2)*g+(1-p)/2)+h*((1-p)/2*y+(p-1)/2*g)};var l=i.default;a.default=l},{"../friendly_errors/fes_core":271,"../friendly_errors/file_errors":272,"../friendly_errors/validate_params":275,"../main":280}],290:[function(r,s,a){function i(w){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(w)}function l(w){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(S){return i(S)}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":i(S)})(w)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.slice"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(x=r("../main"))&&x.__esModule?x:{default:x},u=function(w){if(w&&w.__esModule)return w;if(w===null||l(w)!=="object"&&typeof w!="function")return{default:w};var S=f();if(S&&S.has(w))return S.get(w);var k,_={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(k in w){var P;Object.prototype.hasOwnProperty.call(w,k)&&((P=C?Object.getOwnPropertyDescriptor(w,k):null)&&(P.get||P.set)?Object.defineProperty(_,k,P):_[k]=w[k])}return _.default=w,S&&S.set(w,_),_}(r("../constants"));function f(){var w;return typeof WeakMap!="function"?null:(w=new WeakMap,f=function(){return w},w)}var h=null,d=[],p=[],y=!1,g=!1,b=!1,m=!1,v=!0,x=(c.default.prototype.beginContour=function(){return this._renderer.isP3D?this._renderer.beginContour():(p=[],m=!0),this},c.default.prototype.beginShape=function(w){var S;return c.default._validateParameters("beginShape",arguments),this._renderer.isP3D?(S=this._renderer).beginShape.apply(S,arguments):(h=w===u.POINTS||w===u.LINES||w===u.TRIANGLES||w===u.TRIANGLE_FAN||w===u.TRIANGLE_STRIP||w===u.QUADS||w===u.QUAD_STRIP?w:null,d=[],p=[]),this},c.default.prototype.bezierVertex=function(){for(var w,S=arguments.length,k=new Array(S),_=0;_<S;_++)k[_]=arguments[_];if(c.default._validateParameters("bezierVertex",k),this._renderer.isP3D)(w=this._renderer).bezierVertex.apply(w,k);else if(d.length===0)c.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex");else{y=!0;for(var C=[],P=0;P<k.length;P++)C[P]=k[P];C.isVert=!1,(m?p:d).push(C)}return this},c.default.prototype.curveVertex=function(){for(var w,S=arguments.length,k=new Array(S),_=0;_<S;_++)k[_]=arguments[_];return c.default._validateParameters("curveVertex",k),this._renderer.isP3D?(w=this._renderer).curveVertex.apply(w,k):(g=!0,this.vertex(k[0],k[1])),this},c.default.prototype.endContour=function(){if(!this._renderer.isP3D){var w=p[0].slice();w.isVert=p[0].isVert,w.moveTo=!1,p.push(w),v&&(d.push(d[0]),v=!1);for(var S=0;S<p.length;S++)d.push(p[S])}return this},c.default.prototype.endShape=function(w){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(c.default._validateParameters("endShape",arguments),S<1&&(console.log("\u{1F338} p5.js says: You can not have less than one instance"),S=1),this._renderer.isP3D)this._renderer.endShape(w,g,y,b,m,h,S);else{if(S!==1&&console.log("\u{1F338} p5.js says: Instancing is only supported in WebGL2 mode"),d.length===0)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;S=w===u.CLOSE,S&&!m&&d.push(d[0]),this._renderer.endShape(w,d,g,y,b,m,h),v=!(m=b=y=g=!1),S&&d.pop()}return this},c.default.prototype.quadraticVertex=function(){for(var w,S=arguments.length,k=new Array(S),_=0;_<S;_++)k[_]=arguments[_];if(c.default._validateParameters("quadraticVertex",k),this._renderer.isP3D)(w=this._renderer).quadraticVertex.apply(w,k);else{if(this._contourInited)return(w={}).x=k[0],w.y=k[1],w.x3=k[2],w.y3=k[3],w.type=u.QUADRATIC,this._contourVertices.push(w),this;if(0<d.length){b=!0;for(var C=[],P=0;P<k.length;P++)C[P]=k[P];C.isVert=!1,(m?p:d).push(C)}else c.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}return this},c.default.prototype.vertex=function(w,S,k,_,C){var P;return this._renderer.isP3D?(P=this._renderer).vertex.apply(P,arguments):((P=[]).isVert=!0,P[0]=w,P[1]=S,P[2]=0,P[3]=0,P[4]=0,P[5]=this._renderer._getFill(),P[6]=this._renderer._getStroke(),k&&(P.moveTo=k),(m?(p.length===0&&(P.moveTo=!0),p):d).push(P)),this},c.default.prototype.normal=function(w,S,k){var _;return this._assert3d("normal"),c.default._validateParameters("normal",arguments),(_=this._renderer).normal.apply(_,arguments),this},c.default);a.default=x},{"../constants":269,"../main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],291:[function(r,s,a){},{}],292:[function(r,s,a){r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.assign"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("./main"))&&r.__esModule?r:{default:r},r.default.prototype.noLoop=function(){this._loop=!1},r.default.prototype.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},r.default.prototype.isLooping=function(){return this._loop},r.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})},r.default.prototype.pop=function(){var i=this._styles.pop();i?(this._renderer.pop(i.renderer),Object.assign(this,i.props)):console.warn("pop() was called without matching push()")},r.default.prototype.redraw=function(i){if(!this._inUserDraw&&this._setupDone){var l=parseInt(i),c=((isNaN(l)||l<1)&&(l=1),this._isGlobal?window:this);if(typeof c.draw=="function"){c.setup===void 0&&c.scale(c._pixelDensity,c._pixelDensity);for(var u=0;u<l;u++){c.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),c._renderer.isP3D&&c._renderer._update(),c._setProperty("frameCount",c.frameCount+1),this.callRegisteredHooksFor("pre"),this._inUserDraw=!0;try{c.draw()}finally{this._inUserDraw=!1}this.callRegisteredHooksFor("post")}}}},r=r.default,a.default=r},{"./main":280,"core-js/modules/es.object.assign":181}],293:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("./main"))&&r.__esModule?r:{default:r};function l(c){return function(u){if(Array.isArray(u)){for(var f=0,h=new Array(u.length);f<u.length;f++)h[f]=u[f];return h}}(c)||function(u){if(Symbol.iterator in Object(u)||Object.prototype.toString.call(u)==="[object Arguments]")return Array.from(u)}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.default.prototype.applyMatrix=function(){var c=(arguments.length<=0?void 0:arguments[0])instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(arguments.length<=0?void 0:arguments[0])||c?(c=this._renderer).applyMatrix.apply(c,l(arguments.length<=0?void 0:arguments[0])):(c=this._renderer).applyMatrix.apply(c,arguments),this},i.default.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},i.default.prototype.rotate=function(c,u){return i.default._validateParameters("rotate",arguments),this._renderer.rotate(this._toRadians(c),u),this},i.default.prototype.rotateX=function(c){return this._assert3d("rotateX"),i.default._validateParameters("rotateX",arguments),this._renderer.rotateX(this._toRadians(c)),this},i.default.prototype.rotateY=function(c){return this._assert3d("rotateY"),i.default._validateParameters("rotateY",arguments),this._renderer.rotateY(this._toRadians(c)),this},i.default.prototype.rotateZ=function(c){return this._assert3d("rotateZ"),i.default._validateParameters("rotateZ",arguments),this._renderer.rotateZ(this._toRadians(c)),this},i.default.prototype.scale=function(c,u,f){var h;return i.default._validateParameters("scale",arguments),c instanceof i.default.Vector?(c=(h=c).x,u=h.y,f=h.z):Array.isArray(c)&&(c=(h=c)[0],u=h[1],f=h[2]||1),isNaN(u)?u=f=c:isNaN(f)&&(f=1),this._renderer.scale(c,u,f),this},i.default.prototype.shearX=function(c){return i.default._validateParameters("shearX",arguments),c=this._toRadians(c),this._renderer.applyMatrix(1,0,Math.tan(c),1,0,0),this},i.default.prototype.shearY=function(c){return i.default._validateParameters("shearY",arguments),c=this._toRadians(c),this._renderer.applyMatrix(1,Math.tan(c),0,1,0,0),this},i.default.prototype.translate=function(c,u,f){return i.default._validateParameters("translate",arguments),this._renderer.isP3D?this._renderer.translate(c,u,f):this._renderer.translate(c,u),this},r=i.default,a.default=r},{"./main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.iterator":243}],294:[function(r,s,a){function i(f){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.ends-with"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator");var l=(r=r("../core/main"))&&r.__esModule?r:{default:r};function c(f){return function(h){if(Array.isArray(h)){for(var d=0,p=new Array(h.length);d<h.length;d++)p[d]=h[d];return p}}(f)||function(h){if(Symbol.iterator in Object(h)||Object.prototype.toString.call(h)==="[object Arguments]")return Array.from(h)}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(f){return(u=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(h){return i(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":i(h)})(f)}l.default.prototype.storeItem=function(f,h){typeof f!="string"&&console.log("The argument that you passed to storeItem() - ".concat(f," is not a string.")),f.endsWith("p5TypeID")&&console.log("The argument that you passed to storeItem() - ".concat(f," must not end with 'p5TypeID'.")),h===void 0&&console.log("You cannot store undefined variables using storeItem().");var d=u(h);switch(d){case"number":case"boolean":h=h.toString();break;case"object":h instanceof l.default.Color?d="p5.Color":h instanceof l.default.Vector&&(d="p5.Vector",h=[h.x,h.y,h.z]),h=JSON.stringify(h)}localStorage.setItem(f,h),f="".concat(f,"p5TypeID"),localStorage.setItem(f,d)},l.default.prototype.getItem=function(f){var h=localStorage.getItem(f),d=localStorage.getItem("".concat(f,"p5TypeID"));if(d===void 0)console.log("Unable to determine type of item stored under ".concat(f,"in local storage. Did you save the item with something other than setItem()?"));else if(h!==null)switch(d){case"number":h=parseFloat(h);break;case"boolean":h=h==="true";break;case"object":h=JSON.parse(h);break;case"p5.Color":h=JSON.parse(h),h=this.color.apply(this,c(h.levels));break;case"p5.Vector":h=JSON.parse(h),h=this.createVector.apply(this,c(h))}return h},l.default.prototype.clearStorage=function(){localStorage.clear()},l.default.prototype.removeItem=function(f){typeof f!="string"&&console.log("The argument that you passed to removeItem() - ".concat(f," is not a string.")),localStorage.removeItem(f),localStorage.removeItem("".concat(f,"p5TypeID"))}},{"../core/main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.ends-with":195,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],295:[function(r,s,a){function i(b){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(b)}function l(b){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(m){return i(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":i(m)})(b)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.object.keys"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(r=r("../core/main"))&&r.__esModule?r:{default:r};function u(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),m&&f(b,m)}function f(b,m){return(f=Object.setPrototypeOf||function(v,x){return v.__proto__=x,v})(b,m)}function h(b){return function(){var m,v=d(b),v=(m=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(m=d(this).constructor,Reflect.construct(v,arguments,m)):v.apply(this,arguments),this);if(!m||l(m)!=="object"&&typeof m!="function"){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return m}}function d(b){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(b)}function p(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function y(b,m){for(var v=0;v<m.length;v++){var x=m[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(b,x.key,x)}}function g(b,m,v){m&&y(b.prototype,m),v&&y(b,v)}c.default.prototype.createStringDict=function(b,m){return c.default._validateParameters("createStringDict",arguments),new c.default.StringDict(b,m)},c.default.prototype.createNumberDict=function(b,m){return c.default._validateParameters("createNumberDict",arguments),new c.default.NumberDict(b,m)},c.default.TypedDict=function(){function b(m,v){return p(this,b),m instanceof Object?this.data=m:(this.data={},this.data[m]=v),this}return g(b,[{key:"size",value:function(){return Object.keys(this.data).length}},{key:"hasKey",value:function(m){return this.data.hasOwnProperty(m)}},{key:"get",value:function(m){if(this.data.hasOwnProperty(m))return this.data[m];console.log("".concat(m," does not exist in this Dictionary"))}},{key:"set",value:function(m,v){this._validate(v)?this.data[m]=v:console.log("Those values dont work for this dictionary type.")}},{key:"_addObj",value:function(m){for(var v in m)this.set(v,m[v])}},{key:"create",value:function(m,v){m instanceof Object&&v===void 0?this._addObj(m):m!==void 0?this.set(m,v):console.log("In order to create a new Dictionary entry you must pass an object or a key, value pair")}},{key:"clear",value:function(){this.data={}}},{key:"remove",value:function(m){if(!this.data.hasOwnProperty(m))throw new Error("".concat(m," does not exist in this Dictionary"));delete this.data[m]}},{key:"print",value:function(){for(var m in this.data)console.log("key:".concat(m," value:").concat(this.data[m]))}},{key:"saveTable",value:function(m){var v,x="";for(v in this.data)x+="".concat(v,",").concat(this.data[v],`
`);var w=new Blob([x],{type:"text/csv"});c.default.prototype.downloadFile(w,m||"mycsv","csv")}},{key:"saveJSON",value:function(m,v){c.default.prototype.saveJSON(this.data,m,v)}},{key:"_validate",value:function(m){return!0}}]),b}(),c.default.StringDict=function(){u(m,c.default.TypedDict);var b=h(m);function m(){p(this,m);for(var v=arguments.length,x=new Array(v),w=0;w<v;w++)x[w]=arguments[w];return b.call.apply(b,[this].concat(x))}return g(m,[{key:"_validate",value:function(v){return typeof v=="string"}}]),m}(),c.default.NumberDict=function(){u(m,c.default.TypedDict);var b=h(m);function m(){p(this,m);for(var v=arguments.length,x=new Array(v),w=0;w<v;w++)x[w]=arguments[w];return b.call.apply(b,[this].concat(x))}return g(m,[{key:"_validate",value:function(v){return typeof v=="number"}},{key:"add",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]+=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"sub",value:function(v,x){this.add(v,-x)}},{key:"mult",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]*=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"div",value:function(v,x){this.data.hasOwnProperty(v)?this.data[v]/=x:console.log("The key - ".concat(v," does not exist in this dictionary."))}},{key:"_valueTest",value:function(v){if(Object.keys(this.data).length===0)throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict");if(Object.keys(this.data).length===1)return this.data[Object.keys(this.data)[0]];var x,w=this.data[Object.keys(this.data)[0]];for(x in this.data)this.data[x]*v<w*v&&(w=this.data[x]);return w}},{key:"minValue",value:function(){return this._valueTest(1)}},{key:"maxValue",value:function(){return this._valueTest(-1)}},{key:"_keyTest",value:function(v){if(Object.keys(this.data).length===0)throw new Error("Unable to use minValue on an empty NumberDict");if(Object.keys(this.data).length===1)return Object.keys(this.data)[0];for(var x=Object.keys(this.data)[0],w=1;w<Object.keys(this.data).length;w++)Object.keys(this.data)[w]*v<x*v&&(x=Object.keys(this.data)[w]);return x}},{key:"minKey",value:function(){return this._keyTest(1)}},{key:"maxKey",value:function(){return this._keyTest(-1)}}]),m}(),r=c.default.TypedDict,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],296:[function(r,s,a){function i(x){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(r=r("../core/main"))&&r.__esModule?r:{default:r};function c(x,w){for(var S=0;S<w.length;S++){var k=w[S];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}function u(x,w,S){w&&c(x.prototype,w),S&&c(x,S)}function f(x,w){return(f=Object.setPrototypeOf||function(S,k){return S.__proto__=k,S})(x,w)}function h(x){return function(){var w,S,k=p(x);return w=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(w=p(this).constructor,Reflect.construct(k,arguments,w)):k.apply(this,arguments),k=this,!(S=w)||g(S)!=="object"&&typeof S!="function"?d(k):S}}function d(x){if(x===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x}function p(x){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(x)}function y(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function g(x){return(g=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(w){return i(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":i(w)})(x)}function b(x,w,S){return(w._userNode||document.body).appendChild(x),S=new(S?l.default.MediaElement:l.default.Element)(x,w),w._elements.push(S),S}function m(x,P,S,k){var _=document.createElement(P),C=(typeof(S=S||"")=="string"&&(S=[S]),!0),P=!1,A=void 0;try{for(var I,N=S[Symbol.iterator]();!(C=(I=N.next()).done);C=!0){var O=I.value,F=document.createElement("source");F.setAttribute("src",O),_.appendChild(F)}}catch(G){P=!0,A=G}finally{try{C||N.return==null||N.return()}finally{if(P)throw A}}typeof k=="function"&&_.addEventListener("canplaythrough",function G(){k(),_.removeEventListener("canplaythrough",G)});var U=b(_,x,!0);return U.loadedmetadata=!1,_.addEventListener("loadedmetadata",function(){U.width=_.videoWidth,U.height=_.videoHeight,U.elt.width===0&&(U.elt.width=_.videoWidth),U.elt.height===0&&(U.elt.height=_.videoHeight),U.presetPlaybackRate&&(U.elt.playbackRate=U.presetPlaybackRate,delete U.presetPlaybackRate),U.loadedmetadata=!0}),U}l.default.prototype.select=function(x,w){return l.default._validateParameters("select",arguments),w=this._getContainer(w).querySelector(x),w?this._wrapElement(w):null},l.default.prototype.selectAll=function(x,w){l.default._validateParameters("selectAll",arguments);var S=[],k=this._getContainer(w).querySelectorAll(x);if(k)for(var _=0;_<k.length;_++){var C=this._wrapElement(k[_]);S.push(C)}return S},l.default.prototype._getContainer=function(x){var w=document;return typeof x=="string"?w=document.querySelector(x)||document:x instanceof l.default.Element?w=x.elt:x instanceof HTMLElement&&(w=x),w},l.default.prototype._wrapElement=function(x){var w,S=Array.prototype.slice.call(x.children);return x.tagName==="INPUT"&&x.type==="checkbox"?((w=new l.default.Element(x,this)).checked=function(){return arguments.length===0?this.elt.checked:(this.elt.checked=!(arguments.length<=0||!arguments[0]),this)},w):x.tagName==="VIDEO"||x.tagName==="AUDIO"?new l.default.MediaElement(x,this):x.tagName==="SELECT"?this.createSelect(new l.default.Element(x,this)):0<S.length&&S.every(function(k){return k.tagName==="INPUT"||k.tagName==="LABEL"})?this.createRadio(new l.default.Element(x,this)):new l.default.Element(x,this)},l.default.prototype.removeElements=function(x){l.default._validateParameters("removeElements",arguments),this._elements.filter(function(w){return!(w.elt instanceof HTMLCanvasElement)}).map(function(w){return w.remove()})},l.default.Element.prototype.changed=function(x){return l.default.Element._adjustListener("change",x,this),this},l.default.Element.prototype.input=function(x){return l.default.Element._adjustListener("input",x,this),this},l.default.prototype.createDiv=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",w=document.createElement("div");return w.innerHTML=x,b(w,this)},l.default.prototype.createP=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",w=document.createElement("p");return w.innerHTML=x,b(w,this)},l.default.prototype.createSpan=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",w=document.createElement("span");return w.innerHTML=x,b(w,this)},l.default.prototype.createImg=function(){l.default._validateParameters("createImg",arguments);var x,w=document.createElement("img"),S=arguments;return 1<S.length&&typeof S[1]=="string"&&(w.alt=S[1]),2<S.length&&typeof S[2]=="string"&&(w.crossOrigin=S[2]),w.src=S[0],x=b(w,this),w.addEventListener("load",function(){x.width=w.offsetWidth||w.width,x.height=w.offsetHeight||w.height;var k=S[S.length-1];typeof k=="function"&&k(x)}),x},l.default.prototype.createA=function(x,w,S){l.default._validateParameters("createA",arguments);var k=document.createElement("a");return k.href=x,k.innerHTML=w,S&&(k.target=S),b(k,this)},l.default.prototype.createSlider=function(x,w,S,k){l.default._validateParameters("createSlider",arguments);var _=document.createElement("input");return _.type="range",_.min=x,_.max=w,k===0?_.step=1e-18:k&&(_.step=k),typeof S=="number"&&(_.value=S),b(_,this)},l.default.prototype.createButton=function(x,w){l.default._validateParameters("createButton",arguments);var S=document.createElement("button");return S.innerHTML=x,w&&(S.value=w),b(S,this)},l.default.prototype.createCheckbox=function(){for(var x=arguments.length,w=new Array(x),S=0;S<x;S++)w[S]=arguments[S];l.default._validateParameters("createCheckbox",w);var k=document.createElement("div"),_=document.createElement("input"),C=(_.type="checkbox",document.createElement("label")),P=(C.appendChild(_),k.appendChild(C),b(k,this));return P.checked=function(){var A=P.elt.firstElementChild.getElementsByTagName("input")[0];if(A){if(arguments.length===0)return A.checked;A.checked=!(arguments.length<=0||!arguments[0])}return P},this.value=function(A){return P.value=A,this},w[0]&&(P.value(w[0]),(k=document.createElement("span")).innerHTML=w[0],C.appendChild(k)),w[1]&&(_.checked=!0),P},l.default.prototype.createSelect=function(){for(var x,w=arguments.length,S=new Array(w),k=0;k<w;k++)S[k]=arguments[k];l.default._validateParameters("createSelect",S);var _,C=S[0];return C instanceof l.default.Element&&C.elt instanceof HTMLSelectElement?this.elt=(x=C).elt:C instanceof HTMLSelectElement?(x=b(C,this),this.elt=C):(_=document.createElement("select"),C&&typeof C=="boolean"&&_.setAttribute("multiple","true"),x=b(_,this),this.elt=_),x.option=function(P,A){var I;if(P!==void 0){for(var N,O=0;O<this.elt.length;O+=1)if(this.elt[O].textContent===P){I=O;break}I!==void 0?A===!1?this.elt.remove(I):this.elt[I].value=A:((N=document.createElement("option")).textContent=P,N.value=A===void 0?P:A,this.elt.appendChild(N),this._pInst._elements.push(N))}},x.selected=function(P){if(P!==void 0){for(var A=0;A<this.elt.length;A+=1)this.elt[A].value.toString()===P.toString()&&(this.elt.selectedIndex=A);return this}if(this.elt.getAttribute("multiple")){var I=[],N=!0,O=!1,F=void 0;try{for(var U,G=this.elt.selectedOptions[Symbol.iterator]();!(N=(U=G.next()).done);N=!0){var Y=U.value;I.push(Y.value)}}catch($){O=!0,F=$}finally{try{N||G.return==null||G.return()}finally{if(O)throw F}}return I}return this.elt.value},x.disable=function(P){if(typeof P=="string")for(var A=0;A<this.elt.length;A++)this.elt[A].value.toString()===P&&(this.elt[A].disabled=!0,this.elt[A].selected=!1);else this.elt.disabled=!0;return this},x.enable=function(P){if(typeof P=="string")for(var A=0;A<this.elt.length;A++)this.elt[A].value.toString()===P&&(this.elt[A].disabled=!1,this.elt[A].selected=!1);else{this.elt.disabled=!1;for(var I=0;I<this.elt.length;I++)this.elt[I].disabled=!1,this.elt[I].selected=!1}return this},x},l.default.prototype.createRadio=function(){function x(P){return P instanceof HTMLInputElement&&P.type==="radio"}function w(P){return P instanceof HTMLLabelElement}var S,k,_,C=arguments.length<=0?void 0:arguments[0];return C instanceof l.default.Element&&(C.elt instanceof HTMLDivElement||C.elt instanceof HTMLSpanElement)?(S=C,this.elt=C.elt):C instanceof HTMLDivElement||C instanceof HTMLSpanElement?(S=b(C,this),k=this.elt=C,typeof(arguments.length<=1?void 0:arguments[1])=="string"&&(_=arguments.length<=1?void 0:arguments[1])):(typeof C=="string"&&(_=C),k=document.createElement("div"),S=b(k,this),this.elt=k),S._name=_||"radioOption",S._getOptionsArray=function(){return Array.from(this.elt.children).filter(function(P){return x(P)||w(P)&&x(P.firstElementChild)}).map(function(P){return x(P)?P:P.firstElementChild})},S.option=function(P,A){var I,N,O,F=!0,U=!1,G=void 0;try{for(var Y,$=S._getOptionsArray()[Symbol.iterator]();!(F=(Y=$.next()).done);F=!0){var H=Y.value;if(H.value===P){I=H;break}}}catch(Q){U=!0,G=Q}finally{try{F||$.return==null||$.return()}finally{if(U)throw G}}return I===void 0&&((I=document.createElement("input")).setAttribute("type","radio"),I.setAttribute("value",P)),I.setAttribute("name",S._name),w(I.parentElement)?N=I.parentElement:(N=document.createElement("label")).insertAdjacentElement("afterbegin",I),N.lastElementChild instanceof HTMLSpanElement?O=N.lastElementChild:(O=document.createElement("span"),I.insertAdjacentElement("afterend",O)),O.innerHTML=A===void 0?P:A,this.elt.appendChild(N),I},S.remove=function(P){var A=!0,I=!1,N=void 0;try{for(var O,F=S._getOptionsArray()[Symbol.iterator]();!(A=(O=F.next()).done);A=!0){var U=O.value;if(U.value===P)return void(w(U.parentElement)?U.parentElement:U).remove()}}catch(G){I=!0,N=G}finally{try{A||F.return==null||F.return()}finally{if(I)throw N}}},S.value=function(){var P="",A=!0,I=!1,N=void 0;try{for(var O,F=S._getOptionsArray()[Symbol.iterator]();!(A=(O=F.next()).done);A=!0){var U=O.value;if(U.checked){P=U.value;break}}}catch(G){I=!0,N=G}finally{try{A||F.return==null||F.return()}finally{if(I)throw N}}return P},S.selected=function(P){var A=null;if(P===void 0){var I=!0,N=!1,O=void 0;try{for(var F,U=S._getOptionsArray()[Symbol.iterator]();!(I=(F=U.next()).done);I=!0){var G=F.value;if(G.checked){A=G;break}}}catch(J){N=!0,O=J}finally{try{I||U.return==null||U.return()}finally{if(N)throw O}}}else{S._getOptionsArray().forEach(function(T){T.checked=!1,T.removeAttribute("checked")});var Y=!0,N=!1,O=void 0;try{for(var $,H=S._getOptionsArray()[Symbol.iterator]();!(Y=($=H.next()).done);Y=!0){var Q=$.value;Q.value===P&&(Q.setAttribute("checked",!0),Q.checked=!0,A=Q)}}catch(T){N=!0,O=T}finally{try{Y||H.return==null||H.return()}finally{if(N)throw O}}}return A},S.disable=function(){var P=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],A=!0,I=!1,N=void 0;try{for(var O,F=S._getOptionsArray()[Symbol.iterator]();!(A=(O=F.next()).done);A=!0)O.value.setAttribute("disabled",P)}catch(U){I=!0,N=U}finally{try{A||F.return==null||F.return()}finally{if(I)throw N}}},S},l.default.prototype.createColorPicker=function(x){l.default._validateParameters("createColorPicker",arguments);var w=document.createElement("input");return w.type="color",x?x instanceof l.default.Color?w.value=x.toString("#rrggbb"):(l.default.prototype._colorMode="rgb",l.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},w.value=l.default.prototype.color(x).toString("#rrggbb")):w.value="#000000",(w=b(w,this)).color=function(){return x&&(x.mode&&(l.default.prototype._colorMode=x.mode),x.maxes&&(l.default.prototype._colorMaxes=x.maxes)),l.default.prototype.color(this.elt.value)},w},l.default.prototype.createInput=function(){var x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"text",S=(l.default._validateParameters("createInput",arguments),document.createElement("input"));return S.setAttribute("value",x),S.setAttribute("type",w),b(S,this)},l.default.prototype.createFileInput=function(x){var w,S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(l.default._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob)return(w=document.createElement("input")).setAttribute("type","file"),S&&w.setAttribute("multiple",!0),w.addEventListener("change",function(k){var _=!0,C=!1,P=void 0;try{for(var A,I=k.target.files[Symbol.iterator]();!(_=(A=I.next()).done);_=!0){var N=A.value;l.default.File._load(N,x)}}catch(O){C=!0,P=O}finally{try{_||I.return==null||I.return()}finally{if(C)throw P}}},!1),b(w,this);console.log("The File APIs are not fully supported in this browser. Cannot create element.")},l.default.prototype.createVideo=function(x,w){return l.default._validateParameters("createVideo",arguments),m(this,"video",x,w)},l.default.prototype.createAudio=function(x,w){return l.default._validateParameters("createAudio",arguments),m(this,"audio",x,w)},l.default.prototype.VIDEO="video",l.default.prototype.AUDIO="audio",navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(x){var w=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return w?new Promise(function(S,k){w.call(navigator,x,S,k)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),l.default.prototype.createCapture=function(){for(var x=arguments.length,w=new Array(x),S=0;S<x;S++)w[S]=arguments[S];if(l.default._validateParameters("createCapture",w),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new DOMException("getUserMedia not supported in this browser");for(var k,_=!0,C=!0,P=!1,A=0,I=w;A<I.length;A++){var N=I[A];N===l.default.prototype.VIDEO?C=!1:N===l.default.prototype.AUDIO?_=!1:g(N)==="object"?(N.flipped!==void 0&&(P=N.flipped,delete N.flipped),O=Object.assign({},O,N)):typeof N=="function"&&(k=N)}var O=Object.assign({},{video:_,audio:C},O),F=document.createElement("video"),U=(F.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(O).then(function(G){try{"srcObject"in F?F.srcObject=G:F.src=window.URL.createObjectURL(G)}catch{F.src=G}},console.error),b(F,this,!0));return U.loadedmetadata=!1,F.addEventListener("loadedmetadata",function(){F.play(),F.width?(U.width=F.width,U.height=F.height,P&&(U.elt.style.transform="scaleX(-1)")):(U.width=U.elt.width=F.videoWidth,U.height=U.elt.height=F.videoHeight),U.loadedmetadata=!0,k&&k(F.srcObject)}),U.flipped=P,U},l.default.prototype.createElement=function(x,w){return l.default._validateParameters("createElement",arguments),x=document.createElement(x),w!==void 0&&(x.innerHTML=w),b(x,this)},l.default.Element.prototype.addClass=function(x){return this.elt.className?this.hasClass(x)||(this.elt.className=this.elt.className+" "+x):this.elt.className=x,this},l.default.Element.prototype.removeClass=function(x){return this.elt.classList.remove(x),this},l.default.Element.prototype.hasClass=function(x){return this.elt.classList.contains(x)},l.default.Element.prototype.toggleClass=function(x){return this.elt.classList.contains(x)?this.elt.classList.remove(x):this.elt.classList.add(x),this},l.default.Element.prototype.child=function(x){return x===void 0?this.elt.childNodes:(typeof x=="string"?(x[0]==="#"&&(x=x.substring(1)),x=document.getElementById(x)):x instanceof l.default.Element&&(x=x.elt),x instanceof HTMLElement&&this.elt.appendChild(x),this)},l.default.Element.prototype.center=function(x){var w=this.elt.style.display,S=this.elt.style.display==="none",k=this.parent().style.display==="none",_={x:this.elt.offsetLeft,y:this.elt.offsetTop},C=(S&&this.show(),k&&this.parent().show(),this.elt.style.display="block",this.position(0,0),Math.abs(this.parent().offsetWidth-this.elt.offsetWidth)),P=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return x==="both"||x===void 0?this.position(C/2+this.parent().offsetLeft,P/2+this.parent().offsetTop):x==="horizontal"?this.position(C/2+this.parent().offsetLeft,_.y):x==="vertical"&&this.position(_.x,P/2+this.parent().offsetTop),this.style("display",w),S&&this.hide(),k&&this.parent().hide(),this},l.default.Element.prototype.html=function(){return arguments.length===0?this.elt.innerHTML:(arguments.length<=1||!arguments[1]?this.elt.innerHTML=arguments.length<=0?void 0:arguments[0]:this.elt.insertAdjacentHTML("beforeend",arguments.length<=0?void 0:arguments[0]),this)},l.default.Element.prototype.position=function(){return arguments.length===0?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position=(arguments.length<=2?void 0:arguments[2])!=="static"&&(arguments.length<=2?void 0:arguments[2])!=="fixed"&&(arguments.length<=2?void 0:arguments[2])!=="relative"&&(arguments.length<=2?void 0:arguments[2])!=="sticky"&&(arguments.length<=2?void 0:arguments[2])!=="initial"&&(arguments.length<=2?void 0:arguments[2])!=="inherit"?"absolute":arguments.length<=2?void 0:arguments[2],this.elt.style.left=(arguments.length<=0?void 0:arguments[0])+"px",this.elt.style.top=(arguments.length<=1?void 0:arguments[1])+"px",this.x=arguments.length<=0?void 0:arguments[0],this.y=arguments.length<=1?void 0:arguments[1],this)},l.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var x="";return this.elt.style.transform&&(x=(x=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),arguments.length===2?this.elt.style.transform="translate("+(arguments.length<=0?void 0:arguments[0])+"px, "+(arguments.length<=1?void 0:arguments[1])+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+(arguments.length<=0?void 0:arguments[0])+"px,"+(arguments.length<=1?void 0:arguments[1])+"px,"+(arguments.length<=2?void 0:arguments[2])+"px)",this.elt.parentElement.style.perspective=arguments.length===3?"1000px":(arguments.length<=3?void 0:arguments[3])+"px"),this.elt.style.transform+=x,this},l.default.Element.prototype._rotate=function(){var x="";return this.elt.style.transform&&(x=(x=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,"")),arguments.length===1?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg)":arguments.length===2?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg, "+(arguments.length<=1?void 0:arguments[1])+"deg)":arguments.length===3&&(this.elt.style.transform="rotateX("+(arguments.length<=0?void 0:arguments[0])+"deg)",this.elt.style.transform+="rotateY("+(arguments.length<=1?void 0:arguments[1])+"deg)",this.elt.style.transform+="rotateZ("+(arguments.length<=2?void 0:arguments[2])+"deg)"),this.elt.style.transform+=x,this},l.default.Element.prototype.style=function(x,w){if((w=w instanceof l.default.Color?"rgba("+w.levels[0]+","+w.levels[1]+","+w.levels[2]+","+w.levels[3]/255+")":w)===void 0){if(x.indexOf(":")===-1)return window.getComputedStyle(this.elt).getPropertyValue(x);for(var S=x.split(";"),k=0;k<S.length;k++){var _=S[k].split(":");_[0]&&_[1]&&(this.elt.style[_[0].trim()]=_[1].trim())}}else this.elt.style[x]=w,x!=="width"&&x!=="height"&&x!=="left"&&x!=="top"||(w=window.getComputedStyle(this.elt).getPropertyValue(x).replace(/[^\d.]/g,""),this[x]=Math.round(parseFloat(w,10)));return this},l.default.Element.prototype.attribute=function(x,w){if(this.elt.firstChild==null||this.elt.firstChild.type!=="checkbox"&&this.elt.firstChild.type!=="radio")return w===void 0?this.elt.getAttribute(x):(this.elt.setAttribute(x,w),this);if(w===void 0)return this.elt.firstChild.getAttribute(x);for(var S=0;S<this.elt.childNodes.length;S++)this.elt.childNodes[S].setAttribute(x,w)},l.default.Element.prototype.removeAttribute=function(x){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(var w=0;w<this.elt.childNodes.length;w++)this.elt.childNodes[w].removeAttribute(x);return this.elt.removeAttribute(x),this},l.default.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments.length<=0?void 0:arguments[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value},l.default.Element.prototype.show=function(){return this.elt.style.display="block",this},l.default.Element.prototype.hide=function(){return this.elt.style.display="none",this},l.default.Element.prototype.size=function(x,w){if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var S=x,k=w,_=l.default.prototype.AUTO;if(S!==_||k!==_){if(S===_?S=w*this.width/this.height:k===_&&(k=x*this.height/this.width),this.elt instanceof HTMLCanvasElement){var C,P={},A=this.elt.getContext("2d");for(C in A)P[C]=A[C];for(C in this.elt.setAttribute("width",S*this._pInst._pixelDensity),this.elt.setAttribute("height",k*this._pInst._pixelDensity),this.elt.style.width=S+"px",this.elt.style.height=k+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),P)this.elt.getContext("2d")[C]=P[C]}else this.elt.style.width=S+"px",this.elt.style.height=k+"px",this.elt.width=S,this.elt.height=k;this.width=S,this.height=k,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",S),this._pInst._setProperty("height",k))}return this},l.default.Element.prototype.remove=function(){this instanceof l.default.MediaElement&&(this.stop(),(w=this.elt.srcObject)!==null&&w.getTracks().forEach(function(S){S.stop()}));var x,w=this._pInst._elements.indexOf(this);for(x in w!==-1&&this._pInst._elements.splice(w,1),this._events)this.elt.removeEventListener(x,this._events[x]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},l.default.Element.prototype.drop=function(x,w){var S;return window.File&&window.FileReader&&window.FileList&&window.Blob?(this._dragDisabled||(this._dragDisabled=!0,this.elt.addEventListener("dragover",S=function(k){k.preventDefault()}),this.elt.addEventListener("dragleave",S)),l.default.Element._attachListener("drop",function(_){_.preventDefault(),typeof w=="function"&&w.call(this,_);var _=_.dataTransfer.files,C=!0,P=!1,A=void 0;try{for(var I,N=_[Symbol.iterator]();!(C=(I=N.next()).done);C=!0){var O=I.value;l.default.File._load(O,x)}}catch(F){P=!0,A=F}finally{try{C||N.return==null||N.return()}finally{if(P)throw A}}},this)):console.log("The File APIs are not fully supported in this browser."),this},l.default.Element.prototype.draggable=function(x){var w,S="ontouchstart"in window,k=0,_=0,C=0,P=0,A=S?"touchend":"mouseup",I=S?"touchmove":"mousemove";function N(F){var U;F=F||window.event,P=S?(U=F.changedTouches,k=C-parseInt(U[0].clientX),_=P-parseInt(U[0].clientY),C=parseInt(U[0].clientX),parseInt(U[0].clientY)):(k=C-parseInt(F.clientX),_=P-parseInt(F.clientY),C=parseInt(F.clientX),parseInt(F.clientY)),x.style.left=x.offsetLeft-k+"px",x.style.top=x.offsetTop-_+"px"}function O(){document.removeEventListener(A,O,!1),document.removeEventListener(I,N,!1)}return x===void 0?w=x=this.elt:x!==this.elt&&x.elt!==this.elt&&(x=x.elt,w=this.elt),w.addEventListener(S?"touchstart":"mousedown",function(F){{var U;F=F||window.event,P=S?(U=F.changedTouches,C=parseInt(U[0].clientX),parseInt(U[0].clientY)):(C=parseInt(F.clientX),parseInt(F.clientY))}return document.addEventListener(A,O,!1),document.addEventListener(I,N,!1),!1},!1),w.style.cursor="move",this};function v(x,w,S,k){y(this,v),this.callback=x,this.time=w,this.id=S,this.val=k}r=function(x){var w=k;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(x&&x.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),x&&f(w,x);var S=h(k);function k(_,C){y(this,k);var P=d(C=S.call(this,_,C));return C.elt.crossOrigin="anonymous",C._prevTime=0,C._cueIDCounter=0,C._cues=[],C.pixels=[],C._pixelsState=d(C),C._pixelDensity=1,C._modified=!1,C._frameOnCanvas=-1,Object.defineProperty(P,"src",{get:function(){var A=P.elt.children[0].src,I=P.elt.src===window.location.href?"":P.elt.src;return A===window.location.href?I:A},set:function(A){for(var I=0;I<P.elt.children.length;I++)P.elt.removeChild(P.elt.children[I]);var N=document.createElement("source");N.src=A,_.appendChild(N),P.elt.src=A,P.modified=!0}}),P._onended=function(){},P.elt.onended=function(){P._onended(P)},C}return u(k,[{key:"play",value:function(){var _;return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),1<this.elt.readyState||this.elt.load(),(_=this.elt.play())&&_.catch&&_.catch(function(C){C.name==="NotAllowedError"?console.error(C):console.error("Media play method encountered an unexpected error",C)}),this}},{key:"stop",value:function(){return this.elt.pause(),this.elt.currentTime=0,this}},{key:"pause",value:function(){return this.elt.pause(),this}},{key:"loop",value:function(){return this.elt.setAttribute("loop",!0),this.play(),this}},{key:"noLoop",value:function(){return this.elt.removeAttribute("loop"),this}},{key:"_setupAutoplayFailDetection",value:function(){var _=setTimeout(function(){console.error(e)},500);this.elt.addEventListener("play",function(){return clearTimeout(_)},{passive:!0,once:!0})}},{key:"autoplay",value:function(_){var C=this,P=this.elt.getAttribute("autoplay");return this.elt.setAttribute("autoplay",_),_&&!P&&(_=function(){return C._setupAutoplayFailDetection()},this.elt.readyState===4?_():this.elt.addEventListener("canplay",_,{passive:!0,once:!0})),this}},{key:"volume",value:function(_){if(_===void 0)return this.elt.volume;this.elt.volume=_}},{key:"speed",value:function(_){if(_===void 0)return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=_:this.presetPlaybackRate=_}},{key:"time",value:function(_){return _===void 0?this.elt.currentTime:(this.elt.currentTime=_,this)}},{key:"duration",value:function(){return this.elt.duration}},{key:"_ensureCanvas",value:function(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0));var _=this._frameOnCanvas!==this._pInst.frameCount;this.loadedmetadata&&_&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&(this.drawingContext.save(),this.drawingContext.scale(-1,1),this.drawingContext.translate(-this.canvas.width,0)),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&this.drawingContext.restore(),this.setModified(!0),this._frameOnCanvas=this._pInst.frameCount)}},{key:"loadPixels",value:function(){this._ensureCanvas();for(var _=arguments.length,C=new Array(_),P=0;P<_;P++)C[P]=arguments[P];return l.default.Renderer2D.prototype.loadPixels.apply(this,C)}},{key:"updatePixels",value:function(_,C,P,A){return this.loadedmetadata&&(this._ensureCanvas(),l.default.Renderer2D.prototype.updatePixels.call(this,_,C,P,A)),this.setModified(!0),this}},{key:"get",value:function(){this._ensureCanvas();for(var _=arguments.length,C=new Array(_),P=0;P<_;P++)C[P]=arguments[P];return l.default.Renderer2D.prototype.get.apply(this,C)}},{key:"_getPixel",value:function(){this.loadPixels();for(var _=arguments.length,C=new Array(_),P=0;P<_;P++)C[P]=arguments[P];return l.default.Renderer2D.prototype._getPixel.apply(this,C)}},{key:"set",value:function(_,C,P){this.loadedmetadata&&(this._ensureCanvas(),l.default.Renderer2D.prototype.set.call(this,_,C,P),this.setModified(!0))}},{key:"copy",value:function(){this._ensureCanvas();for(var _=arguments.length,C=new Array(_),P=0;P<_;P++)C[P]=arguments[P];l.default.prototype.copy.apply(this,C)}},{key:"mask",value:function(){this.loadPixels(),this.setModified(!0);for(var _=arguments.length,C=new Array(_),P=0;P<_;P++)C[P]=arguments[P];l.default.Image.prototype.mask.apply(this,C)}},{key:"isModified",value:function(){return this._modified}},{key:"setModified",value:function(_){this._modified=_}},{key:"onended",value:function(_){return this._onended=_,this}},{key:"connect",value:function(_){var C,P;if(typeof l.default.prototype.getAudioContext=="function")C=l.default.prototype.getAudioContext(),P=l.default.soundOut.input;else try{P=(C=_.context).destination}catch{throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=C.createMediaElementSource(this.elt),this.audioSourceNode.connect(P)),_?_.input?this.audioSourceNode.connect(_.input):this.audioSourceNode.connect(_):this.audioSourceNode.connect(P)}},{key:"disconnect",value:function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()}},{key:"showControls",value:function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0}},{key:"hideControls",value:function(){this.elt.controls=!1}},{key:"addCue",value:function(_,I,P){var A=this._cueIDCounter++,I=new v(I,_,A,P);return this._cues.push(I),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),A}},{key:"removeCue",value:function(_){for(var C=0;C<this._cues.length;C++)this._cues[C].id===_&&(console.log(_),this._cues.splice(C,1));this._cues.length===0&&(this.elt.ontimeupdate=null)}},{key:"clearCues",value:function(){this._cues=[],this.elt.ontimeupdate=null}},{key:"_onTimeUpdate",value:function(){for(var _=this.time(),C=0;C<this._cues.length;C++){var P=this._cues[C].time,A=this._cues[C].val;this._prevTime<P&&P<=_&&this._cues[C].callback(A)}this._prevTime=_}}]),k}(l.default.Element),l.default.MediaElement=r,r=function(){function x(w,S){y(this,x),this.file=w,this._pInst=S,S=w.type.split("/"),this.type=S[0],this.subtype=S[1],this.name=w.name,this.size=w.size,this.data=void 0}return u(x,null,[{key:"_createLoader",value:function(w,S){var k=new FileReader;return k.onload=function(_){var C,P=new l.default.File(w);P.file.type==="application/json"?P.data=JSON.parse(_.target.result):P.file.type==="text/xml"?(C=new DOMParser().parseFromString(_.target.result,"text/xml"),P.data=new l.default.XML(C.documentElement)):P.data=_.target.result,S(P)},k}},{key:"_load",value:function(w,S){var k;/^text\//.test(w.type)||w.type==="application/json"?l.default.File._createLoader(w,S).readAsText(w):/^(video|audio)\//.test(w.type)?((k=new l.default.File(w)).data=URL.createObjectURL(w),S(k)):l.default.File._createLoader(w,S).readAsDataURL(w)}}]),x}(),l.default.File=r,r=l.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.every":154,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243,"core-js/modules/web.url":245}],297:[function(g,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(g=g("../core/main"))&&g.__esModule?g:{default:g};i.default.prototype.deviceOrientation=1<window.innerWidth/window.innerHeight?"landscape":"portrait",i.default.prototype.accelerationX=0,i.default.prototype.accelerationY=0,i.default.prototype.accelerationZ=0,i.default.prototype.pAccelerationX=0,i.default.prototype.pAccelerationY=0,i.default.prototype.pAccelerationZ=0,i.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},i.default.prototype.rotationX=0,i.default.prototype.rotationY=0,i.default.prototype.rotationZ=0,i.default.prototype.pRotationX=0,i.default.prototype.pRotationY=0;var l=i.default.prototype.pRotationZ=0,c=0,u=0,f="clockwise",h="clockwise",d="clockwise",p=(i.default.prototype.pRotateDirectionX=void 0,i.default.prototype.pRotateDirectionY=void 0,i.default.prototype.pRotateDirectionZ=void 0,i.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},i.default.prototype.turnAxis=void 0,.5),y=30,g=(i.default.prototype.setMoveThreshold=function(b){i.default._validateParameters("setMoveThreshold",arguments),p=b},i.default.prototype.setShakeThreshold=function(b){i.default._validateParameters("setShakeThreshold",arguments),y=b},i.default.prototype._ondeviceorientation=function(b){this._updatePRotations(),this._setProperty("rotationX",this._fromDegrees(b.beta)),this._setProperty("rotationY",this._fromDegrees(b.gamma)),this._setProperty("rotationZ",this._fromDegrees(b.alpha)),this._handleMotion()},i.default.prototype._ondevicemotion=function(b){this._updatePAccelerations(),this._setProperty("accelerationX",2*b.acceleration.x),this._setProperty("accelerationY",2*b.acceleration.y),this._setProperty("accelerationZ",2*b.acceleration.z),this._handleMotion()},i.default.prototype._handleMotion=function(){window.orientation===90||window.orientation===-90?this._setProperty("deviceOrientation","landscape"):window.orientation===0?this._setProperty("deviceOrientation","portrait"):window.orientation===void 0&&this._setProperty("deviceOrientation","undefined");var b,m,v,x,w,S=this._isGlobal?window:this;typeof S.deviceMoved=="function"&&(Math.abs(this.accelerationX-this.pAccelerationX)>p||Math.abs(this.accelerationY-this.pAccelerationY)>p||Math.abs(this.accelerationZ-this.pAccelerationZ)>p)&&S.deviceMoved(),typeof S.deviceTurned=="function"&&(m=this._toDegrees(this.rotationX)+180,v=this._toDegrees(this.pRotationX)+180,b=l+180,0<m-v&&m-v<270||m-v<-270?f="clockwise":(m-v<0||270<m-v)&&(f="counter-clockwise"),f!==this.pRotateDirectionX&&(b=m),90<Math.abs(m-b)&&Math.abs(m-b)<270&&(b=m,this._setProperty("turnAxis","X"),S.deviceTurned()),this.pRotateDirectionX=f,l=b-180,v=this._toDegrees(this.rotationY)+180,m=this._toDegrees(this.pRotationY)+180,b=c+180,0<v-m&&v-m<270||v-m<-270?h="clockwise":(v-m<0||270<v-this.pRotationY)&&(h="counter-clockwise"),h!==this.pRotateDirectionY&&(b=v),90<Math.abs(v-b)&&Math.abs(v-b)<270&&(b=v,this._setProperty("turnAxis","Y"),S.deviceTurned()),this.pRotateDirectionY=h,c=b-180,0<(m=this._toDegrees(this.rotationZ))-(v=this._toDegrees(this.pRotationZ))&&m-v<270||m-v<-270?d="clockwise":(m-v<0||270<m-v)&&(d="counter-clockwise"),d!==this.pRotateDirectionZ&&(u=m),90<Math.abs(m-u)&&Math.abs(m-u)<270&&(u=m,this._setProperty("turnAxis","Z"),S.deviceTurned()),this.pRotateDirectionZ=d,this._setProperty("turnAxis",void 0)),typeof S.deviceShaken=="function"&&(this.pAccelerationX!==null&&(x=Math.abs(this.accelerationX-this.pAccelerationX),w=Math.abs(this.accelerationY-this.pAccelerationY)),y<x+w&&S.deviceShaken())},i.default);a.default=g},{"../core/main":280}],298:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};i.default.prototype.isKeyPressed=!1,i.default.prototype.keyIsPressed=!1,i.default.prototype.key="",i.default.prototype.keyCode=0,i.default.prototype._onkeydown=function(l){var c;this._downKeys[l.which]||(this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",l.which),this._downKeys[l.which]=!0,this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),typeof(c=this._isGlobal?window:this).keyPressed!="function"||l.charCode||c.keyPressed(l)===!1&&l.preventDefault())},i.default.prototype._onkeyup=function(l){this._downKeys[l.which]=!1,this._areDownKeys()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null),this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),this._setProperty("keyCode",l.which);var c=this._isGlobal?window:this;typeof c.keyReleased=="function"&&c.keyReleased(l)===!1&&l.preventDefault()},i.default.prototype._onkeypress=function(l){var c;l.which!==this._lastKeyCodeTyped&&(this._setProperty("_lastKeyCodeTyped",l.which),this._setProperty("key",l.key||String.fromCharCode(l.which)||l.which),typeof(c=this._isGlobal?window:this).keyTyped=="function"&&c.keyTyped(l)===!1&&l.preventDefault())},i.default.prototype._onblur=function(l){this._downKeys={}},i.default.prototype.keyIsDown=function(l){return i.default._validateParameters("keyIsDown",arguments),this._downKeys[l]||!1},i.default.prototype._areDownKeys=function(){for(var l in this._downKeys)if(this._downKeys.hasOwnProperty(l)&&this._downKeys[l]===!0)return!0;return!1},r=i.default,a.default=r},{"../core/main":280}],299:[function(r,s,a){function i(h){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(h)}function l(h){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(d){return i(d)}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":i(d)})(h)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(c=r("../core/main"))&&c.__esModule?c:{default:c},u=function(h){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var d=f();if(d&&d.has(h))return d.get(h);var p,y={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(p in h){var b;Object.prototype.hasOwnProperty.call(h,p)&&((b=g?Object.getOwnPropertyDescriptor(h,p):null)&&(b.get||b.set)?Object.defineProperty(y,p,b):y[p]=h[p])}return y.default=h,d&&d.set(h,y),y}(r("../core/constants"));function f(){var h;return typeof WeakMap!="function"?null:(h=new WeakMap,f=function(){return h},h)}c.default.prototype.movedX=0,c.default.prototype.movedY=0,c.default.prototype._hasMouseInteracted=!1,c.default.prototype.mouseX=0,c.default.prototype.mouseY=0,c.default.prototype.pmouseX=0,c.default.prototype.pmouseY=0,c.default.prototype.winMouseX=0,c.default.prototype.winMouseY=0,c.default.prototype.pwinMouseX=0,c.default.prototype.pwinMouseY=0,c.default.prototype.mouseButton=0,c.default.prototype.mouseIsPressed=!1,c.default.prototype._updateNextMouseCoords=function(h){var d,p,y,g,b;this._curElement!==null&&(!h.touches||0<h.touches.length)&&(d=this._curElement.elt,p=this.width,y=this.height,(g=h)&&!g.clientX&&(g.touches?g=g.touches[0]:g.changedTouches&&(g=g.changedTouches[0])),b=d.getBoundingClientRect(),p=d.scrollWidth/p||1,d=d.scrollHeight/y||1,y={x:(g.clientX-b.left)/p,y:(g.clientY-b.top)/d,winX:g.clientX,winY:g.clientY,id:g.identifier},this._setProperty("movedX",h.movementX),this._setProperty("movedY",h.movementY),this._setProperty("mouseX",y.x),this._setProperty("mouseY",y.y),this._setProperty("winMouseX",y.winX),this._setProperty("winMouseY",y.winY)),this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},c.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY),this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)},c.default.prototype._setMouseButton=function(h){h.button===1?this._setProperty("mouseButton",u.CENTER):h.button===2?this._setProperty("mouseButton",u.RIGHT):this._setProperty("mouseButton",u.LEFT)},c.default.prototype._onmousemove=function(h){var d=this._isGlobal?window:this;this._updateNextMouseCoords(h),this.mouseIsPressed?typeof d.mouseDragged=="function"?d.mouseDragged(h)===!1&&h.preventDefault():typeof d.touchMoved=="function"&&d.touchMoved(h)===!1&&h.preventDefault():typeof d.mouseMoved=="function"&&d.mouseMoved(h)===!1&&h.preventDefault()},c.default.prototype._onmousedown=function(h){var d=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(h),this._updateNextMouseCoords(h),this.touchstart||(typeof d.mousePressed=="function"?d.mousePressed(h)===!1&&h.preventDefault():typeof d.touchStarted=="function"&&d.touchStarted(h)===!1&&h.preventDefault(),this.touchstart=!1)},c.default.prototype._onmouseup=function(h){var d=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),this.touchend||(typeof d.mouseReleased=="function"?d.mouseReleased(h)===!1&&h.preventDefault():typeof d.touchEnded=="function"&&d.touchEnded(h)===!1&&h.preventDefault(),this.touchend=!1)},c.default.prototype._ondragend=c.default.prototype._onmouseup,c.default.prototype._ondragover=c.default.prototype._onmousemove,c.default.prototype._onclick=function(h){var d=this._isGlobal?window:this;typeof d.mouseClicked=="function"&&d.mouseClicked(h)===!1&&h.preventDefault()},c.default.prototype._ondblclick=function(h){var d=this._isGlobal?window:this;typeof d.doubleClicked=="function"&&d.doubleClicked(h)===!1&&h.preventDefault()},c.default.prototype._mouseWheelDeltaY=0,c.default.prototype._pmouseWheelDeltaY=0,c.default.prototype._onwheel=function(h){var d=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",h.deltaY),typeof d.mouseWheel=="function"&&(h.delta=h.deltaY,d.mouseWheel(h)===!1&&h.preventDefault())},c.default.prototype.requestPointerLock=function(){var h=this._curElement.elt;return h.requestPointerLock=h.requestPointerLock||h.mozRequestPointerLock,h.requestPointerLock?(h.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},c.default.prototype.exitPointerLock=function(){document.exitPointerLock()},r=c.default,a.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],300:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.touches=[],r.default.prototype._updateTouchCoords=function(i){if(this._curElement!==null){for(var l=[],c=0;c<i.touches.length;c++)l[c]=function(b,g,m,d){var p=4<arguments.length&&arguments[4]!==void 0?arguments[4]:0,y=b.getBoundingClientRect(),g=b.scrollWidth/g||1,b=b.scrollHeight/m||1,m=d.touches[p]||d.changedTouches[p];return{x:(m.clientX-y.left)/g,y:(m.clientY-y.top)/b,winX:m.clientX,winY:m.clientY,id:m.identifier}}(this._curElement.elt,this.width,this.height,i,c);this._setProperty("touches",l)}},r.default.prototype._ontouchstart=function(i){var l=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(i),this._updateNextMouseCoords(i),this._updateMouseCoords(),typeof l.touchStarted=="function"&&(l.touchStarted(i)===!1&&i.preventDefault(),this.touchstart=!0)},r.default.prototype._ontouchmove=function(i){var l=this._isGlobal?window:this;this._updateTouchCoords(i),this._updateNextMouseCoords(i),typeof l.touchMoved=="function"?l.touchMoved(i)===!1&&i.preventDefault():typeof l.mouseDragged=="function"&&l.mouseDragged(i)===!1&&i.preventDefault()},r.default.prototype._ontouchend=function(i){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(i),this._updateNextMouseCoords(i);var l=this._isGlobal?window:this;typeof l.touchEnded=="function"&&(l.touchEnded(i)===!1&&i.preventDefault(),this.touchend=!0)},r=r.default,a.default=r},{"../core/main":280}],301:[function(r,s,a){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.int32-array"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.int32-array"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,l,c,u,f={_toPixels:function(h){var d,p;return h instanceof ImageData?h.data:h.getContext("2d")?h.getContext("2d").getImageData(0,0,h.width,h.height).data:h.getContext("webgl")?(p=(d=h.getContext("webgl")).drawingBufferWidth*d.drawingBufferHeight*4,p=new Uint8Array(p),d.readPixels(0,0,h.width,h.height,d.RGBA,d.UNSIGNED_BYTE,p),p):void 0},_getARGB:function(h,d){return d*=4,h[3+d]<<24&4278190080|h[d]<<16&16711680|h[1+d]<<8&65280|255&h[2+d]},_setPixels:function(h,d){for(var p,y=0,g=h.length;y<g;y++)h[0+(p=4*y)]=(16711680&d[y])>>>16,h[1+p]=(65280&d[y])>>>8,h[2+p]=255&d[y],h[3+p]=(4278190080&d[y])>>>24},_toImageData:function(h){return h instanceof ImageData?h:h.getContext("2d").getImageData(0,0,h.width,h.height)},_createImageData:function(h,d){return f._tmpCanvas=document.createElement("canvas"),f._tmpCtx=f._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(h,d)},apply:function(h,b,p){var y=h.getContext("2d"),g=y.getImageData(0,0,h.width,h.height),b=b(g,p);b instanceof ImageData?y.putImageData(b,0,0,0,0,h.width,h.height):y.putImageData(g,0,0,0,0,h.width,h.height)},threshold:function(h){for(var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:.5,p=f._toPixels(h),y=Math.floor(255*d),g=0;g<p.length;g+=4){var b=void 0,b=y<=.2126*p[g]+.7152*p[g+1]+.0722*p[g+2]?255:0;p[g]=p[g+1]=p[g+2]=b}},gray:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4){var y=d[p],g=d[p+1],b=d[p+2];d[p]=d[p+1]=d[p+2]=.2126*y+.7152*g+.0722*b}},opaque:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4)d[p+3]=255;return d},invert:function(h){for(var d=f._toPixels(h),p=0;p<d.length;p+=4)d[p]=255-d[p],d[p+1]=255-d[p+1],d[p+2]=255-d[p+2]},posterize:function(h){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:4,p=f._toPixels(h);if(d<2||255<d)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var y=d-1,g=0;g<p.length;g+=4){var b=p[g],m=p[g+1],v=p[g+2];p[g]=255*(b*d>>8)/y,p[g+1]=255*(m*d>>8)/y,p[g+2]=255*(v*d>>8)/y}},dilate:function(h){for(var d,p,y,g,b,m,v,x,w,S=f._toPixels(h),k=0,_=S.length?S.length/4:0,C=new Int32Array(_);k<_;)for(p=(d=k)+h.width;k<p;)g=y=f._getARGB(S,k),(w=k-1)<d&&(w=k),p<=(x=k+1)&&(x=k),(b=k-h.width)<0&&(b=0),_<=(m=k+h.width)&&(m=k),b=f._getARGB(S,b),w=f._getARGB(S,w),m=f._getARGB(S,m),(g=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))<(v=77*(w>>16&255)+151*(w>>8&255)+28*(255&w))&&(y=w,g=v),g<(v=77*((w=f._getARGB(S,x))>>16&255)+151*(w>>8&255)+28*(255&w))&&(y=w,g=v),g<(x=77*(b>>16&255)+151*(b>>8&255)+28*(255&b))&&(y=b,g=x),g<(w=77*(m>>16&255)+151*(m>>8&255)+28*(255&m))&&(y=m,g=w),C[k++]=y;f._setPixels(S,C)},erode:function(h){for(var d,p,y,g,b,m,v,x,w,S=f._toPixels(h),k=0,_=S.length?S.length/4:0,C=new Int32Array(_);k<_;)for(p=(d=k)+h.width;k<p;)g=y=f._getARGB(S,k),(w=k-1)<d&&(w=k),p<=(x=k+1)&&(x=k),(b=k-h.width)<0&&(b=0),_<=(m=k+h.width)&&(m=k),b=f._getARGB(S,b),w=f._getARGB(S,w),m=f._getARGB(S,m),(v=77*(w>>16&255)+151*(w>>8&255)+28*(255&w))<(g=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))&&(y=w,g=v),(v=77*((w=f._getARGB(S,x))>>16&255)+151*(w>>8&255)+28*(255&w))<g&&(y=w,g=v),(x=77*(b>>16&255)+151*(b>>8&255)+28*(255&b))<g&&(y=b,g=x),(w=77*(m>>16&255)+151*(m>>8&255)+28*(255&m))<g&&(y=m,g=w),C[k++]=y;f._setPixels(S,C)},blur:function(h,d){for(var p,y,g,b,m,v,x,w,S,k,_=f._toPixels(h),C=h.width,P=h.height,A=C*P,I=new Int32Array(A),N=0;N<A;N++)I[N]=f._getARGB(_,N);var O,F,U,G,Y,$,H,Q,J=new Int32Array(A),ae=new Int32Array(A),T=new Int32Array(A),B=new Int32Array(A),W=0,K=3.5*d|0;if(i!==(K=K<1?1:K<248?K:248)){l=1+(i=K)<<1,c=new Int32Array(l),u=new Array(l);for(var te=0;te<l;te++)u[te]=new Int32Array(256);for(var ne=1,ce=K-1;ne<K;ne++){c[K+ne]=c[ce]=$=ce*ce,H=u[K+ne],Q=u[ce--];for(var fe=0;fe<256;fe++)H[fe]=Q[fe]=$*fe}Y=c[K]=K*K,H=u[K];for(var ue=0;ue<256;ue++)H[ue]=Y*ue}for(F=0;F<P;F++){for(O=0;O<C;O++){if(b=g=y=m=p=0,(v=O-i)<0)k=-v,v=0;else{if(C<=v)break;k=0}for(U=k;U<l&&!(C<=v);U++){var ge=I[v+W];G=u[U],m+=G[(-16777216&ge)>>>24],y+=G[(16711680&ge)>>16],g+=G[(65280&ge)>>8],b+=G[255&ge],p+=c[U],v++}J[x=W+O]=m/p,ae[x]=y/p,T[x]=g/p,B[x]=b/p}W+=C}for(S=(w=-i)*C,F=W=0;F<P;F++){for(O=0;O<C;O++){if(b=g=y=m=p=0,w<0)k=x=-w,v=O;else{if(P<=w)break;k=0,x=w,v=O+S}for(U=k;U<l&&!(P<=x);U++)G=u[U],m+=G[J[v]],y+=G[ae[v]],g+=G[T[v]],b+=G[B[v]],p+=c[U],x++,v+=C;I[O+W]=m/p<<24|y/p<<16|g/p<<8|b/p}W+=C,S+=C,w++}f._setPixels(_,I)}};a.default=f},{"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.int32-array":222,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239}],302:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("../core/main")),l=c(r("omggif"));function c(f){return f&&f.__esModule?f:{default:f}}function u(f){return function(h){if(Array.isArray(h)){for(var d=0,p=new Array(h.length);d<h.length;d++)p[d]=h[d];return p}}(f)||function(h){if(Symbol.iterator in Object(h)||Object.prototype.toString.call(h)==="[object Arguments]")return Array.from(h)}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.default.prototype.createImage=function(f,h){return i.default._validateParameters("createImage",arguments),new i.default.Image(f,h)},i.default.prototype.saveCanvas=function(){for(var f,h,d,p,y,g,b=arguments.length,m=new Array(b),v=0;v<b;v++)m[v]=arguments[v];switch(i.default._validateParameters("saveCanvas",m),m[0]instanceof HTMLCanvasElement?(f=m[0],m.shift()):m[0]instanceof i.default.Element?(f=m[0].elt,m.shift()):m[0]instanceof i.default.Framebuffer?(p=m[0],(y=this.createGraphics(p.width,p.height)).pixelDensity(pixelDensity()),p.loadPixels(),y.loadPixels(),y.pixels.set(p.pixels),y.updatePixels(),f=y.elt,m.shift()):f=this._curElement&&this._curElement.elt,1<=m.length&&(h=m[0]),d=(d=2<=m.length?m[1]:d)||i.default.prototype._checkFileExtension(h,d)[1]||"png"){default:g="image/png";break;case"jpeg":case"jpg":g="image/jpeg"}f.toBlob(function(x){i.default.prototype.downloadFile(x,h,d),y&&y.remove()},g)},i.default.prototype.encodeAndDownloadGif=function(f,h){for(var d=f.gifProperties,p=d.loopLimit,y=(p===1?p=null:p===null&&(p=0),new Uint8Array(f.width*f.height*d.numFrames)),g=[],b={},m=0;m<d.numFrames;m++){for(var v=new Set,x=d.frames[m].image.data,w=x.length,S=new Uint32Array(f.width*f.height),k=0,_=0;k<w;k+=4,_++){var C=x[k+0]<<16|x[k+1]<<8|x[k+2]<<0;v.add(C),S[_]=C}var P=u(v).sort().toString();b[P]===void 0?b[P]={freq:1,frames:[m]}:(b[P].freq+=1,b[P].frames.push(m)),g.push(S)}for(var N=[],A=Object.keys(b).sort(function(T,B){return b[B].freq-b[T].freq}),I=A[0].split(",").map(function(T){return parseInt(T)}),N=N.concat(b[I].frames),O=new Set(I),F=1;F<A.length;F++){var U=A[F].split(",").map(function(T){return parseInt(T)}).filter(function(T){return!O.has(T)});if(I.length+U.length<=256){for(var G=0;G<U.length;G++)I.push(U[G]),O.add(U[G]);N=N.concat(b[A[F]].frames)}}N=new Set(N);for(var Y={},$=0;$<I.length;$++)Y[I[$]]||(Y[I[$]]=$);for(var H=1;H<I.length;)H<<=1;I.length=H;for(var p={loop:p,palette:new Uint32Array(I)},Q=new l.default.GifWriter(y,f.width,f.height,p),J={},ae=0;ae<d.numFrames;ae++)(function(B){var W=!N.has(B),K=W?[]:I,te=new Uint8Array(f.width*f.height),ne={},ce=new Set,fe=(g[B].forEach(function(de,xe){W?(ne[de]===void 0&&(ne[de]=K.length,K.push(de)),te[xe]=ne[de]):te[xe]=Y[de],0<B&&g[B-1][xe]!==de&&ce.add(de)}),{}),ue=K.filter(function(de){return!ce.has(de)});if(0<ue.length){var ue=ue[0],ge=(W?ne:Y)[ue];if(0<B){for(var me=0;me<g[B].length;me++)g[B-1][me]===g[B][me]&&(te[me]=ge);fe.transparent=ge,J.frameOpts.disposal=1}}if(fe.delay=d.frames[B].delay/10,W){for(var oe=1;oe<K.length;)oe<<=1;K.length=oe,fe.palette=new Uint32Array(K)}0<B&&Q.addFrame(0,0,f.width,f.height,J.pixelPaletteIndex,J.frameOpts),J={pixelPaletteIndex:te,frameOpts:fe}})(ae);J.frameOpts.disposal=1,Q.addFrame(0,0,f.width,f.height,J.pixelPaletteIndex,J.frameOpts),p=new Blob([y.slice(0,Q.end())],{type:"image/gif"}),i.default.prototype.downloadFile(p,h,"gif")},i.default.prototype.saveFrames=function(f,h,d,g,y){i.default._validateParameters("saveFrames",arguments),d=i.default.prototype.constrain(d=d||3,0,15),d*=1e3;var g=i.default.prototype.constrain(g||15,0,22),b=0,m=i.default.prototype._makeFrame,v=this._curElement.elt,x=[],w=setInterval(function(){x.push(m(f+b,h,v)),b++},1e3/g);setTimeout(function(){if(clearInterval(w),y)y(x);else for(var S=0,k=x;S<k.length;S++){var _=k[S];i.default.prototype.downloadFile(_.imageData,_.filename,_.ext)}x=[]},.01+d)},i.default.prototype._makeFrame=function(f,h,y){var p,y=this?this._curElement.elt:y;if(h)switch(h.toLowerCase()){case"png":p="image/png";break;case"jpeg":case"jpg":p="image/jpeg";break;default:p="image/png"}else h="png",p="image/png";var y=(y=y.toDataURL(p)).replace(p,"image/octet-stream"),g={};return g.imageData=y,g.filename=f,g.ext=h,g},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243,omggif:253}],303:[function(r,s,a){function i(v){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function l(v){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(x){return i(x)}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":i(x)})(v)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.copy-within"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint8-clamped-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.copy-within"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.uint8-clamped-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r("regenerator-runtime/runtime");var c=y(r("../core/main")),u=y(r("../core/helpers")),f=function(v){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var x=p();if(x&&x.has(v))return x.get(v);var w,S={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(w in v){var _;Object.prototype.hasOwnProperty.call(v,w)&&((_=k?Object.getOwnPropertyDescriptor(v,w):null)&&(_.get||_.set)?Object.defineProperty(S,w,_):S[w]=v[w])}return S.default=v,x&&x.set(v,S),S}(r("../core/constants")),h=y(r("omggif")),d=r("gifenc");function p(){var v;return typeof WeakMap!="function"?null:(v=new WeakMap,p=function(){return v},v)}function y(v){return v&&v.__esModule?v:{default:v}}function g(v,x,w,S,k,_,C){try{var P=v[_](C),A=P.value}catch(I){return void w(I)}P.done?x(A):Promise.resolve(A).then(S,k)}function b(v,x,w,S,k,_,C,P,A,I,N){var O,F,U,G,Y,$,H,Q,J;return v===f.COVER&&(O=x,U=w,H=_,Q=C,$=P,J=A,F=I,G=N,Y=Math.max(H/F,Q/G),H/=Y,Q/=Y,Y=$,$=J,O===f.CENTER?Y+=(F-H)/2:O===f.RIGHT&&(Y+=F-H),U===f.CENTER?$+=(G-Q)/2:U===f.BOTTOM&&($+=G-Q),P=(J={x:Y,y:$,w:H,h:Q}).x,A=J.y,I=J.w,N=J.h),v===f.CONTAIN&&(O=x,F=w,U=S,G=k,Y=_,$=C,H=I,Q=N,J=Math.max(H/Y,Q/$),H/=J,Q/=J,J=U,U=G,O===f.CENTER?J+=(Y-H)/2:O===f.RIGHT&&(J+=Y-H),F===f.CENTER?U+=($-Q)/2:F===f.BOTTOM&&(U+=$-Q),S=(v={x:J,y:U,w:H,h:Q}).x,k=v.y,_=v.w,C=v.h),{sx:P,sy:A,sw:I,sh:N,dx:S,dy:k,dw:_,dh:C}}function m(v,x){return 0<v&&v<x?v:x}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.loadImage=function(v,x,w){c.default._validateParameters("loadImage",arguments);var S=new c.default.Image(1,1,this),k=this,_=new Request(v,{method:"GET",mode:"cors"});return fetch(v,_).then(function(C){var P,A=C.headers.get("content-type");A===null&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),A&&A.includes("image/gif")?C.arrayBuffer().then(function(I){if(I){for(var I=new Uint8Array(I),N=S,O=x,F=w,U=(function(W){k._decrementPreload()}).bind(k),G=new h.default.GifReader(I),Y=(N.width=N.canvas.width=G.width,N.height=N.canvas.height=G.height,[]),$=G.numFrames(),H=new Uint8ClampedArray(N.width*N.height*4),Q=0;Q<$;Q++){var J=G.frameInfo(Q),ae=N.drawingContext.getImageData(0,0,N.width,N.height),T=(H=ae.data.slice(),function(W,K){try{K.decodeAndBlitFrameRGBA(W,H)}catch(te){c.default._friendlyFileLoadError(8,N.src),typeof F=="function"?F(te):console.error(te)}}(Q,G),new ImageData(H,N.width,N.height)),T=(N.drawingContext.putImageData(T,0,0),J.delay);T===0&&(T=10),Y.push({image:N.drawingContext.getImageData(0,0,N.width,N.height),delay:10*T}),J.disposal===2?N.drawingContext.clearRect(J.x,J.y,J.width,J.height):J.disposal===3&&N.drawingContext.putImageData(ae,0,0,J.x,J.y,J.width,J.height)}(I=G.loopCount())===null?I=1:I===0&&(I=null),N.drawingContext.putImageData(Y[0].image,0,0),1<Y.length&&(N.gifProperties={displayIndex:0,loopLimit:I,loopCount:0,frames:Y,numFrames:$,playing:!0,timeDisplayed:0,lastChangeTime:0}),typeof O=="function"&&O(N),U()}},function(I){typeof w=="function"?(w(I),k._decrementPreload()):console.error(I)}):((P=new Image).onload=function(){S.width=S.canvas.width=P.width,S.height=S.canvas.height=P.height,S.drawingContext.drawImage(P,0,0),S.modified=!0,typeof x=="function"&&x(S),k._decrementPreload()},P.onerror=function(I){c.default._friendlyFileLoadError(0,P.src),typeof w=="function"?(w(I),k._decrementPreload()):console.error(I)},v.indexOf("data:image/")!==0&&(P.crossOrigin="Anonymous"),P.src=v),S.modified=!0}).catch(function(C){c.default._friendlyFileLoadError(0,v),typeof w=="function"?(w(C),k._decrementPreload()):console.error(C)}),S},c.default.prototype.saveGif=function(){v=regeneratorRuntime.mark(function w(S,k){var _,C,P,A,I,N,O,F,U,G,Y,$,H,Q,J,ae,T,B,W,K,te,ne,ce,fe,ue,ge,me=arguments;return regeneratorRuntime.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(_=2<me.length&&me[2]!==void 0?me[2]:{delay:0,units:"seconds",silent:!1,notificationDuration:0,notificationID:"progressBar"},typeof S!="string")throw TypeError("fileName parameter must be a string");oe.next=3;break;case 3:if(typeof k!="number")throw TypeError("Duration parameter must be a number");oe.next=5;break;case 5:if(C=_&&_.delay||0,P=_&&_.units||"seconds",A=_&&_.silent||!1,I=_&&_.notificationDuration||0,N=_&&_.notificationID||"progressBar",typeof C!="number")throw TypeError("Delay parameter must be a number");oe.next=12;break;case 12:if(P!=="seconds"&&P!=="frames")throw TypeError('Units parameter must be either "frames" or "seconds"');oe.next=14;break;case 14:if(typeof A!="boolean")throw TypeError("Silent parameter must be a boolean");oe.next=16;break;case 16:if(typeof I!="number")throw TypeError("Notification duration parameter must be a number");oe.next=18;break;case 18:if(typeof N!="string")throw TypeError("Notification ID parameter must be a string");oe.next=20;break;case 20:return this._recording=!0,G=this._targetFrameRate,O=(O=1/(G=G!==1/0&&G!==void 0&&G!==0?G:60)*1e3)<20?20:O,U=(F=P==="seconds"?k*G:k)+(G=P==="seconds"?C*G:C),G=G,this.frameCount=G,Y=this._pixelDensity,this.pixelDensity(1),$=[],document.getElementById(N)!==null&&document.getElementById(N).remove(),A||((H=this.createP("")).id(N),H.style("font-size","16px"),H.style("font-family","Montserrat"),H.style("background-color","#ffffffa0"),H.style("padding","8px"),H.style("border-radius","10px"),H.position(0,0)),this._renderer instanceof c.default.RendererGL&&(J=this.drawingContext,Q=new Uint8Array(J.drawingBufferWidth*J.drawingBufferHeight*4)),this.noLoop(),oe.next=39,Promise.resolve();case 39:if(G<U)return this.redraw(),fe=void 0,fe=this._renderer instanceof c.default.RendererGL?(Q=new Uint8Array(J.drawingBufferWidth*J.drawingBufferHeight*4),J.readPixels(0,0,J.drawingBufferWidth,J.drawingBufferHeight,J.RGBA,J.UNSIGNED_BYTE,Q),function(de,xe,Ie){for(var we=parseInt(Ie/2),_e=4*xe,Ae=new Uint8Array(4*xe),$e=0;$e<we;++$e){var Fe=$e*_e,ut=(Ie-$e-1)*_e;Ae.set(de.subarray(Fe,Fe+_e)),de.copyWithin(Fe,ut,ut+_e),de.set(Ae,ut)}return de}(Q,this.width,this.height)):this.drawingContext.getImageData(0,0,this.width,this.height).data,$.push(fe),G++,A||H.html("Saved frame <b>"+$.length.toString()+"</b> out of "+F.toString()),oe.next=48,new Promise(function(de){return setTimeout(de,0)});oe.next=50;break;case 48:oe.next=39;break;case 50:A||H.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(Y),ae=(0,d.GIFEncoder)(),T=function(de){for(var xe=new Uint8Array(de.length*de[0].length),Ie=0;Ie<de.length;Ie++)xe.set(de[Ie],Ie*de[0].length);var we=(0,d.quantize)(xe,256,{format:"rgba4444",oneBitAlpha:!0});return we.length===256?we[we.length-1]=[255*Math.random(),255*Math.random(),255*Math.random(),0]:we.push([255*Math.random(),255*Math.random(),255*Math.random(),0]),we}($),B={},W=function(de){for(var xe=de.length/4,Ie=new Uint8Array(xe),we=0;we<xe;we++){var _e=de[4*we]<<24|de[4*we+1]<<16|de[4*we+2]<<8|de[4*we+3];B[_e]===void 0&&(B[_e]=(0,d.nearestColorIndex)(T,de.slice(4*we,4*(we+1)))),Ie[we]=B[_e]}return Ie},K=T.length-1,te=[],ne=0;case 60:if(!(ne<$.length)){oe.next=71;break}if(ce=W($[ne]),fe=ce.slice(),ne===0)ae.writeFrame(ce,this.width,this.height,{palette:T,delay:O,dispose:1});else{for(ue=0;ue<ce.length;ue++)ce[ue]===te[ue]&&(ce[ue]=K);ae.writeFrame(ce,this.width,this.height,{delay:O,transparent:!0,transparentIndex:K,dispose:1})}return te=fe,A||H.html("Rendered frame <b>"+ne.toString()+"</b> out of "+F.toString()),oe.next=68,new Promise(function(de){return setTimeout(de,0)});case 68:ne++,oe.next=60;break;case 71:ae.finish(),ge=ae.bytesView(),ge=new Blob([ge],{type:"image/gif"}),$=[],this._recording=!1,this.loop(),A||(H.html("Done. Downloading your gif!\u{1F338}"),0<I&&setTimeout(function(){return H.remove()},1e3*I)),c.default.prototype.downloadFile(ge,S,"gif");case 80:case"end":return oe.stop()}},w,this)});var v,x=function(){var w=this,S=arguments;return new Promise(function(k,_){var C=v.apply(w,S);function P(I){g(C,k,_,P,A,"next",I)}function A(I){g(C,k,_,P,A,"throw",I)}P(void 0)})};return function(w,S){return x.apply(this,arguments)}}(),c.default.prototype.image=function(v,x,w,S,G,Y,$,H,J,I,N,O){c.default._validateParameters("image",arguments);var Q=v.width,F=v.height,U=(O=O||f.CENTER,N=N||f.CENTER,v.elt&&(Q=Q!==void 0?Q:v.elt.width,F=F!==void 0?F:v.elt.height),v.elt&&v.elt.videoWidth&&!v.canvas&&(Q=Q!==void 0?Q:v.elt.videoWidth,F=F!==void 0?F:v.elt.videoHeight),S||Q),G=G||F,Y=Y||0,$=$||0,H=m(H!==void 0?H:Q,Q),Q=m(J!==void 0?J:F,F),J=1;v.elt&&!v.canvas&&v.elt.style.width&&(J=v.elt.videoWidth&&!S?v.elt.videoWidth:v.elt.width,J/=parseInt(v.elt.style.width,10)),Y*=J,$*=J,Q*=J,H*=J,F=b(I,N,O,(F=u.default.modeAdjust(x,w,U,G,this._renderer._imageMode)).x,F.y,F.w,F.h,Y,$,H,Q),this._renderer.image(v,F.sx,F.sy,F.sw,F.sh,F.dx,F.dy,F.dw,F.dh)},c.default.prototype.tint=function(){for(var v=arguments.length,x=new Array(v),w=0;w<v;w++)x[w]=arguments[w];c.default._validateParameters("tint",x);var S=this.color.apply(this,x);this._renderer._tint=S.levels},c.default.prototype.noTint=function(){this._renderer._tint=null},c.default.prototype._getTintedImageCanvas=c.default.Renderer2D.prototype._getTintedImageCanvas,c.default.prototype.imageMode=function(v){c.default._validateParameters("imageMode",arguments),v!==f.CORNER&&v!==f.CORNERS&&v!==f.CENTER||(this._renderer._imageMode=v)},r=c.default,a.default=r},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/helpers":276,"../core/main":280,"core-js/modules/es.array.copy-within":153,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.typed-array.uint8-clamped-array":240,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,gifenc:250,omggif:253,"regenerator-runtime/runtime":257}],304:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("../core/main")),l=c(r("./filters"));function c(f){return f&&f.__esModule?f:{default:f}}function u(f,h){for(var d=0;d<h.length;d++){var p=h[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(f,p.key,p)}}i.default.Image=function(){function f(p,y){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");this.width=p,this.height=y,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),(this._pixelsState=this)._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]}var h,d;return h=f,(d=[{key:"pixelDensity",value:function(p){return p!==void 0?(p<=0&&(i.default._friendlyParamError({type:"INVALID_VALUE",format:{types:["Number"]},position:1},"pixelDensity"),p=1),this._pixelDensity=p,this.width/=p,this.height/=p,this):this._pixelDensity}},{key:"_animateGif",value:function(b){var y,g=this.gifProperties,b=b._lastRealFrameTime;g.lastChangeTime===0&&(g.lastChangeTime=b),g.playing&&(g.timeDisplayed=b-g.lastChangeTime,y=g.frames[g.displayIndex].delay,g.timeDisplayed>=y&&(y=Math.floor(g.timeDisplayed/y),g.timeDisplayed=0,g.lastChangeTime=b,g.displayIndex+=y,g.loopCount=Math.floor(g.displayIndex/g.numFrames),g.loopLimit!==null&&g.loopCount>=g.loopLimit?g.playing=!1:(b=g.displayIndex%g.numFrames,this.drawingContext.putImageData(g.frames[b].image,0,0),g.displayIndex=b,this.setModified(!0))))}},{key:"_setProperty",value:function(p,y){this[p]=y,this.setModified(!0)}},{key:"loadPixels",value:function(){i.default.Renderer2D.prototype.loadPixels.call(this),this.setModified(!0)}},{key:"updatePixels",value:function(p,y,g,b){i.default.Renderer2D.prototype.updatePixels.call(this,p,y,g,b),this.setModified(!0)}},{key:"get",value:function(p,y,g,b){return i.default._validateParameters("p5.Image.get",arguments),i.default.Renderer2D.prototype.get.apply(this,arguments)}},{key:"_getPixel",value:function(){for(var p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];return i.default.Renderer2D.prototype._getPixel.apply(this,y)}},{key:"set",value:function(p,y,g){i.default.Renderer2D.prototype.set.call(this,p,y,g),this.setModified(!0)}},{key:"resize",value:function(p,y){p===0&&y===0?(p=this.canvas.width,y=this.canvas.height):p===0?p=this.canvas.width*y/this.canvas.height:y===0&&(y=this.canvas.height*p/this.canvas.width),p=Math.floor(p),y=Math.floor(y);var g=document.createElement("canvas");if(g.width=p,g.height=y,this.gifProperties)for(var b=this.gifProperties,m=0;m<b.numFrames;m++){for(var v=this.drawingContext.createImageData(p,y),x=(C=C=_=k=S=void 0,b.frames[m].image),w=v,S=0,k=0;k<w.height;k++)for(var _=0;_<w.width;_++){var C=Math.floor(_*x.width/w.width),C=4*(Math.floor(k*x.height/w.height)*x.width+C);w.data[S++]=x.data[C++],w.data[S++]=x.data[C++],w.data[S++]=x.data[C++],w.data[S++]=x.data[+C]}b.frames[m].image=v}g.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,g.width,g.height),this.canvas.width=this.width=p,this.canvas.height=this.height=y,this.drawingContext.drawImage(g,0,0,p,y,0,0,p,y),0<this.pixels.length&&this.loadPixels(),this.setModified(!0)}},{key:"copy",value:function(){for(var p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];i.default.prototype.copy.apply(this,y)}},{key:"mask",value:function(p){var y=this.drawingContext.globalCompositeOperation,g=1,b=[p=p===void 0?this:p,0,0,(g=p instanceof i.default.Renderer?p._pInst._pixelDensity:g)*p.width,g*p.height,0,0,this.width,this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(var m=0;m<this.gifProperties.frames.length;m++)this.drawingContext.putImageData(this.gifProperties.frames[m].image,0,0),this.copy.apply(this,b),this.gifProperties.frames[m].image=this.drawingContext.getImageData(0,0,this.width,this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else this.copy.apply(this,b);this.drawingContext.globalCompositeOperation=y,this.setModified(!0)}},{key:"filter",value:function(p,y){l.default.apply(this.canvas,l.default[p],y),this.setModified(!0)}},{key:"blend",value:function(){for(var p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];i.default._validateParameters("p5.Image.blend",arguments),i.default.prototype.blend.apply(this,y),this.setModified(!0)}},{key:"setModified",value:function(p){this._modified=p}},{key:"isModified",value:function(){return this._modified}},{key:"save",value:function(p,y){this.gifProperties?i.default.prototype.encodeAndDownloadGif(this,p):i.default.prototype.saveCanvas(this.canvas,p,y)}},{key:"reset",value:function(){var p;this.gifProperties&&((p=this.gifProperties).playing=!0,p.timeSinceStart=0,p.timeDisplayed=0,p.lastChangeTime=0,p.loopCount=0,p.displayIndex=0,this.drawingContext.putImageData(p.frames[0].image,0,0))}},{key:"getCurrentFrame",value:function(){var p;if(this.gifProperties)return(p=this.gifProperties).displayIndex%p.numFrames}},{key:"setFrame",value:function(p){var y;this.gifProperties&&(p<(y=this.gifProperties).numFrames&&0<=p?(y.timeDisplayed=0,y.lastChangeTime=0,y.displayIndex=p,this.drawingContext.putImageData(y.frames[p].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero."))}},{key:"numFrames",value:function(){if(this.gifProperties)return this.gifProperties.numFrames}},{key:"play",value:function(){this.gifProperties&&(this.gifProperties.playing=!0)}},{key:"pause",value:function(){this.gifProperties&&(this.gifProperties.playing=!1)}},{key:"delay",value:function(p,y){if(this.gifProperties){var g=this.gifProperties;if(y<g.numFrames&&0<=y)g.frames[y].delay=p;else{var b=!0,y=!1,m=void 0;try{for(var v,x=g.frames[Symbol.iterator]();!(b=(v=x.next()).done);b=!0)v.value.delay=p}catch(S){y=!0,m=S}finally{try{b||x.return==null||x.return()}finally{if(y)throw m}}}}}}])&&u(h.prototype,d),f}(),r=i.default.Image,a.default=r},{"../core/main":280,"./filters":301,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],305:[function(r,s,a){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.filter"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("../core/main")),l=c(r("./filters"));function c(u){return u&&u.__esModule?u:{default:u}}r("../color/p5.Color"),i.default.prototype.pixels=[],i.default.prototype.blend=function(){for(var u,f=arguments.length,h=new Array(f),d=0;d<f;d++)h[d]=arguments[d];i.default._validateParameters("blend",h),this._renderer?(u=this._renderer).blend.apply(u,h):i.default.Renderer2D.prototype.blend.apply(this,h)},i.default.prototype.copy=function(){for(var u,f,h,d,p,y,g,b,m,v=arguments.length,x=new Array(v),w=0;w<v;w++)x[w]=arguments[w];if(i.default._validateParameters("copy",x),x.length===9)u=x[0],f=x[1],h=x[2],d=x[3],p=x[4],y=x[5],g=x[6],b=x[7],m=x[8];else{if(x.length!==8)throw new Error("Signature not supported");u=this,f=x[0],h=x[1],d=x[2],p=x[3],y=x[4],g=x[5],b=x[6],m=x[7]}i.default.prototype._copyHelper(this,u,f,h,d,p,y,g,b,m)},i.default.prototype._copyHelper=function(u,f,h,d,p,y,g,b,m,v){var x=f.canvas.width/f.width,w=0,S=0;f._renderer&&f._renderer.isP3D&&(w=f.width/2,S=f.height/2),u._renderer&&u._renderer.isP3D?(u.push(),u.resetMatrix(),u.noLights(),u.blendMode(u.BLEND),u.imageMode(u.CORNER),i.default.RendererGL.prototype.image.call(u._renderer,f,h+w,d+S,p,y,g,b,m,v),u.pop()):u.drawingContext.drawImage(f.canvas,x*(h+w),x*(d+S),x*p,x*y,g,b,m,v)},i.default.prototype.getFilterGraphicsLayer=function(){return this._renderer.getFilterGraphicsLayer()},i.default.prototype.filter=function(){for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];i.default._validateParameters("filter",f);var g=(function(){var b,m={shader:void 0,operation:void 0,value:void 0,useWebGL:!0};return(arguments.length<=0?void 0:arguments[0])instanceof i.default.Shader?m.shader=arguments.length<=0?void 0:arguments[0]:(m.operation=arguments.length<=0?void 0:arguments[0],1<arguments.length&&typeof(arguments.length<=1?void 0:arguments[1])=="number"&&(m.value=arguments.length<=1?void 0:arguments[1]),((b=arguments.length-1)<0||arguments.length<=b?void 0:arguments[b])===!1&&(m.useWebGL=!1)),m}).apply(void 0,f),d=g.shader,p=g.operation,y=g.value,g=g.useWebGL;this._renderer.isP3D&&d?i.default.RendererGL.prototype.filter.call(this._renderer,d):g||this._renderer.isP3D?(!g&&this._renderer.isP3D&&console.warn("filter() with useWebGL=false is not supported in WEBGL"),this._renderer.isP3D?i.default.RendererGL.prototype.filter.call(this._renderer,p,y):((d=this.getFilterGraphicsLayer()).copy(this._renderer,0,0,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height),this._renderer.clear(),this._renderer.resetMatrix(),d.filter.apply(d,f),this.copy(d._renderer,0,0,this.width,this.height,0,0,this.width,this.height),d.clear())):this.canvas!==void 0?l.default.apply(this.canvas,l.default[p],y):l.default.apply(this.elt,l.default[p],y)},i.default.prototype.get=function(u,f,h,d){var p;return i.default._validateParameters("get",arguments),(p=this._renderer).get.apply(p,arguments)},i.default.prototype.loadPixels=function(){for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];i.default._validateParameters("loadPixels",f),this._renderer.loadPixels()},i.default.prototype.set=function(u,f,h){this._renderer.set(u,f,h)},i.default.prototype.updatePixels=function(u,f,h,d){i.default._validateParameters("updatePixels",arguments),this.pixels.length!==0&&this._renderer.updatePixels(u,f,h,d)},r=i.default,a.default=r},{"../color/p5.Color":267,"../core/main":280,"./filters":301,"core-js/modules/es.array.filter":156}],306:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.promise"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/web.url"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=f(r("../core/main")),c=(r("whatwg-fetch"),r("es6-promise/auto"),f(r("fetch-jsonp"))),u=f(r("file-saver"));function f(y){return y&&y.__esModule?y:{default:y}}function h(y){return(h=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}function d(y){return y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function p(y,g){g&&g!==!0&&g!=="true"||(g="");var b="";return(y=y||"untitled")&&y.includes(".")&&(b=y.split(".").pop()),g&&b!==g&&(b=g,y="".concat(y,".").concat(b)),[y,b]}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),l.default.prototype.loadJSON=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];l.default._validateParameters("loadJSON",g);for(var m,v,x,w=g[0],S={},k="json",_=1;_<g.length;_++){var C=g[_];typeof C=="string"?C!=="jsonp"&&C!=="json"||(k=C):typeof C=="function"?m?v=C:m=C:h(C)==="object"&&(C.hasOwnProperty("jsonpCallback")||C.hasOwnProperty("jsonpCallbackFunction"))&&(k="jsonp",x=C)}var P=this;return this.httpDo(w,"GET",x,k,function(A){for(var I in A)S[I]=A[I];m!==void 0&&m(A),P._decrementPreload()},function(A){if(l.default._friendlyFileLoadError(5,w),!v)throw A;v(A)}),S},l.default.prototype.loadStrings=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];l.default._validateParameters("loadStrings",g);for(var m,v,x=[],w=1;w<g.length;w++){var S=g[w];typeof S=="function"&&(m===void 0?m=S:v===void 0&&(v=S))}var k=this;return l.default.prototype.httpDo.call(this,g[0],"GET","text",function(_){for(var C=_.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/),P=0,A=C.length;P<A;P+=32768)Array.prototype.push.apply(x,C.slice(P,Math.min(P+32768,A)));m!==void 0&&m(x),k._decrementPreload()},function(_){if(l.default._friendlyFileLoadError(3,_),!v)throw _;v(_)}),x},l.default.prototype.loadTable=function(y){var g,b,m,v=!1,x=y.substring(y.lastIndexOf(".")+1,y.length);x==="csv"?m=",":x==="ssv"?m=";":x==="tsv"&&(m="	");for(var w=1;w<arguments.length;w++)typeof arguments[w]=="function"?g===void 0?g=arguments[w]:b===void 0&&(b=arguments[w]):typeof arguments[w]=="string"&&(arguments[w]==="header"&&(v=!0),arguments[w]==="csv"?m=",":arguments[w]==="ssv"?m=";":arguments[w]==="tsv"&&(m="	"));var S=new l.default.Table,k=this;return this.httpDo(y,"GET","table",function(_){for(var C,P,A={},I=0,N=[],O=0,F=null,U=function(){A.currentState=I,A.token=""},G=function(){F.push(A.token),U()},Y=function(){A.currentState=4,N.push(F),F=null};;){if((C=_[O++])==null){if(A.escaped)throw new Error("Unclosed quote in file.");if(F){G(),Y();break}}if(F===null&&(A.escaped=!1,F=[],U()),A.currentState===I){if(C==='"'){A.escaped=!0,A.currentState=1;continue}A.currentState=1}if(A.currentState===1&&A.escaped)if(C==='"')_[O]==='"'?(A.token+='"',O++):(A.escaped=!1,A.currentState=2);else{if(C==="\r")continue;A.token+=C}else C==="\r"?(_[O]===`
`&&O++,G(),Y()):C===`
`?(G(),Y()):C===m?G():A.currentState===1&&(A.token+=C)}if(v)S.columns=N.shift();else for(var $=0;$<N[0].length;$++)S.columns[$]="null";for(var H=0;H<N.length;H++)(N[H].length!==1||N[H][0]!=="undefined"&&N[H][0]!=="")&&((P=new l.default.TableRow).arr=N[H],P.obj=function(Q,J){if((J=J||[])===void 0)for(var ae=0;ae<Q.length;ae++)J[ae.toString()]=ae;return Object.fromEntries(J.map(function(T,B){return[T,Q[B]]}))}(N[H],S.columns),S.addRow(P));typeof g=="function"&&g(S),k._decrementPreload()},function(_){l.default._friendlyFileLoadError(2,y),b?b(_):console.error(_)}),S},l.default.prototype.loadXML=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];for(var m,v,x=new l.default.XML,w=1;w<g.length;w++){var S=g[w];typeof S=="function"&&(m===void 0?m=S:v===void 0&&(v=S))}var k=this;return this.httpDo(g[0],"GET","xml",function(_){for(var C in _)x[C]=_[C];m!==void 0&&m(x),k._decrementPreload()},function(_){if(l.default._friendlyFileLoadError(1,_),!v)throw _;v(_)}),x},l.default.prototype.loadBytes=function(y,g,b){var m={},v=this;return this.httpDo(y,"GET","arrayBuffer",function(x){m.bytes=new Uint8Array(x),typeof g=="function"&&g(m),v._decrementPreload()},function(x){if(l.default._friendlyFileLoadError(6,y),!b)throw x;b(x)}),m},l.default.prototype.httpGet=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];return l.default._validateParameters("httpGet",g),g.splice(1,0,"GET"),l.default.prototype.httpDo.apply(this,g)},l.default.prototype.httpPost=function(){for(var y=arguments.length,g=new Array(y),b=0;b<y;b++)g[b]=arguments[b];return l.default._validateParameters("httpPost",g),g.splice(1,0,"POST"),l.default.prototype.httpDo.apply(this,g)},l.default.prototype.httpDo=function(){for(var y,g,b,m={},v=0,x="text/plain",w=arguments.length-1;0<w&&typeof(w<0||arguments.length<=w?void 0:arguments[w])=="function";w--)v++;var S=arguments.length-v,k=arguments.length<=0?void 0:arguments[0];if(S==2&&typeof k=="string"&&h(arguments.length<=1?void 0:arguments[1])==="object")N=new Request(k,arguments.length<=1?void 0:arguments[1]),g=arguments.length<=2?void 0:arguments[2],b=arguments.length<=3?void 0:arguments[3];else{for(var _,C="GET",P=1;P<arguments.length;P++){var A=P<0||arguments.length<=P?void 0:arguments[P];if(typeof A=="string")A==="GET"||A==="POST"||A==="PUT"||A==="DELETE"?C=A:A==="json"||A==="jsonp"||A==="binary"||A==="arrayBuffer"||A==="xml"||A==="text"||A==="table"?y=A:_=A;else if(typeof A=="number")_=A.toString();else if(h(A)==="object")if(A.hasOwnProperty("jsonpCallback")||A.hasOwnProperty("jsonpCallbackFunction"))for(var I in A)m[I]=A[I];else x=A instanceof l.default.XML?(_=A.serialize(),"application/xml"):(_=JSON.stringify(A),"application/json");else typeof A=="function"&&(g?b=A:g=A)}var S=C==="GET"?new Headers:new Headers({"Content-Type":x}),N=new Request(k,{method:C,mode:"cors",body:_,headers:S})}return(S=(S=(y=y||(k.includes("json")?"json":k.includes("xml")?"xml":"text"))==="jsonp"?(0,c.default)(k,m):fetch(N)).then(function(O){if(!O.ok)throw(F=new Error(O.body)).status=O.status,F.ok=!1,F;var F=0;switch((F=y!=="jsonp"?O.headers.get("content-length"):F)&&64e6<F&&l.default._friendlyFileLoadError(7,k),y){case"json":case"jsonp":return O.json();case"binary":return O.blob();case"arrayBuffer":return O.arrayBuffer();case"xml":return O.text().then(function(U){return U=new DOMParser().parseFromString(U,"text/xml"),new l.default.XML(U.documentElement)});default:return O.text()}})).then(g||function(){}),S.catch(b||console.error),S},window.URL=window.URL||window.webkitURL,l.default.prototype._pWriters=[],l.default.prototype.createWriter=function(y,g){var b,m;for(m in l.default.prototype._pWriters)if(l.default.prototype._pWriters[m].name===y)return b=new l.default.PrintWriter(y+this.millis(),g),l.default.prototype._pWriters.push(b),b;return b=new l.default.PrintWriter(y,g),l.default.prototype._pWriters.push(b),b},l.default.PrintWriter=function(y,g){var b=this;this.name=y,this.content="",this.write=function(m){this.content+=m},this.print=function(m){this.content+="".concat(m,`
`)},this.clear=function(){this.content=""},this.close=function(){var m,v=[];for(m in v.push(this.content),l.default.prototype.writeFile(v,y,g),l.default.prototype._pWriters)l.default.prototype._pWriters[m].name===this.name&&l.default.prototype._pWriters.splice(m,1);b.clear(),b={}}},l.default.prototype.save=function(y,g,b){var m=arguments,v=(this._curElement||this).elt;if(m.length===0)l.default.prototype.saveCanvas(v);else if(m[0]instanceof l.default.Renderer||m[0]instanceof l.default.Graphics)l.default.prototype.saveCanvas(m[0].elt,m[1],m[2]);else if(m.length===1&&typeof m[0]=="string")l.default.prototype.saveCanvas(v,m[0]);else switch(p(m[1],m[2])[1]){case"json":return void l.default.prototype.saveJSON(m[0],m[1],m[2]);case"txt":return void l.default.prototype.saveStrings(m[0],m[1],m[2]);default:m[0]instanceof Array?l.default.prototype.saveStrings(m[0],m[1],m[2]):m[0]instanceof l.default.Table?l.default.prototype.saveTable(m[0],m[1],m[2]):m[0]instanceof l.default.Image?l.default.prototype.saveCanvas(m[0].canvas,m[1]):m[0]instanceof l.default.SoundFile&&l.default.prototype.saveSound(m[0],m[1],m[2],m[3])}},l.default.prototype.saveJSON=function(y,g,b){l.default._validateParameters("saveJSON",arguments),b=b?JSON.stringify(y):JSON.stringify(y,void 0,2),this.saveStrings(b.split(`
`),g,"json")},l.default.prototype.saveJSONObject=l.default.prototype.saveJSON,l.default.prototype.saveJSONArray=l.default.prototype.saveJSON,l.default.prototype.saveStrings=function(y,g,b,m){l.default._validateParameters("saveStrings",arguments);for(var v=this.createWriter(g,b||"txt"),x=0;x<y.length;x++)m?v.write(y[x]+`\r
`):v.write(y[x]+`
`);v.close(),v.clear()},l.default.prototype.saveTable=function(y,g,b){l.default._validateParameters("saveTable",arguments),m=b===void 0?g.substring(g.lastIndexOf(".")+1,g.length):b;var m,v=this.createWriter(g,m),x=y.columns,w=m==="tsv"?"	":",";if(m!=="html"){if(x[0]!=="0"){for(var S=0;S<x.length;S++)S<x.length-1?v.write(x[S]+w):v.write(x[S]);v.write(`
`)}for(var k=0;k<y.rows.length;k++){for(var _=void 0,_=0;_<y.rows[k].arr.length;_++)_<y.rows[k].arr.length-1?m==="csv"&&String(y.rows[k].arr[_]).includes(",")?v.write('"'+y.rows[k].arr[_]+'"'+w):v.write(y.rows[k].arr[_]+w):m==="csv"&&String(y.rows[k].arr[_]).includes(",")?v.write('"'+y.rows[k].arr[_]+'"'):v.write(y.rows[k].arr[_]);v.write(`
`)}}else{if(v.print("<html>"),v.print("<head>"),v.print('  <meta http-equiv="content-type" content="text/html;charset=utf-8" />'),v.print("</head>"),v.print("<body>"),v.print("  <table>"),x[0]!=="0"){v.print("    <tr>");for(var C=0;C<x.length;C++){var P=d(x[C]);v.print("      <td>".concat(P)),v.print("      </td>")}v.print("    </tr>")}for(var A=0;A<y.rows.length;A++){v.print("    <tr>");for(var I=0;I<y.columns.length;I++){var N=d(y.rows[A].getString(I));v.print("      <td>".concat(N)),v.print("      </td>")}v.print("    </tr>")}v.print("  </table>"),v.print("</body>"),v.print("</html>")}v.close(),v.clear()},l.default.prototype.writeFile=function(v,g,b){var m="application/octet-stream",v=(l.default.prototype._isSafari()&&(m="text/plain"),new Blob(v,{type:m}));l.default.prototype.downloadFile(v,g,b)},l.default.prototype.downloadFile=function(y,v,x){var m,v=p(v,x),x=v[0];y instanceof Blob?u.default.saveAs(y,x):((m=document.createElement("a")).href=y,m.download=x,m.onclick=function(w){document.body.removeChild(w.target),w.stopPropagation()},m.style.display="none",document.body.appendChild(m),l.default.prototype._isSafari()&&(y=(y=`Hello, Safari user! To download this file...
1. Go to File --> Save As.
2. Choose "Page Source" as the Format.
`)+'3. Name it with this extension: ."'.concat(v[1],'"'),alert(y)),m.click())},l.default.prototype._checkFileExtension=p,l.default.prototype._isSafari=function(){return window.HTMLElement.toString().includes("Constructor")},r=l.default,a.default=r},{"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.object.from-entries":182,"core-js/modules/es.object.to-string":187,"core-js/modules/es.promise":188,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/web.dom-collections.iterator":243,"core-js/modules/web.url":245,"es6-promise/auto":246,"fetch-jsonp":248,"file-saver":249,"whatwg-fetch":258}],307:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.replace"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}i.default.Table=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.columns=[],this.rows=[]}var u,f;return u=c,(f=[{key:"addRow",value:function(h){if(h=h||new i.default.TableRow,h.arr===void 0||h.obj===void 0)throw new Error("invalid TableRow: ".concat(h));return(h.table=this).rows.push(h),h}},{key:"removeRow",value:function(h){this.rows[h].table=null,h=this.rows.splice(h+1,this.rows.length),this.rows.pop(),this.rows=this.rows.concat(h)}},{key:"getRow",value:function(h){return this.rows[h]}},{key:"getRows",value:function(){return this.rows}},{key:"findRow",value:function(h,d){if(typeof d=="string"){for(var p=0;p<this.rows.length;p++)if(this.rows[p].obj[d]===h)return this.rows[p]}else for(var y=0;y<this.rows.length;y++)if(this.rows[y].arr[d]===h)return this.rows[y];return null}},{key:"findRows",value:function(h,d){var p=[];if(typeof d=="string")for(var y=0;y<this.rows.length;y++)this.rows[y].obj[d]===h&&p.push(this.rows[y]);else for(var g=0;g<this.rows.length;g++)this.rows[g].arr[d]===h&&p.push(this.rows[g]);return p}},{key:"matchRow",value:function(h,d){if(typeof d=="number"){for(var p=0;p<this.rows.length;p++)if(this.rows[p].arr[d].match(h))return this.rows[p]}else for(var y=0;y<this.rows.length;y++)if(this.rows[y].obj[d].match(h))return this.rows[y];return null}},{key:"matchRows",value:function(h,d){var p=[];if(typeof d=="number")for(var y=0;y<this.rows.length;y++)this.rows[y].arr[d].match(h)&&p.push(this.rows[y]);else for(var g=0;g<this.rows.length;g++)this.rows[g].obj[d].match(h)&&p.push(this.rows[g]);return p}},{key:"getColumn",value:function(h){var d=[];if(typeof h=="string")for(var p=0;p<this.rows.length;p++)d.push(this.rows[p].obj[h]);else for(var y=0;y<this.rows.length;y++)d.push(this.rows[y].arr[h]);return d}},{key:"clearRows",value:function(){delete this.rows,this.rows=[]}},{key:"addColumn",value:function(h){this.columns.push(h||null)}},{key:"getColumnCount",value:function(){return this.columns.length}},{key:"getRowCount",value:function(){return this.rows.length}},{key:"removeTokens",value:function(h,d){for(var p=[],y=0;y<h.length;y++)p.push(h.charAt(y).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var g=new RegExp(p.join("|"),"g");if(d===void 0)for(var b=0;b<this.columns.length;b++)for(var m=0;m<this.rows.length;m++){var v=(v=this.rows[m].arr[b]).replace(g,"");this.rows[m].arr[b]=v,this.rows[m].obj[this.columns[b]]=v}else if(typeof d=="string")for(var x=0;x<this.rows.length;x++){var w=(w=this.rows[x].obj[d]).replace(g,""),S=(this.rows[x].obj[d]=w,this.columns.indexOf(d));this.rows[x].arr[S]=w}else for(var k=0;k<this.rows.length;k++){var _=(_=this.rows[k].arr[d]).replace(g,"");this.rows[k].arr[d]=_,this.rows[k].obj[this.columns[d]]=_}}},{key:"trim",value:function(h){var d=new RegExp(" ","g");if(h===void 0)for(var p=0;p<this.columns.length;p++)for(var y=0;y<this.rows.length;y++){var g=(g=this.rows[y].arr[p]).replace(d,"");this.rows[y].arr[p]=g,this.rows[y].obj[this.columns[p]]=g}else if(typeof h=="string")for(var b=0;b<this.rows.length;b++){var m=(m=this.rows[b].obj[h]).replace(d,""),v=(this.rows[b].obj[h]=m,this.columns.indexOf(h));this.rows[b].arr[v]=m}else for(var x=0;x<this.rows.length;x++){var w=(w=this.rows[x].arr[h]).replace(d,"");this.rows[x].arr[h]=w,this.rows[x].obj[this.columns[h]]=w}}},{key:"removeColumn",value:function(y){typeof y=="string"?p=this.columns.indexOf(d=y):d=this.columns[p=y];var d,p,y=this.columns.splice(p+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(y);for(var g=0;g<this.rows.length;g++){var b=this.rows[g].arr,m=b.splice(p+1,b.length);b.pop(),this.rows[g].arr=b.concat(m),delete this.rows[g].obj[d]}}},{key:"set",value:function(h,d,p){this.rows[h].set(d,p)}},{key:"setNum",value:function(h,d,p){this.rows[h].setNum(d,p)}},{key:"setString",value:function(h,d,p){this.rows[h].setString(d,p)}},{key:"get",value:function(h,d){return this.rows[h].get(d)}},{key:"getNum",value:function(h,d){return this.rows[h].getNum(d)}},{key:"getString",value:function(h,d){return this.rows[h].getString(d)}},{key:"getObject",value:function(h){for(var d,p={},y=0;y<this.rows.length;y++)if(d=this.rows[y].obj,typeof h=="string"){if(!(0<=this.columns.indexOf(h)))throw new Error('This table has no column named "'.concat(h,'"'));p[d[h]]=d}else p[y]=this.rows[y].obj;return p}},{key:"getArray",value:function(){for(var h=[],d=0;d<this.rows.length;d++)h.push(this.rows[d].arr);return h}}])&&l(u.prototype,f),c}(),r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.join":165,"core-js/modules/es.array.splice":170,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.match":198,"core-js/modules/es.string.replace":201}],308:[function(r,s,a){r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.from-entries"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function i(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.TableRow=function(){function l(f,h){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");var d=[];f&&(d=f.split(h=h||",")),this.arr=d,this.obj=Object.fromEntries(d.entries()),this.table=null}var c,u;return c=l,(u=[{key:"set",value:function(f,h){if(typeof f=="string"){var d=this.table.columns.indexOf(f);if(!(0<=d))throw new Error('This table has no column named "'.concat(f,'"'));this.obj[f]=h,this.arr[d]=h}else{if(!(f<this.table.columns.length))throw new Error("Column #".concat(f," is out of the range of this table"));this.arr[f]=h,d=this.table.columns[f],this.obj[d]=h}}},{key:"setNum",value:function(f,h){h=parseFloat(h),this.set(f,h)}},{key:"setString",value:function(f,h){h=h.toString(),this.set(f,h)}},{key:"get",value:function(f){return(typeof f=="string"?this.obj:this.arr)[f]}},{key:"getNum",value:function(f){var h=parseFloat(typeof f=="string"?this.obj[f]:this.arr[f]);if(h.toString()==="NaN")throw"Error: ".concat(this.obj[f]," is NaN (Not a Number)");return h}},{key:"getString",value:function(f){return(typeof f=="string"?this.obj:this.arr)[f].toString()}}])&&i(c.prototype,u),l}(),r=r.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.from-entries":182,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.split":203,"core-js/modules/web.dom-collections.iterator":243}],309:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u,f){for(var h=0;h<f.length;h++){var d=f[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}function c(u){for(var f=[],h=0;h<u.length;h++)f.push(new i.default.XML(u[h]));return f}i.default.XML=function(){function u(d){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");d?this.DOM=d:(d=document.implementation.createDocument(null,"doc"),this.DOM=d.createElement("root"))}var f,h;return f=u,(h=[{key:"getParent",value:function(){return new i.default.XML(this.DOM.parentElement)}},{key:"getName",value:function(){return this.DOM.tagName}},{key:"setName",value:function(d){var p=this.DOM.innerHTML,y=this.DOM.attributes,g=document.implementation.createDocument(null,"default").createElement(d);g.innerHTML=p;for(var b=0;b<y.length;b++)g.setAttribute(y[b].nodeName,y.nodeValue);this.DOM=g}},{key:"hasChildren",value:function(){return 0<this.DOM.children.length}},{key:"listChildren",value:function(){for(var d=[],p=0;p<this.DOM.childNodes.length;p++)d.push(this.DOM.childNodes[p].nodeName);return d}},{key:"getChildren",value:function(d){return c(d?this.DOM.getElementsByTagName(d):this.DOM.children)}},{key:"getChild",value:function(d){if(typeof d!="string")return new i.default.XML(this.DOM.children[d]);var p=!0,y=!1,g=void 0;try{for(var b,m=this.DOM.children[Symbol.iterator]();!(p=(b=m.next()).done);p=!0){var v=b.value;if(v.tagName===d)return new i.default.XML(v)}}catch(x){y=!0,g=x}finally{try{p||m.return==null||m.return()}finally{if(y)throw g}}}},{key:"addChild",value:function(d){d instanceof i.default.XML&&this.DOM.appendChild(d.DOM)}},{key:"removeChild",value:function(d){var p=-1;if(typeof d=="string"){for(var y=0;y<this.DOM.children.length;y++)if(this.DOM.children[y].tagName===d){p=y;break}}else p=d;p!==-1&&this.DOM.removeChild(this.DOM.children[p])}},{key:"getAttributeCount",value:function(){return this.DOM.attributes.length}},{key:"listAttributes",value:function(){var d=[],p=!0,y=!1,g=void 0;try{for(var b,m=this.DOM.attributes[Symbol.iterator]();!(p=(b=m.next()).done);p=!0){var v=b.value;d.push(v.nodeName)}}catch(x){y=!0,g=x}finally{try{p||m.return==null||m.return()}finally{if(y)throw g}}return d}},{key:"hasAttribute",value:function(d){var p={},y=!0,g=!1,b=void 0;try{for(var m,v=this.DOM.attributes[Symbol.iterator]();!(y=(m=v.next()).done);y=!0){var x=m.value;p[x.nodeName]=x.nodeValue}}catch(w){g=!0,b=w}finally{try{y||v.return==null||v.return()}finally{if(g)throw b}}return!!p[d]}},{key:"getNum",value:function(d,p){var y={},g=!0,b=!1,m=void 0;try{for(var v,x=this.DOM.attributes[Symbol.iterator]();!(g=(v=x.next()).done);g=!0){var w=v.value;y[w.nodeName]=w.nodeValue}}catch(S){b=!0,m=S}finally{try{g||x.return==null||x.return()}finally{if(b)throw m}}return Number(y[d])||p||0}},{key:"getString",value:function(d,p){var y={},g=!0,b=!1,m=void 0;try{for(var v,x=this.DOM.attributes[Symbol.iterator]();!(g=(v=x.next()).done);g=!0){var w=v.value;y[w.nodeName]=w.nodeValue}}catch(S){b=!0,m=S}finally{try{g||x.return==null||x.return()}finally{if(b)throw m}}return y[d]?String(y[d]):p||null}},{key:"setAttribute",value:function(d,p){this.DOM.setAttribute(d,p)}},{key:"getContent",value:function(d){var p=this.DOM.textContent;return(p=p.replace(/\s\s+/g,","))||d||null}},{key:"setContent",value:function(d){this.DOM.children.length||(this.DOM.textContent=d)}},{key:"serialize",value:function(){return new XMLSerializer().serializeToString(this.DOM)}}])&&l(f.prototype,h),u}(),r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],310:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.string.includes"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c){return function(u){if(Array.isArray(u)){for(var f=0,h=new Array(u.length);f<u.length;f++)h[f]=u[f];return h}}(c)||function(u){if(Symbol.iterator in Object(u)||Object.prototype.toString.call(u)==="[object Arguments]")return Array.from(u)}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}i.default.prototype.abs=Math.abs,i.default.prototype.ceil=Math.ceil,i.default.prototype.constrain=function(c,u,f){return i.default._validateParameters("constrain",arguments),Math.max(Math.min(c,f),u)},i.default.prototype.dist=function(){for(var c=arguments.length,u=new Array(c),f=0;f<c;f++)u[f]=arguments[f];return i.default._validateParameters("dist",u),u.length===4?Math.hypot(u[2]-u[0],u[3]-u[1]):u.length===6?Math.hypot(u[3]-u[0],u[4]-u[1],u[5]-u[2]):void 0},i.default.prototype.exp=Math.exp,i.default.prototype.floor=Math.floor,i.default.prototype.lerp=function(c,u,f){return i.default._validateParameters("lerp",arguments),f*(u-c)+c},i.default.prototype.log=Math.log,i.default.prototype.mag=function(c,u){return i.default._validateParameters("mag",arguments),Math.hypot(c,u)},i.default.prototype.map=function(c,u,f,h,d,p){return i.default._validateParameters("map",arguments),c=(c-u)/(f-u)*(d-h)+h,p?h<d?this.constrain(c,h,d):this.constrain(c,d,h):c},i.default.prototype.max=function(){for(var c=function(d){return Math.max.apply(Math,l(d))},u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return Array.isArray(f[0])?c(f[0]):c(f)},i.default.prototype.min=function(){for(var c=function(d){return Math.min.apply(Math,l(d))},u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return Array.isArray(f[0])?c(f[0]):c(f)},i.default.prototype.norm=function(c,u,f){return i.default._validateParameters("norm",arguments),this.map(c,u,f,0,1)},i.default.prototype.pow=Math.pow,i.default.prototype.round=function(c,u){return u?(u=Math.pow(10,u),Math.round(c*u)/u):Math.round(c)},i.default.prototype.sq=function(c){return c*c},i.default.prototype.sqrt=Math.sqrt,i.default.prototype.fract=function(h){i.default._validateParameters("fract",arguments);var u,f=0,h=Number(h);return isNaN(h)||Math.abs(h)===1/0?h:(h<0&&(h=-h,f=1),String(h).includes(".")&&!String(h).includes("e")?(u=String(h),u=+("0"+u.slice(u.indexOf("."))),Math.abs(f-u)):h<1?Math.abs(f-h):0)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],311:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(u,f,h){return(l=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?Reflect.construct:function(d,p,y){var g=[null];return g.push.apply(g,p),p=new(Function.bind.apply(d,g)),y&&c(p,y.prototype),p}).apply(null,arguments)}function c(u,f){return(c=Object.setPrototypeOf||function(h,d){return h.__proto__=d,h})(u,f)}i.default.prototype.createVector=function(u,f,h){return this instanceof i.default?l(i.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments))):new i.default.Vector(u,f,h)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193}],312:[function(h,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,h=(h=h("../core/main"))&&h.__esModule?h:{default:h};function i(d){return .5*(1-Math.cos(d*Math.PI))}var l,c=4095,u=4,f=.5,h=(h.default.prototype.noise=function(d){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if(l==null){l=new Array(4096);for(var g=0;g<4096;g++)l[g]=Math.random()}d<0&&(d=-d),p<0&&(p=-p),y<0&&(y=-y);for(var b,m,v=Math.floor(d),x=Math.floor(p),w=Math.floor(y),S=d-v,k=p-x,_=y-w,C=0,P=.5,A=0;A<u;A++){var I=v+(x<<4)+(w<<8),N=i(S),O=i(k),F=l[I&c];F+=N*(l[I+1&c]-F),b=l[I+16&c],F+=O*((b+=N*(l[I+16+1&c]-b))-F),b=l[(I+=256)&c],b+=N*(l[I+1&c]-b),m=l[I+16&c],b+=O*((m+=N*(l[I+16+1&c]-m))-b),C+=(F+=i(_)*(b-F))*P,P*=f,v<<=1,x<<=1,w<<=1,1<=(S*=2)&&(v++,S--),1<=(k*=2)&&(x++,k--),1<=(_*=2)&&(w++,_--)}return C},h.default.prototype.noiseDetail=function(d,p){0<d&&(u=d),0<p&&(f=p)},h.default.prototype.noiseSeed=function(d){g=4294967296;var p,y,g,b={setSeed:function(v){y=p=(v??Math.random()*g)>>>0},getSeed:function(){return p},rand:function(){return(y=(1664525*y+1013904223)%g)/g}};b.setSeed(d),l=new Array(4096);for(var m=0;m<4096;m++)l[m]=b.rand()},h.default);a.default=h},{"../core/main":280}],313:[function(r,s,a){function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}function l(p){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(y){return i(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":i(y)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.number.is-finite"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.number.is-finite"),r("core-js/modules/es.string.sub"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(d=r("../core/main"))&&d.__esModule?d:{default:d},u=function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var y=f();if(y&&y.has(p))return y.get(p);var g,b={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=m?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,y&&y.set(p,b),b}(r("../core/constants"));function f(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,f=function(){return p},p)}function h(p,y){for(var g=0;g<y.length;g++){var b=y[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(p,b.key,b)}}c.default.Vector=function(){function p(){var w=this,m=p;if(!(w instanceof m))throw new TypeError("Cannot call a class as a function");var v,x,w=typeof(arguments.length<=0?void 0:arguments[0])=="function"?(this.isPInst=!0,this._fromRadians=arguments.length<=0?void 0:arguments[0],this._toRadians=arguments.length<=1?void 0:arguments[1],v=(arguments.length<=2?void 0:arguments[2])||0,x=(arguments.length<=3?void 0:arguments[3])||0,(arguments.length<=4?void 0:arguments[4])||0):(v=(arguments.length<=0?void 0:arguments[0])||0,x=(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0);this.x=v,this.y=x,this.z=w}var y,g,b;return y=p,b=[{key:"fromAngle",value:function(m,v){return new c.default.Vector((v=v===void 0?1:v)*Math.cos(m),v*Math.sin(m),0)}},{key:"fromAngles",value:function(_,S,x){x===void 0&&(x=1);var w=Math.cos(S),S=Math.sin(S),k=Math.cos(_),_=Math.sin(_);return new c.default.Vector(x*_*S,-x*k,x*_*w)}},{key:"random2D",value:function(){return this.fromAngle(Math.random()*u.TWO_PI)}},{key:"random3D",value:function(){var m=Math.random()*u.TWO_PI,v=2*Math.random()-1,w=Math.sqrt(1-v*v),x=w*Math.cos(m),w=w*Math.sin(m);return new c.default.Vector(x,w,v)}},{key:"copy",value:function(m){return m.copy(m)}},{key:"add",value:function(m,v,x){return x?x.set(m):(x=m.copy(),arguments.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),x.add(v),x}},{key:"rem",value:function(m,v){if(m instanceof c.default.Vector&&v instanceof c.default.Vector)return(m=m.copy()).rem(v),m}},{key:"sub",value:function(m,v,x){return x?x.set(m):(x=m.copy(),arguments.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),x.sub(v),x}},{key:"mult",value:function(m,v,x){return x?x.set(m):(x=m.copy(),arguments.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),x.mult(v),x}},{key:"rotate",value:function(m,v,x){return arguments.length===2?x=m.copy():(x instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),x.set(m)),x.rotate(v),x}},{key:"div",value:function(m,v,x){return x?x.set(m):(x=m.copy(),arguments.length===3&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),x.div(v),x}},{key:"dot",value:function(m,v){return m.dot(v)}},{key:"cross",value:function(m,v){return m.cross(v)}},{key:"dist",value:function(m,v){return m.dist(v)}},{key:"lerp",value:function(m,v,x,w){return w?w.set(m):(w=m.copy(),arguments.length===4&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),w.lerp(v,x),w}},{key:"slerp",value:function(m,v,x,w){return w?w.set(m):(w=m.copy(),arguments.length===4&&c.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")),w.slerp(v,x),w}},{key:"mag",value:function(m){return m.mag()}},{key:"magSq",value:function(m){return m.magSq()}},{key:"normalize",value:function(m,v){return arguments.length<2?v=m.copy():(v instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),v.set(m)),v.normalize()}},{key:"limit",value:function(m,v,x){return arguments.length<3?x=m.copy():(x instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),x.set(m)),x.limit(v)}},{key:"setMag",value:function(m,v,x){return arguments.length<3?x=m.copy():(x instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),x.set(m)),x.setMag(v)}},{key:"heading",value:function(m){return m.heading()}},{key:"angleBetween",value:function(m,v){return m.angleBetween(v)}},{key:"reflect",value:function(m,v,x){return arguments.length<3?x=m.copy():(x instanceof c.default.Vector||c.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),x.set(m)),x.reflect(v)}},{key:"array",value:function(m){return m.array()}},{key:"equals",value:function(m,v){var x;return m instanceof c.default.Vector?x=m:Array.isArray(m)?x=new c.default.Vector().set(m):c.default._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),x.equals(v)}}],(g=[{key:"toString",value:function(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")}},{key:"set",value:function(m,v,x){return m instanceof c.default.Vector?(this.x=m.x||0,this.y=m.y||0,this.z=m.z||0):Array.isArray(m)?(this.x=m[0]||0,this.y=m[1]||0,this.z=m[2]||0):(this.x=m||0,this.y=v||0,this.z=x||0),this}},{key:"copy",value:function(){return this.isPInst?new c.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z):new c.default.Vector(this.x,this.y,this.z)}},{key:"add",value:function(m,v,x){return m instanceof c.default.Vector?(this.x+=m.x||0,this.y+=m.y||0,this.z+=m.z||0):Array.isArray(m)?(this.x+=m[0]||0,this.y+=m[1]||0,this.z+=m[2]||0):(this.x+=m||0,this.y+=v||0,this.z+=x||0),this}},{key:"calculateRemainder2D",value:function(m,v){return m!==0&&(this.x=this.x%m),v!==0&&(this.y=this.y%v),this}},{key:"calculateRemainder3D",value:function(m,v,x){return m!==0&&(this.x=this.x%m),v!==0&&(this.y=this.y%v),x!==0&&(this.z=this.z%x),this}},{key:"rem",value:function(m,v,x){var w;if(m instanceof c.default.Vector){if([m.x,m.y,m.z].every(Number.isFinite))return S=parseFloat(m.x),k=parseFloat(m.y),w=parseFloat(m.z),this.calculateRemainder3D(S,k,w)}else if(Array.isArray(m)){if(m.every(function(_){return Number.isFinite(_)}))return m.length===2?this.calculateRemainder2D(m[0],m[1]):m.length===3?this.calculateRemainder3D(m[0],m[1],m[2]):void 0}else if(arguments.length===1){if(Number.isFinite(m)&&m!==0)return this.x=this.x%m,this.y=this.y%m,this.z=this.z%m,this}else if(arguments.length===2){var S=Array.prototype.slice.call(arguments);if(S.every(function(_){return Number.isFinite(_)})&&S.length===2)return this.calculateRemainder2D(S[0],S[1])}else if(arguments.length===3){var k=Array.prototype.slice.call(arguments);if(k.every(function(_){return Number.isFinite(_)})&&k.length===3)return this.calculateRemainder3D(k[0],k[1],k[2])}}},{key:"sub",value:function(m,v,x){return m instanceof c.default.Vector?(this.x-=m.x||0,this.y-=m.y||0,this.z-=m.z||0):Array.isArray(m)?(this.x-=m[0]||0,this.y-=m[1]||0,this.z-=m[2]||0):(this.x-=m||0,this.y-=v||0,this.z-=x||0),this}},{key:"mult",value:function(m,v,x){var w;return m instanceof c.default.Vector?Number.isFinite(m.x)&&Number.isFinite(m.y)&&Number.isFinite(m.z)&&typeof m.x=="number"&&typeof m.y=="number"&&typeof m.z=="number"?(this.x*=m.x,this.y*=m.y,this.z*=m.z):console.warn("p5.Vector.prototype.mult:","x contains components that are either undefined or not finite numbers"):Array.isArray(m)?m.every(function(S){return Number.isFinite(S)})&&m.every(function(S){return typeof S=="number"})?m.length===1?(this.x*=m[0],this.y*=m[0],this.z*=m[0]):m.length===2?(this.x*=m[0],this.y*=m[1]):m.length===3&&(this.x*=m[0],this.y*=m[1],this.z*=m[2]):console.warn("p5.Vector.prototype.mult:","x contains elements that are either undefined or not finite numbers"):(w=Array.prototype.slice.call(arguments)).every(function(S){return Number.isFinite(S)})&&w.every(function(S){return typeof S=="number"})?(arguments.length===1&&(this.x*=m,this.y*=m,this.z*=m),arguments.length===2&&(this.x*=m,this.y*=v),arguments.length===3&&(this.x*=m,this.y*=v,this.z*=x)):console.warn("p5.Vector.prototype.mult:","x, y, or z arguments are either undefined or not a finite number"),this}},{key:"div",value:function(m,v,x){if(m instanceof c.default.Vector)if(Number.isFinite(m.x)&&Number.isFinite(m.y)&&Number.isFinite(m.z)&&typeof m.x=="number"&&typeof m.y=="number"&&typeof m.z=="number"){var w=m.z===0&&this.z===0;if(m.x===0||m.y===0||!w&&m.z===0)return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this.x/=m.x,this.y/=m.y,w||(this.z/=m.z)}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if(Array.isArray(m))if(m.every(function(S){return Number.isFinite(S)})&&m.every(function(S){return typeof S=="number"})){if(m.some(function(S){return S===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;m.length===1?(this.x/=m[0],this.y/=m[0],this.z/=m[0]):m.length===2?(this.x/=m[0],this.y/=m[1]):m.length===3&&(this.x/=m[0],this.y/=m[1],this.z/=m[2])}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if(w=Array.prototype.slice.call(arguments),w.every(function(S){return Number.isFinite(S)})&&w.every(function(S){return typeof S=="number"})){if(w.some(function(S){return S===0}))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;arguments.length===1&&(this.x/=m,this.y/=m,this.z/=m),arguments.length===2&&(this.x/=m,this.y/=v),arguments.length===3&&(this.x/=m,this.y/=v,this.z/=x)}else console.warn("p5.Vector.prototype.div:","x, y, or z arguments are either undefined or not a finite number");return this}},{key:"mag",value:function(){return Math.sqrt(this.magSq())}},{key:"magSq",value:function(){var m=this.x,v=this.y,x=this.z;return m*m+v*v+x*x}},{key:"dot",value:function(m,v,x){return m instanceof c.default.Vector?this.dot(m.x,m.y,m.z):this.x*(m||0)+this.y*(v||0)+this.z*(x||0)}},{key:"cross",value:function(w){var v=this.y*w.z-this.z*w.y,x=this.z*w.x-this.x*w.z,w=this.x*w.y-this.y*w.x;return this.isPInst?new c.default.Vector(this._fromRadians,this._toRadians,v,x,w):new c.default.Vector(v,x,w)}},{key:"dist",value:function(m){return m.copy().sub(this).mag()}},{key:"normalize",value:function(){var m=this.mag();return m!==0&&this.mult(1/m),this}},{key:"limit",value:function(m){var v=this.magSq();return m*m<v&&this.div(Math.sqrt(v)).mult(m),this}},{key:"setMag",value:function(m){return this.normalize().mult(m)}},{key:"heading",value:function(){var m=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(m):m}},{key:"setHeading",value:function(m){this.isPInst&&(m=this._toRadians(m));var v=this.mag();return this.x=v*Math.cos(m),this.y=v*Math.sin(m),this}},{key:"rotate",value:function(v){var v=this.heading()+v,x=(this.isPInst&&(v=this._toRadians(v)),this.mag());return this.x=Math.cos(v)*x,this.y=Math.sin(v)*x,this}},{key:"angleBetween",value:function(m){var v;return this.magSq()*m.magSq()==0?NaN:(v=this.cross(m),m=Math.atan2(v.mag(),this.dot(m))*Math.sign(v.z||1),this.isPInst?this._fromRadians(m):m)}},{key:"lerp",value:function(m,v,x,w){return m instanceof c.default.Vector?this.lerp(m.x,m.y,m.z,v):(this.x+=(m-this.x)*w||0,this.y+=(v-this.y)*w||0,this.z+=(x-this.z)*w||0,this)}},{key:"slerp",value:function(m,v){if(v!==0){if(v===1)return this.set(m);var x=this.mag(),w=m.mag();if(x*w==0)this.mult(1-v).add(m.x*v,m.y*v,m.z*v);else{var S=this.cross(m),k=S.mag(),_=Math.atan2(k,this.dot(m));if(0<k)S.x/=k,S.y/=k,S.z/=k;else{if(_<.5*Math.PI)return this.mult(1-v).add(m.x*v,m.y*v,m.z*v),this;this.z===0&&m.z===0?S.set(0,0,1):this.x!==0?S.set(this.y,-this.x,0).normalize():S.set(1,0,0)}k=S.cross(this),m=1-v+v*w/x,S=m*Math.cos(v*_),w=m*Math.sin(v*_),this.x=this.x*S+k.x*w,this.y=this.y*S+k.y*w,this.z=this.z*S+k.z*w}}return this}},{key:"reflect",value:function(m){return m.normalize(),this.sub(m.mult(2*this.dot(m)))}},{key:"array",value:function(){return[this.x||0,this.y||0,this.z||0]}},{key:"equals",value:function(k,v,x){var w,S,k=k instanceof c.default.Vector?(w=k.x||0,S=k.y||0,k.z||0):Array.isArray(k)?(w=k[0]||0,S=k[1]||0,k[2]||0):(w=k||0,S=v||0,x||0);return this.x===w&&this.y===S&&this.z===k}}])&&h(y.prototype,g),b&&h(y,b),p}();var d=c.default.Vector;a.default=d},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.every":154,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.math.sign":177,"core-js/modules/es.number.constructor":178,"core-js/modules/es.number.is-finite":179,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],314:[function(f,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(f=f("../core/main"))&&f.__esModule?f:{default:f},l="_lcg_random_state",c=4294967296,u=0,f=(i.default.prototype._lcg=function(h){return this[h]=(1664525*this[h]+1013904223)%c,this[h]/c},i.default.prototype._lcgSetSeed=function(h,d){this[h]=(d??Math.random()*c)>>>0},i.default.prototype.randomSeed=function(h){this._lcgSetSeed(l,h),this._gaussian_previous=!1},i.default.prototype.random=function(h,d){var p,y;return i.default._validateParameters("random",arguments),p=this[l]!=null?this._lcg(l):Math.random(),h===void 0?p:d===void 0?Array.isArray(h)?h[Math.floor(p*h.length)]:p*h:(d<h&&(y=h,h=d,d=y),p*(d-h)+h)},i.default.prototype.randomGaussian=function(h){var d,p,y,g,b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;if(this._gaussian_previous)d=u,this._gaussian_previous=!1;else{for(;1<=(g=(p=this.random(2)-1)*p+(y=this.random(2)-1)*y););d=p*(g=Math.sqrt(-2*Math.log(g)/g)),u=y*g,this._gaussian_previous=!0}return d*b+(h||0)},i.default);a.default=f},{"../core/main":280}],315:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.prototype._angleMode=u.RADIANS,c.default.prototype.acos=function(d){return this._fromRadians(Math.acos(d))},c.default.prototype.asin=function(d){return this._fromRadians(Math.asin(d))},c.default.prototype.atan=function(d){return this._fromRadians(Math.atan(d))},c.default.prototype.atan2=function(d,p){return this._fromRadians(Math.atan2(d,p))},c.default.prototype.cos=function(d){return Math.cos(this._toRadians(d))},c.default.prototype.sin=function(d){return Math.sin(this._toRadians(d))},c.default.prototype.tan=function(d){return Math.tan(this._toRadians(d))},c.default.prototype.degrees=function(d){return d*u.RAD_TO_DEG},c.default.prototype.radians=function(d){return d*u.DEG_TO_RAD},c.default.prototype.angleMode=function(d){if(c.default._validateParameters("angleMode",arguments),d===void 0)return this._angleMode;d!==u.DEGREES&&d!==u.RADIANS||d!==this._angleMode&&(d===u.RADIANS?(this._setProperty("pRotationX",this.pRotationX*u.DEG_TO_RAD),this._setProperty("pRotationY",this.pRotationY*u.DEG_TO_RAD),this._setProperty("pRotationZ",this.pRotationZ*u.DEG_TO_RAD)):(this._setProperty("pRotationX",this.pRotationX*u.RAD_TO_DEG),this._setProperty("pRotationY",this.pRotationY*u.RAD_TO_DEG),this._setProperty("pRotationZ",this.pRotationZ*u.RAD_TO_DEG)),this._angleMode=d)},c.default.prototype._toRadians=function(d){return this._angleMode===u.DEGREES?d*u.DEG_TO_RAD:d},c.default.prototype._toDegrees=function(d){return this._angleMode===u.RADIANS?d*u.RAD_TO_DEG:d},c.default.prototype._fromRadians=function(d){return this._angleMode===u.DEGREES?d*u.RAD_TO_DEG:d},c.default.prototype._fromDegrees=function(d){return this._angleMode===u.RADIANS?d*u.DEG_TO_RAD:d};var h=c.default;a.default=h},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],316:[function(r,s,a){r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};i.default.prototype.textAlign=function(l,c){var u;return i.default._validateParameters("textAlign",arguments),(u=this._renderer).textAlign.apply(u,arguments)},i.default.prototype.textLeading=function(l){var c;return i.default._validateParameters("textLeading",arguments),(c=this._renderer).textLeading.apply(c,arguments)},i.default.prototype.textSize=function(l){var c;return i.default._validateParameters("textSize",arguments),(c=this._renderer).textSize.apply(c,arguments)},i.default.prototype.textStyle=function(l){var c;return i.default._validateParameters("textStyle",arguments),(c=this._renderer).textStyle.apply(c,arguments)},i.default.prototype.textWidth=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];if(c[0]+="",i.default._validateParameters("textWidth",c),c[0].length===0)return 0;for(var f=c[0].replace(/\t/g,"  ").split(/\r?\n|\r|\n/g),h=[],d=0;d<f.length;d++)h.push(this._renderer.textWidth(f[d]));return Math.max.apply(Math,h)},i.default.prototype.textAscent=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return i.default._validateParameters("textAscent",c),this._renderer.textAscent()},i.default.prototype.textDescent=function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return i.default._validateParameters("textDescent",c),this._renderer.textDescent()},i.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},i.default.prototype.textWrap=function(l){if(l!=="WORD"&&l!=="CHAR")throw"Error: textWrap accepts only WORD or CHAR";return this._renderer.textWrap(l)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203}],317:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}function l(y){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.last-index-of"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.split"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=d(r("../core/constants")),f=d(r("opentype.js"));function h(){var y;return typeof WeakMap!="function"?null:(y=new WeakMap,h=function(){return y},y)}function d(y){if(y&&y.__esModule)return y;if(y===null||l(y)!=="object"&&typeof y!="function")return{default:y};var g=h();if(g&&g.has(y))return g.get(y);var b,m,v={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in y)Object.prototype.hasOwnProperty.call(y,b)&&((m=x?Object.getOwnPropertyDescriptor(y,b):null)&&(m.get||m.set)?Object.defineProperty(v,b,m):v[b]=y[b]);return v.default=y,g&&g.set(y,v),v}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),c.default.prototype.loadFont=function(y,g,b){c.default._validateParameters("loadFont",arguments);var m=new c.default.Font(this),v=this;return f.load(y,function(S,k){if(S)return c.default._friendlyFileLoadError(4,y),b!==void 0?b(S):void console.error(S,y);m.font=k,g!==void 0&&g(m),v._decrementPreload();var S=y.split("\\").pop().split("/").pop(),k=S.lastIndexOf("."),_=k<1?null:S.slice(k+1);["ttf","otf","woff","woff2"].includes(_)&&(_=S.slice(0,k!==-1?k:0),(S=document.createElement("style")).appendChild(document.createTextNode(`
@font-face {
font-family: `.concat(_,`;
src: url(`).concat(y,`);
}
`))),document.head.appendChild(S))}),m},c.default.prototype.text=function(y,g,b,m,v){var x;return c.default._validateParameters("text",arguments),this._renderer._doFill||this._renderer._doStroke?(x=this._renderer).text.apply(x,arguments):this},c.default.prototype.textFont=function(y,g){if(c.default._validateParameters("textFont",arguments),arguments.length){if(y)return this._renderer._setProperty("_textFont",y),g&&(this._renderer._setProperty("_textSize",g),this._renderer._leadingSet||this._renderer._setProperty("_textLeading",g*u._DEFAULT_LEADMULT)),this._renderer._applyTextProperties();throw new Error("null font passed to textFont")}return this._renderer._textFont};var p=c.default;a.default=p},{"../core/constants":269,"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.last-index-of":166,"core-js/modules/es.array.slice":168,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,"opentype.js":254}],318:[function(r,s,a){function i(C){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P})(C)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.function.name"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(l=r("../core/main"))&&l.__esModule?l:{default:l},c=function(C){if(C&&C.__esModule)return C;if(C===null||f(C)!=="object"&&typeof C!="function")return{default:C};var P=u();if(P&&P.has(C))return P.get(C);var A,I={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(A in C){var O;Object.prototype.hasOwnProperty.call(C,A)&&((O=N?Object.getOwnPropertyDescriptor(C,A):null)&&(O.get||O.set)?Object.defineProperty(I,A,O):I[A]=C[A])}return I.default=C,P&&P.set(C,I),I}(r("../core/constants"));function u(){var C;return typeof WeakMap!="function"?null:(C=new WeakMap,u=function(){return C},C)}function f(C){return(f=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(P){return i(P)}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":i(P)})(C)}function h(C,P){for(var A=0;A<P.length;A++){var I=P[A];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(C,I.key,I)}}function d(C,P){var A=C.length;return C[P<0?P%A+A:P%A]}function p(C,P,A,I){var N,O,F;return I?(p.tmpPoint1===void 0&&(p.tmpPoint1=[],p.tmpPoint2=[]),O=p.tmpPoint1,F=p.tmpPoint2,O.x=P.x-C.x,O.y=P.y-C.y,F.x=A.x-P.x,F.y=A.y-P.y,N=O.x*F.x+O.y*F.y,O=Math.sqrt(O.x*O.x+O.y*O.y),F=Math.sqrt(F.x*F.x+F.y*F.y),Math.acos(N/(O*F))<I):(P[0]-C[0])*(A[1]-C[1])-(A[0]-C[0])*(P[1]-C[1])==0}function y(B,K,W,te,ne,O,F,U,G){var Y=1-G,H=Math.pow(Y,3),Q=Math.pow(Y,2),T=G*G,J=T*G,$=H*B+3*Q*G*W+3*Y*G*G*ne+J*F,H=H*K+3*Q*G*te+3*Y*G*G*O+J*U,Q=B+2*G*(W-B)+T*(ne-2*W+B),J=K+2*G*(te-K)+T*(O-2*te+K),ae=W+2*G*(ne-W)+T*(F-2*ne+W),T=te+2*G*(O-te)+T*(U-2*O+te),B=Y*B+G*W,W=Y*K+G*te,K=Y*ne+G*F,te=Y*O+G*U,ne=90-180*Math.atan2(Q-ae,J-T)/Math.PI;return(ae<Q||J<T)&&(ne+=180),{x:$,y:H,m:{x:Q,y:J},n:{x:ae,y:T},start:{x:B,y:W},end:{x:K,y:te},alpha:ne}}function g(C,P,A,I,N,O,F,U,G){return G==null?k(C,P,A,I,N,O,F,U):y(C,P,A,I,N,O,F,U,function(Y,$,H,Q,J,ae,T,B,W){if(!(W<0||k(Y,$,H,Q,J,ae,T,B)<W)){var K,te=.5,ne=1-te;for(K=k(Y,$,H,Q,J,ae,T,B,ne);.01<Math.abs(K-W);)K=k(Y,$,H,Q,J,ae,T,B,ne+=(K<W?1:-1)*(te/=2));return ne}}(C,P,A,I,N,O,F,U,G))}function b(C,P,A){for(var I,N,O,F,U,G=0,Y=0,$=(C=function(H,Q){function J(we,_e,Ae){var $e,Fe;if(!we)return["C",_e.x,_e.y,_e.x,_e.y,_e.x,_e.y];switch(we[0]in{T:1,Q:1}||(_e.qx=_e.qy=null),we[0]){case"M":_e.X=we[1],_e.Y=we[2];break;case"A":we=["C"].concat(v.apply(0,[_e.x,_e.y].concat(we.slice(1))));break;case"S":Fe=Ae==="C"||Ae==="S"?($e=2*_e.x-_e.bx,2*_e.y-_e.by):($e=_e.x,_e.y),we=["C",$e,Fe].concat(we.slice(1));break;case"T":Ae==="Q"||Ae==="T"?(_e.qx=2*_e.x-_e.qx,_e.qy=2*_e.y-_e.qy):(_e.qx=_e.x,_e.qy=_e.y),we=["C"].concat(S(_e.x,_e.y,_e.qx,_e.qy,we[1],we[2]));break;case"Q":_e.qx=we[1],_e.qy=we[2],we=["C"].concat(S(_e.x,_e.y,we[1],we[2],we[3],we[4]));break;case"L":we=["C"].concat(w(_e.x,_e.y,we[1],we[2]));break;case"H":we=["C"].concat(w(_e.x,_e.y,we[1],_e.y));break;case"V":we=["C"].concat(w(_e.x,_e.y,_e.x,we[1]));break;case"Z":we=["C"].concat(w(_e.x,_e.y,_e.X,_e.Y))}return we}function ae(we,_e){if(7<we[_e].length){we[_e].shift();for(var Ae=we[_e];Ae.length;)ce[_e]="A",K&&(fe[_e]="A"),we.splice(_e++,0,["C"].concat(Ae.splice(0,6)));we.splice(_e,1),B=Math.max(W.length,K&&K.length||0)}}function T(we,_e,Ae,$e,Fe){we&&_e&&we[Fe][0]==="M"&&_e[Fe][0]!=="M"&&(_e.splice(Fe,0,["M",$e.x,$e.y]),Ae.bx=0,Ae.by=0,Ae.x=we[Fe][1],Ae.y=we[Fe][2],B=Math.max(W.length,K&&K.length||0))}var B,W=m(H),K=Q&&m(Q),te={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},ne={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},ce=[],fe=[],ue="",ge="";B=Math.max(W.length,K&&K.length||0);for(var me=0;me<B;me++){(ue=W[me]?W[me][0]:ue)!=="C"&&(ce[me]=ue,me&&(ge=ce[me-1])),W[me]=J(W[me],te,ge),ce[me]!=="A"&&ue==="C"&&(ce[me]="C"),ae(W,me),K&&((ue=K[me]?K[me][0]:ue)!=="C"&&(fe[me]=ue,me&&(ge=fe[me-1])),K[me]=J(K[me],ne,ge),fe[me]!=="A"&&ue==="C"&&(fe[me]="C"),ae(K,me)),T(W,K,te,ne,me),T(K,W,ne,te,me);var oe=W[me],de=K&&K[me],xe=oe.length,Ie=K&&de.length;te.x=oe[xe-2],te.y=oe[xe-1],te.bx=parseFloat(oe[xe-4])||te.x,te.by=parseFloat(oe[xe-3])||te.y,ne.bx=K&&(parseFloat(de[Ie-4])||ne.x),ne.by=K&&(parseFloat(de[Ie-3])||ne.y),ne.x=K&&de[Ie-2],ne.y=K&&de[Ie-1]}return K?[W,K]:W}(C)).length;Y<$;Y++){if((O=C[Y])[0]==="M")I=+O[1],N=+O[2];else{if(P<G+(F=g(I,N,O[1],O[2],O[3],O[4],O[5],O[6]))&&!A)return{x:(U=g(I,N,O[1],O[2],O[3],O[4],O[5],O[6],P-G)).x,y:U.y,alpha:U.alpha};G+=F,I=+O[5],N=+O[6]}O.shift()}return U=(U=A?G:y(I,N,O[0],O[1],O[2],O[3],O[4],O[5],1)).alpha?{x:U.x,y:U.y,alpha:U.alpha}:U}function m(C){var P=[],A=0,I=0,N=0,O=0,F=0;if(C){C[0][0]==="M"&&(N=A=+C[0][1],O=I=+C[0][2],F++,P[0]=["M",A,I]);for(var U,G,Y=C.length===3&&C[0][0]==="M"&&C[1][0].toUpperCase()==="R"&&C[2][0].toUpperCase()==="Z",$=F,H=C.length;$<H;$++){if(P.push(U=[]),(G=C[$])[0]!==G[0].toUpperCase())switch(U[0]=G[0].toUpperCase(),U[0]){case"A":U[1]=G[1],U[2]=G[2],U[3]=G[3],U[4]=G[4],U[5]=G[5],U[6]=+(G[6]+A),U[7]=+(G[7]+I);break;case"V":U[1]=+G[1]+I;break;case"H":U[1]=+G[1]+A;break;case"R":for(var Q,J=2,ae=(Q=[A,I].concat(G.slice(1))).length;J<ae;J++)Q[J]=+Q[J]+A,Q[++J]=+Q[J]+I;P.pop(),P=P.concat(x(Q,Y));break;case"M":N=+G[1]+A,O=+G[2]+I;break;default:for(var T=1,B=G.length;T<B;T++)U[T]=+G[T]+(T%2?A:I)}else if(G[0]==="R")Q=[A,I].concat(G.slice(1)),P.pop(),P=P.concat(x(Q,Y)),U=["R"].concat(G.slice(-2));else for(var W=0,K=G.length;W<K;W++)U[W]=G[W];switch(U[0]){case"Z":A=N,I=O;break;case"H":A=U[1];break;case"V":I=U[1];break;case"M":N=U[U.length-2],O=U[U.length-1];break;default:A=U[U.length-2],I=U[U.length-1]}}}return P}function v(C,P,A,I,K,ce,te,U,G,Y){function $(Ie,we,_e){return{x:Ie*Math.cos(_e)-we*Math.sin(_e),y:Ie*Math.sin(_e)+we*Math.cos(_e)}}var H,B=Math.PI,W=120*B/180,Q=B/180*(+K||0),J=[],ae=(Y?(me=Y[0],H=Y[1],ue=Y[2],ge=Y[3]):(C=(ne=$(C,P,-Q)).x,P=ne.y,1<(ae=(T=(C-(U=(ne=$(U,G,-Q)).x))/2)*T/(A*A)+(ne=(P-(G=ne.y))/2)*ne/(I*I))&&(A*=ae=Math.sqrt(ae),I*=ae),ae=A*A,fe=I*I,ue=(ce=(ce===te?-1:1)*Math.sqrt(Math.abs((ae*fe-ae*ne*ne-fe*T*T)/(ae*ne*ne+fe*T*T))))*A*ne/I+(C+U)/2,ge=ce*-I*T/A+(P+G)/2,me=Math.asin(((P-ge)/I).toFixed(9)),H=Math.asin(((G-ge)/I).toFixed(9)),(me=C<ue?B-me:me)<0&&(me=2*B+me),(H=U<ue?B-H:H)<0&&(H=2*B+H),te&&H<me&&(me-=2*B),!te&&me<H&&(H-=2*B)),H-me),T=(Math.abs(ae)>W&&(fe=H,ne=U,ce=G,H=me+W*(te&&me<H?1:-1),J=v(U=ue+A*Math.cos(H),G=ge+I*Math.sin(H),A,I,K,0,te,ne,ce,[H,fe,ue,ge])),ae=H-me,Math.cos(me)),B=Math.sin(me),W=Math.cos(H),K=Math.sin(H),te=Math.tan(ae/4),ne=4/3*A*te,ce=4/3*I*te,fe=[C,P],ue=[C+ne*B,P-ce*T],ge=[U+ne*K,G-ce*W],me=[U,G];if(ue[0]=2*fe[0]-ue[0],ue[1]=2*fe[1]-ue[1],Y)return[ue,ge,me].concat(J);for(var oe=[],de=0,xe=(J=[ue,ge,me].concat(J).join().split(",")).length;de<xe;de++)oe[de]=de%2?$(J[de-1],J[de],Q).y:$(J[de],J[de+1],Q).x;return oe}function x(C,P){for(var A=[],I=0,N=C.length;I<N-2*!P;I+=2){var O=[{x:+C[I-2],y:+C[I-1]},{x:+C[I],y:+C[I+1]},{x:+C[I+2],y:+C[I+3]},{x:+C[I+4],y:+C[I+5]}];P?I?N-4===I?O[3]={x:+C[0],y:+C[1]}:N-2===I&&(O[2]={x:+C[0],y:+C[1]},O[3]={x:+C[2],y:+C[3]}):O[0]={x:+C[N-2],y:+C[N-1]}:N-4===I?O[3]=O[2]:I||(O[0]={x:+C[I],y:+C[I+1]}),A.push(["C",(-O[0].x+6*O[1].x+O[2].x)/6,(-O[0].y+6*O[1].y+O[2].y)/6,(O[1].x+6*O[2].x-O[3].x)/6,(O[1].y+6*O[2].y-O[3].y)/6,O[2].x,O[2].y])}return A}function w(C,P,A,I){return[C,P,A,I,A,I]}function S(C,P,A,I,N,O){return[1/3*C+2/3*A,1/3*P+2/3*I,1/3*N+2/3*A,1/3*O+2/3*I,N,O]}function k(C,P,A,I,N,O,F,U,G){for(var Y=(G=1<(G=G??1)?1:G<0?0:G)/2,$=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],H=0,Q=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],J=0;J<12;J++){var T=Y*$[J]+Y,ae=_(T,C,A,N,F),T=_(T,P,I,O,U);H+=Q[J]*Math.sqrt(ae*ae+T*T)}return Y*H}function _(C,P,A,I,N){return C*(C*(-3*P+9*A-9*I+3*N)+6*P-12*A+6*I)-3*P+3*A}l.default.Font=function(){function C(I){if(!(this instanceof C))throw new TypeError("Cannot call a class as a function");this.parent=I,this.cache={},this.font=void 0}var P,A;return P=C,(A=[{key:"textBounds",value:function(I){var N=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,O=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,Y=3<arguments.length?arguments[3]:void 0,F=4<arguments.length?arguments[4]:void 0,U=F&&F.renderer&&F.renderer._pInst||this.parent,G=U._renderer.drawingContext,Y=(G.textAlign||c.LEFT,G.textBaseline||c.BASELINE,Y||U._renderer._textSize);if(!ne){for(var $=[],H=[],Q=[],J=(Q[0]=[],[]),ae=this._scale(Y),T=U._renderer.textLeading(),B=0,W=(this.font.forEachGlyph(I,N,O,Y,F,function(ue,ge,me,oe){var de=ue.getMetrics();ue.index===0?Q[B+=1]=[]:(Q[B].push(ge+de.xMin*ae),Q[B].push(ge+de.xMax*ae),J.push(me+B*T+-de.yMin*ae),J.push(me+B*T+-de.yMax*ae))}),0<Q[B].length&&($[B]=Math.min.apply(null,Q[B]),H[B]=Math.max.apply(null,Q[B])),0),K=0;K<=B;K++){$[K]=Math.min.apply(null,Q[K]),H[K]=Math.max.apply(null,Q[K]);var te=H[K]-$[K];W<te&&(W=te)}var G=Math.min.apply(null,$),ne={x:G,y:O=Math.min.apply(null,J),h:Math.max.apply(null,J)-O,w:W,advance:G-N},Y=this._handleAlignment(U._renderer,I,ne.x,ne.y,ne.w+ne.advance);ne.x=Y.x,ne.y=Y.y}return ne}},{key:"textToPoints",value:function(I,N,O,F,U){var G=N,Y=[],$=I.split(/\r?\n|\r|\n/g);F=F||this.parent._renderer._textSize;for(var H,Q,J,ae=0;ae<$.length;ae++){var T=0;N=G;for(var B=(B=$[ae]).replace("	","  "),W=this._getGlyphs(B),K=0;K<W.length;K++){if(Q=B,!((J=W)[H=K].name&&J[H].name==="space"||Q.length===J.length&&Q[H]===" "))for(var te=function(ue){for(var ge,me=[],oe=0;oe<ue.length;oe++)ue[oe].type==="M"&&(ge&&me.push(ge),ge=[]),ge.push(function(de){var xe=[de.type];return de.type==="M"||de.type==="L"?xe.push(de.x,de.y):de.type==="C"?xe.push(de.x1,de.y1,de.x2,de.y2,de.x,de.y):de.type==="Q"&&xe.push(de.x1,de.y1,de.x,de.y),xe}(ue[oe]));return me.push(ge),me}(W[K].getPath(N,O,F).commands),ne=0;ne<te.length;ne++)for(var ce=function(ue,ge){for(var ge=function(we,_e){if(f(we)!=="object")we=_e;else for(var Ae in _e)we[Ae]===void 0&&(we[Ae]=_e[Ae]);return we}(ge,{sampleFactor:.1,simplifyThreshold:0}),me=b(ue,0,1),oe=me/(me*ge.sampleFactor),de=[],xe=0;xe<me;xe+=oe)de.push(b(ue,xe));return ge.simplifyThreshold&&function(Ie){for(var we=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,_e=0,Ae=Ie.length-1;3<Ie.length&&0<=Ae;--Ae)p(d(Ie,Ae-1),d(Ie,Ae),d(Ie,Ae+1),we)&&(Ie.splice(Ae%Ie.length,1),_e++)}(de,ge.simplifyThreshold),de}(te[ne],U),fe=0;fe<ce.length;fe++)ce[fe].x+=T,Y.push(ce[fe]);T+=W[K].advanceWidth*this._scale(F)}O+=this.parent._renderer._textLeading}return Y}},{key:"_getGlyphs",value:function(I){return this.font.stringToGlyphs(I)}},{key:"_getPath",value:function(I,G,O,F){var U=(F&&F.renderer&&F.renderer._pInst||this.parent)._renderer,G=this._handleAlignment(U,I,G,O);return this.font.getPath(I,G.x,G.y,U._textSize,F)}},{key:"_getPathData",value:function(I,N,O,F){var U=3;return typeof I=="string"&&2<arguments.length?I=this._getPath(I,N,O,F):f(N)==="object"&&(F=N),F&&typeof F.decimals=="number"&&(U=F.decimals),I.toPathData(U)}},{key:"_getSVG",value:function(I,N,O,F){var U=3;return typeof I=="string"&&2<arguments.length?I=this._getPath(I,N,O,F):f(N)==="object"&&(F=N),F&&(typeof F.decimals=="number"&&(U=F.decimals),typeof F.strokeWidth=="number"&&(I.strokeWidth=F.strokeWidth),F.fill!==void 0&&(I.fill=F.fill),F.stroke!==void 0&&(I.stroke=F.stroke)),I.toSVG(U)}},{key:"_renderPath",value:function(Y,H,Q,F){var U=F&&F.renderer||this.parent._renderer,G=U.drawingContext,Y=(f(Y)==="object"&&Y.commands?Y:this._getPath(Y,H,Q,F)).commands,$=(G.beginPath(),!0),H=!1,Q=void 0;try{for(var J,ae=Y[Symbol.iterator]();!($=(J=ae.next()).done);$=!0){var T=J.value;T.type==="M"?G.moveTo(T.x,T.y):T.type==="L"?G.lineTo(T.x,T.y):T.type==="C"?G.bezierCurveTo(T.x1,T.y1,T.x2,T.y2,T.x,T.y):T.type==="Q"?G.quadraticCurveTo(T.x1,T.y1,T.x,T.y):T.type==="Z"&&G.closePath()}}catch(B){H=!0,Q=B}finally{try{$||ae.return==null||ae.return()}finally{if(H)throw Q}}return U._doStroke&&U._strokeSet&&!U._clipping&&G.stroke(),U._doFill&&!U._clipping&&(U._fillSet||U._setFill(c._DEFAULT_TEXT_FILL),G.fill()),this}},{key:"_textWidth",value:function(I,N){return this.font.getAdvanceWidth(I,N)}},{key:"_textAscent",value:function(I){return this.font.ascender*this._scale(I)}},{key:"_textDescent",value:function(I){return-this.font.descender*this._scale(I)}},{key:"_scale",value:function(I){return 1/this.font.unitsPerEm*(I||this.parent._renderer._textSize)}},{key:"_handleAlignment",value:function(I,N,O,F,U){var G=I._textSize;switch(U===void 0&&(U=this._textWidth(N,G)),I._textAlign){case c.CENTER:O-=U/2;break;case c.RIGHT:O-=U}switch(I._textBaseline){case c.TOP:F+=this._textAscent(G);break;case c.CENTER:F+=this._textAscent(G)/2;break;case c.BOTTOM:F-=this._textDescent(G)}return{x:O,y:F}}}])&&h(P.prototype,A),C}(),r=l.default,a.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.function.name":173,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],319:[function(r,s,a){r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.array-buffer.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.array-buffer.constructor"),r("core-js/modules/es.object.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.append=function(i,l){return i.push(l),i},r.default.prototype.arrayCopy=function(i,l,c,u,f){var h,d;i=f!==void 0?(d=Math.min(f,i.length),h=u,i.slice(l,d+l)):(d=c!==void 0?(d=c,Math.min(d,i.length)):i.length,c=l,i.slice(h=0,d)),Array.prototype.splice.apply(c,[h,d].concat(i))},r.default.prototype.concat=function(i,l){return i.concat(l)},r.default.prototype.reverse=function(i){return i.reverse()},r.default.prototype.shorten=function(i){return i.pop(),i},r.default.prototype.shuffle=function(i,l){for(var c,u,f=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(i),h=(i=l||f?i:i.slice()).length;1<h;)c=this.random(0,1)*h|0,u=i[--h],i[h]=i[c],i[c]=u;return i},r.default.prototype.sort=function(i,u){var c=u?i.slice(0,Math.min(u,i.length)):i,u=u?i.slice(Math.min(u,i.length)):[];return(c=typeof c[0]=="string"?c.sort():c.sort(function(f,h){return f-h})).concat(u)},r.default.prototype.splice=function(i,l,c){return Array.prototype.splice.apply(i,[c,0].concat(l)),i},r.default.prototype.subset=function(i,l,c){return c!==void 0?i.slice(l,l+c):i.slice(l,i.length)},r=r.default,a.default=r},{"../core/main":280,"core-js/modules/es.array-buffer.constructor":151,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.to-string":187}],320:[function(r,s,a){r("core-js/modules/es.array.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.repeat"),r("core-js/modules/es.array.map"),r("core-js/modules/es.number.constructor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.repeat"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};i.default.prototype.float=function(l){return l instanceof Array?l.map(parseFloat):parseFloat(l)},i.default.prototype.int=function(l){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:10;return l===1/0||l==="Infinity"?1/0:l===-1/0||l==="-Infinity"?-1/0:typeof l=="string"?parseInt(l,c):typeof l=="number"?0|l:typeof l=="boolean"?l?1:0:l instanceof Array?l.map(function(u){return i.default.prototype.int(u,c)}):void 0},i.default.prototype.str=function(l){return l instanceof Array?l.map(i.default.prototype.str):String(l)},i.default.prototype.boolean=function(l){return typeof l=="number"?l!==0:typeof l=="string"?l.toLowerCase()==="true":typeof l=="boolean"?l:l instanceof Array?l.map(i.default.prototype.boolean):void 0},i.default.prototype.byte=function(l){return l=i.default.prototype.int(l,10),typeof l=="number"?(l+128)%256-128:l instanceof Array?l.map(i.default.prototype.byte):void 0},i.default.prototype.char=function(l){return typeof l!="number"||isNaN(l)?l instanceof Array?l.map(i.default.prototype.char):typeof l=="string"?i.default.prototype.char(parseInt(l,10)):void 0:String.fromCharCode(l)},i.default.prototype.unchar=function(l){return typeof l=="string"&&l.length===1?l.charCodeAt(0):l instanceof Array?l.map(i.default.prototype.unchar):void 0},i.default.prototype.hex=function(l,c){if(c=c??8,l instanceof Array)return l.map(function(f){return i.default.prototype.hex(f,c)});if(l===1/0||l===-1/0)return(l===1/0?"F":"0").repeat(c);if(typeof l=="number"){l<0&&(l=4294967295+l+1);for(var u=Number(l).toString(16).toUpperCase();u.length<c;)u="0".concat(u);return u=u.length>=c?u.substring(u.length-c,u.length):u}},i.default.prototype.unhex=function(l){return l instanceof Array?l.map(i.default.prototype.unhex):parseInt("0x".concat(l),16)},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.map":167,"core-js/modules/es.number.constructor":178,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.repeat":200}],321:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.pad-start"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.join"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.constructor"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.pad-start"),r("core-js/modules/es.string.replace"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(d=r("../core/main"))&&d.__esModule?d:{default:d};function l(p,y){return function(g){if(Array.isArray(g))return g}(p)||function(g,b){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]"){var m=[],v=!0,x=!1,w=void 0;try{for(var S,k=g[Symbol.iterator]();!(v=(S=k.next()).done)&&(m.push(S.value),!b||m.length!==b);v=!0);}catch(_){x=!0,w=_}finally{try{v||k.return==null||k.return()}finally{if(x)throw w}}return m}}(p,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(p,y,g){var m=l(p.toString().split("."),2),b=m[0],m=m[1];return g===void 0?(b=b.padStart(y,"0"),m?b+"."+m:b):(b=(p=l(p.toFixed(g).toString().split("."),2))[0],m=p[1],b=b.padStart(y,"0"),m===void 0?b:b+"."+m)}function u(m,y){var g=(m=m.toString()).indexOf("."),b=g!==-1?m.substring(g):"",m=(m=g!==-1?m.substring(0,g):m).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(y===0)b="";else if(y!==void 0)if(y>b.length)for(var v=y-(b+=g===-1?".":"").length+1,x=0;x<v;x++)b+="0";else b=b.substring(0,y+1);return m+b}function f(p){return 0<parseFloat(p)?"+".concat(p.toString()):p.toString()}function h(p){return 0<=parseFloat(p)?" ".concat(p.toString()):p.toString()}r("../core/friendly_errors/validate_params"),r("../core/friendly_errors/file_errors"),r("../core/friendly_errors/fes_core"),i.default.prototype.join=function(p,y){return i.default._validateParameters("join",arguments),p.join(y)},i.default.prototype.match=function(p,y){return i.default._validateParameters("match",arguments),p.match(y)},i.default.prototype.matchAll=function(p,y){i.default._validateParameters("matchAll",arguments);for(var g=new RegExp(y,"g"),b=g.exec(p),m=[];b!==null;)m.push(b),b=g.exec(p);return m},i.default.prototype.nf=function(p,y,g){return i.default._validateParameters("nf",arguments),p instanceof Array?p.map(function(b){return c(b,y,g)}):Object.prototype.toString.call(p)==="[object Arguments]"?p.length===3?this.nf(p[0],p[1],p[2]):p.length===2?this.nf(p[0],p[1]):this.nf(p[0]):c(p,y,g)},i.default.prototype.nfc=function(p,y){return i.default._validateParameters("nfc",arguments),p instanceof Array?p.map(function(g){return u(g,y)}):u(p,y)},i.default.prototype.nfp=function(){for(var p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];i.default._validateParameters("nfp",y);var b=i.default.prototype.nf.apply(this,y);return b instanceof Array?b.map(f):f(b)},i.default.prototype.nfs=function(){for(var p=arguments.length,y=new Array(p),g=0;g<p;g++)y[g]=arguments[g];i.default._validateParameters("nfs",y);var b=i.default.prototype.nf.apply(this,y);return b instanceof Array?b.map(h):h(b)},i.default.prototype.split=function(p,y){return i.default._validateParameters("split",arguments),p.split(y)},i.default.prototype.splitTokens=function(p,y){var g,b;return i.default._validateParameters("splitTokens",arguments),b=y!==void 0?(b=/\]/g.exec(y=y),(g=/\[/g.exec(y))&&b?(y=y.slice(0,b.index)+y.slice(b.index+1),g=/\[/g.exec(y),y=y.slice(0,g.index)+y.slice(g.index+1),new RegExp("[\\[".concat(y,"\\]]"),"g")):b?(y=y.slice(0,b.index)+y.slice(b.index+1),new RegExp("[".concat(y,"\\]]"),"g")):g?(y=y.slice(0,g.index)+y.slice(g.index+1),new RegExp("[".concat(y,"\\[]"),"g")):new RegExp("[".concat(y,"]"),"g")):/\s/g,p.split(b).filter(function(m){return m})},i.default.prototype.trim=function(p){return i.default._validateParameters("trim",arguments),p instanceof Array?p.map(this.trim):p.trim()};var d=i.default;a.default=d},{"../core/friendly_errors/fes_core":271,"../core/friendly_errors/file_errors":272,"../core/friendly_errors/validate_params":275,"../core/main":280,"core-js/modules/es.array.filter":156,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.constructor":191,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.pad-start":199,"core-js/modules/es.string.replace":201,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],322:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r},r.default.prototype.day=function(){return new Date().getDate()},r.default.prototype.hour=function(){return new Date().getHours()},r.default.prototype.minute=function(){return new Date().getMinutes()},r.default.prototype.millis=function(){return this._millisStart===-1?0:window.performance.now()-this._millisStart},r.default.prototype.month=function(){return new Date().getMonth()+1},r.default.prototype.second=function(){return new Date().getSeconds()},r.default.prototype.year=function(){return new Date().getFullYear()},r=r.default,a.default=r},{"../core/main":280}],323:[function(r,s,a){function i(p){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}function l(p){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(y){return i(y)}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":i(y)})(p)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.number.to-fixed"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(d=r("../core/main"))&&d.__esModule?d:{default:d},u=(r("./p5.Geometry"),function(p){if(p&&p.__esModule)return p;if(p===null||l(p)!=="object"&&typeof p!="function")return{default:p};var y=f();if(y&&y.has(p))return y.get(p);var g,b={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(g in p){var v;Object.prototype.hasOwnProperty.call(p,g)&&((v=m?Object.getOwnPropertyDescriptor(p,g):null)&&(v.get||v.set)?Object.defineProperty(b,g,v):b[g]=p[g])}return b.default=p,y&&y.set(p,b),b}(r("../core/constants")));function f(){var p;return typeof WeakMap!="function"?null:(p=new WeakMap,f=function(){return p},p)}c.default.prototype.beginGeometry=function(){return this._renderer.beginGeometry()},c.default.prototype.endGeometry=function(){return this._renderer.endGeometry()},c.default.prototype.buildGeometry=function(p){return this._renderer.buildGeometry(p)},c.default.prototype.freeGeometry=function(p){this._renderer._freeBuffers(p.gid)},c.default.prototype.plane=function(){var p,y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:y,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1,m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=(this._assert3d("plane"),c.default._validateParameters("plane",arguments),"plane|".concat(b,"|").concat(m));return this._renderer.geometryInHash(v)||((p=new c.default.Geometry(b,m,function(){for(var x,w,S=0;S<=this.detailY;S++)for(var k=S/this.detailY,_=0;_<=this.detailX;_++)x=_/this.detailX,w=new c.default.Vector(x-.5,k-.5,0),this.vertices.push(w),this.uvs.push(x,k)})).computeFaces().computeNormals(),b<=1&&m<=1?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),this._renderer.createBuffers(v,p)),this._renderer.drawBuffersScaled(v,y,g,1),this},c.default.prototype.box=function(p,y,g,b,m){this._assert3d("box"),c.default._validateParameters("box",arguments),p===void 0&&(p=50),y===void 0&&(y=p),g===void 0&&(g=y);var v,x=this._renderer.attributes&&this._renderer.attributes.perPixelLighting,x=(m===void 0&&(m=x?1:4),"box|".concat(b=b===void 0?x?1:4:b,"|").concat(m));return this._renderer.geometryInHash(x)||((v=new c.default.Geometry(b,m,function(){var w=this;this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]],[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]].forEach(function(S,k){for(var k=4*k,_=0;_<4;_++){var C=S[_],C=new c.default.Vector((2*(1&C)-1)/2,((2&C)-1)/2,((4&C)/2-1)/2);w.vertices.push(C),w.uvs.push(1&_,(2&_)/2)}w.faces.push([k,1+k,2+k]),w.faces.push([2+k,1+k,3+k])})})).computeNormals(),b<=4&&m<=4?v._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),this._renderer.createBuffers(x,v)),this._renderer.drawBuffersScaled(x,p,y,g),this},c.default.prototype.sphere=function(){var p=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:24,g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:16;return this._assert3d("sphere"),c.default._validateParameters("sphere",arguments),this.ellipsoid(p,p,p,y,g),this};function h(p,y,g,b,m,v,x){p=p<=0?1:p,y=y<0?0:y,g=g<=0?p:g,b=b<3?3:b;for(var w,S,k=(v=v===void 0||v)?-2:0,_=(m=m<1?1:m)+((x=x===void 0?y!==0:x)?2:0),C=Math.atan2(p-y,g),P=Math.sin(C),A=Math.cos(C),I=k;I<=_;++I){var N=I/m,O=g*N,F=void 0,F=I<0?(N=O=0,p):m<I?(O=g,N=1,y):p+(y-p)*N;for(I!==-2&&I!==m+2||(F=0),O-=g/2,w=0;w<b;++w){var U=w/(b-1),Y=2*Math.PI*U,G=Math.sin(Y),Y=Math.cos(Y),$=(this.vertices.push(new c.default.Vector(G*F,O,Y*F)),void 0),$=I<0?new c.default.Vector(0,-1,0):m<I&&y?new c.default.Vector(0,1,0):new c.default.Vector(G*A,P,Y*A);this.vertexNormals.push($),this.uvs.push(U,N)}}var H=0;if(v){for(S=0;S<b;++S)this.faces.push([H+S,H+b+(S+1)%b,H+b+S]);H+=2*b}for(I=0;I<m;++I){for(w=0;w<b;++w){var Q=(w+1)%b;this.faces.push([H+w,H+Q,H+b+Q]),this.faces.push([H+w,H+b+Q,H+b+w])}H+=b}if(x)for(H+=b,w=0;w<b;++w)this.faces.push([H+w,H+(w+1)%b,H+b])}c.default.prototype.cylinder=function(){var p,y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:y,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:24,m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=!(4<arguments.length&&arguments[4]!==void 0)||arguments[4],x=!(5<arguments.length&&arguments[5]!==void 0)||arguments[5],w=(this._assert3d("cylinder"),c.default._validateParameters("cylinder",arguments),"cylinder|".concat(b,"|").concat(m,"|").concat(v,"|").concat(x));return this._renderer.geometryInHash(w)||(p=new c.default.Geometry(b,m),h.call(p,1,1,1,b,m,v,x),b<=24&&m<=16?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(w,p)),this._renderer.drawBuffersScaled(w,y,g,y),this},c.default.prototype.cone=function(){var p,y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:y,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:24,m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,v=!(4<arguments.length&&arguments[4]!==void 0)||arguments[4],x=(this._assert3d("cone"),c.default._validateParameters("cone",arguments),"cone|".concat(b,"|").concat(m,"|").concat(v));return this._renderer.geometryInHash(x)||(p=new c.default.Geometry(b,m),h.call(p,1,0,1,b,m,v,!1),b<=24&&m<=16?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(x,p)),this._renderer.drawBuffersScaled(x,y,g,y),this},c.default.prototype.ellipsoid=function(){var p,y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:50,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:y,b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:y,m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:24,v=4<arguments.length&&arguments[4]!==void 0?arguments[4]:16,x=(this._assert3d("ellipsoid"),c.default._validateParameters("ellipsoid",arguments),"ellipsoid|".concat(m,"|").concat(v));return this._renderer.geometryInHash(x)||((p=new c.default.Geometry(m,v,function(){for(var w=0;w<=this.detailY;w++)for(var S=w/this.detailY,k=Math.PI*S-Math.PI/2,_=Math.cos(k),C=Math.sin(k),P=0;P<=this.detailX;P++){var A=P/this.detailX,N=2*Math.PI*A,I=Math.cos(N),N=Math.sin(N),N=new c.default.Vector(_*N,C,_*I);this.vertices.push(N),this.vertexNormals.push(N),this.uvs.push(A,S)}})).computeFaces(),m<=24&&v<=24?p._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),this._renderer.createBuffers(x,p)),this._renderer.drawBuffersScaled(x,y,g,b),this},c.default.prototype.torus=function(p,x,g,b){if(this._assert3d("torus"),c.default._validateParameters("torus",arguments),p===void 0)p=50;else if(!p)return;if(x===void 0)x=10;else if(!x)return;g===void 0&&(g=24),b===void 0&&(b=16);var m,v=(x/p).toPrecision(4),x="torus|".concat(v,"|").concat(g,"|").concat(b);return this._renderer.geometryInHash(x)||((m=new c.default.Geometry(g,b,function(){for(var w=0;w<=this.detailY;w++)for(var S=w/this.detailY,k=2*Math.PI*S,_=Math.cos(k),C=Math.sin(k),P=1+v*_,A=0;A<=this.detailX;A++){var I=A/this.detailX,N=2*Math.PI*I,F=Math.cos(N),N=Math.sin(N),O=new c.default.Vector(P*F,P*N,v*C),F=new c.default.Vector(_*F,_*N,C);this.vertices.push(O),this.vertexNormals.push(F),this.uvs.push(I,S)}})).computeFaces(),g<=24&&b<=16?m._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(x,m)),this._renderer.drawBuffersScaled(x,p,p,p),this},c.default.RendererGL.prototype.point=function(p,y){var g=[];return g.push(new c.default.Vector(p,y,2<arguments.length&&arguments[2]!==void 0?arguments[2]:0)),this._drawPoints(g,this.immediateMode.buffers.point),this},c.default.RendererGL.prototype.triangle=function(x){var y=x[0],g=x[1],b=x[2],m=x[3],v=x[4],x=x[5],w=(this.geometryInHash("tri")||((w=new c.default.Geometry(1,1,function(){var _=[];_.push(new c.default.Vector(0,0,0)),_.push(new c.default.Vector(1,0,0)),_.push(new c.default.Vector(0,1,0)),this.edges=[[0,1],[1,2],[2,0]],this.vertices=_,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]}))._edgesToVertices(),w.computeNormals(),this.createBuffers("tri",w)),this.uMVMatrix.copy());try{var S=Math.sign(y*m-b*g+b*x-v*m+v*g-y*x),k=new c.default.Matrix([b-y,m-g,0,0,v-y,x-g,0,0,0,0,S,0,y,g,0,1]).mult(this.uMVMatrix);this.uMVMatrix=k,this.drawBuffers("tri")}finally{this.uMVMatrix=w}return this},c.default.RendererGL.prototype.ellipse=function(p){this.arc(p[0],p[1],p[2],p[3],0,u.TWO_PI,u.OPEN,p[4])},c.default.RendererGL.prototype.arc=function(){var p,y=arguments.length<=0?void 0:arguments[0],g=arguments.length<=1?void 0:arguments[1],b=arguments.length<=2?void 0:arguments[2],m=arguments.length<=3?void 0:arguments[3],v=arguments.length<=4?void 0:arguments[4],x=arguments.length<=5?void 0:arguments[5],w=arguments.length<=6?void 0:arguments[6],S=(arguments.length<=7?void 0:arguments[7])||25,k=(Math.abs(x-v)>=u.TWO_PI?"".concat(_="ellipse","|"):"".concat(_="arc","|").concat(v,"|").concat(x,"|").concat(w,"|")).concat(S,"|"),_=(this.geometryInHash(k)||((p=new c.default.Geometry(S,1,function(){if(v.toFixed(10)!==x.toFixed(10)){w!==u.PIE&&w!==void 0||(this.vertices.push(new c.default.Vector(.5,.5,0)),this.uvs.push([.5,.5]));for(var C=0;C<=S;C++){var A=(x-v)*(C/S)+v,P=.5+Math.cos(A)/2,A=.5+Math.sin(A)/2;this.vertices.push(new c.default.Vector(P,A,0)),this.uvs.push([P,A]),C<S-1&&(this.faces.push([0,C+1,C+2]),this.edges.push([C+1,C+2]))}switch(w){case u.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,1]),this.edges.push([this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,this.vertices.length-1]);break;case u.CHORD:this.edges.push([0,1]),this.edges.push([0,this.vertices.length-1]);break;case u.OPEN:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([this.vertices.length-2,this.vertices.length-1])}}})).computeNormals(),S<=50?p._edgesToVertices(p):this._doStroke&&console.log("Cannot apply a stroke to an ".concat(_," with more than 50 detail")),this.createBuffers(k,p)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([y,g,0]),this.uMVMatrix.scale(b,m,1),this.drawBuffers(k)}finally{this.uMVMatrix=_}return this},c.default.RendererGL.prototype.rect=function(p){var y=p[0],g=p[1],b=p[2],m=p[3];if(p[4]===void 0){var w=this._pInst._glAttributes.perPixelLighting,v=p[4]||(w?1:24),x=p[5]||(w?1:16),w="rect|".concat(v,"|").concat(x),S=(this.geometryInHash(w)||((S=new c.default.Geometry(v,x,function(){for(var $=0;$<=this.detailY;$++)for(var H=$/this.detailY,Q=0;Q<=this.detailX;Q++){var J=Q/this.detailX,ae=new c.default.Vector(J,H,0);this.vertices.push(ae),this.uvs.push(J,H)}0<v&&0<x&&(this.edges=[[0,v],[v,(v+1)*(x+1)-1],[(v+1)*(x+1)-1,(v+1)*x],[(v+1)*x,0]])})).computeFaces().computeNormals()._edgesToVertices(),this.createBuffers(w,S)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([y,g,0]),this.uMVMatrix.scale(b,m,1),this.drawBuffers(w)}finally{this.uMVMatrix=S}}else{var w=p[4],S=p[5]===void 0?w:p[5],k=p[6]===void 0?S:p[6],p=p[7]===void 0?k:p[7],N=b,_=m,A=((N+=y)<y&&(A=y,y=N,N=A),(_+=g)<g&&(A=g,g=_,_=A),Math.min((N-y)/2,(_-g)/2)),C=(A<w&&(w=A),A<S&&(S=A),A<k&&(k=A),A<p&&(p=A),y),P=g,A=N,y=_,I=(this.beginShape(),S!==0?(this.vertex(A-S,P),this.quadraticVertex(A,P,A,P+S)):this.vertex(A,P),k!==0?(this.vertex(A,y-k),this.quadraticVertex(A,y,A-k,y)):this.vertex(A,y),p!==0?(this.vertex(C+p,y),this.quadraticVertex(C,y,C,y-p)):this.vertex(C,y),w!==0?(this.vertex(C,P+w),this.quadraticVertex(C,P,C+w,P)):this.vertex(C,P),!(this.immediateMode.geometry.uvs.length=0)),g=!1,N=void 0;try{for(var O,F=this.immediateMode.geometry.vertices[Symbol.iterator]();!(I=(O=F.next()).done);I=!0){var U=O.value,G=(U.x-C)/b,Y=(U.y-P)/m;this.immediateMode.geometry.uvs.push(G,Y)}}catch(T){g=!0,N=T}finally{try{I||F.return==null||F.return()}finally{if(g)throw N}}this.endShape(u.CLOSE)}return this},c.default.RendererGL.prototype.quad=function(p,y,g,b,m,v,x,w,S,k,_,C){var P=12<arguments.length&&arguments[12]!==void 0?arguments[12]:2,A=13<arguments.length&&arguments[13]!==void 0?arguments[13]:2,I="quad|".concat(p,"|").concat(y,"|").concat(g,"|").concat(b,"|").concat(m,"|").concat(v,"|").concat(x,"|").concat(w,"|").concat(S,"|").concat(k,"|").concat(_,"|").concat(C,"|").concat(P,"|").concat(A);if(!this.geometryInHash(I)){var N=new c.default.Geometry(P,A,function(){for(var Q=1/(this.detailX-1),J=1/(this.detailY-1),ae=0;ae<this.detailY;ae++)for(var T=0;T<this.detailX;T++){var B=T*Q,W=ae*J;this.vertices.push(new c.default.Vector((1-B)*((1-W)*p+W*k)+B*((1-W)*b+W*x),(1-B)*((1-W)*y+W*_)+B*((1-W)*m+W*w),(1-B)*((1-W)*g+W*C)+B*((1-W)*v+W*S))),this.uvs.push([B,W])}});N.faces=[];for(var O=0;O<A-1;O++)for(var F=0;F<P-1;F++){var U=F+O*P,G=F+1+(O+1)*P,Y=F+(O+1)*P;N.faces.push([U,F+1+O*P,G]),N.faces.push([U,G,Y])}N.computeNormals();for(var $=[N.edges.length=0,2,3,1],H=0;H<$.length;H++)N.edges.push([$[H],$[(H+1)%$.length]]);N._edgesToVertices(),this.createBuffers(I,N)}return this.drawBuffers(I),this},c.default.RendererGL.prototype.bezier=function(p,y,g,b,m,v,x,w,S,k,_,C){arguments.length===8&&(_=w,k=x,w=v,x=m,m=b,b=g,g=v=S=C=0);var P=this._pInst._bezierDetail||20;this.beginShape();for(var A=0;A<=P;A++){var I=Math.pow(1-A/P,3),N=A/P*3*Math.pow(1-A/P,2),O=3*Math.pow(A/P,2)*(1-A/P),F=Math.pow(A/P,3);this.vertex(p*I+b*N+x*O+k*F,y*I+m*N+w*O+_*F,g*I+v*N+S*O+C*F)}return this.endShape(),this},c.default.RendererGL.prototype.curve=function(p,y,g,b,m,v,x,w,S,k,_,C){arguments.length===8&&(k=x,_=w,x=m,w=b,m=b=g,g=v=S=C=0);var P=this._pInst._curveDetail;this.beginShape();for(var A=0;A<=P;A++){var I=.5*Math.pow(A/P,3),N=.5*Math.pow(A/P,2),O=A/P*.5;this.vertex(I*(3*b-p-3*x+k)+N*(2*p-5*b+4*x-k)+O*(-p+x)+2*b*.5,I*(3*m-y-3*w+_)+N*(2*y-5*m+4*w-_)+O*(-y+w)+2*m*.5,I*(3*v-g-3*S+C)+N*(2*g-5*v+4*S-C)+O*(-g+S)+2*v*.5)}return this.endShape(),this},c.default.RendererGL.prototype.line=function(){return arguments.length===6?(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),this.vertex(arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]),this.endShape()):arguments.length===4&&(this.beginShape(u.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],0),this.vertex(arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],0),this.endShape()),this},c.default.RendererGL.prototype.bezierVertex=function(){if(this.immediateMode._bezierVertex.length===0)throw Error("vertex() must be used once before calling bezierVertex()");var p,y,g,b,m,v,x=[],w=[],S=arguments.length;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var k=1/this._lutBezierDetail,_=0,C=1,P=0;_<1;){if(v=parseFloat(_.toFixed(6)),this._lookUpTableBezier[P]=this._bezierCoefficients(v),C.toFixed(6)===k.toFixed(6)){v=parseFloat(C.toFixed(6))+parseFloat(_.toFixed(6)),++P,this._lookUpTableBezier[P]=this._bezierCoefficients(v);break}_+=k,C-=k,++P}}for(var A=this._lookUpTableBezier.length,I=[],N=0;N<4;N++)I.push([]);I[0]=this.immediateMode.geometry.vertexColors.slice(-4),I[3]=this.curFillColor.slice();var O=[];for(N=0;N<4;N++)O.push([]);if(O[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),O[3]=this.curStrokeColor.slice(),S===6){this.isBezier=!0;var x=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2],arguments.length<=4?void 0:arguments[4]],w=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3],arguments.length<=5?void 0:arguments[5]],F=Math.hypot(x[0]-x[1],w[0]-w[1]),G=Math.hypot(x[1]-x[2],w[1]-w[2]),U=Math.hypot(x[2]-x[3],w[2]-w[3]),G=F+G+U;for(F/=G,U/=G,m=0;m<4;m++)I[1].push(I[0][m]*(1-F)+I[3][m]*F),I[2].push(I[0][m]*U+I[3][m]*(1-U)),O[1].push(O[0][m]*(1-F)+O[3][m]*F),O[2].push(O[0][m]*U+O[3][m]*(1-U));for(b=0;b<A;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],N=p=y=0;N<4;N++){for(m=0;m<4;m++)this.curFillColor[m]+=this._lookUpTableBezier[b][N]*I[N][m],this.curStrokeColor[m]+=this._lookUpTableBezier[b][N]*O[N][m];p+=x[N]*this._lookUpTableBezier[b][N],y+=w[N]*this._lookUpTableBezier[b][N]}this.vertex(p,y)}this.curFillColor=I[3],this.curStrokeColor=O[3],this.immediateMode._bezierVertex[0]=arguments.length<=4?void 0:arguments[4],this.immediateMode._bezierVertex[1]=arguments.length<=5?void 0:arguments[5]}else if(S===9){this.isBezier=!0,x=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3],arguments.length<=6?void 0:arguments[6]],w=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4],arguments.length<=7?void 0:arguments[7]];var Y=[this.immediateMode._bezierVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5],arguments.length<=8?void 0:arguments[8]],$=Math.hypot(x[0]-x[1],w[0]-w[1],Y[0]-Y[1]),G=Math.hypot(x[1]-x[2],w[1]-w[2],Y[1]-Y[2]),H=Math.hypot(x[2]-x[3],w[2]-w[3],Y[2]-Y[3]),S=$+G+H;for($/=S,H/=S,m=0;m<4;m++)I[1].push(I[0][m]*(1-$)+I[3][m]*$),I[2].push(I[0][m]*H+I[3][m]*(1-H)),O[1].push(O[0][m]*(1-$)+O[3][m]*$),O[2].push(O[0][m]*H+O[3][m]*(1-H));for(b=0;b<A;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],N=p=y=g=0;N<4;N++){for(m=0;m<4;m++)this.curFillColor[m]+=this._lookUpTableBezier[b][N]*I[N][m],this.curStrokeColor[m]+=this._lookUpTableBezier[b][N]*O[N][m];p+=x[N]*this._lookUpTableBezier[b][N],y+=w[N]*this._lookUpTableBezier[b][N],g+=Y[N]*this._lookUpTableBezier[b][N]}this.vertex(p,y,g)}this.curFillColor=I[3],this.curStrokeColor=O[3],this.immediateMode._bezierVertex[0]=arguments.length<=6?void 0:arguments[6],this.immediateMode._bezierVertex[1]=arguments.length<=7?void 0:arguments[7],this.immediateMode._bezierVertex[2]=arguments.length<=8?void 0:arguments[8]}},c.default.RendererGL.prototype.quadraticVertex=function(){if(this.immediateMode._quadraticVertex.length===0)throw Error("vertex() must be used once before calling quadraticVertex()");var p,y,g,b,m,v,x=[],w=[],S=arguments.length;if(this._lookUpTableQuadratic.length===0||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[],this._lutQuadraticDetail=this._pInst._curveDetail;for(var k=1/this._lutQuadraticDetail,_=0,C=1,P=0;_<1;){if(v=parseFloat(_.toFixed(6)),this._lookUpTableQuadratic[P]=this._quadraticCoefficients(v),C.toFixed(6)===k.toFixed(6)){v=parseFloat(C.toFixed(6))+parseFloat(_.toFixed(6)),++P,this._lookUpTableQuadratic[P]=this._quadraticCoefficients(v);break}_+=k,C-=k,++P}}for(var A=this._lookUpTableQuadratic.length,I=[],N=0;N<3;N++)I.push([]);I[0]=this.immediateMode.geometry.vertexColors.slice(-4),I[2]=this.curFillColor.slice();var O=[];for(N=0;N<3;N++)O.push([]);if(O[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),O[2]=this.curStrokeColor.slice(),S===4){this.isQuadratic=!0;var x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2]],w=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3]],F=Math.hypot(x[0]-x[1],w[0]-w[1]);for(F/=F+Math.hypot(x[1]-x[2],w[1]-w[2]),m=0;m<4;m++)I[1].push(I[0][m]*(1-F)+I[2][m]*F),O[1].push(O[0][m]*(1-F)+O[2][m]*F);for(b=0;b<A;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],N=p=y=0;N<3;N++){for(m=0;m<4;m++)this.curFillColor[m]+=this._lookUpTableQuadratic[b][N]*I[N][m],this.curStrokeColor[m]+=this._lookUpTableQuadratic[b][N]*O[N][m];p+=x[N]*this._lookUpTableQuadratic[b][N],y+=w[N]*this._lookUpTableQuadratic[b][N]}this.vertex(p,y)}this.curFillColor=I[2],this.curStrokeColor=O[2],this.immediateMode._quadraticVertex[0]=arguments.length<=2?void 0:arguments[2],this.immediateMode._quadraticVertex[1]=arguments.length<=3?void 0:arguments[3]}else if(S===6){this.isQuadratic=!0,x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3]],w=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4]];var U=[this.immediateMode._quadraticVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5]],G=Math.hypot(x[0]-x[1],w[0]-w[1],U[0]-U[1]);for(G/=G+Math.hypot(x[1]-x[2],w[1]-w[2],U[1]-U[2]),m=0;m<4;m++)I[1].push(I[0][m]*(1-G)+I[2][m]*G),O[1].push(O[0][m]*(1-G)+O[2][m]*G);for(b=0;b<A;b++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],N=p=y=g=0;N<3;N++){for(m=0;m<4;m++)this.curFillColor[m]+=this._lookUpTableQuadratic[b][N]*I[N][m],this.curStrokeColor[m]+=this._lookUpTableQuadratic[b][N]*O[N][m];p+=x[N]*this._lookUpTableQuadratic[b][N],y+=w[N]*this._lookUpTableQuadratic[b][N],g+=U[N]*this._lookUpTableQuadratic[b][N]}this.vertex(p,y,g)}this.curFillColor=I[2],this.curStrokeColor=O[2],this.immediateMode._quadraticVertex[0]=arguments.length<=3?void 0:arguments[3],this.immediateMode._quadraticVertex[1]=arguments.length<=4?void 0:arguments[4],this.immediateMode._quadraticVertex[2]=arguments.length<=5?void 0:arguments[5]}},c.default.RendererGL.prototype.curveVertex=function(){var p,y,g,b,m,v,x=[],w=[],S=arguments.length;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var k=1/this._lutBezierDetail,_=0,C=1,P=0;_<1;){if(v=parseFloat(_.toFixed(6)),this._lookUpTableBezier[P]=this._bezierCoefficients(v),C.toFixed(6)===k.toFixed(6)){v=parseFloat(C.toFixed(6))+parseFloat(_.toFixed(6)),++P,this._lookUpTableBezier[P]=this._bezierCoefficients(v);break}_+=k,C-=k,++P}}var A=this._lookUpTableBezier.length;if(S===2){if(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.length===8){for(this.isCurve=!0,x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]),w=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]),m=0;m<A;m++)y=x[0]*this._lookUpTableBezier[m][0]+x[1]*this._lookUpTableBezier[m][1]+x[2]*this._lookUpTableBezier[m][2]+x[3]*this._lookUpTableBezier[m][3],g=w[0]*this._lookUpTableBezier[m][0]+w[1]*this._lookUpTableBezier[m][1]+w[2]*this._lookUpTableBezier[m][2]+w[3]*this._lookUpTableBezier[m][3],this.vertex(y,g);for(m=0;m<S;m++)this.immediateMode._curveVertex.shift()}}else if(S===3&&(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.push(arguments.length<=2?void 0:arguments[2]),this.immediateMode._curveVertex.length===12)){for(this.isCurve=!0,x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]),w=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]),p=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]),m=0;m<A;m++)y=x[0]*this._lookUpTableBezier[m][0]+x[1]*this._lookUpTableBezier[m][1]+x[2]*this._lookUpTableBezier[m][2]+x[3]*this._lookUpTableBezier[m][3],g=w[0]*this._lookUpTableBezier[m][0]+w[1]*this._lookUpTableBezier[m][1]+w[2]*this._lookUpTableBezier[m][2]+w[3]*this._lookUpTableBezier[m][3],b=p[0]*this._lookUpTableBezier[m][0]+p[1]*this._lookUpTableBezier[m][1]+p[2]*this._lookUpTableBezier[m][2]+p[3]*this._lookUpTableBezier[m][3],this.vertex(y,g,b);for(m=0;m<S;m++)this.immediateMode._curveVertex.shift()}},c.default.RendererGL.prototype.image=function(p,C,g,P,m,v,x,w,S){this._isErasing&&this.blendMode(this._cachedBlendMode),this._pInst.push(),this._pInst.noLights(),this._pInst.noStroke(),this._pInst.texture(p),this._pInst.textureMode(u.NORMAL);var k=0,_=(C<=p.width&&(k=C/p.width),1),C=(C+P<=p.width&&(_=(C+P)/p.width),0),P=(g<=p.height&&(C=g/p.height),1);g+m<=p.height&&(P=(g+m)/p.height),this.beginShape(),this.vertex(v,x,0,k,C),this.vertex(v+w,x,0,_,C),this.vertex(v+w,x+S,0,_,P),this.vertex(v,x+S,0,k,P),this.endShape(u.CLOSE),this._pInst.pop(),this._isErasing&&this.blendMode(u.REMOVE)};var d=c.default;a.default=d},{"../core/constants":269,"../core/main":280,"./p5.Geometry":332,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.math.sign":177,"core-js/modules/es.number.to-fixed":180,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],324:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}function l(y){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.every"),r("core-js/modules/es.array.map"),r("core-js/modules/es.object.assign"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(y){if(y&&y.__esModule)return y;if(y===null||l(y)!=="object"&&typeof y!="function")return{default:y};var g=f();if(g&&g.has(y))return g.get(y);var b,m={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in y){var x;Object.prototype.hasOwnProperty.call(y,b)&&((x=v?Object.getOwnPropertyDescriptor(y,b):null)&&(x.get||x.set)?Object.defineProperty(m,b,x):m[b]=y[b])}return m.default=y,g&&g.set(y,m),m}(r("../core/constants"));function f(){var y;return typeof WeakMap!="function"?null:(y=new WeakMap,f=function(){return y},y)}function h(y){return function(g){if(Array.isArray(g)){for(var b=0,m=new Array(g.length);b<g.length;b++)m[b]=g[b];return m}}(y)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(y,g){for(var b=0;b<g.length;b++){var m=g[b];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}var p=function(){function y(m){if(!(this instanceof y))throw new TypeError("Cannot call a class as a function");(this.renderer=m)._pInst.push(),this.identityMatrix=new c.default.Matrix,m.uMVMatrix=new c.default.Matrix,this.geometry=new c.default.Geometry,this.geometry.gid="_p5_GeometryBuilder_".concat(y.nextGeometryId),y.nextGeometryId++,this.hasTransform=!1}var g,b;return g=y,(b=[{key:"transformVertices",value:function(m){var v=this;return this.hasTransform?m.map(function(x){return v.renderer.uMVMatrix.multiplyPoint(x)}):m}},{key:"transformNormals",value:function(m){var v=this;return this.hasTransform?m.map(function(x){return v.renderer.uNMatrix.multiplyVec3(x)}):m}},{key:"addGeometry",value:function(m){for(var v,x=this,w=(this.hasTransform=!this.renderer.uMVMatrix.mat4.every(function(k,_){return k===x.identityMatrix.mat4[_]}),this.hasTransform&&this.renderer.uNMatrix.inverseTranspose(this.renderer.uMVMatrix),this.geometry.vertices.length),S=((v=this.geometry.vertices).push.apply(v,h(this.transformVertices(m.vertices))),(v=this.geometry.vertexNormals).push.apply(v,h(this.transformNormals(m.vertexNormals))),(v=this.geometry.uvs).push.apply(v,h(m.uvs)),this.renderer._doFill&&(v=this.geometry.faces).push.apply(v,h(m.faces.map(function(k){return k.map(function(_){return _+w})}))),this.renderer._doStroke&&(v=this.geometry.edges).push.apply(v,h(m.edges.map(function(k){return k.map(function(_){return _+w})}))),h(m.vertexColors));S.length<4*m.vertices.length;)S.push.apply(S,h(this.renderer.curFillColor));(v=this.geometry.vertexColors).push.apply(v,h(S))}},{key:"addImmediate",value:function(){var m=this.renderer.immediateMode.geometry,v=this.renderer.immediateMode.shapeMode,x=[];if(this.renderer._doFill)if(v===u.TRIANGLE_STRIP||v===u.QUAD_STRIP)for(var w=2;w<m.vertices.length;w++)w%2==0?x.push([w,w-1,w-2]):x.push([w,w-2,w-1]);else if(v===u.TRIANGLE_FAN)for(var S=2;S<m.vertices.length;S++)x.push([0,S-1,S]);else for(var k=0;k<m.vertices.length;k+=3)x.push([k,k+1,k+2]);this.addGeometry(Object.assign({},m,{faces:x}))}},{key:"addRetained",value:function(m){this.addGeometry(m.model)}},{key:"finish",value:function(){return this.renderer._pInst.pop(),this.geometry}}])&&d(g.prototype,b),y}();p.nextGeometryId=0,a.default=p},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.every":154,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],325:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.math.sign"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(h=r("../core/main"))&&h.__esModule?h:{default:h},c=function(d){if(d&&d.__esModule)return d;if(d===null||f(d)!=="object"&&typeof d!="function")return{default:d};var p=u();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function u(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,u=function(){return d},d)}function f(d){return(f=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}l.default.prototype.orbitControl=function(d,p,y,S){var b=this,m=(this._assert3d("orbitControl"),l.default._validateParameters("orbitControl",arguments),this._renderer._curCamera);d===void 0&&(d=1),p===void 0&&(p=d),y===void 0&&(y=1),f(S)!=="object"&&(S={}),this.contextMenuDisabled!==!0&&(this.canvas.oncontextmenu=function(){return!1},this._setProperty("contextMenuDisabled",!0)),this.wheelDefaultDisabled!==!0&&(this.canvas.onwheel=function(){return!1},this._setProperty("wheelDefaultDisabled",!0));var _=S.disableTouchActions;this.touchActionsDisabled===!0||_!==void 0&&!_||(this.canvas.style["touch-action"]="none",this._setProperty("touchActionsDisabled",!0));var v,x,w,_=S.freeRotation,S=_!==void 0&&_,k=[],_=(this.touches.forEach(function(F){b._renderer.prevTouches.forEach(function(U){F.id===U.id&&(U={x:F.x,y:F.y,px:U.x,py:U.y},k.push(U))})}),this._renderer.prevTouches=this.touches,0),C=0,P=0,A=0,I=0,N=this.height<this.width?this.height:this.width,O=!1;return 0<k.length?(O=0<k[0].x&&k[0].x<this.width&&0<k[0].y&&k[0].y<this.height,k.length===1?(C=-d*((v=k[0]).x-v.px)/N,P=p*(v.y-v.py)/N):(v=k[0],x=k[1],_=-(Math.hypot(v.x-x.x,v.y-x.y)-Math.hypot(v.px-x.px,v.py-x.py))*y*4e-4,A=.5*(v.x+x.x)-.5*(v.px+x.px),I=.5*(v.y+x.y)-.5*(v.py+x.py)),0<this.touches.length?O&&(this._renderer.executeRotateAndMove=!0,this._renderer.executeZoom=!0):(this._renderer.executeRotateAndMove=!1,this._renderer.executeZoom=!1)):(O=0<this.mouseX&&this.mouseX<this.width&&0<this.mouseY&&this.mouseY<this.height,this._mouseWheelDeltaY!==0?(_=Math.sign(this._mouseWheelDeltaY)*y,_*=.01,this._mouseWheelDeltaY=0,O&&(this._renderer.executeZoom=!0)):this._renderer.executeZoom=!1,this.mouseIsPressed?(this.mouseButton===this.LEFT?(C=-d*this.movedX/N,P=p*this.movedY/N):this.mouseButton===this.RIGHT&&(A=this.movedX,I=this.movedY*m.yScale),O&&(this._renderer.executeRotateAndMove=!0)):this._renderer.executeRotateAndMove=!1),_!==0&&this._renderer.executeZoom&&(this._renderer.zoomVelocity+=_),.001<Math.abs(this._renderer.zoomVelocity)?(S?m._orbitFree(0,0,this._renderer.zoomVelocity):m._orbit(0,0,this._renderer.zoomVelocity),m.projMatrix.mat4[15]!==0&&(m.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity),m.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity),this._renderer.uPMatrix.mat4[0]=m.projMatrix.mat4[0],this._renderer.uPMatrix.mat4[5]=m.projMatrix.mat4[5]),this._renderer.zoomVelocity*=.85):this._renderer.zoomVelocity=0,C===0&&P===0||!this._renderer.executeRotateAndMove||this._renderer.rotateVelocity.add(.6*C,.6*P),1e-6<this._renderer.rotateVelocity.magSq()?(S?m._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0):m._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0),this._renderer.rotateVelocity.mult(.85)):this._renderer.rotateVelocity.set(0,0),A===0&&I===0||!this._renderer.executeRotateAndMove||(v=2*A/this.width,x=2*-I/this.height,this._renderer.moveVelocity.add(.15*v,.15*x)),1e-6<this._renderer.moveVelocity.magSq()?(y=m._getLocalAxes(),d=m.eyeX-m.centerX,p=m.eyeY-m.centerY,N=m.eyeZ-m.centerZ,O=Math.sqrt(d*d+p*p+N*N),_=new l.default.Vector(m.centerX,m.centerY,m.centerZ),_=m.cameraMatrix.multiplyPoint(_),(_=this._renderer.uPMatrix.multiplyAndNormalizePoint(_)).x-=this._renderer.moveVelocity.x,_.y-=this._renderer.moveVelocity.y,P=(C=this._renderer.uPMatrix.mat4)[15]===0?(w=(C[8]+_.x)/C[0]*O,(C[9]+_.y)/C[5]*O):(w=(_.x-C[12])/C[0],(_.y-C[13])/C[5]),m.setPosition(m.eyeX+w*y.x[0]+P*y.y[0],m.eyeY+w*y.x[1]+P*y.y[1],m.eyeZ+w*y.x[2]+P*y.y[2]),this._renderer.moveVelocity.mult(.85)):this._renderer.moveVelocity.set(0,0),this},l.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var d=arguments.length,p=new Array(d),y=0;y<d;y++)p[y]=arguments[y];l.default._validateParameters("debugMode",p);for(var g=this._registeredMethods.post.length-1;0<=g;g--)this._registeredMethods.post[g].toString()!==this._grid().toString()&&this._registeredMethods.post[g].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(g,1);p[0]===c.GRID?this.registerMethod("post",this._grid(p[1],p[2],p[3],p[4],p[5])):p[0]===c.AXES?this.registerMethod("post",this._axesIcon(p[1],p[2],p[3],p[4])):(this.registerMethod("post",this._grid(p[0],p[1],p[2],p[3],p[4])),this.registerMethod("post",this._axesIcon(p[5],p[6],p[7],p[8])))},l.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var d=this._registeredMethods.post.length-1;0<=d;d--)this._registeredMethods.post[d].toString()!==this._grid().toString()&&this._registeredMethods.post[d].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(d,1)},l.default.prototype._grid=function(d,p,y,g,b){d===void 0&&(d=this.width/2),p===void 0&&(p=Math.round(d/30)<4?4:Math.round(d/30)),y===void 0&&(y=0),g===void 0&&(g=0),b===void 0&&(b=0);var m=d/p,v=d/2;return function(){this.push(),this.stroke(255*this._renderer.curStrokeColor[0],255*this._renderer.curStrokeColor[1],255*this._renderer.curStrokeColor[2]),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix);for(var x=0;x<=p;x++)this.beginShape(this.LINES),this.vertex(-v+y,g,x*m-v+b),this.vertex(v+y,g,x*m-v+b),this.endShape();for(var w=0;w<=p;w++)this.beginShape(this.LINES),this.vertex(w*m-v+y,g,-v+b),this.vertex(w*m-v+y,g,v+b),this.endShape();this.pop()}},l.default.prototype._axesIcon=function(d,p,y,g){return d===void 0&&(d=40<this.width/20?this.width/20:40),p===void 0&&(p=-this.width/4),y===void 0&&(y=p),g===void 0&&(g=p),function(){this.push(),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(p,y,g),this.vertex(p+d,y,g),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(p,y,g),this.vertex(p,y+d,g),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(p,y,g),this.vertex(p,y,g+d),this.endShape(),this.pop()}};var h=l.default;a.default=h},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.splice":170,"core-js/modules/es.math.hypot":175,"core-js/modules/es.math.sign":177,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],326:[function(r,s,a){r("core-js/modules/es.array.filter"),r("core-js/modules/es.array.filter"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};i.default.prototype.ambientLight=function(l,c,u,f){this._assert3d("ambientLight"),i.default._validateParameters("ambientLight",arguments);var h=this.color.apply(this,arguments);return this._renderer.ambientLightColors.push(h._array[0],h._array[1],h._array[2]),this._renderer._enableLighting=!0,this},i.default.prototype.specularColor=function(l,c,u){this._assert3d("specularColor"),i.default._validateParameters("specularColor",arguments);var f=this.color.apply(this,arguments);return this._renderer.specularColors=[f._array[0],f._array[1],f._array[2]],this},i.default.prototype.directionalLight=function(l,b,g,f,h,d){this._assert3d("directionalLight"),i.default._validateParameters("directionalLight",arguments),l=l instanceof i.default.Color?l:this.color(l,b,g);var p,y,b=arguments[arguments.length-1],g=typeof b=="number"?(p=arguments[arguments.length-3],y=arguments[arguments.length-2],arguments[arguments.length-1]):(p=b.x,y=b.y,b.z),b=Math.sqrt(p*p+y*y+g*g);return this._renderer.directionalLightDirections.push(p/b,y/b,g/b),this._renderer.directionalLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},i.default.prototype.pointLight=function(l,g,b,f,h,d){this._assert3d("pointLight"),i.default._validateParameters("pointLight",arguments),l=l instanceof i.default.Color?l:this.color(l,g,b);var p,y,g=arguments[arguments.length-1],b=typeof g=="number"?(p=arguments[arguments.length-3],y=arguments[arguments.length-2],arguments[arguments.length-1]):(p=g.x,y=g.y,g.z);return this._renderer.pointLightPositions.push(p,y,b),this._renderer.pointLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},i.default.prototype.imageLight=function(l){this._renderer.activeImageLight=l,this._renderer._enableLighting=!0},i.default.prototype.panorama=function(l){this.filter(this._renderer._getSphereMapping(l))},i.default.prototype.lights=function(){this._assert3d("lights");var l=this.color("rgb(128,128,128)");return this.ambientLight(l),this.directionalLight(l,0,0,-1),this},i.default.prototype.lightFalloff=function(l,c,u){return this._assert3d("lightFalloff"),i.default._validateParameters("lightFalloff",arguments),l<0&&(l=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),c<0&&(c=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),u<0&&(u=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),l===0&&c===0&&u===0&&(l=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this._renderer.constantAttenuation=l,this._renderer.linearAttenuation=c,this._renderer.quadraticAttenuation=u,this},i.default.prototype.spotLight=function(l,c,u,f,h,d,p,y,g,b,m){this._assert3d("spotLight"),i.default._validateParameters("spotLight",arguments);var v,x,w,S=arguments.length;switch(S){case 11:case 10:v=this.color(l,c,u),x=new i.default.Vector(f,h,d),w=new i.default.Vector(p,y,g);break;case 9:l instanceof i.default.Color?(v=l,x=new i.default.Vector(c,u,f),w=new i.default.Vector(h,d,p),b=y,m=g):f instanceof i.default.Vector?(v=this.color(l,c,u),x=f,w=new i.default.Vector(h,d,p),b=y,m=g):p instanceof i.default.Vector?(v=this.color(l,c,u),x=new i.default.Vector(f,h,d),w=p,b=y,m=g):(v=this.color(l,c,u),x=new i.default.Vector(f,h,d),w=new i.default.Vector(p,y,g));break;case 8:b=(w=l instanceof i.default.Color?(v=l,x=new i.default.Vector(c,u,f),new i.default.Vector(h,d,p)):f instanceof i.default.Vector?(v=this.color(l,c,u),x=f,new i.default.Vector(h,d,p)):(v=this.color(l,c,u),x=new i.default.Vector(f,h,d),p),y);break;case 7:l instanceof i.default.Color&&c instanceof i.default.Vector?(v=l,x=c,w=new i.default.Vector(u,f,h),b=d,m=p):l instanceof i.default.Color&&h instanceof i.default.Vector?(v=l,x=new i.default.Vector(c,u,f),w=h,b=d,m=p):f instanceof i.default.Vector&&h instanceof i.default.Vector?(v=this.color(l,c,u),x=f,w=h,b=d,m=p):w=l instanceof i.default.Color?(v=l,x=new i.default.Vector(c,u,f),new i.default.Vector(h,d,p)):f instanceof i.default.Vector?(v=this.color(l,c,u),x=f,new i.default.Vector(h,d,p)):(v=this.color(l,c,u),x=new i.default.Vector(f,h,d),p);break;case 6:f instanceof i.default.Vector&&h instanceof i.default.Vector?(v=this.color(l,c,u),x=f,w=h,b=d):l instanceof i.default.Color&&h instanceof i.default.Vector?(v=l,x=new i.default.Vector(c,u,f),w=h,b=d):l instanceof i.default.Color&&c instanceof i.default.Vector&&(v=l,x=c,w=new i.default.Vector(u,f,h),b=d);break;case 5:l instanceof i.default.Color&&c instanceof i.default.Vector&&u instanceof i.default.Vector?(v=l,x=c,w=u,b=f,m=h):f instanceof i.default.Vector&&h instanceof i.default.Vector?(v=this.color(l,c,u),x=f,w=h):l instanceof i.default.Color&&h instanceof i.default.Vector?(v=l,x=new i.default.Vector(c,u,f),w=h):l instanceof i.default.Color&&c instanceof i.default.Vector&&(v=l,x=c,w=new i.default.Vector(u,f,h));break;case 4:v=l,x=c,w=u,b=f;break;case 3:v=l,x=c,w=u;break;default:return console.warn("Sorry, input for spotlight() is not in prescribed format. Too ".concat(S<3?"few":"many"," arguments were provided")),this}return this._renderer.spotLightDiffuseColors.push(v._array[0],v._array[1],v._array[2]),Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors),this._renderer.spotLightPositions.push(x.x,x.y,x.z),w.normalize(),this._renderer.spotLightDirections.push(w.x,w.y,w.z),b===void 0&&(b=Math.PI/3),m!==void 0&&m<1?(m=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):m===void 0&&(m=100),b=this._renderer._pInst._toRadians(b),this._renderer.spotLightAngle.push(Math.cos(b)),this._renderer.spotLightConc.push(m),this._renderer._enableLighting=!0,this},i.default.prototype.noLights=function(){this._assert3d("noLights");for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return i.default._validateParameters("noLights",c),this._renderer.activeImageLight=null,this._renderer._enableLighting=!1,this._renderer.ambientLightColors.length=0,this._renderer.specularColors=[1,1,1],this._renderer.directionalLightDirections.length=0,this._renderer.directionalLightDiffuseColors.length=0,this._renderer.directionalLightSpecularColors.length=0,this._renderer.pointLightPositions.length=0,this._renderer.pointLightDiffuseColors.length=0,this._renderer.pointLightSpecularColors.length=0,this._renderer.spotLightPositions.length=0,this._renderer.spotLightDirections.length=0,this._renderer.spotLightDiffuseColors.length=0,this._renderer.spotLightSpecularColors.length=0,this._renderer.spotLightAngle.length=0,this._renderer.spotLightConc.length=0,this._renderer.constantAttenuation=1,this._renderer.linearAttenuation=0,this._renderer.quadraticAttenuation=0,this._renderer._useShininess=1,this._renderer._useMetalness=0,this},r=i.default,a.default=r},{"../core/main":280,"core-js/modules/es.array.filter":156}],327:[function(r,s,a){function i(f){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.splice"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.match"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.trim"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=(u=r("../core/main"))&&u.__esModule?u:{default:u};function c(f){return(c=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(h){return i(h)}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":i(h)})(f)}r("./p5.Geometry"),l.default.prototype.loadModel=function(f,h){l.default._validateParameters("loadModel",arguments);var d,p,y=!1,g=!1,b=!1,m=f.slice(-4),v=(h&&c(h)==="object"?(y=h.normalize||!1,d=h.successCallback,p=h.failureCallback,m=h.fileType||m,g=h.flipU||!1,b=h.flipV||!1):typeof h=="boolean"?(y=h,d=arguments[2],p=arguments[3],arguments[4]!==void 0&&(m=arguments[4])):(d=typeof h=="function"?h:void 0,p=arguments[2],arguments[3]!==void 0&&(m=arguments[3])),new l.default.Geometry),x=(v.gid="".concat(f,"|").concat(y),this);return m.match(/\.stl$/i)?this.httpDo(f,"GET","arrayBuffer",function(w){(function(S,k){if(function(_){for(var C=new DataView(_),P=[115,111,108,105,100],A=0;A<5;A++)if(function(I,N,O){for(var F=0,U=I.length;F<U;F++)if(I[F]!==N.getUint8(O+F,!1))return;return 1}(P,C,A))return;return 1}(k))(function(_,C){for(var P,A,I,N,O,F,U,G=new DataView(C),Y=G.getUint32(80,!0),$=!1,H=0;H<70;H++)G.getUint32(H,!1)===1129270351&&G.getUint8(H+4)===82&&G.getUint8(H+5)===61&&($=!0,N=[],O=G.getUint8(H+6)/255,F=G.getUint8(H+7)/255,U=G.getUint8(H+8)/255);for(var Q=0;Q<Y;Q++){for(var J,ae=84+50*Q,T=G.getFloat32(ae,!0),B=G.getFloat32(4+ae,!0),W=G.getFloat32(8+ae,!0),K=($&&(J=G.getUint16(48+ae,!0),I=32768&J?(P=O,A=F,U):(P=(31&J)/31,A=(J>>5&31)/31,(J>>10&31)/31)),new l.default.Vector(T,B,W)),te=1;te<=3;te++){var ne=ae+12*te,ne=new l.default.Vector(G.getFloat32(ne,!0),G.getFloat32(4+ne,!0),G.getFloat32(8+ne,!0));_.vertices.push(ne),_.vertexNormals.push(K),$&&N.push(P,A,I)}_.faces.push([3*Q,3*Q+1,3*Q+2]),_.uvs.push([0,0],[0,0],[0,0])}})(S,k);else{if(k=new DataView(k),!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)");k=new TextDecoder("utf-8").decode(k).split(`
`),function(_,C){for(var P,A,I="",N=[],O=0;O<C.length;++O){for(var F=C[O].trim(),U=F.split(" "),G=0;G<U.length;++G)U[G]===""&&U.splice(G,1);if(U.length!==0)switch(I){case"":if(U[0]!=="solid")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "solid"'));I="solid";break;case"solid":if(U[0]!=="facet"||U[1]!=="normal")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "facet normal"'));P=new l.default.Vector(parseFloat(U[2]),parseFloat(U[3]),parseFloat(U[4])),_.vertexNormals.push(P,P,P),I="facet normal";break;case"facet normal":if(U[0]!=="outer"||U[1]!=="loop")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "outer loop"'));I="vertex";break;case"vertex":if(U[0]==="vertex")A=new l.default.Vector(parseFloat(U[1]),parseFloat(U[2]),parseFloat(U[3])),_.vertices.push(A),_.uvs.push([0,0]),N.push(_.vertices.indexOf(A));else{if(U[0]!=="endloop")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "vertex" or "endloop"'));_.faces.push(N),N=[],I="endloop"}break;case"endloop":if(U[0]!=="endfacet")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "endfacet"'));I="endfacet";break;case"endfacet":if(U[0]!=="endsolid"){if(U[0]!=="facet"||U[1]!=="normal")return console.error(F),console.error('Invalid state "'.concat(U[0],'", should be "endsolid" or "facet normal"'));P=new l.default.Vector(parseFloat(U[2]),parseFloat(U[3]),parseFloat(U[4])),_.vertexNormals.push(P,P,P),I="facet normal"}break;default:console.error('Invalid state "'.concat(I,'"'))}}}(S,k)}})(v,w),y&&v.normalize(),g&&v.flipU(),b&&v.flipV(),x._decrementPreload(),typeof d=="function"&&d(v)},p):m.match(/\.obj$/i)?this.loadStrings(f,function(w){for(var S=v,k=w,_={v:[],vt:[],vn:[]},C={},P=0;P<k.length;++P){var A=k[P].trim().split(/\b\s+/);if(0<A.length){if(A[0]==="v"||A[0]==="vn"){var I=new l.default.Vector(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]));_[A[0]].push(I)}else if(A[0]==="vt")I=[parseFloat(A[1]),1-parseFloat(A[2])],_[A[0]].push(I);else if(A[0]==="f")for(var N=3;N<A.length;++N){for(var O=[],F=[1,N-1,N],U=0;U<F.length;++U){var G=A[F[U]],Y=0;if(C[G]!==void 0)Y=C[G];else{for(var $=G.split("/"),H=0;H<$.length;H++)$[H]=parseInt($[H])-1;Y=C[G]=S.vertices.length,S.vertices.push(_.v[$[0]].copy()),_.vt[$[1]]?S.uvs.push(_.vt[$[1]].slice()):S.uvs.push([0,0]),_.vn[$[2]]&&S.vertexNormals.push(_.vn[$[2]].copy())}O.push(Y)}O[0]!==O[1]&&O[0]!==O[2]&&O[1]!==O[2]&&S.faces.push(O)}}}S.vertexNormals.length===0&&S.computeNormals(),y&&v.normalize(),g&&v.flipU(),b&&v.flipV(),x._decrementPreload(),typeof d=="function"&&d(v)},p):(l.default._friendlyFileLoadError(3,f),p?p():l.default._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.")),v},l.default.prototype.model=function(f){this._assert3d("model"),l.default._validateParameters("model",arguments),0<f.vertices.length&&(this._renderer.geometryInHash(f.gid)||(f.edges.length===0&&f._makeTriangleEdges(),f._edgesToVertices(),this._renderer.createBuffers(f.gid,f)),this._renderer.drawBuffers(f.gid))};var u=l.default;a.default=u},{"../core/main":280,"./p5.Geometry":332,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.splice":170,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.match":198,"core-js/modules/es.string.split":203,"core-js/modules/es.string.trim":206,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],328:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.join"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants"));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}r("./p5.Texture"),c.default.prototype.loadShader=function(d,p,y,g){c.default._validateParameters("loadShader",arguments),g=g||console.error;function b(){v._decrementPreload(),y&&y(m)}var m=new c.default.Shader,v=this,x=!1,w=!1;return this.loadStrings(d,function(S){m._vertSrc=S.join(`
`),w=!0,x&&b()},g),this.loadStrings(p,function(S){m._fragSrc=S.join(`
`),x=!0,w&&b()},g),m},c.default.prototype.createShader=function(d,p){return c.default._validateParameters("createShader",arguments),new c.default.Shader(this._renderer,d,p)},c.default.prototype.createFilterShader=function(d){c.default._validateParameters("createFilterShader",arguments);var p=d.includes("#version 300 es")?`#version 300 es
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    in vec3 aPosition;
    in vec2 aTexCoord;
    out vec2 vTexCoord;

    void main() {
      // transferring texcoords for the frag shader
      vTexCoord = aTexCoord;

      // copy position with a fourth coordinate for projection (1.0 is normal)
      vec4 positionVec4 = vec4(aPosition, 1.0);

      // project to 3D space
      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
    }
  `:`
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    attribute vec3 aPosition;
    // texcoords only come from p5 to vertex shader
    // so pass texcoords on to the fragment shader in a varying variable
    attribute vec2 aTexCoord;
    varying vec2 vTexCoord;

    void main() {
      // transferring texcoords for the frag shader
      vTexCoord = aTexCoord;

      // copy position with a fourth coordinate for projection (1.0 is normal)
      vec4 positionVec4 = vec4(aPosition, 1.0);

      // project to 3D space
      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
    }
  `,p=new c.default.Shader(this._renderer,p,d);return this._renderer.GL?p.ensureCompiledOnContext(this):p.ensureCompiledOnContext(this._renderer.getFilterGraphicsLayer()),p},c.default.prototype.shader=function(d){return this._assert3d("shader"),c.default._validateParameters("shader",arguments),d.ensureCompiledOnContext(this),d.isStrokeShader()?this._renderer.userStrokeShader=d:(this._renderer.userFillShader=d,this._renderer._useNormalMaterial=!1),this},c.default.prototype.resetShader=function(){return this._renderer.userFillShader=this._renderer.userStrokeShader=null,this},c.default.prototype.texture=function(d){return this._assert3d("texture"),c.default._validateParameters("texture",arguments),d.gifProperties&&d._animateGif(this),this._renderer.drawMode=u.TEXTURE,this._renderer._useNormalMaterial=!1,this._renderer._tex=d,this._renderer._setProperty("_doFill",!0),this},c.default.prototype.textureMode=function(d){d!==u.IMAGE&&d!==u.NORMAL?console.warn("You tried to set ".concat(d," textureMode only supports IMAGE & NORMAL ")):this._renderer.textureMode=d},c.default.prototype.textureWrap=function(d){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:d,y=(this._renderer.textureWrapX=d,this._renderer.textureWrapY=p,!0),g=!1,b=void 0;try{for(var m,v=this._renderer.textures.values()[Symbol.iterator]();!(y=(m=v.next()).done);y=!0)m.value.setWrapMode(d,p)}catch(x){g=!0,b=x}finally{try{y||v.return==null||v.return()}finally{if(g)throw b}}},c.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var d=arguments.length,p=new Array(d),y=0;y<d;y++)p[y]=arguments[y];return c.default._validateParameters("normalMaterial",p),this._renderer.drawMode=u.FILL,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!0,this._renderer.curFillColor=[1,1,1,1],this._renderer._setProperty("_doFill",!0),this.noStroke(),this},c.default.prototype.ambientMaterial=function(d,p,y){this._assert3d("ambientMaterial"),c.default._validateParameters("ambientMaterial",arguments);var g=c.default.prototype.color.apply(this,arguments);return this._renderer._hasSetAmbient=!0,this._renderer.curAmbientColor=g._array,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._setProperty("_doFill",!0),this},c.default.prototype.emissiveMaterial=function(d,p,y,g){this._assert3d("emissiveMaterial"),c.default._validateParameters("emissiveMaterial",arguments);var b=c.default.prototype.color.apply(this,arguments);return this._renderer.curEmissiveColor=b._array,this._renderer._useEmissiveMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},c.default.prototype.specularMaterial=function(d,p,y,g){this._assert3d("specularMaterial"),c.default._validateParameters("specularMaterial",arguments);var b=c.default.prototype.color.apply(this,arguments);return this._renderer.curSpecularColor=b._array,this._renderer._useSpecularMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},c.default.prototype.shininess=function(d){return this._assert3d("shininess"),c.default._validateParameters("shininess",arguments),this._renderer._useShininess=d=d<1?1:d,this},c.default.prototype.metalness=function(d){return this._assert3d("metalness"),d=1-Math.exp(-d/100),this._renderer._useMetalness=d,this},c.default.RendererGL.prototype._applyColorBlend=function(d,b){var y=this.GL,g=this.drawMode===u.TEXTURE,b=b||this.userFillShader||this.userStrokeShader||this.userPointShader||g||this.curBlendMode!==u.BLEND||d[d.length-1]<1||this._isErasing;return b!==this._isBlending&&(b||this.curBlendMode!==u.BLEND&&this.curBlendMode!==u.ADD?y.enable(y.BLEND):y.disable(y.BLEND),y.depthMask(!0),this._isBlending=b),this._applyBlendMode(),d},c.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode!==this.curBlendMode){var d=this.GL;switch(this.curBlendMode){case u.BLEND:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case u.ADD:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE);break;case u.REMOVE:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ZERO,d.ONE_MINUS_SRC_ALPHA);break;case u.MULTIPLY:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.DST_COLOR,d.ONE_MINUS_SRC_ALPHA);break;case u.SCREEN:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_COLOR);break;case u.EXCLUSION:d.blendEquationSeparate(d.FUNC_ADD,d.FUNC_ADD),d.blendFuncSeparate(d.ONE_MINUS_DST_COLOR,d.ONE_MINUS_SRC_COLOR,d.ONE,d.ONE);break;case u.REPLACE:d.blendEquation(d.FUNC_ADD),d.blendFunc(d.ONE,d.ZERO);break;case u.SUBTRACT:d.blendEquationSeparate(d.FUNC_REVERSE_SUBTRACT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE_MINUS_SRC_ALPHA);break;case u.DARKEST:this.blendExt?(d.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case u.LIGHTEST:this.blendExt?(d.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,d.FUNC_ADD),d.blendFuncSeparate(d.ONE,d.ONE,d.ONE,d.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.")}this._isErasing||(this._cachedBlendMode=this.curBlendMode)}};var h=c.default;a.default=h},{"../core/constants":269,"../core/main":280,"./p5.Texture":339,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.join":165,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],329:[function(r,s,a){r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.hypot"),r("core-js/modules/es.string.sub"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}i.default.prototype.camera=function(){var c;this._assert3d("camera");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("camera",f),(c=this._renderer._curCamera).camera.apply(c,f),this},i.default.prototype.perspective=function(){var c;this._assert3d("perspective");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("perspective",f),(c=this._renderer._curCamera).perspective.apply(c,f),this},i.default.prototype.ortho=function(){var c;this._assert3d("ortho");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("ortho",f),(c=this._renderer._curCamera).ortho.apply(c,f),this},i.default.prototype.frustum=function(){var c;this._assert3d("frustum");for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return i.default._validateParameters("frustum",f),(c=this._renderer._curCamera).frustum.apply(c,f),this},i.default.prototype.createCamera=function(){this._assert3d("createCamera");var c=new i.default.Camera(this._renderer);return c._computeCameraDefaultSettings(),c._setDefaultCamera(),this._renderer._curCamera=c},i.default.Camera=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._renderer=h,this.cameraType="default",this.cameraMatrix=new i.default.Matrix,this.projMatrix=new i.default.Matrix,this.yScale=1}var u,f;return u=c,(f=[{key:"perspective",value:function(g,d,p,y){this.cameraType=0<arguments.length?"custom":"default",g===void 0?(g=this.defaultCameraFOV,this.cameraFOV=g):this.cameraFOV=this._renderer._pInst._toRadians(g),d===void 0&&(d=this.defaultAspectRatio),p===void 0&&(p=this.defaultCameraNear),y===void 0&&(y=this.defaultCameraFar),p<=1e-4&&(p=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),y<p&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=d,this.cameraNear=p,this.cameraFar=y,this.projMatrix=i.default.Matrix.identity();var g=1/Math.tan(this.cameraFOV/2),b=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(g/d,0,0,0,0,-g*this.yScale,0,0,0,0,(y+p)*b,-1,0,0,2*y*p*b,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix)}},{key:"ortho",value:function(_,k,p,y,g,b){_===void 0&&(_=-this._renderer.width/2),k===void 0&&(k=+this._renderer.width/2),p===void 0&&(p=-this._renderer.height/2),y===void 0&&(y=+this._renderer.height/2),g===void 0&&(g=0),b===void 0&&(b=Math.max(this._renderer.width,this._renderer.height)+800),this.cameraNear=g;var C=k-_,m=y-p,v=(this.cameraFar=b)-g,x=2/C,w=2/m*this.yScale,S=-2/v,k=-(k+_)/C,_=-(y+p)/m,C=-(b+g)/v;this.projMatrix=i.default.Matrix.identity(),this.projMatrix.set(x,0,0,0,0,-w,0,0,0,0,S,0,k,_,C,1),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix),this.cameraType="custom"}},{key:"frustum",value:function(_,k,p,y,g,b){_===void 0&&(_=.05*-this._renderer.width),k===void 0&&(k=.05*+this._renderer.width),p===void 0&&(p=.05*+this._renderer.height),y===void 0&&(y=.05*-this._renderer.height),g===void 0&&(g=this.defaultCameraNear),b===void 0&&(b=this.defaultCameraFar),this.cameraNear=g;var C=k-_,m=y-p,v=(this.cameraFar=b)-g,x=2*g/C,w=2*g/m*this.yScale,S=-2*b*g/v,k=(k+_)/C,_=(y+p)/m,C=-(b+g)/v;this.projMatrix=i.default.Matrix.identity(),this.projMatrix.set(x,0,0,0,0,-w,0,0,k,_,C,-1,0,0,S,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix),this.cameraType="custom"}},{key:"_rotateView",value:function(x,d,p,y){var g=this.centerX,b=this.centerY,m=this.centerZ,v=(g-=this.eyeX,b-=this.eyeY,m-=this.eyeZ,i.default.Matrix.identity(this._renderer._pInst)),x=(v.rotate(this._renderer._pInst._toRadians(x),d,p,y),[g*v.mat4[0]+b*v.mat4[4]+m*v.mat4[8],g*v.mat4[1]+b*v.mat4[5]+m*v.mat4[9],g*v.mat4[2]+b*v.mat4[6]+m*v.mat4[10]]);x[0]+=this.eyeX,x[1]+=this.eyeY,x[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,x[0],x[1],x[2],this.upX,this.upY,this.upZ)}},{key:"pan",value:function(h){var d=this._getLocalAxes();this._rotateView(h,d.y[0],d.y[1],d.y[2])}},{key:"tilt",value:function(h){var d=this._getLocalAxes();this._rotateView(h,d.x[0],d.x[1],d.x[2])}},{key:"lookAt",value:function(h,d,p){this.camera(this.eyeX,this.eyeY,this.eyeZ,h,d,p,this.upX,this.upY,this.upZ)}},{key:"camera",value:function(h,d,p,y,g,b,m,v,x){return h===void 0&&(h=this.defaultEyeX,d=this.defaultEyeY,p=this.defaultEyeZ,y=h,g=d,v=1,x=m=b=0),this.eyeX=h,this.eyeY=d,this.eyeZ=p,y!==void 0&&(this.centerX=y,this.centerY=g,this.centerZ=b),m!==void 0&&(this.upX=m,this.upY=v,this.upZ=x),y=this._getLocalAxes(),this.cameraMatrix.set(y.x[0],y.y[0],y.z[0],0,y.x[1],y.y[1],y.z[1],0,y.x[2],y.y[2],y.z[2],0,0,0,0,1),g=-h,this.cameraMatrix.translate([g,-d,-p]),this._isActive()&&this._renderer.uMVMatrix.set(this.cameraMatrix),this}},{key:"move",value:function(y,g,p){var b=this._getLocalAxes(),y=[b.x[0]*y,b.x[1]*y,b.x[2]*y],g=[b.y[0]*g,b.y[1]*g,b.y[2]*g],b=[b.z[0]*p,b.z[1]*p,b.z[2]*p];this.camera(this.eyeX+y[0]+g[0]+b[0],this.eyeY+y[1]+g[1]+b[1],this.eyeZ+y[2]+g[2]+b[2],this.centerX+y[0]+g[0]+b[0],this.centerY+y[1]+g[1]+b[1],this.centerZ+y[2]+g[2]+b[2],this.upX,this.upY,this.upZ)}},{key:"setPosition",value:function(h,d,p){var y=h-this.eyeX,g=d-this.eyeY,b=p-this.eyeZ;this.camera(h,d,p,this.centerX+y,this.centerY+g,this.centerZ+b,this.upX,this.upY,this.upZ)}},{key:"set",value:function(h){for(var d=0,p=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType","yScale"];d<p.length;d++){var y=p[d];this[y]=h[y]}this.cameraMatrix=h.cameraMatrix.copy(),this.projMatrix=h.projMatrix.copy(),this._isActive()&&(this._renderer.uMVMatrix.mat4=this.cameraMatrix.mat4.slice(),this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())}},{key:"slerp",value:function(h,d,p){var y,g,b,m,v,x,w,S,k,_,C,P,A,I,N,O,F,U;p===0?this.set(h):p===1?this.set(d):(this.projMatrix.mat4[15]!==0&&(this.projMatrix.mat4[0]=h.projMatrix.mat4[0]*Math.pow(d.projMatrix.mat4[0]/h.projMatrix.mat4[0],p),this.projMatrix.mat4[5]=h.projMatrix.mat4[5]*Math.pow(d.projMatrix.mat4[5]/h.projMatrix.mat4[5],p),this._isActive()&&(this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())),m=new i.default.Vector(h.eyeX,h.eyeY,h.eyeZ),v=new i.default.Vector(d.eyeX,d.eyeY,d.eyeZ),O=new i.default.Vector(h.centerX,h.centerY,h.centerZ),U=new i.default.Vector(d.centerX,d.centerY,d.centerZ),b=i.default.Vector.dist(m,O),y=i.default.Vector.dist(v,U),y=b*Math.pow(y/b,p),b=i.default.Vector.sub(m,v),g=1,1e-6<(F=(I=m.copy().sub(v).sub(O).add(U)).magSq())&&(g=i.default.Vector.dot(b,I)/F,g=Math.max(0,Math.min(g,1))),b=i.default.Vector.lerp(i.default.Vector.lerp(m,O,g),i.default.Vector.lerp(v,U,g),p),I=h.cameraMatrix.createSubMatrix3x3(),F=d.cameraMatrix.createSubMatrix3x3(),m=I.row(2),O=F.row(2),v=I.row(1),U=F.row(1),h=new i.default.Vector,d=new i.default.Vector,x=new i.default.Vector,w=new i.default.Vector,1-(S=.5*((I=(F=F.mult3x3(I.copy().transpose3x3())).diagonal())[0]+I[1]+I[2]-1))<1e-7?(h.set(i.default.Vector.lerp(m,O,p)).normalize(),x.set(h).mult(g*y).add(b),w.set(h).mult((g-1)*y).add(b),d.set(i.default.Vector.lerp(v,U,p)).normalize()):(O=1/(1-S),U=Math.max(I[0],I[1],I[2]),P=F.mat3[1]+F.mat3[3],A=F.mat3[2]+F.mat3[6],N=F.mat3[5]+F.mat3[7],U=U===I[0]?(_=.5*P*(O/=k=Math.sqrt((I[0]-S)*O)),C=.5*A*O,.5*(F.mat3[7]-F.mat3[5])/k):U===I[1]?(C=.5*N*(O/=_=Math.sqrt((I[1]-S)*O)),k=.5*P*O,.5*(F.mat3[2]-F.mat3[6])/_):(k=.5*A*(O/=C=Math.sqrt((I[2]-S)*O)),_=.5*N*O,.5*(F.mat3[3]-F.mat3[1])/C),P=p*Math.atan2(U,S),A=Math.cos(P),I=Math.sin(P),(U=new i.default.Matrix("mat3",[A+(N=1-A)*k*k,N*(O=k*_)+I*C,N*(F=C*k)-I*_,N*O-I*C,A+N*_*_,N*(p=_*C)+I*k,N*F+I*_,N*p-I*k,A+N*C*C])).multiplyVec3(m,h),x.set(h).mult(g*y).add(b),w.set(h).mult((g-1)*y).add(b),U.multiplyVec3(v,d)),this.camera(x.x,x.y,x.z,w.x,w.y,w.z,d.x,d.y,d.z))}},{key:"_computeCameraDefaultSettings",value:function(){this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=800,this.defaultCameraFOV=2*Math.atan(this._renderer.height/2/this.defaultEyeZ),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ}},{key:"_setDefaultCamera",value:function(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"}},{key:"_resize",value:function(){this.cameraType==="default"&&(this._computeCameraDefaultSettings(),this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.perspective())}},{key:"copy",value:function(){var h=new i.default.Camera(this._renderer);return h.cameraFOV=this.cameraFOV,h.aspectRatio=this.aspectRatio,h.eyeX=this.eyeX,h.eyeY=this.eyeY,h.eyeZ=this.eyeZ,h.centerX=this.centerX,h.centerY=this.centerY,h.centerZ=this.centerZ,h.upX=this.upX,h.upY=this.upY,h.upZ=this.upZ,h.cameraNear=this.cameraNear,h.cameraFar=this.cameraFar,h.cameraType=this.cameraType,h.cameraMatrix=this.cameraMatrix.copy(),h.projMatrix=this.projMatrix.copy(),h.yScale=this.yScale,h}},{key:"_getLocalAxes",value:function(){var h=this.eyeX-this.centerX,d=this.eyeY-this.centerY,p=this.eyeZ-this.centerZ,m=Math.sqrt(h*h+d*d+p*p),m=(m!==0&&(h/=m,d/=m,p/=m),this.upX),y=(v=this.upY)*p-(x=this.upZ)*d,g=-m*p+x*h,b=m*d-v*h,m=d*b-p*g,v=-h*b+p*y,x=h*g-d*y,w=Math.sqrt(y*y+g*g+b*b),w=(w!==0&&(y/=w,g/=w,b/=w),Math.sqrt(m*m+v*v+x*x));return w!==0&&(m/=w,v/=w,x/=w),{x:[y,g,b],y:[m,v,x],z:[h,d,p]}}},{key:"_orbit",value:function(h,w,x){var g=this.eyeX-this.centerX,b=this.eyeY-this.centerY,m=this.eyeZ-this.centerZ,y=Math.hypot(g,b,m),g=new i.default.Vector(g,b,m).normalize(),b=new i.default.Vector(this.upX,this.upY,this.upZ).normalize(),m=i.default.Vector.cross(b,g).normalize(),v=i.default.Vector.cross(m,b),x=((y=(y*=Math.pow(10,x))<this.cameraNear?this.cameraNear:y)>this.cameraFar&&(y=this.cameraFar),Math.acos(Math.max(-1,Math.min(1,i.default.Vector.dot(g,b))))+w),w=h;(x<=0||x>=Math.PI)&&(this.upX*=-1,this.upY*=-1,this.upZ*=-1),b.mult(Math.cos(x)),v.mult(Math.cos(w)*Math.sin(x)),m.mult(Math.sin(w)*Math.sin(x)),g.set(b).add(v).add(m),this.eyeX=y*g.x+this.centerX,this.eyeY=y*g.y+this.centerY,this.eyeZ=y*g.z+this.centerZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}},{key:"_orbitFree",value:function(x,w,k){var g=this.eyeX-this.centerX,b=this.eyeY-this.centerY,m=this.eyeZ-this.centerZ,y=Math.hypot(g,b,m),g=new i.default.Vector(g,b,m).normalize(),b=new i.default.Vector(this.upX,this.upY,this.upZ),m=i.default.Vector.cross(b,g).normalize(),v=i.default.Vector.cross(g,m),_=Math.atan2(w,x),_=(v.mult(Math.sin(_)),m.mult(Math.cos(_)).add(v),Math.sqrt(x*x+w*w)),v=i.default.Vector.cross(g,m),x=((y=(y*=Math.pow(10,k))<this.cameraNear?this.cameraNear:y)>this.cameraFar&&(y=this.cameraFar),Math.cos(_)),w=Math.sin(_),k=b.dot(g),_=b.dot(m),S=k*x+_*w,k=-k*w+_*x,_=b.dot(v);b.x=S*g.x+k*m.x+_*v.x,b.y=S*g.y+k*m.y+_*v.y,b.z=S*g.z+k*m.z+_*v.z,m.mult(-w),g.mult(x).add(m).mult(y),this.camera(g.x+this.centerX,g.y+this.centerY,g.z+this.centerZ,this.centerX,this.centerY,this.centerZ,b.x,b.y,b.z)}},{key:"_isActive",value:function(){return this===this._renderer._curCamera}}])&&l(u.prototype,f),c}(),i.default.prototype.setCamera=function(c){this._renderer._curCamera=c,this._renderer.uPMatrix.set(c.projMatrix)},r=i.default.Camera,a.default=r},{"../core/main":280,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.hypot":175,"core-js/modules/es.string.sub":205}],330:[function(r,s,a){r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.log2"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.math.log2"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function i(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.DataArray=function(){function l(){var f=0<arguments.length&&arguments[0]!==void 0?arguments[0]:128,h=this,d=l;if(!(h instanceof d))throw new TypeError("Cannot call a class as a function");this.length=0,this.data=new Float32Array(f),this.initialLength=f}var c,u;return c=l,(u=[{key:"dataArray",value:function(){return this.subArray(0,this.length)}},{key:"clear",value:function(){this.length=0}},{key:"rescale",value:function(){var f;this.length<this.data.length/2&&(f=1<<Math.ceil(Math.log2(this.length)),(f=new Float32Array(f)).set(this.data.subarray(0,this.length),0),this.data=f)}},{key:"reset",value:function(){this.clear(),this.data=new Float32Array(this.initialLength)}},{key:"push",value:function(){for(var f=arguments.length,h=new Array(f),d=0;d<f;d++)h[d]=arguments[d];this.ensureLength(this.length+h.length),this.data.set(h,this.length),this.length+=h.length}},{key:"slice",value:function(f,h){return this.data.slice(f,Math.min(h,this.length))}},{key:"subArray",value:function(f,h){return this.data.subarray(f,Math.min(h,this.length))}},{key:"ensureLength",value:function(f){for(;this.data.length<f;){var h=new Float32Array(2*this.data.length);h.set(this.data,0),this.data=h}}}])&&i(c.prototype,u),l}(),r=r.default.DataArray,a.default=r},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.math.log2":176,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236}],331:[function(P,s,a){function i(A){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(A)}function l(A){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(I){return i(I)}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":i(I)})(A)}P("core-js/modules/es.symbol"),P("core-js/modules/es.symbol.description"),P("core-js/modules/es.symbol.iterator"),P("core-js/modules/es.array.fill"),P("core-js/modules/es.array.includes"),P("core-js/modules/es.array.iterator"),P("core-js/modules/es.object.get-own-property-descriptor"),P("core-js/modules/es.object.get-prototype-of"),P("core-js/modules/es.object.to-string"),P("core-js/modules/es.reflect.construct"),P("core-js/modules/es.reflect.get"),P("core-js/modules/es.regexp.to-string"),P("core-js/modules/es.string.includes"),P("core-js/modules/es.string.iterator"),P("core-js/modules/es.typed-array.float32-array"),P("core-js/modules/es.typed-array.uint8-array"),P("core-js/modules/es.typed-array.uint8-clamped-array"),P("core-js/modules/es.typed-array.copy-within"),P("core-js/modules/es.typed-array.every"),P("core-js/modules/es.typed-array.fill"),P("core-js/modules/es.typed-array.filter"),P("core-js/modules/es.typed-array.find"),P("core-js/modules/es.typed-array.find-index"),P("core-js/modules/es.typed-array.for-each"),P("core-js/modules/es.typed-array.includes"),P("core-js/modules/es.typed-array.index-of"),P("core-js/modules/es.typed-array.iterator"),P("core-js/modules/es.typed-array.join"),P("core-js/modules/es.typed-array.last-index-of"),P("core-js/modules/es.typed-array.map"),P("core-js/modules/es.typed-array.reduce"),P("core-js/modules/es.typed-array.reduce-right"),P("core-js/modules/es.typed-array.reverse"),P("core-js/modules/es.typed-array.set"),P("core-js/modules/es.typed-array.slice"),P("core-js/modules/es.typed-array.some"),P("core-js/modules/es.typed-array.sort"),P("core-js/modules/es.typed-array.subarray"),P("core-js/modules/es.typed-array.to-locale-string"),P("core-js/modules/es.typed-array.to-string"),P("core-js/modules/es.weak-map"),P("core-js/modules/web.dom-collections.iterator"),P("core-js/modules/es.array.fill"),P("core-js/modules/es.array.includes"),P("core-js/modules/es.array.iterator"),P("core-js/modules/es.object.get-prototype-of"),P("core-js/modules/es.object.to-string"),P("core-js/modules/es.string.includes"),P("core-js/modules/es.typed-array.float32-array"),P("core-js/modules/es.typed-array.uint8-array"),P("core-js/modules/es.typed-array.uint8-clamped-array"),P("core-js/modules/es.typed-array.copy-within"),P("core-js/modules/es.typed-array.every"),P("core-js/modules/es.typed-array.fill"),P("core-js/modules/es.typed-array.filter"),P("core-js/modules/es.typed-array.find"),P("core-js/modules/es.typed-array.find-index"),P("core-js/modules/es.typed-array.for-each"),P("core-js/modules/es.typed-array.includes"),P("core-js/modules/es.typed-array.index-of"),P("core-js/modules/es.typed-array.iterator"),P("core-js/modules/es.typed-array.join"),P("core-js/modules/es.typed-array.last-index-of"),P("core-js/modules/es.typed-array.map"),P("core-js/modules/es.typed-array.reduce"),P("core-js/modules/es.typed-array.reduce-right"),P("core-js/modules/es.typed-array.reverse"),P("core-js/modules/es.typed-array.set"),P("core-js/modules/es.typed-array.slice"),P("core-js/modules/es.typed-array.some"),P("core-js/modules/es.typed-array.sort"),P("core-js/modules/es.typed-array.subarray"),P("core-js/modules/es.typed-array.to-locale-string"),P("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(C=P("../core/main"))&&C.__esModule?C:{default:C},u=function(A){if(A&&A.__esModule)return A;if(A===null||l(A)!=="object"&&typeof A!="function")return{default:A};var I=d();if(I&&I.has(A))return I.get(A);var N,O={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(N in A){var U;Object.prototype.hasOwnProperty.call(A,N)&&((U=F?Object.getOwnPropertyDescriptor(A,N):null)&&(U.get||U.set)?Object.defineProperty(O,N,U):O[N]=A[N])}return O.default=A,I&&I.set(A,O),O}(P("../core/constants")),f=P("./p5.Texture"),h=P("./p5.RendererGL");function d(){var A;return typeof WeakMap!="function"?null:(A=new WeakMap,d=function(){return A},A)}function p(A,I){return function(N){if(Array.isArray(N))return N}(A)||function(N,O){if(Symbol.iterator in Object(N)||Object.prototype.toString.call(N)==="[object Arguments]"){var F=[],U=!0,G=!1,Y=void 0;try{for(var $,H=N[Symbol.iterator]();!(U=($=H.next()).done)&&(F.push($.value),!O||F.length!==O);U=!0);}catch(Q){G=!0,Y=Q}finally{try{U||H.return==null||H.return()}finally{if(G)throw Y}}return F}}(A,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(A,I,N){return I in A?Object.defineProperty(A,I,{value:N,enumerable:!0,configurable:!0,writable:!0}):A[I]=N,A}function g(A,I){if(!(A instanceof I))throw new TypeError("Cannot call a class as a function")}function b(A,I){for(var N=0;N<I.length;N++){var O=I[N];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(A,O.key,O)}}function m(A,I,N){I&&b(A.prototype,I),N&&b(A,N)}function v(A,I,N){return(v=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(G,F,U){var G=function(Y,$){for(;!Object.prototype.hasOwnProperty.call(Y,$)&&(Y=S(Y))!==null;);return Y}(G,F);if(G)return(G=Object.getOwnPropertyDescriptor(G,F)).get?G.get.call(U):G.value})(A,I,N||A)}function x(A,I){return(x=Object.setPrototypeOf||function(N,O){return N.__proto__=O,N})(A,I)}function w(A){return function(){var I,N=S(A),N=(I=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(I=S(this).constructor,Reflect.construct(N,arguments,I)):N.apply(this,arguments),this);if(!I||l(I)!=="object"&&typeof I!="function"){if(N!==void 0)return N;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return I}}function S(A){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)})(A)}var k=function(A){var I=O;if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(A&&A.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),A&&x(I,A);var N=w(O);function O(F){var U;return g(this,O),(U=N.call(this,F.target._renderer)).fbo=F,U.yScale=-1,U}return m(O,[{key:"_computeCameraDefaultSettings",value:function(){v(S(O.prototype),"_computeCameraDefaultSettings",this).call(this),this.defaultAspectRatio=this.fbo.width/this.fbo.height,this.defaultCameraFOV=2*Math.atan(this.fbo.height/2/this.defaultEyeZ)}}]),O}(c.default.Camera),_=(c.default.FramebufferCamera=k,function(){function A(I,N){g(this,A),this.framebuffer=I,this.property=N}return m(A,[{key:"rawTexture",value:function(){return this.framebuffer[this.property]}},{key:"width",get:function(){return this.framebuffer.width*this.framebuffer.density}},{key:"height",get:function(){return this.framebuffer.height*this.framebuffer.density}}]),A}()),C=(c.default.FramebufferTexture=_,function(){function A(F){var N=this,O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},F=(g(this,A),this.target=F,this.target._renderer.framebuffers.add(this),this._isClipApplied=!1,this.pixels=[],this.format=O.format||u.UNSIGNED_BYTE,this.channels=O.channels||(F._renderer._pInst._glAttributes.alpha?u.RGBA:u.RGB),this.useDepth=O.depth===void 0||O.depth,this.depthFormat=O.depthFormat||u.FLOAT,this.textureFiltering=O.textureFiltering||u.LINEAR,O.antialias===void 0?this.antialiasSamples=F._renderer._pInst._glAttributes.antialias?2:0:typeof O.antialias=="number"?this.antialiasSamples=O.antialias:this.antialiasSamples=O.antialias?2:0,this.antialias=0<this.antialiasSamples,this.antialias&&F.webglVersion!==u.WEBGL2&&(console.warn("Antialiasing is unsupported in a WebGL 1 context"),this.antialias=!1),O.width&&O.height?(this.width=O.width,this.height=O.height,this.autoSized=!1):(O.width===void 0!=(O.height===void 0)&&console.warn("Please supply both width and height for a framebuffer to give it a size. Only one was given, so the framebuffer will match the size of its canvas."),this.width=F.width,this.height=F.height,this.autoSized=!0),this.density=O.density||F.pixelDensity(),F._renderer.GL);if(this.gl=F,this._checkIfFormatsAvailable(),O.stencil&&!this.useDepth&&console.warn("A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored."),this.useStencil=this.useDepth&&(O.stencil===void 0||O.stencil),this.framebuffer=F.createFramebuffer(),!this.framebuffer)throw new Error("Unable to create a framebuffer");if(this.antialias&&(this.aaFramebuffer=F.createFramebuffer(),!this.aaFramebuffer))throw new Error("Unable to create a framebuffer for antialiasing");this._recreateTextures(),O=this.target._renderer._curCamera,this.defaultCamera=this.createCamera(),this.filterCamera=this.createCamera(),this.target._renderer._curCamera=O,this.draw(function(){return N.target.clear()})}return m(A,[{key:"resize",value:function(I,N){this.autoSized=!1,this.width=I,this.height=N,this._handleResize()}},{key:"pixelDensity",value:function(I){if(!I)return this.density;this.autoSized=!1,this.density=I,this._handleResize()}},{key:"autoSized",value:function(I){if(I===void 0)return this.autoSized;this.autoSized=I,this._handleResize()}},{key:"_checkIfFormatsAvailable",value:function(){var I=this.gl,I=(this.useDepth&&this.target.webglVersion===u.WEBGL&&!I.getExtension("WEBGL_depth_texture")&&(console.warn("Unable to create depth textures in this environment. Falling back to a framebuffer without depth."),this.useDepth=!1),this.useDepth&&this.target.webglVersion===u.WEBGL&&this.depthFormat===u.FLOAT&&(console.warn("FLOAT depth format is unavailable in WebGL 1. Defaulting to UNSIGNED_INT."),this.depthFormat=u.UNSIGNED_INT),[u.UNSIGNED_BYTE,u.FLOAT,u.HALF_FLOAT].includes(this.format)||(console.warn("Unknown Framebuffer format. Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. Defaulting to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.useDepth&&![u.UNSIGNED_INT,u.FLOAT].includes(this.depthFormat)&&(console.warn("Unknown Framebuffer depth format. Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT."),this.depthFormat=u.FLOAT),(0,f.checkWebGLCapabilities)(this.target._renderer));I.float||this.format!==u.FLOAT||(console.warn("This environment does not support FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.useDepth&&!I.float&&this.depthFormat===u.FLOAT&&(console.warn("This environment does not support FLOAT depth textures. Falling back to UNSIGNED_INT."),this.depthFormat=u.UNSIGNED_INT),I.halfFloat||this.format!==u.HALF_FLOAT||(console.warn("This environment does not support HALF_FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=u.UNSIGNED_BYTE),this.channels===u.RGB&&[u.FLOAT,u.HALF_FLOAT].includes(this.format)&&(console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only RGB channels. Falling back to RGBA."),this.channels=u.RGBA)}},{key:"_recreateTextures",value:function(){var I=this.gl,N=(this._updateSize(),I.getParameter(I.TEXTURE_BINDING_2D)),O=I.getParameter(I.FRAMEBUFFER_BINDING),F=I.createTexture();if(!F)throw new Error("Unable to create color texture");I.bindTexture(I.TEXTURE_2D,F);var U=this._glColorFormat();if(I.texImage2D(I.TEXTURE_2D,0,U.internalFormat,this.width*this.density,this.height*this.density,0,U.format,U.type,null),this.colorTexture=F,I.bindFramebuffer(I.FRAMEBUFFER,this.framebuffer),I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,F,0),this.useDepth){var F=I.createTexture();if(!F)throw new Error("Unable to create depth texture");var G=this._glDepthFormat();I.bindTexture(I.TEXTURE_2D,F),I.texImage2D(I.TEXTURE_2D,0,G.internalFormat,this.width*this.density,this.height*this.density,0,G.format,G.type,null),I.framebufferTexture2D(I.FRAMEBUFFER,this.useStencil?I.DEPTH_STENCIL_ATTACHMENT:I.DEPTH_ATTACHMENT,I.TEXTURE_2D,F,0),this.depthTexture=F}this.antialias&&(this.colorRenderbuffer=I.createRenderbuffer(),I.bindRenderbuffer(I.RENDERBUFFER,this.colorRenderbuffer),I.renderbufferStorageMultisample(I.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,I.getParameter(I.MAX_SAMPLES))),U.internalFormat,this.width*this.density,this.height*this.density),this.useDepth&&(G=this._glDepthFormat(),this.depthRenderbuffer=I.createRenderbuffer(),I.bindRenderbuffer(I.RENDERBUFFER,this.depthRenderbuffer),I.renderbufferStorageMultisample(I.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,I.getParameter(I.MAX_SAMPLES))),G.internalFormat,this.width*this.density,this.height*this.density)),I.bindFramebuffer(I.FRAMEBUFFER,this.aaFramebuffer),I.framebufferRenderbuffer(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.RENDERBUFFER,this.colorRenderbuffer),this.useDepth&&I.framebufferRenderbuffer(I.FRAMEBUFFER,this.useStencil?I.DEPTH_STENCIL_ATTACHMENT:I.DEPTH_ATTACHMENT,I.RENDERBUFFER,this.depthRenderbuffer)),this.useDepth&&(this.depth=new _(this,"depthTexture"),F=I.NEAREST,this.depthP5Texture=new c.default.Texture(this.target._renderer,this.depth,{minFilter:F,magFilter:F}),this.target._renderer.textures.set(this.depth,this.depthP5Texture)),this.color=new _(this,"colorTexture"),U=this.textureFiltering===u.LINEAR?I.LINEAR:I.NEAREST,this.colorP5Texture=new c.default.Texture(this.target._renderer,this.color,{minFilter:U,magFilter:U}),this.target._renderer.textures.set(this.color,this.colorP5Texture),I.bindTexture(I.TEXTURE_2D,N),I.bindFramebuffer(I.FRAMEBUFFER,O)}},{key:"_glColorFormat",value:function(){var I,N,O=this.gl,F=this.format===u.FLOAT?O.FLOAT:this.format===u.HALF_FLOAT?this.target.webglVersion===u.WEBGL2?O.HALF_FLOAT:O.getExtension("OES_texture_half_float").HALF_FLOAT_OES:O.UNSIGNED_BYTE,U=this.channels===u.RGBA?O.RGBA:O.RGB;return{internalFormat:this.target.webglVersion===u.WEBGL2?(y(N={},O.FLOAT,y({},O.RGBA,O.RGBA32F)),y(N,O.HALF_FLOAT,y({},O.RGBA,O.RGBA16F)),y(N,O.UNSIGNED_BYTE,(y(I={},O.RGBA,O.RGBA8),y(I,O.RGB,O.RGB8),I)),N[F][U]):this.format===u.HALF_FLOAT?O.RGBA:U,format:U,type:F}}},{key:"_glDepthFormat",value:function(){var O=this.gl,I=this.useStencil?this.depthFormat===u.FLOAT?O.FLOAT_32_UNSIGNED_INT_24_8_REV:this.target.webglVersion===u.WEBGL2?O.UNSIGNED_INT_24_8:O.getExtension("WEBGL_depth_texture").UNSIGNED_INT_24_8_WEBGL:this.depthFormat===u.FLOAT?O.FLOAT:O.UNSIGNED_INT,N=this.useStencil?O.DEPTH_STENCIL:O.DEPTH_COMPONENT,O=this.useStencil?this.depthFormat===u.FLOAT?O.DEPTH32F_STENCIL8:this.target.webglVersion===u.WEBGL2?O.DEPTH24_STENCIL8:O.DEPTH_STENCIL:this.target.webglVersion===u.WEBGL2?this.depthFormat===u.FLOAT?O.DEPTH_COMPONENT32F:O.DEPTH_COMPONENT24:O.DEPTH_COMPONENT;return{internalFormat:O,format:N,type:I}}},{key:"_updateSize",value:function(){this.autoSized&&(this.width=this.target.width,this.height=this.target.height,this.density=this.target.pixelDensity())}},{key:"_canvasSizeChanged",value:function(){this.autoSized&&this._handleResize()}},{key:"_handleResize",value:function(){var F=this.color,I=this.depth,N=this.colorRenderbuffer,O=this.depthRenderbuffer,F=(this._deleteTexture(F),I&&this._deleteTexture(I),this.gl);N&&F.deleteRenderbuffer(N),O&&F.deleteRenderbuffer(O),this._recreateTextures(),this.defaultCamera._resize()}},{key:"createCamera",value:function(){var I=new k(this);return I._computeCameraDefaultSettings(),I._setDefaultCamera(),this.target._renderer._curCamera=I}},{key:"_deleteTexture",value:function(I){this.gl.deleteTexture(I.rawTexture()),this.target._renderer.textures.delete(I)}},{key:"remove",value:function(){var I=this.gl;this._deleteTexture(this.color),this.depth&&this._deleteTexture(this.depth),I.deleteFramebuffer(this.framebuffer),this.aaFramebuffer&&I.deleteFramebuffer(this.aaFramebuffer),this.depthRenderbuffer&&I.deleteRenderbuffer(this.depthRenderbuffer),this.colorRenderbuffer&&I.deleteRenderbuffer(this.colorRenderbuffer),this.target._renderer.framebuffers.delete(this)}},{key:"begin",value:function(){this.prevFramebuffer=this.target._renderer.activeFramebuffer(),this.prevFramebuffer&&this.prevFramebuffer._beforeEnd(),this.target._renderer.activeFramebuffers.push(this),this._beforeBegin(),this.target.push(),this.target.setCamera(this.defaultCamera),this.target._renderer.uMVMatrix.set(this.target._renderer._curCamera.cameraMatrix)}},{key:"_framebufferToBind",value:function(){return this.antialias?this.aaFramebuffer:this.framebuffer}},{key:"_beforeBegin",value:function(){var I=this.gl;I.bindFramebuffer(I.FRAMEBUFFER,this._framebufferToBind()),this.target._renderer.viewport(this.width*this.density,this.height*this.density)}},{key:"_beforeEnd",value:function(){if(this.antialias){var I=this.gl,N=(I.bindFramebuffer(I.READ_FRAMEBUFFER,this.aaFramebuffer),I.bindFramebuffer(I.DRAW_FRAMEBUFFER,this.framebuffer),[[I.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]]);this.useDepth&&N.push([I.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter]);for(var O=0,F=N;O<F.length;O++){var G=p(F[O],2),U=G[0],G=G[1];I.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,U,G)}}}},{key:"end",value:function(){var I=this.gl;if(this.target.pop(),this.target._renderer.activeFramebuffers.pop()!==this)throw new Error("It looks like you've called end() while another Framebuffer is active.");this._beforeEnd(),this.prevFramebuffer?this.prevFramebuffer._beforeBegin():(I.bindFramebuffer(I.FRAMEBUFFER,null),this.target._renderer.viewport(this.target._renderer._origViewport.width,this.target._renderer._origViewport.height)),this.target._renderer._applyStencilTestIfClipping()}},{key:"draw",value:function(I){this.begin(),I(),this.end()}},{key:"loadPixels",value:function(){var I=this.gl,N=this.target._renderer.activeFramebuffer(),O=(I.bindFramebuffer(I.FRAMEBUFFER,this.framebuffer),this._glColorFormat());this.pixels=(0,h.readPixelsWebGL)(this.pixels,I,this.framebuffer,0,0,this.width*this.density,this.height*this.density,O.format,O.type),N?I.bindFramebuffer(I.FRAMEBUFFER,N._framebufferToBind()):I.bindFramebuffer(I.FRAMEBUFFER,null)}},{key:"get",value:function(I,N,O,F){c.default._validateParameters("p5.Framebuffer.get",arguments);var U=this._glColorFormat();if(I===void 0&&N===void 0)N=I=0,O=this.width,F=this.height;else if(O===void 0&&F===void 0)return(I<0||N<0||I>=this.width||N>=this.height)&&(console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped."),I=this.target.constrain(I,0,this.width-1),N=this.target.constrain(N,0,this.height-1)),(0,h.readPixelWebGL)(this.gl,this.framebuffer,I*this.density,N*this.density,U.format,U.type);I=this.target.constrain(I,0,this.width-1),N=this.target.constrain(N,0,this.height-1),O=this.target.constrain(O,1,this.width-I),F=this.target.constrain(F,1,this.height-N);for(var G=(0,h.readPixelsWebGL)(void 0,this.gl,this.framebuffer,I*this.density,N*this.density,O*this.density,F*this.density,U.format,U.type),Y=new Uint8ClampedArray(O*F*this.density*this.density*4),$=(Y.fill(255),U.type===this.gl.RGB?3:4),H=0;H<F*this.density;H++)for(var Q=0;Q<O*this.density;Q++)for(var J=0;J<4;J++){var ae,T=4*(H*O*this.density+Q)+J;J<$&&(ae=$==4?T:(H*O*this.density+Q)*$+J,Y[T]=G[ae])}return I=new c.default.Image(O*this.density,F*this.density),I.imageData=I.canvas.getContext("2d").createImageData(I.width,I.height),I.imageData.data.set(Y),I.pixels=I.imageData.data,I.updatePixels(),this.density!==1&&I.resize(O,F),I}},{key:"updatePixels",value:function(){var I=this.gl,N=(this.colorP5Texture.bindTexture(),this._glColorFormat()),O=N.format===I.RGBA?4:3,O=this.width*this.height*this.density*this.density*O,F=N.type===I.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(this.pixels instanceof F)||this.pixels.length!==O)throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().");I.texImage2D(I.TEXTURE_2D,0,N.internalFormat,this.width*this.density,this.height*this.density,0,N.format,N.type,this.pixels),this.colorP5Texture.unbindTexture(),F=this.target._renderer.activeFramebuffer(),this.antialias?(this.begin(),this.target.push(),this.target.imageMode(this.target.CENTER),this.target.resetMatrix(),this.target.noStroke(),this.target.clear(),this.target.image(this,0,0),this.target.pop(),this.useDepth&&(I.clearDepth(1),I.clear(I.DEPTH_BUFFER_BIT)),this.end()):(I.bindFramebuffer(I.FRAMEBUFFER,this.framebuffer),this.useDepth&&(I.clearDepth(1),I.clear(I.DEPTH_BUFFER_BIT)),F?I.bindFramebuffer(I.FRAMEBUFFER,F._framebufferToBind()):I.bindFramebuffer(I.FRAMEBUFFER,null))}}]),A}()),P=c.default.Framebuffer=C;a.default=P},{"../core/constants":269,"../core/main":280,"./p5.RendererGL":337,"./p5.Texture":339,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.typed-array.uint8-clamped-array":240,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],332:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}function l(y){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.flat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.unscopables.flat"),r("core-js/modules/es.map"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.flat"),r("core-js/modules/es.array.for-each"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.unscopables.flat"),r("core-js/modules/es.map"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.set"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.sub"),r("core-js/modules/web.dom-collections.for-each"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(y){if(y&&y.__esModule)return y;if(y===null||l(y)!=="object"&&typeof y!="function")return{default:y};var g=f();if(g&&g.has(y))return g.get(y);var b,m={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in y){var x;Object.prototype.hasOwnProperty.call(y,b)&&((x=v?Object.getOwnPropertyDescriptor(y,b):null)&&(x.get||x.set)?Object.defineProperty(m,b,x):m[b]=y[b])}return m.default=y,g&&g.set(y,m),m}(r("../core/constants"));function f(){var y;return typeof WeakMap!="function"?null:(y=new WeakMap,f=function(){return y},y)}function h(y){return function(g){if(Array.isArray(g)){for(var b=0,m=new Array(g.length);b<g.length;b++)m[b]=g[b];return m}}(y)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(y,g){for(var b=0;b<g.length;b++){var m=g[b];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(y,m.key,m)}}c.default.Geometry=function(){function y(m,v,x){if(!(this instanceof y))throw new TypeError("Cannot call a class as a function");this.vertices=[],this.lineVertices=new c.default.DataArray,this.lineTangentsIn=new c.default.DataArray,this.lineTangentsOut=new c.default.DataArray,this.lineSides=new c.default.DataArray,this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.lineVertexColors=new c.default.DataArray,this.detailX=m!==void 0?m:1,this.detailY=v!==void 0?v:1,this.dirtyFlags={},this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,x instanceof Function&&x.call(this)}var g,b;return g=y,(b=[{key:"reset",value:function(){this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear(),this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.clear(),this.vertexNormals.length=0,this.uvs.length=0,this.dirtyFlags={}}},{key:"hasFillTransparency",value:function(){if(this._hasFillTransparency===void 0){this._hasFillTransparency=!1;for(var m=0;m<this.vertexColors.length;m+=4)if(this.vertexColors[m+3]<1){this._hasFillTransparency=!0;break}}return this._hasFillTransparency}},{key:"hasStrokeTransparency",value:function(){if(this._hasStrokeTransparency===void 0){this._hasStrokeTransparency=!1;for(var m=0;m<this.lineVertexColors.length;m+=4)if(this.lineVertexColors[m+3]<1){this._hasStrokeTransparency=!0;break}}return this._hasStrokeTransparency}},{key:"clearColors",value:function(){return this.vertexColors=[],this}},{key:"flipU",value:function(){this.uvs=this.uvs.flat().map(function(m,v){return v%2==0?1-m:m})}},{key:"flipV",value:function(){this.uvs=this.uvs.flat().map(function(m,v){return v%2==0?m:1-m})}},{key:"computeFaces",value:function(){this.faces.length=0;for(var m,v,x,w=this.detailX+1,S=0;S<this.detailY;S++)for(var k=0;k<this.detailX;k++)v=(S+1)*w+k+1,this.faces.push([S*w+k,m=S*w+k+1,x=(S+1)*w+k]),this.faces.push([x,m,v]);return this}},{key:"_getFaceNormal",value:function(v){var v=this.faces[v],x=this.vertices[v[0]],S=this.vertices[v[1]],v=this.vertices[v[2]],S=c.default.Vector.sub(S,x),v=c.default.Vector.sub(v,x),x=c.default.Vector.cross(S,v),w=c.default.Vector.mag(x),S=w/(c.default.Vector.mag(S)*c.default.Vector.mag(v));return S===0||isNaN(S)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),x):(1<S&&(S=1),x.mult(Math.asin(S)/w))}},{key:"computeNormals",value:function(){var m,v=this,x=0<arguments.length&&arguments[0]!==void 0?arguments[0]:u.FLAT,w=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).roundToPrecision,S=this.vertexNormals,k=this.vertices,_=this.faces;if(x===u.SMOOTH){for(var C={},P=[],A=Math.pow(10,w===void 0?3:w),I=function(G){return Math.round(G*A)/A},N=function(G){return"".concat(I(G.x),",").concat(I(G.y),",").concat(I(G.z))},O=0;O<k.length;O++){var F=k[O],U=N(F);C[U]===void 0&&(C[U]=P.length,P.push(F))}_.forEach(function(G){for(var Y=0;Y<3;++Y){var $=G[Y],$=k[$],$=N($);G[Y]=C[$]}}),this.edges.forEach(function(G){for(var Y=0;Y<2;++Y){var $=G[Y],$=k[$],$=N($);G[Y]=C[$]}}),this.vertices=k=P}for(m=S.length=0;m<k.length;++m)S.push(new c.default.Vector);for(_.forEach(function(G,Y){for(var $=v._getFaceNormal(Y),H=0;H<3;++H){var Q=G[H];S[Q].add($)}}),m=0;m<k.length;++m)S[m].normalize();return this}},{key:"averageNormals",value:function(){for(var m=0;m<=this.detailY;m++){var v=this.detailX+1,x=c.default.Vector.add(this.vertexNormals[m*v],this.vertexNormals[m*v+this.detailX]),x=c.default.Vector.div(x,2);this.vertexNormals[m*v]=x,this.vertexNormals[m*v+this.detailX]=x}return this}},{key:"averagePoleNormals",value:function(){for(var m=new c.default.Vector(0,0,0),v=0;v<this.detailX;v++)m.add(this.vertexNormals[v]);for(var m=c.default.Vector.div(m,this.detailX),x=0;x<this.detailX;x++)this.vertexNormals[x]=m;m=new c.default.Vector(0,0,0);for(var w=this.vertices.length-1;w>this.vertices.length-1-this.detailX;w--)m.add(this.vertexNormals[w]);m=c.default.Vector.div(m,this.detailX);for(var S=this.vertices.length-1;S>this.vertices.length-1-this.detailX;S--)this.vertexNormals[S]=m;return this}},{key:"_makeTriangleEdges",value:function(){for(var m=this.edges.length=0;m<this.faces.length;m++)this.edges.push([this.faces[m][0],this.faces[m][1]]),this.edges.push([this.faces[m][1],this.faces[m][2]]),this.edges.push([this.faces[m][2],this.faces[m][0]]);return this}},{key:"_edgesToVertices",value:function(){this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear();for(var m,v=new Map,x=new Set,w=0;w<this.edges.length;w++){var S,k=this.edges[w-1],_=this.edges[w],C=this.vertices[_[0]],P=this.vertices[_[1]],A=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*_[0],4*(_[0]+1)):[0,0,0,0],I=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*_[1],4*(_[1]+1)):[0,0,0,0],N=P.copy().sub(C).normalize(),O=0<N.magSq();O&&this._addSegment(C,P,A,I,N),0<w&&k[1]===_[0]?x.has(_[0])||(x.add(_[0]),v.delete(_[0]),m&&O&&N.dot(m)<1-1e-8&&this._addJoin(C,m,N,A)):(O&&!x.has(_[0])&&((S=v.get(_[0]))?(this._addJoin(C,S.dir,N,A),v.delete(_[0]),x.add(_[0])):v.set(_[0],{point:C,dir:N.copy().mult(-1),color:A})),m&&!x.has(k[1])&&((S=v.get(k[1]))?(this._addJoin(this.vertices[k[1]],m,S.dir.copy().mult(-1),A),v.delete(k[1]),x.add(k[1])):v.set(k[1],{point:this.vertices[k[1]],dir:m,color:A}),m=void 0)),w!==this.edges.length-1||x.has(_[1])||((C=v.get(_[1]))?(this._addJoin(P,N,C.dir.copy().mult(-1),I),v.delete(_[1]),x.add(_[1])):v.set(_[1],{point:P,dir:N,color:I})),O&&(m=N)}var F=!0,U=!1,G=void 0;try{for(var Y,$=v.values()[Symbol.iterator]();!(F=(Y=$.next()).done);F=!0){var H=Y.value,Q=H.point,J=H.dir,ae=H.color;this._addCap(Q,J,ae)}}catch(T){U=!0,G=T}finally{try{F||$.return==null||$.return()}finally{if(U)throw G}}return this}},{key:"_addSegment",value:function(k,_,x,w,S){var k=k.array(),_=_.array(),C=S.array();this.lineSides.push(1,1,-1,1,-1,-1);for(var P=0,A=[this.lineTangentsIn,this.lineTangentsOut];P<A.length;P++)for(var I=A[P],N=0;N<6;N++)I.push.apply(I,h(C));return(S=this.lineVertices).push.apply(S,h(k).concat(h(_),h(k),h(_),h(_),h(k))),(S=this.lineVertexColors).push.apply(S,h(x).concat(h(w),h(x),h(w),h(w),h(x))),this}},{key:"_addCap",value:function(m,v,x){for(var w,S=m.array(),k=v.array(),_=[0,0,0],C=0;C<6;C++)(w=this.lineVertices).push.apply(w,h(S)),(w=this.lineTangentsIn).push.apply(w,h(k)),(w=this.lineTangentsOut).push.apply(w,_),(w=this.lineVertexColors).push.apply(w,h(x));return this.lineSides.push(-1,2,-2,1,2,-1),this}},{key:"_addJoin",value:function(m,v,x,w){for(var S,k=m.array(),_=v.array(),C=x.array(),P=0;P<12;P++)(S=this.lineVertices).push.apply(S,h(k)),(S=this.lineTangentsIn).push.apply(S,h(_)),(S=this.lineTangentsOut).push.apply(S,h(C)),(S=this.lineVertexColors).push.apply(S,h(w));return this.lineSides.push(-1,-3,-2,-1,0,-3),this.lineSides.push(3,1,2,3,0,1),this}},{key:"normalize",value:function(){if(0<this.vertices.length){for(var m=this.vertices[0].copy(),v=this.vertices[0].copy(),x=0;x<this.vertices.length;x++)m.x=Math.max(m.x,this.vertices[x].x),v.x=Math.min(v.x,this.vertices[x].x),m.y=Math.max(m.y,this.vertices[x].y),v.y=Math.min(v.y,this.vertices[x].y),m.z=Math.max(m.z,this.vertices[x].z),v.z=Math.min(v.z,this.vertices[x].z);for(var w=c.default.Vector.lerp(m,v,.5),S=c.default.Vector.sub(m,v),k=200/Math.max(Math.max(S.x,S.y),S.z),_=0;_<this.vertices.length;_++)this.vertices[_].sub(w),this.vertices[_].mult(k)}return this}}])&&d(g.prototype,b),y}();var p=c.default.Geometry;a.default=p},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.flat":159,"core-js/modules/es.array.for-each":160,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.unscopables.flat":172,"core-js/modules/es.map":174,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.for-each":242,"core-js/modules/web.dom-collections.iterator":243}],333:[function(f,s,a){f("core-js/modules/es.array.iterator"),f("core-js/modules/es.object.to-string"),f("core-js/modules/es.typed-array.float32-array"),f("core-js/modules/es.typed-array.copy-within"),f("core-js/modules/es.typed-array.every"),f("core-js/modules/es.typed-array.fill"),f("core-js/modules/es.typed-array.filter"),f("core-js/modules/es.typed-array.find"),f("core-js/modules/es.typed-array.find-index"),f("core-js/modules/es.typed-array.for-each"),f("core-js/modules/es.typed-array.includes"),f("core-js/modules/es.typed-array.index-of"),f("core-js/modules/es.typed-array.iterator"),f("core-js/modules/es.typed-array.join"),f("core-js/modules/es.typed-array.last-index-of"),f("core-js/modules/es.typed-array.map"),f("core-js/modules/es.typed-array.reduce"),f("core-js/modules/es.typed-array.reduce-right"),f("core-js/modules/es.typed-array.reverse"),f("core-js/modules/es.typed-array.set"),f("core-js/modules/es.typed-array.slice"),f("core-js/modules/es.typed-array.some"),f("core-js/modules/es.typed-array.sort"),f("core-js/modules/es.typed-array.subarray"),f("core-js/modules/es.typed-array.to-locale-string"),f("core-js/modules/es.typed-array.to-string"),f("core-js/modules/es.array.iterator"),f("core-js/modules/es.object.to-string"),f("core-js/modules/es.typed-array.float32-array"),f("core-js/modules/es.typed-array.copy-within"),f("core-js/modules/es.typed-array.every"),f("core-js/modules/es.typed-array.fill"),f("core-js/modules/es.typed-array.filter"),f("core-js/modules/es.typed-array.find"),f("core-js/modules/es.typed-array.find-index"),f("core-js/modules/es.typed-array.for-each"),f("core-js/modules/es.typed-array.includes"),f("core-js/modules/es.typed-array.index-of"),f("core-js/modules/es.typed-array.iterator"),f("core-js/modules/es.typed-array.join"),f("core-js/modules/es.typed-array.last-index-of"),f("core-js/modules/es.typed-array.map"),f("core-js/modules/es.typed-array.reduce"),f("core-js/modules/es.typed-array.reduce-right"),f("core-js/modules/es.typed-array.reverse"),f("core-js/modules/es.typed-array.set"),f("core-js/modules/es.typed-array.slice"),f("core-js/modules/es.typed-array.some"),f("core-js/modules/es.typed-array.sort"),f("core-js/modules/es.typed-array.subarray"),f("core-js/modules/es.typed-array.to-locale-string"),f("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(f=f("../core/main"))&&f.__esModule?f:{default:f};function l(h,d){for(var p=0;p<d.length;p++){var y=d[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(h,y.key,y)}}var c=Array,u=function(h){return Array.isArray(h)},f=(typeof Float32Array<"u"&&(c=Float32Array,u=function(h){return Array.isArray(h)||h instanceof Float32Array}),i.default.Matrix=function(){function h(){var g=this,b=h;if(g instanceof b)return arguments.length&&((g=arguments.length-1)<0||arguments.length<=g?void 0:arguments[g])instanceof i.default&&(this.p5=(b=arguments.length-1)<0||arguments.length<=b?void 0:arguments[b]),(arguments.length<=0?void 0:arguments[0])==="mat3"?this.mat3=Array.isArray(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:new c([1,0,0,0,1,0,0,0,1]):this.mat4=Array.isArray(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:new c([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this;throw new TypeError("Cannot call a class as a function")}var d,p,y;return d=h,y=[{key:"identity",value:function(g){return new i.default.Matrix(g)}}],(p=[{key:"set",value:function(g){var b=arguments;if(g instanceof i.default.Matrix?b=g.mat4:u(g)&&(b=g),b.length!==16)i.default._friendlyError("Expected 16 values but received ".concat(b.length,"."),"p5.Matrix.set");else for(var m=0;m<16;m++)this.mat4[m]=b[m];return this}},{key:"get",value:function(){return new i.default.Matrix(this.mat4,this.p5)}},{key:"copy",value:function(){var g;return this.mat3!==void 0?((g=new i.default.Matrix("mat3",this.p5)).mat3[0]=this.mat3[0],g.mat3[1]=this.mat3[1],g.mat3[2]=this.mat3[2],g.mat3[3]=this.mat3[3],g.mat3[4]=this.mat3[4],g.mat3[5]=this.mat3[5],g.mat3[6]=this.mat3[6],g.mat3[7]=this.mat3[7],g.mat3[8]=this.mat3[8]):((g=new i.default.Matrix(this.p5)).mat4[0]=this.mat4[0],g.mat4[1]=this.mat4[1],g.mat4[2]=this.mat4[2],g.mat4[3]=this.mat4[3],g.mat4[4]=this.mat4[4],g.mat4[5]=this.mat4[5],g.mat4[6]=this.mat4[6],g.mat4[7]=this.mat4[7],g.mat4[8]=this.mat4[8],g.mat4[9]=this.mat4[9],g.mat4[10]=this.mat4[10],g.mat4[11]=this.mat4[11],g.mat4[12]=this.mat4[12],g.mat4[13]=this.mat4[13],g.mat4[14]=this.mat4[14],g.mat4[15]=this.mat4[15]),g}},{key:"transpose",value:function(g){var b,m,v,x,w,S;return g instanceof i.default.Matrix?(b=g.mat4[1],m=g.mat4[2],v=g.mat4[3],x=g.mat4[6],w=g.mat4[7],S=g.mat4[11],this.mat4[0]=g.mat4[0],this.mat4[1]=g.mat4[4],this.mat4[2]=g.mat4[8],this.mat4[3]=g.mat4[12],this.mat4[4]=b,this.mat4[5]=g.mat4[5],this.mat4[6]=g.mat4[9],this.mat4[7]=g.mat4[13],this.mat4[8]=m,this.mat4[9]=x,this.mat4[10]=g.mat4[10],this.mat4[11]=g.mat4[14],this.mat4[12]=v,this.mat4[13]=w,this.mat4[14]=S,this.mat4[15]=g.mat4[15]):u(g)&&(b=g[1],m=g[2],v=g[3],x=g[6],w=g[7],S=g[11],this.mat4[0]=g[0],this.mat4[1]=g[4],this.mat4[2]=g[8],this.mat4[3]=g[12],this.mat4[4]=b,this.mat4[5]=g[5],this.mat4[6]=g[9],this.mat4[7]=g[13],this.mat4[8]=m,this.mat4[9]=x,this.mat4[10]=g[10],this.mat4[11]=g[14],this.mat4[12]=v,this.mat4[13]=w,this.mat4[14]=S,this.mat4[15]=g[15]),this}},{key:"invert",value:function(G){G instanceof i.default.Matrix?(b=G.mat4[0],m=G.mat4[1],v=G.mat4[2],x=G.mat4[3],w=G.mat4[4],S=G.mat4[5],k=G.mat4[6],_=G.mat4[7],C=G.mat4[8],P=G.mat4[9],A=G.mat4[10],I=G.mat4[11],N=G.mat4[12],O=G.mat4[13],F=G.mat4[14],U=G.mat4[15]):u(G)&&(b=G[0],m=G[1],v=G[2],x=G[3],w=G[4],S=G[5],k=G[6],_=G[7],C=G[8],P=G[9],A=G[10],I=G[11],N=G[12],O=G[13],F=G[14],U=G[15]);var b,m,v,x,w,S,k,_,C,P,A,I,N,O,F,U,G=b*S-m*w,Y=b*k-v*w,$=b*_-x*w,H=m*k-v*S,Q=m*_-x*S,J=v*_-x*k,ae=C*O-P*N,T=C*F-A*N,B=C*U-I*N,W=P*F-A*O,K=P*U-I*O,te=A*U-I*F,ne=G*te-Y*K+$*W+H*B-Q*T+J*ae;return ne?(this.mat4[0]=(S*te-k*K+_*W)*(ne=1/ne),this.mat4[1]=(v*K-m*te-x*W)*ne,this.mat4[2]=(O*J-F*Q+U*H)*ne,this.mat4[3]=(A*Q-P*J-I*H)*ne,this.mat4[4]=(k*B-w*te-_*T)*ne,this.mat4[5]=(b*te-v*B+x*T)*ne,this.mat4[6]=(F*$-N*J-U*Y)*ne,this.mat4[7]=(C*J-A*$+I*Y)*ne,this.mat4[8]=(w*K-S*B+_*ae)*ne,this.mat4[9]=(m*B-b*K-x*ae)*ne,this.mat4[10]=(N*Q-O*$+U*G)*ne,this.mat4[11]=(P*$-C*Q-I*G)*ne,this.mat4[12]=(S*T-w*W-k*ae)*ne,this.mat4[13]=(b*W-m*T+v*ae)*ne,this.mat4[14]=(O*Y-N*H-F*G)*ne,this.mat4[15]=(C*H-P*Y+A*G)*ne,this):null}},{key:"invert3x3",value:function(){var g=this.mat3[0],b=this.mat3[1],m=this.mat3[2],v=this.mat3[3],x=this.mat3[4],w=this.mat3[5],S=this.mat3[6],k=this.mat3[7],_=this.mat3[8],C=_*x-w*k,P=-_*v+w*S,A=k*v-x*S,I=g*C+b*P+m*A;return I?(this.mat3[0]=C*(I=1/I),this.mat3[1]=(-_*b+m*k)*I,this.mat3[2]=(w*b-m*x)*I,this.mat3[3]=P*I,this.mat3[4]=(_*g-m*S)*I,this.mat3[5]=(-w*g+m*v)*I,this.mat3[6]=A*I,this.mat3[7]=(-k*g+b*S)*I,this.mat3[8]=(x*g-b*v)*I,this):null}},{key:"transpose3x3",value:function(g){var b=(g=g===void 0?this.mat3:g)[1],m=g[2],v=g[5];return this.mat3[0]=g[0],this.mat3[1]=g[3],this.mat3[2]=g[6],this.mat3[3]=b,this.mat3[4]=g[4],this.mat3[5]=g[7],this.mat3[6]=m,this.mat3[7]=v,this.mat3[8]=g[8],this}},{key:"inverseTranspose",value:function(g){if(g=g.mat4,this.mat3===void 0?i.default._friendlyError("sorry, this function only works with mat3"):(this.mat3[0]=g[0],this.mat3[1]=g[1],this.mat3[2]=g[2],this.mat3[3]=g[4],this.mat3[4]=g[5],this.mat3[5]=g[6],this.mat3[6]=g[8],this.mat3[7]=g[9],this.mat3[8]=g[10]),g=this.invert3x3(),g)g.transpose3x3(this.mat3);else for(var b=0;b<9;b++)this.mat3[b]=0;return this}},{key:"determinant",value:function(){var g=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],b=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],m=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],v=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],x=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],w=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],S=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],k=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],_=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],C=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],P=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return g*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-b*P+m*C+v*_-x*k+w*S}},{key:"mult",value:function(m){var b;if(m===this||m===this.mat4)b=this.copy().mat4;else if(m instanceof i.default.Matrix)b=m.mat4;else if(u(m))b=m;else{if(arguments.length!==16)return;b=arguments}var m=this.mat4[0],v=this.mat4[1],x=this.mat4[2],w=this.mat4[3];return this.mat4[0]=m*b[0]+v*b[4]+x*b[8]+w*b[12],this.mat4[1]=m*b[1]+v*b[5]+x*b[9]+w*b[13],this.mat4[2]=m*b[2]+v*b[6]+x*b[10]+w*b[14],this.mat4[3]=m*b[3]+v*b[7]+x*b[11]+w*b[15],m=this.mat4[4],v=this.mat4[5],x=this.mat4[6],w=this.mat4[7],this.mat4[4]=m*b[0]+v*b[4]+x*b[8]+w*b[12],this.mat4[5]=m*b[1]+v*b[5]+x*b[9]+w*b[13],this.mat4[6]=m*b[2]+v*b[6]+x*b[10]+w*b[14],this.mat4[7]=m*b[3]+v*b[7]+x*b[11]+w*b[15],m=this.mat4[8],v=this.mat4[9],x=this.mat4[10],w=this.mat4[11],this.mat4[8]=m*b[0]+v*b[4]+x*b[8]+w*b[12],this.mat4[9]=m*b[1]+v*b[5]+x*b[9]+w*b[13],this.mat4[10]=m*b[2]+v*b[6]+x*b[10]+w*b[14],this.mat4[11]=m*b[3]+v*b[7]+x*b[11]+w*b[15],m=this.mat4[12],v=this.mat4[13],x=this.mat4[14],w=this.mat4[15],this.mat4[12]=m*b[0]+v*b[4]+x*b[8]+w*b[12],this.mat4[13]=m*b[1]+v*b[5]+x*b[9]+w*b[13],this.mat4[14]=m*b[2]+v*b[6]+x*b[10]+w*b[14],this.mat4[15]=m*b[3]+v*b[7]+x*b[11]+w*b[15],this}},{key:"apply",value:function(m){var b;if(m===this||m===this.mat4)b=this.copy().mat4;else if(m instanceof i.default.Matrix)b=m.mat4;else if(u(m))b=m;else{if(arguments.length!==16)return;b=arguments}var m=this.mat4,v=m[0],x=m[4],w=m[8],S=m[12],v=(m[0]=b[0]*v+b[1]*x+b[2]*w+b[3]*S,m[4]=b[4]*v+b[5]*x+b[6]*w+b[7]*S,m[8]=b[8]*v+b[9]*x+b[10]*w+b[11]*S,m[12]=b[12]*v+b[13]*x+b[14]*w+b[15]*S,m[1]),x=m[5],w=m[9],S=m[13],v=(m[1]=b[0]*v+b[1]*x+b[2]*w+b[3]*S,m[5]=b[4]*v+b[5]*x+b[6]*w+b[7]*S,m[9]=b[8]*v+b[9]*x+b[10]*w+b[11]*S,m[13]=b[12]*v+b[13]*x+b[14]*w+b[15]*S,m[2]),x=m[6],w=m[10],S=m[14],v=(m[2]=b[0]*v+b[1]*x+b[2]*w+b[3]*S,m[6]=b[4]*v+b[5]*x+b[6]*w+b[7]*S,m[10]=b[8]*v+b[9]*x+b[10]*w+b[11]*S,m[14]=b[12]*v+b[13]*x+b[14]*w+b[15]*S,m[3]),x=m[7],w=m[11],S=m[15];return m[3]=b[0]*v+b[1]*x+b[2]*w+b[3]*S,m[7]=b[4]*v+b[5]*x+b[6]*w+b[7]*S,m[11]=b[8]*v+b[9]*x+b[10]*w+b[11]*S,m[15]=b[12]*v+b[13]*x+b[14]*w+b[15]*S,this}},{key:"scale",value:function(g,b,m){return g instanceof i.default.Vector?(b=g.y,m=g.z,g=g.x):g instanceof Array&&(b=g[1],m=g[2],g=g[0]),this.mat4[0]*=g,this.mat4[1]*=g,this.mat4[2]*=g,this.mat4[3]*=g,this.mat4[4]*=b,this.mat4[5]*=b,this.mat4[6]*=b,this.mat4[7]*=b,this.mat4[8]*=m,this.mat4[9]*=m,this.mat4[10]*=m,this.mat4[11]*=m,this}},{key:"rotate",value:function(G,K,W,v){K instanceof i.default.Vector?(W=K.y,v=K.z,K=K.x):K instanceof Array&&(W=K[1],v=K[2],K=K[0]);var x=Math.sqrt(K*K+W*W+v*v),x=(K*=1/x,W*=1/x,v*=1/x,this.mat4[0]),w=this.mat4[1],S=this.mat4[2],k=this.mat4[3],_=this.mat4[4],C=this.mat4[5],P=this.mat4[6],A=this.mat4[7],I=this.mat4[8],N=this.mat4[9],O=this.mat4[10],F=this.mat4[11],U=Math.sin(G),G=Math.cos(G),Y=1-G,$=K*K*Y+G,H=W*K*Y+v*U,Q=v*K*Y-W*U,J=K*W*Y-v*U,ae=W*W*Y+G,T=v*W*Y+K*U,B=K*v*Y+W*U,W=W*v*Y-K*U,K=v*v*Y+G;return this.mat4[0]=x*$+_*H+I*Q,this.mat4[1]=w*$+C*H+N*Q,this.mat4[2]=S*$+P*H+O*Q,this.mat4[3]=k*$+A*H+F*Q,this.mat4[4]=x*J+_*ae+I*T,this.mat4[5]=w*J+C*ae+N*T,this.mat4[6]=S*J+P*ae+O*T,this.mat4[7]=k*J+A*ae+F*T,this.mat4[8]=x*B+_*W+I*K,this.mat4[9]=w*B+C*W+N*K,this.mat4[10]=S*B+P*W+O*K,this.mat4[11]=k*B+A*W+F*K,this}},{key:"translate",value:function(v){var b=v[0],m=v[1],v=v[2]||0;this.mat4[12]+=this.mat4[0]*b+this.mat4[4]*m+this.mat4[8]*v,this.mat4[13]+=this.mat4[1]*b+this.mat4[5]*m+this.mat4[9]*v,this.mat4[14]+=this.mat4[2]*b+this.mat4[6]*m+this.mat4[10]*v,this.mat4[15]+=this.mat4[3]*b+this.mat4[7]*m+this.mat4[11]*v}},{key:"rotateX",value:function(g){this.rotate(g,1,0,0)}},{key:"rotateY",value:function(g){this.rotate(g,0,1,0)}},{key:"rotateZ",value:function(g){this.rotate(g,0,0,1)}},{key:"perspective",value:function(x,b,m,v){var x=1/Math.tan(x/2),w=1/(m-v);return this.mat4[0]=x/b,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=x,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(v+m)*w,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*v*m*w,this.mat4[15]=0,this}},{key:"ortho",value:function(g,b,m,v,x,w){var S=1/(g-b),k=1/(m-v),_=1/(x-w);return this.mat4[0]=-2*S,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*k,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*_,this.mat4[11]=0,this.mat4[12]=(g+b)*S,this.mat4[13]=(v+m)*k,this.mat4[14]=(w+x)*_,this.mat4[15]=1,this}},{key:"multiplyVec4",value:function(g,b,m,v){var x=new Array(4),w=this.mat4;return x[0]=w[0]*g+w[4]*b+w[8]*m+w[12]*v,x[1]=w[1]*g+w[5]*b+w[9]*m+w[13]*v,x[2]=w[2]*g+w[6]*b+w[10]*m+w[14]*v,x[3]=w[3]*g+w[7]*b+w[11]*m+w[15]*v,x}},{key:"multiplyPoint",value:function(m){var v=m.x,b=m.y,m=m.z,v=this.multiplyVec4(v,b,m,1);return new i.default.Vector(v[0],v[1],v[2])}},{key:"multiplyAndNormalizePoint",value:function(m){var v=m.x,b=m.y,m=m.z,v=this.multiplyVec4(v,b,m,1);return v[0]/=v[3],v[1]/=v[3],v[2]/=v[3],new i.default.Vector(v[0],v[1],v[2])}},{key:"multiplyDirection",value:function(m){var v=m.x,b=m.y,m=m.z,v=this.multiplyVec4(v,b,m,0);return new i.default.Vector(v[0],v[1],v[2])}},{key:"mult3x3",value:function(m){var b;if(m===this||m===this.mat3)b=this.copy().mat3;else if(m instanceof i.default.Matrix)b=m.mat3;else if(u(m))b=m;else{if(arguments.length!==9)return;b=arguments}var m=this.mat3[0],v=this.mat3[1],x=this.mat3[2];return this.mat3[0]=m*b[0]+v*b[3]+x*b[6],this.mat3[1]=m*b[1]+v*b[4]+x*b[7],this.mat3[2]=m*b[2]+v*b[5]+x*b[8],m=this.mat3[3],v=this.mat3[4],x=this.mat3[5],this.mat3[3]=m*b[0]+v*b[3]+x*b[6],this.mat3[4]=m*b[1]+v*b[4]+x*b[7],this.mat3[5]=m*b[2]+v*b[5]+x*b[8],m=this.mat3[6],v=this.mat3[7],x=this.mat3[8],this.mat3[6]=m*b[0]+v*b[3]+x*b[6],this.mat3[7]=m*b[1]+v*b[4]+x*b[7],this.mat3[8]=m*b[2]+v*b[5]+x*b[8],this}},{key:"column",value:function(g){return new i.default.Vector(this.mat3[3*g],this.mat3[3*g+1],this.mat3[3*g+2])}},{key:"row",value:function(g){return new i.default.Vector(this.mat3[g],this.mat3[g+3],this.mat3[g+6])}},{key:"diagonal",value:function(){return this.mat3!==void 0?[this.mat3[0],this.mat3[4],this.mat3[8]]:[this.mat4[0],this.mat4[5],this.mat4[10],this.mat4[15]]}},{key:"multiplyVec3",value:function(g,b){return(b=b===void 0?g.copy():b).x=this.row(0).dot(g),b.y=this.row(1).dot(g),b.z=this.row(2).dot(g),b}},{key:"createSubMatrix3x3",value:function(){var g=new i.default.Matrix("mat3");return g.mat3[0]=this.mat4[0],g.mat3[1]=this.mat4[1],g.mat3[2]=this.mat4[2],g.mat3[3]=this.mat4[4],g.mat3[4]=this.mat4[5],g.mat3[5]=this.mat4[6],g.mat3[6]=this.mat4[8],g.mat3[7]=this.mat4[9],g.mat3[8]=this.mat4[10],g}}])&&l(d.prototype,p),y&&l(d,y),h}(),i.default.Matrix);a.default=f},{"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.to-string":187,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236}],334:[function(r,s,a){r("core-js/modules/es.array.map"),r("core-js/modules/es.array.map"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,r=(r=r("../core/main"))&&r.__esModule?r:{default:r};function i(l,c){for(var u=0;u<c.length;u++){var f=c[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(l,f.key,f)}}r.default.RenderBuffer=function(){function l(f,h,d,p,y,g){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");this.size=f,this.src=h,this.dst=d,this.attr=p,this._renderer=y,this.map=g}var c,u;return c=l,(u=[{key:"_prepareBuffer",value:function(f,h){var d,p,y,m=h.attributes,g=this._renderer.GL,b=f.model||f,m=m[this.attr];m&&(d=f[this.dst],0<(p=b[this.src]).length?((y=!d)&&(f[this.dst]=d=g.createBuffer()),g.bindBuffer(g.ARRAY_BUFFER,d),!y&&b.dirtyFlags[this.src]===!1||(y=(f=this.map)?f(p):p,this._renderer._bindBuffer(d,g.ARRAY_BUFFER,y),b.dirtyFlags[this.src]=!1),h.enableAttrib(m,this.size)):(f=m.location)!==-1&&this._renderer.registerEnabled.has(f)&&(g.disableVertexAttribArray(f),this._renderer.registerEnabled.delete(f)))}}])&&i(c.prototype,u),l}(),r=r.default.RenderBuffer,a.default=r},{"../core/main":280,"core-js/modules/es.array.map":167}],335:[function(r,s,a){function i(y){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}function l(y){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(g){return i(g)}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":i(g)})(y)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.from"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.map"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.concat"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.map"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.map"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(p=r("../core/main"))&&p.__esModule?p:{default:p},u=function(y){if(y&&y.__esModule)return y;if(y===null||l(y)!=="object"&&typeof y!="function")return{default:y};var g=f();if(g&&g.has(y))return g.get(y);var b,m={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(b in y){var x;Object.prototype.hasOwnProperty.call(y,b)&&((x=v?Object.getOwnPropertyDescriptor(y,b):null)&&(x.get||x.set)?Object.defineProperty(m,b,x):m[b]=y[b])}return m.default=y,g&&g.set(y,m),m}(r("../core/constants"));function f(){var y;return typeof WeakMap!="function"?null:(y=new WeakMap,f=function(){return y},y)}function h(y){return function(g){if(Array.isArray(g)){for(var b=0,m=new Array(g.length);b<g.length;b++)m[b]=g[b];return m}}(y)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r("./p5.RenderBuffer"),c.default.RendererGL.prototype.beginShape=function(y){return this.immediateMode.shapeMode=y!==void 0?y:u.TESS,this.immediateMode.geometry.reset(),this.immediateMode.contourIndices=[],this};var d={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},p=(c.default.RendererGL.prototype.beginContour=function(){if(this.immediateMode.shapeMode!==u.TESS)throw new Error("WebGL mode can only use contours with beginShape(TESS).");this.immediateMode.contourIndices.push(this.immediateMode.geometry.vertices.length)},c.default.RendererGL.prototype.vertex=function(y,g){if(this.immediateMode.shapeMode===u.QUADS&&this.immediateMode.geometry.vertices.length%6==3)for(var b in d){var m=d[b],b=this.immediateMode.geometry[b];b.push.apply(b,h(b.slice(b.length-3*m,b.length-2*m)).concat(h(b.slice(b.length-m,b.length))))}var v,x,w=v=x=0,S=(arguments.length===3?w=arguments[2]:arguments.length===4?(v=arguments[2],x=arguments[3]):arguments.length===5&&(w=arguments[2],v=arguments[3],x=arguments[4]),new c.default.Vector(y,g,w)),S=(this.immediateMode.geometry.vertices.push(S),this.immediateMode.geometry.vertexNormals.push(this._currentNormal),this.curFillColor||[.5,.5,.5,1]),S=(this.immediateMode.geometry.vertexColors.push(S[0],S[1],S[2],S[3]),this.curStrokeColor||[.5,.5,.5,1]);return this.immediateMode.geometry.vertexStrokeColors.push(S[0],S[1],S[2],S[3]),this.textureMode!==u.IMAGE||this.isProcessingVertices||(this._tex!==null?0<this._tex.width&&0<this._tex.height&&(v/=this._tex.width,x/=this._tex.height):this.userFillShader===void 0&&this.userStrokeShader===void 0&&this.userPointShader===void 0&&this._tex===null&&4<=arguments.length&&console.warn("You must first call texture() before using vertex() with image based u and v coordinates")),this.immediateMode.geometry.uvs.push(v,x),this.immediateMode._bezierVertex[0]=y,this.immediateMode._bezierVertex[1]=g,this.immediateMode._bezierVertex[2]=w,this.immediateMode._quadraticVertex[0]=y,this.immediateMode._quadraticVertex[1]=g,this.immediateMode._quadraticVertex[2]=w,this},c.default.RendererGL.prototype.normal=function(y,g,b){return y instanceof c.default.Vector?this._currentNormal=y:this._currentNormal=new c.default.Vector(y,g,b),this},c.default.RendererGL.prototype.endShape=function(y,g,b,m,v,x){var w=6<arguments.length&&arguments[6]!==void 0?arguments[6]:1;return this.immediateMode.shapeMode===u.POINTS?this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point):(this.immediateMode.geometry.vertices.length===3&&this.immediateMode.shapeMode===u.TESS&&(this.immediateMode.shapeMode,u.TRIANGLES),this.isProcessingVertices=!0,this._processVertices.apply(this,arguments),this.isProcessingVertices=!1,this.immediateMode.shapeMode!==u.LINE_STRIP&&this.immediateMode.shapeMode!==u.LINES||(this.immediateMode.shapeMode=u.TRIANGLE_FAN),this.immediateMode.shapeMode===u.QUADS?this.immediateMode.shapeMode=u.TRIANGLES:this.immediateMode.shapeMode===u.QUAD_STRIP&&(this.immediateMode.shapeMode=u.TRIANGLE_STRIP),this._doFill&&!this.geometryBuilder&&3<=this.immediateMode.geometry.vertices.length&&this._drawImmediateFill(w),this._doStroke&&!this.geometryBuilder&&1<=this.immediateMode.geometry.lineVertices.length&&this._drawImmediateStroke(),this.geometryBuilder&&this.geometryBuilder.addImmediate(),this.isBezier=!1,this.isQuadratic=!1,this.isCurve=!1,this.immediateMode._bezierVertex.length=0,this.immediateMode._quadraticVertex.length=0,this.immediateMode._curveVertex.length=0),this},c.default.RendererGL.prototype._processVertices=function(y){var g;this.immediateMode.geometry.vertices.length!==0&&(g=this._doStroke,y=y===u.CLOSE,g&&(this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,y),this.geometryBuilder||this.immediateMode.geometry._edgesToVertices()),g=this.immediateMode.shapeMode===u.TESS,y=0<this.immediateMode.contourIndices.length,this._doFill&&(this.isBezier||this.isQuadratic||this.isCurve||g||y)&&this.immediateMode.shapeMode!==u.LINES&&this._tesselateShape())},c.default.RendererGL.prototype._calculateEdges=function(y,g,b){var m=[],v=0,x=this.immediateMode.contourIndices.slice(),w=0;switch(y){case u.TRIANGLE_STRIP:for(v=0;v<g.length-2;v++)m.push([v,v+1]),m.push([v,v+2]);m.push([v,v+1]);break;case u.TRIANGLE_FAN:for(v=1;v<g.length-1;v++)m.push([0,v]),m.push([v,v+1]);m.push([0,g.length-1]);break;case u.TRIANGLES:for(v=0;v<g.length-2;v+=3)m.push([v,v+1]),m.push([v+1,v+2]),m.push([v+2,v]);break;case u.LINES:for(v=0;v<g.length-1;v+=2)m.push([v,v+1]);break;case u.QUADS:for(v=0;v<g.length-5;v+=6)m.push([v,v+1]),m.push([v+1,v+2]),m.push([v+3,v+5]),m.push([v+4,v+5]);break;case u.QUAD_STRIP:for(v=0;v<g.length-2;v+=2)m.push([v,v+1]),m.push([v,v+2]),m.push([v+1,v+3]);m.push([v,v+1]);break;default:for(v=0;v<g.length;v++)v+1<g.length&&v+1!==x[0]?m.push([v,v+1]):((b||w)&&m.push([v,w]),0<x.length&&(w=x.shift()))}return y!==u.TESS&&b&&m.push([g.length-1,0]),m},c.default.RendererGL.prototype._tesselateShape=function(){for(var y=this,g=(this.immediateMode.shapeMode=u.TRIANGLES,[[]]),b=0;b<this.immediateMode.geometry.vertices.length;b++)0<this.immediateMode.contourIndices.length&&this.immediateMode.contourIndices[0]===b&&(this.immediateMode.contourIndices.shift(),g.push([])),g[g.length-1].push(this.immediateMode.geometry.vertices[b].x,this.immediateMode.geometry.vertices[b].y,this.immediateMode.geometry.vertices[b].z,this.immediateMode.geometry.uvs[2*b],this.immediateMode.geometry.uvs[2*b+1],this.immediateMode.geometry.vertexColors[4*b],this.immediateMode.geometry.vertexColors[4*b+1],this.immediateMode.geometry.vertexColors[4*b+2],this.immediateMode.geometry.vertexColors[4*b+3],this.immediateMode.geometry.vertexNormals[b].x,this.immediateMode.geometry.vertexNormals[b].y,this.immediateMode.geometry.vertexNormals[b].z);for(var m,v=this._triangulate(g),x=this.immediateMode.geometry.vertices,w=(this.immediateMode.geometry.vertices=[],this.immediateMode.geometry.vertexNormals=[],this.immediateMode.geometry.uvs=[],[]),S=0,k=v.length;S<k;S+=c.default.RendererGL.prototype.tessyVertexSize)w.push.apply(w,h(v.slice(S+5,S+9))),this.normal.apply(this,h(v.slice(S+9,S+12))),this.vertex.apply(this,h(v.slice(S,S+5)));this.geometryBuilder&&(m=new Map,this.immediateMode.geometry.edges=this.immediateMode.geometry.edges.map(function(_){return _.map(function(C){if(!m.has(C)){var P=x[C],A=y.immediateMode.geometry.vertices.findIndex(function(Y){return P.x===Y.x&&P.y===Y.y&&P.z===Y.z});if(A===-1){for(var I=1/0,N=0,O=0;O<y.immediateMode.geometry.vertices.length;O++){var U=y.immediateMode.geometry.vertices[O],G=P.x-U.x,F=P.y-U.y,U=P.z-U.z,G=G*G+F*F+U*U;G<I&&(I=G,N=O)}A=N}m.set(C,A)}return m.get(C)})})),this.immediateMode.geometry.vertexColors=w},c.default.RendererGL.prototype._drawImmediateFill=function(){var y,g=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1,b=this.GL,m=(this._useVertexColor=0<this.immediateMode.geometry.vertexColors.length,y=this._getImmediateFillShader(),this._setFillUniforms(y),!0),v=!1,x=void 0;try{for(var w,S=this.immediateMode.buffers.fill[Symbol.iterator]();!(m=(w=S.next()).done);m=!0)w.value._prepareBuffer(this.immediateMode.geometry,y)}catch(k){v=!0,x=k}finally{try{m||S.return==null||S.return()}finally{if(v)throw x}}if(y.disableRemainingAttributes(),this._applyColorBlend(this.curFillColor,this.immediateMode.geometry.hasFillTransparency()),g===1)b.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length);else try{b.drawArraysInstanced(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length,g)}catch{console.log("\u{1F338} p5.js says: Instancing is only supported in WebGL2 mode")}y.unbindShader()},c.default.RendererGL.prototype._drawImmediateStroke=function(){var y=this.GL,g=(this._useLineColor=0<this.immediateMode.geometry.vertexStrokeColors.length,this._getImmediateStrokeShader()),b=(this._setStrokeUniforms(g),!0),m=!1,v=void 0;try{for(var x,w=this.immediateMode.buffers.stroke[Symbol.iterator]();!(b=(x=w.next()).done);b=!0)x.value._prepareBuffer(this.immediateMode.geometry,g)}catch(S){m=!0,v=S}finally{try{b||w.return==null||w.return()}finally{if(m)throw v}}g.disableRemainingAttributes(),this._applyColorBlend(this.curStrokeColor,this.immediateMode.geometry.hasFillTransparency()),y.drawArrays(y.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length/3),g.unbindShader()},c.default.RendererGL);a.default=p},{"../core/constants":269,"../core/main":280,"./p5.RenderBuffer":334,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.find-index":157,"core-js/modules/es.array.from":161,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.map":174,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],336:[function(r,s,a){function i(d){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(d)}function l(d){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(p){return i(p)}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":i(p)})(d)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.some"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.uint16-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.fill"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.some"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.float32-array"),r("core-js/modules/es.typed-array.uint16-array"),r("core-js/modules/es.typed-array.uint32-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=(h=r("../core/main"))&&h.__esModule?h:{default:h},u=(r("./p5.RendererGL"),r("./p5.RenderBuffer"),function(d){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var p=f();if(p&&p.has(d))return p.get(d);var y,g={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(y in d){var m;Object.prototype.hasOwnProperty.call(d,y)&&((m=b?Object.getOwnPropertyDescriptor(d,y):null)&&(m.get||m.set)?Object.defineProperty(g,y,m):g[y]=d[y])}return g.default=d,p&&p.set(d,g),g}(r("../core/constants")));function f(){var d;return typeof WeakMap!="function"?null:(d=new WeakMap,f=function(){return d},d)}c.default.RendererGL.prototype.freeGeometry=function(d){d.gid?this._freeBuffers(d.gid):console.warn("The model you passed to freeGeometry does not have an id!")},c.default.RendererGL.prototype._initBufferDefaults=function(d){var p;return this._freeBuffers(d),1e3<Object.keys(this.retainedMode.geometry).length&&(p=Object.keys(this.retainedMode.geometry)[0],this._freeBuffers(p)),this.retainedMode.geometry[d]={}},c.default.RendererGL.prototype._freeBuffers=function(d){var p,y=this.retainedMode.geometry[d];function g(b){var m=!0,v=!1,x=void 0;try{for(var w,S=b[Symbol.iterator]();!(m=(w=S.next()).done);m=!0){var k=w.value;y[k.dst]&&(p.deleteBuffer(y[k.dst]),y[k.dst]=null)}}catch(_){v=!0,x=_}finally{try{m||S.return==null||S.return()}finally{if(v)throw x}}}y&&(delete this.retainedMode.geometry[d],p=this.GL,y.indexBuffer&&p.deleteBuffer(y.indexBuffer),g(this.retainedMode.buffers.stroke),g(this.retainedMode.buffers.fill))},c.default.RendererGL.prototype.createBuffers=function(v,p){var y,g,b,m=this.GL,v=this._initBufferDefaults(v),x=(v.model=p,v.indexBuffer);return p.faces.length?(x=x||(v.indexBuffer=m.createBuffer()),b=(g=(y=c.default.RendererGL.prototype._flatten(p.faces)).some(function(w){return 65535<w}))?Uint32Array:Uint16Array,this._bindBuffer(x,m.ELEMENT_ARRAY_BUFFER,y,b),v.indexBufferType=g?m.UNSIGNED_INT:m.UNSIGNED_SHORT,v.vertexCount=3*p.faces.length):(x&&(m.deleteBuffer(x),v.indexBuffer=null),v.vertexCount=p.vertices?p.vertices.length:0),v.lineVertexCount=p.lineVertices?p.lineVertices.length/3:0,v},c.default.RendererGL.prototype.drawBuffers=function(d){var p=this.GL,y=this.retainedMode.geometry[d];if(!this.geometryBuilder&&this._doFill&&0<this.retainedMode.geometry[d].vertexCount){this._useVertexColor=0<y.model.vertexColors.length;var g=this._getRetainedFillShader(),b=(this._setFillUniforms(g),!0),m=!1,v=void 0;try{for(var x,w=this.retainedMode.buffers.fill[Symbol.iterator]();!(b=(x=w.next()).done);b=!0)x.value._prepareBuffer(y,g)}catch(P){m=!0,v=P}finally{try{b||w.return==null||w.return()}finally{if(m)throw v}}g.disableRemainingAttributes(),y.indexBuffer&&this._bindBuffer(y.indexBuffer,p.ELEMENT_ARRAY_BUFFER),this._applyColorBlend(this.curFillColor,y.model.hasFillTransparency()),this._drawElements(p.TRIANGLES,d),g.unbindShader()}if(!this.geometryBuilder&&this._doStroke&&0<y.lineVertexCount){this._useLineColor=0<y.model.vertexStrokeColors.length;var S=this._getRetainedStrokeShader(),k=(this._setStrokeUniforms(S),!0),m=!1,v=void 0;try{for(var _,C=this.retainedMode.buffers.stroke[Symbol.iterator]();!(k=(_=C.next()).done);k=!0)_.value._prepareBuffer(y,S)}catch(I){m=!0,v=I}finally{try{k||C.return==null||C.return()}finally{if(m)throw v}}S.disableRemainingAttributes(),this._applyColorBlend(this.curStrokeColor,y.model.hasStrokeTransparency()),this._drawArrays(p.TRIANGLES,d),S.unbindShader()}return this.geometryBuilder&&this.geometryBuilder.addRetained(y),this},c.default.RendererGL.prototype.drawBuffersScaled=function(d,p,y,g){var b=this.uMVMatrix.copy();try{this.uMVMatrix.scale(p,y,g),this.drawBuffers(d)}finally{this.uMVMatrix=b}},c.default.RendererGL.prototype._drawArrays=function(d,p){return this.GL.drawArrays(d,0,this.retainedMode.geometry[p].lineVertexCount),this},c.default.RendererGL.prototype._drawElements=function(d,y){var y=this.retainedMode.geometry[y],g=this.GL;if(y.indexBuffer){if(this._pInst.webglVersion!==u.WEBGL2&&y.indexBufferType===g.UNSIGNED_INT&&!g.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");g.drawElements(g.TRIANGLES,y.vertexCount,y.indexBufferType,0)}else g.drawArrays(d||g.TRIANGLES,0,y.vertexCount)},c.default.RendererGL.prototype._drawPoints=function(d,p){var y=this.GL,g=this._getImmediatePointShader();this._setPointUniforms(g),this._bindBuffer(p,y.ARRAY_BUFFER,this._vToNArray(d),Float32Array,y.STATIC_DRAW),g.enableAttrib(g.attributes.aPosition,3),this._applyColorBlend(this.curStrokeColor),y.drawArrays(y.Points,0,d.length),g.unbindShader()};var h=c.default.RendererGL;a.default=h},{"../core/constants":269,"../core/main":280,"./p5.RenderBuffer":334,"./p5.RendererGL":337,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.some":169,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint16-array":237,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],337:[function(O,s,a){function i(H){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q})(H)}function l(H){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(Q){return i(Q)}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":i(Q)})(H)}O("core-js/modules/es.symbol"),O("core-js/modules/es.symbol.description"),O("core-js/modules/es.symbol.iterator"),O("core-js/modules/es.array.concat"),O("core-js/modules/es.array.copy-within"),O("core-js/modules/es.array.every"),O("core-js/modules/es.array.fill"),O("core-js/modules/es.array.flat"),O("core-js/modules/es.array.flat-map"),O("core-js/modules/es.array.from"),O("core-js/modules/es.array.includes"),O("core-js/modules/es.array.iterator"),O("core-js/modules/es.array.map"),O("core-js/modules/es.array.slice"),O("core-js/modules/es.array.some"),O("core-js/modules/es.array.unscopables.flat"),O("core-js/modules/es.array.unscopables.flat-map"),O("core-js/modules/es.map"),O("core-js/modules/es.object.assign"),O("core-js/modules/es.object.get-own-property-descriptor"),O("core-js/modules/es.object.get-prototype-of"),O("core-js/modules/es.object.to-string"),O("core-js/modules/es.reflect.construct"),O("core-js/modules/es.reflect.get"),O("core-js/modules/es.regexp.to-string"),O("core-js/modules/es.set"),O("core-js/modules/es.string.includes"),O("core-js/modules/es.string.iterator"),O("core-js/modules/es.typed-array.float32-array"),O("core-js/modules/es.typed-array.float64-array"),O("core-js/modules/es.typed-array.int16-array"),O("core-js/modules/es.typed-array.uint8-array"),O("core-js/modules/es.typed-array.uint16-array"),O("core-js/modules/es.typed-array.uint32-array"),O("core-js/modules/es.typed-array.copy-within"),O("core-js/modules/es.typed-array.every"),O("core-js/modules/es.typed-array.fill"),O("core-js/modules/es.typed-array.filter"),O("core-js/modules/es.typed-array.find"),O("core-js/modules/es.typed-array.find-index"),O("core-js/modules/es.typed-array.for-each"),O("core-js/modules/es.typed-array.includes"),O("core-js/modules/es.typed-array.index-of"),O("core-js/modules/es.typed-array.iterator"),O("core-js/modules/es.typed-array.join"),O("core-js/modules/es.typed-array.last-index-of"),O("core-js/modules/es.typed-array.map"),O("core-js/modules/es.typed-array.reduce"),O("core-js/modules/es.typed-array.reduce-right"),O("core-js/modules/es.typed-array.reverse"),O("core-js/modules/es.typed-array.set"),O("core-js/modules/es.typed-array.slice"),O("core-js/modules/es.typed-array.some"),O("core-js/modules/es.typed-array.sort"),O("core-js/modules/es.typed-array.subarray"),O("core-js/modules/es.typed-array.to-locale-string"),O("core-js/modules/es.typed-array.to-string"),O("core-js/modules/es.weak-map"),O("core-js/modules/web.dom-collections.iterator"),O("core-js/modules/es.symbol"),O("core-js/modules/es.symbol.description"),O("core-js/modules/es.symbol.iterator"),O("core-js/modules/es.array.concat"),O("core-js/modules/es.array.copy-within"),O("core-js/modules/es.array.every"),O("core-js/modules/es.array.fill"),O("core-js/modules/es.array.flat"),O("core-js/modules/es.array.flat-map"),O("core-js/modules/es.array.from"),O("core-js/modules/es.array.includes"),O("core-js/modules/es.array.iterator"),O("core-js/modules/es.array.map"),O("core-js/modules/es.array.slice"),O("core-js/modules/es.array.some"),O("core-js/modules/es.array.unscopables.flat"),O("core-js/modules/es.array.unscopables.flat-map"),O("core-js/modules/es.map"),O("core-js/modules/es.object.assign"),O("core-js/modules/es.object.to-string"),O("core-js/modules/es.set"),O("core-js/modules/es.string.includes"),O("core-js/modules/es.string.iterator"),O("core-js/modules/es.typed-array.float32-array"),O("core-js/modules/es.typed-array.float64-array"),O("core-js/modules/es.typed-array.int16-array"),O("core-js/modules/es.typed-array.uint8-array"),O("core-js/modules/es.typed-array.uint16-array"),O("core-js/modules/es.typed-array.uint32-array"),O("core-js/modules/es.typed-array.copy-within"),O("core-js/modules/es.typed-array.every"),O("core-js/modules/es.typed-array.fill"),O("core-js/modules/es.typed-array.filter"),O("core-js/modules/es.typed-array.find"),O("core-js/modules/es.typed-array.find-index"),O("core-js/modules/es.typed-array.for-each"),O("core-js/modules/es.typed-array.includes"),O("core-js/modules/es.typed-array.index-of"),O("core-js/modules/es.typed-array.iterator"),O("core-js/modules/es.typed-array.join"),O("core-js/modules/es.typed-array.last-index-of"),O("core-js/modules/es.typed-array.map"),O("core-js/modules/es.typed-array.reduce"),O("core-js/modules/es.typed-array.reduce-right"),O("core-js/modules/es.typed-array.reverse"),O("core-js/modules/es.typed-array.set"),O("core-js/modules/es.typed-array.slice"),O("core-js/modules/es.typed-array.some"),O("core-js/modules/es.typed-array.sort"),O("core-js/modules/es.typed-array.subarray"),O("core-js/modules/es.typed-array.to-locale-string"),O("core-js/modules/es.typed-array.to-string"),O("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.readPixelsWebGL=Y,a.readPixelWebGL=$,a.default=void 0;var c=y(O("../core/main")),u=function(H){if(H&&H.__esModule)return H;if(H===null||l(H)!=="object"&&typeof H!="function")return{default:H};var Q=p();if(Q&&Q.has(H))return Q.get(H);var J,ae={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(J in H){var B;Object.prototype.hasOwnProperty.call(H,J)&&((B=T?Object.getOwnPropertyDescriptor(H,J):null)&&(B.get||B.set)?Object.defineProperty(ae,J,B):ae[J]=H[J])}return ae.default=H,Q&&Q.set(H,ae),ae}(O("../core/constants")),f=y(O("./GeometryBuilder")),h=y(O("libtess")),d=(O("./p5.Shader"),O("./p5.Camera"),O("../core/p5.Renderer"),O("./p5.Matrix"),O("./p5.Framebuffer"),O("path"),O("./p5.Texture"));function p(){var H;return typeof WeakMap!="function"?null:(H=new WeakMap,p=function(){return H},H)}function y(H){return H&&H.__esModule?H:{default:H}}function g(H){return function(Q){if(Array.isArray(Q)){for(var J=0,ae=new Array(Q.length);J<Q.length;J++)ae[J]=Q[J];return ae}}(H)||function(Q){if(Symbol.iterator in Object(Q)||Object.prototype.toString.call(Q)==="[object Arguments]")return Array.from(Q)}(H)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(H,Q){for(var J=0;J<Q.length;J++){var ae=Q[J];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(H,ae.key,ae)}}function m(H,Q,J){return(m=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(W,T,B){var W=function(K,te){for(;!Object.prototype.hasOwnProperty.call(K,te)&&(K=S(K))!==null;);return K}(W,T);if(W)return(W=Object.getOwnPropertyDescriptor(W,T)).get?W.get.call(B):W.value})(H,Q,J||H)}function v(H,Q){return(v=Object.setPrototypeOf||function(J,ae){return J.__proto__=ae,J})(H,Q)}function x(H){return function(){var Q,J,ae=S(H);return Q=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(Q=S(this).constructor,Reflect.construct(ae,arguments,Q)):ae.apply(this,arguments),ae=this,!(J=Q)||l(J)!=="object"&&typeof J!="function"?w(ae):J}}function w(H){if(H===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return H}function S(H){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(Q){return Q.__proto__||Object.getPrototypeOf(Q)})(H)}function k(H,Q,J){Q in H?Object.defineProperty(H,Q,{value:J,enumerable:!0,configurable:!0,writable:!0}):H[Q]=J}function _(H,Q){N+="#define STROKE_CAP_".concat(H," ").concat(Q,`
`),A[u[H]]=Q}function C(H,Q){N+="#define STROKE_JOIN_".concat(H," ").concat(Q,`
`),I[u[H]]=Q}var P,A={},I={},N="",O=(_("ROUND",0),_("PROJECT",1),_("SQUARE",2),C("ROUND",0),C("MITER",1),C("BEVEL",2),`#define PI 3.141592

precision highp float;
precision highp int;

uniform mat4 uViewMatrix;

uniform bool uUseLighting;

uniform int uAmbientLightCount;
uniform vec3 uAmbientColor[5];
uniform mat3 uCameraRotation;
uniform int uDirectionalLightCount;
uniform vec3 uLightingDirection[5];
uniform vec3 uDirectionalDiffuseColors[5];
uniform vec3 uDirectionalSpecularColors[5];

uniform int uPointLightCount;
uniform vec3 uPointLightLocation[5];
uniform vec3 uPointLightDiffuseColors[5];	
uniform vec3 uPointLightSpecularColors[5];

uniform int uSpotLightCount;
uniform float uSpotLightAngle[5];
uniform float uSpotLightConc[5];
uniform vec3 uSpotLightDiffuseColors[5];
uniform vec3 uSpotLightSpecularColors[5];
uniform vec3 uSpotLightLocation[5];
uniform vec3 uSpotLightDirection[5];

uniform bool uSpecular;
uniform float uShininess;
uniform float metallic;

uniform float uConstantAttenuation;
uniform float uLinearAttenuation;
uniform float uQuadraticAttenuation;

// setting from  _setImageLightUniforms()
// boolean to initiate the calculateImageDiffuse and calculateImageSpecular
uniform bool uUseImageLight;
// texture for use in calculateImageDiffuse
uniform sampler2D environmentMapDiffused;
// texture for use in calculateImageSpecular
uniform sampler2D environmentMapSpecular;
// roughness for use in calculateImageSpecular
uniform float levelOfDetail;

const float specularFactor = 2.0;
const float diffuseFactor = 0.73;

struct LightResult {
  float specular;
  float diffuse;
};

float _phongSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float shininess) {

  vec3 R = reflect(lightDirection, surfaceNormal);
  return pow(max(0.0, dot(R, viewDirection)), shininess);
}

float _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {
  return max(0.0, dot(-lightDirection, surfaceNormal));
}

LightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {

  vec3 lightDir = normalize(lightVector);

  //compute our diffuse & specular terms
  LightResult lr;
  float specularIntensity = mix(1.0, 0.4, metallic);
  float diffuseIntensity = mix(1.0, 0.1, metallic);
  if (uSpecular)
    lr.specular = (_phongSpecular(lightDir, viewDirection, normal, uShininess)) * specularIntensity;
    lr.diffuse = _lambertDiffuse(lightDir, normal) * diffuseIntensity;
  return lr;
}

// converts the range of "value" from [min1 to max1] to [min2 to max2]
float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

vec2 mapTextureToNormal( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );
  return angles;
}


vec3 calculateImageDiffuse( vec3 vNormal, vec3 vViewPosition ){
  // make 2 seperate builds 
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position
  vec3 worldNormal = normalize(vNormal * uCameraRotation);
  vec2 newTexCoor = mapTextureToNormal( worldNormal );
  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(smoothstep(vec3(0.0), vec3(1.0), texture.xyz), vec3(0.0), metallic);
}

vec3 calculateImageSpecular( vec3 vNormal, vec3 vViewPosition ){
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);
  vec3 worldNormal = normalize(vNormal);
  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );
  vec3 R = reflect(lightDirection, worldNormal) * uCameraRotation;
  vec2 newTexCoor = mapTextureToNormal( R );
#ifdef WEBGL2
  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, levelOfDetail);
#else
  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);
#endif
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(
    pow(outColor.xyz, vec3(10)),
    pow(outColor.xyz, vec3(1.2)),
    metallic 
  );
}

void totalLight(
  vec3 modelPosition,
  vec3 normal,
  out vec3 totalDiffuse,
  out vec3 totalSpecular
) {

  totalSpecular = vec3(0.0);

  if (!uUseLighting) {
    totalDiffuse = vec3(1.0);
    return;
  }

  totalDiffuse = vec3(0.0);

  vec3 viewDirection = normalize(-modelPosition);

  for (int j = 0; j < 5; j++) {
    if (j < uDirectionalLightCount) {
      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;
      vec3 lightColor = uDirectionalDiffuseColors[j];
      vec3 specularColor = uDirectionalSpecularColors[j];
      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if (j < uPointLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
      //calculate attenuation
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);
      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];
      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];

      LightResult result = _light(viewDirection, normal, lightVector);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if(j < uSpotLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);

      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;
      float spotDot = dot(normalize(lightVector), normalize(lightDirection));
      float spotFalloff;
      if(spotDot < uSpotLightAngle[j]) {
        spotFalloff = 0.0;
      }
      else {
        spotFalloff = pow(spotDot, uSpotLightConc[j]);
      }
      lightFalloff *= spotFalloff;

      vec3 lightColor = uSpotLightDiffuseColors[j];
      vec3 specularColor = uSpotLightSpecularColors[j];
     
      LightResult result = _light(viewDirection, normal, lightVector);
      
      totalDiffuse += result.diffuse * lightColor * lightFalloff;
      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;
    }
  }

  if( uUseImageLight ){
    totalDiffuse += calculateImageDiffuse(normal, modelPosition);
    totalSpecular += calculateImageSpecular(normal, modelPosition);
  }

  totalDiffuse *= diffuseFactor;
  totalSpecular *= specularFactor;
}
`),F={sphereMappingFrag:`#define PI 3.141592

precision highp float;
  
uniform sampler2D uSampler;
uniform mat3 uNewNormalMatrix;
uniform float uFovY;
uniform float uAspect;

varying vec2 vTexCoord;
  
void main() {
    float uFovX = uFovY * uAspect; 
    vec4 newTexColor = texture2D(uSampler, vTexCoord);
    float angleY = mix(uFovY/2.0,  -uFovY/2.0, vTexCoord.y);
    float angleX = mix(uFovX/2.0, -uFovX/2.0, vTexCoord.x);
    vec3 rotatedNormal = vec3( angleX, angleY, 1.0 );
    rotatedNormal = uNewNormalMatrix * normalize(rotatedNormal);
    vec2 suv;
    suv.y = 0.5 + 0.5 * (-rotatedNormal.y);
    suv.x = atan(rotatedNormal.z, rotatedNormal.x) / (2.0 * PI) + 0.5;
    newTexColor = texture2D(uSampler, suv.xy);
    gl_FragColor = newTexColor;
}
`,immediateVert:`IN vec3 aPosition;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uResolution;
uniform float uPointSize;

OUT vec4 vColor;
void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
  gl_PointSize = uPointSize;
}
`,vertexColorVert:`IN vec3 aPosition;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

OUT vec4 vColor;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vColor = aVertexColor;
}
`,vertexColorFrag:`IN vec4 vColor;
void main(void) {
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,normalVert:`IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform vec4 uMaterialColor;
uniform bool uUseVertexColor;

OUT vec3 vVertexNormal;
OUT highp vec2 vVertTexCoord;
OUT vec4 vColor;

void main(void) {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));
  vVertTexCoord = aTexCoord;
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,normalFrag:`IN vec3 vVertexNormal;
void main(void) {
  OUT_COLOR = vec4(vVertexNormal, 1.0);
}
`,basicFrag:`IN vec4 vColor;
void main(void) {
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,lightVert:O+`// include lighting.glgl

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT highp vec2 vVertTexCoord;
OUT vec3 vDiffuseColor;
OUT vec3 vSpecularColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;

  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);
  vVertTexCoord = aTexCoord;

  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);

  for (int i = 0; i < 8; i++) {
    if (i < uAmbientLightCount) {
      vDiffuseColor += uAmbientColor[i];
    }
  }
  
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,lightTextureFrag:`uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

IN highp vec2 vVertTexCoord;
IN vec3 vDiffuseColor;
IN vec3 vSpecularColor;
IN vec4 vColor;

void main(void) {
  if(uEmissive && !isTexture) {
    OUT_COLOR = vColor;
  }
  else {
    vec4 baseColor = isTexture
      // Textures come in with premultiplied alpha. To apply tint and still have
      // premultiplied alpha output, we need to multiply the RGB channels by the
      // tint RGB, and all channels by the tint alpha.
      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
      // Colors come in with unmultiplied alpha, so we need to multiply the RGB
      // channels by alpha to convert it to premultiplied alpha.
      : vec4(vColor.rgb * vColor.a, vColor.a);
    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);
  }
}
`,phongVert:`precision highp int;

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform vec3 uAmbientColor[5];

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;
uniform int uAmbientLightCount;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT vec3 vNormal;
OUT vec2 vTexCoord;
OUT vec3 vViewPosition;
OUT vec3 vAmbientColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);

  // Pass varyings to fragment shader
  vViewPosition = viewModelPosition.xyz;
  gl_Position = uProjectionMatrix * viewModelPosition;  

  vNormal = uNormalMatrix * aNormal;
  vTexCoord = aTexCoord;

  // TODO: this should be a uniform
  vAmbientColor = vec3(0.0);
  for (int i = 0; i < 5; i++) {
    if (i < uAmbientLightCount) {
      vAmbientColor += uAmbientColor[i];
    }
  }
  
  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);
}
`,phongFrag:O+`// include lighting.glsl
precision highp int;

uniform bool uHasSetAmbient;
uniform vec4 uSpecularMatColor;
uniform vec4 uAmbientMatColor;
uniform vec4 uEmissiveMatColor;

uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;

IN vec3 vNormal;
IN vec2 vTexCoord;
IN vec3 vViewPosition;
IN vec3 vAmbientColor;
IN vec4 vColor;

void main(void) {

  vec3 diffuse;
  vec3 specular;
  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);

  // Calculating final color as result of all lights (plus emissive term).

  vec4 baseColor = isTexture
    // Textures come in with premultiplied alpha. To apply tint and still have
    // premultiplied alpha output, we need to multiply the RGB channels by the
    // tint RGB, and all channels by the tint alpha.
    ? TEXTURE(uSampler, vTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
    // Colors come in with unmultiplied alpha, so we need to multiply the RGB
    // channels by alpha to convert it to premultiplied alpha.
    : vec4(vColor.rgb * vColor.a, vColor.a);
  OUT_COLOR = vec4(diffuse * baseColor.rgb + 
                    vAmbientColor * (
                      uHasSetAmbient ? uAmbientMatColor.rgb : baseColor.rgb
                    ) + 
                    specular * uSpecularMatColor.rgb + 
                    uEmissiveMatColor.rgb, baseColor.a);
}
`,fontVert:`IN vec3 aPosition;
IN vec2 aTexCoord;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

uniform vec4 uGlyphRect;
uniform float uGlyphOffset;

OUT vec2 vTexCoord;
OUT float w;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // scale by the size of the glyph's rectangle
  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;

  // Expand glyph bounding boxes by 1px on each side to give a bit of room
  // for antialiasing
  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;
  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;
  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;
  vec2 pixelScale = vec2(
    1. / length(newOrigin - newDX),
    1. / length(newOrigin - newDY)
  );
  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5)) * vec2(1., -1.);
  vec2 textureOffset = offset * (1. / vec2(
    uGlyphRect.z - uGlyphRect.x,
    uGlyphRect.w - uGlyphRect.y
  ));

  // move to the corner of the glyph
  positionVec4.xy += uGlyphRect.xy;

  // move to the letter's line offset
  positionVec4.x += uGlyphOffset;

  positionVec4.xy += offset;
  
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vTexCoord = aTexCoord + textureOffset;
  w = gl_Position.w;
}
`,fontFrag:`#ifndef WEBGL2
#extension GL_OES_standard_derivatives : enable
#endif

#if 0
  // simulate integer math using floats
	#define int float
	#define ivec2 vec2
	#define INT(x) float(x)

	int ifloor(float v) { return floor(v); }
	ivec2 ifloor(vec2 v) { return floor(v); }

#else
  // use native integer math
	precision highp int;
	#define INT(x) x

	int ifloor(float v) { return int(v); }
	int ifloor(int v) { return v; }
	ivec2 ifloor(vec2 v) { return ivec2(v); }

#endif

uniform sampler2D uSamplerStrokes;
uniform sampler2D uSamplerRowStrokes;
uniform sampler2D uSamplerRows;
uniform sampler2D uSamplerColStrokes;
uniform sampler2D uSamplerCols;

uniform ivec2 uStrokeImageSize;
uniform ivec2 uCellsImageSize;
uniform ivec2 uGridImageSize;

uniform ivec2 uGridOffset;
uniform ivec2 uGridSize;
uniform vec4 uMaterialColor;

IN vec2 vTexCoord;

// some helper functions
int ROUND(float v) { return ifloor(v + 0.5); }
ivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }
float saturate(float v) { return clamp(v, 0.0, 1.0); }
vec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }

int mul(float v1, int v2) {
  return ifloor(v1 * float(v2));
}

ivec2 mul(vec2 v1, ivec2 v2) {
  return ifloor(v1 * vec2(v2) + 0.5);
}

// unpack a 16-bit integer from a float vec2
int getInt16(vec2 v) {
  ivec2 iv = ROUND(v * 255.0);
  return iv.x * INT(128) + iv.y;
}

vec2 pixelScale;
vec2 coverage = vec2(0.0);
vec2 weight = vec2(0.5);
const float minDistance = 1.0/8192.0;
const float hardness = 1.05; // amount of antialias

// the maximum number of curves in a glyph
const int N = INT(250);

// retrieves an indexed pixel from a sampler
vec4 getTexel(sampler2D sampler, int pos, ivec2 size) {
  int width = size.x;
  int y = ifloor(pos / width);
  int x = pos - y * width;  // pos % width

  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));
}

void calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {

  // get the coefficients of the quadratic in t
  vec2 a = p0 - p1 * 2.0 + p2;
  vec2 b = p0 - p1;
  vec2 c = p0 - vTexCoord;

  // found out which values of 't' it crosses the axes
  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));
  vec2 t1 = ((b - surd) / a).yx;
  vec2 t2 = ((b + surd) / a).yx;

  // approximate straight lines to avoid rounding errors
  if (abs(a.y) < 0.001)
    t1.x = t2.x = c.y / (2.0 * b.y);

  if (abs(a.x) < 0.001)
    t1.y = t2.y = c.x / (2.0 * b.x);

  // plug into quadratic formula to find the corrdinates of the crossings
  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;
  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;
}

void coverageX(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  // determine on which side of the x-axis the points lie
  bool y0 = p0.y > vTexCoord.y;
  bool y1 = p1.y > vTexCoord.y;
  bool y2 = p2.y > vTexCoord.y;

  // could web be under the curve (after t1)?
  if (y1 ? !y2 : y0) {
    // add the coverage for t1
    coverage.x += saturate(C1.x + 0.5);
    // calculate the anti-aliasing for t1
    weight.x = min(weight.x, abs(C1.x));
  }

  // are we outside the curve (after t2)?
  if (y1 ? !y0 : y2) {
    // subtract the coverage for t2
    coverage.x -= saturate(C2.x + 0.5);
    // calculate the anti-aliasing for t2
    weight.x = min(weight.x, abs(C2.x));
  }
}

// this is essentially the same as coverageX, but with the axes swapped
void coverageY(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  bool x0 = p0.x > vTexCoord.x;
  bool x1 = p1.x > vTexCoord.x;
  bool x2 = p2.x > vTexCoord.x;

  if (x1 ? !x2 : x0) {
    coverage.y -= saturate(C1.y + 0.5);
    weight.y = min(weight.y, abs(C1.y));
  }

  if (x1 ? !x0 : x2) {
    coverage.y += saturate(C2.y + 0.5);
    weight.y = min(weight.y, abs(C2.y));
  }
}

void main() {

  // calculate the pixel scale based on screen-coordinates
  pixelScale = hardness / fwidth(vTexCoord);

  // which grid cell is this pixel in?
  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));

  // intersect curves in this row
  {
    // the index into the row info bitmap
    int rowIndex = gridCoord.y + uGridOffset.y;
    // fetch the info texel
    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);
    // unpack the rowInfo
    int rowStrokeIndex = getInt16(rowInfo.xy);
    int rowStrokeCount = getInt16(rowInfo.zw);

    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {
      if (iRowStroke >= rowStrokeCount)
        break;

      // each stroke is made up of 3 points: the start and control point
      // and the start of the next curve.
      // fetch the indices of this pair of strokes:
      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);

      // unpack the stroke index
      int strokePos = getInt16(strokeIndices.xy);

      // fetch the two strokes
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);

      // calculate the coverage
      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  // intersect curves in this column
  {
    int colIndex = gridCoord.x + uGridOffset.x;
    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);
    int colStrokeIndex = getInt16(colInfo.xy);
    int colStrokeCount = getInt16(colInfo.zw);
    
    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {
      if (iColStroke >= colStrokeCount)
        break;

      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);

      int strokePos = getInt16(strokeIndices.xy);
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);
      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  weight = saturate(1.0 - weight * 2.0);
  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.
  float antialias = abs(dot(coverage, weight) / distance);
  float cover = min(abs(coverage.x), abs(coverage.y));
  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
  OUT_COLOR *= saturate(max(antialias, cover));
}
`,lineVert:N+`/*
  Part of the Processing project - http://processing.org
  Copyright (c) 2012-15 The Processing Foundation
  Copyright (c) 2004-12 Ben Fry and Casey Reas
  Copyright (c) 2001-04 Massachusetts Institute of Technology
  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation, version 2.1.
  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.
  You should have received a copy of the GNU Lesser General
  Public License along with this library; if not, write to the
  Free Software Foundation, Inc., 59 Temple Place, Suite 330,
  Boston, MA  02111-1307  USA
*/

#define PROCESSING_LINE_SHADER

precision mediump int;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform float uStrokeWeight;

uniform bool uUseLineColor;
uniform vec4 uMaterialColor;

uniform vec4 uViewport;
uniform int uPerspective;
uniform int uStrokeJoin;

IN vec4 aPosition;
IN vec3 aTangentIn;
IN vec3 aTangentOut;
IN float aSide;
IN vec4 aVertexColor;

OUT vec4 vColor;
OUT vec2 vTangent;
OUT vec2 vCenter;
OUT vec2 vPosition;
OUT float vMaxDist;
OUT float vCap;
OUT float vJoin;

vec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {
  // Rotate and translate so a starts at the origin and goes out to the right
  bPoint -= aPoint;
  vec2 rotatedBFrom = vec2(
    bPoint.x*aDir.x + bPoint.y*aDir.y,
    bPoint.y*aDir.x - bPoint.x*aDir.y
  );
  vec2 bTo = bPoint + bDir;
  vec2 rotatedBTo = vec2(
    bTo.x*aDir.x + bTo.y*aDir.y,
    bTo.y*aDir.x - bTo.x*aDir.y
  );
  float intersectionDistance =
    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /
    (rotatedBTo.y - rotatedBFrom.y);
  return aPoint + aDir * intersectionDistance;
}

void main() {
  // Caps have one of either the in or out tangent set to 0
  vCap = (aTangentIn == vec3(0.)) != (aTangentOut == (vec3(0.)))
    ? 1. : 0.;

  // Joins have two unique, defined tangents
  vJoin = (
    aTangentIn != vec3(0.) &&
    aTangentOut != vec3(0.) &&
    aTangentIn != aTangentOut
  ) ? 1. : 0.;

  vec4 posp = uModelViewMatrix * aPosition;
  vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));
  vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));

  float facingCamera = pow(
    // The word space tangent's z value is 0 if it's facing the camera
    abs(normalize(posqIn-posp).z),

    // Using pow() here to ramp \`facingCamera\` up from 0 to 1 really quickly
    // so most lines get scaled and don't get clipped
    0.25
  );

  // using a scale <1 moves the lines towards the camera
  // in order to prevent popping effects due to half of
  // the line disappearing behind the geometry faces.
  float scale = mix(1., 0.995, facingCamera);

  // Moving vertices slightly toward the camera
  // to avoid depth-fighting with the fill triangles.
  // Discussed here:
  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  
  posp.xyz = posp.xyz * scale;
  posqIn.xyz = posqIn.xyz * scale;
  posqOut.xyz = posqOut.xyz * scale;

  vec4 p = uProjectionMatrix * posp;
  vec4 qIn = uProjectionMatrix * posqIn;
  vec4 qOut = uProjectionMatrix * posqOut;
  vCenter = p.xy;

  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])
  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw

  // prevent division by W by transforming the tangent formula (div by 0 causes
  // the line to disappear, see https://github.com/processing/processing/issues/5183)
  // t = screen_q - screen_p
  //
  // tangent is normalized and we don't care which aDirection it points to (+-)
  // t = +- normalize( screen_q - screen_p )
  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )
  //
  // extract common factor, <1,1> - <1,1> cancels out
  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )
  //
  // convert to common divisor
  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )
  //
  // remove the common scalar divisor/factor, not needed due to normalize and +-
  // (keep uViewport - can't remove because it has different components for x and y
  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)
  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )

  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);
  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);

  vec2 curPerspScale;
  if(uPerspective == 1) {
    // Perspective ---
    // convert from world to clip by multiplying with projection scaling factor
    // to get the right thickness (see https://github.com/processing/processing/issues/5182)

    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.
    // Multiplying again by its sign here negates the flip to get just the scale.
    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;
  } else {
    // No Perspective ---
    // multiply by W (to cancel out division by W later in the pipeline) and
    // convert from screen to clip (derived from clip to screen above)
    curPerspScale = p.w / (0.5 * uViewport.zw);
  }

  vec2 offset;
  if (vJoin == 1.) {
    vTangent = normalize(tangentIn + tangentOut);
    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);
    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);
    float side = sign(aSide);
    float sideEnum = abs(aSide);

    // We generate vertices for joins on either side of the centerline, but
    // the "elbow" side is the only one needing a join. By not setting the
    // offset for the other side, all its vertices will end up in the same
    // spot and not render, effectively discarding it.
    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {
      // Side enums:
      //   1: the side going into the join
      //   2: the middle of the join
      //   3: the side going out of the join
      if (sideEnum == 2.) {
        // Calculate the position + tangent on either side of the join, and
        // find where the lines intersect to find the elbow of the join
        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;
        vec2 intersection = lineIntersection(
          c + (side * normalIn * uStrokeWeight / 2.),
          tangentIn,
          c + (side * normalOut * uStrokeWeight / 2.),
          tangentOut
        );
        offset = (intersection - c);

        // When lines are thick and the angle of the join approaches 180, the
        // elbow might be really far from the center. We'll apply a limit to
        // the magnitude to avoid lines going across the whole screen when this
        // happens.
        float mag = length(offset);
        float maxMag = 3. * uStrokeWeight;
        if (mag > maxMag) {
          offset *= maxMag / mag;
        }
      } else if (sideEnum == 1.) {
        offset = side * normalIn * uStrokeWeight / 2.;
      } else if (sideEnum == 3.) {
        offset = side * normalOut * uStrokeWeight / 2.;
      }
    }
    if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);
      vMaxDist = abs(dot(avgNormal, normalIn * uStrokeWeight / 2.));
    } else {
      vMaxDist = uStrokeWeight / 2.;
    }
  } else {
    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;
    vTangent = tangent;
    vec2 normal = vec2(-tangent.y, tangent.x);

    float normalOffset = sign(aSide);
    // Caps will have side values of -2 or 2 on the edge of the cap that
    // extends out from the line
    float tangentOffset = abs(aSide) - 1.;
    offset = (normal * normalOffset + tangent * tangentOffset) *
      uStrokeWeight * 0.5;
    vMaxDist = uStrokeWeight / 2.;
  }
  vPosition = vCenter + offset;

  gl_Position.xy = p.xy + offset.xy * curPerspScale;
  gl_Position.zw = p.zw;
  
  vColor = (uUseLineColor ? aVertexColor : uMaterialColor);
}
`,lineFrag:N+`precision mediump int;

uniform vec4 uMaterialColor;
uniform int uStrokeCap;
uniform int uStrokeJoin;
uniform float uStrokeWeight;

IN vec4 vColor;
IN vec2 vTangent;
IN vec2 vCenter;
IN vec2 vPosition;
IN float vMaxDist;
IN float vCap;
IN float vJoin;

float distSquared(vec2 a, vec2 b) {
  vec2 aToB = b - a;
  return dot(aToB, aToB);
}

void main() {
  if (vCap > 0.) {
    if (
      uStrokeCap == STROKE_CAP_ROUND &&
      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25
    ) {
      discard;
    } else if (
      uStrokeCap == STROKE_CAP_SQUARE &&
      dot(vPosition - vCenter, vTangent) > 0.
    ) {
      discard;
    }
    // Use full area for PROJECT
  } else if (vJoin > 0.) {
    if (
      uStrokeJoin == STROKE_JOIN_ROUND &&
      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25
    ) {
      discard;
    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 normal = vec2(-vTangent.y, vTangent.x);
      if (abs(dot(vPosition - vCenter, normal)) > vMaxDist) {
        discard;
      }
    }
    // Use full area for MITER
  }
  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;
}
`,pointVert:`IN vec3 aPosition;
uniform float uPointSize;
OUT float vStrokeWeight;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
void main() {
	vec4 positionVec4 =  vec4(aPosition, 1.0);
	gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
	gl_PointSize = uPointSize;
	vStrokeWeight = uPointSize;
}
`,pointFrag:`precision mediump int;
uniform vec4 uMaterialColor;
IN float vStrokeWeight;

void main(){
  float mask = 0.0;

  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)
  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant

  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));

  // if strokeWeight is 1 or less lets just draw a square
  // this prevents weird artifacting from carving circles when our points are really small
  // if strokeWeight is larger than 1, we just use it as is

  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));

  // throw away the borders of the mask
  // otherwise we get weird alpha blending issues

  if(mask > 0.98){
    discard;
  }

  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
}
`,imageLightVert:`precision highp float;
attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

varying vec3 localPos;
varying vec3 vWorldNormal;
varying vec3 vWorldPosition;
varying vec2 vTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

void main() {
  // Multiply the position by the matrix.
  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;  
  
  // orient the normals and pass to the fragment shader
  vWorldNormal = uNormalMatrix * aNormal;
  
  // send the view position to the fragment shader
  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;
  
  localPos = vWorldPosition;
  vTexCoord = aTexCoord;
}


/*
in the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.
*/
`,imageLightDiffusedFrag:`precision highp float;
varying vec3 localPos;

// the HDR cubemap converted (can be from an equirectangular environment map.)
uniform sampler2D environmentMap;
varying vec2 vTexCoord;

const float PI = 3.14159265359;

vec2 nTOE( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( phi, theta );
  return angles;
}

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

void main()
{   	 
	// the sample direction equals the hemisphere's orientation
  float phi = vTexCoord.x * 2.0 * PI;
  float theta = vTexCoord.y * PI;
  float x = sin(theta) * cos(phi);
  float y = sin(theta) * sin(phi);
  float z = cos(theta);
  vec3 normal = vec3( x, y, z);

	// Discretely sampling the hemisphere given the integral's
  // spherical coordinates translates to the following fragment code:
	vec3 irradiance = vec3(0.0);  
	vec3 up	= vec3(0.0, 1.0, 0.0);
	vec3 right = normalize(cross(up, normal));
	up = normalize(cross(normal, right));

	//  We specify a fixed sampleDelta delta value to traverse
  // the hemisphere; decreasing or increasing the sample delta
  // will increase or decrease the accuracy respectively.
	const float sampleDelta = 0.100;
	float nrSamples = 0.0;
  float randomOffset = random(gl_FragCoord.xy) * sampleDelta;
	for(float rawPhi = 0.0; rawPhi < 2.0 * PI; rawPhi += sampleDelta)
	{
    float phi = rawPhi + randomOffset;
    for(float rawTheta = 0.0; rawTheta < ( 0.5 ) * PI; rawTheta += sampleDelta)
    {
      float theta = rawTheta + randomOffset;
      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance
      float x = sin(theta) * cos(phi);
      float y = sin(theta) * sin(phi);
      float z = cos(theta);
      vec3 tangentSample = vec3( x, y, z);
      
      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;
        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);
      nrSamples++;
    }
	}
	// divide by the total number of samples taken, giving us the average sampled irradiance.
	irradiance = PI * irradiance * (1.0 / float(nrSamples )) ;
  
 
	gl_FragColor = vec4(irradiance, 1.0);
}`,imageLightSpecularFrag:`precision highp float;\r
varying vec3 localPos;\r
varying vec2 vTexCoord;\r
\r
// our texture\r
uniform sampler2D environmentMap;\r
uniform float roughness;\r
\r
const float PI = 3.14159265359;\r
\r
float VanDerCorput(int bits);\r
vec2 HammersleyNoBitOps(int i, int N);\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\r
\r
\r
vec2 nTOE( vec3 v ){\r
  // x = r sin(phi) cos(theta)   \r
  // y = r cos(phi)  \r
  // z = r sin(phi) sin(theta)\r
  float phi = acos( v.y );\r
  // if phi is 0, then there are no x, z components\r
  float theta = 0.0;\r
  // else \r
  theta = acos(v.x / sin(phi));\r
  float sinTheta = v.z / sin(phi);\r
  if (sinTheta < 0.0) {\r
    // Turn it into -theta, but in the 0-2PI range\r
    theta = 2.0 * PI - theta;\r
  }\r
  theta = theta / (2.0 * 3.14159);\r
  phi = phi / 3.14159 ;\r
  \r
  vec2 angles = vec2( phi, theta );\r
  return angles;\r
}\r
\r
\r
void main(){\r
  const int SAMPLE_COUNT = 400; // 4096\r
  int lowRoughnessLimit = int(pow(2.0,(roughness+0.1)*20.0));\r
  float totalWeight = 0.0;\r
  vec3 prefilteredColor = vec3(0.0);\r
  float phi = vTexCoord.x * 2.0 * PI;\r
  float theta = vTexCoord.y * PI;\r
  float x = sin(theta) * cos(phi);\r
  float y = sin(theta) * sin(phi);\r
  float z = cos(theta);\r
  vec3 N = vec3(x,y,z);\r
  vec3 V = N;\r
  for (int i = 0; i < SAMPLE_COUNT; ++i)\r
  {\r
    // break at smaller sample numbers for low roughness levels\r
    if(i == lowRoughnessLimit)\r
    {\r
      break;\r
    }\r
    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\r
    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\r
    vec3 L = normalize(2.0 * dot(V, H) * H - V);\r
\r
    float NdotL = max(dot(N, L), 0.0);\r
    if (NdotL > 0.0)\r
    {\r
      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\r
      totalWeight += NdotL;\r
    }\r
  }\r
  prefilteredColor = prefilteredColor / totalWeight;\r
\r
  gl_FragColor = vec4(prefilteredColor, 1.0);\r
}\r
\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\r
  float a = roughness * roughness;\r
\r
  float phi = 2.0 * PI * Xi.x;\r
  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\r
  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\r
  // from spherical coordinates to cartesian coordinates\r
  vec3 H;\r
  H.x = cos(phi) * sinTheta;\r
  H.y = sin(phi) * sinTheta;\r
  H.z = cosTheta;\r
\r
  // from tangent-space vector to world-space sample vector\r
  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\r
  vec3 tangent = normalize(cross(up, N));\r
  vec3 bitangent = cross(N, tangent);\r
\r
  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\r
  return normalize(sampleVec);\r
}\r
\r
\r
float VanDerCorput(int n, int base)\r
{\r
#ifdef WEBGL2\r
\r
    uint bits = uint(n);\r
    bits = (bits << 16u) | (bits >> 16u);\r
    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\r
    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\r
    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\r
    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\r
    return float(bits) * 2.3283064365386963e-10; // / 0x100000000\r
\r
#else\r
\r
  float invBase = 1.0 / float(base);\r
  float denom = 1.0;\r
  float result = 0.0;\r
\r
\r
  for (int i = 0; i < 32; ++i)\r
  {\r
        if (n > 0)\r
        {\r
        denom = mod(float(n), 2.0);\r
        result += denom * invBase;\r
        invBase = invBase / 2.0;\r
        n = int(float(n) / 2.0);\r
        }\r
  }\r
\r
\r
  return result;\r
\r
#endif\r
}\r
\r
vec2 HammersleyNoBitOps(int i, int N)\r
{\r
  return vec2(float(i) / float(N), VanDerCorput(i, 2));\r
}\r
`},U=F.sphereMappingFrag;for(P in F)F[P]=`#ifdef WEBGL2

#define IN in
#define OUT out

#ifdef FRAGMENT_SHADER
out vec4 outColor;
#define OUT_COLOR outColor
#endif
#define TEXTURE texture

#else

#ifdef FRAGMENT_SHADER
#define IN varying
#else
#define IN attribute
#endif
#define OUT varying
#define TEXTURE texture2D

#ifdef FRAGMENT_SHADER
#define OUT_COLOR gl_FragColor
#endif

#endif
`+F[P];k(O={},u.GRAY,`precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 tex = texture2D(tex0, vTexCoord);
  float gray = luma(tex.rgb);
  gl_FragColor = vec4(gray, gray, gray, tex.a);
}
`),k(O,u.ERODE,`// Reduces the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the darkest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum < lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`),k(O,u.DILATE,`// Increase the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the brightest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum > lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`),k(O,u.BLUR,`precision highp float;

// Two-pass blur filter, unweighted kernel.
// See also a similar blur at Adam Ferriss' repo of shader examples:
// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag


uniform sampler2D tex0;
varying vec2 vTexCoord;
uniform vec2 direction;
uniform vec2 canvasSize;
uniform float radius;

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

// This isn't a real Gaussian weight, it's a quadratic weight. It's what the
// CPU mode's blur uses though, so we also use it here to match.
float quadWeight(float x, float e) {
  return pow(e-abs(x), 2.);
}

void main(){
  vec2 uv = vTexCoord;

  // A reasonable maximum number of samples
  const float maxSamples = 64.0;

  float numSamples = floor(7. * radius);
  if (fract(numSamples / 2.) == 0.) {
    numSamples++;
  }
  vec4 avg = vec4(0.0);
  float total = 0.0;

  // Calculate the spacing to avoid skewing if numSamples > maxSamples
  float spacing = 1.0;
  if (numSamples > maxSamples) {
    spacing = numSamples / maxSamples;
    numSamples = maxSamples;
  }

  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));
  for (float i = 0.0; i < maxSamples; i++) {
    if (i >= numSamples) break;

    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;
    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;
    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);

    avg += weight * texture2D(tex0, sampleCoord);
    total += weight;
  }

  avg /= total;
  gl_FragColor = avg;
}
`),k(O,u.POSTERIZE,`// Limit color space for a stylized cartoon / poster effect

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

vec3 quantize(vec3 color, float n) {
  // restrict values to N options/bins
  // and floor each channel to nearest value
  //
  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0
  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)

  color = color * n;
  color = floor(color);
  color = color / (n - 1.0);
  return color;
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);

  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);

  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);
}
`),k(O,u.OPAQUE,`// Set alpha channel to entirely opaque

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  gl_FragColor = vec4(color.rgb / color.a, 1.0);
}
`),k(O,u.INVERT,`// Set each pixel to inverse value
// Note that original INVERT does not change the opacity, so this follows suit

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
vec4 color = texture2D(tex0, vTexCoord);
vec3 origColor = color.rgb / color.a;
vec3 invertedColor = vec3(1.0) - origColor;
gl_FragColor = vec4(invertedColor * color.a, color.a);
}
`),k(O,u.THRESHOLD,`// Convert pixels to either white or black, 
// depending on if their luma is above or below filterParameter

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float gray = luma(color.rgb / color.a);
  // floor() used to match src/image/filters.js
  float threshold = floor(filterParameter * 255.0) / 255.0;
  float blackOrWhite = step(threshold, gray);
  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);
}
`);var G=O;function Y(H,Q,fe,ae,T,B,W,K,te,ne){var ce=Q.getParameter(Q.FRAMEBUFFER_BINDING),fe=(Q.bindFramebuffer(Q.FRAMEBUFFER,fe),K===Q.RGBA?4:3),ue=B*W*fe,ge=te===Q.UNSIGNED_BYTE?Uint8Array:Float32Array;if(H instanceof ge&&H.length===ue||(H=new ge(ue)),Q.readPixels(ae,ne?ne-T-W:T,B,W,K,te,H),Q.bindFramebuffer(Q.FRAMEBUFFER,ce),ne)for(var me=Math.floor(W/2),oe=new ge(B*fe),de=0;de<me;de++){var xe=de*B*4,Ie=(W-de-1)*B*4;oe.set(H.subarray(xe,xe+4*B)),H.copyWithin(xe,Ie,Ie+4*B),H.set(oe,Ie)}return H}function $(H,te,J,ae,T,B,W){var K=H.getParameter(H.FRAMEBUFFER_BINDING),te=(H.bindFramebuffer(H.FRAMEBUFFER,te),T===H.RGBA?4:3),te=new(B===H.UNSIGNED_BYTE?Uint8Array:Float32Array)(te);return H.readPixels(J,W?W-ae-1:ae,1,1,T,B,te),H.bindFramebuffer(H.FRAMEBUFFER,K),Array.from(te)}c.default.prototype.setAttributes=function(H,Q){if(this._glAttributes===void 0)console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.");else{var J=!0;if(Q!==void 0?(this._glAttributes===null&&(this._glAttributes={}),this._glAttributes[H]!==Q&&(this._glAttributes[H]=Q,J=!1)):H instanceof Object&&this._glAttributes!==H&&(this._glAttributes=H,J=!1),this._renderer.isP3D&&!J){if(!this._setupDone){for(var ae in this._renderer.retainedMode.geometry)if(this._renderer.retainedMode.geometry.hasOwnProperty(ae))return void c.default._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()")}this.push(),this._renderer._resetContext(),this.pop(),this._renderer._curCamera&&(this._renderer._curCamera._renderer=this._renderer)}}},c.default.RendererGL=function(H){var Q=ae;if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function");Q.prototype=Object.create(H&&H.prototype,{constructor:{value:Q,writable:!0,configurable:!0}}),H&&v(Q,H);var J=x(ae);function ae(T,B,W,K){if(this instanceof ae)return(T=J.call(this,T,B,W))._setAttributeDefaults(B),T._initContext(),T.isP3D=!0,T.geometryBuilder=void 0,T.GL=T.drawingContext,T._pInst._setProperty("drawingContext",T.drawingContext),T._isErasing=!1,T._clipDepths=[],T._isClipApplied=!1,T._stencilTestOn=!1,T._enableLighting=!1,T.ambientLightColors=[],T.mixedAmbientLight=[],T.mixedSpecularColor=[],T.specularColors=[1,1,1],T.directionalLightDirections=[],T.directionalLightDiffuseColors=[],T.directionalLightSpecularColors=[],T.pointLightPositions=[],T.pointLightDiffuseColors=[],T.pointLightSpecularColors=[],T.spotLightPositions=[],T.spotLightDirections=[],T.spotLightDiffuseColors=[],T.spotLightSpecularColors=[],T.spotLightAngle=[],T.spotLightConc=[],T.activeImageLight=null,T.diffusedTextures=new Map,T.specularTextures=new Map,T.drawMode=u.FILL,T.curFillColor=T._cachedFillStyle=[1,1,1,1],T.curAmbientColor=T._cachedFillStyle=[1,1,1,1],T.curSpecularColor=T._cachedFillStyle=[0,0,0,0],T.curEmissiveColor=T._cachedFillStyle=[0,0,0,0],T.curStrokeColor=T._cachedStrokeStyle=[0,0,0,1],T.curBlendMode=u.BLEND,T.preEraseBlend=void 0,T._cachedBlendMode=void 0,T.webglVersion===u.WEBGL2?T.blendExt=T.GL:T.blendExt=T.GL.getExtension("EXT_blend_minmax"),T._isBlending=!1,T._hasSetAmbient=!1,T._useSpecularMaterial=!1,T._useEmissiveMaterial=!1,T._useNormalMaterial=!1,T._useShininess=1,T._useMetalness=0,T._useLineColor=!1,T._useVertexColor=!1,T.registerEnabled=new Set,T._tint=[255,255,255,255],T.constantAttenuation=1,T.linearAttenuation=0,T.quadraticAttenuation=0,T.uMVMatrix=new c.default.Matrix,T.uPMatrix=new c.default.Matrix,T.uNMatrix=new c.default.Matrix("mat3"),T.curMatrix=new c.default.Matrix("mat3"),T._currentNormal=new c.default.Vector(0,0,1),T._curCamera=new c.default.Camera(w(T)),T._curCamera._computeCameraDefaultSettings(),T._curCamera._setDefaultCamera(),T.filterCamera=new c.default.Camera(w(T)),T.filterCamera._computeCameraDefaultSettings(),T.filterCamera._setDefaultCamera(),T.prevTouches=[],T.zoomVelocity=0,T.rotateVelocity=new c.default.Vector(0,0),T.moveVelocity=new c.default.Vector(0,0),T.executeZoom=!1,T.executeRotateAndMove=!1,T.specularShader=void 0,T.sphereMapping=void 0,T.diffusedShader=void 0,T._defaultLightShader=void 0,T._defaultImmediateModeShader=void 0,T._defaultNormalShader=void 0,T._defaultColorShader=void 0,T._defaultPointShader=void 0,T.userFillShader=void 0,T.userStrokeShader=void 0,T.userPointShader=void 0,T.retainedMode={geometry:{},buffers:{stroke:[new c.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",w(T)),new c.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",w(T)),new c.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",w(T)),new c.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",w(T)),new c.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",w(T))],fill:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",w(T),T._vToNArray),new c.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",w(T),T._vToNArray),new c.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",w(T)),new c.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",w(T)),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",w(T),T._flatten)],text:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",w(T),T._vToNArray),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",w(T),T._flatten)]}},T.immediateMode={geometry:new c.default.Geometry,shapeMode:u.TRIANGLE_FAN,contourIndices:[],_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new c.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",w(T),T._vToNArray),new c.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",w(T),T._vToNArray),new c.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",w(T)),new c.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",w(T)),new c.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",w(T),T._flatten)],stroke:[new c.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",w(T)),new c.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",w(T)),new c.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",w(T)),new c.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",w(T)),new c.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",w(T))],point:T.GL.createBuffer()}},T.pointSize=5,T.curStrokeWeight=1,T.curStrokeCap=u.ROUND,T.curStrokeJoin=u.ROUND,T.textures=new Map,T.framebuffers=new Set,T.activeFramebuffers=[],T.filterShader=void 0,T.filterLayer=void 0,T.filterLayerTemp=void 0,T.defaultFilterShaders={},T.textureMode=u.IMAGE,T.textureWrapX=u.CLAMP,T.textureWrapY=u.CLAMP,T._tex=null,T._curveTightness=6,T._lookUpTableBezier=[],T._lookUpTableQuadratic=[],T._lutBezierDetail=0,T._lutQuadraticDetail=0,T.isProcessingVertices=!1,T._tessy=T._initTessy(),T.fontInfos={},T._curShader=void 0,T;throw new TypeError("Cannot call a class as a function")}return Q=ae,(H=[{key:"beginGeometry",value:function(){if(this.geometryBuilder)throw new Error("It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.");this.geometryBuilder=new f.default(this)}},{key:"endGeometry",value:function(){var T;if(this.geometryBuilder)return T=this.geometryBuilder.finish(),this.geometryBuilder=void 0,T;throw new Error("Make sure you call beginGeometry() before endGeometry()!")}},{key:"buildGeometry",value:function(T){return this.beginGeometry(),T(),this.endGeometry()}},{key:"_setAttributeDefaults",value:function(T){var B={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0,version:2};T._glAttributes===null?T._glAttributes=B:T._glAttributes=Object.assign(B,T._glAttributes)}},{key:"_initContext",value:function(){if(this._pInst._glAttributes.version!==1&&(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)),this.webglVersion=this.drawingContext?u.WEBGL2:u.WEBGL,this._pInst._setProperty("webglVersion",this.webglVersion),this.drawingContext||(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)),this.drawingContext===null)throw new Error("Error creating webgl context");var T=this.drawingContext;T.enable(T.DEPTH_TEST),T.depthFunc(T.LEQUAL),T.viewport(0,0,T.drawingBufferWidth,T.drawingBufferHeight),T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}},{key:"_resetContext",value:function(T,B){var W,K=this.width,te=this.height,ce=this.canvas.id,ne=this._pInst instanceof c.default.Graphics,ce=(ne?((W=this._pInst).canvas.parentNode.removeChild(W.canvas),W.canvas=document.createElement("canvas"),(W._pInst._userNode||document.body).appendChild(W.canvas),c.default.Element.call(W,W.canvas,W._pInst),W.width=K,W.height=te):((W=this.canvas)&&W.parentNode.removeChild(W),(W=document.createElement("canvas")).id=ce,(this._pInst._userNode||document.body).appendChild(W),this._pInst.canvas=W,this.canvas=W),new c.default.RendererGL(this._pInst.canvas,this._pInst,!ne));this._pInst._setProperty("_renderer",ce),ce.resize(K,te),ce._applyDefaults(),ne||this._pInst._elements.push(ce),typeof B=="function"&&setTimeout(function(){B.apply(window._renderer,T)},0)}},{key:"_update",value:function(){this.uMVMatrix.set(this._curCamera.cameraMatrix),this.ambientLightColors.length=0,this.specularColors=[1,1,1],this.directionalLightDirections.length=0,this.directionalLightDiffuseColors.length=0,this.directionalLightSpecularColors.length=0,this.pointLightPositions.length=0,this.pointLightDiffuseColors.length=0,this.pointLightSpecularColors.length=0,this.spotLightPositions.length=0,this.spotLightDirections.length=0,this.spotLightDiffuseColors.length=0,this.spotLightSpecularColors.length=0,this.spotLightAngle.length=0,this.spotLightConc.length=0,this._enableLighting=!1,this._tint=[255,255,255,255],this.GL.clearStencil(0),this.GL.clear(this.GL.DEPTH_BUFFER_BIT|this.GL.STENCIL_BUFFER_BIT),this.GL.disable(this.GL.STENCIL_TEST)}},{key:"background",value:function(){var K=(K=this._pInst).color.apply(K,arguments),T=K.levels[0]/255,B=K.levels[1]/255,W=K.levels[2]/255,K=K.levels[3]/255;this.clear(T,B,W,K)}},{key:"fill",value:function(T,B,W,K){var te=c.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=te._array,this.drawMode=u.FILL,this._useNormalMaterial=!1,this._tex=null}},{key:"stroke",value:function(T,B,W,K){var te=c.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=te._array}},{key:"strokeCap",value:function(T){this.curStrokeCap=T}},{key:"strokeJoin",value:function(T){this.curStrokeJoin=T}},{key:"getFilterLayer",value:function(){return this.filterLayer||(this.filterLayer=this._pInst.createFramebuffer()),this.filterLayer}},{key:"getFilterLayerTemp",value:function(){return this.filterLayerTemp||(this.filterLayerTemp=this._pInst.createFramebuffer()),this.filterLayerTemp}},{key:"matchSize",value:function(T,B){T.width===B.width&&T.height===B.height||T.resize(B.width,B.height),T.pixelDensity()!==B.pixelDensity()&&T.pixelDensity(B.pixelDensity())}},{key:"filter",value:function(){var T,B,W=this,K=this.getFilterLayer(),te=void 0,ne=void 0,ce=(typeof(arguments.length<=0?void 0:arguments[0])=="string"?(ne=arguments.length<=0?void 0:arguments[0],k(T={},u.BLUR,3),k(T,u.POSTERIZE,4),k(T,u.THRESHOLD,.5),te=ne in(T=T)&&(arguments.length<=1?void 0:arguments[1])===void 0?T[ne]:arguments.length<=1?void 0:arguments[1],ne in this.defaultFilterShaders||(this.defaultFilterShaders[ne]=new c.default.Shader(K._renderer,`uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

attribute vec3 aPosition;
// texcoords only come from p5 to vertex shader
// so pass texcoords on to the fragment shader in a varying variable
attribute vec2 aTexCoord;
varying vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`,G[ne])),this.filterShader=this.defaultFilterShaders[ne]):this.filterShader=arguments.length<=0?void 0:arguments[0],this.activeFramebuffer()||this),fe=(this.matchSize(K,ce),K.draw(function(){return W._pInst.clear()}),[1/(ce.width*ce.pixelDensity()),1/(ce.height*ce.pixelDensity())]);ne===u.BLUR?(B=this.getFilterLayerTemp(),this.matchSize(B,ce),this._pInst.push(),this._pInst.noStroke(),this._pInst.blendMode(u.BLEND),this._pInst.shader(this.filterShader),this.filterShader.setUniform("texelSize",fe),this.filterShader.setUniform("canvasSize",[ce.width,ce.height]),this.filterShader.setUniform("radius",Math.max(1,te)),B.draw(function(){W.filterShader.setUniform("direction",[1,0]),W.filterShader.setUniform("tex0",ce),W._pInst.clear(),W._pInst.shader(W.filterShader),W._pInst.noLights(),W._pInst.plane(ce.width,ce.height)}),K.draw(function(){W.filterShader.setUniform("direction",[0,1]),W.filterShader.setUniform("tex0",B),W._pInst.clear(),W._pInst.shader(W.filterShader),W._pInst.noLights(),W._pInst.plane(ce.width,ce.height)}),this._pInst.pop()):K.draw(function(){W._pInst.noStroke(),W._pInst.blendMode(u.BLEND),W._pInst.shader(W.filterShader),W.filterShader.setUniform("tex0",ce),W.filterShader.setUniform("texelSize",fe),W.filterShader.setUniform("canvasSize",[ce.width,ce.height]),W.filterShader.setUniform("filterParameter",te),W._pInst.noLights(),W._pInst.plane(ce.width,ce.height)}),this._pInst.push(),this._pInst.noStroke(),this.clear(),this._pInst.push(),this._pInst.imageMode(u.CORNER),this._pInst.blendMode(u.BLEND),ce.filterCamera._resize(),this._pInst.setCamera(ce.filterCamera),this._pInst.resetMatrix(),this._pInst.image(K,-ce.width/2,-ce.height/2,ce.width,ce.height),this._pInst.clearDepth(),this._pInst.pop(),this._pInst.pop()}},{key:"pixelDensity",value:function(T){return T?this._pInst.pixelDensity(T):this._pInst.pixelDensity()}},{key:"blendMode",value:function(T){T===u.DARKEST||T===u.LIGHTEST||T===u.ADD||T===u.BLEND||T===u.SUBTRACT||T===u.SCREEN||T===u.EXCLUSION||T===u.REPLACE||T===u.MULTIPLY||T===u.REMOVE?this.curBlendMode=T:T!==u.BURN&&T!==u.OVERLAY&&T!==u.HARD_LIGHT&&T!==u.SOFT_LIGHT&&T!==u.DODGE||console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}},{key:"erase",value:function(T,B){this._isErasing||(this.preEraseBlend=this.curBlendMode,this._isErasing=!0,this.blendMode(u.REMOVE),this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,T/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,B/255])}},{key:"noErase",value:function(){this._isErasing&&(this.curFillColor=this._cachedFillStyle.slice(),this.curStrokeColor=this._cachedStrokeStyle.slice(),this.curBlendMode=this.preEraseBlend,this.blendMode(this.preEraseBlend),this._isErasing=!1,this._applyBlendMode())}},{key:"drawTarget",value:function(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||this}},{key:"beginClip",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},T=(m(S(ae.prototype),"beginClip",this).call(this,T),this.drawTarget()._isClipApplied=!0,this.GL);T.clearStencil(0),T.clear(T.STENCIL_BUFFER_BIT),T.enable(T.STENCIL_TEST),this._stencilTestOn=!0,T.stencilFunc(T.ALWAYS,1,255),T.stencilOp(T.KEEP,T.KEEP,T.REPLACE),T.disable(T.DEPTH_TEST),this._pInst.push(),this._pInst.resetShader(),this._doFill&&this._pInst.fill(0,0),this._doStroke&&this._pInst.stroke(0,0)}},{key:"endClip",value:function(){this._pInst.pop();var T=this.GL;T.stencilOp(T.KEEP,T.KEEP,T.KEEP),T.stencilFunc(this._clipInvert?T.EQUAL:T.NOTEQUAL,0,255),T.enable(T.DEPTH_TEST),this._clipDepths.push(this._pushPopDepth),m(S(ae.prototype),"endClip",this).call(this)}},{key:"_clearClip",value:function(){this.GL.clearStencil(1),this.GL.clear(this.GL.STENCIL_BUFFER_BIT),0<this._clipDepths.length&&this._clipDepths.pop(),this.drawTarget()._isClipApplied=!1}},{key:"strokeWeight",value:function(T){this.curStrokeWeight!==T&&(this.pointSize=T,this.curStrokeWeight=T)}},{key:"_getPixel",value:function(T,B){var W=this.GL;return $(W,null,T,B,W.RGBA,W.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}},{key:"loadPixels",value:function(){var T,B,W=this._pixelsState;this._pInst._glAttributes.preserveDrawingBuffer!==!0?console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true."):(T=this._pInst._pixelDensity,B=this.GL,W._setProperty("pixels",Y(W.pixels,B,null,0,0,this.width*T,this.height*T,B.RGBA,B.UNSIGNED_BYTE,this.height*T)))}},{key:"updatePixels",value:function(){var T=this._getTempFramebuffer();T.pixels=this._pixelsState.pixels,T.updatePixels(),this._pInst.push(),this._pInst.resetMatrix(),this._pInst.clear(),this._pInst.imageMode(u.CENTER),this._pInst.image(T,0,0),this._pInst.pop(),this.GL.clearDepth(1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"_getTempFramebuffer",value:function(){return this._tempFramebuffer||(this._tempFramebuffer=this._pInst.createFramebuffer({format:u.UNSIGNED_BYTE,useDepth:this._pInst._glAttributes.depth,depthFormat:u.UNSIGNED_INT,antialias:this._pInst._glAttributes.antialias})),this._tempFramebuffer}},{key:"geometryInHash",value:function(T){return this.retainedMode.geometry[T]!==void 0}},{key:"viewport",value:function(T,B){this._viewport=[0,0,T,B],this.GL.viewport(0,0,T,B)}},{key:"resize",value:function(te,K){c.default.Renderer.prototype.resize.call(this,te,K),this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this._curCamera._resize();var te=this._pixelsState,W=(te.pixels!==void 0&&te._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4)),!0),K=!1,te=void 0;try{for(var ne,ce=this.framebuffers[Symbol.iterator]();!(W=(ne=ce.next()).done);W=!0)ne.value._canvasSizeChanged()}catch(fe){K=!0,te=fe}finally{try{W||ce.return==null||ce.return()}finally{if(K)throw te}}}},{key:"clear",value:function(){var T=(arguments.length<=0?void 0:arguments[0])||0,B=(arguments.length<=1?void 0:arguments[1])||0,W=(arguments.length<=2?void 0:arguments[2])||0,K=(arguments.length<=3?void 0:arguments[3])||0,te=this.activeFramebuffer();te&&te.format===u.UNSIGNED_BYTE&&!te.antialias&&K===0&&(K=1e-10),this.GL.clearColor(T*K,B*K,W*K,K),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}},{key:"clearDepth",value:function(){this.GL.clearDepth(0<arguments.length&&arguments[0]!==void 0?arguments[0]:1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"applyMatrix",value:function(T,B,W,K,te,ne){arguments.length===16?c.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments):this.uMVMatrix.apply([T,B,0,0,W,K,0,0,0,0,1,0,te,ne,0,1])}},{key:"translate",value:function(T,B,W){return T instanceof c.default.Vector&&(W=T.z,B=T.y,T=T.x),this.uMVMatrix.translate([T,B,W]),this}},{key:"scale",value:function(T,B,W){return this.uMVMatrix.scale(T,B,W),this}},{key:"rotate",value:function(T,B){return B===void 0?this.rotateZ(T):(c.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments),this)}},{key:"rotateX",value:function(T){return this.rotate(T,1,0,0),this}},{key:"rotateY",value:function(T){return this.rotate(T,0,1,0),this}},{key:"rotateZ",value:function(T){return this.rotate(T,0,0,1),this}},{key:"push",value:function(){var T=c.default.Renderer.prototype.push.apply(this),B=T.properties;return B.uMVMatrix=this.uMVMatrix.copy(),B.uPMatrix=this.uPMatrix.copy(),B._curCamera=this._curCamera,this._curCamera=this._curCamera.copy(),B.ambientLightColors=this.ambientLightColors.slice(),B.specularColors=this.specularColors.slice(),B.directionalLightDirections=this.directionalLightDirections.slice(),B.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice(),B.directionalLightSpecularColors=this.directionalLightSpecularColors.slice(),B.pointLightPositions=this.pointLightPositions.slice(),B.pointLightDiffuseColors=this.pointLightDiffuseColors.slice(),B.pointLightSpecularColors=this.pointLightSpecularColors.slice(),B.spotLightPositions=this.spotLightPositions.slice(),B.spotLightDirections=this.spotLightDirections.slice(),B.spotLightDiffuseColors=this.spotLightDiffuseColors.slice(),B.spotLightSpecularColors=this.spotLightSpecularColors.slice(),B.spotLightAngle=this.spotLightAngle.slice(),B.spotLightConc=this.spotLightConc.slice(),B.userFillShader=this.userFillShader,B.userStrokeShader=this.userStrokeShader,B.userPointShader=this.userPointShader,B.pointSize=this.pointSize,B.curStrokeWeight=this.curStrokeWeight,B.curStrokeColor=this.curStrokeColor,B.curFillColor=this.curFillColor,B.curAmbientColor=this.curAmbientColor,B.curSpecularColor=this.curSpecularColor,B.curEmissiveColor=this.curEmissiveColor,B._hasSetAmbient=this._hasSetAmbient,B._useSpecularMaterial=this._useSpecularMaterial,B._useEmissiveMaterial=this._useEmissiveMaterial,B._useShininess=this._useShininess,B._useMetalness=this._useMetalness,B.constantAttenuation=this.constantAttenuation,B.linearAttenuation=this.linearAttenuation,B.quadraticAttenuation=this.quadraticAttenuation,B._enableLighting=this._enableLighting,B._useNormalMaterial=this._useNormalMaterial,B._tex=this._tex,B.drawMode=this.drawMode,B._currentNormal=this._currentNormal,B.curBlendMode=this.curBlendMode,B.activeImageLight=this.activeImageLight,T}},{key:"pop",value:function(){var T;0<this._clipDepths.length&&this._pushPopDepth===this._clipDepths[this._clipDepths.length-1]&&this._clearClip();for(var B=arguments.length,W=new Array(B),K=0;K<B;K++)W[K]=arguments[K];(T=m(S(ae.prototype),"pop",this)).call.apply(T,[this].concat(W)),this._applyStencilTestIfClipping()}},{key:"_applyStencilTestIfClipping",value:function(){var T=this.drawTarget();T._isClipApplied!==this._stencilTestOn&&(T._isClipApplied?(this.GL.enable(this.GL.STENCIL_TEST),this._stencilTestOn=!0):(this.GL.disable(this.GL.STENCIL_TEST),this._stencilTestOn=!1))}},{key:"resetMatrix",value:function(){return this.uMVMatrix.set(this._curCamera.cameraMatrix),this}},{key:"_getImmediateStrokeShader",value:function(){var T=this.userStrokeShader;return T&&T.isStrokeShader()?T:this._getLineShader()}},{key:"_getRetainedStrokeShader",value:function(){return this._getImmediateStrokeShader()}},{key:"_getSphereMapping",value:function(T){return this.sphereMapping||(this.sphereMapping=this._pInst.createFilterShader(U)),this.uNMatrix.inverseTranspose(this.uMVMatrix),this.uNMatrix.invert3x3(this.uNMatrix),this.sphereMapping.setUniform("uFovY",this._curCamera.cameraFOV),this.sphereMapping.setUniform("uAspect",this._curCamera.aspectRatio),this.sphereMapping.setUniform("uNewNormalMatrix",this.uNMatrix.mat3),this.sphereMapping.setUniform("uSampler",T),this.sphereMapping}},{key:"_getImmediateFillShader",value:function(){var T=this.userFillShader;if(this._useNormalMaterial&&(!T||!T.isNormalShader()))return this._getNormalShader();if(this._enableLighting){if(!T||!T.isLightShader())return this._getLightShader()}else if(this._tex){if(!T||!T.isTextureShader())return this._getLightShader()}else if(!T)return this._getImmediateModeShader();return T}},{key:"_getRetainedFillShader",value:function(){if(this._useNormalMaterial)return this._getNormalShader();var T=this.userFillShader;if(this._enableLighting){if(!T||!T.isLightShader())return this._getLightShader()}else if(this._tex){if(!T||!T.isTextureShader())return this._getLightShader()}else if(!T)return this._getColorShader();return T}},{key:"_getImmediatePointShader",value:function(){var T=this.userPointShader;return T&&T.isPointShader()?T:this._getPointShader()}},{key:"_getRetainedLineShader",value:function(){return this._getImmediateLineShader()}},{key:"_getLightShader",value:function(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+F.phongVert,this._webGL2CompatibilityPrefix("frag","highp")+F.phongFrag):this._defaultLightShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+F.lightVert,this._webGL2CompatibilityPrefix("frag","highp")+F.lightTextureFrag)),this._defaultLightShader}},{key:"_getImmediateModeShader",value:function(){return this._defaultImmediateModeShader||(this._defaultImmediateModeShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.immediateVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.vertexColorFrag)),this._defaultImmediateModeShader}},{key:"_getNormalShader",value:function(){return this._defaultNormalShader||(this._defaultNormalShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.normalFrag)),this._defaultNormalShader}},{key:"_getColorShader",value:function(){return this._defaultColorShader||(this._defaultColorShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.basicFrag)),this._defaultColorShader}},{key:"_getPointShader",value:function(){return this._defaultPointShader||(this._defaultPointShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.pointVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.pointFrag)),this._defaultPointShader}},{key:"_getLineShader",value:function(){return this._defaultLineShader||(this._defaultLineShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.lineVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.lineFrag)),this._defaultLineShader}},{key:"_getFontShader",value:function(){return this._defaultFontShader||(this.webglVersion===u.WEBGL&&this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new c.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+F.fontVert,this._webGL2CompatibilityPrefix("frag","mediump")+F.fontFrag)),this._defaultFontShader}},{key:"_webGL2CompatibilityPrefix",value:function(T,B){var W="";return this.webglVersion===u.WEBGL2&&(W+=`#version 300 es
#define WEBGL2
`),T==="vert"?W+=`#define VERTEX_SHADER
`:T==="frag"&&(W+=`#define FRAGMENT_SHADER
`),B&&(W+="precision ".concat(B,` float;
`)),W}},{key:"_getEmptyTexture",value:function(){var T;return this._emptyTexture||((T=new c.default.Image(1,1)).set(0,0,255),this._emptyTexture=new c.default.Texture(this,T)),this._emptyTexture}},{key:"getTexture",value:function(T){T instanceof c.default.Framebuffer&&(T=T.color);var B=this.textures.get(T);return B||(B=new c.default.Texture(this,T),this.textures.set(T,B),B)}},{key:"getDiffusedTexture",value:function(T){var B,W,K=this;return this.diffusedTextures.get(T)!=null?this.diffusedTextures.get(T):(B=Math.floor(T.height/T.width*200),W=this._pInst.createFramebuffer({width:200,height:B,density:1}),this.diffusedShader||(this.diffusedShader=this._pInst.createShader(F.imageLightVert,F.imageLightDiffusedFrag)),W.draw(function(){K._pInst.shader(K.diffusedShader),K.diffusedShader.setUniform("environmentMap",T),K._pInst.noStroke(),K._pInst.rectMode(u.CENTER),K._pInst.noLights(),K._pInst.rect(0,0,200,B)}),this.diffusedTextures.set(T,W),W)}},{key:"getSpecularTexture",value:function(T){var B=this;if(this.specularTextures.get(T)!=null)return this.specularTextures.get(T);for(var W,K=[],te=this._pInst.createFramebuffer({width:512,height:512,density:1}),ne=Math.log(512)/Math.log(2),ce=(this.specularShader||(this.specularShader=this._pInst.createShader(F.imageLightVert,F.imageLightSpecularFrag)),512);1<=ce;ce/=2)(function(fe){te.resize(fe,fe);var ue=1-Math.log(fe)/Math.log(2)/ne;te.draw(function(){B._pInst.shader(B.specularShader),B._pInst.clear(),B.specularShader.setUniform("environmentMap",T),B.specularShader.setUniform("roughness",ue),B._pInst.noStroke(),B._pInst.noLights(),B._pInst.plane(fe,fe)}),K.push(te.get().drawingContext.getImageData(0,0,fe,fe))})(ce);return te.remove(),W=new d.MipmapTexture(this,K,{}),this.specularTextures.set(T,W),W}},{key:"activeFramebuffer",value:function(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||null}},{key:"createFramebuffer",value:function(T){return new c.default.Framebuffer(this,T)}},{key:"_setStrokeUniforms",value:function(T){T.bindShader(),T.setUniform("uUseLineColor",this._useLineColor),T.setUniform("uMaterialColor",this.curStrokeColor),T.setUniform("uStrokeWeight",this.curStrokeWeight),T.setUniform("uStrokeCap",A[this.curStrokeCap]),T.setUniform("uStrokeJoin",I[this.curStrokeJoin])}},{key:"_setFillUniforms",value:function(T){var B=this,W=(T.bindShader(),this.mixedSpecularColor=g(this.curSpecularColor),0<this._useMetalness&&(this.mixedSpecularColor=this.mixedSpecularColor.map(function(K,te){return B.curFillColor[te]*B._useMetalness+K*(1-B._useMetalness)})),T.setUniform("uUseVertexColor",this._useVertexColor),T.setUniform("uMaterialColor",this.curFillColor),T.setUniform("isTexture",!!this._tex),this._tex&&T.setUniform("uSampler",this._tex),T.setUniform("uTint",this._tint),T.setUniform("uHasSetAmbient",this._hasSetAmbient),T.setUniform("uAmbientMatColor",this.curAmbientColor),T.setUniform("uSpecularMatColor",this.mixedSpecularColor),T.setUniform("uEmissiveMatColor",this.curEmissiveColor),T.setUniform("uSpecular",this._useSpecularMaterial),T.setUniform("uEmissive",this._useEmissiveMaterial),T.setUniform("uShininess",this._useShininess),T.setUniform("metallic",this._useMetalness),this._setImageLightUniforms(T),T.setUniform("uUseLighting",this._enableLighting),this.pointLightDiffuseColors.length/3),W=(T.setUniform("uPointLightCount",W),T.setUniform("uPointLightLocation",this.pointLightPositions),T.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors),T.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors),this.directionalLightDiffuseColors.length/3),W=(T.setUniform("uDirectionalLightCount",W),T.setUniform("uLightingDirection",this.directionalLightDirections),T.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors),T.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors),this.ambientLightColors.length/3),W=(this.mixedAmbientLight=g(this.ambientLightColors),0<this._useMetalness&&(this.mixedAmbientLight=this.mixedAmbientLight.map(function(K){return K-=B._useMetalness,Math.max(0,K)})),T.setUniform("uAmbientLightCount",W),T.setUniform("uAmbientColor",this.mixedAmbientLight),this.spotLightDiffuseColors.length/3);T.setUniform("uSpotLightCount",W),T.setUniform("uSpotLightAngle",this.spotLightAngle),T.setUniform("uSpotLightConc",this.spotLightConc),T.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors),T.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors),T.setUniform("uSpotLightLocation",this.spotLightPositions),T.setUniform("uSpotLightDirection",this.spotLightDirections),T.setUniform("uConstantAttenuation",this.constantAttenuation),T.setUniform("uLinearAttenuation",this.linearAttenuation),T.setUniform("uQuadraticAttenuation",this.quadraticAttenuation),T.bindTextures()}},{key:"_setImageLightUniforms",value:function(T){var B,W;T.setUniform("uUseImageLight",this.activeImageLight!=null),this.activeImageLight&&(B=this.getDiffusedTexture(this.activeImageLight),T.setUniform("environmentMapDiffused",B),B=this.getSpecularTexture(this.activeImageLight),W=20/this._useShininess,T.setUniform("levelOfDetail",8*W),T.setUniform("environmentMapSpecular",B))}},{key:"_setPointUniforms",value:function(T){T.bindShader(),T.setUniform("uMaterialColor",this.curStrokeColor),T.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)}},{key:"_bindBuffer",value:function(T,B,W,K,te){B=B||this.GL.ARRAY_BUFFER,this.GL.bindBuffer(B,T),W!==void 0&&((T=W)instanceof c.default.DataArray?T=W.dataArray():T instanceof(K||Float32Array)||(T=new(K||Float32Array)(T)),this.GL.bufferData(B,T,te||this.GL.STATIC_DRAW))}},{key:"_arraysEqual",value:function(T,B){return T.length===B.length&&T.every(function(W,K){return W===B[K]})}},{key:"_isTypedArray",value:function(T){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some(function(B){return T instanceof B})}},{key:"_flatten",value:function(T){return T.flat()}},{key:"_vToNArray",value:function(T){return T.flatMap(function(B){return[B.x,B.y,B.z]})}},{key:"_bezierCoefficients",value:function(T){var B=T*T,W=1-T,K=W*W;return[K*W,3*K*T,3*W*B,B*T]}},{key:"_quadraticCoefficients",value:function(T){var B=1-T;return[B*B,2*B*T,T*T]}},{key:"_bezierToCatmull",value:function(T){return[T[1],T[1]+(T[2]-T[0])/this._curveTightness,T[2]-(T[3]-T[1])/this._curveTightness,T[2]]}},{key:"_initTessy",value:function(){var T=new h.default.GluTesselator;return T.gluTessCallback(h.default.gluEnum.GLU_TESS_VERTEX_DATA,function(B,W){var K=!0,te=!1,ne=void 0;try{for(var ce,fe=B[Symbol.iterator]();!(K=(ce=fe.next()).done);K=!0){var ue=ce.value;W.push(ue)}}catch(ge){te=!0,ne=ge}finally{try{K||fe.return==null||fe.return()}finally{if(te)throw ne}}}),T.gluTessCallback(h.default.gluEnum.GLU_TESS_BEGIN,function(B){B!==h.default.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: ".concat(B))}),T.gluTessCallback(h.default.gluEnum.GLU_TESS_ERROR,function(B){console.log("error callback"),console.log("error number: ".concat(B))}),T.gluTessCallback(h.default.gluEnum.GLU_TESS_COMBINE,function(B,W,K){for(var te=new Array(c.default.RendererGL.prototype.tessyVertexSize).fill(0),ne=0;ne<K.length;ne++)for(var ce=0;ce<te.length;ce++)K[ne]!==0&&W[ne]&&(te[ce]+=W[ne][ce]*K[ne]);return te}),T.gluTessCallback(h.default.gluEnum.GLU_TESS_EDGE_FLAG,function(B){}),T.gluTessProperty(h.default.gluEnum.GLU_TESS_WINDING_RULE,h.default.windingRule.GLU_TESS_WINDING_NONZERO),T}},{key:"_triangulate",value:function(T){var B=T[0]?T[0][2]:void 0,W=!0,K=!0,ue=!1,me=void 0;try{for(var te,ne=T[Symbol.iterator]();!(K=(te=ne.next()).done);K=!0)for(var ce=te.value,fe=0;fe<ce.length;fe+=c.default.RendererGL.prototype.tessyVertexSize)if(ce[fe+2]!==B){W=!1;break}}catch(Ae){ue=!0,me=Ae}finally{try{K||ne.return==null||ne.return()}finally{if(ue)throw me}}W?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0);var ue=[],ge=(this._tessy.gluTessBeginPolygon(ue),!0),me=!1,oe=void 0;try{for(var de,xe=T[Symbol.iterator]();!(ge=(de=xe.next()).done);ge=!0){var Ie=de.value;this._tessy.gluTessBeginContour();for(var we=0;we<Ie.length;we+=c.default.RendererGL.prototype.tessyVertexSize){var _e=Ie.slice(we,we+c.default.RendererGL.prototype.tessyVertexSize);this._tessy.gluTessVertex(_e,_e)}this._tessy.gluTessEndContour()}}catch(Ae){me=!0,oe=Ae}finally{try{ge||xe.return==null||xe.return()}finally{if(me)throw oe}}return this._tessy.gluTessEndPolygon(),ue}}])&&b(Q.prototype,H),ae}(c.default.Renderer),c.default.prototype._assert3d=function(H){if(!this._renderer.isP3D)throw new Error("".concat(H,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))},c.default.RendererGL.prototype.tessyVertexSize=12,O=c.default.RendererGL,a.default=O},{"../core/constants":269,"../core/main":280,"../core/p5.Renderer":283,"./GeometryBuilder":324,"./p5.Camera":329,"./p5.Framebuffer":331,"./p5.Matrix":333,"./p5.Shader":338,"./p5.Texture":339,"core-js/modules/es.array.concat":152,"core-js/modules/es.array.copy-within":153,"core-js/modules/es.array.every":154,"core-js/modules/es.array.fill":155,"core-js/modules/es.array.flat":159,"core-js/modules/es.array.flat-map":158,"core-js/modules/es.array.from":161,"core-js/modules/es.array.includes":162,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.map":167,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.array.unscopables.flat":172,"core-js/modules/es.array.unscopables.flat-map":171,"core-js/modules/es.map":174,"core-js/modules/es.object.assign":181,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.reflect.get":190,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.set":194,"core-js/modules/es.string.includes":196,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.float32-array":216,"core-js/modules/es.typed-array.float64-array":217,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.int16-array":221,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint16-array":237,"core-js/modules/es.typed-array.uint32-array":238,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243,libtess:252,path:255}],338:[function(r,s,a){r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.index-of"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.slice"),r("core-js/modules/es.array.some"),r("core-js/modules/es.function.name"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=(r=r("../core/main"))&&r.__esModule?r:{default:r};function l(c,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(c,h.key,h)}}i.default.Shader=function(){function c(h,d,p){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._renderer=h,this._vertSrc=d,this._fragSrc=p,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[]}var u,f;return u=c,(f=[{key:"init",value:function(){if(this._glProgram===0){var h=this._renderer.GL;if(this._vertShader=h.createShader(h.VERTEX_SHADER),h.shaderSource(this._vertShader,this._vertSrc),h.compileShader(this._vertShader),!h.getShaderParameter(this._vertShader,h.COMPILE_STATUS))return i.default._friendlyError("Yikes! An error occurred compiling the vertex shader:".concat(h.getShaderInfoLog(this._vertShader))),null;if(this._fragShader=h.createShader(h.FRAGMENT_SHADER),h.shaderSource(this._fragShader,this._fragSrc),h.compileShader(this._fragShader),!h.getShaderParameter(this._fragShader,h.COMPILE_STATUS))return i.default._friendlyError("Darn! An error occurred compiling the fragment shader:".concat(h.getShaderInfoLog(this._fragShader))),null;this._glProgram=h.createProgram(),h.attachShader(this._glProgram,this._vertShader),h.attachShader(this._glProgram,this._fragShader),h.linkProgram(this._glProgram),h.getProgramParameter(this._glProgram,h.LINK_STATUS)||i.default._friendlyError("Snap! Error linking shader program: ".concat(h.getProgramInfoLog(this._glProgram))),this._loadAttributes(),this._loadUniforms()}return this}},{key:"copyToContext",value:function(h){var d=new i.default.Shader(h._renderer,this._vertSrc,this._fragSrc);return d.ensureCompiledOnContext(h),d}},{key:"ensureCompiledOnContext",value:function(h){if(this._glProgram!==0&&this._renderer!==h._renderer)throw new Error("The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?");this._glProgram===0&&(this._renderer=h._renderer,this.init())}},{key:"_loadAttributes",value:function(){if(!this._loadedAttributes){this.attributes={};for(var h=this._renderer.GL,d=h.getProgramParameter(this._glProgram,h.ACTIVE_ATTRIBUTES),p=0;p<d;++p){var y=h.getActiveAttrib(this._glProgram,p),g=y.name,b=h.getAttribLocation(this._glProgram,g),m={};m.name=g,m.location=b,m.index=p,m.type=y.type,m.size=y.size,this.attributes[g]=m}this._loadedAttributes=!0}}},{key:"_loadUniforms",value:function(){if(!this._loadedUniforms){for(var h=this._renderer.GL,d=h.getProgramParameter(this._glProgram,h.ACTIVE_UNIFORMS),p=0,y=0;y<d;++y){var g=h.getActiveUniform(this._glProgram,y),b={},m=(b.location=h.getUniformLocation(this._glProgram,g.name),b.size=g.size,g.name);1<g.size&&(m=m.substring(0,m.indexOf("[0]"))),b.name=m,b.type=g.type,b._cachedData=void 0,b.type===h.SAMPLER_2D&&(b.samplerIndex=p,p++,this.samplers.push(b)),b.isArray=1<g.size||b.type===h.FLOAT_MAT3||b.type===h.FLOAT_MAT4||b.type===h.FLOAT_VEC2||b.type===h.FLOAT_VEC3||b.type===h.FLOAT_VEC4||b.type===h.INT_VEC2||b.type===h.INT_VEC4||b.type===h.INT_VEC3,this.uniforms[m]=b}this._loadedUniforms=!0}}},{key:"compile",value:function(){}},{key:"bindShader",value:function(){this.init(),this._bound||(this.useProgram(),this._bound=!0,this._setMatrixUniforms(),this.setUniform("uViewport",this._renderer._viewport))}},{key:"unbindShader",value:function(){return this._bound&&(this.unbindTextures(),this._bound=!1),this}},{key:"bindTextures",value:function(){var h=this._renderer.GL,d=!0,p=!1,y=void 0;try{for(var g,b=this.samplers[Symbol.iterator]();!(d=(g=b.next()).done);d=!0){var m=g.value,v=m.texture;v===void 0&&(v=this._renderer._getEmptyTexture()),h.activeTexture(h.TEXTURE0+m.samplerIndex),v.bindTexture(),v.update(),h.uniform1i(m.location,m.samplerIndex)}}catch(x){p=!0,y=x}finally{try{d||b.return==null||b.return()}finally{if(p)throw y}}}},{key:"updateTextures",value:function(){var h=!0,d=!1,p=void 0;try{for(var y,g=this.samplers[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var b=y.value.texture;b&&b.update()}}catch(m){d=!0,p=m}finally{try{h||g.return==null||g.return()}finally{if(d)throw p}}}},{key:"unbindTextures",value:function(){var h=!0,d=!1,p=void 0;try{for(var y,g=this.samplers[Symbol.iterator]();!(h=(y=g.next()).done);h=!0){var b=y.value;this.setUniform(b.name,this._renderer._getEmptyTexture())}}catch(m){d=!0,p=m}finally{try{h||g.return==null||g.return()}finally{if(d)throw p}}}},{key:"_setMatrixUniforms",value:function(){var h=this._renderer._curCamera.cameraMatrix,d=this._renderer.uPMatrix,p=this._renderer.uMVMatrix,y=p.copy();y.mult(d),this.isStrokeShader()&&(this._renderer._curCamera.cameraType==="default"?this.setUniform("uPerspective",1):this.setUniform("uPerspective",0)),this.setUniform("uViewMatrix",h.mat4),this.setUniform("uProjectionMatrix",d.mat4),this.setUniform("uModelViewMatrix",p.mat4),this.setUniform("uModelViewProjectionMatrix",y.mat4),this.uniforms.uNormalMatrix&&(this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix),this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3)),this.uniforms.uCameraRotation&&(this._renderer.curMatrix.inverseTranspose(this._renderer._curCamera.cameraMatrix),this.setUniform("uCameraRotation",this._renderer.curMatrix.mat3))}},{key:"useProgram",value:function(){var h=this._renderer.GL;return this._renderer._curShader!==this&&(h.useProgram(this._glProgram),this._renderer._curShader=this),this}},{key:"setUniform",value:function(h,d){var p=this.uniforms[h];if(p){var y=this._renderer.GL;if(p.isArray){if(p._cachedData&&this._renderer._arraysEqual(p._cachedData,d))return;p._cachedData=d.slice(0)}else{if(p._cachedData&&p._cachedData===d)return;Array.isArray(d)?p._cachedData=d.slice(0):p._cachedData=d}var g=p.location;switch(this.useProgram(),p.type){case y.BOOL:d===!0?y.uniform1i(g,1):y.uniform1i(g,0);break;case y.INT:1<p.size?d.length&&y.uniform1iv(g,d):y.uniform1i(g,d);break;case y.FLOAT:1<p.size?d.length&&y.uniform1fv(g,d):y.uniform1f(g,d);break;case y.FLOAT_MAT3:y.uniformMatrix3fv(g,!1,d);break;case y.FLOAT_MAT4:y.uniformMatrix4fv(g,!1,d);break;case y.FLOAT_VEC2:1<p.size?d.length&&y.uniform2fv(g,d):y.uniform2f(g,d[0],d[1]);break;case y.FLOAT_VEC3:1<p.size?d.length&&y.uniform3fv(g,d):y.uniform3f(g,d[0],d[1],d[2]);break;case y.FLOAT_VEC4:1<p.size?d.length&&y.uniform4fv(g,d):y.uniform4f(g,d[0],d[1],d[2],d[3]);break;case y.INT_VEC2:1<p.size?d.length&&y.uniform2iv(g,d):y.uniform2i(g,d[0],d[1]);break;case y.INT_VEC3:1<p.size?d.length&&y.uniform3iv(g,d):y.uniform3i(g,d[0],d[1],d[2]);break;case y.INT_VEC4:1<p.size?d.length&&y.uniform4iv(g,d):y.uniform4i(g,d[0],d[1],d[2],d[3]);break;case y.SAMPLER_2D:y.activeTexture(y.TEXTURE0+p.samplerIndex),p.texture=d instanceof i.default.Texture?d:this._renderer.getTexture(d),y.uniform1i(g,p.samplerIndex),p.texture.src.gifProperties&&p.texture.src._animateGif(this._renderer._pInst)}return this}}},{key:"isLightShader",value:function(){return[this.attributes.aNormal,this.uniforms.uUseLighting,this.uniforms.uAmbientLightCount,this.uniforms.uDirectionalLightCount,this.uniforms.uPointLightCount,this.uniforms.uAmbientColor,this.uniforms.uDirectionalDiffuseColors,this.uniforms.uDirectionalSpecularColors,this.uniforms.uPointLightLocation,this.uniforms.uPointLightDiffuseColors,this.uniforms.uPointLightSpecularColors,this.uniforms.uLightingDirection,this.uniforms.uSpecular].some(function(h){return h!==void 0})}},{key:"isNormalShader",value:function(){return this.attributes.aNormal!==void 0}},{key:"isTextureShader",value:function(){return 0<this.samplers.length}},{key:"isColorShader",value:function(){return this.attributes.aVertexColor!==void 0||this.uniforms.uMaterialColor!==void 0}},{key:"isTexLightShader",value:function(){return this.isLightShader()&&this.isTextureShader()}},{key:"isStrokeShader",value:function(){return this.uniforms.uStrokeWeight!==void 0}},{key:"enableAttrib",value:function(h,d,p,y,g,b){var m;return h&&(h=h.location)!==-1&&(m=this._renderer.GL,this._renderer.registerEnabled.has(h)||(m.enableVertexAttribArray(h),this._renderer.registerEnabled.add(h)),this._renderer.GL.vertexAttribPointer(h,d,p||m.FLOAT,y||!1,g||0,b||0)),this}},{key:"disableRemainingAttributes",value:function(){var h=this,d=!0,p=!1,y=void 0;try{for(var g,b=this._renderer.registerEnabled.values()[Symbol.iterator]();!(d=(g=b.next()).done);d=!0)(function(){var m=g.value;Object.keys(h.attributes).some(function(v){return h.attributes[v].location===m})||(h._renderer.GL.disableVertexAttribArray(m),h._renderer.registerEnabled.delete(m))})()}catch(m){p=!0,y=m}finally{try{d||b.return==null||b.return()}finally{if(p)throw y}}}}])&&l(u.prototype,f),c}(),r=i.default.Shader,a.default=r},{"../core/main":280,"core-js/modules/es.array.index-of":163,"core-js/modules/es.array.iterator":164,"core-js/modules/es.array.slice":168,"core-js/modules/es.array.some":169,"core-js/modules/es.function.name":173,"core-js/modules/es.object.keys":186,"core-js/modules/es.object.to-string":187,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/web.dom-collections.iterator":243}],339:[function(r,s,a){function i(x){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(x)}function l(x){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(w){return i(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":i(w)})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.get-prototype-of"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.reflect.construct"),r("core-js/modules/es.regexp.to-string"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.typed-array.uint8-array"),r("core-js/modules/es.typed-array.copy-within"),r("core-js/modules/es.typed-array.every"),r("core-js/modules/es.typed-array.fill"),r("core-js/modules/es.typed-array.filter"),r("core-js/modules/es.typed-array.find"),r("core-js/modules/es.typed-array.find-index"),r("core-js/modules/es.typed-array.for-each"),r("core-js/modules/es.typed-array.includes"),r("core-js/modules/es.typed-array.index-of"),r("core-js/modules/es.typed-array.iterator"),r("core-js/modules/es.typed-array.join"),r("core-js/modules/es.typed-array.last-index-of"),r("core-js/modules/es.typed-array.map"),r("core-js/modules/es.typed-array.reduce"),r("core-js/modules/es.typed-array.reduce-right"),r("core-js/modules/es.typed-array.reverse"),r("core-js/modules/es.typed-array.set"),r("core-js/modules/es.typed-array.slice"),r("core-js/modules/es.typed-array.some"),r("core-js/modules/es.typed-array.sort"),r("core-js/modules/es.typed-array.subarray"),r("core-js/modules/es.typed-array.to-locale-string"),r("core-js/modules/es.typed-array.to-string"),Object.defineProperty(a,"__esModule",{value:!0}),a.checkWebGLCapabilities=v,a.default=a.MipmapTexture=void 0;var c=(m=r("../core/main"))&&m.__esModule?m:{default:m},u=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var w=f();if(w&&w.has(x))return w.get(x);var S,k={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in x){var C;Object.prototype.hasOwnProperty.call(x,S)&&((C=_?Object.getOwnPropertyDescriptor(x,S):null)&&(C.get||C.set)?Object.defineProperty(k,S,C):k[S]=x[S])}return k.default=x,w&&w.set(x,k),k}(r("../core/constants"));function f(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,f=function(){return x},x)}function h(x,w){return(h=Object.setPrototypeOf||function(S,k){return S.__proto__=k,S})(x,w)}function d(x){return function(){var w,S=p(x),S=(w=function(){if(typeof Reflect<"u"&&Reflect.construct&&!Reflect.construct.sham){if(typeof Proxy=="function")return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch{}}}()?(w=p(this).constructor,Reflect.construct(S,arguments,w)):S.apply(this,arguments),this);if(!w||l(w)!=="object"&&typeof w!="function"){if(S!==void 0)return S;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return w}}function p(x){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(x)}function y(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function g(x,w){for(var S=0;S<w.length;S++){var k=w[S];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}function b(x,w,S){w&&g(x.prototype,w),S&&g(x,S)}c.default.Texture=function(){function x(P,S,C){y(this,x),this._renderer=P;var _=this._renderer.GL,C=(C=C||{},this.src=S,this.glTex=void 0,this.glTarget=_.TEXTURE_2D,this.glFormat=C.format||_.RGBA,this.mipmaps=!1,this.glMinFilter=C.minFilter||_.LINEAR,this.glMagFilter=C.magFilter||_.LINEAR,this.glWrapS=C.wrapS||_.CLAMP_TO_EDGE,this.glWrapT=C.wrapT||_.CLAMP_TO_EDGE,this.glDataType=C.dataType||_.UNSIGNED_BYTE,v(P)),P=(this.glFormat!==_.HALF_FLOAT||C.halfFloat||(console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT."),this.glDataType=_.FLOAT),this.glFormat!==_.HALF_FLOAT||this.glMinFilter!==_.LINEAR&&this.glMagFilter!==_.LINEAR||C.halfFloatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===_.LINEAR&&(this.glMinFilter=_.NEAREST),this.glMagFilter===_.LINEAR&&(this.glMagFilter=_.NEAREST)),this.glFormat!==_.FLOAT||C.float||(console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE."),this.glDataType=_.UNSIGNED_BYTE),this.glFormat!==_.FLOAT||this.glMinFilter!==_.LINEAR&&this.glMagFilter!==_.LINEAR||C.floatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===_.LINEAR&&(this.glMinFilter=_.NEAREST),this.glMagFilter===_.LINEAR&&(this.glMagFilter=_.NEAREST)),this.isSrcMediaElement=c.default.MediaElement!==void 0&&S instanceof c.default.MediaElement,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=c.default.Element!==void 0&&S instanceof c.default.Element&&!(S instanceof c.default.Graphics)&&!(S instanceof c.default.Renderer),this.isSrcP5Image=S instanceof c.default.Image,this.isSrcP5Graphics=S instanceof c.default.Graphics,this.isSrcP5Renderer=S instanceof c.default.Renderer,this.isImageData=typeof ImageData<"u"&&S instanceof ImageData,this.isFramebufferTexture=S instanceof c.default.FramebufferTexture,this._getTextureDataFromSource());return this.width=P.width,this.height=P.height,this.init(P),this}return b(x,[{key:"_getTextureDataFromSource",value:function(){var w;return this.isFramebufferTexture?w=this.src.rawTexture():this.isSrcP5Image?w=this.src.canvas:this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcP5Renderer||this.isSrcHTMLElement?w=this.src.elt:this.isImageData&&(w=this.src),w}},{key:"init",value:function(w){var S,k=this._renderer.GL;this.isFramebufferTexture||(this.glTex=k.createTexture()),this.glWrapS=this._renderer.textureWrapX,this.glWrapT=this._renderer.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,this.glMagFilter),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,this.glMinFilter),this.isFramebufferTexture||(this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata?(S=new Uint8Array([1,1,1,1]),k.texImage2D(this.glTarget,0,k.RGBA,1,1,0,this.glFormat,this.glDataType,S)):k.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,w))}},{key:"update",value:function(){var w,S,k,_=this.src;return _.width!==0&&_.height!==0&&!this.isFramebufferTexture&&(w=this._getTextureDataFromSource(),S=!1,k=this._renderer.GL,w.width!==this.width||w.height!==this.height?(S=!0,this.width=w.width||_.width,this.height=w.height||_.height,this.isSrcP5Image?_.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&_.setModified(!0)):this.isSrcP5Image?_.isModified()&&_.setModified(!(S=!0)):this.isSrcMediaElement?_.isModified()?_.setModified(!(S=!0)):_.loadedmetadata&&this._videoPrevUpdateTime!==_.time()&&(this._videoPrevUpdateTime=_.time(),S=!0):this.isImageData?_._dirty&&(S=!(_._dirty=!1)):S=!0,S&&(this.bindTexture(),k.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,w)),S)}},{key:"bindTexture",value:function(){return this._renderer.GL.bindTexture(this.glTarget,this.getTexture()),this}},{key:"unbindTexture",value:function(){this._renderer.GL.bindTexture(this.glTarget,null)}},{key:"getTexture",value:function(){return this.isFramebufferTexture?this.src.rawTexture():this.glTex}},{key:"setInterpolation",value:function(w,S){var k=this._renderer.GL;this.glMinFilter=this.glFilter(w),this.glMagFilter=this.glFilter(S),this.bindTexture(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,this.glMinFilter),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()}},{key:"glFilter",value:function(w){var S=this._renderer.GL;return w===u.NEAREST?S.NEAREST:S.LINEAR}},{key:"setWrapMode",value:function(w,S){function k(A){return(A&A-1)==0}var _=this._renderer.GL,P=this._getTextureDataFromSource(),P=P.naturalWidth&&P.naturalHeight?(C=P.naturalWidth,P.naturalHeight):(C=this.width,this.height),C=k(C),P=k(P);w===u.REPEAT?this._renderer.webglVersion===u.WEBGL2||C&&P?this.glWrapS=_.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=_.CLAMP_TO_EDGE):w===u.MIRROR?this._renderer.webglVersion===u.WEBGL2||C&&P?this.glWrapS=_.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=_.CLAMP_TO_EDGE):this.glWrapS=_.CLAMP_TO_EDGE,S===u.REPEAT?this._renderer.webglVersion===u.WEBGL2||C&&P?this.glWrapT=_.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=_.CLAMP_TO_EDGE):S===u.MIRROR?this._renderer.webglVersion===u.WEBGL2||C&&P?this.glWrapT=_.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=_.CLAMP_TO_EDGE):this.glWrapT=_.CLAMP_TO_EDGE,this.bindTexture(),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this.glWrapS),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()}}]),x}();var m=function(x){var w=k;if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(x&&x.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),x&&h(w,x);var S=d(k);function k(_,C,P){return y(this,k),C=(_=S.call(this,_,C,P))._renderer.GL,_.glMinFilter===C.LINEAR&&(_.glMinFilter=C.LINEAR_MIPMAP_LINEAR),_}return b(k,[{key:"glFilter",value:function(_){return this._renderer.GL.LINEAR_MIPMAP_LINEAR}},{key:"_getTextureDataFromSource",value:function(){return this.src}},{key:"init",value:function(_){var C=this._renderer.GL;this.glTex=C.createTexture(),this.bindTexture();for(var P=0;P<_.length;P++)C.texImage2D(this.glTarget,P,this.glFormat,this.glFormat,this.glDataType,_[P]);this.glMinFilter=C.LINEAR_MIPMAP_LINEAR,C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,this.glMagFilter),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,this.glMinFilter),this.unbindTexture()}},{key:"update",value:function(){}}]),k}(c.default.Texture);function v(_){var w=_.GL,_=_.webglVersion,S=_===u.WEBGL2?w.getExtension("EXT_color_buffer_float")&&w.getExtension("EXT_float_blend"):w.getExtension("OES_texture_float"),k=S&&w.getExtension("OES_texture_float_linear"),_=_===u.WEBGL2?w.getExtension("EXT_color_buffer_float"):w.getExtension("OES_texture_half_float");return{float:S,floatLinear:k,halfFloat:_,halfFloatLinear:_&&w.getExtension("OES_texture_half_float_linear")}}a.MipmapTexture=m,r=c.default.Texture,a.default=r},{"../core/constants":269,"../core/main":280,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.get-prototype-of":185,"core-js/modules/es.object.to-string":187,"core-js/modules/es.reflect.construct":189,"core-js/modules/es.regexp.to-string":193,"core-js/modules/es.string.iterator":197,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.typed-array.copy-within":210,"core-js/modules/es.typed-array.every":211,"core-js/modules/es.typed-array.fill":212,"core-js/modules/es.typed-array.filter":213,"core-js/modules/es.typed-array.find":215,"core-js/modules/es.typed-array.find-index":214,"core-js/modules/es.typed-array.for-each":218,"core-js/modules/es.typed-array.includes":219,"core-js/modules/es.typed-array.index-of":220,"core-js/modules/es.typed-array.iterator":223,"core-js/modules/es.typed-array.join":224,"core-js/modules/es.typed-array.last-index-of":225,"core-js/modules/es.typed-array.map":226,"core-js/modules/es.typed-array.reduce":228,"core-js/modules/es.typed-array.reduce-right":227,"core-js/modules/es.typed-array.reverse":229,"core-js/modules/es.typed-array.set":230,"core-js/modules/es.typed-array.slice":231,"core-js/modules/es.typed-array.some":232,"core-js/modules/es.typed-array.sort":233,"core-js/modules/es.typed-array.subarray":234,"core-js/modules/es.typed-array.to-locale-string":235,"core-js/modules/es.typed-array.to-string":236,"core-js/modules/es.typed-array.uint8-array":239,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}],340:[function(r,s,a){function i(x){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(x)}function l(x){return(l=typeof Symbol=="function"&&i(Symbol.iterator)==="symbol"?function(w){return i(w)}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":i(w)})(x)}r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.get-own-property-descriptor"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.sub"),r("core-js/modules/es.weak-map"),r("core-js/modules/web.dom-collections.iterator"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.description"),r("core-js/modules/es.symbol.iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.object.to-string"),r("core-js/modules/es.regexp.exec"),r("core-js/modules/es.string.iterator"),r("core-js/modules/es.string.split"),r("core-js/modules/es.string.sub"),r("core-js/modules/web.dom-collections.iterator");var c,u=(c=r("../core/main"))&&c.__esModule?c:{default:c},f=function(x){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var w=h();if(w&&w.has(x))return w.get(x);var S,k={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(S in x){var C;Object.prototype.hasOwnProperty.call(x,S)&&((C=_?Object.getOwnPropertyDescriptor(x,S):null)&&(C.get||C.set)?Object.defineProperty(k,S,C):k[S]=x[S])}return k.default=x,w&&w.set(x,k),k}(r("../core/constants"));function h(){var x;return typeof WeakMap!="function"?null:(x=new WeakMap,h=function(){return x},x)}function d(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function p(x,w){for(var S=0;S<w.length;S++){var k=w[S];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(x,k.key,k)}}function y(x,w,S){w&&p(x.prototype,w),S&&p(x,S)}r("./p5.Shader"),r("./p5.RendererGL.Retained"),u.default.RendererGL.prototype._applyTextProperties=function(){},u.default.RendererGL.prototype.textWidth=function(x){return this._isOpenType()?this._textFont._textWidth(x,this._textSize):0};var g=function(){function x(w,S){d(this,x),this.width=w,this.height=S,this.infos=[]}return y(x,[{key:"findImage",value:function(w){var S,k,_=this.width*this.height;if(_<w)throw new Error("font is too complex to render in 3D");for(var C=this.infos.length-1;0<=C;--C){var P=this.infos[C];if(P.index+w<_){k=(S=P).imageData;break}}if(!S){try{k=new ImageData(this.width,this.height)}catch{var A=document.getElementsByTagName("canvas")[0],I=!A,N=(A||((A=document.createElement("canvas")).style.display="none",document.body.appendChild(A)),A.getContext("2d"));N&&(k=N.createImageData(this.width,this.height)),I&&document.body.removeChild(A)}this.infos.push(S={index:0,imageData:k})}return N=S.index,S.index+=w,k._dirty=!0,{imageData:k,index:N}}}]),x}();function b(P,w,S,k,_){var C=P.imageData.data,P=4*P.index++;C[P++]=w,C[P++]=S,C[P++]=k,C[+P]=_}var m=Math.sqrt(3),v=function(){function x(w){d(this,x),this.font=w,this.strokeImageInfos=new g(64,64),this.colDimImageInfos=new g(64,64),this.rowDimImageInfos=new g(64,64),this.colCellImageInfos=new g(64,64),this.rowCellImageInfos=new g(64,64),this.glyphInfos={}}return y(x,[{key:"getGlyphInfo",value:function(w){var S=this.glyphInfos[w.index];if(!S){var k=w.getBoundingBox(),_=k.x1,C=k.y1,P=k.x2-_,A=k.y2-C,I=w.path.commands;if(P==0||A==0||!I.length)return this.glyphInfos[w.index]={};for(var N=[],O=[],F=[],U=8;0<=U;--U)F.push([]);for(U=8;0<=U;--U)O.push([]);var G,Y,$,H,Q=function(){function tt(rt,it,nt,Ee){d(this,tt),this.p0=rt,this.c0=it,this.c1=nt,this.p1=Ee}return y(tt,[{key:"toQuadratic",value:function(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:(3*(this.c0.x+this.c1.x)-(this.p0.x+this.p1.x))/4,cy:(3*(this.c0.y+this.c1.y)-(this.p0.y+this.p1.y))/4}}},{key:"quadError",value:function(){return u.default.Vector.sub(u.default.Vector.sub(this.p1,this.p0),u.default.Vector.mult(u.default.Vector.sub(this.c1,this.c0),3)).mag()/2}},{key:"split",value:function(Ve){var it=u.default.Vector.lerp(this.p0,this.c0,Ve),Ee=u.default.Vector.lerp(this.c0,this.c1,Ve),nt=u.default.Vector.lerp(it,Ee,Ve),Ee=(this.c1=u.default.Vector.lerp(this.c1,this.p1,Ve),this.c0=u.default.Vector.lerp(Ee,this.c1,Ve),u.default.Vector.lerp(nt,this.c0,Ve)),Ve=new tt(this.p0,it,nt,Ee);return this.p0=Ee,Ve}},{key:"splitInflections",value:function(){var rt=u.default.Vector.sub(this.c0,this.p0),it=u.default.Vector.sub(u.default.Vector.sub(this.c1,this.c0),rt),nt=u.default.Vector.sub(u.default.Vector.sub(u.default.Vector.sub(this.p1,this.c1),rt),u.default.Vector.mult(it,2)),Ee=[],Ve=it.x*nt.y-it.y*nt.x;return Ve!==0&&0<=(rt=(nt=rt.x*nt.y-rt.y*nt.x)*nt-4*Ve*(rt.x*it.y-rt.y*it.x))&&(Ve<0&&(Ve=-Ve,nt=-nt),rt=(-nt+(it=Math.sqrt(rt)))/(2*Ve),0<(nt=(-nt-it)/(2*Ve))&&nt<1&&(Ee.push(this.split(nt)),rt=1-(1-rt)/(1-nt)),0<rt&&rt<1&&Ee.push(this.split(rt))),Ee.push(this),Ee}}]),tt}(),J=!0,ae=!1,T=void 0;try{for(var B,W=I[Symbol.iterator]();!(J=(B=W.next()).done);J=!0){var K=B.value,te=(K.x-_)/P,ne=(K.y-C)/A;if(!Fe(G,Y,te,ne)){switch(K.type){case"M":$=te,H=ne;break;case"L":$e(G,Y,te,ne);break;case"Q":var ce=(K.x1-_)/P,fe=(K.y1-C)/A;_e([G,te,ce],[Y,ne,fe],{x:G,y:Y,cx:ce,cy:fe});break;case"Z":Fe(G,Y,$,H)?N.push({x:G,y:Y}):($e(G,Y,$,H),N.push({x:$,y:H}));break;case"C":for(var ue=function(ie,Pe,Ue,nt,Ee,Ve,Me,re){var ie=new Q(new u.default.Vector(ie,Pe),new u.default.Vector(Ue,nt),new u.default.Vector(Ee,Ve),new u.default.Vector(Me,re)).splitInflections(),ee=[],le=30/m,Se=!0,Pe=!1,Ue=void 0;try{for(var Xe,Ze=ie[Symbol.iterator]();!(Se=(Xe=Ze.next()).done);Se=!0){for(var et=Xe.value,at=[],At=void 0;!(.125<=(At=le/et.quadError()));){var Et=Math.pow(At,.3333333333333333),dt=et.split(Et),Ct=et.split(1-Et/(1-Et));ee.push(dt),at.push(et),et=Ct}At<1&&ee.push(et.split(.5)),ee.push(et),Array.prototype.push.apply(ee,at.reverse())}}catch(kt){Pe=!0,Ue=kt}finally{try{Se||Ze.return==null||Ze.return()}finally{if(Pe)throw Ue}}return ee}(G,Y,(K.x1-_)/P,(K.y1-C)/A,(K.x2-_)/P,(K.y2-C)/A,te,ne),ge=0;ge<ue.length;ge++){var me=ue[ge].toQuadratic();_e([me.x,me.x1,me.cx],[me.y,me.y1,me.cy],me)}break;default:throw new Error("unknown command type: ".concat(K.type))}G=te,Y=ne}}}catch(tt){ae=!0,T=tt}finally{try{J||W.return==null||W.return()}finally{if(ae)throw T}}for(var oe=N.length,de=this.strokeImageInfos.findImage(oe),xe=de.index,Ie=0;Ie<oe;++Ie){var we=N[Ie];b(de,Ae(we.x),Ae(we.y),Ae(we.cx),Ae(we.cy))}(S=this.glyphInfos[w.index]={glyph:w,uGlyphRect:[k.x1,-k.y1,k.x2,-k.y2],strokeImageInfo:de,strokes:N,colInfo:ut(F,this.colDimImageInfos,this.colCellImageInfos),rowInfo:ut(O,this.rowDimImageInfos,this.rowCellImageInfos)}).uGridOffset=[S.colInfo.dimOffset,S.rowInfo.dimOffset]}return S;function _e(tt,rt,it){var nt=N.length;function Ee(ee,le,Se){for(var Pe=ee.length;0<Pe--;){var Ue=ee[Pe];Ue<le&&(le=Ue),Se<Ue&&(Se=Ue)}return{min:le,max:Se}}N.push(it);for(var it=Ee(tt,1,0),tt=Math.max(Math.floor(9*it.min-.5),0),Ve=Math.min(Math.ceil(9*it.max+.5),9),Me=tt;Me<Ve;++Me)F[Me].push(nt);for(var it=Ee(rt,1,0),tt=Math.max(Math.floor(9*it.min-.5),0),re=Math.min(Math.ceil(9*it.max+.5),9),ie=tt;ie<re;++ie)O[ie].push(nt)}function Ae(tt){return(tt=(it=255)*tt)<(rt=0)?rt:it<tt?it:tt;var rt,it}function $e(tt,rt,it,nt){_e([tt,it],[rt,nt],{x:tt,y:rt,cx:(tt+it)/2,cy:(rt+nt)/2})}function Fe(tt,rt,it,nt){return Math.abs(it-tt)<1e-5&&Math.abs(nt-rt)<1e-5}function ut(tt,rt,it){for(var nt=tt.length,Ee=rt.findImage(nt),rt=Ee.index,Ve=0,Me=0;Me<nt;++Me)Ve+=tt[Me].length;for(var re=it.findImage(Ve),ie=0;ie<nt;++ie){var ee=tt[ie],le=ee.length,Se=re.index;b(Ee,Se>>7,127&Se,le>>7,127&le);for(var Pe=0;Pe<le;++Pe){var Ue=ee[Pe]+xe;b(re,Ue>>7,127&Ue,0,0)}}return{cellImageInfo:re,dimOffset:rt,dimImageInfo:Ee}}}}]),x}();u.default.RendererGL.prototype._renderText=function(x,w,S,k,_){if(this._textFont&&typeof this._textFont!="string"){if(!(_<=k)&&this._doFill){if(this._isOpenType()){x.push();var _=this._doStroke,C=this.drawMode,P=(this._doStroke=!1,this.drawMode=f.TEXTURE,this._textFont.font),A=(A=this._textFont._fontInfo)||(this._textFont._fontInfo=new v(P)),S=this._textFont._handleAlignment(this,w,S,k),k=this._textSize/P.unitsPerEm,I=(this.translate(S.x,S.y,0),this.scale(k,k,1),this.GL),S=!this._defaultFontShader,N=this._getFontShader(),O=(N.init(),N.bindShader(),S&&(N.setUniform("uGridImageSize",[64,64]),N.setUniform("uCellsImageSize",[64,64]),N.setUniform("uStrokeImageSize",[64,64]),N.setUniform("uGridSize",[9,9])),this._applyColorBlend(this.curFillColor),this.retainedMode.geometry.glyph),F=(O||((k=this._textGeom=new u.default.Geometry(1,1,function(){for(var ge=0;ge<=1;ge++)for(var me=0;me<=1;me++)this.vertices.push(new u.default.Vector(me,ge,0)),this.uvs.push(me,ge)})).computeFaces().computeNormals(),O=this.createBuffers("glyph",k)),!0),S=!1,k=void 0;try{for(var U,G=this.retainedMode.buffers.text[Symbol.iterator]();!(F=(U=G.next()).done);F=!0)U.value._prepareBuffer(O,N)}catch(ge){S=!0,k=ge}finally{try{F||G.return==null||G.return()}finally{if(S)throw k}}this._bindBuffer(O.indexBuffer,I.ELEMENT_ARRAY_BUFFER),N.setUniform("uMaterialColor",this.curFillColor),I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);try{var Y=0,$=null,H=P.stringToGlyphs(w),Q=!0,J=!1,ae=void 0;try{for(var T,B=H[Symbol.iterator]();!(Q=(T=B.next()).done);Q=!0){var W,K,te=T.value,ne=($&&(Y+=P.getKerningValue($,te)),A.getGlyphInfo(te));ne.uGlyphRect&&(W=ne.rowInfo,K=ne.colInfo,N.setUniform("uSamplerStrokes",ne.strokeImageInfo.imageData),N.setUniform("uSamplerRowStrokes",W.cellImageInfo.imageData),N.setUniform("uSamplerRows",W.dimImageInfo.imageData),N.setUniform("uSamplerColStrokes",K.cellImageInfo.imageData),N.setUniform("uSamplerCols",K.dimImageInfo.imageData),N.setUniform("uGridOffset",ne.uGridOffset),N.setUniform("uGlyphRect",ne.uGlyphRect),N.setUniform("uGlyphOffset",Y),N.bindTextures(),I.drawElements(I.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)),Y+=te.advanceWidth,$=te}}catch(ge){J=!0,ae=ge}finally{try{Q||B.return==null||B.return()}finally{if(J)throw ae}}}finally{N.unbindShader(),this._doStroke=_,this.drawMode=C,I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),x.pop()}}else console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts are supported");return x}}else console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.")}},{"../core/constants":269,"../core/main":280,"./p5.RendererGL.Retained":336,"./p5.Shader":338,"core-js/modules/es.array.iterator":164,"core-js/modules/es.object.get-own-property-descriptor":183,"core-js/modules/es.object.to-string":187,"core-js/modules/es.regexp.exec":192,"core-js/modules/es.string.iterator":197,"core-js/modules/es.string.split":203,"core-js/modules/es.string.sub":205,"core-js/modules/es.symbol":209,"core-js/modules/es.symbol.description":207,"core-js/modules/es.symbol.iterator":208,"core-js/modules/es.weak-map":241,"core-js/modules/web.dom-collections.iterator":243}]},{},[264])(264)})})(FO);var Zoe=FO.exports;const Joe=ml(Zoe),ese=`precision highp float;
attribute vec3 aPosition;
attribute vec2 aTexCoord;
varying vec2 vTexCoord;
void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);
  positionVec4.xy = positionVec4.xy * 2.0 - 1.0;
  gl_Position = positionVec4;
  vTexCoord = aTexCoord;
}`,tse=`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D img;
uniform sampler2D depth;
uniform vec3 fog;
void main() {
  gl_FragColor = mix(
    // Original color
    texture2D(img, vTexCoord),
    // Fog color
    vec4(fog/255., 1.),
    // Mix between them based on the depth.
    // The pow() makes the light falloff a bit steeper.
    pow(texture2D(depth, vTexCoord).r, 6.)
  );
}`;class rse{constructor(){R(this,"depth",!0);R(this,"edges",!0);this.depth=!0,this.edges=!0}}const Gu=new rse,nse=()=>{const[t,n]=z.useState(Gu.depth),[o,r]=z.useState(Gu.edges),s=()=>{Gu.depth=!t,n(!t)},a=()=>{Gu.edges=!o,r(!o)};return E.jsxs("div",{className:"controls",children:[E.jsx("button",{type:"button",onClick:s,children:t?"Hide Depth":"Show Depth"}),E.jsx("button",{type:"button",onClick:a,children:o?"Hide Edges":"Show Edges"})]})};class ose{constructor(n){R(this,"editor");R(this,"p5");R(this,"width");R(this,"height");this.editor=n,this.width=window.innerWidth,this.height=window.innerHeight,this.p5=new Joe(o=>{let r,s;o.preload=()=>{s=o.createShader(ese,tse)},o.setup=()=>{o.createCanvas(this.width,this.height,o.WEBGL);const a={width:o.width,height:o.height};r=o.createFramebuffer(a)},o.draw=()=>{o.colorMode(o.HSL);const a=this.editor.user.getIsDarkMode()?o.color(220,10,10):o.color("white");o.background(a);const i=this.editor.getCurrentPageShapes();r.begin(),o.clear(),o.lights(),o.scale(1,-1,1),this.draw(o,i),r.end(),o.shader(s),s.setUniform("fog",[o.red(a),o.green(a),o.blue(a)]),s.setUniform("img",r.color),s.setUniform("depth",r.depth),o.rect(0,0,o.width,o.height)}})}draw(n,o){const r=this.editor.getCamera();n.scale(r.z,r.z,r.z);let s=null;o.forEach(a=>{const i=a.x+r.x-n.width/2/r.z,l=a.y+r.y-n.height/2/r.z;n.push(),n.translate(i,l),n.rotateZ(a.rotation),Gu.depth&&this.drawGeo(a),s&&Gu.edges&&this.drawRope(a,s),n.pop(),s=a})}drawGeo(n){const o=this.p5.color(190,50,50),r=this.p5.color(190,50,30),s=1e4,a=this.editor.getShapeGeometry(n),i=n.type!=="arrow"&&a.isClosed,l=a.vertices;this.p5.stroke(r),this.p5.fill(o);const c=i?l.length:l.length-1;for(let u=0;u<c;u++){const f=(u+1)%l.length;this.p5.beginShape(),this.p5.vertex(l[u].x,l[u].y,0),this.p5.vertex(l[f].x,l[f].y,0),this.p5.vertex(l[f].x,l[f].y,-s),this.p5.vertex(l[u].x,l[u].y,-s),this.p5.endShape(this.p5.CLOSE)}}drawRope(n,o){const r=this.editor.getShapeGeometry(n),s=20,a=1e3,i=20,l=this.p5.color(250,50,50);this.p5.push(),this.p5.translate(r.bounds.w/2,r.bounds.h/2),this.p5.rotateZ(-n.rotation);const c=this.centerToCenter(n,o);this.p5.stroke(l),this.p5.strokeWeight(i),this.p5.noFill(),this.p5.beginShape();for(let u=0;u<=s;u++){const f=u/s,h=this.p5.lerp(0,c.x,f),d=this.p5.lerp(0,c.y,f),p=a*Math.sin(Math.PI*f),y=this.p5.lerpColor(l,this.p5.color("red"),f);this.p5.stroke(y),this.p5.vertex(h,d,-p)}this.p5.endShape(),this.p5.pop()}centerToCenter(n,o){const r=this.editor.getShapeGeometry(n),s=this.editor.getShapeGeometry(o),a=n.x+r.bounds.w/2*Math.cos(n.rotation)-r.bounds.h/2*Math.sin(n.rotation),i=n.y+r.bounds.w/2*Math.sin(n.rotation)+r.bounds.h/2*Math.cos(n.rotation),l=o.x+s.bounds.w/2*Math.cos(o.rotation)-s.bounds.h/2*Math.sin(o.rotation),c=o.y+s.bounds.w/2*Math.sin(o.rotation)+s.bounds.h/2*Math.cos(o.rotation);return{x:l-a,y:c-i}}}function sse(){return E.jsx("div",{className:"tldraw__editor",children:E.jsx($oe,{persistenceKey:"fuzzy-canvas",onMount:t=>{new ose(t)},children:E.jsx(nse,{})})})}Zy.createRoot(document.getElementById("root")).render(E.jsx(sse,{}));
